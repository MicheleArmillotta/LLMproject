[
  {
    "function_name": "eso_set_gain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1816-1909",
    "snippet": "HIDE void\neso_set_gain(sc, port)\n\tstruct eso_softc *sc;\n\tunsigned int port;\n{\n\tuint8_t mixreg, tmp;\n\n\tswitch (port) {\n\tcase ESO_DAC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_AUXB;\n\t\tbreak;\n\t\t    \n\tcase ESO_DAC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_AUXB;\n\t\tbreak;\n\tcase ESO_MONO_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MONO;\n\t\tbreak;\n\tcase ESO_MONO_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MONO;\n\t\tbreak;\n\t\t\n\tcase ESO_PCSPEAKER_VOL:\n\t\t/* Special case - only 3-bit, mono, and reserved bits. */\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_PCSVR);\n\t\ttmp &= ESO_MIXREG_PCSVR_RESV;\n\t\t/* Map bits 7:5 -> 2:0. */\n\t\ttmp |= (sc->sc_gain[port][ESO_LEFT] >> 5);\n\t\teso_write_mixreg(sc, ESO_MIXREG_PCSVR, tmp);\n\t\treturn;\n\n\tcase ESO_MASTER_VOL:\n\t\t/* Special case - separate regs, and 6-bit precision. */\n\t\t/* Map bits 7:2 -> 5:0. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_LMVM,\n\t\t    sc->sc_gain[port][ESO_LEFT] >> 2);\n\t\teso_write_mixreg(sc, ESO_MIXREG_RMVM,\n\t\t    sc->sc_gain[port][ESO_RIGHT] >> 2);\n\t\treturn;\n\n\tcase ESO_SPATIALIZER:\n\t\t/* Special case - only `mono', and higher precision. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_SPATLVL,\n\t\t    sc->sc_gain[port][ESO_LEFT]);\n\t\treturn;\n\t\t\n\tcase ESO_RECORD_VOL:\n\t\t/* Very Special case, controller register. */\n\t\teso_write_ctlreg(sc, ESO_CTLREG_RECLVL,ESO_4BIT_GAIN_TO_STEREO(\n\t\t   sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n\t\treturn;\n\n\tdefault:\n#ifdef DIAGNOSTIC\t\t\n\t\tpanic(\"eso_set_gain: bad port %u\", port);\n\t\t/* NOTREACHED */\n#else\n\t\treturn;\n#endif\t\t\n\t\t}\n\n\teso_write_mixreg(sc, mixreg, ESO_4BIT_GAIN_TO_STEREO(\n\t    sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "mixreg",
            "ESO_4BIT_GAIN_TO_STEREO(\n\t    sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT])"
          ],
          "line": 1907
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ESO_4BIT_GAIN_TO_STEREO",
          "args": [
            "sc->sc_gain[port][ESO_LEFT]",
            "sc->sc_gain[port][ESO_RIGHT]"
          ],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"eso_set_gain: bad port %u\"",
            "port"
          ],
          "line": 1900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_write_ctlreg",
          "args": [
            "sc",
            "ESO_CTLREG_RECLVL",
            "ESO_4BIT_GAIN_TO_STEREO(\n\t\t   sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT])"
          ],
          "line": 1894
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_ctlreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "460-470",
          "snippet": "HIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ESO_4BIT_GAIN_TO_STEREO",
          "args": [
            "sc->sc_gain[port][ESO_LEFT]",
            "sc->sc_gain[port][ESO_RIGHT]"
          ],
          "line": 1894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_read_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_PCSVR"
          ],
          "line": 1870
        },
        "resolved": true,
        "details": {
          "function_name": "eso_read_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "520-534",
          "snippet": "HIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_set_gain(sc, port)\n\tstruct eso_softc *sc;\n\tunsigned int port;\n{\n\tuint8_t mixreg, tmp;\n\n\tswitch (port) {\n\tcase ESO_DAC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_AUXB;\n\t\tbreak;\n\t\t    \n\tcase ESO_DAC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_AUXB;\n\t\tbreak;\n\tcase ESO_MONO_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MONO;\n\t\tbreak;\n\tcase ESO_MONO_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MONO;\n\t\tbreak;\n\t\t\n\tcase ESO_PCSPEAKER_VOL:\n\t\t/* Special case - only 3-bit, mono, and reserved bits. */\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_PCSVR);\n\t\ttmp &= ESO_MIXREG_PCSVR_RESV;\n\t\t/* Map bits 7:5 -> 2:0. */\n\t\ttmp |= (sc->sc_gain[port][ESO_LEFT] >> 5);\n\t\teso_write_mixreg(sc, ESO_MIXREG_PCSVR, tmp);\n\t\treturn;\n\n\tcase ESO_MASTER_VOL:\n\t\t/* Special case - separate regs, and 6-bit precision. */\n\t\t/* Map bits 7:2 -> 5:0. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_LMVM,\n\t\t    sc->sc_gain[port][ESO_LEFT] >> 2);\n\t\teso_write_mixreg(sc, ESO_MIXREG_RMVM,\n\t\t    sc->sc_gain[port][ESO_RIGHT] >> 2);\n\t\treturn;\n\n\tcase ESO_SPATIALIZER:\n\t\t/* Special case - only `mono', and higher precision. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_SPATLVL,\n\t\t    sc->sc_gain[port][ESO_LEFT]);\n\t\treturn;\n\t\t\n\tcase ESO_RECORD_VOL:\n\t\t/* Very Special case, controller register. */\n\t\teso_write_ctlreg(sc, ESO_CTLREG_RECLVL,ESO_4BIT_GAIN_TO_STEREO(\n\t\t   sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n\t\treturn;\n\n\tdefault:\n#ifdef DIAGNOSTIC\t\t\n\t\tpanic(\"eso_set_gain: bad port %u\", port);\n\t\t/* NOTREACHED */\n#else\n\t\treturn;\n#endif\t\t\n\t\t}\n\n\teso_write_mixreg(sc, mixreg, ESO_4BIT_GAIN_TO_STEREO(\n\t    sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n}"
  },
  {
    "function_name": "eso_set_recsrc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1805-1814",
    "snippet": "HIDE int\neso_set_recsrc(sc, recsrc)\n\tstruct eso_softc *sc;\n\tunsigned int recsrc;\n{\n\n\teso_write_mixreg(sc, ESO_MIXREG_ERS, recsrc);\n\tsc->sc_recsrc = recsrc;\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_ERS",
            "recsrc"
          ],
          "line": 1811
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\n\nHIDE int\neso_set_recsrc(sc, recsrc)\n\tstruct eso_softc *sc;\n\tunsigned int recsrc;\n{\n\n\teso_write_mixreg(sc, ESO_MIXREG_ERS, recsrc);\n\tsc->sc_recsrc = recsrc;\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_trigger_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1707-1803",
    "snippet": "HIDE int\neso_trigger_input(hdl, start, end, blksize, intr, arg, param)\n\tvoid *hdl;\n\tvoid *start, *end;\n\tint blksize;\n\tvoid (*intr) __P((void *));\n\tvoid *arg;\n\tstruct audio_params *param;\n{\n\tstruct eso_softc *sc = hdl;\n\tstruct eso_dma *ed;\n\tuint8_t actl, a1c1;\n\n\tDPRINTF((\n\t    \"%s: trigger_input: start %p, end %p, blksize %d, intr %p(%p)\\n\",\n\t    sc->sc_dev.dv_xname, start, end, blksize, intr, arg));\n\tDPRINTF((\"%s: param: rate %lu, encoding %u, precision %u, channels %u, sw_code %p, factor %d\\n\",\n\t    sc->sc_dev.dv_xname, param->sample_rate, param->encoding,\n\t    param->precision, param->channels, param->sw_code, param->factor));\n\n\t/*\n\t * If we failed to configure the Audio 1 DMA controller, bail here\n\t * while retaining availability of the DAC direction (in Audio 2).\n\t */\n\tif (!sc->sc_dmac_configured)\n\t\treturn (EIO);\n\n\t/* Find DMA buffer. */\n\tfor (ed = sc->sc_dmas; ed != NULL && KVADDR(ed) != start;\n\t     ed = ed->ed_next)\n\t\t;\n\tif (ed == NULL) {\n\t\tprintf(\"%s: trigger_output: bad addr %p\\n\",\n\t\t    sc->sc_dev.dv_xname, start);\n\t\treturn (EINVAL);\n\t}\n\n\tsc->sc_rintr = intr;\n\tsc->sc_rarg = arg;\n\n\t/* Set up ADC DMA converter parameters. */\n\tactl = eso_read_ctlreg(sc, ESO_CTLREG_ACTL);\n\tif (param->channels == 2) {\n\t\tactl &= ~ESO_CTLREG_ACTL_MONO;\n\t\tactl |= ESO_CTLREG_ACTL_STEREO;\n\t} else {\n\t\tactl &= ~ESO_CTLREG_ACTL_STEREO;\n\t\tactl |= ESO_CTLREG_ACTL_MONO;\n\t}\n\teso_write_ctlreg(sc, ESO_CTLREG_ACTL, actl);\n\n\t/* Set up Transfer Type: maybe move to attach time? */\n\teso_write_ctlreg(sc, ESO_CTLREG_A1TT, ESO_CTLREG_A1TT_DEMAND4);\n\n\t/* DMA transfer count reload using 2's complement. */\n\tblksize = -blksize;\n\teso_write_ctlreg(sc, ESO_CTLREG_A1TCRLO, blksize & 0xff);\n\teso_write_ctlreg(sc, ESO_CTLREG_A1TCRHI, blksize >> 8);\n\n\t/* Set up and enable Audio 1 DMA FIFO. */\n\ta1c1 = ESO_CTLREG_A1C1_RESV1 | ESO_CTLREG_A1C1_FIFOENB;\n\tif (param->precision * param->factor == 16)\n\t\ta1c1 |= ESO_CTLREG_A1C1_16BIT;\n\tif (param->channels == 2)\n\t\ta1c1 |= ESO_CTLREG_A1C1_STEREO;\n\telse\n\t\ta1c1 |= ESO_CTLREG_A1C1_MONO;\n\tif (param->encoding == AUDIO_ENCODING_SLINEAR_BE ||\n\t    param->encoding == AUDIO_ENCODING_SLINEAR_LE)\n\t\ta1c1 |= ESO_CTLREG_A1C1_SIGNED;\n\teso_write_ctlreg(sc, ESO_CTLREG_A1C1, a1c1);\n\n\t/* Set up ADC IRQ/DRQ parameters. */\n\teso_write_ctlreg(sc, ESO_CTLREG_LAIC,\n\t    ESO_CTLREG_LAIC_PINENB | ESO_CTLREG_LAIC_EXTENB);\n\teso_write_ctlreg(sc, ESO_CTLREG_DRQCTL,\n\t    ESO_CTLREG_DRQCTL_ENB1 | ESO_CTLREG_DRQCTL_EXTENB);\n\n\t/* Set up and enable DMA controller. */\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_CLEAR, 0);\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MASK,\n\t    ESO_DMAC_MASK_MASK);\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MODE,\n\t    DMA37MD_WRITE | DMA37MD_LOOP | DMA37MD_DEMAND);\n\tbus_space_write_4(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_DMAA,\n\t    htopci(DMAADDR(ed)));\n\tbus_space_write_2(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_DMAC,\n\t    htopci((uint8_t *)end - (uint8_t *)start - 1));\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MASK, 0);\n\n\t/* Start DMA. */\n\teso_write_ctlreg(sc, ESO_CTLREG_A1C2,\n\t    ESO_CTLREG_A1C2_DMAENB | ESO_CTLREG_A1C2_READ |\n\t    ESO_CTLREG_A1C2_AUTO | ESO_CTLREG_A1C2_ADC);\n\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "eso_intr __P((void *));",
      "HIDE int",
      "eso_open __P((void *, int));",
      "HIDE void",
      "eso_close __P((void *));",
      "HIDE int",
      "HIDE int",
      "eso_set_params __P((void *, int, int, struct audio_params *,\n\t\t    struct audio_params *));",
      "HIDE int",
      "eso_round_blocksize __P((void *, int));",
      "HIDE int",
      "eso_halt_output __P((void *));",
      "HIDE int",
      "eso_halt_input __P((void *));",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "eso_freem __P((void *, void *, int));",
      "HIDE int",
      "eso_mappage __P((void *, void *, int, int));",
      "HIDE int",
      "eso_get_props __P((void *));",
      "HIDE int",
      "eso_trigger_output __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));",
      "HIDE int",
      "eso_trigger_input __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "eso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));",
      "HIDE void",
      "eso_freemem __P((struct eso_softc *, struct eso_dma *));",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eso_write_ctlreg",
          "args": [
            "sc",
            "ESO_CTLREG_A1C2",
            "ESO_CTLREG_A1C2_DMAENB | ESO_CTLREG_A1C2_READ |\n\t    ESO_CTLREG_A1C2_AUTO | ESO_CTLREG_A1C2_ADC"
          ],
          "line": 1798
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_ctlreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "460-470",
          "snippet": "HIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_dmac_iot",
            "sc->sc_dmac_ioh",
            "ESO_DMAC_MASK",
            "0"
          ],
          "line": 1795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "sc->sc_dmac_iot",
            "sc->sc_dmac_ioh",
            "ESO_DMAC_DMAC",
            "htopci((uint8_t *)end - (uint8_t *)start - 1)"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htopci",
          "args": [
            "(uint8_t *)end - (uint8_t *)start - 1"
          ],
          "line": 1794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "sc->sc_dmac_iot",
            "sc->sc_dmac_ioh",
            "ESO_DMAC_DMAA",
            "htopci(DMAADDR(ed))"
          ],
          "line": 1791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htopci",
          "args": [
            "DMAADDR(ed)"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMAADDR",
          "args": [
            "ed"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_dmac_iot",
            "sc->sc_dmac_ioh",
            "ESO_DMAC_MODE",
            "DMA37MD_WRITE | DMA37MD_LOOP | DMA37MD_DEMAND"
          ],
          "line": 1789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_dmac_iot",
            "sc->sc_dmac_ioh",
            "ESO_DMAC_MASK",
            "ESO_DMAC_MASK_MASK"
          ],
          "line": 1787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_dmac_iot",
            "sc->sc_dmac_ioh",
            "ESO_DMAC_CLEAR",
            "0"
          ],
          "line": 1786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_read_ctlreg",
          "args": [
            "sc",
            "ESO_CTLREG_ACTL"
          ],
          "line": 1748
        },
        "resolved": true,
        "details": {
          "function_name": "eso_read_ctlreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "494-503",
          "snippet": "HIDE uint8_t\neso_read_ctlreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\n\teso_write_cmd(sc, ESO_CMD_RCR);\n\teso_write_cmd(sc, reg);\n\treturn (eso_read_rdr(sc));\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_ctlreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\n\teso_write_cmd(sc, ESO_CMD_RCR);\n\teso_write_cmd(sc, reg);\n\treturn (eso_read_rdr(sc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: trigger_output: bad addr %p\\n\"",
            "sc->sc_dev.dv_xname",
            "start"
          ],
          "line": 1739
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "KVADDR",
          "args": [
            "ed"
          ],
          "line": 1735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: param: rate %lu, encoding %u, precision %u, channels %u, sw_code %p, factor %d\\n\",\n\t    sc->sc_dev.dv_xname, param->sample_rate, param->encoding,\n\t    param->precision, param->channels, param->sw_code, param->factor)"
          ],
          "line": 1723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\n\t    \"%s: trigger_input: start %p, end %p, blksize %d, intr %p(%p)\\n\",\n\t    sc->sc_dev.dv_xname, start, end, blksize, intr, arg)"
          ],
          "line": 1720
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\neso_intr __P((void *));\nHIDE int;\neso_open __P((void *, int));\nHIDE void;\neso_close __P((void *));\nHIDE int;\nHIDE int;\neso_set_params __P((void *, int, int, struct audio_params *,\n\t\t    struct audio_params *));\nHIDE int;\neso_round_blocksize __P((void *, int));\nHIDE int;\neso_halt_output __P((void *));\nHIDE int;\neso_halt_input __P((void *));\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\neso_freem __P((void *, void *, int));\nHIDE int;\neso_mappage __P((void *, void *, int, int));\nHIDE int;\neso_get_props __P((void *));\nHIDE int;\neso_trigger_output __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));\nHIDE int;\neso_trigger_input __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\neso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));\nHIDE void;\neso_freemem __P((struct eso_softc *, struct eso_dma *));\nvoid *hdl;\n\nHIDE int\neso_trigger_input(hdl, start, end, blksize, intr, arg, param)\n\tvoid *hdl;\n\tvoid *start, *end;\n\tint blksize;\n\tvoid (*intr) __P((void *));\n\tvoid *arg;\n\tstruct audio_params *param;\n{\n\tstruct eso_softc *sc = hdl;\n\tstruct eso_dma *ed;\n\tuint8_t actl, a1c1;\n\n\tDPRINTF((\n\t    \"%s: trigger_input: start %p, end %p, blksize %d, intr %p(%p)\\n\",\n\t    sc->sc_dev.dv_xname, start, end, blksize, intr, arg));\n\tDPRINTF((\"%s: param: rate %lu, encoding %u, precision %u, channels %u, sw_code %p, factor %d\\n\",\n\t    sc->sc_dev.dv_xname, param->sample_rate, param->encoding,\n\t    param->precision, param->channels, param->sw_code, param->factor));\n\n\t/*\n\t * If we failed to configure the Audio 1 DMA controller, bail here\n\t * while retaining availability of the DAC direction (in Audio 2).\n\t */\n\tif (!sc->sc_dmac_configured)\n\t\treturn (EIO);\n\n\t/* Find DMA buffer. */\n\tfor (ed = sc->sc_dmas; ed != NULL && KVADDR(ed) != start;\n\t     ed = ed->ed_next)\n\t\t;\n\tif (ed == NULL) {\n\t\tprintf(\"%s: trigger_output: bad addr %p\\n\",\n\t\t    sc->sc_dev.dv_xname, start);\n\t\treturn (EINVAL);\n\t}\n\n\tsc->sc_rintr = intr;\n\tsc->sc_rarg = arg;\n\n\t/* Set up ADC DMA converter parameters. */\n\tactl = eso_read_ctlreg(sc, ESO_CTLREG_ACTL);\n\tif (param->channels == 2) {\n\t\tactl &= ~ESO_CTLREG_ACTL_MONO;\n\t\tactl |= ESO_CTLREG_ACTL_STEREO;\n\t} else {\n\t\tactl &= ~ESO_CTLREG_ACTL_STEREO;\n\t\tactl |= ESO_CTLREG_ACTL_MONO;\n\t}\n\teso_write_ctlreg(sc, ESO_CTLREG_ACTL, actl);\n\n\t/* Set up Transfer Type: maybe move to attach time? */\n\teso_write_ctlreg(sc, ESO_CTLREG_A1TT, ESO_CTLREG_A1TT_DEMAND4);\n\n\t/* DMA transfer count reload using 2's complement. */\n\tblksize = -blksize;\n\teso_write_ctlreg(sc, ESO_CTLREG_A1TCRLO, blksize & 0xff);\n\teso_write_ctlreg(sc, ESO_CTLREG_A1TCRHI, blksize >> 8);\n\n\t/* Set up and enable Audio 1 DMA FIFO. */\n\ta1c1 = ESO_CTLREG_A1C1_RESV1 | ESO_CTLREG_A1C1_FIFOENB;\n\tif (param->precision * param->factor == 16)\n\t\ta1c1 |= ESO_CTLREG_A1C1_16BIT;\n\tif (param->channels == 2)\n\t\ta1c1 |= ESO_CTLREG_A1C1_STEREO;\n\telse\n\t\ta1c1 |= ESO_CTLREG_A1C1_MONO;\n\tif (param->encoding == AUDIO_ENCODING_SLINEAR_BE ||\n\t    param->encoding == AUDIO_ENCODING_SLINEAR_LE)\n\t\ta1c1 |= ESO_CTLREG_A1C1_SIGNED;\n\teso_write_ctlreg(sc, ESO_CTLREG_A1C1, a1c1);\n\n\t/* Set up ADC IRQ/DRQ parameters. */\n\teso_write_ctlreg(sc, ESO_CTLREG_LAIC,\n\t    ESO_CTLREG_LAIC_PINENB | ESO_CTLREG_LAIC_EXTENB);\n\teso_write_ctlreg(sc, ESO_CTLREG_DRQCTL,\n\t    ESO_CTLREG_DRQCTL_ENB1 | ESO_CTLREG_DRQCTL_EXTENB);\n\n\t/* Set up and enable DMA controller. */\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_CLEAR, 0);\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MASK,\n\t    ESO_DMAC_MASK_MASK);\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MODE,\n\t    DMA37MD_WRITE | DMA37MD_LOOP | DMA37MD_DEMAND);\n\tbus_space_write_4(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_DMAA,\n\t    htopci(DMAADDR(ed)));\n\tbus_space_write_2(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_DMAC,\n\t    htopci((uint8_t *)end - (uint8_t *)start - 1));\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MASK, 0);\n\n\t/* Start DMA. */\n\teso_write_ctlreg(sc, ESO_CTLREG_A1C2,\n\t    ESO_CTLREG_A1C2_DMAENB | ESO_CTLREG_A1C2_READ |\n\t    ESO_CTLREG_A1C2_AUTO | ESO_CTLREG_A1C2_ADC);\n\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_trigger_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1632-1705",
    "snippet": "HIDE int\neso_trigger_output(hdl, start, end, blksize, intr, arg, param)\n\tvoid *hdl;\n\tvoid *start, *end;\n\tint blksize;\n\tvoid (*intr) __P((void *));\n\tvoid *arg;\n\tstruct audio_params *param;\n{\n\tstruct eso_softc *sc = hdl;\n\tstruct eso_dma *ed;\n\tuint8_t a2c1;\n\t\n\tDPRINTF((\n\t    \"%s: trigger_output: start %p, end %p, blksize %d, intr %p(%p)\\n\",\n\t    sc->sc_dev.dv_xname, start, end, blksize, intr, arg));\n\tDPRINTF((\"%s: param: rate %lu, encoding %u, precision %u, channels %u, sw_code %p, factor %d\\n\",\n\t    sc->sc_dev.dv_xname, param->sample_rate, param->encoding,\n\t    param->precision, param->channels, param->sw_code, param->factor));\n\t\n\t/* Find DMA buffer. */\n\tfor (ed = sc->sc_dmas; ed != NULL && KVADDR(ed) != start;\n\t     ed = ed->ed_next)\n\t\t;\n\tif (ed == NULL) {\n\t\tprintf(\"%s: trigger_output: bad addr %p\\n\",\n\t\t    sc->sc_dev.dv_xname, start);\n\t\treturn (EINVAL);\n\t}\n\t\n\tsc->sc_pintr = intr;\n\tsc->sc_parg = arg;\n\n\t/* DMA transfer count (in `words'!) reload using 2's complement. */\n\tblksize = -(blksize >> 1);\n\teso_write_mixreg(sc, ESO_MIXREG_A2TCRLO, blksize & 0xff);\n\teso_write_mixreg(sc, ESO_MIXREG_A2TCRHI, blksize >> 8);\n\n\t/* Update DAC to reflect DMA count and audio parameters. */\n\t/* Note: we cache A2C2 in order to avoid r/m/w at interrupt time. */\n\tif (param->precision * param->factor == 16)\n\t\tsc->sc_a2c2 |= ESO_MIXREG_A2C2_16BIT;\n\telse\n\t\tsc->sc_a2c2 &= ~ESO_MIXREG_A2C2_16BIT;\n\tif (param->channels == 2)\n\t\tsc->sc_a2c2 |= ESO_MIXREG_A2C2_STEREO;\n\telse\n\t\tsc->sc_a2c2 &= ~ESO_MIXREG_A2C2_STEREO;\n\tif (param->encoding == AUDIO_ENCODING_SLINEAR_BE ||\n\t    param->encoding == AUDIO_ENCODING_SLINEAR_LE)\n\t\tsc->sc_a2c2 |= ESO_MIXREG_A2C2_SIGNED;\n\telse\n\t\tsc->sc_a2c2 &= ~ESO_MIXREG_A2C2_SIGNED;\n\t/* Unmask IRQ. */\n\tsc->sc_a2c2 |= ESO_MIXREG_A2C2_IRQM;\n\teso_write_mixreg(sc, ESO_MIXREG_A2C2, sc->sc_a2c2);\n\t\n\t/* Set up DMA controller. */\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAA,\n\t    htopci(DMAADDR(ed)));\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAC,\n\t    htopci((uint8_t *)end - (uint8_t *)start));\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAM,\n\t    ESO_IO_A2DMAM_DMAENB | ESO_IO_A2DMAM_AUTO);\n\t\n\t/* Start DMA. */\n\ta2c1 = eso_read_mixreg(sc, ESO_MIXREG_A2C1);\n\ta2c1 &= ~ESO_MIXREG_A2C1_RESV0; /* Paranoia? XXX bit 5 */\n\ta2c1 |= ESO_MIXREG_A2C1_FIFOENB | ESO_MIXREG_A2C1_DMAENB |\n\t    ESO_MIXREG_A2C1_AUTO;\n\teso_write_mixreg(sc, ESO_MIXREG_A2C1, a2c1);\n\t\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "eso_intr __P((void *));",
      "HIDE int",
      "eso_open __P((void *, int));",
      "HIDE void",
      "eso_close __P((void *));",
      "HIDE int",
      "HIDE int",
      "eso_set_params __P((void *, int, int, struct audio_params *,\n\t\t    struct audio_params *));",
      "HIDE int",
      "eso_round_blocksize __P((void *, int));",
      "HIDE int",
      "eso_halt_output __P((void *));",
      "HIDE int",
      "eso_halt_input __P((void *));",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "eso_freem __P((void *, void *, int));",
      "HIDE int",
      "eso_mappage __P((void *, void *, int, int));",
      "HIDE int",
      "eso_get_props __P((void *));",
      "HIDE int",
      "eso_trigger_output __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));",
      "HIDE int",
      "eso_trigger_input __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "eso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));",
      "HIDE void",
      "eso_freemem __P((struct eso_softc *, struct eso_dma *));",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_A2C1",
            "a2c1"
          ],
          "line": 1702
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_read_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_A2C1"
          ],
          "line": 1698
        },
        "resolved": true,
        "details": {
          "function_name": "eso_read_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "520-534",
          "snippet": "HIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "ESO_IO_A2DMAM",
            "ESO_IO_A2DMAM_DMAENB | ESO_IO_A2DMAM_AUTO"
          ],
          "line": 1694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_2",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "ESO_IO_A2DMAC",
            "htopci((uint8_t *)end - (uint8_t *)start)"
          ],
          "line": 1692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htopci",
          "args": [
            "(uint8_t *)end - (uint8_t *)start"
          ],
          "line": 1693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_4",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "ESO_IO_A2DMAA",
            "htopci(DMAADDR(ed))"
          ],
          "line": 1690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htopci",
          "args": [
            "DMAADDR(ed)"
          ],
          "line": 1691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DMAADDR",
          "args": [
            "ed"
          ],
          "line": 1691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: trigger_output: bad addr %p\\n\"",
            "sc->sc_dev.dv_xname",
            "start"
          ],
          "line": 1657
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "KVADDR",
          "args": [
            "ed"
          ],
          "line": 1653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: param: rate %lu, encoding %u, precision %u, channels %u, sw_code %p, factor %d\\n\",\n\t    sc->sc_dev.dv_xname, param->sample_rate, param->encoding,\n\t    param->precision, param->channels, param->sw_code, param->factor)"
          ],
          "line": 1648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\n\t    \"%s: trigger_output: start %p, end %p, blksize %d, intr %p(%p)\\n\",\n\t    sc->sc_dev.dv_xname, start, end, blksize, intr, arg)"
          ],
          "line": 1645
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\neso_intr __P((void *));\nHIDE int;\neso_open __P((void *, int));\nHIDE void;\neso_close __P((void *));\nHIDE int;\nHIDE int;\neso_set_params __P((void *, int, int, struct audio_params *,\n\t\t    struct audio_params *));\nHIDE int;\neso_round_blocksize __P((void *, int));\nHIDE int;\neso_halt_output __P((void *));\nHIDE int;\neso_halt_input __P((void *));\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\neso_freem __P((void *, void *, int));\nHIDE int;\neso_mappage __P((void *, void *, int, int));\nHIDE int;\neso_get_props __P((void *));\nHIDE int;\neso_trigger_output __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));\nHIDE int;\neso_trigger_input __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\neso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));\nHIDE void;\neso_freemem __P((struct eso_softc *, struct eso_dma *));\nvoid *hdl;\n\nHIDE int\neso_trigger_output(hdl, start, end, blksize, intr, arg, param)\n\tvoid *hdl;\n\tvoid *start, *end;\n\tint blksize;\n\tvoid (*intr) __P((void *));\n\tvoid *arg;\n\tstruct audio_params *param;\n{\n\tstruct eso_softc *sc = hdl;\n\tstruct eso_dma *ed;\n\tuint8_t a2c1;\n\t\n\tDPRINTF((\n\t    \"%s: trigger_output: start %p, end %p, blksize %d, intr %p(%p)\\n\",\n\t    sc->sc_dev.dv_xname, start, end, blksize, intr, arg));\n\tDPRINTF((\"%s: param: rate %lu, encoding %u, precision %u, channels %u, sw_code %p, factor %d\\n\",\n\t    sc->sc_dev.dv_xname, param->sample_rate, param->encoding,\n\t    param->precision, param->channels, param->sw_code, param->factor));\n\t\n\t/* Find DMA buffer. */\n\tfor (ed = sc->sc_dmas; ed != NULL && KVADDR(ed) != start;\n\t     ed = ed->ed_next)\n\t\t;\n\tif (ed == NULL) {\n\t\tprintf(\"%s: trigger_output: bad addr %p\\n\",\n\t\t    sc->sc_dev.dv_xname, start);\n\t\treturn (EINVAL);\n\t}\n\t\n\tsc->sc_pintr = intr;\n\tsc->sc_parg = arg;\n\n\t/* DMA transfer count (in `words'!) reload using 2's complement. */\n\tblksize = -(blksize >> 1);\n\teso_write_mixreg(sc, ESO_MIXREG_A2TCRLO, blksize & 0xff);\n\teso_write_mixreg(sc, ESO_MIXREG_A2TCRHI, blksize >> 8);\n\n\t/* Update DAC to reflect DMA count and audio parameters. */\n\t/* Note: we cache A2C2 in order to avoid r/m/w at interrupt time. */\n\tif (param->precision * param->factor == 16)\n\t\tsc->sc_a2c2 |= ESO_MIXREG_A2C2_16BIT;\n\telse\n\t\tsc->sc_a2c2 &= ~ESO_MIXREG_A2C2_16BIT;\n\tif (param->channels == 2)\n\t\tsc->sc_a2c2 |= ESO_MIXREG_A2C2_STEREO;\n\telse\n\t\tsc->sc_a2c2 &= ~ESO_MIXREG_A2C2_STEREO;\n\tif (param->encoding == AUDIO_ENCODING_SLINEAR_BE ||\n\t    param->encoding == AUDIO_ENCODING_SLINEAR_LE)\n\t\tsc->sc_a2c2 |= ESO_MIXREG_A2C2_SIGNED;\n\telse\n\t\tsc->sc_a2c2 &= ~ESO_MIXREG_A2C2_SIGNED;\n\t/* Unmask IRQ. */\n\tsc->sc_a2c2 |= ESO_MIXREG_A2C2_IRQM;\n\teso_write_mixreg(sc, ESO_MIXREG_A2C2, sc->sc_a2c2);\n\t\n\t/* Set up DMA controller. */\n\tbus_space_write_4(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAA,\n\t    htopci(DMAADDR(ed)));\n\tbus_space_write_2(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAC,\n\t    htopci((uint8_t *)end - (uint8_t *)start));\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAM,\n\t    ESO_IO_A2DMAM_DMAENB | ESO_IO_A2DMAM_AUTO);\n\t\n\t/* Start DMA. */\n\ta2c1 = eso_read_mixreg(sc, ESO_MIXREG_A2C1);\n\ta2c1 &= ~ESO_MIXREG_A2C1_RESV0; /* Paranoia? XXX bit 5 */\n\ta2c1 |= ESO_MIXREG_A2C1_FIFOENB | ESO_MIXREG_A2C1_DMAENB |\n\t    ESO_MIXREG_A2C1_AUTO;\n\teso_write_mixreg(sc, ESO_MIXREG_A2C1, a2c1);\n\t\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_get_props",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1623-1630",
    "snippet": "HIDE int\neso_get_props(hdl)\n\tvoid *hdl;\n{\n\n\treturn (AUDIO_PROP_MMAP | AUDIO_PROP_INDEPENDENT |\n\t    AUDIO_PROP_FULLDUPLEX);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_get_props(hdl)\n\tvoid *hdl;\n{\n\n\treturn (AUDIO_PROP_MMAP | AUDIO_PROP_INDEPENDENT |\n\t    AUDIO_PROP_FULLDUPLEX);\n}"
  },
  {
    "function_name": "eso_mappage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1600-1620",
    "snippet": "HIDE int\neso_mappage(hdl, addr, offs, prot)\n\tvoid *hdl;\n\tvoid *addr;\n\tint offs;\n\tint prot;\n{\n\tstruct eso_softc *sc = hdl;\n\tstruct eso_dma *ed;\n\n\tif (offs < 0)\n\t\treturn (-1);\n\tfor (ed = sc->sc_dmas; ed != NULL && KVADDR(ed) == addr;\n\t     ed = ed->ed_next)\n\t\t;\n\tif (ed == NULL)\n\t\treturn (-1);\n\t\n\treturn (bus_dmamem_mmap(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs,\n\t    offs, prot, BUS_DMA_WAITOK));\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "eso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));",
      "HIDE void",
      "eso_freemem __P((struct eso_softc *, struct eso_dma *));",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_mmap",
          "args": [
            "sc->sc_dmat",
            "ed->ed_segs",
            "ed->ed_nsegs",
            "offs",
            "prot",
            "BUS_DMA_WAITOK"
          ],
          "line": 1618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KVADDR",
          "args": [
            "ed"
          ],
          "line": 1612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\neso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));\nHIDE void;\neso_freemem __P((struct eso_softc *, struct eso_dma *));\nvoid *hdl;\n\nHIDE int\neso_mappage(hdl, addr, offs, prot)\n\tvoid *hdl;\n\tvoid *addr;\n\tint offs;\n\tint prot;\n{\n\tstruct eso_softc *sc = hdl;\n\tstruct eso_dma *ed;\n\n\tif (offs < 0)\n\t\treturn (-1);\n\tfor (ed = sc->sc_dmas; ed != NULL && KVADDR(ed) == addr;\n\t     ed = ed->ed_next)\n\t\t;\n\tif (ed == NULL)\n\t\treturn (-1);\n\t\n\treturn (bus_dmamem_mmap(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs,\n\t    offs, prot, BUS_DMA_WAITOK));\n}"
  },
  {
    "function_name": "eso_round_buffersize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1578-1598",
    "snippet": "u_long\neso_round_buffersize(hdl, bufsize)\n#else\nHIDE size_t\neso_round_buffersize(hdl, direction, bufsize)\n#endif\n\tvoid *hdl;\n#ifdef __OpenBSD__\n\tu_long bufsize;\n#else\n\tint direction;\n\tsize_t bufsize;\n#endif\n{\n\n\t/* 64K restriction: ISA at eleven? */\n\tif (bufsize > 65536)\n\t\tbufsize = 65536;\n\n\treturn (bufsize);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nu_long\neso_round_buffersize(hdl, bufsize)\n#else\nHIDE size_t\neso_round_buffersize(hdl, direction, bufsize)\n#endif\n\tvoid *hdl;\n#ifdef __OpenBSD__\n\tu_long bufsize;\n#else\n\tint direction;\n\tsize_t bufsize;\n#endif\n{\n\n\t/* 64K restriction: ISA at eleven? */\n\tif (bufsize > 65536)\n\t\tbufsize = 65536;\n\n\treturn (bufsize);\n}"
  },
  {
    "function_name": "eso_freem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1558-1575",
    "snippet": "HIDE void\neso_freem(hdl, addr, type)\n\tvoid *hdl;\n\tvoid *addr;\n\tint type;\n{\n\tstruct eso_softc *sc;\n\tstruct eso_dma *p, **pp;\n\n\tfor (pp = &sc->sc_dmas; (p = *pp) != NULL; pp = &p->ed_next) {\n\t\tif (KVADDR(p) == addr) {\n\t\t\teso_freemem(sc, p);\n\t\t\t*pp = p->ed_next;\n\t\t\tfree(p, type);\n\t\t\treturn;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "eso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));",
      "HIDE void",
      "eso_freemem __P((struct eso_softc *, struct eso_dma *));",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "p",
            "type"
          ],
          "line": 1571
        },
        "resolved": true,
        "details": {
          "function_name": "eso_freem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "1558-1575",
          "snippet": "HIDE void\neso_freem(hdl, addr, type)\n\tvoid *hdl;\n\tvoid *addr;\n\tint type;\n{\n\tstruct eso_softc *sc;\n\tstruct eso_dma *p, **pp;\n\n\tfor (pp = &sc->sc_dmas; (p = *pp) != NULL; pp = &p->ed_next) {\n\t\tif (KVADDR(p) == addr) {\n\t\t\teso_freemem(sc, p);\n\t\t\t*pp = p->ed_next;\n\t\t\tfree(p, type);\n\t\t\treturn;\n\t\t}\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "eso_freemem",
          "args": [
            "sc",
            "p"
          ],
          "line": 1569
        },
        "resolved": true,
        "details": {
          "function_name": "eso_freemem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "1497-1507",
          "snippet": "HIDE void\neso_freemem(sc, ed)\n\tstruct eso_softc *sc;\n\tstruct eso_dma *ed;\n{\n\n\tbus_dmamap_unload(sc->sc_dmat, ed->ed_map);\n\tbus_dmamap_destroy(sc->sc_dmat, ed->ed_map);\n\tbus_dmamem_unmap(sc->sc_dmat, ed->ed_addr, ed->ed_size);\n\tbus_dmamem_free(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "eso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));",
            "HIDE void",
            "eso_freemem __P((struct eso_softc *, struct eso_dma *));"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\neso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));\nHIDE void;\neso_freemem __P((struct eso_softc *, struct eso_dma *));\n\nHIDE void\neso_freemem(sc, ed)\n\tstruct eso_softc *sc;\n\tstruct eso_dma *ed;\n{\n\n\tbus_dmamap_unload(sc->sc_dmat, ed->ed_map);\n\tbus_dmamap_destroy(sc->sc_dmat, ed->ed_map);\n\tbus_dmamem_unmap(sc->sc_dmat, ed->ed_addr, ed->ed_size);\n\tbus_dmamem_free(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "KVADDR",
          "args": [
            "p"
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\neso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));\nHIDE void;\neso_freemem __P((struct eso_softc *, struct eso_dma *));\nvoid *hdl;\n\nHIDE void\neso_freem(hdl, addr, type)\n\tvoid *hdl;\n\tvoid *addr;\n\tint type;\n{\n\tstruct eso_softc *sc;\n\tstruct eso_dma *p, **pp;\n\n\tfor (pp = &sc->sc_dmas; (p = *pp) != NULL; pp = &p->ed_next) {\n\t\tif (KVADDR(p) == addr) {\n\t\t\teso_freemem(sc, p);\n\t\t\t*pp = p->ed_next;\n\t\t\tfree(p, type);\n\t\t\treturn;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "eso_freemem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1497-1507",
    "snippet": "HIDE void\neso_freemem(sc, ed)\n\tstruct eso_softc *sc;\n\tstruct eso_dma *ed;\n{\n\n\tbus_dmamap_unload(sc->sc_dmat, ed->ed_map);\n\tbus_dmamap_destroy(sc->sc_dmat, ed->ed_map);\n\tbus_dmamem_unmap(sc->sc_dmat, ed->ed_addr, ed->ed_size);\n\tbus_dmamem_free(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "eso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));",
      "HIDE void",
      "eso_freemem __P((struct eso_softc *, struct eso_dma *));"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_free",
          "args": [
            "sc->sc_dmat",
            "ed->ed_segs",
            "ed->ed_nsegs"
          ],
          "line": 1506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamem_unmap",
          "args": [
            "sc->sc_dmat",
            "ed->ed_addr",
            "ed->ed_size"
          ],
          "line": 1505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_destroy",
          "args": [
            "sc->sc_dmat",
            "ed->ed_map"
          ],
          "line": 1504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_unload",
          "args": [
            "sc->sc_dmat",
            "ed->ed_map"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\neso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));\nHIDE void;\neso_freemem __P((struct eso_softc *, struct eso_dma *));\n\nHIDE void\neso_freemem(sc, ed)\n\tstruct eso_softc *sc;\n\tstruct eso_dma *ed;\n{\n\n\tbus_dmamap_unload(sc->sc_dmat, ed->ed_map);\n\tbus_dmamap_destroy(sc->sc_dmat, ed->ed_map);\n\tbus_dmamem_unmap(sc->sc_dmat, ed->ed_addr, ed->ed_size);\n\tbus_dmamem_free(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs);\n}"
  },
  {
    "function_name": "eso_allocmem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1450-1495",
    "snippet": "HIDE int\neso_allocmem(sc, size, align, boundary, flags, ed)\n\tstruct eso_softc *sc;\n\tsize_t size;\n\tsize_t align;\n\tsize_t boundary;\n\tint flags;\n\tstruct eso_dma *ed;\n{\n\tint error, wait;\n\n\twait = (flags & M_NOWAIT) ? BUS_DMA_NOWAIT : BUS_DMA_WAITOK;\n\ted->ed_size = size;\n\t\n\terror = bus_dmamem_alloc(sc->sc_dmat, ed->ed_size, align, boundary,\n\t    ed->ed_segs, sizeof (ed->ed_segs) / sizeof (ed->ed_segs[0]),\n\t    &ed->ed_nsegs, wait);\n\tif (error)\n\t\tgoto out;\n\n\terror = bus_dmamem_map(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs,\n\t    ed->ed_size, &ed->ed_addr, wait | BUS_DMA_COHERENT);\n\tif (error)\n\t\tgoto free;\n\n\terror = bus_dmamap_create(sc->sc_dmat, ed->ed_size, 1, ed->ed_size, 0,\n\t    wait, &ed->ed_map);\n\tif (error)\n\t\tgoto unmap;\n\n\terror = bus_dmamap_load(sc->sc_dmat, ed->ed_map, ed->ed_addr,\n\t    ed->ed_size, NULL, wait);\n\tif (error)\n\t\tgoto destroy;\n\n\treturn (0);\n\n destroy:\n\tbus_dmamap_destroy(sc->sc_dmat, ed->ed_map);\n unmap:\n\tbus_dmamem_unmap(sc->sc_dmat, ed->ed_addr, ed->ed_size);\n free:\n\tbus_dmamem_free(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs);\n out:\n\treturn (error);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "eso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));",
      "HIDE void",
      "eso_freemem __P((struct eso_softc *, struct eso_dma *));",
      "int type, flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_dmamem_free",
          "args": [
            "sc->sc_dmat",
            "ed->ed_segs",
            "ed->ed_nsegs"
          ],
          "line": 1492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamem_unmap",
          "args": [
            "sc->sc_dmat",
            "ed->ed_addr",
            "ed->ed_size"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_destroy",
          "args": [
            "sc->sc_dmat",
            "ed->ed_map"
          ],
          "line": 1488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_load",
          "args": [
            "sc->sc_dmat",
            "ed->ed_map",
            "ed->ed_addr",
            "ed->ed_size",
            "NULL",
            "wait"
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamap_create",
          "args": [
            "sc->sc_dmat",
            "ed->ed_size",
            "1",
            "ed->ed_size",
            "0",
            "wait",
            "&ed->ed_map"
          ],
          "line": 1475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamem_map",
          "args": [
            "sc->sc_dmat",
            "ed->ed_segs",
            "ed->ed_nsegs",
            "ed->ed_size",
            "&ed->ed_addr",
            "wait | BUS_DMA_COHERENT"
          ],
          "line": 1470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_dmamem_alloc",
          "args": [
            "sc->sc_dmat",
            "ed->ed_size",
            "align",
            "boundary",
            "ed->ed_segs",
            "sizeof (ed->ed_segs) / sizeof (ed->ed_segs[0])",
            "&ed->ed_nsegs",
            "wait"
          ],
          "line": 1464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\neso_allocmem __P((struct eso_softc *, size_t, size_t, size_t,\n\t\t    int, struct eso_dma *));\nHIDE void;\neso_freemem __P((struct eso_softc *, struct eso_dma *));\nint type, flags;\n\nHIDE int\neso_allocmem(sc, size, align, boundary, flags, ed)\n\tstruct eso_softc *sc;\n\tsize_t size;\n\tsize_t align;\n\tsize_t boundary;\n\tint flags;\n\tstruct eso_dma *ed;\n{\n\tint error, wait;\n\n\twait = (flags & M_NOWAIT) ? BUS_DMA_NOWAIT : BUS_DMA_WAITOK;\n\ted->ed_size = size;\n\t\n\terror = bus_dmamem_alloc(sc->sc_dmat, ed->ed_size, align, boundary,\n\t    ed->ed_segs, sizeof (ed->ed_segs) / sizeof (ed->ed_segs[0]),\n\t    &ed->ed_nsegs, wait);\n\tif (error)\n\t\tgoto out;\n\n\terror = bus_dmamem_map(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs,\n\t    ed->ed_size, &ed->ed_addr, wait | BUS_DMA_COHERENT);\n\tif (error)\n\t\tgoto free;\n\n\terror = bus_dmamap_create(sc->sc_dmat, ed->ed_size, 1, ed->ed_size, 0,\n\t    wait, &ed->ed_map);\n\tif (error)\n\t\tgoto unmap;\n\n\terror = bus_dmamap_load(sc->sc_dmat, ed->ed_map, ed->ed_addr,\n\t    ed->ed_size, NULL, wait);\n\tif (error)\n\t\tgoto destroy;\n\n\treturn (0);\n\n destroy:\n\tbus_dmamap_destroy(sc->sc_dmat, ed->ed_map);\n unmap:\n\tbus_dmamem_unmap(sc->sc_dmat, ed->ed_addr, ed->ed_size);\n free:\n\tbus_dmamem_free(sc->sc_dmat, ed->ed_segs, ed->ed_nsegs);\n out:\n\treturn (error);\n}"
  },
  {
    "function_name": "eso_query_devinfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1193-1448",
    "snippet": "HIDE int\neso_query_devinfo(hdl, dip)\n\tvoid *hdl;\n\tmixer_devinfo_t *dip;\n{\n\n\tswitch (dip->index) {\n\tcase ESO_DAC_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNdac);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MIC_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_LINE_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNline);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_SYNTH_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNfmsynth);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MONO_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"mono_in\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_CD_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNcd);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_AUXB_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"auxb\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ESO_MIC_PREAMP:\n\t\tdip->mixer_class = ESO_MICROPHONE_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNpreamp);\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\tbreak;\n\tcase ESO_MICROPHONE_CLASS:\n\t\tdip->mixer_class = ESO_MICROPHONE_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\t\t\n\tcase ESO_INPUT_CLASS:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCinputs);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\t\t\n\tcase ESO_MASTER_VOL:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmaster);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_PCSPEAKER_VOL:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"pc_speaker\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MONOOUT_SOURCE:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"mono_out\");\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 3;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNmute);\n\t\tdip->un.e.member[0].ord = ESO_MIXREG_MPM_MOMUTE;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNdac);\n\t\tdip->un.e.member[1].ord = ESO_MIXREG_MPM_MOA2R;\n\t\tstrcpy(dip->un.e.member[2].label.name, AudioNmixerout);\n\t\tdip->un.e.member[2].ord = ESO_MIXREG_MPM_MOREC;\n\t\tbreak;\n\tcase ESO_SPATIALIZER:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = ESO_SPATIALIZER_ENABLE;\n\t\tstrcpy(dip->label.name, AudioNspatial);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, \"level\");\n\t\tbreak;\n\tcase ESO_SPATIALIZER_ENABLE:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->prev = ESO_SPATIALIZER;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"enable\");\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\tbreak;\n\t\n\tcase ESO_OUTPUT_CLASS:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCoutputs);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\n\tcase ESO_RECORD_MONITOR:\n\t\tdip->mixer_class = ESO_MONITOR_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmute);\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\tbreak;\n\tcase ESO_MONITOR_CLASS:\n\t\tdip->mixer_class = ESO_MONITOR_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCmonitor);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\n\tcase ESO_RECORD_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNrecord);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_RECORD_SOURCE:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNsource);\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 4;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNmicrophone);\n\t\tdip->un.e.member[0].ord = ESO_MIXREG_ERS_MIC;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNline);\n\t\tdip->un.e.member[1].ord = ESO_MIXREG_ERS_LINE;\n\t\tstrcpy(dip->un.e.member[2].label.name, AudioNcd);\n\t\tdip->un.e.member[2].ord = ESO_MIXREG_ERS_CD;\n\t\tstrcpy(dip->un.e.member[3].label.name, AudioNmixerout);\n\t\tdip->un.e.member[3].ord = ESO_MIXREG_ERS_MIXER;\n\t\tbreak;\n\tcase ESO_DAC_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNdac);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MIC_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_LINE_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNline);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_SYNTH_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNfmsynth);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MONO_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"mono_in\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 1; /* No lies */\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_CD_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNcd);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_AUXB_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"auxb\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_RECORD_CLASS:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCrecord);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\t\t\n\tdefault:\n\t\treturn (ENXIO);\n\t}\n\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "eso_query_devinfo __P((void *, mixer_devinfo_t *));",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCrecord"
          ],
          "line": 1439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"auxb\""
          ],
          "line": 1431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNcd"
          ],
          "line": 1423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"mono_in\""
          ],
          "line": 1415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNfmsynth"
          ],
          "line": 1407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNline"
          ],
          "line": 1399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmicrophone"
          ],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNdac"
          ],
          "line": 1383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[3].label.name",
            "AudioNmixerout"
          ],
          "line": 1377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[2].label.name",
            "AudioNcd"
          ],
          "line": 1375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNline"
          ],
          "line": 1373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNmicrophone"
          ],
          "line": 1371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNsource"
          ],
          "line": 1368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNrecord"
          ],
          "line": 1361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCmonitor"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNon"
          ],
          "line": 1348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNoff"
          ],
          "line": 1346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmute"
          ],
          "line": 1343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCoutputs"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNon"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNoff"
          ],
          "line": 1327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"enable\""
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "\"level\""
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNspatial"
          ],
          "line": 1315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[2].label.name",
            "AudioNmixerout"
          ],
          "line": 1308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNdac"
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNmute"
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"mono_out\""
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"pc_speaker\""
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmaster"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioCinputs"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmicrophone"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[1].label.name",
            "AudioNon"
          ],
          "line": 1265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.e.member[0].label.name",
            "AudioNoff"
          ],
          "line": 1263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNpreamp"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"auxb\""
          ],
          "line": 1251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNcd"
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "\"mono_in\""
          ],
          "line": 1235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNfmsynth"
          ],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNline"
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNmicrophone"
          ],
          "line": 1211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->un.v.units.name",
            "AudioNvolume"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "dip->label.name",
            "AudioNdac"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\neso_query_devinfo __P((void *, mixer_devinfo_t *));\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_query_devinfo(hdl, dip)\n\tvoid *hdl;\n\tmixer_devinfo_t *dip;\n{\n\n\tswitch (dip->index) {\n\tcase ESO_DAC_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNdac);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MIC_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_LINE_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNline);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_SYNTH_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNfmsynth);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MONO_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"mono_in\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_CD_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNcd);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_AUXB_PLAY_VOL:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"auxb\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\n\tcase ESO_MIC_PREAMP:\n\t\tdip->mixer_class = ESO_MICROPHONE_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNpreamp);\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\tbreak;\n\tcase ESO_MICROPHONE_CLASS:\n\t\tdip->mixer_class = ESO_MICROPHONE_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\t\t\n\tcase ESO_INPUT_CLASS:\n\t\tdip->mixer_class = ESO_INPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCinputs);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\t\t\n\tcase ESO_MASTER_VOL:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmaster);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_PCSPEAKER_VOL:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"pc_speaker\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MONOOUT_SOURCE:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"mono_out\");\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 3;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNmute);\n\t\tdip->un.e.member[0].ord = ESO_MIXREG_MPM_MOMUTE;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNdac);\n\t\tdip->un.e.member[1].ord = ESO_MIXREG_MPM_MOA2R;\n\t\tstrcpy(dip->un.e.member[2].label.name, AudioNmixerout);\n\t\tdip->un.e.member[2].ord = ESO_MIXREG_MPM_MOREC;\n\t\tbreak;\n\tcase ESO_SPATIALIZER:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->prev = AUDIO_MIXER_LAST;\n\t\tdip->next = ESO_SPATIALIZER_ENABLE;\n\t\tstrcpy(dip->label.name, AudioNspatial);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 1;\n\t\tstrcpy(dip->un.v.units.name, \"level\");\n\t\tbreak;\n\tcase ESO_SPATIALIZER_ENABLE:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->prev = ESO_SPATIALIZER;\n\t\tdip->next = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"enable\");\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\tbreak;\n\t\n\tcase ESO_OUTPUT_CLASS:\n\t\tdip->mixer_class = ESO_OUTPUT_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCoutputs);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\n\tcase ESO_RECORD_MONITOR:\n\t\tdip->mixer_class = ESO_MONITOR_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmute);\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 2;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNoff);\n\t\tdip->un.e.member[0].ord = 0;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNon);\n\t\tdip->un.e.member[1].ord = 1;\n\t\tbreak;\n\tcase ESO_MONITOR_CLASS:\n\t\tdip->mixer_class = ESO_MONITOR_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCmonitor);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\n\tcase ESO_RECORD_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNrecord);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_RECORD_SOURCE:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNsource);\n\t\tdip->type = AUDIO_MIXER_ENUM;\n\t\tdip->un.e.num_mem = 4;\n\t\tstrcpy(dip->un.e.member[0].label.name, AudioNmicrophone);\n\t\tdip->un.e.member[0].ord = ESO_MIXREG_ERS_MIC;\n\t\tstrcpy(dip->un.e.member[1].label.name, AudioNline);\n\t\tdip->un.e.member[1].ord = ESO_MIXREG_ERS_LINE;\n\t\tstrcpy(dip->un.e.member[2].label.name, AudioNcd);\n\t\tdip->un.e.member[2].ord = ESO_MIXREG_ERS_CD;\n\t\tstrcpy(dip->un.e.member[3].label.name, AudioNmixerout);\n\t\tdip->un.e.member[3].ord = ESO_MIXREG_ERS_MIXER;\n\t\tbreak;\n\tcase ESO_DAC_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNdac);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MIC_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNmicrophone);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_LINE_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNline);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_SYNTH_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNfmsynth);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_MONO_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"mono_in\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 1; /* No lies */\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_CD_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioNcd);\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_AUXB_REC_VOL:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, \"auxb\");\n\t\tdip->type = AUDIO_MIXER_VALUE;\n\t\tdip->un.v.num_channels = 2;\n\t\tstrcpy(dip->un.v.units.name, AudioNvolume);\n\t\tbreak;\n\tcase ESO_RECORD_CLASS:\n\t\tdip->mixer_class = ESO_RECORD_CLASS;\n\t\tdip->next = dip->prev = AUDIO_MIXER_LAST;\n\t\tstrcpy(dip->label.name, AudioCrecord);\n\t\tdip->type = AUDIO_MIXER_CLASS;\n\t\tbreak;\n\t\t\n\tdefault:\n\t\treturn (ENXIO);\n\t}\n\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_get_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "1111-1191",
    "snippet": "HIDE int\neso_get_port(hdl, cp)\n\tvoid *hdl;\n\tmixer_ctrl_t *cp;\n{\n\tstruct eso_softc *sc = hdl;\n\n\tswitch (cp->dev) {\n\tcase ESO_DAC_PLAY_VOL:\n\tcase ESO_MIC_PLAY_VOL:\n\tcase ESO_LINE_PLAY_VOL:\n\tcase ESO_SYNTH_PLAY_VOL:\n\tcase ESO_CD_PLAY_VOL:\n\tcase ESO_AUXB_PLAY_VOL:\n\tcase ESO_MASTER_VOL:\n\tcase ESO_RECORD_VOL:\n\tcase ESO_DAC_REC_VOL:\n\tcase ESO_MIC_REC_VOL:\n\tcase ESO_LINE_REC_VOL:\n\tcase ESO_SYNTH_REC_VOL:\n\tcase ESO_CD_REC_VOL:\n\tcase ESO_AUXB_REC_VOL:\n\t\t/*\n\t\t * Stereo-capable ports: if a single-channel query is made,\n\t\t * just return the left channel's value (since single-channel\n\t\t * settings themselves are applied to both channels).\n\t\t */\n\t\tswitch (cp->un.value.num_channels) {\n\t\tcase 1:\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO] =\n\t\t\t    sc->sc_gain[cp->dev][ESO_LEFT];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_LEFT] =\n\t\t\t    sc->sc_gain[cp->dev][ESO_LEFT];\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT] =\n\t\t\t    sc->sc_gain[cp->dev][ESO_RIGHT];\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\t\tbreak;\n\t\t\n\tcase ESO_MONO_PLAY_VOL:\n\tcase ESO_PCSPEAKER_VOL:\n\tcase ESO_MONO_REC_VOL:\n\tcase ESO_SPATIALIZER:\n\t\tif (cp->un.value.num_channels != 1)\n\t\t\treturn (EINVAL);\n\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO] =\n\t\t    sc->sc_gain[cp->dev][ESO_LEFT];\n\t\tbreak;\n\n\tcase ESO_RECORD_MONITOR:\n\t\tcp->un.ord = sc->sc_recmon;\n\t\tbreak;\n\t\t\n\tcase ESO_RECORD_SOURCE:\n\t\tcp->un.ord = sc->sc_recsrc;\n\t\tbreak;\n\n\tcase ESO_MONOOUT_SOURCE:\n\t\tcp->un.ord = sc->sc_monooutsrc;\n\t\tbreak;\n\t\t\n\tcase ESO_SPATIALIZER_ENABLE:\n\t\tcp->un.ord = sc->sc_spatializer;\n\t\tbreak;\n\t\t\n\tcase ESO_MIC_PREAMP:\n\t\tcp->un.ord = sc->sc_preamp;\n\t\tbreak;\n\n\tdefault:\n\t\treturn (EINVAL);\n\t}\n\n\n\treturn (0);\n\t\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "eso_set_port __P((void *, mixer_ctrl_t *));",
      "HIDE int",
      "eso_get_port __P((void *, mixer_ctrl_t *));",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\neso_set_port __P((void *, mixer_ctrl_t *));\nHIDE int;\neso_get_port __P((void *, mixer_ctrl_t *));\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_get_port(hdl, cp)\n\tvoid *hdl;\n\tmixer_ctrl_t *cp;\n{\n\tstruct eso_softc *sc = hdl;\n\n\tswitch (cp->dev) {\n\tcase ESO_DAC_PLAY_VOL:\n\tcase ESO_MIC_PLAY_VOL:\n\tcase ESO_LINE_PLAY_VOL:\n\tcase ESO_SYNTH_PLAY_VOL:\n\tcase ESO_CD_PLAY_VOL:\n\tcase ESO_AUXB_PLAY_VOL:\n\tcase ESO_MASTER_VOL:\n\tcase ESO_RECORD_VOL:\n\tcase ESO_DAC_REC_VOL:\n\tcase ESO_MIC_REC_VOL:\n\tcase ESO_LINE_REC_VOL:\n\tcase ESO_SYNTH_REC_VOL:\n\tcase ESO_CD_REC_VOL:\n\tcase ESO_AUXB_REC_VOL:\n\t\t/*\n\t\t * Stereo-capable ports: if a single-channel query is made,\n\t\t * just return the left channel's value (since single-channel\n\t\t * settings themselves are applied to both channels).\n\t\t */\n\t\tswitch (cp->un.value.num_channels) {\n\t\tcase 1:\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO] =\n\t\t\t    sc->sc_gain[cp->dev][ESO_LEFT];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_LEFT] =\n\t\t\t    sc->sc_gain[cp->dev][ESO_LEFT];\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT] =\n\t\t\t    sc->sc_gain[cp->dev][ESO_RIGHT];\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\t\tbreak;\n\t\t\n\tcase ESO_MONO_PLAY_VOL:\n\tcase ESO_PCSPEAKER_VOL:\n\tcase ESO_MONO_REC_VOL:\n\tcase ESO_SPATIALIZER:\n\t\tif (cp->un.value.num_channels != 1)\n\t\t\treturn (EINVAL);\n\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO] =\n\t\t    sc->sc_gain[cp->dev][ESO_LEFT];\n\t\tbreak;\n\n\tcase ESO_RECORD_MONITOR:\n\t\tcp->un.ord = sc->sc_recmon;\n\t\tbreak;\n\t\t\n\tcase ESO_RECORD_SOURCE:\n\t\tcp->un.ord = sc->sc_recsrc;\n\t\tbreak;\n\n\tcase ESO_MONOOUT_SOURCE:\n\t\tcp->un.ord = sc->sc_monooutsrc;\n\t\tbreak;\n\t\t\n\tcase ESO_SPATIALIZER_ENABLE:\n\t\tcp->un.ord = sc->sc_spatializer;\n\t\tbreak;\n\t\t\n\tcase ESO_MIC_PREAMP:\n\t\tcp->un.ord = sc->sc_preamp;\n\t\tbreak;\n\n\tdefault:\n\t\treturn (EINVAL);\n\t}\n\n\n\treturn (0);\n\t\n}"
  },
  {
    "function_name": "eso_set_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "929-1109",
    "snippet": "HIDE int\neso_set_port(hdl, cp)\n\tvoid *hdl;\n\tmixer_ctrl_t *cp;\n{\n\tstruct eso_softc *sc = hdl;\n\tunsigned int lgain, rgain;\n\tuint8_t tmp;\n\t\n\tswitch (cp->dev) {\n\tcase ESO_DAC_PLAY_VOL:\n\tcase ESO_MIC_PLAY_VOL:\n\tcase ESO_LINE_PLAY_VOL:\n\tcase ESO_SYNTH_PLAY_VOL:\n\tcase ESO_CD_PLAY_VOL:\n\tcase ESO_AUXB_PLAY_VOL:\n\tcase ESO_RECORD_VOL:\n\tcase ESO_DAC_REC_VOL:\n\tcase ESO_MIC_REC_VOL:\n\tcase ESO_LINE_REC_VOL:\n\tcase ESO_SYNTH_REC_VOL:\n\tcase ESO_CD_REC_VOL:\n\tcase ESO_AUXB_REC_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE)\n\t\t\treturn (EINVAL);\n\t\t\n\t\t/*\n\t\t * Stereo-capable mixer ports: if we get a single-channel\n\t\t * gain value passed in, then we duplicate it to both left\n\t\t * and right channels.\n\t\t */\n\t\tswitch (cp->un.value.num_channels) {\n\t\tcase 1:\n\t\t\tlgain = rgain = ESO_GAIN_TO_4BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tlgain = ESO_GAIN_TO_4BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]);\n\t\t\trgain = ESO_GAIN_TO_4BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] = lgain;\n\t\tsc->sc_gain[cp->dev][ESO_RIGHT] = rgain;\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\n\tcase ESO_MASTER_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE)\n\t\t\treturn (EINVAL);\n\n\t\t/* Like above, but a precision of 6 bits. */\n\t\tswitch (cp->un.value.num_channels) {\n\t\tcase 1:\n\t\t\tlgain = rgain = ESO_GAIN_TO_6BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tlgain = ESO_GAIN_TO_6BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]);\n\t\t\trgain = ESO_GAIN_TO_6BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] = lgain;\n\t\tsc->sc_gain[cp->dev][ESO_RIGHT] = rgain;\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\n\tcase ESO_SPATIALIZER:\n\t\tif (cp->type != AUDIO_MIXER_VALUE ||\n\t\t    cp->un.value.num_channels != 1)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] =\n\t\t    sc->sc_gain[cp->dev][ESO_RIGHT] =\n\t\t    ESO_GAIN_TO_6BIT(\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\t\t\n\tcase ESO_MONO_PLAY_VOL:\n\tcase ESO_MONO_REC_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE ||\n\t\t    cp->un.value.num_channels != 1)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] =\n\t\t    sc->sc_gain[cp->dev][ESO_RIGHT] =\n\t\t    ESO_GAIN_TO_4BIT(\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\t\t\n\tcase ESO_PCSPEAKER_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE ||\n\t\t    cp->un.value.num_channels != 1)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] =\n\t\t    sc->sc_gain[cp->dev][ESO_RIGHT] =\n\t\t    ESO_GAIN_TO_3BIT(\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\n\tcase ESO_SPATIALIZER_ENABLE:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_spatializer = (cp->un.ord != 0);\n\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_SPAT);\n\t\tif (sc->sc_spatializer)\n\t\t\ttmp |= ESO_MIXREG_SPAT_ENB;\n\t\telse\n\t\t\ttmp &= ~ESO_MIXREG_SPAT_ENB;\n\t\teso_write_mixreg(sc, ESO_MIXREG_SPAT,\n\t\t    tmp | ESO_MIXREG_SPAT_RSTREL);\n\t\tbreak;\n\t\t\n\tcase ESO_MONOOUT_SOURCE:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_monooutsrc = cp->un.ord;\n\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_MPM);\n\t\ttmp &= ~ESO_MIXREG_MPM_MOMASK;\n\t\ttmp |= sc->sc_monooutsrc;\n\t\teso_write_mixreg(sc, ESO_MIXREG_MPM, tmp);\n\t\tbreak;\n\t\t\n\tcase ESO_RECORD_MONITOR:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_recmon = (cp->un.ord != 0);\n\t\t\n\t\ttmp = eso_read_ctlreg(sc, ESO_CTLREG_ACTL);\n\t\tif (sc->sc_recmon)\n\t\t\ttmp |= ESO_CTLREG_ACTL_RECMON;\n\t\telse\n\t\t\ttmp &= ~ESO_CTLREG_ACTL_RECMON;\n\t\teso_write_ctlreg(sc, ESO_CTLREG_ACTL, tmp);\n\t\tbreak;\n\n\tcase ESO_RECORD_SOURCE:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\treturn (eso_set_recsrc(sc, cp->un.ord));\n\n\tcase ESO_MIC_PREAMP:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_preamp = (cp->un.ord != 0);\n\t\t\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_MPM);\n\t\ttmp &= ~ESO_MIXREG_MPM_RESV0;\n\t\tif (sc->sc_preamp)\n\t\t\ttmp |= ESO_MIXREG_MPM_PREAMP;\n\t\telse\n\t\t\ttmp &= ~ESO_MIXREG_MPM_PREAMP;\n\t\teso_write_mixreg(sc, ESO_MIXREG_MPM, tmp);\n\t\tbreak;\n\t\t\n\tdefault:\n\t\treturn (EINVAL);\n\t}\n\t\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "eso_set_port __P((void *, mixer_ctrl_t *));",
      "HIDE int",
      "eso_get_port __P((void *, mixer_ctrl_t *));",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_MPM",
            "tmp"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_read_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_MPM"
          ],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "eso_read_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "520-534",
          "snippet": "HIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_set_recsrc",
          "args": [
            "sc",
            "cp->un.ord"
          ],
          "line": 1087
        },
        "resolved": true,
        "details": {
          "function_name": "eso_set_recsrc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "1805-1814",
          "snippet": "HIDE int\neso_set_recsrc(sc, recsrc)\n\tstruct eso_softc *sc;\n\tunsigned int recsrc;\n{\n\n\teso_write_mixreg(sc, ESO_MIXREG_ERS, recsrc);\n\tsc->sc_recsrc = recsrc;\n\treturn (0);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\n\nHIDE int\neso_set_recsrc(sc, recsrc)\n\tstruct eso_softc *sc;\n\tunsigned int recsrc;\n{\n\n\teso_write_mixreg(sc, ESO_MIXREG_ERS, recsrc);\n\tsc->sc_recsrc = recsrc;\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_write_ctlreg",
          "args": [
            "sc",
            "ESO_CTLREG_ACTL",
            "tmp"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_ctlreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "460-470",
          "snippet": "HIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_read_ctlreg",
          "args": [
            "sc",
            "ESO_CTLREG_ACTL"
          ],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "eso_read_ctlreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "494-503",
          "snippet": "HIDE uint8_t\neso_read_ctlreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\n\teso_write_cmd(sc, ESO_CMD_RCR);\n\teso_write_cmd(sc, reg);\n\treturn (eso_read_rdr(sc));\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_ctlreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\n\teso_write_cmd(sc, ESO_CMD_RCR);\n\teso_write_cmd(sc, reg);\n\treturn (eso_read_rdr(sc));\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_set_gain",
          "args": [
            "sc",
            "cp->dev"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "eso_set_gain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "1816-1909",
          "snippet": "HIDE void\neso_set_gain(sc, port)\n\tstruct eso_softc *sc;\n\tunsigned int port;\n{\n\tuint8_t mixreg, tmp;\n\n\tswitch (port) {\n\tcase ESO_DAC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_AUXB;\n\t\tbreak;\n\t\t    \n\tcase ESO_DAC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_AUXB;\n\t\tbreak;\n\tcase ESO_MONO_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MONO;\n\t\tbreak;\n\tcase ESO_MONO_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MONO;\n\t\tbreak;\n\t\t\n\tcase ESO_PCSPEAKER_VOL:\n\t\t/* Special case - only 3-bit, mono, and reserved bits. */\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_PCSVR);\n\t\ttmp &= ESO_MIXREG_PCSVR_RESV;\n\t\t/* Map bits 7:5 -> 2:0. */\n\t\ttmp |= (sc->sc_gain[port][ESO_LEFT] >> 5);\n\t\teso_write_mixreg(sc, ESO_MIXREG_PCSVR, tmp);\n\t\treturn;\n\n\tcase ESO_MASTER_VOL:\n\t\t/* Special case - separate regs, and 6-bit precision. */\n\t\t/* Map bits 7:2 -> 5:0. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_LMVM,\n\t\t    sc->sc_gain[port][ESO_LEFT] >> 2);\n\t\teso_write_mixreg(sc, ESO_MIXREG_RMVM,\n\t\t    sc->sc_gain[port][ESO_RIGHT] >> 2);\n\t\treturn;\n\n\tcase ESO_SPATIALIZER:\n\t\t/* Special case - only `mono', and higher precision. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_SPATLVL,\n\t\t    sc->sc_gain[port][ESO_LEFT]);\n\t\treturn;\n\t\t\n\tcase ESO_RECORD_VOL:\n\t\t/* Very Special case, controller register. */\n\t\teso_write_ctlreg(sc, ESO_CTLREG_RECLVL,ESO_4BIT_GAIN_TO_STEREO(\n\t\t   sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n\t\treturn;\n\n\tdefault:\n#ifdef DIAGNOSTIC\t\t\n\t\tpanic(\"eso_set_gain: bad port %u\", port);\n\t\t/* NOTREACHED */\n#else\n\t\treturn;\n#endif\t\t\n\t\t}\n\n\teso_write_mixreg(sc, mixreg, ESO_4BIT_GAIN_TO_STEREO(\n\t    sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_set_gain(sc, port)\n\tstruct eso_softc *sc;\n\tunsigned int port;\n{\n\tuint8_t mixreg, tmp;\n\n\tswitch (port) {\n\tcase ESO_DAC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_AUXB;\n\t\tbreak;\n\t\t    \n\tcase ESO_DAC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_AUXB;\n\t\tbreak;\n\tcase ESO_MONO_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MONO;\n\t\tbreak;\n\tcase ESO_MONO_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MONO;\n\t\tbreak;\n\t\t\n\tcase ESO_PCSPEAKER_VOL:\n\t\t/* Special case - only 3-bit, mono, and reserved bits. */\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_PCSVR);\n\t\ttmp &= ESO_MIXREG_PCSVR_RESV;\n\t\t/* Map bits 7:5 -> 2:0. */\n\t\ttmp |= (sc->sc_gain[port][ESO_LEFT] >> 5);\n\t\teso_write_mixreg(sc, ESO_MIXREG_PCSVR, tmp);\n\t\treturn;\n\n\tcase ESO_MASTER_VOL:\n\t\t/* Special case - separate regs, and 6-bit precision. */\n\t\t/* Map bits 7:2 -> 5:0. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_LMVM,\n\t\t    sc->sc_gain[port][ESO_LEFT] >> 2);\n\t\teso_write_mixreg(sc, ESO_MIXREG_RMVM,\n\t\t    sc->sc_gain[port][ESO_RIGHT] >> 2);\n\t\treturn;\n\n\tcase ESO_SPATIALIZER:\n\t\t/* Special case - only `mono', and higher precision. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_SPATLVL,\n\t\t    sc->sc_gain[port][ESO_LEFT]);\n\t\treturn;\n\t\t\n\tcase ESO_RECORD_VOL:\n\t\t/* Very Special case, controller register. */\n\t\teso_write_ctlreg(sc, ESO_CTLREG_RECLVL,ESO_4BIT_GAIN_TO_STEREO(\n\t\t   sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n\t\treturn;\n\n\tdefault:\n#ifdef DIAGNOSTIC\t\t\n\t\tpanic(\"eso_set_gain: bad port %u\", port);\n\t\t/* NOTREACHED */\n#else\n\t\treturn;\n#endif\t\t\n\t\t}\n\n\teso_write_mixreg(sc, mixreg, ESO_4BIT_GAIN_TO_STEREO(\n\t    sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_3BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_4BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_6BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_6BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_6BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_6BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_4BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_4BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_4BIT",
          "args": [
            "cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\neso_set_port __P((void *, mixer_ctrl_t *));\nHIDE int;\neso_get_port __P((void *, mixer_ctrl_t *));\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_set_port(hdl, cp)\n\tvoid *hdl;\n\tmixer_ctrl_t *cp;\n{\n\tstruct eso_softc *sc = hdl;\n\tunsigned int lgain, rgain;\n\tuint8_t tmp;\n\t\n\tswitch (cp->dev) {\n\tcase ESO_DAC_PLAY_VOL:\n\tcase ESO_MIC_PLAY_VOL:\n\tcase ESO_LINE_PLAY_VOL:\n\tcase ESO_SYNTH_PLAY_VOL:\n\tcase ESO_CD_PLAY_VOL:\n\tcase ESO_AUXB_PLAY_VOL:\n\tcase ESO_RECORD_VOL:\n\tcase ESO_DAC_REC_VOL:\n\tcase ESO_MIC_REC_VOL:\n\tcase ESO_LINE_REC_VOL:\n\tcase ESO_SYNTH_REC_VOL:\n\tcase ESO_CD_REC_VOL:\n\tcase ESO_AUXB_REC_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE)\n\t\t\treturn (EINVAL);\n\t\t\n\t\t/*\n\t\t * Stereo-capable mixer ports: if we get a single-channel\n\t\t * gain value passed in, then we duplicate it to both left\n\t\t * and right channels.\n\t\t */\n\t\tswitch (cp->un.value.num_channels) {\n\t\tcase 1:\n\t\t\tlgain = rgain = ESO_GAIN_TO_4BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tlgain = ESO_GAIN_TO_4BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]);\n\t\t\trgain = ESO_GAIN_TO_4BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] = lgain;\n\t\tsc->sc_gain[cp->dev][ESO_RIGHT] = rgain;\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\n\tcase ESO_MASTER_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE)\n\t\t\treturn (EINVAL);\n\n\t\t/* Like above, but a precision of 6 bits. */\n\t\tswitch (cp->un.value.num_channels) {\n\t\tcase 1:\n\t\t\tlgain = rgain = ESO_GAIN_TO_6BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tlgain = ESO_GAIN_TO_6BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_LEFT]);\n\t\t\trgain = ESO_GAIN_TO_6BIT(\n\t\t\t    cp->un.value.level[AUDIO_MIXER_LEVEL_RIGHT]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] = lgain;\n\t\tsc->sc_gain[cp->dev][ESO_RIGHT] = rgain;\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\n\tcase ESO_SPATIALIZER:\n\t\tif (cp->type != AUDIO_MIXER_VALUE ||\n\t\t    cp->un.value.num_channels != 1)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] =\n\t\t    sc->sc_gain[cp->dev][ESO_RIGHT] =\n\t\t    ESO_GAIN_TO_6BIT(\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\t\t\n\tcase ESO_MONO_PLAY_VOL:\n\tcase ESO_MONO_REC_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE ||\n\t\t    cp->un.value.num_channels != 1)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] =\n\t\t    sc->sc_gain[cp->dev][ESO_RIGHT] =\n\t\t    ESO_GAIN_TO_4BIT(\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\t\t\n\tcase ESO_PCSPEAKER_VOL:\n\t\tif (cp->type != AUDIO_MIXER_VALUE ||\n\t\t    cp->un.value.num_channels != 1)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_gain[cp->dev][ESO_LEFT] =\n\t\t    sc->sc_gain[cp->dev][ESO_RIGHT] =\n\t\t    ESO_GAIN_TO_3BIT(\n\t\t\tcp->un.value.level[AUDIO_MIXER_LEVEL_MONO]);\n\t\teso_set_gain(sc, cp->dev);\n\t\tbreak;\n\n\tcase ESO_SPATIALIZER_ENABLE:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_spatializer = (cp->un.ord != 0);\n\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_SPAT);\n\t\tif (sc->sc_spatializer)\n\t\t\ttmp |= ESO_MIXREG_SPAT_ENB;\n\t\telse\n\t\t\ttmp &= ~ESO_MIXREG_SPAT_ENB;\n\t\teso_write_mixreg(sc, ESO_MIXREG_SPAT,\n\t\t    tmp | ESO_MIXREG_SPAT_RSTREL);\n\t\tbreak;\n\t\t\n\tcase ESO_MONOOUT_SOURCE:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_monooutsrc = cp->un.ord;\n\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_MPM);\n\t\ttmp &= ~ESO_MIXREG_MPM_MOMASK;\n\t\ttmp |= sc->sc_monooutsrc;\n\t\teso_write_mixreg(sc, ESO_MIXREG_MPM, tmp);\n\t\tbreak;\n\t\t\n\tcase ESO_RECORD_MONITOR:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_recmon = (cp->un.ord != 0);\n\t\t\n\t\ttmp = eso_read_ctlreg(sc, ESO_CTLREG_ACTL);\n\t\tif (sc->sc_recmon)\n\t\t\ttmp |= ESO_CTLREG_ACTL_RECMON;\n\t\telse\n\t\t\ttmp &= ~ESO_CTLREG_ACTL_RECMON;\n\t\teso_write_ctlreg(sc, ESO_CTLREG_ACTL, tmp);\n\t\tbreak;\n\n\tcase ESO_RECORD_SOURCE:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\treturn (eso_set_recsrc(sc, cp->un.ord));\n\n\tcase ESO_MIC_PREAMP:\n\t\tif (cp->type != AUDIO_MIXER_ENUM)\n\t\t\treturn (EINVAL);\n\n\t\tsc->sc_preamp = (cp->un.ord != 0);\n\t\t\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_MPM);\n\t\ttmp &= ~ESO_MIXREG_MPM_RESV0;\n\t\tif (sc->sc_preamp)\n\t\t\ttmp |= ESO_MIXREG_MPM_PREAMP;\n\t\telse\n\t\t\ttmp &= ~ESO_MIXREG_MPM_PREAMP;\n\t\teso_write_mixreg(sc, ESO_MIXREG_MPM, tmp);\n\t\tbreak;\n\t\t\n\tdefault:\n\t\treturn (EINVAL);\n\t}\n\t\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_getdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "904-927",
    "snippet": "HIDE int\neso_getdev(hdl, retp)\n\tvoid *hdl;\n\tstruct audio_device *retp;\n{\n\tstruct eso_softc *sc = hdl;\n\n\tstrncpy(retp->name, \"ESS Solo-1\", sizeof (retp->name));\n#ifdef __OpenBSD__\n\t/* This does not overflow. */\n\tsprintf(retp->version, \"0x%02x\", sc->sc_revision);\n#else\n\tsnprintf(retp->version, sizeof (retp->version), \"0x%02x\",\n\t    sc->sc_revision);\n#endif\n\tif (sc->sc_revision <=\n\t    sizeof (eso_rev2model) / sizeof (eso_rev2model[0]))\n\t\tstrncpy(retp->config, eso_rev2model[sc->sc_revision],\n\t\t    sizeof (retp->config));\n\telse\n\t\tstrncpy(retp->config, \"unknown\", sizeof (retp->config));\n\t\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "eso_getdev __P((void *, struct audio_device *));",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE const char * const eso_rev2model[] = {\n\t\"ES1938\",\n\t\"ES1946\",\n\t\"ES1946 rev E\"\n};",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "retp->config",
            "\"unknown\"",
            "sizeof (retp->config)"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "retp->config",
            "eso_rev2model[sc->sc_revision]",
            "sizeof (retp->config)"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "retp->version",
            "sizeof (retp->version)",
            "\"0x%02x\"",
            "sc->sc_revision"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "retp->version",
            "\"0x%02x\"",
            "sc->sc_revision"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "retp->name",
            "\"ESS Solo-1\"",
            "sizeof (retp->name)"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\neso_getdev __P((void *, struct audio_device *));\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE const char * const eso_rev2model[] = {\n\t\"ES1938\",\n\t\"ES1946\",\n\t\"ES1946 rev E\"\n};\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_getdev(hdl, retp)\n\tvoid *hdl;\n\tstruct audio_device *retp;\n{\n\tstruct eso_softc *sc = hdl;\n\n\tstrncpy(retp->name, \"ESS Solo-1\", sizeof (retp->name));\n#ifdef __OpenBSD__\n\t/* This does not overflow. */\n\tsprintf(retp->version, \"0x%02x\", sc->sc_revision);\n#else\n\tsnprintf(retp->version, sizeof (retp->version), \"0x%02x\",\n\t    sc->sc_revision);\n#endif\n\tif (sc->sc_revision <=\n\t    sizeof (eso_rev2model) / sizeof (eso_rev2model[0]))\n\t\tstrncpy(retp->config, eso_rev2model[sc->sc_revision],\n\t\t    sizeof (retp->config));\n\telse\n\t\tstrncpy(retp->config, \"unknown\", sizeof (retp->config));\n\t\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_halt_input",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "873-901",
    "snippet": "HIDE int\neso_halt_input(hdl)\n\tvoid *hdl;\n{\n\tstruct eso_softc *sc = hdl;\n\tint error, s;\n\t\n\tDPRINTF((\"%s: halt_input\\n\", sc->sc_dev.dv_xname));\n\n\t/* Just like eso_halt_output(), but for Audio 1. */\n\ts = splaudio();\n\teso_write_ctlreg(sc, ESO_CTLREG_A1C2,\n\t    ESO_CTLREG_A1C2_READ | ESO_CTLREG_A1C2_ADC |\n\t    ESO_CTLREG_A1C2_DMAENB);\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MODE,\n\t    DMA37MD_WRITE | DMA37MD_DEMAND);\n\n\tsc->sc_rintr = NULL;\n\terror = tsleep(&sc->sc_rintr, PCATCH | PWAIT, \"esohi\", hz);\n\tsplx(s);\n\n\t/* Shut down DMA completely. */\n\teso_write_ctlreg(sc, ESO_CTLREG_A1C2,\n\t    ESO_CTLREG_A1C2_READ | ESO_CTLREG_A1C2_ADC);\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MASK,\n\t    ESO_DMAC_MASK_MASK);\n\n\treturn (error == EWOULDBLOCK ? 0 : error);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_dmac_iot",
            "sc->sc_dmac_ioh",
            "ESO_DMAC_MASK",
            "ESO_DMAC_MASK_MASK"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_write_ctlreg",
          "args": [
            "sc",
            "ESO_CTLREG_A1C2",
            "ESO_CTLREG_A1C2_READ | ESO_CTLREG_A1C2_ADC"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_ctlreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "460-470",
          "snippet": "HIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tsleep",
          "args": [
            "&sc->sc_rintr",
            "PCATCH | PWAIT",
            "\"esohi\"",
            "hz"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_dmac_iot",
            "sc->sc_dmac_ioh",
            "ESO_DMAC_MODE",
            "DMA37MD_WRITE | DMA37MD_DEMAND"
          ],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: halt_input\\n\", sc->sc_dev.dv_xname)"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_halt_input(hdl)\n\tvoid *hdl;\n{\n\tstruct eso_softc *sc = hdl;\n\tint error, s;\n\t\n\tDPRINTF((\"%s: halt_input\\n\", sc->sc_dev.dv_xname));\n\n\t/* Just like eso_halt_output(), but for Audio 1. */\n\ts = splaudio();\n\teso_write_ctlreg(sc, ESO_CTLREG_A1C2,\n\t    ESO_CTLREG_A1C2_READ | ESO_CTLREG_A1C2_ADC |\n\t    ESO_CTLREG_A1C2_DMAENB);\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MODE,\n\t    DMA37MD_WRITE | DMA37MD_DEMAND);\n\n\tsc->sc_rintr = NULL;\n\terror = tsleep(&sc->sc_rintr, PCATCH | PWAIT, \"esohi\", hz);\n\tsplx(s);\n\n\t/* Shut down DMA completely. */\n\teso_write_ctlreg(sc, ESO_CTLREG_A1C2,\n\t    ESO_CTLREG_A1C2_READ | ESO_CTLREG_A1C2_ADC);\n\tbus_space_write_1(sc->sc_dmac_iot, sc->sc_dmac_ioh, ESO_DMAC_MASK,\n\t    ESO_DMAC_MASK_MASK);\n\n\treturn (error == EWOULDBLOCK ? 0 : error);\n}"
  },
  {
    "function_name": "eso_halt_output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "836-871",
    "snippet": "HIDE int\neso_halt_output(hdl)\n\tvoid *hdl;\n{\n\tstruct eso_softc *sc = hdl;\n\tint error, s;\n\t\n\tDPRINTF((\"%s: halt_output\\n\", sc->sc_dev.dv_xname));\n\n\t/*\n\t * Disable auto-initialize DMA, allowing the FIFO to drain and then\n\t * stop.  The interrupt callback pointer is cleared at this\n\t * point so that an outstanding FIFO interrupt for the remaining data\n\t * will be acknowledged without further processing.\n\t *\n\t * This does not immediately `abort' an operation in progress (c.f.\n\t * audio(9)) but is the method to leave the FIFO behind in a clean\n\t * state with the least hair.  (Besides, that item needs to be\n\t * rephrased for trigger_*()-based DMA environments.)\n\t */\n\ts = splaudio();\n\teso_write_mixreg(sc, ESO_MIXREG_A2C1,\n\t    ESO_MIXREG_A2C1_FIFOENB | ESO_MIXREG_A2C1_DMAENB);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAM,\n\t    ESO_IO_A2DMAM_DMAENB);\n\n\tsc->sc_pintr = NULL;\n\terror = tsleep(&sc->sc_pintr, PCATCH | PWAIT, \"esoho\", hz);\n\tsplx(s);\n\t\n\t/* Shut down DMA completely. */\n\teso_write_mixreg(sc, ESO_MIXREG_A2C1, 0);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAM, 0);\n\t\n\treturn (error == EWOULDBLOCK ? 0 : error);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "ESO_IO_A2DMAM",
            "0"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_A2C1",
            "0"
          ],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tsleep",
          "args": [
            "&sc->sc_pintr",
            "PCATCH | PWAIT",
            "\"esoho\"",
            "hz"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "ESO_IO_A2DMAM",
            "ESO_IO_A2DMAM_DMAENB"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: halt_output\\n\", sc->sc_dev.dv_xname)"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_halt_output(hdl)\n\tvoid *hdl;\n{\n\tstruct eso_softc *sc = hdl;\n\tint error, s;\n\t\n\tDPRINTF((\"%s: halt_output\\n\", sc->sc_dev.dv_xname));\n\n\t/*\n\t * Disable auto-initialize DMA, allowing the FIFO to drain and then\n\t * stop.  The interrupt callback pointer is cleared at this\n\t * point so that an outstanding FIFO interrupt for the remaining data\n\t * will be acknowledged without further processing.\n\t *\n\t * This does not immediately `abort' an operation in progress (c.f.\n\t * audio(9)) but is the method to leave the FIFO behind in a clean\n\t * state with the least hair.  (Besides, that item needs to be\n\t * rephrased for trigger_*()-based DMA environments.)\n\t */\n\ts = splaudio();\n\teso_write_mixreg(sc, ESO_MIXREG_A2C1,\n\t    ESO_MIXREG_A2C1_FIFOENB | ESO_MIXREG_A2C1_DMAENB);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAM,\n\t    ESO_IO_A2DMAM_DMAENB);\n\n\tsc->sc_pintr = NULL;\n\terror = tsleep(&sc->sc_pintr, PCATCH | PWAIT, \"esoho\", hz);\n\tsplx(s);\n\t\n\t/* Shut down DMA completely. */\n\teso_write_mixreg(sc, ESO_MIXREG_A2C1, 0);\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, ESO_IO_A2DMAM, 0);\n\t\n\treturn (error == EWOULDBLOCK ? 0 : error);\n}"
  },
  {
    "function_name": "eso_round_blocksize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "827-834",
    "snippet": "HIDE int\neso_round_blocksize(hdl, blk)\n\tvoid *hdl;\n\tint blk;\n{\n\n\treturn (blk & -32);\t/* keep good alignment; at least 16 req'd */\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_round_blocksize(hdl, blk)\n\tvoid *hdl;\n\tint blk;\n{\n\n\treturn (blk & -32);\t/* keep good alignment; at least 16 req'd */\n}"
  },
  {
    "function_name": "eso_set_params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "733-825",
    "snippet": "HIDE int\neso_set_params(hdl, setmode, usemode, play, rec)\n\tvoid *hdl;\n\tint setmode, usemode;\n\tstruct audio_params *play, *rec;\n{\n\tstruct eso_softc *sc = hdl;\n\tstruct audio_params *p;\n\tint mode, r[2], rd[2], clk;\n\tunsigned int srg, fltdiv;\n\t\n\tfor (mode = AUMODE_RECORD; mode != -1; \n\t     mode = mode == AUMODE_RECORD ? AUMODE_PLAY : -1) {\n\t\tif ((setmode & mode) == 0)\n\t\t\tcontinue;\n\n\t\tp = (mode == AUMODE_PLAY) ? play : rec;\n\n\t\tif (p->sample_rate < ESO_MINRATE ||\n\t\t    p->sample_rate > ESO_MAXRATE ||\n\t\t    (p->precision != 8 && p->precision != 16) ||\n\t\t    (p->channels != 1 && p->channels != 2))\n\t\t\treturn (EINVAL);\n\t\t\n\t\tp->factor = 1;\n\t\tp->sw_code = NULL;\n\t\tswitch (p->encoding) {\n\t\tcase AUDIO_ENCODING_SLINEAR_BE:\n\t\tcase AUDIO_ENCODING_ULINEAR_BE:\n\t\t\tif (mode == AUMODE_PLAY && p->precision == 16)\n\t\t\t\tp->sw_code = swap_bytes;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_SLINEAR_LE:\n\t\tcase AUDIO_ENCODING_ULINEAR_LE:\n\t\t\tif (mode == AUMODE_RECORD && p->precision == 16)\n\t\t\t\tp->sw_code = swap_bytes;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULAW:\n\t\t\tif (mode == AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = mulaw_to_ulinear16;\n\t\t\t} else {\n\t\t\t\tp->sw_code = ulinear8_to_mulaw;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ALAW:\n\t\t\tif (mode == AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = alaw_to_ulinear16;\n\t\t\t} else {\n\t\t\t\tp->sw_code = ulinear8_to_alaw;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\n\t\t/*\n\t\t * We'll compute both possible sample rate dividers and pick\n\t\t * the one with the least error.\n\t\t */\n#define ABS(x) ((x) < 0 ? -(x) : (x))\n\t\tr[0] = ESO_CLK0 /\n\t\t    (128 - (rd[0] = 128 - ESO_CLK0 / p->sample_rate));\n\t\tr[1] = ESO_CLK1 /\n\t\t    (128 - (rd[1] = 128 - ESO_CLK1 / p->sample_rate));\n\n\t\tclk = ABS(p->sample_rate - r[0]) > ABS(p->sample_rate - r[1]);\n\t\tsrg = rd[clk] | (clk == 1 ? ESO_CLK1_SELECT : 0x00);\n\n\t\t/* Roll-off frequency of 87%, as in the ES1888 driver. */\n\t\tfltdiv = 256 - 200279L / p->sample_rate;\n\n\t\t/* Update to reflect the possibly inexact rate. */\n\t\tp->sample_rate = r[clk];\n\t\n\t\tif (mode == AUMODE_RECORD) {\n\t\t\t/* Audio 1 */\n\t\t\tDPRINTF((\"A1 srg 0x%02x fdiv 0x%02x\\n\", srg, fltdiv));\n\t\t\teso_write_ctlreg(sc, ESO_CTLREG_SRG, srg);\n\t\t\teso_write_ctlreg(sc, ESO_CTLREG_FLTDIV, fltdiv);\n\t\t} else {\n\t\t\t/* Audio 2 */\n\t\t\tDPRINTF((\"A2 srg 0x%02x fdiv 0x%02x\\n\", srg, fltdiv));\n\t\t\teso_write_mixreg(sc, ESO_MIXREG_A2SRG, srg);\n\t\t\teso_write_mixreg(sc, ESO_MIXREG_A2FLTDIV, fltdiv);\n\t\t}\n#undef ABS\n\n\t}\n\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "eso_set_params __P((void *, int, int, struct audio_params *,\n\t\t    struct audio_params *));",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "eso_trigger_output __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));",
      "HIDE int",
      "eso_trigger_input __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_A2FLTDIV",
            "fltdiv"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"A2 srg 0x%02x fdiv 0x%02x\\n\", srg, fltdiv)"
          ],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_write_ctlreg",
          "args": [
            "sc",
            "ESO_CTLREG_FLTDIV",
            "fltdiv"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_ctlreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "460-470",
          "snippet": "HIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"A1 srg 0x%02x fdiv 0x%02x\\n\", srg, fltdiv)"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ABS",
          "args": [
            "p->sample_rate - r[1]"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ABS",
          "args": [
            "p->sample_rate - r[0]"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\neso_set_params __P((void *, int, int, struct audio_params *,\n\t\t    struct audio_params *));\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\neso_trigger_output __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));\nHIDE int;\neso_trigger_input __P((void *, void *, void *, int,\n\t\t    void (*)(void *), void *, struct audio_params *));\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_set_params(hdl, setmode, usemode, play, rec)\n\tvoid *hdl;\n\tint setmode, usemode;\n\tstruct audio_params *play, *rec;\n{\n\tstruct eso_softc *sc = hdl;\n\tstruct audio_params *p;\n\tint mode, r[2], rd[2], clk;\n\tunsigned int srg, fltdiv;\n\t\n\tfor (mode = AUMODE_RECORD; mode != -1; \n\t     mode = mode == AUMODE_RECORD ? AUMODE_PLAY : -1) {\n\t\tif ((setmode & mode) == 0)\n\t\t\tcontinue;\n\n\t\tp = (mode == AUMODE_PLAY) ? play : rec;\n\n\t\tif (p->sample_rate < ESO_MINRATE ||\n\t\t    p->sample_rate > ESO_MAXRATE ||\n\t\t    (p->precision != 8 && p->precision != 16) ||\n\t\t    (p->channels != 1 && p->channels != 2))\n\t\t\treturn (EINVAL);\n\t\t\n\t\tp->factor = 1;\n\t\tp->sw_code = NULL;\n\t\tswitch (p->encoding) {\n\t\tcase AUDIO_ENCODING_SLINEAR_BE:\n\t\tcase AUDIO_ENCODING_ULINEAR_BE:\n\t\t\tif (mode == AUMODE_PLAY && p->precision == 16)\n\t\t\t\tp->sw_code = swap_bytes;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_SLINEAR_LE:\n\t\tcase AUDIO_ENCODING_ULINEAR_LE:\n\t\t\tif (mode == AUMODE_RECORD && p->precision == 16)\n\t\t\t\tp->sw_code = swap_bytes;\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ULAW:\n\t\t\tif (mode == AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = mulaw_to_ulinear16;\n\t\t\t} else {\n\t\t\t\tp->sw_code = ulinear8_to_mulaw;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase AUDIO_ENCODING_ALAW:\n\t\t\tif (mode == AUMODE_PLAY) {\n\t\t\t\tp->factor = 2;\n\t\t\t\tp->sw_code = alaw_to_ulinear16;\n\t\t\t} else {\n\t\t\t\tp->sw_code = ulinear8_to_alaw;\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn (EINVAL);\n\t\t}\n\n\t\t/*\n\t\t * We'll compute both possible sample rate dividers and pick\n\t\t * the one with the least error.\n\t\t */\n#define ABS(x) ((x) < 0 ? -(x) : (x))\n\t\tr[0] = ESO_CLK0 /\n\t\t    (128 - (rd[0] = 128 - ESO_CLK0 / p->sample_rate));\n\t\tr[1] = ESO_CLK1 /\n\t\t    (128 - (rd[1] = 128 - ESO_CLK1 / p->sample_rate));\n\n\t\tclk = ABS(p->sample_rate - r[0]) > ABS(p->sample_rate - r[1]);\n\t\tsrg = rd[clk] | (clk == 1 ? ESO_CLK1_SELECT : 0x00);\n\n\t\t/* Roll-off frequency of 87%, as in the ES1888 driver. */\n\t\tfltdiv = 256 - 200279L / p->sample_rate;\n\n\t\t/* Update to reflect the possibly inexact rate. */\n\t\tp->sample_rate = r[clk];\n\t\n\t\tif (mode == AUMODE_RECORD) {\n\t\t\t/* Audio 1 */\n\t\t\tDPRINTF((\"A1 srg 0x%02x fdiv 0x%02x\\n\", srg, fltdiv));\n\t\t\teso_write_ctlreg(sc, ESO_CTLREG_SRG, srg);\n\t\t\teso_write_ctlreg(sc, ESO_CTLREG_FLTDIV, fltdiv);\n\t\t} else {\n\t\t\t/* Audio 2 */\n\t\t\tDPRINTF((\"A2 srg 0x%02x fdiv 0x%02x\\n\", srg, fltdiv));\n\t\t\teso_write_mixreg(sc, ESO_MIXREG_A2SRG, srg);\n\t\t\teso_write_mixreg(sc, ESO_MIXREG_A2FLTDIV, fltdiv);\n\t\t}\n#undef ABS\n\n\t}\n\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_query_encoding",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "643-731",
    "snippet": "HIDE int\neso_query_encoding(hdl, fp)\n\tvoid *hdl;\n\tstruct audio_encoding *fp;\n{\n\t\n\tswitch (fp->index) {\n\tcase 0:\n\t\tstrcpy(fp->name, AudioEulinear);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = 0;\n\t\tbreak;\n\tcase 1:\n\t\tstrcpy(fp->name, AudioEslinear);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = 0;\n\t\tbreak;\n\tcase 2:\n\t\tfp->precision = 16;\n\t\tif (fp->flags & AUOPEN_READ) {\n\t\t\tstrcpy(fp->name, AudioEslinear_be);\n\t\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_BE;\n\t\t\tif (fp->flags & AUOPEN_WRITE)\n\t\t\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\t\telse\n\t\t\t\tfp->flags = 0;\n\t\t} else {\n\t\t\tstrcpy(fp->name, AudioEslinear_le);\n\t\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_LE;\n\t\t\tfp->flags = 0;\n\t\t}\n\t\tbreak;\n\tcase 3:\n\t\tfp->precision = 16;\n\t\tif (fp->flags & AUOPEN_READ) {\n\t\t\tstrcpy(fp->name, AudioEulinear_be);\n\t\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_BE;\n\t\t\tif (fp->flags & AUOPEN_WRITE)\n\t\t\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\t\telse\n\t\t\t\tfp->flags = 0;\n\t\t} else {\n\t\t\tstrcpy(fp->name, AudioEulinear_le);\n\t\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_LE;\n\t\t\tfp->flags = 0;\n\t\t}\n\t\tbreak;\n\tcase 4:\n\t\tfp->precision = 16;\n\t\tif (fp->flags & AUOPEN_READ) {\n\t\t\tstrcpy(fp->name, AudioEslinear_le);\n\t\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_LE;\n\t\t} else {\n\t\t\tstrcpy(fp->name, AudioEslinear_be);\n\t\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_BE;\n\t\t}\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 5:\n\t\tfp->precision = 16;\n\t\tif (fp->flags & AUOPEN_READ) {\n\t\t\tstrcpy(fp->name, AudioEulinear_le);\n\t\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_LE;\n\t\t} else {\n\t\t\tstrcpy(fp->name, AudioEulinear_be);\n\t\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_BE;\n\t\t}\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 6:\n\t\tstrcpy(fp->name, AudioEmulaw);\n\t\tfp->encoding = AUDIO_ENCODING_ULAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 7:\n\t\tstrcpy(fp->name, AudioEalaw);\n\t\tfp->encoding = AUDIO_ENCODING_ALAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tdefault:\n\t\treturn (EINVAL);\n\t}\n\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "eso_query_encoding __P((void *, struct audio_encoding *));",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;",
      "int type, flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEalaw"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEmulaw"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear_be"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear_le"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear_be"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear_le"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear_le"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear_be"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear_le"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear_be"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEslinear"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "fp->name",
            "AudioEulinear"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\neso_query_encoding __P((void *, struct audio_encoding *));\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\nint type, flags;\n\nHIDE int\neso_query_encoding(hdl, fp)\n\tvoid *hdl;\n\tstruct audio_encoding *fp;\n{\n\t\n\tswitch (fp->index) {\n\tcase 0:\n\t\tstrcpy(fp->name, AudioEulinear);\n\t\tfp->encoding = AUDIO_ENCODING_ULINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = 0;\n\t\tbreak;\n\tcase 1:\n\t\tstrcpy(fp->name, AudioEslinear);\n\t\tfp->encoding = AUDIO_ENCODING_SLINEAR;\n\t\tfp->precision = 8;\n\t\tfp->flags = 0;\n\t\tbreak;\n\tcase 2:\n\t\tfp->precision = 16;\n\t\tif (fp->flags & AUOPEN_READ) {\n\t\t\tstrcpy(fp->name, AudioEslinear_be);\n\t\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_BE;\n\t\t\tif (fp->flags & AUOPEN_WRITE)\n\t\t\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\t\telse\n\t\t\t\tfp->flags = 0;\n\t\t} else {\n\t\t\tstrcpy(fp->name, AudioEslinear_le);\n\t\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_LE;\n\t\t\tfp->flags = 0;\n\t\t}\n\t\tbreak;\n\tcase 3:\n\t\tfp->precision = 16;\n\t\tif (fp->flags & AUOPEN_READ) {\n\t\t\tstrcpy(fp->name, AudioEulinear_be);\n\t\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_BE;\n\t\t\tif (fp->flags & AUOPEN_WRITE)\n\t\t\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\t\telse\n\t\t\t\tfp->flags = 0;\n\t\t} else {\n\t\t\tstrcpy(fp->name, AudioEulinear_le);\n\t\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_LE;\n\t\t\tfp->flags = 0;\n\t\t}\n\t\tbreak;\n\tcase 4:\n\t\tfp->precision = 16;\n\t\tif (fp->flags & AUOPEN_READ) {\n\t\t\tstrcpy(fp->name, AudioEslinear_le);\n\t\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_LE;\n\t\t} else {\n\t\t\tstrcpy(fp->name, AudioEslinear_be);\n\t\t\tfp->encoding = AUDIO_ENCODING_SLINEAR_BE;\n\t\t}\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 5:\n\t\tfp->precision = 16;\n\t\tif (fp->flags & AUOPEN_READ) {\n\t\t\tstrcpy(fp->name, AudioEulinear_le);\n\t\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_LE;\n\t\t} else {\n\t\t\tstrcpy(fp->name, AudioEulinear_be);\n\t\t\tfp->encoding = AUDIO_ENCODING_ULINEAR_BE;\n\t\t}\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 6:\n\t\tstrcpy(fp->name, AudioEmulaw);\n\t\tfp->encoding = AUDIO_ENCODING_ULAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tcase 7:\n\t\tstrcpy(fp->name, AudioEalaw);\n\t\tfp->encoding = AUDIO_ENCODING_ALAW;\n\t\tfp->precision = 8;\n\t\tfp->flags = AUDIO_ENCODINGFLAG_EMULATED;\n\t\tbreak;\n\tdefault:\n\t\treturn (EINVAL);\n\t}\n\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_close",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "635-641",
    "snippet": "HIDE void\neso_close(hdl)\n\tvoid *hdl;\n{\n\n\tDPRINTF((\"%s: close\\n\", ((struct eso_softc *)hdl)->sc_dev.dv_xname));\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: close\\n\", ((struct eso_softc *)hdl)->sc_dev.dv_xname)"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE void\neso_close(hdl)\n\tvoid *hdl;\n{\n\n\tDPRINTF((\"%s: close\\n\", ((struct eso_softc *)hdl)->sc_dev.dv_xname));\n}"
  },
  {
    "function_name": "eso_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "620-633",
    "snippet": "HIDE int\neso_open(hdl, flags)\n\tvoid *hdl;\n\tint flags;\n{\n\tstruct eso_softc *sc = hdl;\n\t\n\tDPRINTF((\"%s: open\\n\", sc->sc_dev.dv_xname));\n\n\tsc->sc_pintr = NULL;\n\tsc->sc_rintr = NULL;\n\t\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "void *hdl;",
      "int type, flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: open\\n\", sc->sc_dev.dv_xname)"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\nvoid *hdl;\nint type, flags;\n\nHIDE int\neso_open(hdl, flags)\n\tvoid *hdl;\n\tint flags;\n{\n\tstruct eso_softc *sc = hdl;\n\t\n\tDPRINTF((\"%s: open\\n\", sc->sc_dev.dv_xname));\n\n\tsc->sc_pintr = NULL;\n\tsc->sc_rintr = NULL;\n\t\n\treturn (0);\n}"
  },
  {
    "function_name": "eso_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "582-616",
    "snippet": "HIDE int\neso_reset(sc)\n\tstruct eso_softc *sc;\n{\n\tint i;\n\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RESET,\n\t    ESO_SB_RESET_SW | ESO_SB_RESET_FIFO);\n\t/* `Delay' suggested in the data sheet. */\n\t(void)bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_STATUS);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RESET, 0);\n\n\t/* Wait for reset to take effect. */\n\tfor (i = 0; i < ESO_RESET_TIMEOUT; i++) {\n\t\t/* Poll for data to become available. */\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR) & ESO_SB_RBSR_RDAV) != 0 &&\n\t\t    bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\tESO_SB_RDR) == ESO_SB_RDR_RESETMAGIC) {\n\n\t\t\t/* Activate Solo-1 extension commands. */\n\t\t\teso_write_cmd(sc, ESO_CMD_EXTENB);\n\t\t\t/* Reset mixer registers. */\n\t\t\teso_write_mixreg(sc, ESO_MIXREG_RESET,\n\t\t\t    ESO_MIXREG_RESET_RESET);\n\n\t\t\treturn (0);\n\t\t} else {\n\t\t\tdelay(1000);\n\t\t}\n\t}\n\t\n\tprintf(\"%s: reset timeout\\n\", sc->sc_dev.dv_xname);\n\treturn (-1);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: reset timeout\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "1000"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_RESET",
            "ESO_MIXREG_RESET_RESET"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_write_cmd",
          "args": [
            "sc",
            "ESO_CMD_EXTENB"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_cmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "436-457",
          "snippet": "HIDE void\neso_write_cmd(sc, cmd)\n\tstruct eso_softc *sc;\n\tuint8_t cmd;\n{\n\tint i;\n\n\t/* Poll for busy indicator to become clear. */\n\tfor (i = 0; i < ESO_WDR_TIMEOUT; i++) {\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RSR)\n\t\t    & ESO_SB_RSR_BUSY) == 0) {\n\t\t\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\t    ESO_SB_WDR, cmd);\n\t\t\treturn;\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: WDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn;\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_cmd(sc, cmd)\n\tstruct eso_softc *sc;\n\tuint8_t cmd;\n{\n\tint i;\n\n\t/* Poll for busy indicator to become clear. */\n\tfor (i = 0; i < ESO_WDR_TIMEOUT; i++) {\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RSR)\n\t\t    & ESO_SB_RSR_BUSY) == 0) {\n\t\t\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\t    ESO_SB_WDR, cmd);\n\t\t\treturn;\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: WDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_RDR"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_RBSR"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_RESET",
            "0"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_STATUS"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_RESET",
            "ESO_SB_RESET_SW | ESO_SB_RESET_FIFO"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\n\nHIDE int\neso_reset(sc)\n\tstruct eso_softc *sc;\n{\n\tint i;\n\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RESET,\n\t    ESO_SB_RESET_SW | ESO_SB_RESET_FIFO);\n\t/* `Delay' suggested in the data sheet. */\n\t(void)bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_STATUS);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RESET, 0);\n\n\t/* Wait for reset to take effect. */\n\tfor (i = 0; i < ESO_RESET_TIMEOUT; i++) {\n\t\t/* Poll for data to become available. */\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR) & ESO_SB_RBSR_RDAV) != 0 &&\n\t\t    bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\tESO_SB_RDR) == ESO_SB_RDR_RESETMAGIC) {\n\n\t\t\t/* Activate Solo-1 extension commands. */\n\t\t\teso_write_cmd(sc, ESO_CMD_EXTENB);\n\t\t\t/* Reset mixer registers. */\n\t\t\teso_write_mixreg(sc, ESO_MIXREG_RESET,\n\t\t\t    ESO_MIXREG_RESET_RESET);\n\n\t\t\treturn (0);\n\t\t} else {\n\t\t\tdelay(1000);\n\t\t}\n\t}\n\t\n\tprintf(\"%s: reset timeout\\n\", sc->sc_dev.dv_xname);\n\treturn (-1);\n}"
  },
  {
    "function_name": "eso_intr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "536-579",
    "snippet": "HIDE int\neso_intr(hdl)\n\tvoid *hdl;\n{\n\tstruct eso_softc *sc = hdl;\n\tuint8_t irqctl;\n\n\tirqctl = bus_space_read_1(sc->sc_iot, sc->sc_ioh, ESO_IO_IRQCTL);\n\n\t/* If it wasn't ours, that's all she wrote. */\n\tif ((irqctl & (ESO_IO_IRQCTL_A1IRQ | ESO_IO_IRQCTL_A2IRQ)) == 0)\n\t\treturn (0);\n\t\n\tif (irqctl & ESO_IO_IRQCTL_A1IRQ) {\n\t\t/* Clear interrupt. */\n\t\t(void)bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR);\n\t\n\t\tif (sc->sc_rintr)\n\t\t\tsc->sc_rintr(sc->sc_rarg);\n\t\telse\n\t\t\twakeup(&sc->sc_rintr);\n\t}\n\n\tif (irqctl & ESO_IO_IRQCTL_A2IRQ) {\n\t\t/*\n\t\t * Clear the A2 IRQ latch: the cached value reflects the\n\t\t * current DAC settings with the IRQ latch bit not set.\n\t\t */\n\t\teso_write_mixreg(sc, ESO_MIXREG_A2C2, sc->sc_a2c2);\n\n\t\tif (sc->sc_pintr)\n\t\t\tsc->sc_pintr(sc->sc_parg);\n\t\telse\n\t\t\twakeup(&sc->sc_pintr);\n\t}\n\n#if 0\n\tif ((irqctl & ESO_IO_IRQCTL_MPUIRQ) && sc->sc_mpudev != 0)\n\t\tmpu_intr(sc->sc_mpudev);\n#endif\n \n\treturn (1);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mpu_intr",
          "args": [
            "sc->sc_mpudev"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "mpu_intr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/mpu401.c",
          "lines": "243-255",
          "snippet": "int\nmpu_intr(v)\n\tvoid *v;\n{\n\tstruct mpu_softc *sc = v;\n\n\tif (MPU_GETSTATUS(sc->iot, sc->ioh) & MPU_INPUT_EMPTY) {\n\t\tDPRINTF((\"mpu_intr: no data\\n\"));\n\t\treturn 0;\n\t}\n\tmpu_readinput(sc);\n\treturn 1;\n}",
          "includes": [
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/midi_if.h>",
            "#include <machine/bus.h>",
            "#include <machine/intr.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define  MPU_INPUT_EMPTY\t0x80"
          ],
          "globals_used": [
            "int\tmpu_reset(struct mpu_softc *);",
            "static\t__inline int mpu_waitready(struct mpu_softc *);",
            "void\tmpu_readinput(struct mpu_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/mpuvar.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/midi_if.h>\n#include <machine/bus.h>\n#include <machine/intr.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define  MPU_INPUT_EMPTY\t0x80\n\nint\tmpu_reset(struct mpu_softc *);\nstatic\t__inline int mpu_waitready(struct mpu_softc *);\nvoid\tmpu_readinput(struct mpu_softc *);\n\nint\nmpu_intr(v)\n\tvoid *v;\n{\n\tstruct mpu_softc *sc = v;\n\n\tif (MPU_GETSTATUS(sc->iot, sc->ioh) & MPU_INPUT_EMPTY) {\n\t\tDPRINTF((\"mpu_intr: no data\\n\"));\n\t\treturn 0;\n\t}\n\tmpu_readinput(sc);\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wakeup",
          "args": [
            "&sc->sc_pintr"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "audio_wakeup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "765-774",
          "snippet": "static __inline void\naudio_wakeup(chan)\n\tint *chan;\n{\n\tDPRINTFN(3, (\"audio_wakeup: chan=%p, *chan=%d\\n\", chan, *chan));\n\tif (*chan) {\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nstatic __inline void\naudio_wakeup(chan)\n\tint *chan;\n{\n\tDPRINTFN(3, (\"audio_wakeup: chan=%p, *chan=%d\\n\", chan, *chan));\n\tif (*chan) {\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc->sc_pintr",
          "args": [
            "sc->sc_parg"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_A2C2",
            "sc->sc_a2c2"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sc->sc_rintr",
          "args": [
            "sc->sc_rarg"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_RBSR"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "ESO_IO_IRQCTL"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE int\neso_intr(hdl)\n\tvoid *hdl;\n{\n\tstruct eso_softc *sc = hdl;\n\tuint8_t irqctl;\n\n\tirqctl = bus_space_read_1(sc->sc_iot, sc->sc_ioh, ESO_IO_IRQCTL);\n\n\t/* If it wasn't ours, that's all she wrote. */\n\tif ((irqctl & (ESO_IO_IRQCTL_A1IRQ | ESO_IO_IRQCTL_A2IRQ)) == 0)\n\t\treturn (0);\n\t\n\tif (irqctl & ESO_IO_IRQCTL_A1IRQ) {\n\t\t/* Clear interrupt. */\n\t\t(void)bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR);\n\t\n\t\tif (sc->sc_rintr)\n\t\t\tsc->sc_rintr(sc->sc_rarg);\n\t\telse\n\t\t\twakeup(&sc->sc_rintr);\n\t}\n\n\tif (irqctl & ESO_IO_IRQCTL_A2IRQ) {\n\t\t/*\n\t\t * Clear the A2 IRQ latch: the cached value reflects the\n\t\t * current DAC settings with the IRQ latch bit not set.\n\t\t */\n\t\teso_write_mixreg(sc, ESO_MIXREG_A2C2, sc->sc_a2c2);\n\n\t\tif (sc->sc_pintr)\n\t\t\tsc->sc_pintr(sc->sc_parg);\n\t\telse\n\t\t\twakeup(&sc->sc_pintr);\n\t}\n\n#if 0\n\tif ((irqctl & ESO_IO_IRQCTL_MPUIRQ) && sc->sc_mpudev != 0)\n\t\tmpu_intr(sc->sc_mpudev);\n#endif\n \n\treturn (1);\n}"
  },
  {
    "function_name": "eso_read_mixreg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "520-534",
    "snippet": "HIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_MIXERDATA"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_MIXERADDR",
            "reg"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}"
  },
  {
    "function_name": "eso_write_mixreg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "505-518",
    "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "splx",
          "args": [
            "s"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_MIXERDATA",
            "val"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_MIXERADDR",
            "reg"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "splaudio",
          "args": [],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
  },
  {
    "function_name": "eso_read_ctlreg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "494-503",
    "snippet": "HIDE uint8_t\neso_read_ctlreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\n\teso_write_cmd(sc, ESO_CMD_RCR);\n\teso_write_cmd(sc, reg);\n\treturn (eso_read_rdr(sc));\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eso_read_rdr",
          "args": [
            "sc"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "eso_read_rdr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "473-491",
          "snippet": "HIDE uint8_t\neso_read_rdr(sc)\n\tstruct eso_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < ESO_RDR_TIMEOUT; i++) {\n\t\tif (bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR) & ESO_SB_RBSR_RDAV) {\n\t\t\treturn (bus_space_read_1(sc->sc_sb_iot,\n\t\t\t    sc->sc_sb_ioh, ESO_SB_RDR));\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: RDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn (-1);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_rdr(sc)\n\tstruct eso_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < ESO_RDR_TIMEOUT; i++) {\n\t\tif (bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR) & ESO_SB_RBSR_RDAV) {\n\t\t\treturn (bus_space_read_1(sc->sc_sb_iot,\n\t\t\t    sc->sc_sb_ioh, ESO_SB_RDR));\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: RDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn (-1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_write_cmd",
          "args": [
            "sc",
            "reg"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_cmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "436-457",
          "snippet": "HIDE void\neso_write_cmd(sc, cmd)\n\tstruct eso_softc *sc;\n\tuint8_t cmd;\n{\n\tint i;\n\n\t/* Poll for busy indicator to become clear. */\n\tfor (i = 0; i < ESO_WDR_TIMEOUT; i++) {\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RSR)\n\t\t    & ESO_SB_RSR_BUSY) == 0) {\n\t\t\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\t    ESO_SB_WDR, cmd);\n\t\t\treturn;\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: WDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn;\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_cmd(sc, cmd)\n\tstruct eso_softc *sc;\n\tuint8_t cmd;\n{\n\tint i;\n\n\t/* Poll for busy indicator to become clear. */\n\tfor (i = 0; i < ESO_WDR_TIMEOUT; i++) {\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RSR)\n\t\t    & ESO_SB_RSR_BUSY) == 0) {\n\t\t\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\t    ESO_SB_WDR, cmd);\n\t\t\treturn;\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: WDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_ctlreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\n\teso_write_cmd(sc, ESO_CMD_RCR);\n\teso_write_cmd(sc, reg);\n\treturn (eso_read_rdr(sc));\n}"
  },
  {
    "function_name": "eso_read_rdr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "473-491",
    "snippet": "HIDE uint8_t\neso_read_rdr(sc)\n\tstruct eso_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < ESO_RDR_TIMEOUT; i++) {\n\t\tif (bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR) & ESO_SB_RBSR_RDAV) {\n\t\t\treturn (bus_space_read_1(sc->sc_sb_iot,\n\t\t\t    sc->sc_sb_ioh, ESO_SB_RDR));\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: RDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn (-1);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: RDR timeout\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_RDR"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_RBSR"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_rdr(sc)\n\tstruct eso_softc *sc;\n{\n\tint i;\n\n\tfor (i = 0; i < ESO_RDR_TIMEOUT; i++) {\n\t\tif (bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR) & ESO_SB_RBSR_RDAV) {\n\t\t\treturn (bus_space_read_1(sc->sc_sb_iot,\n\t\t\t    sc->sc_sb_ioh, ESO_SB_RDR));\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: RDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn (-1);\n}"
  },
  {
    "function_name": "eso_write_ctlreg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "460-470",
    "snippet": "HIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "eso_write_cmd",
          "args": [
            "sc",
            "val"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_cmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "436-457",
          "snippet": "HIDE void\neso_write_cmd(sc, cmd)\n\tstruct eso_softc *sc;\n\tuint8_t cmd;\n{\n\tint i;\n\n\t/* Poll for busy indicator to become clear. */\n\tfor (i = 0; i < ESO_WDR_TIMEOUT; i++) {\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RSR)\n\t\t    & ESO_SB_RSR_BUSY) == 0) {\n\t\t\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\t    ESO_SB_WDR, cmd);\n\t\t\treturn;\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: WDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn;\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_cmd(sc, cmd)\n\tstruct eso_softc *sc;\n\tuint8_t cmd;\n{\n\tint i;\n\n\t/* Poll for busy indicator to become clear. */\n\tfor (i = 0; i < ESO_WDR_TIMEOUT; i++) {\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RSR)\n\t\t    & ESO_SB_RSR_BUSY) == 0) {\n\t\t\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\t    ESO_SB_WDR, cmd);\n\t\t\treturn;\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: WDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_ctlreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\n\t/* DPRINTF((\"ctlreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\teso_write_cmd(sc, reg);\n\teso_write_cmd(sc, val);\n}"
  },
  {
    "function_name": "eso_write_cmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "436-457",
    "snippet": "HIDE void\neso_write_cmd(sc, cmd)\n\tstruct eso_softc *sc;\n\tuint8_t cmd;\n{\n\tint i;\n\n\t/* Poll for busy indicator to become clear. */\n\tfor (i = 0; i < ESO_WDR_TIMEOUT; i++) {\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RSR)\n\t\t    & ESO_SB_RSR_BUSY) == 0) {\n\t\t\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\t    ESO_SB_WDR, cmd);\n\t\t\treturn;\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: WDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn;\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: WDR timeout\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "delay",
          "args": [
            "10"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "lmc_delay_300ns",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/if_lmc.c",
          "lines": "217-223",
          "snippet": "static inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}",
          "includes": [
            "#include \"i386/pci/if_lmcvar.h\"",
            "#include \"i386/pci/if_lmcioctl.h\"",
            "#include \"i386/pci/if_lmctypes.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"",
            "#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"",
            "#include <dev/ic/dc21040reg.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <i386/pci/pci.h>",
            "#include <i386/isa/isavar.h>",
            "#include <i386/isa/dma.h>",
            "#include <i386/isa/icu.h>",
            "#include <i386/isa/isa.h>",
            "#include <i386/pci/ic/dc21040.h>",
            "#include <pci/dc21040reg.h>",
            "#include <pci/pcivar.h>",
            "#include <pci.h>",
            "#include <vm/pmap.h>",
            "#include <net/if_c_hdlc.h>",
            "#include <net/if_p2p.h>",
            "#include <net/if_types.h>",
            "#include <net/netisr.h>",
            "#include <net/if.h>",
            "#include <net/netisr.h>",
            "#include <netinet/ip.h>",
            "#include <netinet/in_systm.h>",
            "#include <netinet/in.h>",
            "#include <net/if_sppp.h>",
            "#include <vm/vm_kern.h>",
            "#include <vm/vm_param.h>",
            "#include <vm/vm.h>",
            "#include <net/bpfdesc.h>",
            "#include <net/bpf.h>",
            "#include \"bpfilter.h\"",
            "#include <net/netisr.h>",
            "#include <net/if_dl.h>",
            "#include <net/if_types.h>",
            "#include <net/if.h>",
            "#include <sys/rnd.h>",
            "#include \"rnd.h\"",
            "#include <dev/pci/pcidevs.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/device.h>",
            "#include <machine/clock.h>",
            "#include <sys/proc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/malloc.h>",
            "#include <sys/errno.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/socket.h>",
            "#include <sys/mbuf.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void lmc_rx_intr(lmc_softc_t * const sc);",
            "static void lmc_ifup(lmc_softc_t * const sc);",
            "static void lmc_ifdown(lmc_softc_t * const sc);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"i386/pci/if_lmcvar.h\"\n#include \"i386/pci/if_lmcioctl.h\"\n#include \"i386/pci/if_lmctypes.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcvar.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmcioctl.h\"\n#include INCLUDE_PATH_PREFIX \"if_lmc_types.h\"\n#include <dev/ic/dc21040reg.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <i386/pci/pci.h>\n#include <i386/isa/isavar.h>\n#include <i386/isa/dma.h>\n#include <i386/isa/icu.h>\n#include <i386/isa/isa.h>\n#include <i386/pci/ic/dc21040.h>\n#include <pci/dc21040reg.h>\n#include <pci/pcivar.h>\n#include <pci.h>\n#include <vm/pmap.h>\n#include <net/if_c_hdlc.h>\n#include <net/if_p2p.h>\n#include <net/if_types.h>\n#include <net/netisr.h>\n#include <net/if.h>\n#include <net/netisr.h>\n#include <netinet/ip.h>\n#include <netinet/in_systm.h>\n#include <netinet/in.h>\n#include <net/if_sppp.h>\n#include <vm/vm_kern.h>\n#include <vm/vm_param.h>\n#include <vm/vm.h>\n#include <net/bpfdesc.h>\n#include <net/bpf.h>\n#include \"bpfilter.h\"\n#include <net/netisr.h>\n#include <net/if_dl.h>\n#include <net/if_types.h>\n#include <net/if.h>\n#include <sys/rnd.h>\n#include \"rnd.h\"\n#include <dev/pci/pcidevs.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/device.h>\n#include <machine/clock.h>\n#include <sys/proc.h>\n#include <sys/kernel.h>\n#include <sys/malloc.h>\n#include <sys/errno.h>\n#include <sys/ioctl.h>\n#include <sys/socket.h>\n#include <sys/mbuf.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic void lmc_rx_intr(lmc_softc_t * const sc);\nstatic void lmc_ifup(lmc_softc_t * const sc);\nstatic void lmc_ifdown(lmc_softc_t * const sc);\n\nstatic inline void\nlmc_delay_300ns(lmc_softc_t * const sc)\n{\n\tint idx;\n\tfor (idx = (300 / 33) + 1; idx > 0; idx--)\n\t\t(void)LMC_CSR_READ(sc, csr_busmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_WDR",
            "cmd"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_read_1",
          "args": [
            "sc->sc_sb_iot",
            "sc->sc_sb_ioh",
            "ESO_SB_RSR"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_cmd(sc, cmd)\n\tstruct eso_softc *sc;\n\tuint8_t cmd;\n{\n\tint i;\n\n\t/* Poll for busy indicator to become clear. */\n\tfor (i = 0; i < ESO_WDR_TIMEOUT; i++) {\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RSR)\n\t\t    & ESO_SB_RSR_BUSY) == 0) {\n\t\t\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\t    ESO_SB_WDR, cmd);\n\t\t\treturn;\n\t\t} else {\n\t\t\tdelay(10);\n\t\t}\n\t}\n\n\tprintf(\"%s: WDR timeout\\n\", sc->sc_dev.dv_xname);\n\treturn;\n}"
  },
  {
    "function_name": "eso_defer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "400-434",
    "snippet": "HIDE void\neso_defer(self)\n\tstruct device *self;\n{\n\tstruct eso_softc *sc = (struct eso_softc *)self;\n\tstruct pci_attach_args *pa = &sc->sc_pa;\n\tbus_addr_t addr, start;\n\n\tprintf(\"%s: \", sc->sc_dev.dv_xname);\n\n\t/*\n\t * This is outright ugly, but since we must not make assumptions\n\t * on the underlying allocator's behaviour it's the most straight-\n\t * forward way to implement it.  Note that we skip over the first\n\t * 1K region, which is typically occupied by an attached ISA bus.\n\t */\n\tfor (start = 0x0400; start < 0xffff; start += 0x0400) {\n\t\tif (bus_space_alloc(sc->sc_iot,\n\t\t    start + sc->sc_vcsize, start + 0x0400 - 1,\n\t\t    sc->sc_vcsize, sc->sc_vcsize, 0, 0, &addr,\n\t\t    &sc->sc_dmac_ioh) != 0)\n\t\t\tcontinue;\n\n\t\tpci_conf_write(pa->pa_pc, pa->pa_tag, ESO_PCI_DDMAC,\n\t\t    addr | ESO_PCI_DDMAC_DE);\n\t\tsc->sc_dmac_iot = sc->sc_iot;\n\t\tsc->sc_dmac_configured = 1;\n\t\tprintf(\"mapping Audio 1 DMA using I/O space at 0x%lx\\n\",\n\t\t    (unsigned long)addr);\n\n\t\treturn;\n\t}\n\t\n\tprintf(\"can't map Audio 1 DMA into I/O space\\n\");\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "eso_attach __P((struct device *, struct device *, void *));",
      "HIDE void",
      "eso_defer __P((struct device *));",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"can't map Audio 1 DMA into I/O space\\n\""
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pci_conf_write",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "ESO_PCI_DDMAC",
            "addr | ESO_PCI_DDMAC_DE"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bus_space_alloc",
          "args": [
            "sc->sc_iot",
            "start + sc->sc_vcsize",
            "start + 0x0400 - 1",
            "sc->sc_vcsize",
            "sc->sc_vcsize",
            "0",
            "0",
            "&addr",
            "&sc->sc_dmac_ioh"
          ],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "rbus_space_alloc_subregion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/cardbus/rbus.c",
          "lines": "82-173",
          "snippet": "int\nrbus_space_alloc_subregion(rbt, substart, subend, addr, size, mask, align, flags, addrp, bshp)\n     rbus_tag_t rbt;\n     bus_addr_t addr;\n     bus_addr_t substart;\n     bus_addr_t subend;\n     bus_size_t size;\n     bus_addr_t mask, align;\n     int flags;\n     bus_addr_t *addrp;\n     bus_space_handle_t *bshp;\n{\n  bus_addr_t decodesize = mask + 1;\n  bus_addr_t boundary, search_addr;\n  int val = 0;\n  bus_addr_t result;\n  int exflags = EX_FAST | EX_NOWAIT;\n\n  DPRINTF((\"rbus_space_alloc: addr %lx, size %lx, mask %lx, align %lx\\n\",\n\t   addr, size, mask, align));\n\n  addr += rbt->rb_offset;\n\n  if (mask == 0) {\n    /* FULL Decode */\n    decodesize = 0;\n  }\n\n  if (rbt->rb_flags == RBUS_SPACE_ASK_PARENT) {\n    return rbus_space_alloc(rbt->rb_parent, addr, size, mask, align, flags,\n\t\t\t    addrp, bshp);\n  } else if (rbt->rb_flags == RBUS_SPACE_SHARE ||\n\t     rbt->rb_flags == RBUS_SPACE_DEDICATE) {\n    /* rbt has its own sh_extent */\n\n    /* sanity check: the subregion [substart, subend] should be\n       smaller than the region included in sh_extent */\n    if (substart < rbt->rb_ext->ex_start || subend > rbt->rb_ext->ex_end) {\n      return 1;\n    }\n\n    if (decodesize == align) {\n      if(extent_alloc_subregion(rbt->rb_ext, substart, subend, size, align, 0,\n\t\t\t\texflags, (u_long *)&result)) {\n\treturn 1;\n      }\n    } else if (decodesize == 0) {\n      /* maybe, the resister is overflowed. */\n      \n      if (extent_alloc_subregion(rbt->rb_ext, addr, addr + size, size,\n\t\t\t\t 0, 0, exflags, (u_long *)&result)) {\n\treturn 1;\n      }\n    } else {\n\n      boundary = decodesize > align ? decodesize : align;\n\n      search_addr = (substart & ~(boundary - 1)) + addr;\n\n      if (search_addr < substart) {\n\tsearch_addr += boundary;\n      }\n\n      for (; search_addr + size <= subend; search_addr += boundary) {\n\tval = extent_alloc_subregion(rbt->rb_ext,search_addr, search_addr+size,\n\t\t\t\tsize, align, 0, exflags, (u_long *)&result);\n\tif (val == 0) {\n\t  break;\n\t}\n      }\n      if (val) {\n\treturn 1;\n      }\n    }\n\n    if(md_space_map(rbt->rb_bt, result, size, flags, bshp)) {\n      /* map failed */\n      extent_free(rbt->rb_ext, result, size, exflags);\n      return 1;\n    }\n\n    if (addrp != NULL) {\n      *addrp = result + rbt->rb_offset;\n    }\n    return 0;\n\n  } else {\n    /* error!! */\n    return 1;\n  }\n  return 1;\n}",
          "includes": [
            "#include <dev/cardbus/rbus.h>",
            "#include <machine/bus.h>",
            "#include <sys/extent.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct extent *ex, bus_addr_t start,\n\t\t\t\t    bus_addr_t end, bus_addr_t offset,\n\t\t\t\t    int flags));"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/cardbus/rbus.h>\n#include <machine/bus.h>\n#include <sys/extent.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include <sys/types.h>\n\nstruct extent *ex, bus_addr_t start,\n\t\t\t\t    bus_addr_t end, bus_addr_t offset,\n\t\t\t\t    int flags));\n\nint\nrbus_space_alloc_subregion(rbt, substart, subend, addr, size, mask, align, flags, addrp, bshp)\n     rbus_tag_t rbt;\n     bus_addr_t addr;\n     bus_addr_t substart;\n     bus_addr_t subend;\n     bus_size_t size;\n     bus_addr_t mask, align;\n     int flags;\n     bus_addr_t *addrp;\n     bus_space_handle_t *bshp;\n{\n  bus_addr_t decodesize = mask + 1;\n  bus_addr_t boundary, search_addr;\n  int val = 0;\n  bus_addr_t result;\n  int exflags = EX_FAST | EX_NOWAIT;\n\n  DPRINTF((\"rbus_space_alloc: addr %lx, size %lx, mask %lx, align %lx\\n\",\n\t   addr, size, mask, align));\n\n  addr += rbt->rb_offset;\n\n  if (mask == 0) {\n    /* FULL Decode */\n    decodesize = 0;\n  }\n\n  if (rbt->rb_flags == RBUS_SPACE_ASK_PARENT) {\n    return rbus_space_alloc(rbt->rb_parent, addr, size, mask, align, flags,\n\t\t\t    addrp, bshp);\n  } else if (rbt->rb_flags == RBUS_SPACE_SHARE ||\n\t     rbt->rb_flags == RBUS_SPACE_DEDICATE) {\n    /* rbt has its own sh_extent */\n\n    /* sanity check: the subregion [substart, subend] should be\n       smaller than the region included in sh_extent */\n    if (substart < rbt->rb_ext->ex_start || subend > rbt->rb_ext->ex_end) {\n      return 1;\n    }\n\n    if (decodesize == align) {\n      if(extent_alloc_subregion(rbt->rb_ext, substart, subend, size, align, 0,\n\t\t\t\texflags, (u_long *)&result)) {\n\treturn 1;\n      }\n    } else if (decodesize == 0) {\n      /* maybe, the resister is overflowed. */\n      \n      if (extent_alloc_subregion(rbt->rb_ext, addr, addr + size, size,\n\t\t\t\t 0, 0, exflags, (u_long *)&result)) {\n\treturn 1;\n      }\n    } else {\n\n      boundary = decodesize > align ? decodesize : align;\n\n      search_addr = (substart & ~(boundary - 1)) + addr;\n\n      if (search_addr < substart) {\n\tsearch_addr += boundary;\n      }\n\n      for (; search_addr + size <= subend; search_addr += boundary) {\n\tval = extent_alloc_subregion(rbt->rb_ext,search_addr, search_addr+size,\n\t\t\t\tsize, align, 0, exflags, (u_long *)&result);\n\tif (val == 0) {\n\t  break;\n\t}\n      }\n      if (val) {\n\treturn 1;\n      }\n    }\n\n    if(md_space_map(rbt->rb_bt, result, size, flags, bshp)) {\n      /* map failed */\n      extent_free(rbt->rb_ext, result, size, exflags);\n      return 1;\n    }\n\n    if (addrp != NULL) {\n      *addrp = result + rbt->rb_offset;\n    }\n    return 0;\n\n  } else {\n    /* error!! */\n    return 1;\n  }\n  return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\neso_attach __P((struct device *, struct device *, void *));\nHIDE void;\neso_defer __P((struct device *));\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\n\nHIDE void\neso_defer(self)\n\tstruct device *self;\n{\n\tstruct eso_softc *sc = (struct eso_softc *)self;\n\tstruct pci_attach_args *pa = &sc->sc_pa;\n\tbus_addr_t addr, start;\n\n\tprintf(\"%s: \", sc->sc_dev.dv_xname);\n\n\t/*\n\t * This is outright ugly, but since we must not make assumptions\n\t * on the underlying allocator's behaviour it's the most straight-\n\t * forward way to implement it.  Note that we skip over the first\n\t * 1K region, which is typically occupied by an attached ISA bus.\n\t */\n\tfor (start = 0x0400; start < 0xffff; start += 0x0400) {\n\t\tif (bus_space_alloc(sc->sc_iot,\n\t\t    start + sc->sc_vcsize, start + 0x0400 - 1,\n\t\t    sc->sc_vcsize, sc->sc_vcsize, 0, 0, &addr,\n\t\t    &sc->sc_dmac_ioh) != 0)\n\t\t\tcontinue;\n\n\t\tpci_conf_write(pa->pa_pc, pa->pa_tag, ESO_PCI_DDMAC,\n\t\t    addr | ESO_PCI_DDMAC_DE);\n\t\tsc->sc_dmac_iot = sc->sc_iot;\n\t\tsc->sc_dmac_configured = 1;\n\t\tprintf(\"mapping Audio 1 DMA using I/O space at 0x%lx\\n\",\n\t\t    (unsigned long)addr);\n\n\t\treturn;\n\t}\n\t\n\tprintf(\"can't map Audio 1 DMA into I/O space\\n\");\n}"
  },
  {
    "function_name": "eso_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "222-398",
    "snippet": "HIDE void\neso_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct eso_softc *sc = (struct eso_softc *)self;\n\tstruct pci_attach_args *pa = aux;\n\tstruct audio_attach_args aa;\n\tpci_intr_handle_t ih;\n\tbus_addr_t vcbase;\n\tconst char *intrstring;\n\tint idx;\n\tuint8_t a2mode;\n\n\tsc->sc_revision = PCI_REVISION(pa->pa_class);\n\n\tif (sc->sc_revision <\n\t    sizeof (eso_rev2model) / sizeof (eso_rev2model[0]))\n\t\tprintf(\": %s\", eso_rev2model[sc->sc_revision]);\n\telse\n\t\tprintf(\": (unknown rev. 0x%02x)\", sc->sc_revision);\n\n\t/* Map I/O registers. */\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_IO, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_iot, &sc->sc_ioh, NULL, NULL)) {\n\t\tprintf(\", can't map I/O space\\n\");\n\t\treturn;\n\t}\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_SB, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_sb_iot, &sc->sc_sb_ioh, NULL, NULL)) {\n\t\tprintf(\", can't map SB I/O space\\n\");\n\t\treturn;\n\t}\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_VC, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_dmac_iot, &sc->sc_dmac_ioh, &vcbase, &sc->sc_vcsize)) {\n\t\tvcbase = 0;\n\t\tsc->sc_vcsize = 0x10; /* From the data sheet. */\n\t}\n\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_MPU, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_mpu_iot, &sc->sc_mpu_ioh, NULL, NULL)) {\n\t\tprintf(\", can't map MPU I/O space\\n\");\n\t\treturn;\n\t}\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_GAME, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_game_iot, &sc->sc_game_ioh, NULL, NULL)) {\n\t\tprintf(\", can't map Game I/O space\\n\");\n\t\treturn;\n\t}\n\n\tsc->sc_dmat = pa->pa_dmat;\n\tsc->sc_dmas = NULL;\n\tsc->sc_dmac_configured = 0;\n\n\t/* Enable bus mastering. */\n\tpci_conf_write(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG,\n\t    pci_conf_read(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG) |\n\t    PCI_COMMAND_MASTER_ENABLE);\n\n\t/* Reset the device; bail out upon failure. */\n\tif (eso_reset(sc) != 0) {\n\t\tprintf(\", can't reset\\n\");\n\t\treturn;\n\t}\n\t\n\t/* Select the DMA/IRQ policy: DDMA, ISA IRQ emulation disabled. */\n\tpci_conf_write(pa->pa_pc, pa->pa_tag, ESO_PCI_S1C,\n\t    pci_conf_read(pa->pa_pc, pa->pa_tag, ESO_PCI_S1C) &\n\t    ~(ESO_PCI_S1C_IRQP_MASK | ESO_PCI_S1C_DMAP_MASK));\n\n\t/* Enable the relevant DMA interrupts. */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, ESO_IO_IRQCTL,\n\t    ESO_IO_IRQCTL_A1IRQ | ESO_IO_IRQCTL_A2IRQ);\n\t\n\t/* Set up A1's sample rate generator for new-style parameters. */\n\ta2mode = eso_read_mixreg(sc, ESO_MIXREG_A2MODE);\n\ta2mode |= ESO_MIXREG_A2MODE_NEWA1 | ESO_MIXREG_A2MODE_ASYNC;\n\teso_write_mixreg(sc, ESO_MIXREG_A2MODE, a2mode);\n\t\n\t/* Set mixer regs to something reasonable, needs work. */\n\tfor (idx = 0; idx < ESO_NGAINDEVS; idx++) {\n\t\tint v;\n\t\t\n\t\tswitch (idx) {\n \t\tcase ESO_MIC_PLAY_VOL:\n\t\tcase ESO_LINE_PLAY_VOL:\n\t\tcase ESO_CD_PLAY_VOL:\n\t\tcase ESO_MONO_PLAY_VOL:\n\t\tcase ESO_AUXB_PLAY_VOL:\n\t\tcase ESO_DAC_REC_VOL:\n\t\tcase ESO_LINE_REC_VOL:\n\t\tcase ESO_SYNTH_REC_VOL:\n\t\tcase ESO_CD_REC_VOL:\n\t\tcase ESO_MONO_REC_VOL:\n\t\tcase ESO_AUXB_REC_VOL:\n\t\tcase ESO_SPATIALIZER:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\tcase ESO_MASTER_VOL:\n\t\t\tv = ESO_GAIN_TO_6BIT(AUDIO_MAX_GAIN / 2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tv = ESO_GAIN_TO_4BIT(AUDIO_MAX_GAIN / 2);\n\t\t\tbreak;\n\t\t}\n\t\tsc->sc_gain[idx][ESO_LEFT] = sc->sc_gain[idx][ESO_RIGHT] = v;\n\t\teso_set_gain(sc, idx);\n\t}\n\teso_set_recsrc(sc, ESO_MIXREG_ERS_MIC);\n\t\n\t/* Map and establish the interrupt. */\n\tif (pci_intr_map(pa->pa_pc, pa->pa_intrtag, pa->pa_intrpin,\n\t    pa->pa_intrline, &ih)) {\n\t\tprintf(\", couldn't map interrupt\\n\");\n\t\treturn;\n\t}\n\tintrstring = pci_intr_string(pa->pa_pc, ih);\n#ifdef __OpenBSD__\n\tsc->sc_ih  = pci_intr_establish(pa->pa_pc, ih, IPL_AUDIO, eso_intr, sc,\n\t    sc->sc_dev.dv_xname);\n#else\n\tsc->sc_ih  = pci_intr_establish(pa->pa_pc, ih, IPL_AUDIO, eso_intr, sc);\n#endif\n\tif (sc->sc_ih == NULL) {\n\t\tprintf(\", couldn't establish interrupt\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tif (intrstring != NULL)\n\t\t\tprintf(\" at %s\", intrstring);\n\t\tprintf(\"\\n\");\n\t\treturn;\n\t}\n\tprintf(\", %s\\n\", intrstring);\n\n\t/*\n\t * Set up the DDMA Control register; a suitable I/O region has been\n\t * supposedly mapped in the VC base address register.\n\t *\n\t * The Solo-1 has an ... interesting silicon bug that causes it to\n\t * not respond to I/O space accesses to the Audio 1 DMA controller\n\t * if the latter's mapping base address is aligned on a 1K boundary.\n\t * As a consequence, it is quite possible for the mapping provided\n\t * in the VC BAR to be useless.  To work around this, we defer this\n\t * part until all autoconfiguration on our parent bus is completed\n\t * and then try to map it ourselves in fulfillment of the constraint.\n\t * \n\t * According to the register map we may write to the low 16 bits\n\t * only, but experimenting has shown we're safe.\n\t * -kjk\n\t */\n\tif (ESO_VALID_DDMAC_BASE(vcbase)) {\n\t\tpci_conf_write(pa->pa_pc, pa->pa_tag, ESO_PCI_DDMAC,\n\t\t    vcbase | ESO_PCI_DDMAC_DE);\n\t\tsc->sc_dmac_configured = 1;\n\n\t\tprintf(\"%s: mapping Audio 1 DMA using VC I/O space at 0x%lx\\n\",\n\t\t    sc->sc_dev.dv_xname, (unsigned long)vcbase);\n\t} else {\n\t\tDPRINTF((\"%s: VC I/O space at 0x%lx not suitable, deferring\\n\",\n\t\t    sc->sc_dev.dv_xname, (unsigned long)vcbase));\n\t\tsc->sc_pa = *pa;\n\t\tconfig_defer(self, eso_defer);\n\t}\n\t\n\taudio_attach_mi(&eso_hw_if, sc, &sc->sc_dev);\n\n\taa.type = AUDIODEV_TYPE_OPL;\n\taa.hwif = NULL;\n\taa.hdl = NULL;\n\t(void)config_found(&sc->sc_dev, &aa, audioprint);\n\n#if 0\n\taa.type = AUDIODEV_TYPE_MPU;\n\taa.hwif = NULL;\n\taa.hdl = NULL;\n\tsc->sc_mpudev = config_found(&sc->sc_dev, &aa, audioprint);\n#endif\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define HIDE static",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "HIDE void",
      "eso_attach __P((struct device *, struct device *, void *));",
      "HIDE void",
      "eso_defer __P((struct device *));",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "audio_hw_if eso_hw_if = {\n\teso_open,\n\teso_close,\n\tNULL,\t\t\t/* drain */\n\teso_query_encoding,\n\teso_set_params,\n\teso_round_blocksize,\n\tNULL,\t\t\t/* commit_settings */\n\tNULL,\t\t\t/* init_output */\n\tNULL,\t\t\t/* init_input */\n\tNULL,\t\t\t/* start_output */\n\tNULL,\t\t\t/* start_input */\n\teso_halt_output,\n\teso_halt_input,\n\tNULL,\t\t\t/* speaker_ctl */\n\teso_getdev,\n\tNULL,\t\t\t/* setfd */\n\teso_set_port,\n\teso_get_port,\n\teso_query_devinfo,\n\teso_allocm,\n\teso_freem,\n\teso_round_buffersize,\n\teso_mappage,\n\teso_get_props,\n\teso_trigger_output,\n\teso_trigger_input\n};",
      "HIDE const char * const eso_rev2model[] = {\n\t\"ES1938\",\n\t\"ES1946\",\n\t\"ES1946 rev E\"\n};",
      "HIDE uint8_t",
      "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
      "HIDE uint8_t",
      "eso_read_rdr __P((struct eso_softc *));",
      "HIDE int",
      "eso_reset __P((struct eso_softc *));",
      "HIDE void",
      "eso_set_gain __P((struct eso_softc *, unsigned int));",
      "HIDE int",
      "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
      "HIDE void",
      "eso_write_cmd __P((struct eso_softc *, uint8_t));",
      "HIDE void",
      "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE void",
      "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
      "HIDE int",
      "HIDE void",
      "void *hdl;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "config_found",
          "args": [
            "&sc->sc_dev",
            "&aa",
            "audioprint"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_found",
          "args": [
            "&sc->sc_dev",
            "&aa",
            "audioprint"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "audio_attach_mi",
          "args": [
            "&eso_hw_if",
            "sc",
            "&sc->sc_dev"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "audio_attach_mi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "394-408",
          "snippet": "void\naudio_attach_mi(ahwp, hdlp, dev)\n\tstruct audio_hw_if *ahwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n\tif (ahwp != NULL) {\n\t\targ.type = AUDIODEV_TYPE_AUDIO;\n\t\targ.hwif = ahwp;\n\t\targ.hdl = hdlp;\n\t\t(void)config_found(dev, &arg, audioprint);\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nvoid\naudio_attach_mi(ahwp, hdlp, dev)\n\tstruct audio_hw_if *ahwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n\tif (ahwp != NULL) {\n\t\targ.type = AUDIODEV_TYPE_AUDIO;\n\t\targ.hwif = ahwp;\n\t\targ.hdl = hdlp;\n\t\t(void)config_found(dev, &arg, audioprint);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_defer",
          "args": [
            "self",
            "eso_defer"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: VC I/O space at 0x%lx not suitable, deferring\\n\",\n\t\t    sc->sc_dev.dv_xname, (unsigned long)vcbase)"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: mapping Audio 1 DMA using VC I/O space at 0x%lx\\n\"",
            "sc->sc_dev.dv_xname",
            "(unsigned long)vcbase"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pci_conf_write",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "ESO_PCI_DDMAC",
            "vcbase | ESO_PCI_DDMAC_DE"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_VALID_DDMAC_BASE",
          "args": [
            "vcbase"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_intr_establish",
          "args": [
            "pa->pa_pc",
            "ih",
            "IPL_AUDIO",
            "eso_intr",
            "sc"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_intr_establish",
          "args": [
            "pa->pa_pc",
            "ih",
            "IPL_AUDIO",
            "eso_intr",
            "sc",
            "sc->sc_dev.dv_xname"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_intr_string",
          "args": [
            "pa->pa_pc",
            "ih"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_intr_map",
          "args": [
            "pa->pa_pc",
            "pa->pa_intrtag",
            "pa->pa_intrpin",
            "pa->pa_intrline",
            "&ih"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_set_recsrc",
          "args": [
            "sc",
            "ESO_MIXREG_ERS_MIC"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "eso_set_recsrc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "1805-1814",
          "snippet": "HIDE int\neso_set_recsrc(sc, recsrc)\n\tstruct eso_softc *sc;\n\tunsigned int recsrc;\n{\n\n\teso_write_mixreg(sc, ESO_MIXREG_ERS, recsrc);\n\tsc->sc_recsrc = recsrc;\n\treturn (0);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\n\nHIDE int\neso_set_recsrc(sc, recsrc)\n\tstruct eso_softc *sc;\n\tunsigned int recsrc;\n{\n\n\teso_write_mixreg(sc, ESO_MIXREG_ERS, recsrc);\n\tsc->sc_recsrc = recsrc;\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_set_gain",
          "args": [
            "sc",
            "idx"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "eso_set_gain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "1816-1909",
          "snippet": "HIDE void\neso_set_gain(sc, port)\n\tstruct eso_softc *sc;\n\tunsigned int port;\n{\n\tuint8_t mixreg, tmp;\n\n\tswitch (port) {\n\tcase ESO_DAC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_AUXB;\n\t\tbreak;\n\t\t    \n\tcase ESO_DAC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_AUXB;\n\t\tbreak;\n\tcase ESO_MONO_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MONO;\n\t\tbreak;\n\tcase ESO_MONO_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MONO;\n\t\tbreak;\n\t\t\n\tcase ESO_PCSPEAKER_VOL:\n\t\t/* Special case - only 3-bit, mono, and reserved bits. */\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_PCSVR);\n\t\ttmp &= ESO_MIXREG_PCSVR_RESV;\n\t\t/* Map bits 7:5 -> 2:0. */\n\t\ttmp |= (sc->sc_gain[port][ESO_LEFT] >> 5);\n\t\teso_write_mixreg(sc, ESO_MIXREG_PCSVR, tmp);\n\t\treturn;\n\n\tcase ESO_MASTER_VOL:\n\t\t/* Special case - separate regs, and 6-bit precision. */\n\t\t/* Map bits 7:2 -> 5:0. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_LMVM,\n\t\t    sc->sc_gain[port][ESO_LEFT] >> 2);\n\t\teso_write_mixreg(sc, ESO_MIXREG_RMVM,\n\t\t    sc->sc_gain[port][ESO_RIGHT] >> 2);\n\t\treturn;\n\n\tcase ESO_SPATIALIZER:\n\t\t/* Special case - only `mono', and higher precision. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_SPATLVL,\n\t\t    sc->sc_gain[port][ESO_LEFT]);\n\t\treturn;\n\t\t\n\tcase ESO_RECORD_VOL:\n\t\t/* Very Special case, controller register. */\n\t\teso_write_ctlreg(sc, ESO_CTLREG_RECLVL,ESO_4BIT_GAIN_TO_STEREO(\n\t\t   sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n\t\treturn;\n\n\tdefault:\n#ifdef DIAGNOSTIC\t\t\n\t\tpanic(\"eso_set_gain: bad port %u\", port);\n\t\t/* NOTREACHED */\n#else\n\t\treturn;\n#endif\t\t\n\t\t}\n\n\teso_write_mixreg(sc, mixreg, ESO_4BIT_GAIN_TO_STEREO(\n\t    sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_set_gain(sc, port)\n\tstruct eso_softc *sc;\n\tunsigned int port;\n{\n\tuint8_t mixreg, tmp;\n\n\tswitch (port) {\n\tcase ESO_DAC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_AUXB;\n\t\tbreak;\n\t\t    \n\tcase ESO_DAC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_A2;\n\t\tbreak;\n\tcase ESO_MIC_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MIC;\n\t\tbreak;\n\tcase ESO_LINE_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_LINE;\n\t\tbreak;\n\tcase ESO_SYNTH_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_SYNTH;\n\t\tbreak;\n\tcase ESO_CD_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_CD;\n\t\tbreak;\n\tcase ESO_AUXB_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_AUXB;\n\t\tbreak;\n\tcase ESO_MONO_PLAY_VOL:\n\t\tmixreg = ESO_MIXREG_PVR_MONO;\n\t\tbreak;\n\tcase ESO_MONO_REC_VOL:\n\t\tmixreg = ESO_MIXREG_RVR_MONO;\n\t\tbreak;\n\t\t\n\tcase ESO_PCSPEAKER_VOL:\n\t\t/* Special case - only 3-bit, mono, and reserved bits. */\n\t\ttmp = eso_read_mixreg(sc, ESO_MIXREG_PCSVR);\n\t\ttmp &= ESO_MIXREG_PCSVR_RESV;\n\t\t/* Map bits 7:5 -> 2:0. */\n\t\ttmp |= (sc->sc_gain[port][ESO_LEFT] >> 5);\n\t\teso_write_mixreg(sc, ESO_MIXREG_PCSVR, tmp);\n\t\treturn;\n\n\tcase ESO_MASTER_VOL:\n\t\t/* Special case - separate regs, and 6-bit precision. */\n\t\t/* Map bits 7:2 -> 5:0. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_LMVM,\n\t\t    sc->sc_gain[port][ESO_LEFT] >> 2);\n\t\teso_write_mixreg(sc, ESO_MIXREG_RMVM,\n\t\t    sc->sc_gain[port][ESO_RIGHT] >> 2);\n\t\treturn;\n\n\tcase ESO_SPATIALIZER:\n\t\t/* Special case - only `mono', and higher precision. */\n\t\teso_write_mixreg(sc, ESO_MIXREG_SPATLVL,\n\t\t    sc->sc_gain[port][ESO_LEFT]);\n\t\treturn;\n\t\t\n\tcase ESO_RECORD_VOL:\n\t\t/* Very Special case, controller register. */\n\t\teso_write_ctlreg(sc, ESO_CTLREG_RECLVL,ESO_4BIT_GAIN_TO_STEREO(\n\t\t   sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n\t\treturn;\n\n\tdefault:\n#ifdef DIAGNOSTIC\t\t\n\t\tpanic(\"eso_set_gain: bad port %u\", port);\n\t\t/* NOTREACHED */\n#else\n\t\treturn;\n#endif\t\t\n\t\t}\n\n\teso_write_mixreg(sc, mixreg, ESO_4BIT_GAIN_TO_STEREO(\n\t    sc->sc_gain[port][ESO_LEFT], sc->sc_gain[port][ESO_RIGHT]));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_4BIT",
          "args": [
            "AUDIO_MAX_GAIN / 2"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ESO_GAIN_TO_6BIT",
          "args": [
            "AUDIO_MAX_GAIN / 2"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_write_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_A2MODE",
            "a2mode"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "eso_write_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "505-518",
          "snippet": "HIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE void\neso_write_mixreg(sc, reg, val)\n\tstruct eso_softc *sc;\n\tuint8_t reg, val;\n{\n\tint s;\n\n\t/* DPRINTF((\"mixreg 0x%02x = 0x%02x\\n\", reg, val)); */\n\t\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA, val);\n\tsplx(s);\n}"
        }
      },
      {
        "call_info": {
          "callee": "eso_read_mixreg",
          "args": [
            "sc",
            "ESO_MIXREG_A2MODE"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "eso_read_mixreg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "520-534",
          "snippet": "HIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "HIDE uint8_t",
            "eso_read_ctlreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_mixreg __P((struct eso_softc *, uint8_t));",
            "HIDE uint8_t",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "eso_write_cmd __P((struct eso_softc *, uint8_t));",
            "HIDE void",
            "eso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE void",
            "eso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\n\nHIDE uint8_t\neso_read_mixreg(sc, reg)\n\tstruct eso_softc *sc;\n\tuint8_t reg;\n{\n\tint s;\n\tuint8_t val;\n\n\ts = splaudio();\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERADDR, reg);\n\tval = bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_MIXERDATA);\n\tsplx(s);\n\t\n\treturn (val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bus_space_write_1",
          "args": [
            "sc->sc_iot",
            "sc->sc_ioh",
            "ESO_IO_IRQCTL",
            "ESO_IO_IRQCTL_A1IRQ | ESO_IO_IRQCTL_A2IRQ"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_conf_write",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "ESO_PCI_S1C",
            "pci_conf_read(pa->pa_pc, pa->pa_tag, ESO_PCI_S1C) &\n\t    ~(ESO_PCI_S1C_IRQP_MASK | ESO_PCI_S1C_DMAP_MASK)"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_conf_read",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "ESO_PCI_S1C"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eso_reset",
          "args": [
            "sc"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "eso_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
          "lines": "582-616",
          "snippet": "HIDE int\neso_reset(sc)\n\tstruct eso_softc *sc;\n{\n\tint i;\n\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RESET,\n\t    ESO_SB_RESET_SW | ESO_SB_RESET_FIFO);\n\t/* `Delay' suggested in the data sheet. */\n\t(void)bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_STATUS);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RESET, 0);\n\n\t/* Wait for reset to take effect. */\n\tfor (i = 0; i < ESO_RESET_TIMEOUT; i++) {\n\t\t/* Poll for data to become available. */\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR) & ESO_SB_RBSR_RDAV) != 0 &&\n\t\t    bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\tESO_SB_RDR) == ESO_SB_RDR_RESETMAGIC) {\n\n\t\t\t/* Activate Solo-1 extension commands. */\n\t\t\teso_write_cmd(sc, ESO_CMD_EXTENB);\n\t\t\t/* Reset mixer registers. */\n\t\t\teso_write_mixreg(sc, ESO_MIXREG_RESET,\n\t\t\t    ESO_MIXREG_RESET_RESET);\n\n\t\t\treturn (0);\n\t\t} else {\n\t\t\tdelay(1000);\n\t\t}\n\t}\n\t\n\tprintf(\"%s: reset timeout\\n\", sc->sc_dev.dv_xname);\n\treturn (-1);\n}",
          "includes": [
            "#include <machine/bswap.h>",
            "#include <machine/endian.h>",
            "#include <machine/intr.h>",
            "#include <machine/bus.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/pci/esovar.h>",
            "#include <dev/pci/esoreg.h>",
            "#include <dev/ic/i8237reg.h>",
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/auconv.h>",
            "#include <dev/mulaw.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/audioio.h>",
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcidevs.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/malloc.h>",
            "#include <sys/kernel.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define HIDE static",
            "#define HIDE"
          ],
          "globals_used": [
            "HIDE int",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE void",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE int",
            "HIDE struct",
            "eso_read_rdr __P((struct eso_softc *));",
            "HIDE int",
            "eso_reset __P((struct eso_softc *));",
            "HIDE void",
            "eso_set_gain __P((struct eso_softc *, unsigned int));",
            "HIDE int",
            "eso_set_recsrc __P((struct eso_softc *, unsigned int));",
            "HIDE void",
            "HIDE void",
            "HIDE void",
            "HIDE int",
            "HIDE void"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\n\nHIDE int\neso_reset(sc)\n\tstruct eso_softc *sc;\n{\n\tint i;\n\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RESET,\n\t    ESO_SB_RESET_SW | ESO_SB_RESET_FIFO);\n\t/* `Delay' suggested in the data sheet. */\n\t(void)bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_STATUS);\n\tbus_space_write_1(sc->sc_sb_iot, sc->sc_sb_ioh, ESO_SB_RESET, 0);\n\n\t/* Wait for reset to take effect. */\n\tfor (i = 0; i < ESO_RESET_TIMEOUT; i++) {\n\t\t/* Poll for data to become available. */\n\t\tif ((bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t    ESO_SB_RBSR) & ESO_SB_RBSR_RDAV) != 0 &&\n\t\t    bus_space_read_1(sc->sc_sb_iot, sc->sc_sb_ioh,\n\t\t\tESO_SB_RDR) == ESO_SB_RDR_RESETMAGIC) {\n\n\t\t\t/* Activate Solo-1 extension commands. */\n\t\t\teso_write_cmd(sc, ESO_CMD_EXTENB);\n\t\t\t/* Reset mixer registers. */\n\t\t\teso_write_mixreg(sc, ESO_MIXREG_RESET,\n\t\t\t    ESO_MIXREG_RESET_RESET);\n\n\t\t\treturn (0);\n\t\t} else {\n\t\t\tdelay(1000);\n\t\t}\n\t}\n\t\n\tprintf(\"%s: reset timeout\\n\", sc->sc_dev.dv_xname);\n\treturn (-1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pci_conf_write",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "PCI_COMMAND_STATUS_REG",
            "pci_conf_read(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG) |\n\t    PCI_COMMAND_MASTER_ENABLE"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_conf_read",
          "args": [
            "pa->pa_pc",
            "pa->pa_tag",
            "PCI_COMMAND_STATUS_REG"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pci_mapreg_map",
          "args": [
            "pa",
            "ESO_PCI_BAR_GAME",
            "PCI_MAPREG_TYPE_IO",
            "0",
            "&sc->sc_game_iot",
            "&sc->sc_game_ioh",
            "NULL",
            "NULL"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "pci_mapreg_map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/pci_map.c",
          "lines": "230-275",
          "snippet": "int\npci_mapreg_map(pa, reg, type, busflags, tagp, handlep, basep, sizep)\n\tstruct pci_attach_args *pa;\n\tint reg, busflags;\n\tpcireg_t type;\n\tbus_space_tag_t *tagp;\n\tbus_space_handle_t *handlep;\n\tbus_addr_t *basep;\n\tbus_size_t *sizep;\n{\n\tbus_space_tag_t tag;\n\tbus_space_handle_t handle;\n\tbus_addr_t base;\n\tbus_size_t size;\n\tint flags;\n\n\tif (PCI_MAPREG_TYPE(type) == PCI_MAPREG_TYPE_IO) {\n\t\tif ((pa->pa_flags & PCI_FLAGS_IO_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_io_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t     &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_iot;\n\t} else {\n\t\tif ((pa->pa_flags & PCI_FLAGS_MEM_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_mem_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t      &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_memt;\n\t}\n\n\tif (bus_space_map(tag, base, size, busflags | flags, &handle))\n\t\treturn (1);\n\n\tif (tagp != 0)\n\t\t*tagp = tag;\n\tif (handlep != 0)\n\t\t*handlep = handle;\n\tif (basep != 0)\n\t\t*basep = base;\n\tif (sizep != 0)\n\t\t*sizep = size;\n\n\treturn (0);\n}",
          "includes": [
            "#include <dev/pci/pcivar.h>",
            "#include <dev/pci/pcireg.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int nbsd_pci_io_find",
            "static int nbsd_pci_mem_find"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/pci/pcivar.h>\n#include <dev/pci/pcireg.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic int nbsd_pci_io_find;\nstatic int nbsd_pci_mem_find;\n\nint\npci_mapreg_map(pa, reg, type, busflags, tagp, handlep, basep, sizep)\n\tstruct pci_attach_args *pa;\n\tint reg, busflags;\n\tpcireg_t type;\n\tbus_space_tag_t *tagp;\n\tbus_space_handle_t *handlep;\n\tbus_addr_t *basep;\n\tbus_size_t *sizep;\n{\n\tbus_space_tag_t tag;\n\tbus_space_handle_t handle;\n\tbus_addr_t base;\n\tbus_size_t size;\n\tint flags;\n\n\tif (PCI_MAPREG_TYPE(type) == PCI_MAPREG_TYPE_IO) {\n\t\tif ((pa->pa_flags & PCI_FLAGS_IO_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_io_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t     &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_iot;\n\t} else {\n\t\tif ((pa->pa_flags & PCI_FLAGS_MEM_ENABLED) == 0)\n\t\t\treturn (1);\n\t\tif (nbsd_pci_mem_find(pa->pa_pc, pa->pa_tag, reg, type, &base,\n\t\t\t\t      &size, &flags))\n\t\t\treturn (1);\n\t\ttag = pa->pa_memt;\n\t}\n\n\tif (bus_space_map(tag, base, size, busflags | flags, &handle))\n\t\treturn (1);\n\n\tif (tagp != 0)\n\t\t*tagp = tag;\n\tif (handlep != 0)\n\t\t*handlep = handle;\n\tif (basep != 0)\n\t\t*basep = base;\n\tif (sizep != 0)\n\t\t*sizep = size;\n\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PCI_REVISION",
          "args": [
            "pa->pa_class"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define HIDE static\n#define HIDE\n\nHIDE int;\nHIDE void;\neso_attach __P((struct device *, struct device *, void *));\nHIDE void;\neso_defer __P((struct device *));\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\naudio_hw_if eso_hw_if = {\n\teso_open,\n\teso_close,\n\tNULL,\t\t\t/* drain */\n\teso_query_encoding,\n\teso_set_params,\n\teso_round_blocksize,\n\tNULL,\t\t\t/* commit_settings */\n\tNULL,\t\t\t/* init_output */\n\tNULL,\t\t\t/* init_input */\n\tNULL,\t\t\t/* start_output */\n\tNULL,\t\t\t/* start_input */\n\teso_halt_output,\n\teso_halt_input,\n\tNULL,\t\t\t/* speaker_ctl */\n\teso_getdev,\n\tNULL,\t\t\t/* setfd */\n\teso_set_port,\n\teso_get_port,\n\teso_query_devinfo,\n\teso_allocm,\n\teso_freem,\n\teso_round_buffersize,\n\teso_mappage,\n\teso_get_props,\n\teso_trigger_output,\n\teso_trigger_input\n};\nHIDE const char * const eso_rev2model[] = {\n\t\"ES1938\",\n\t\"ES1946\",\n\t\"ES1946 rev E\"\n};\nHIDE uint8_t;\neso_read_ctlreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_mixreg __P((struct eso_softc *, uint8_t));\nHIDE uint8_t;\neso_read_rdr __P((struct eso_softc *));\nHIDE int;\neso_reset __P((struct eso_softc *));\nHIDE void;\neso_set_gain __P((struct eso_softc *, unsigned int));\nHIDE int;\neso_set_recsrc __P((struct eso_softc *, unsigned int));\nHIDE void;\neso_write_cmd __P((struct eso_softc *, uint8_t));\nHIDE void;\neso_write_ctlreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE void;\neso_write_mixreg __P((struct eso_softc *, uint8_t, uint8_t));\nHIDE int;\nHIDE void;\nvoid *hdl;\n\nHIDE void\neso_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct eso_softc *sc = (struct eso_softc *)self;\n\tstruct pci_attach_args *pa = aux;\n\tstruct audio_attach_args aa;\n\tpci_intr_handle_t ih;\n\tbus_addr_t vcbase;\n\tconst char *intrstring;\n\tint idx;\n\tuint8_t a2mode;\n\n\tsc->sc_revision = PCI_REVISION(pa->pa_class);\n\n\tif (sc->sc_revision <\n\t    sizeof (eso_rev2model) / sizeof (eso_rev2model[0]))\n\t\tprintf(\": %s\", eso_rev2model[sc->sc_revision]);\n\telse\n\t\tprintf(\": (unknown rev. 0x%02x)\", sc->sc_revision);\n\n\t/* Map I/O registers. */\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_IO, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_iot, &sc->sc_ioh, NULL, NULL)) {\n\t\tprintf(\", can't map I/O space\\n\");\n\t\treturn;\n\t}\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_SB, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_sb_iot, &sc->sc_sb_ioh, NULL, NULL)) {\n\t\tprintf(\", can't map SB I/O space\\n\");\n\t\treturn;\n\t}\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_VC, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_dmac_iot, &sc->sc_dmac_ioh, &vcbase, &sc->sc_vcsize)) {\n\t\tvcbase = 0;\n\t\tsc->sc_vcsize = 0x10; /* From the data sheet. */\n\t}\n\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_MPU, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_mpu_iot, &sc->sc_mpu_ioh, NULL, NULL)) {\n\t\tprintf(\", can't map MPU I/O space\\n\");\n\t\treturn;\n\t}\n\tif (pci_mapreg_map(pa, ESO_PCI_BAR_GAME, PCI_MAPREG_TYPE_IO, 0,\n\t    &sc->sc_game_iot, &sc->sc_game_ioh, NULL, NULL)) {\n\t\tprintf(\", can't map Game I/O space\\n\");\n\t\treturn;\n\t}\n\n\tsc->sc_dmat = pa->pa_dmat;\n\tsc->sc_dmas = NULL;\n\tsc->sc_dmac_configured = 0;\n\n\t/* Enable bus mastering. */\n\tpci_conf_write(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG,\n\t    pci_conf_read(pa->pa_pc, pa->pa_tag, PCI_COMMAND_STATUS_REG) |\n\t    PCI_COMMAND_MASTER_ENABLE);\n\n\t/* Reset the device; bail out upon failure. */\n\tif (eso_reset(sc) != 0) {\n\t\tprintf(\", can't reset\\n\");\n\t\treturn;\n\t}\n\t\n\t/* Select the DMA/IRQ policy: DDMA, ISA IRQ emulation disabled. */\n\tpci_conf_write(pa->pa_pc, pa->pa_tag, ESO_PCI_S1C,\n\t    pci_conf_read(pa->pa_pc, pa->pa_tag, ESO_PCI_S1C) &\n\t    ~(ESO_PCI_S1C_IRQP_MASK | ESO_PCI_S1C_DMAP_MASK));\n\n\t/* Enable the relevant DMA interrupts. */\n\tbus_space_write_1(sc->sc_iot, sc->sc_ioh, ESO_IO_IRQCTL,\n\t    ESO_IO_IRQCTL_A1IRQ | ESO_IO_IRQCTL_A2IRQ);\n\t\n\t/* Set up A1's sample rate generator for new-style parameters. */\n\ta2mode = eso_read_mixreg(sc, ESO_MIXREG_A2MODE);\n\ta2mode |= ESO_MIXREG_A2MODE_NEWA1 | ESO_MIXREG_A2MODE_ASYNC;\n\teso_write_mixreg(sc, ESO_MIXREG_A2MODE, a2mode);\n\t\n\t/* Set mixer regs to something reasonable, needs work. */\n\tfor (idx = 0; idx < ESO_NGAINDEVS; idx++) {\n\t\tint v;\n\t\t\n\t\tswitch (idx) {\n \t\tcase ESO_MIC_PLAY_VOL:\n\t\tcase ESO_LINE_PLAY_VOL:\n\t\tcase ESO_CD_PLAY_VOL:\n\t\tcase ESO_MONO_PLAY_VOL:\n\t\tcase ESO_AUXB_PLAY_VOL:\n\t\tcase ESO_DAC_REC_VOL:\n\t\tcase ESO_LINE_REC_VOL:\n\t\tcase ESO_SYNTH_REC_VOL:\n\t\tcase ESO_CD_REC_VOL:\n\t\tcase ESO_MONO_REC_VOL:\n\t\tcase ESO_AUXB_REC_VOL:\n\t\tcase ESO_SPATIALIZER:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\tcase ESO_MASTER_VOL:\n\t\t\tv = ESO_GAIN_TO_6BIT(AUDIO_MAX_GAIN / 2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tv = ESO_GAIN_TO_4BIT(AUDIO_MAX_GAIN / 2);\n\t\t\tbreak;\n\t\t}\n\t\tsc->sc_gain[idx][ESO_LEFT] = sc->sc_gain[idx][ESO_RIGHT] = v;\n\t\teso_set_gain(sc, idx);\n\t}\n\teso_set_recsrc(sc, ESO_MIXREG_ERS_MIC);\n\t\n\t/* Map and establish the interrupt. */\n\tif (pci_intr_map(pa->pa_pc, pa->pa_intrtag, pa->pa_intrpin,\n\t    pa->pa_intrline, &ih)) {\n\t\tprintf(\", couldn't map interrupt\\n\");\n\t\treturn;\n\t}\n\tintrstring = pci_intr_string(pa->pa_pc, ih);\n#ifdef __OpenBSD__\n\tsc->sc_ih  = pci_intr_establish(pa->pa_pc, ih, IPL_AUDIO, eso_intr, sc,\n\t    sc->sc_dev.dv_xname);\n#else\n\tsc->sc_ih  = pci_intr_establish(pa->pa_pc, ih, IPL_AUDIO, eso_intr, sc);\n#endif\n\tif (sc->sc_ih == NULL) {\n\t\tprintf(\", couldn't establish interrupt\",\n\t\t    sc->sc_dev.dv_xname);\n\t\tif (intrstring != NULL)\n\t\t\tprintf(\" at %s\", intrstring);\n\t\tprintf(\"\\n\");\n\t\treturn;\n\t}\n\tprintf(\", %s\\n\", intrstring);\n\n\t/*\n\t * Set up the DDMA Control register; a suitable I/O region has been\n\t * supposedly mapped in the VC base address register.\n\t *\n\t * The Solo-1 has an ... interesting silicon bug that causes it to\n\t * not respond to I/O space accesses to the Audio 1 DMA controller\n\t * if the latter's mapping base address is aligned on a 1K boundary.\n\t * As a consequence, it is quite possible for the mapping provided\n\t * in the VC BAR to be useless.  To work around this, we defer this\n\t * part until all autoconfiguration on our parent bus is completed\n\t * and then try to map it ourselves in fulfillment of the constraint.\n\t * \n\t * According to the register map we may write to the low 16 bits\n\t * only, but experimenting has shown we're safe.\n\t * -kjk\n\t */\n\tif (ESO_VALID_DDMAC_BASE(vcbase)) {\n\t\tpci_conf_write(pa->pa_pc, pa->pa_tag, ESO_PCI_DDMAC,\n\t\t    vcbase | ESO_PCI_DDMAC_DE);\n\t\tsc->sc_dmac_configured = 1;\n\n\t\tprintf(\"%s: mapping Audio 1 DMA using VC I/O space at 0x%lx\\n\",\n\t\t    sc->sc_dev.dv_xname, (unsigned long)vcbase);\n\t} else {\n\t\tDPRINTF((\"%s: VC I/O space at 0x%lx not suitable, deferring\\n\",\n\t\t    sc->sc_dev.dv_xname, (unsigned long)vcbase));\n\t\tsc->sc_pa = *pa;\n\t\tconfig_defer(self, eso_defer);\n\t}\n\t\n\taudio_attach_mi(&eso_hw_if, sc, &sc->sc_dev);\n\n\taa.type = AUDIODEV_TYPE_OPL;\n\taa.hwif = NULL;\n\taa.hdl = NULL;\n\t(void)config_found(&sc->sc_dev, &aa, audioprint);\n\n#if 0\n\taa.type = AUDIODEV_TYPE_MPU;\n\taa.hwif = NULL;\n\taa.hdl = NULL;\n\tsc->sc_mpudev = config_found(&sc->sc_dev, &aa, audioprint);\n#endif\n}"
  },
  {
    "function_name": "eso_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/pci/eso.c",
    "lines": "207-220",
    "snippet": "HIDE int\neso_match(parent, match, aux)\n\tstruct device *parent;\n\tMATCH_ARG_2_T match;\n\tvoid *aux;\n{\n\tstruct pci_attach_args *pa = aux;\n\n\tif (PCI_VENDOR(pa->pa_id) == PCI_VENDOR_ESSTECH &&\n\t    PCI_PRODUCT(pa->pa_id) == PCI_PRODUCT_ESSTECH_SOLO1)\n\t\treturn (1);\n\n\treturn (0);\n}",
    "includes": [
      "#include <machine/bswap.h>",
      "#include <machine/endian.h>",
      "#include <machine/intr.h>",
      "#include <machine/bus.h>",
      "#include <dev/audiovar.h>",
      "#include <dev/pci/esovar.h>",
      "#include <dev/pci/esoreg.h>",
      "#include <dev/ic/i8237reg.h>",
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/auconv.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <dev/pci/pcivar.h>",
      "#include <dev/pci/pcidevs.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/malloc.h>",
      "#include <sys/kernel.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define MATCH_ARG_2_T struct cfdata *",
      "#define HIDE static",
      "#define MATCH_ARG_2_T void *",
      "#define HIDE"
    ],
    "globals_used": [
      "HIDE int",
      "eso_match __P((struct device *, MATCH_ARG_2_T, void *));",
      "HIDE void",
      "eso_attach __P((struct device *, struct device *, void *));",
      "HIDE void",
      "eso_defer __P((struct device *));",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE int",
      "HIDE struct",
      "HIDE int",
      "HIDE void",
      "HIDE int",
      "HIDE void",
      "HIDE void",
      "HIDE void",
      "HIDE int",
      "HIDE void"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PCI_PRODUCT",
          "args": [
            "pa->pa_id"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PCI_VENDOR",
          "args": [
            "pa->pa_id"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <machine/bswap.h>\n#include <machine/endian.h>\n#include <machine/intr.h>\n#include <machine/bus.h>\n#include <dev/audiovar.h>\n#include <dev/pci/esovar.h>\n#include <dev/pci/esoreg.h>\n#include <dev/ic/i8237reg.h>\n#include <dev/ic/mpuvar.h>\n#include <dev/auconv.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <dev/pci/pcivar.h>\n#include <dev/pci/pcidevs.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/malloc.h>\n#include <sys/kernel.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define MATCH_ARG_2_T struct cfdata *\n#define HIDE static\n#define MATCH_ARG_2_T void *\n#define HIDE\n\nHIDE int;\neso_match __P((struct device *, MATCH_ARG_2_T, void *));\nHIDE void;\neso_attach __P((struct device *, struct device *, void *));\nHIDE void;\neso_defer __P((struct device *));\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE int;\nHIDE struct;\nHIDE int;\nHIDE void;\nHIDE int;\nHIDE void;\nHIDE void;\nHIDE void;\nHIDE int;\nHIDE void;\n\nHIDE int\neso_match(parent, match, aux)\n\tstruct device *parent;\n\tMATCH_ARG_2_T match;\n\tvoid *aux;\n{\n\tstruct pci_attach_args *pa = aux;\n\n\tif (PCI_VENDOR(pa->pa_id) == PCI_VENDOR_ESSTECH &&\n\t    PCI_PRODUCT(pa->pa_id) == PCI_PRODUCT_ESSTECH_SOLO1)\n\t\treturn (1);\n\n\treturn (0);\n}"
  }
]