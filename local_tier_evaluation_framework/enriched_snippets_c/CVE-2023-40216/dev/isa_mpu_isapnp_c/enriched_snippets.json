[
  {
    "function_name": "mpu_isapnp_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/mpu_isapnp.c",
    "lines": "53-79",
    "snippet": "void\nmpu_isapnp_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct mpu_isapnp_softc *sc = (struct mpu_isapnp_softc *)self;\n\tstruct isa_attach_args *ipa = aux;\n\n\tprintf(\"\\n\");\n\n\tsc->sc_mpu.iot = ipa->ia_iot;\n\tsc->sc_mpu.ioh = ipa->ipa_io[0].h;\n\n\tsc->sc_ih = isa_intr_establish(ipa->ia_ic, ipa->ipa_irq[0].num,\n\t    ipa->ipa_irq[0].type, IPL_AUDIO, mpu_intr, &sc->sc_mpu,\n\t    sc->sc_dev.dv_xname);\n\n\tif (!mpu_find(&sc->sc_mpu)) {\n\t\tprintf(\"%s: find failed\\n\", sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\n\tprintf(\"%s: %s %s\\n\", sc->sc_dev.dv_xname, ipa->ipa_devident,\n\t       ipa->ipa_devclass);\n\n\tmidi_attach_mi(&mpu_midi_hw_if, &sc->sc_mpu, &sc->sc_dev);\n}",
    "includes": [
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"midi.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void\tmpu_isapnp_attach"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "midi_attach_mi",
          "args": [
            "&mpu_midi_hw_if",
            "&sc->sc_mpu",
            "&sc->sc_dev"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "midi_attach_mi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/midi.c",
          "lines": "749-767",
          "snippet": "void\nmidi_attach_mi(mhwp, hdlp, dev)\n\tstruct midi_hw_if *mhwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n#ifdef DIAGNOSTIC\n\tif (mhwp == NULL) {\n\t\tprintf(\"midi_attach_mi: NULL\\n\");\n\t\treturn;\n\t}\n#endif\n\targ.type = AUDIODEV_TYPE_MIDI;\n\targ.hwif = mhwp;\n\targ.hdl = hdlp;\n\t(void)config_found(dev, &arg, midiprint);\n}",
          "includes": [
            "#include <dev/midivar.h>",
            "#include <dev/midi_if.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/midiio.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"sequencer.h\"",
            "#include \"midi.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/midivar.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/midiio.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"sequencer.h\"\n#include \"midi.h\"\n\nvoid\nmidi_attach_mi(mhwp, hdlp, dev)\n\tstruct midi_hw_if *mhwp;\n\tvoid *hdlp;\n\tstruct device *dev;\n{\n\tstruct audio_attach_args arg;\n\n#ifdef DIAGNOSTIC\n\tif (mhwp == NULL) {\n\t\tprintf(\"midi_attach_mi: NULL\\n\");\n\t\treturn;\n\t}\n#endif\n\targ.type = AUDIODEV_TYPE_MIDI;\n\targ.hwif = mhwp;\n\targ.hdl = hdlp;\n\t(void)config_found(dev, &arg, midiprint);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: %s %s\\n\"",
            "sc->sc_dev.dv_xname",
            "ipa->ipa_devident",
            "ipa->ipa_devclass"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mpu_find",
          "args": [
            "&sc->sc_mpu"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "mpu_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/mpu401.c",
          "lines": "100-116",
          "snippet": "int\nmpu_find(v)\n\tvoid *v;\n{\n\tstruct mpu_softc *sc = v;\n\n\tif (MPU_GETSTATUS(sc->iot, sc->ioh) == 0xff) {\n\t\tDPRINTF((\"mpu_find: No status\\n\"));\n\t\tgoto bad;\n\t}\n\tsc->open = 0;\n\tsc->intr = 0;\n\tif (mpu_reset(sc) == 0)\n\t\treturn 1;\nbad:\n\treturn 0;\n}",
          "includes": [
            "#include <dev/ic/mpuvar.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/midi_if.h>",
            "#include <machine/bus.h>",
            "#include <machine/intr.h>",
            "#include <machine/cpu.h>",
            "#include <vm/vm.h>",
            "#include <sys/buf.h>",
            "#include <sys/proc.h>",
            "#include <sys/device.h>",
            "#include <sys/syslog.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/errno.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int\tmpu_reset(struct mpu_softc *);",
            "static\t__inline int mpu_waitready(struct mpu_softc *);",
            "void\tmpu_readinput(struct mpu_softc *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/ic/mpuvar.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/midi_if.h>\n#include <machine/bus.h>\n#include <machine/intr.h>\n#include <machine/cpu.h>\n#include <vm/vm.h>\n#include <sys/buf.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint\tmpu_reset(struct mpu_softc *);\nstatic\t__inline int mpu_waitready(struct mpu_softc *);\nvoid\tmpu_readinput(struct mpu_softc *);\n\nint\nmpu_find(v)\n\tvoid *v;\n{\n\tstruct mpu_softc *sc = v;\n\n\tif (MPU_GETSTATUS(sc->iot, sc->ioh) == 0xff) {\n\t\tDPRINTF((\"mpu_find: No status\\n\"));\n\t\tgoto bad;\n\t}\n\tsc->open = 0;\n\tsc->intr = 0;\n\tif (mpu_reset(sc) == 0)\n\t\treturn 1;\nbad:\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isa_intr_establish",
          "args": [
            "ipa->ia_ic",
            "ipa->ipa_irq[0].num",
            "ipa->ipa_irq[0].type",
            "IPL_AUDIO",
            "mpu_intr",
            "&sc->sc_mpu",
            "sc->sc_dev.dv_xname"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/ic/mpuvar.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"midi.h\"\n\nvoid\tmpu_isapnp_attach;\n\nvoid\nmpu_isapnp_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct mpu_isapnp_softc *sc = (struct mpu_isapnp_softc *)self;\n\tstruct isa_attach_args *ipa = aux;\n\n\tprintf(\"\\n\");\n\n\tsc->sc_mpu.iot = ipa->ia_iot;\n\tsc->sc_mpu.ioh = ipa->ipa_io[0].h;\n\n\tsc->sc_ih = isa_intr_establish(ipa->ia_ic, ipa->ipa_irq[0].num,\n\t    ipa->ipa_irq[0].type, IPL_AUDIO, mpu_intr, &sc->sc_mpu,\n\t    sc->sc_dev.dv_xname);\n\n\tif (!mpu_find(&sc->sc_mpu)) {\n\t\tprintf(\"%s: find failed\\n\", sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\n\tprintf(\"%s: %s %s\\n\", sc->sc_dev.dv_xname, ipa->ipa_devident,\n\t       ipa->ipa_devclass);\n\n\tmidi_attach_mi(&mpu_midi_hw_if, &sc->sc_mpu, &sc->sc_dev);\n}"
  },
  {
    "function_name": "mpu_isapnp_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/mpu_isapnp.c",
    "lines": "41-51",
    "snippet": "int\nmpu_isapnp_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct isa_attach_args *ipa = aux;\n\n\tif (ipa->ipa_nirq != 1)\n\t\treturn 0;\n\treturn 1;\n}",
    "includes": [
      "#include <dev/ic/mpuvar.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/mulaw.h>",
      "#include <dev/midi_if.h>",
      "#include <dev/audio_if.h>",
      "#include <sys/audioio.h>",
      "#include <machine/bus.h>",
      "#include <sys/proc.h>",
      "#include <sys/device.h>",
      "#include <sys/syslog.h>",
      "#include <sys/ioctl.h>",
      "#include <sys/errno.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>",
      "#include \"midi.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int\tmpu_isapnp_match"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <dev/ic/mpuvar.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/mulaw.h>\n#include <dev/midi_if.h>\n#include <dev/audio_if.h>\n#include <sys/audioio.h>\n#include <machine/bus.h>\n#include <sys/proc.h>\n#include <sys/device.h>\n#include <sys/syslog.h>\n#include <sys/ioctl.h>\n#include <sys/errno.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n#include \"midi.h\"\n\nint\tmpu_isapnp_match;\n\nint\nmpu_isapnp_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct isa_attach_args *ipa = aux;\n\n\tif (ipa->ipa_nirq != 1)\n\t\treturn 0;\n\treturn 1;\n}"
  }
]