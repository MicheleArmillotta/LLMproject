[
  {
    "function_name": "rf_MCPairWakeupFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_mcpair.c",
    "lines": "132-148",
    "snippet": "void \nrf_MCPairWakeupFunc(mcpair)\n\tRF_MCPair_t *mcpair;\n{\n\tRF_LOCK_MUTEX(mcpair->mutex);\n\tmcpair->flag = 1;\n#if 0\n\tprintf(\"MCPairWakeupFunc called!\\n\");\n#endif\n\twakeup(&(mcpair->flag));/* XXX Does this do anything useful!! GO */\n\t/* XXX Looks like the following is needed to truly get the\n\t * functionality they were looking for here... This could be a\n\t * side-effect of my using a tsleep in the Net- and OpenBSD port\n\t * though... XXX */\n\twakeup(&(mcpair->cond));/* XXX XXX XXX GO */\n\tRF_UNLOCK_MUTEX(mcpair->mutex);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_mcpair.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int init_mcpair(RF_MCPair_t *);",
      "static void clean_mcpair(RF_MCPair_t *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_UNLOCK_MUTEX",
          "args": [
            "mcpair->mutex"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wakeup",
          "args": [
            "&(mcpair->cond)"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "audio_wakeup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/audio.c",
          "lines": "765-774",
          "snippet": "static __inline void\naudio_wakeup(chan)\n\tint *chan;\n{\n\tDPRINTFN(3, (\"audio_wakeup: chan=%p, *chan=%d\\n\", chan, *chan));\n\tif (*chan) {\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}",
          "includes": [
            "#include <machine/endian.h>",
            "#include <vm/vm_prot.h>",
            "#include <vm/vm.h>",
            "#include <dev/rndvar.h>",
            "#include <dev/audiovar.h>",
            "#include <dev/audio_if.h>",
            "#include <sys/device.h>",
            "#include <sys/audioio.h>",
            "#include <sys/conf.h>",
            "#include <sys/signalvar.h>",
            "#include <sys/kernel.h>",
            "#include <sys/syslog.h>",
            "#include <sys/systm.h>",
            "#include <sys/proc.h>",
            "#include <sys/malloc.h>",
            "#include <sys/poll.h>",
            "#include <sys/select.h>",
            "#include <sys/vnode.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/ioctl.h>",
            "#include <sys/param.h>",
            "#include \"audio.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <machine/endian.h>\n#include <vm/vm_prot.h>\n#include <vm/vm.h>\n#include <dev/rndvar.h>\n#include <dev/audiovar.h>\n#include <dev/audio_if.h>\n#include <sys/device.h>\n#include <sys/audioio.h>\n#include <sys/conf.h>\n#include <sys/signalvar.h>\n#include <sys/kernel.h>\n#include <sys/syslog.h>\n#include <sys/systm.h>\n#include <sys/proc.h>\n#include <sys/malloc.h>\n#include <sys/poll.h>\n#include <sys/select.h>\n#include <sys/vnode.h>\n#include <sys/fcntl.h>\n#include <sys/ioctl.h>\n#include <sys/param.h>\n#include \"audio.h\"\n\nstatic __inline void\naudio_wakeup(chan)\n\tint *chan;\n{\n\tDPRINTFN(3, (\"audio_wakeup: chan=%p, *chan=%d\\n\", chan, *chan));\n\tif (*chan) {\n\t\twakeup(chan);\n\t\t*chan = 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"MCPairWakeupFunc called!\\n\""
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_LOCK_MUTEX",
          "args": [
            "mcpair->mutex"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_mcpair.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic int init_mcpair(RF_MCPair_t *);\nstatic void clean_mcpair(RF_MCPair_t *);\n\nvoid \nrf_MCPairWakeupFunc(mcpair)\n\tRF_MCPair_t *mcpair;\n{\n\tRF_LOCK_MUTEX(mcpair->mutex);\n\tmcpair->flag = 1;\n#if 0\n\tprintf(\"MCPairWakeupFunc called!\\n\");\n#endif\n\twakeup(&(mcpair->flag));/* XXX Does this do anything useful!! GO */\n\t/* XXX Looks like the following is needed to truly get the\n\t * functionality they were looking for here... This could be a\n\t * side-effect of my using a tsleep in the Net- and OpenBSD port\n\t * though... XXX */\n\twakeup(&(mcpair->cond));/* XXX XXX XXX GO */\n\tRF_UNLOCK_MUTEX(mcpair->mutex);\n}"
  },
  {
    "function_name": "rf_FreeMCPair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_mcpair.c",
    "lines": "125-130",
    "snippet": "void \nrf_FreeMCPair(t)\n\tRF_MCPair_t *t;\n{\n\tRF_FREELIST_FREE_CLEAN(rf_mcpair_freelist, t, next, clean_mcpair);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_mcpair.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static RF_FreeList_t *rf_mcpair_freelist;",
      "static int init_mcpair(RF_MCPair_t *);",
      "static void clean_mcpair(RF_MCPair_t *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_FREELIST_FREE_CLEAN",
          "args": [
            "rf_mcpair_freelist",
            "t",
            "next",
            "clean_mcpair"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_mcpair.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic RF_FreeList_t *rf_mcpair_freelist;\nstatic int init_mcpair(RF_MCPair_t *);\nstatic void clean_mcpair(RF_MCPair_t *);\n\nvoid \nrf_FreeMCPair(t)\n\tRF_MCPair_t *t;\n{\n\tRF_FREELIST_FREE_CLEAN(rf_mcpair_freelist, t, next, clean_mcpair);\n}"
  },
  {
    "function_name": "rf_AllocMCPair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_mcpair.c",
    "lines": "112-123",
    "snippet": "RF_MCPair_t *\nrf_AllocMCPair()\n{\n\tRF_MCPair_t *t;\n\n\tRF_FREELIST_GET_INIT(rf_mcpair_freelist, t, next, (RF_MCPair_t *), init_mcpair);\n\tif (t) {\n\t\tt->flag = 0;\n\t\tt->next = NULL;\n\t}\n\treturn (t);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_mcpair.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static RF_FreeList_t *rf_mcpair_freelist;",
      "static int init_mcpair(RF_MCPair_t *);",
      "static void clean_mcpair(RF_MCPair_t *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_FREELIST_GET_INIT",
          "args": [
            "rf_mcpair_freelist",
            "t",
            "next",
            "(RF_MCPair_t *), init_mcpair"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_mcpair.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic RF_FreeList_t *rf_mcpair_freelist;\nstatic int init_mcpair(RF_MCPair_t *);\nstatic void clean_mcpair(RF_MCPair_t *);\n\nRF_MCPair_t *\nrf_AllocMCPair()\n{\n\tRF_MCPair_t *t;\n\n\tRF_FREELIST_GET_INIT(rf_mcpair_freelist, t, next, (RF_MCPair_t *), init_mcpair);\n\tif (t) {\n\t\tt->flag = 0;\n\t\tt->next = NULL;\n\t}\n\treturn (t);\n}"
  },
  {
    "function_name": "rf_ConfigureMCPair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_mcpair.c",
    "lines": "92-110",
    "snippet": "int \nrf_ConfigureMCPair(listp)\n\tRF_ShutdownList_t **listp;\n{\n\tint     rc;\n\n\tRF_FREELIST_CREATE(rf_mcpair_freelist, RF_MAX_FREE_MCPAIR,\n\t    RF_MCPAIR_INC, sizeof(RF_MCPair_t));\n\trc = rf_ShutdownCreate(listp, rf_ShutdownMCPair, NULL);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to add to shutdown list file %s line %d rc=%d\\n\",\n\t\t    __FILE__, __LINE__, rc);\n\t\trf_ShutdownMCPair(NULL);\n\t\treturn (rc);\n\t}\n\tRF_FREELIST_PRIME_INIT(rf_mcpair_freelist, RF_MCPAIR_INITIAL, next,\n\t    (RF_MCPair_t *), init_mcpair);\n\treturn (0);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_mcpair.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [
      "#define RF_MCPAIR_INITIAL   24",
      "#define RF_MCPAIR_INC       16",
      "#define RF_MAX_FREE_MCPAIR 128"
    ],
    "globals_used": [
      "static RF_FreeList_t *rf_mcpair_freelist;",
      "static int init_mcpair(RF_MCPair_t *);",
      "static void clean_mcpair(RF_MCPair_t *);",
      "static void rf_ShutdownMCPair(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_FREELIST_PRIME_INIT",
          "args": [
            "rf_mcpair_freelist",
            "RF_MCPAIR_INITIAL",
            "next",
            "(RF_MCPair_t *), init_mcpair"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_ShutdownMCPair",
          "args": [
            "NULL"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "rf_ShutdownMCPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_mcpair.c",
          "lines": "85-90",
          "snippet": "static void \nrf_ShutdownMCPair(ignored)\n\tvoid   *ignored;\n{\n\tRF_FREELIST_DESTROY_CLEAN(rf_mcpair_freelist, next, (RF_MCPair_t *), clean_mcpair);\n}",
          "includes": [
            "#include <sys/proc.h>",
            "#include \"rf_shutdown.h\"",
            "#include \"rf_freelist.h\"",
            "#include \"rf_debugMem.h\"",
            "#include \"rf_mcpair.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static RF_FreeList_t *rf_mcpair_freelist;",
            "static int init_mcpair(RF_MCPair_t *);",
            "static void clean_mcpair(RF_MCPair_t *);",
            "static void rf_ShutdownMCPair(void *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_mcpair.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic RF_FreeList_t *rf_mcpair_freelist;\nstatic int init_mcpair(RF_MCPair_t *);\nstatic void clean_mcpair(RF_MCPair_t *);\nstatic void rf_ShutdownMCPair(void *);\n\nstatic void \nrf_ShutdownMCPair(ignored)\n\tvoid   *ignored;\n{\n\tRF_FREELIST_DESTROY_CLEAN(rf_mcpair_freelist, next, (RF_MCPair_t *), clean_mcpair);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG3",
          "args": [
            "\"Unable to add to shutdown list file %s line %d rc=%d\\n\"",
            "__FILE__",
            "__LINE__",
            "rc"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_ShutdownCreate",
          "args": [
            "listp",
            "rf_ShutdownMCPair",
            "NULL"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_FREELIST_CREATE",
          "args": [
            "rf_mcpair_freelist",
            "RF_MAX_FREE_MCPAIR",
            "RF_MCPAIR_INC",
            "sizeof(RF_MCPair_t)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_mcpair.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define RF_MCPAIR_INITIAL   24\n#define RF_MCPAIR_INC       16\n#define RF_MAX_FREE_MCPAIR 128\n\nstatic RF_FreeList_t *rf_mcpair_freelist;\nstatic int init_mcpair(RF_MCPair_t *);\nstatic void clean_mcpair(RF_MCPair_t *);\nstatic void rf_ShutdownMCPair(void *);\n\nint \nrf_ConfigureMCPair(listp)\n\tRF_ShutdownList_t **listp;\n{\n\tint     rc;\n\n\tRF_FREELIST_CREATE(rf_mcpair_freelist, RF_MAX_FREE_MCPAIR,\n\t    RF_MCPAIR_INC, sizeof(RF_MCPair_t));\n\trc = rf_ShutdownCreate(listp, rf_ShutdownMCPair, NULL);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to add to shutdown list file %s line %d rc=%d\\n\",\n\t\t    __FILE__, __LINE__, rc);\n\t\trf_ShutdownMCPair(NULL);\n\t\treturn (rc);\n\t}\n\tRF_FREELIST_PRIME_INIT(rf_mcpair_freelist, RF_MCPAIR_INITIAL, next,\n\t    (RF_MCPair_t *), init_mcpair);\n\treturn (0);\n}"
  },
  {
    "function_name": "rf_ShutdownMCPair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_mcpair.c",
    "lines": "85-90",
    "snippet": "static void \nrf_ShutdownMCPair(ignored)\n\tvoid   *ignored;\n{\n\tRF_FREELIST_DESTROY_CLEAN(rf_mcpair_freelist, next, (RF_MCPair_t *), clean_mcpair);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_mcpair.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static RF_FreeList_t *rf_mcpair_freelist;",
      "static int init_mcpair(RF_MCPair_t *);",
      "static void clean_mcpair(RF_MCPair_t *);",
      "static void rf_ShutdownMCPair(void *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RF_FREELIST_DESTROY_CLEAN",
          "args": [
            "rf_mcpair_freelist",
            "next",
            "(RF_MCPair_t *), clean_mcpair"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_mcpair.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic RF_FreeList_t *rf_mcpair_freelist;\nstatic int init_mcpair(RF_MCPair_t *);\nstatic void clean_mcpair(RF_MCPair_t *);\nstatic void rf_ShutdownMCPair(void *);\n\nstatic void \nrf_ShutdownMCPair(ignored)\n\tvoid   *ignored;\n{\n\tRF_FREELIST_DESTROY_CLEAN(rf_mcpair_freelist, next, (RF_MCPair_t *), clean_mcpair);\n}"
  },
  {
    "function_name": "clean_mcpair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_mcpair.c",
    "lines": "77-83",
    "snippet": "static void \nclean_mcpair(t)\n\tRF_MCPair_t *t;\n{\n\trf_mutex_destroy(&t->mutex);\n\trf_cond_destroy(&t->cond);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_mcpair.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int init_mcpair(RF_MCPair_t *);",
      "static void clean_mcpair(RF_MCPair_t *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_cond_destroy",
          "args": [
            "&t->cond"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "&t->mutex"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_mcpair.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic int init_mcpair(RF_MCPair_t *);\nstatic void clean_mcpair(RF_MCPair_t *);\n\nstatic void \nclean_mcpair(t)\n\tRF_MCPair_t *t;\n{\n\trf_mutex_destroy(&t->mutex);\n\trf_cond_destroy(&t->cond);\n}"
  },
  {
    "function_name": "init_mcpair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_mcpair.c",
    "lines": "55-75",
    "snippet": "static int \ninit_mcpair(t)\n\tRF_MCPair_t *t;\n{\n\tint     rc;\n\n\trc = rf_mutex_init(&t->mutex);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to init mutex file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\treturn (rc);\n\t}\n\trc = rf_cond_init(&t->cond);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to init cond file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\trf_mutex_destroy(&t->mutex);\n\t\treturn (rc);\n\t}\n\treturn (0);\n}",
    "includes": [
      "#include <sys/proc.h>",
      "#include \"rf_shutdown.h\"",
      "#include \"rf_freelist.h\"",
      "#include \"rf_debugMem.h\"",
      "#include \"rf_mcpair.h\"",
      "#include \"rf_threadstuff.h\"",
      "#include \"rf_types.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int init_mcpair(RF_MCPair_t *);",
      "static void clean_mcpair(RF_MCPair_t *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rf_mutex_destroy",
          "args": [
            "&t->mutex"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG3",
          "args": [
            "\"Unable to init cond file %s line %d rc=%d\\n\"",
            "__FILE__",
            "__LINE__",
            "rc"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_cond_init",
          "args": [
            "&t->cond"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "rf_cond_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "188-201",
          "snippet": "int \nrf_cond_init(c)\nRF_DECLARE_COND(*c)\n{\n\t*c = 0;\t\t\t/* no reason */\n\treturn (0);\n}\n\nint \nrf_cond_destroy(c)\nRF_DECLARE_COND(*c)\n{\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_cond_init(c)\nRF_DECLARE_COND(*c)\n{\n\t*c = 0;\t\t\t/* no reason */\n\treturn (0);\n}\n\nint \nrf_cond_destroy(c)\nRF_DECLARE_COND(*c)\n{\n\treturn (0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RF_ERRORMSG3",
          "args": [
            "\"Unable to init mutex file %s line %d rc=%d\\n\"",
            "__FILE__",
            "__LINE__",
            "rc"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rf_mutex_init",
          "args": [
            "&t->mutex"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "rf_mutex_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_threadstuff.c",
          "lines": "173-186",
          "snippet": "int \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}",
          "includes": [
            "#include \"rf_shutdown.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rf_shutdown.h\"\n#include \"rf_general.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nint \nrf_mutex_init(m)\ndecl_simple_lock_data(, *m)\n{\n\tsimple_lock_init(m);\n\treturn (0);\n}\n\nint \nrf_mutex_destroy(m)\ndecl_simple_lock_data(, *m)\n{\n\treturn (0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sys/proc.h>\n#include \"rf_shutdown.h\"\n#include \"rf_freelist.h\"\n#include \"rf_debugMem.h\"\n#include \"rf_mcpair.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\nstatic int init_mcpair(RF_MCPair_t *);\nstatic void clean_mcpair(RF_MCPair_t *);\n\nstatic int \ninit_mcpair(t)\n\tRF_MCPair_t *t;\n{\n\tint     rc;\n\n\trc = rf_mutex_init(&t->mutex);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to init mutex file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\treturn (rc);\n\t}\n\trc = rf_cond_init(&t->cond);\n\tif (rc) {\n\t\tRF_ERRORMSG3(\"Unable to init cond file %s line %d rc=%d\\n\", __FILE__,\n\t\t    __LINE__, rc);\n\t\trf_mutex_destroy(&t->mutex);\n\t\treturn (rc);\n\t}\n\treturn (0);\n}"
  }
]