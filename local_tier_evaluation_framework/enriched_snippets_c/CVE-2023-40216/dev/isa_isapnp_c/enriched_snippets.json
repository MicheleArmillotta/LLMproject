[
  {
    "function_name": "isapnp_attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "881-963",
    "snippet": "void\nisapnp_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct isapnp_softc *sc = (struct isapnp_softc *) self;\n\tstruct isa_attach_args *ia = aux;\n\tvoid *match;\n\tint c, d;\n\n\tsc->sc_iot = ia->ia_iot;\n\tsc->sc_memt = ia->ia_memt;\n\tsc->sc_dmat = ia->ia_dmat;\n\tsc->sc_ncards = 0;\n\n\tif (isapnp_map(sc))\n\t\tpanic(\"%s: bus map failed\", sc->sc_dev.dv_xname);\n\n\tif (!isapnp_find(sc, 1)) {\n\t\tprintf(\": no cards found\\n\", sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\n\tprintf(\": read port 0x%x\\n\", sc->sc_read_port);\n\n\tfor (c = 0; c < sc->sc_ncards; c++) {\n\t\tstruct isa_attach_args *ipa, *lpa;\n\n\t\t/* Good morning card c */\n\t\tisapnp_write_reg(sc, ISAPNP_WAKE, c + 1);\n\n\t\tif ((ipa = isapnp_get_resource(sc, c)) == NULL)\n\t\t\tcontinue;\n\n\t\tDPRINTF((\"Selecting attachments\\n\"));\n\t\tfor (d = 0;\n\t\t    (lpa = isapnp_bestconfig(parent, sc, &ipa)) != NULL; d++) {\n\t\t\tisapnp_write_reg(sc, ISAPNP_LOGICAL_DEV_NUM, d);\n\t\t\tisapnp_configure(sc, lpa);\n#ifdef DEBUG_ISAPNP\n\t\t\t{\n\t\t\t\tstruct isa_attach_args pa;\n\n\t\t\t\tisapnp_get_config(sc, &pa);\n\t\t\t\tisapnp_print_config(&pa);\n\t\t\t}\n#endif\n\n\t\t\tDPRINTF((\"%s: configuring <%s, %s, %s, %s>\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    lpa->ipa_devident, lpa->ipa_devlogic,\n\t\t\t    lpa->ipa_devcompat, lpa->ipa_devclass));\n\t\t\tif (lpa->ipa_pref == ISAPNP_DEP_CONFLICTING) {\n\t\t\t\tisapnp_print(lpa, self->dv_xname);\n\t\t\t\tprintf(\" resource conflict\\n\");\n\t\t\t\tISAPNP_FREE(lpa);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlpa->ia_ic = ia->ia_ic;\n\t\t\tlpa->ia_iot = ia->ia_iot;\n\t\t\tlpa->ia_memt = ia->ia_memt;\n\t\t\tlpa->ia_dmat = ia->ia_dmat;\n\t\t\tlpa->ia_delaybah = ia->ia_delaybah;\n\n\t\t\tisapnp_write_reg(sc, ISAPNP_ACTIVATE, 1);\n\n\t\t\tif ((match = config_search(isapnp_submatch,\n\t\t\t    self, lpa)))\n\t\t\t\tconfig_attach(self, match, lpa, isapnp_print);\n\t\t\telse if ((match = config_search(isapnp_com_submatch,\n\t\t\t    self, lpa)))\n\t\t\t\tconfig_attach(self, match, lpa, isapnp_print);\n\t\t\telse {\n\t\t\t\tisapnp_print(lpa, self->dv_xname);\n\t\t\t\tprintf(\" not configured\\n\");\n\t\t\t\tisapnp_write_reg(sc, ISAPNP_ACTIVATE, 0);\n\t\t\t}\n\t\t\tISAPNP_FREE(lpa);\n\t\t}\n\t\tisapnp_write_reg(sc, ISAPNP_WAKE, 0);    /* Good night cards */\n\t}\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct isa_attach_args *isapnp_bestconfig",
      "void isapnp_configure",
      "int isapnp_print",
      "int isapnp_submatch",
      "int isapnp_com_submatch",
      "int isapnp_find",
      "void isapnp_attach",
      "struct isapnp_softc *sc;",
      "struct isa_attach_args **ipa;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_write_reg",
          "args": [
            "sc",
            "ISAPNP_WAKE",
            "0"
          ],
          "line": 961
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_write_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isavar.h",
          "lines": "423-431",
          "snippet": "static __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}",
          "includes": [
            "#include <alpha/isa/isapnp_machdep.h>",
            "#include <i386/isa/isapnp_machdep.h>",
            "#include \"isapnp.h\"",
            "#include <hppa/isa/isa_machdep.h>",
            "#include <powerpc/isa/isa_machdep.h>",
            "#include <wgrisc/isa/isa_machdep.h>",
            "#include <arc/isa/isa_machdep.h>",
            "#include <i386/isa/isa_machdep.h>",
            "#include <amiga/isa/isa_machdep.h>",
            "#include <alpha/isa/isa_machdep.h>",
            "#include \"isadma.h\"",
            "#include <machine/bus.h>",
            "#include <sys/queue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <alpha/isa/isapnp_machdep.h>\n#include <i386/isa/isapnp_machdep.h>\n#include \"isapnp.h\"\n#include <hppa/isa/isa_machdep.h>\n#include <powerpc/isa/isa_machdep.h>\n#include <wgrisc/isa/isa_machdep.h>\n#include <arc/isa/isa_machdep.h>\n#include <i386/isa/isa_machdep.h>\n#include <amiga/isa/isa_machdep.h>\n#include <alpha/isa/isa_machdep.h>\n#include \"isadma.h\"\n#include <machine/bus.h>\n#include <sys/queue.h>\n\nstatic __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISAPNP_FREE",
          "args": [
            "lpa"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" not configured\\n\""
          ],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_print",
          "args": [
            "lpa",
            "self->dv_xname"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "548-569",
          "snippet": "int\nisapnp_print(aux, str)\n\tvoid *aux;\n\tconst char *str;\n{\n\tstruct isa_attach_args *ipa = aux;\n\n\tif (!str)\n\t\tprintf(\" \");\n\tprintf(\"\\\"%s, %s, %s, %s\\\"\", ipa->ipa_devident,\n\t    ipa->ipa_devlogic, ipa->ipa_devcompat, ipa->ipa_devclass);\n\n\tif (str)\n\t\tprintf(\" at %s\", str);\n\n\tisapnp_print_region(\"port\", ipa->ipa_io, ipa->ipa_nio);\n\tisapnp_print_region(\"mem\", ipa->ipa_mem, ipa->ipa_nmem);\n\tisapnp_print_region(\"mem32\", ipa->ipa_mem32, ipa->ipa_nmem32);\n\tisapnp_print_pin(\"irq\", ipa->ipa_irq, ipa->ipa_nirq);\n\tisapnp_print_pin(\"drq\", ipa->ipa_drq, ipa->ipa_ndrq);\n\treturn UNCONF;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_print_region",
            "void isapnp_print_pin",
            "int isapnp_print",
            "struct isa_attach_args **ipa;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_print_region;\nvoid isapnp_print_pin;\nint isapnp_print;\nstruct isa_attach_args **ipa;\n\nint\nisapnp_print(aux, str)\n\tvoid *aux;\n\tconst char *str;\n{\n\tstruct isa_attach_args *ipa = aux;\n\n\tif (!str)\n\t\tprintf(\" \");\n\tprintf(\"\\\"%s, %s, %s, %s\\\"\", ipa->ipa_devident,\n\t    ipa->ipa_devlogic, ipa->ipa_devcompat, ipa->ipa_devclass);\n\n\tif (str)\n\t\tprintf(\" at %s\", str);\n\n\tisapnp_print_region(\"port\", ipa->ipa_io, ipa->ipa_nio);\n\tisapnp_print_region(\"mem\", ipa->ipa_mem, ipa->ipa_nmem);\n\tisapnp_print_region(\"mem32\", ipa->ipa_mem32, ipa->ipa_nmem32);\n\tisapnp_print_pin(\"irq\", ipa->ipa_irq, ipa->ipa_nirq);\n\tisapnp_print_pin(\"drq\", ipa->ipa_drq, ipa->ipa_ndrq);\n\treturn UNCONF;\n}"
        }
      },
      {
        "call_info": {
          "callee": "config_attach",
          "args": [
            "self",
            "match",
            "lpa",
            "isapnp_print"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_search",
          "args": [
            "isapnp_com_submatch",
            "self",
            "lpa"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_attach",
          "args": [
            "self",
            "match",
            "lpa",
            "isapnp_print"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config_search",
          "args": [
            "isapnp_submatch",
            "self",
            "lpa"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISAPNP_FREE",
          "args": [
            "lpa"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: configuring <%s, %s, %s, %s>\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    lpa->ipa_devident, lpa->ipa_devlogic,\n\t\t\t    lpa->ipa_devcompat, lpa->ipa_devclass)"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_print_config",
          "args": [
            "&pa"
          ],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpdebug.c",
          "lines": "370-408",
          "snippet": "void\nisapnp_print_config(pa)\n\tconst struct isa_attach_args *pa;\n{\n\tint i;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\n\tprintf(\"Register configuration:\\n\");\n\tif (pa->ipa_nio)\n\t\tfor (i = 0; i < pa->ipa_nio; i++) {\n\t\t\tr = &pa->ipa_io[i];\n\t\t\tprintf(\"io[%d]: 0x%x/%d\\n\", i, r->base, r->length);\n\t\t}\n\n\tif (pa->ipa_nmem)\n\t\tfor (i = 0; i < pa->ipa_nmem; i++) {\n\t\t\tr = &pa->ipa_mem[i];\n\t\t\tprintf(\"mem[%d]: 0x%x/%d\\n\", i, r->base, r->length);\n\t\t}\n\n\tif (pa->ipa_nirq)\n\t\tfor (i = 0; i < pa->ipa_nirq; i++) {\n\t\t\tp = &pa->ipa_irq[i];\n\t\t\tprintf(\"irq[%d]: %d\\n\", i, p->num);\n\t\t}\n\n\tif (pa->ipa_ndrq)\n\t\tfor (i = 0; i < pa->ipa_ndrq; i++) {\n\t\t\tp = &pa->ipa_drq[i];\n\t\t\tprintf(\"drq[%d]: %d\\n\", i, p->num);\n\t\t}\n\n\tif (pa->ipa_nmem32)\n\t\tfor (i = 0; i < pa->ipa_nmem32; i++) {\n\t\t\tr = &pa->ipa_mem32[i];\n\t\t\tprintf(\"mem32[%d]: 0x%x/%d\\n\", i, r->base, r->length);\n\t\t}\n}",
          "includes": [
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nisapnp_print_config(pa)\n\tconst struct isa_attach_args *pa;\n{\n\tint i;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\n\tprintf(\"Register configuration:\\n\");\n\tif (pa->ipa_nio)\n\t\tfor (i = 0; i < pa->ipa_nio; i++) {\n\t\t\tr = &pa->ipa_io[i];\n\t\t\tprintf(\"io[%d]: 0x%x/%d\\n\", i, r->base, r->length);\n\t\t}\n\n\tif (pa->ipa_nmem)\n\t\tfor (i = 0; i < pa->ipa_nmem; i++) {\n\t\t\tr = &pa->ipa_mem[i];\n\t\t\tprintf(\"mem[%d]: 0x%x/%d\\n\", i, r->base, r->length);\n\t\t}\n\n\tif (pa->ipa_nirq)\n\t\tfor (i = 0; i < pa->ipa_nirq; i++) {\n\t\t\tp = &pa->ipa_irq[i];\n\t\t\tprintf(\"irq[%d]: %d\\n\", i, p->num);\n\t\t}\n\n\tif (pa->ipa_ndrq)\n\t\tfor (i = 0; i < pa->ipa_ndrq; i++) {\n\t\t\tp = &pa->ipa_drq[i];\n\t\t\tprintf(\"drq[%d]: %d\\n\", i, p->num);\n\t\t}\n\n\tif (pa->ipa_nmem32)\n\t\tfor (i = 0; i < pa->ipa_nmem32; i++) {\n\t\t\tr = &pa->ipa_mem32[i];\n\t\t\tprintf(\"mem32[%d]: 0x%x/%d\\n\", i, r->base, r->length);\n\t\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_get_config",
          "args": [
            "sc",
            "&pa"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_get_config",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpdebug.c",
          "lines": "248-364",
          "snippet": "void\nisapnp_get_config(sc, pa)\n\tstruct isapnp_softc *sc;\n\tstruct isa_attach_args *pa;\n{\n\tint i;\n\tu_char v0, v1, v2, v3;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tstruct isapnp_region *r;\n\tstruct isapnp_pin *p;\n\n\tbzero(pa, sizeof(*pa));\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tr = &pa->ipa_io[i];\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0);\n\t\tr->base = (v0 << 8) | v1;\n\t\tif (r->base == 0)\n\t\t\tbreak;\n\t}\n\tpa->ipa_nio = i;\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tr = &pa->ipa_mem[i];\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8);\n\t\tr->base = (v0 << 16) | (v1 << 8);\n\t\tif (r->base == 0)\n\t\t\tbreak;\n\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8);\n\t\tr->length = (v0 << 16) | (v1 << 8);\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_CONTROL);\n\t\tr->flags = 0;\n\t\tif (v0 & ISAPNP_MEM_CONTROL_LIMIT)\n\t\t\tr->flags |= ISAPNP_MEMATTR_HIGH_ADDR;\n\t\tif (v0 & ISAPNP_MEM_CONTROL_16)\n\t\t\tr->flags |= ISAPNP_MEMWIDTH_16;\n\t}\n\tpa->ipa_nmem = i;\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER);\n\t\tp = &pa->ipa_irq[i];\n\t\tp->num = v0 & 0xf;\n\t\tif (p->num == 0)\n\t\t\tbreak;\n\n\t\tswitch (v0 & (ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH)) {\n\t\tcase ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH:\n\t\t    p->flags = ISAPNP_IRQTYPE_LEVEL_PLUS;\n\t\t    break;\n\t\tcase ISAPNP_IRQ_HIGH:\n\t\t    p->flags = ISAPNP_IRQTYPE_EDGE_PLUS;\n\t\t    break;\n\t\tcase ISAPNP_IRQ_LEVEL:\n\t\t    p->flags = ISAPNP_IRQTYPE_LEVEL_MINUS;\n\t\t    break;\n\t\tdefault:\n\t\t    p->flags = ISAPNP_IRQTYPE_EDGE_MINUS;\n\t\t    break;\n\t\t}\n\t}\n\tpa->ipa_nirq = i;\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tv0 = isapnp_read_reg(sc, isapnp_drq_range[i]);\n\t\tp = &pa->ipa_drq[i];\n\t\tp->num = v0 & 0xf;\n\t\tif (p->num == 4)\n\t\t\tbreak;\n\t}\n\tpa->ipa_ndrq = i;\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tr = &pa->ipa_mem32[i];\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16);\n\t\tv2 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8);\n\t\tv3 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0);\n\t\tr->base = (v0 << 24) | (v1 << 16) | (v2 << 8) | v3;\n\t\tif (r->base == 0)\n\t\t\tbreak;\n\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16);\n\t\tv2 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8);\n\t\tv3 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0);\n\t\tr->length = (v0 << 24) | (v1 << 16) | (v2 << 8) | v3;\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_CONTROL);\n\t\tr->flags = v0;\n\t}\n\tpa->ipa_nmem32 = i;\n}",
          "includes": [
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nisapnp_get_config(sc, pa)\n\tstruct isapnp_softc *sc;\n\tstruct isa_attach_args *pa;\n{\n\tint i;\n\tu_char v0, v1, v2, v3;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tstruct isapnp_region *r;\n\tstruct isapnp_pin *p;\n\n\tbzero(pa, sizeof(*pa));\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tr = &pa->ipa_io[i];\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0);\n\t\tr->base = (v0 << 8) | v1;\n\t\tif (r->base == 0)\n\t\t\tbreak;\n\t}\n\tpa->ipa_nio = i;\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tr = &pa->ipa_mem[i];\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8);\n\t\tr->base = (v0 << 16) | (v1 << 8);\n\t\tif (r->base == 0)\n\t\t\tbreak;\n\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8);\n\t\tr->length = (v0 << 16) | (v1 << 8);\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_CONTROL);\n\t\tr->flags = 0;\n\t\tif (v0 & ISAPNP_MEM_CONTROL_LIMIT)\n\t\t\tr->flags |= ISAPNP_MEMATTR_HIGH_ADDR;\n\t\tif (v0 & ISAPNP_MEM_CONTROL_16)\n\t\t\tr->flags |= ISAPNP_MEMWIDTH_16;\n\t}\n\tpa->ipa_nmem = i;\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER);\n\t\tp = &pa->ipa_irq[i];\n\t\tp->num = v0 & 0xf;\n\t\tif (p->num == 0)\n\t\t\tbreak;\n\n\t\tswitch (v0 & (ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH)) {\n\t\tcase ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH:\n\t\t    p->flags = ISAPNP_IRQTYPE_LEVEL_PLUS;\n\t\t    break;\n\t\tcase ISAPNP_IRQ_HIGH:\n\t\t    p->flags = ISAPNP_IRQTYPE_EDGE_PLUS;\n\t\t    break;\n\t\tcase ISAPNP_IRQ_LEVEL:\n\t\t    p->flags = ISAPNP_IRQTYPE_LEVEL_MINUS;\n\t\t    break;\n\t\tdefault:\n\t\t    p->flags = ISAPNP_IRQTYPE_EDGE_MINUS;\n\t\t    break;\n\t\t}\n\t}\n\tpa->ipa_nirq = i;\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tv0 = isapnp_read_reg(sc, isapnp_drq_range[i]);\n\t\tp = &pa->ipa_drq[i];\n\t\tp->num = v0 & 0xf;\n\t\tif (p->num == 4)\n\t\t\tbreak;\n\t}\n\tpa->ipa_ndrq = i;\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tr = &pa->ipa_mem32[i];\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16);\n\t\tv2 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8);\n\t\tv3 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0);\n\t\tr->base = (v0 << 24) | (v1 << 16) | (v2 << 8) | v3;\n\t\tif (r->base == 0)\n\t\t\tbreak;\n\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24);\n\t\tv1 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16);\n\t\tv2 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8);\n\t\tv3 = isapnp_read_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0);\n\t\tr->length = (v0 << 24) | (v1 << 16) | (v2 << 8) | v3;\n\t\tv0 = isapnp_read_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_CONTROL);\n\t\tr->flags = v0;\n\t}\n\tpa->ipa_nmem32 = i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_configure",
          "args": [
            "sc",
            "lpa"
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_configure",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "685-816",
          "snippet": "void\nisapnp_configure(sc, ipa)\n\tstruct isapnp_softc *sc;\n\tconst struct isa_attach_args *ipa;\n{\n\tint i;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\tstruct isapnp_region rz;\n\tstruct isapnp_pin pz;\n\n\tbzero(&pz, sizeof(pz));\n\tbzero(&rz, sizeof(rz));\n\n#define B0(a) ((a) & 0xff)\n#define B1(a) (((a) >> 8) & 0xff)\n#define B2(a) (((a) >> 16) & 0xff)\n#define B3(a) (((a) >> 24) & 0xff)\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tif (i < ipa->ipa_nio)\n\t\t\tr = &ipa->ipa_io[i];\n\t\telse\n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8, B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0, B0(r->base));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tif (i < ipa->ipa_nmem)\n\t\t\tr = &ipa->ipa_mem[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16, B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8, B1(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8,\n\t\t    B1(r->length));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_nirq)\n\t\t\tp = &ipa->ipa_irq[i];\n\t\telse\n\t\t\tp = &pz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER, p->num);\n\n\t\tswitch (p->flags) {\n\t\tcase ISAPNP_IRQTYPE_LEVEL_PLUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_EDGE_PLUS:\n\t\t\tv = ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_LEVEL_MINUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\tcase ISAPNP_IRQTYPE_EDGE_MINUS:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\t}\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_CONTROL, v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_ndrq)\n\t\t\tv = ipa->ipa_drq[i].num;\n\t\telse\n\t\t\tv = 4;\n\n\t\tisapnp_write_reg(sc, isapnp_drq_range[i], v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tif (i < ipa->ipa_nmem32)\n\t\t\tr = &ipa->ipa_mem32[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24,\n\t\t    B3(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16,\n\t\t    B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8,\n\t\t    B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0,\n\t\t    B0(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24,\n\t\t    B3(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8,\n\t\t    B1(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0,\n\t\t    B0(r->length));\n\t}\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_configure",
            "struct isapnp_softc *sc;",
            "struct isa_attach_args **ipa;",
            "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_configure;\nstruct isapnp_softc *sc;\nstruct isa_attach_args **ipa;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nvoid\nisapnp_configure(sc, ipa)\n\tstruct isapnp_softc *sc;\n\tconst struct isa_attach_args *ipa;\n{\n\tint i;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\tstruct isapnp_region rz;\n\tstruct isapnp_pin pz;\n\n\tbzero(&pz, sizeof(pz));\n\tbzero(&rz, sizeof(rz));\n\n#define B0(a) ((a) & 0xff)\n#define B1(a) (((a) >> 8) & 0xff)\n#define B2(a) (((a) >> 16) & 0xff)\n#define B3(a) (((a) >> 24) & 0xff)\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tif (i < ipa->ipa_nio)\n\t\t\tr = &ipa->ipa_io[i];\n\t\telse\n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8, B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0, B0(r->base));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tif (i < ipa->ipa_nmem)\n\t\t\tr = &ipa->ipa_mem[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16, B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8, B1(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8,\n\t\t    B1(r->length));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_nirq)\n\t\t\tp = &ipa->ipa_irq[i];\n\t\telse\n\t\t\tp = &pz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER, p->num);\n\n\t\tswitch (p->flags) {\n\t\tcase ISAPNP_IRQTYPE_LEVEL_PLUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_EDGE_PLUS:\n\t\t\tv = ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_LEVEL_MINUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\tcase ISAPNP_IRQTYPE_EDGE_MINUS:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\t}\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_CONTROL, v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_ndrq)\n\t\t\tv = ipa->ipa_drq[i].num;\n\t\telse\n\t\t\tv = 4;\n\n\t\tisapnp_write_reg(sc, isapnp_drq_range[i], v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tif (i < ipa->ipa_nmem32)\n\t\t\tr = &ipa->ipa_mem32[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24,\n\t\t    B3(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16,\n\t\t    B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8,\n\t\t    B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0,\n\t\t    B0(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24,\n\t\t    B3(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8,\n\t\t    B1(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0,\n\t\t    B0(r->length));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_bestconfig",
          "args": [
            "parent",
            "sc",
            "&ipa"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"Selecting attachments\\n\")"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_get_resource",
          "args": [
            "sc",
            "c"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_find",
          "args": [
            "sc",
            "1"
          ],
          "line": 899
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "642-677",
          "snippet": "int\nisapnp_find(sc, all)\n\tstruct isapnp_softc *sc;\n\tint all;\n{\n\tint p;\n\n\tisapnp_init(sc);\n\n\tisapnp_write_reg(sc, ISAPNP_CONFIG_CONTROL, ISAPNP_CC_RESET_DRV);\n\tDELAY(2000);\n\n\tisapnp_init(sc);\n\tDELAY(2000);\n\n\tfor (p = ISAPNP_RDDATA_MIN; p <= ISAPNP_RDDATA_MAX; p += 4) {\n\t\tsc->sc_read_port = p;\n\t\tif (isapnp_map_readport(sc))\n\t\t\tcontinue;\n\t\tDPRINTF((\"%s: Trying port %x\\n\", sc->sc_dev.dv_xname, p));\n\t\tif (isapnp_findcard(sc))\n\t\t\tbreak;\n\t\tisapnp_unmap_readport(sc);\n\t}\n\n\tif (p > ISAPNP_RDDATA_MAX) {\n\t\tsc->sc_read_port = 0;\n\t\treturn 0;\n\t}\n\n\tif (all)\n\t\twhile (isapnp_findcard(sc))\n\t\t\tcontinue;\n\n\treturn 1;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_init",
            "int isapnp_findcard",
            "int isapnp_find",
            "struct isapnp_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_init;\nint isapnp_findcard;\nint isapnp_find;\nstruct isapnp_softc *sc;\n\nint\nisapnp_find(sc, all)\n\tstruct isapnp_softc *sc;\n\tint all;\n{\n\tint p;\n\n\tisapnp_init(sc);\n\n\tisapnp_write_reg(sc, ISAPNP_CONFIG_CONTROL, ISAPNP_CC_RESET_DRV);\n\tDELAY(2000);\n\n\tisapnp_init(sc);\n\tDELAY(2000);\n\n\tfor (p = ISAPNP_RDDATA_MIN; p <= ISAPNP_RDDATA_MAX; p += 4) {\n\t\tsc->sc_read_port = p;\n\t\tif (isapnp_map_readport(sc))\n\t\t\tcontinue;\n\t\tDPRINTF((\"%s: Trying port %x\\n\", sc->sc_dev.dv_xname, p));\n\t\tif (isapnp_findcard(sc))\n\t\t\tbreak;\n\t\tisapnp_unmap_readport(sc);\n\t}\n\n\tif (p > ISAPNP_RDDATA_MAX) {\n\t\tsc->sc_read_port = 0;\n\t\treturn 0;\n\t}\n\n\tif (all)\n\t\twhile (isapnp_findcard(sc))\n\t\t\tcontinue;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"%s: bus map failed\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_map",
          "args": [
            "sc"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstruct isa_attach_args *isapnp_bestconfig;\nvoid isapnp_configure;\nint isapnp_print;\nint isapnp_submatch;\nint isapnp_com_submatch;\nint isapnp_find;\nvoid isapnp_attach;\nstruct isapnp_softc *sc;\nstruct isa_attach_args **ipa;\n\nvoid\nisapnp_attach(parent, self, aux)\n\tstruct device *parent, *self;\n\tvoid *aux;\n{\n\tstruct isapnp_softc *sc = (struct isapnp_softc *) self;\n\tstruct isa_attach_args *ia = aux;\n\tvoid *match;\n\tint c, d;\n\n\tsc->sc_iot = ia->ia_iot;\n\tsc->sc_memt = ia->ia_memt;\n\tsc->sc_dmat = ia->ia_dmat;\n\tsc->sc_ncards = 0;\n\n\tif (isapnp_map(sc))\n\t\tpanic(\"%s: bus map failed\", sc->sc_dev.dv_xname);\n\n\tif (!isapnp_find(sc, 1)) {\n\t\tprintf(\": no cards found\\n\", sc->sc_dev.dv_xname);\n\t\treturn;\n\t}\n\n\tprintf(\": read port 0x%x\\n\", sc->sc_read_port);\n\n\tfor (c = 0; c < sc->sc_ncards; c++) {\n\t\tstruct isa_attach_args *ipa, *lpa;\n\n\t\t/* Good morning card c */\n\t\tisapnp_write_reg(sc, ISAPNP_WAKE, c + 1);\n\n\t\tif ((ipa = isapnp_get_resource(sc, c)) == NULL)\n\t\t\tcontinue;\n\n\t\tDPRINTF((\"Selecting attachments\\n\"));\n\t\tfor (d = 0;\n\t\t    (lpa = isapnp_bestconfig(parent, sc, &ipa)) != NULL; d++) {\n\t\t\tisapnp_write_reg(sc, ISAPNP_LOGICAL_DEV_NUM, d);\n\t\t\tisapnp_configure(sc, lpa);\n#ifdef DEBUG_ISAPNP\n\t\t\t{\n\t\t\t\tstruct isa_attach_args pa;\n\n\t\t\t\tisapnp_get_config(sc, &pa);\n\t\t\t\tisapnp_print_config(&pa);\n\t\t\t}\n#endif\n\n\t\t\tDPRINTF((\"%s: configuring <%s, %s, %s, %s>\\n\",\n\t\t\t    sc->sc_dev.dv_xname,\n\t\t\t    lpa->ipa_devident, lpa->ipa_devlogic,\n\t\t\t    lpa->ipa_devcompat, lpa->ipa_devclass));\n\t\t\tif (lpa->ipa_pref == ISAPNP_DEP_CONFLICTING) {\n\t\t\t\tisapnp_print(lpa, self->dv_xname);\n\t\t\t\tprintf(\" resource conflict\\n\");\n\t\t\t\tISAPNP_FREE(lpa);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlpa->ia_ic = ia->ia_ic;\n\t\t\tlpa->ia_iot = ia->ia_iot;\n\t\t\tlpa->ia_memt = ia->ia_memt;\n\t\t\tlpa->ia_dmat = ia->ia_dmat;\n\t\t\tlpa->ia_delaybah = ia->ia_delaybah;\n\n\t\t\tisapnp_write_reg(sc, ISAPNP_ACTIVATE, 1);\n\n\t\t\tif ((match = config_search(isapnp_submatch,\n\t\t\t    self, lpa)))\n\t\t\t\tconfig_attach(self, match, lpa, isapnp_print);\n\t\t\telse if ((match = config_search(isapnp_com_submatch,\n\t\t\t    self, lpa)))\n\t\t\t\tconfig_attach(self, match, lpa, isapnp_print);\n\t\t\telse {\n\t\t\t\tisapnp_print(lpa, self->dv_xname);\n\t\t\t\tprintf(\" not configured\\n\");\n\t\t\t\tisapnp_write_reg(sc, ISAPNP_ACTIVATE, 0);\n\t\t\t}\n\t\t\tISAPNP_FREE(lpa);\n\t\t}\n\t\tisapnp_write_reg(sc, ISAPNP_WAKE, 0);    /* Good night cards */\n\t}\n}"
  },
  {
    "function_name": "isapnp_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "849-875",
    "snippet": "int\nisapnp_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match;\n\tvoid *aux;\n{\n\tint rv;\n\tstruct isapnp_softc sc;\n\tstruct isa_attach_args *ia = aux;\n\n\tsc.sc_iot = ia->ia_iot;\n\tsc.sc_ncards = 0;\n\t(void) strcpy(sc.sc_dev.dv_xname, \"(isapnp probe)\");\n\n\tif (isapnp_map(&sc))\n\t\treturn 0;\n\n\trv = isapnp_find(&sc, 0);\n\tia->ia_iobase = ISAPNP_ADDR;\n\tia->ia_iosize = 1;\n\n\tisapnp_unmap(&sc);\n\tif (rv)\n\t\tisapnp_unmap_readport(&sc);\n\n\treturn (rv);\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int isapnp_find",
      "int isapnp_match",
      "struct isapnp_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_unmap_readport",
          "args": [
            "&sc"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_unmap",
          "args": [
            "&sc"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_find",
          "args": [
            "&sc",
            "0"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "642-677",
          "snippet": "int\nisapnp_find(sc, all)\n\tstruct isapnp_softc *sc;\n\tint all;\n{\n\tint p;\n\n\tisapnp_init(sc);\n\n\tisapnp_write_reg(sc, ISAPNP_CONFIG_CONTROL, ISAPNP_CC_RESET_DRV);\n\tDELAY(2000);\n\n\tisapnp_init(sc);\n\tDELAY(2000);\n\n\tfor (p = ISAPNP_RDDATA_MIN; p <= ISAPNP_RDDATA_MAX; p += 4) {\n\t\tsc->sc_read_port = p;\n\t\tif (isapnp_map_readport(sc))\n\t\t\tcontinue;\n\t\tDPRINTF((\"%s: Trying port %x\\n\", sc->sc_dev.dv_xname, p));\n\t\tif (isapnp_findcard(sc))\n\t\t\tbreak;\n\t\tisapnp_unmap_readport(sc);\n\t}\n\n\tif (p > ISAPNP_RDDATA_MAX) {\n\t\tsc->sc_read_port = 0;\n\t\treturn 0;\n\t}\n\n\tif (all)\n\t\twhile (isapnp_findcard(sc))\n\t\t\tcontinue;\n\n\treturn 1;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_init",
            "int isapnp_findcard",
            "int isapnp_find",
            "struct isapnp_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_init;\nint isapnp_findcard;\nint isapnp_find;\nstruct isapnp_softc *sc;\n\nint\nisapnp_find(sc, all)\n\tstruct isapnp_softc *sc;\n\tint all;\n{\n\tint p;\n\n\tisapnp_init(sc);\n\n\tisapnp_write_reg(sc, ISAPNP_CONFIG_CONTROL, ISAPNP_CC_RESET_DRV);\n\tDELAY(2000);\n\n\tisapnp_init(sc);\n\tDELAY(2000);\n\n\tfor (p = ISAPNP_RDDATA_MIN; p <= ISAPNP_RDDATA_MAX; p += 4) {\n\t\tsc->sc_read_port = p;\n\t\tif (isapnp_map_readport(sc))\n\t\t\tcontinue;\n\t\tDPRINTF((\"%s: Trying port %x\\n\", sc->sc_dev.dv_xname, p));\n\t\tif (isapnp_findcard(sc))\n\t\t\tbreak;\n\t\tisapnp_unmap_readport(sc);\n\t}\n\n\tif (p > ISAPNP_RDDATA_MAX) {\n\t\tsc->sc_read_port = 0;\n\t\treturn 0;\n\t}\n\n\tif (all)\n\t\twhile (isapnp_findcard(sc))\n\t\t\tcontinue;\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_map",
          "args": [
            "&sc"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "sc.sc_dev.dv_xname",
            "\"(isapnp probe)\""
          ],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_find;\nint isapnp_match;\nstruct isapnp_softc *sc;\n\nint\nisapnp_match(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match;\n\tvoid *aux;\n{\n\tint rv;\n\tstruct isapnp_softc sc;\n\tstruct isa_attach_args *ia = aux;\n\n\tsc.sc_iot = ia->ia_iot;\n\tsc.sc_ncards = 0;\n\t(void) strcpy(sc.sc_dev.dv_xname, \"(isapnp probe)\");\n\n\tif (isapnp_map(&sc))\n\t\treturn 0;\n\n\trv = isapnp_find(&sc, 0);\n\tia->ia_iobase = ISAPNP_ADDR;\n\tia->ia_iosize = 1;\n\n\tisapnp_unmap(&sc);\n\tif (rv)\n\t\tisapnp_unmap_readport(&sc);\n\n\treturn (rv);\n}"
  },
  {
    "function_name": "isapnp_isa_attach_hook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "824-844",
    "snippet": "void\nisapnp_isa_attach_hook(isa_sc)\n\tstruct isa_softc *isa_sc;\n\n{\n\tstruct isapnp_softc sc;\n\t\n\tbzero(&sc, sizeof sc);\n\tsc.sc_iot = isa_sc->sc_iot;\n\tsc.sc_ncards = 0;\n\n\tif (isapnp_map(&sc))\n\t\treturn;\n\n\tisapnp_init(&sc);\n\n\tisapnp_write_reg(&sc, ISAPNP_CONFIG_CONTROL, ISAPNP_CC_RESET_DRV);\n\tDELAY(2000);\n\n\tisapnp_unmap(&sc);\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_init",
      "struct isapnp_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_unmap",
          "args": [
            "&sc"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "2000"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_write_reg",
          "args": [
            "&sc",
            "ISAPNP_CONFIG_CONTROL",
            "ISAPNP_CC_RESET_DRV"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_write_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isavar.h",
          "lines": "423-431",
          "snippet": "static __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}",
          "includes": [
            "#include <alpha/isa/isapnp_machdep.h>",
            "#include <i386/isa/isapnp_machdep.h>",
            "#include \"isapnp.h\"",
            "#include <hppa/isa/isa_machdep.h>",
            "#include <powerpc/isa/isa_machdep.h>",
            "#include <wgrisc/isa/isa_machdep.h>",
            "#include <arc/isa/isa_machdep.h>",
            "#include <i386/isa/isa_machdep.h>",
            "#include <amiga/isa/isa_machdep.h>",
            "#include <alpha/isa/isa_machdep.h>",
            "#include \"isadma.h\"",
            "#include <machine/bus.h>",
            "#include <sys/queue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <alpha/isa/isapnp_machdep.h>\n#include <i386/isa/isapnp_machdep.h>\n#include \"isapnp.h\"\n#include <hppa/isa/isa_machdep.h>\n#include <powerpc/isa/isa_machdep.h>\n#include <wgrisc/isa/isa_machdep.h>\n#include <arc/isa/isa_machdep.h>\n#include <i386/isa/isa_machdep.h>\n#include <amiga/isa/isa_machdep.h>\n#include <alpha/isa/isa_machdep.h>\n#include \"isadma.h\"\n#include <machine/bus.h>\n#include <sys/queue.h>\n\nstatic __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_init",
          "args": [
            "&sc"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "92-108",
          "snippet": "void\nisapnp_init(sc)\n\tstruct isapnp_softc *sc;\n{\n\tint i;\n\tu_char v = ISAPNP_LFSR_INIT;\n\n\t/* First write 0's twice to enter the Wait for Key state */\n\tISAPNP_WRITE_ADDR(sc, 0);\n\tISAPNP_WRITE_ADDR(sc, 0);\n\n\t/* Send the 32 byte sequence to awake the logic */\n\tfor (i = 0; i < ISAPNP_LFSR_LENGTH; i++) {\n\t\tISAPNP_WRITE_ADDR(sc, v);\n\t\tv = ISAPNP_LFSR_NEXT(v);\n\t}\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_init",
            "struct isapnp_softc *sc;",
            "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_init;\nstruct isapnp_softc *sc;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nvoid\nisapnp_init(sc)\n\tstruct isapnp_softc *sc;\n{\n\tint i;\n\tu_char v = ISAPNP_LFSR_INIT;\n\n\t/* First write 0's twice to enter the Wait for Key state */\n\tISAPNP_WRITE_ADDR(sc, 0);\n\tISAPNP_WRITE_ADDR(sc, 0);\n\n\t/* Send the 32 byte sequence to awake the logic */\n\tfor (i = 0; i < ISAPNP_LFSR_LENGTH; i++) {\n\t\tISAPNP_WRITE_ADDR(sc, v);\n\t\tv = ISAPNP_LFSR_NEXT(v);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_map",
          "args": [
            "&sc"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "&sc",
            "sizeof sc"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_init;\nstruct isapnp_softc *sc;\n\nvoid\nisapnp_isa_attach_hook(isa_sc)\n\tstruct isa_softc *isa_sc;\n\n{\n\tstruct isapnp_softc sc;\n\t\n\tbzero(&sc, sizeof sc);\n\tsc.sc_iot = isa_sc->sc_iot;\n\tsc.sc_ncards = 0;\n\n\tif (isapnp_map(&sc))\n\t\treturn;\n\n\tisapnp_init(&sc);\n\n\tisapnp_write_reg(&sc, ISAPNP_CONFIG_CONTROL, ISAPNP_CC_RESET_DRV);\n\tDELAY(2000);\n\n\tisapnp_unmap(&sc);\n}"
  },
  {
    "function_name": "isapnp_configure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "685-816",
    "snippet": "void\nisapnp_configure(sc, ipa)\n\tstruct isapnp_softc *sc;\n\tconst struct isa_attach_args *ipa;\n{\n\tint i;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\tstruct isapnp_region rz;\n\tstruct isapnp_pin pz;\n\n\tbzero(&pz, sizeof(pz));\n\tbzero(&rz, sizeof(rz));\n\n#define B0(a) ((a) & 0xff)\n#define B1(a) (((a) >> 8) & 0xff)\n#define B2(a) (((a) >> 16) & 0xff)\n#define B3(a) (((a) >> 24) & 0xff)\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tif (i < ipa->ipa_nio)\n\t\t\tr = &ipa->ipa_io[i];\n\t\telse\n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8, B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0, B0(r->base));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tif (i < ipa->ipa_nmem)\n\t\t\tr = &ipa->ipa_mem[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16, B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8, B1(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8,\n\t\t    B1(r->length));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_nirq)\n\t\t\tp = &ipa->ipa_irq[i];\n\t\telse\n\t\t\tp = &pz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER, p->num);\n\n\t\tswitch (p->flags) {\n\t\tcase ISAPNP_IRQTYPE_LEVEL_PLUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_EDGE_PLUS:\n\t\t\tv = ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_LEVEL_MINUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\tcase ISAPNP_IRQTYPE_EDGE_MINUS:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\t}\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_CONTROL, v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_ndrq)\n\t\t\tv = ipa->ipa_drq[i].num;\n\t\telse\n\t\t\tv = 4;\n\n\t\tisapnp_write_reg(sc, isapnp_drq_range[i], v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tif (i < ipa->ipa_nmem32)\n\t\t\tr = &ipa->ipa_mem32[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24,\n\t\t    B3(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16,\n\t\t    B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8,\n\t\t    B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0,\n\t\t    B0(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24,\n\t\t    B3(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8,\n\t\t    B1(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0,\n\t\t    B0(r->length));\n\t}\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_configure",
      "struct isapnp_softc *sc;",
      "struct isa_attach_args **ipa;",
      "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_write_reg",
          "args": [
            "sc",
            "isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0",
            "B0(r->length)"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_write_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isavar.h",
          "lines": "423-431",
          "snippet": "static __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}",
          "includes": [
            "#include <alpha/isa/isapnp_machdep.h>",
            "#include <i386/isa/isapnp_machdep.h>",
            "#include \"isapnp.h\"",
            "#include <hppa/isa/isa_machdep.h>",
            "#include <powerpc/isa/isa_machdep.h>",
            "#include <wgrisc/isa/isa_machdep.h>",
            "#include <arc/isa/isa_machdep.h>",
            "#include <i386/isa/isa_machdep.h>",
            "#include <amiga/isa/isa_machdep.h>",
            "#include <alpha/isa/isa_machdep.h>",
            "#include \"isadma.h\"",
            "#include <machine/bus.h>",
            "#include <sys/queue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <alpha/isa/isapnp_machdep.h>\n#include <i386/isa/isapnp_machdep.h>\n#include \"isapnp.h\"\n#include <hppa/isa/isa_machdep.h>\n#include <powerpc/isa/isa_machdep.h>\n#include <wgrisc/isa/isa_machdep.h>\n#include <arc/isa/isa_machdep.h>\n#include <i386/isa/isa_machdep.h>\n#include <amiga/isa/isa_machdep.h>\n#include <alpha/isa/isa_machdep.h>\n#include \"isadma.h\"\n#include <machine/bus.h>\n#include <sys/queue.h>\n\nstatic __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "B0",
          "args": [
            "r->length"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B1",
          "args": [
            "r->length"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B2",
          "args": [
            "r->length"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B3",
          "args": [
            "r->length"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B0",
          "args": [
            "r->base"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B1",
          "args": [
            "r->base"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B2",
          "args": [
            "r->base"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B3",
          "args": [
            "r->base"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B1",
          "args": [
            "r->length"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B2",
          "args": [
            "r->length"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B1",
          "args": [
            "r->base"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B2",
          "args": [
            "r->base"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B0",
          "args": [
            "r->base"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "B1",
          "args": [
            "r->base"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "&rz",
            "sizeof(rz)"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bzero",
          "args": [
            "&pz",
            "sizeof(pz)"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_configure;\nstruct isapnp_softc *sc;\nstruct isa_attach_args **ipa;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nvoid\nisapnp_configure(sc, ipa)\n\tstruct isapnp_softc *sc;\n\tconst struct isa_attach_args *ipa;\n{\n\tint i;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\tstruct isapnp_region rz;\n\tstruct isapnp_pin pz;\n\n\tbzero(&pz, sizeof(pz));\n\tbzero(&rz, sizeof(rz));\n\n#define B0(a) ((a) & 0xff)\n#define B1(a) (((a) >> 8) & 0xff)\n#define B2(a) (((a) >> 16) & 0xff)\n#define B3(a) (((a) >> 24) & 0xff)\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tif (i < ipa->ipa_nio)\n\t\t\tr = &ipa->ipa_io[i];\n\t\telse\n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8, B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0, B0(r->base));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tif (i < ipa->ipa_nmem)\n\t\t\tr = &ipa->ipa_mem[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16, B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8, B1(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8,\n\t\t    B1(r->length));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_nirq)\n\t\t\tp = &ipa->ipa_irq[i];\n\t\telse\n\t\t\tp = &pz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER, p->num);\n\n\t\tswitch (p->flags) {\n\t\tcase ISAPNP_IRQTYPE_LEVEL_PLUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_EDGE_PLUS:\n\t\t\tv = ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_LEVEL_MINUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\tcase ISAPNP_IRQTYPE_EDGE_MINUS:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\t}\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_CONTROL, v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_ndrq)\n\t\t\tv = ipa->ipa_drq[i].num;\n\t\telse\n\t\t\tv = 4;\n\n\t\tisapnp_write_reg(sc, isapnp_drq_range[i], v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tif (i < ipa->ipa_nmem32)\n\t\t\tr = &ipa->ipa_mem32[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24,\n\t\t    B3(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16,\n\t\t    B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8,\n\t\t    B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0,\n\t\t    B0(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24,\n\t\t    B3(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8,\n\t\t    B1(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0,\n\t\t    B0(r->length));\n\t}\n}"
  },
  {
    "function_name": "isapnp_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "642-677",
    "snippet": "int\nisapnp_find(sc, all)\n\tstruct isapnp_softc *sc;\n\tint all;\n{\n\tint p;\n\n\tisapnp_init(sc);\n\n\tisapnp_write_reg(sc, ISAPNP_CONFIG_CONTROL, ISAPNP_CC_RESET_DRV);\n\tDELAY(2000);\n\n\tisapnp_init(sc);\n\tDELAY(2000);\n\n\tfor (p = ISAPNP_RDDATA_MIN; p <= ISAPNP_RDDATA_MAX; p += 4) {\n\t\tsc->sc_read_port = p;\n\t\tif (isapnp_map_readport(sc))\n\t\t\tcontinue;\n\t\tDPRINTF((\"%s: Trying port %x\\n\", sc->sc_dev.dv_xname, p));\n\t\tif (isapnp_findcard(sc))\n\t\t\tbreak;\n\t\tisapnp_unmap_readport(sc);\n\t}\n\n\tif (p > ISAPNP_RDDATA_MAX) {\n\t\tsc->sc_read_port = 0;\n\t\treturn 0;\n\t}\n\n\tif (all)\n\t\twhile (isapnp_findcard(sc))\n\t\t\tcontinue;\n\n\treturn 1;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_init",
      "int isapnp_findcard",
      "int isapnp_find",
      "struct isapnp_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_findcard",
          "args": [
            "sc"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_findcard",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "137-186",
          "snippet": "int\nisapnp_findcard(sc)\n\tstruct isapnp_softc *sc;\n{\n\tu_char v = ISAPNP_LFSR_INIT, csum, w;\n\tint i, b;\n\n\tif (sc->sc_ncards == ISAPNP_MAX_CARDS) {\n\t\tprintf(\"%s: Too many pnp cards\\n\", sc->sc_dev.dv_xname);\n\t\treturn 0;\n\t}\n\n\t/* Set the read port */\n\tisapnp_write_reg(sc, ISAPNP_WAKE, 0);\n\tisapnp_write_reg(sc, ISAPNP_SET_RD_PORT, sc->sc_read_port >> 2);\n\tsc->sc_read_port |= 3;\n\tDELAY(1000);\n\n\tISAPNP_WRITE_ADDR(sc, ISAPNP_SERIAL_ISOLATION);\n\tDELAY(1000);\n\n\t/* Read the 8 bytes of the Vendor ID and Serial Number */\n\tfor(i = 0; i < 8; i++) {\n\t\t/* Read each bit separately */\n\t\tfor (w = 0, b = 0; b < 8; b++) {\n\t\t\tu_char neg = isapnp_shift_bit(sc);\n\n\t\t\tw >>= 1;\n\t\t\tw |= neg;\n\t\t\tv = ISAPNP_LFSR_NEXT(v) ^ neg;\n\t\t}\n\t\tsc->sc_id[sc->sc_ncards][i] = w;\n\t}\n\n\t/* Read the remaining checksum byte */\n\tfor (csum = 0, b = 0; b < 8; b++) {\n\t\tu_char neg = isapnp_shift_bit(sc);\n\n\t\tcsum >>= 1;\n\t\tcsum |= neg;\n\t}\n\tsc->sc_id[sc->sc_ncards][8] = csum;\n\n\tif (csum == v) {\n\t\tsc->sc_ncards++;\n\t\tisapnp_write_reg(sc, ISAPNP_CARD_SELECT_NUM, sc->sc_ncards);\n\t\treturn 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline u_char isapnp_shift_bit",
            "int isapnp_findcard",
            "struct isapnp_softc *sc;",
            "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline u_char isapnp_shift_bit;\nint isapnp_findcard;\nstruct isapnp_softc *sc;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nint\nisapnp_findcard(sc)\n\tstruct isapnp_softc *sc;\n{\n\tu_char v = ISAPNP_LFSR_INIT, csum, w;\n\tint i, b;\n\n\tif (sc->sc_ncards == ISAPNP_MAX_CARDS) {\n\t\tprintf(\"%s: Too many pnp cards\\n\", sc->sc_dev.dv_xname);\n\t\treturn 0;\n\t}\n\n\t/* Set the read port */\n\tisapnp_write_reg(sc, ISAPNP_WAKE, 0);\n\tisapnp_write_reg(sc, ISAPNP_SET_RD_PORT, sc->sc_read_port >> 2);\n\tsc->sc_read_port |= 3;\n\tDELAY(1000);\n\n\tISAPNP_WRITE_ADDR(sc, ISAPNP_SERIAL_ISOLATION);\n\tDELAY(1000);\n\n\t/* Read the 8 bytes of the Vendor ID and Serial Number */\n\tfor(i = 0; i < 8; i++) {\n\t\t/* Read each bit separately */\n\t\tfor (w = 0, b = 0; b < 8; b++) {\n\t\t\tu_char neg = isapnp_shift_bit(sc);\n\n\t\t\tw >>= 1;\n\t\t\tw |= neg;\n\t\t\tv = ISAPNP_LFSR_NEXT(v) ^ neg;\n\t\t}\n\t\tsc->sc_id[sc->sc_ncards][i] = w;\n\t}\n\n\t/* Read the remaining checksum byte */\n\tfor (csum = 0, b = 0; b < 8; b++) {\n\t\tu_char neg = isapnp_shift_bit(sc);\n\n\t\tcsum >>= 1;\n\t\tcsum |= neg;\n\t}\n\tsc->sc_id[sc->sc_ncards][8] = csum;\n\n\tif (csum == v) {\n\t\tsc->sc_ncards++;\n\t\tisapnp_write_reg(sc, ISAPNP_CARD_SELECT_NUM, sc->sc_ncards);\n\t\treturn 1;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_unmap_readport",
          "args": [
            "sc"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DPRINTF",
          "args": [
            "(\"%s: Trying port %x\\n\", sc->sc_dev.dv_xname, p)"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_map_readport",
          "args": [
            "sc"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "2000"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_init",
          "args": [
            "sc"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "92-108",
          "snippet": "void\nisapnp_init(sc)\n\tstruct isapnp_softc *sc;\n{\n\tint i;\n\tu_char v = ISAPNP_LFSR_INIT;\n\n\t/* First write 0's twice to enter the Wait for Key state */\n\tISAPNP_WRITE_ADDR(sc, 0);\n\tISAPNP_WRITE_ADDR(sc, 0);\n\n\t/* Send the 32 byte sequence to awake the logic */\n\tfor (i = 0; i < ISAPNP_LFSR_LENGTH; i++) {\n\t\tISAPNP_WRITE_ADDR(sc, v);\n\t\tv = ISAPNP_LFSR_NEXT(v);\n\t}\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_init",
            "struct isapnp_softc *sc;",
            "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_init;\nstruct isapnp_softc *sc;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nvoid\nisapnp_init(sc)\n\tstruct isapnp_softc *sc;\n{\n\tint i;\n\tu_char v = ISAPNP_LFSR_INIT;\n\n\t/* First write 0's twice to enter the Wait for Key state */\n\tISAPNP_WRITE_ADDR(sc, 0);\n\tISAPNP_WRITE_ADDR(sc, 0);\n\n\t/* Send the 32 byte sequence to awake the logic */\n\tfor (i = 0; i < ISAPNP_LFSR_LENGTH; i++) {\n\t\tISAPNP_WRITE_ADDR(sc, v);\n\t\tv = ISAPNP_LFSR_NEXT(v);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "2000"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_write_reg",
          "args": [
            "sc",
            "ISAPNP_CONFIG_CONTROL",
            "ISAPNP_CC_RESET_DRV"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_write_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isavar.h",
          "lines": "423-431",
          "snippet": "static __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}",
          "includes": [
            "#include <alpha/isa/isapnp_machdep.h>",
            "#include <i386/isa/isapnp_machdep.h>",
            "#include \"isapnp.h\"",
            "#include <hppa/isa/isa_machdep.h>",
            "#include <powerpc/isa/isa_machdep.h>",
            "#include <wgrisc/isa/isa_machdep.h>",
            "#include <arc/isa/isa_machdep.h>",
            "#include <i386/isa/isa_machdep.h>",
            "#include <amiga/isa/isa_machdep.h>",
            "#include <alpha/isa/isa_machdep.h>",
            "#include \"isadma.h\"",
            "#include <machine/bus.h>",
            "#include <sys/queue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <alpha/isa/isapnp_machdep.h>\n#include <i386/isa/isapnp_machdep.h>\n#include \"isapnp.h\"\n#include <hppa/isa/isa_machdep.h>\n#include <powerpc/isa/isa_machdep.h>\n#include <wgrisc/isa/isa_machdep.h>\n#include <arc/isa/isa_machdep.h>\n#include <i386/isa/isa_machdep.h>\n#include <amiga/isa/isa_machdep.h>\n#include <alpha/isa/isa_machdep.h>\n#include \"isadma.h\"\n#include <machine/bus.h>\n#include <sys/queue.h>\n\nstatic __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_init;\nint isapnp_findcard;\nint isapnp_find;\nstruct isapnp_softc *sc;\n\nint\nisapnp_find(sc, all)\n\tstruct isapnp_softc *sc;\n\tint all;\n{\n\tint p;\n\n\tisapnp_init(sc);\n\n\tisapnp_write_reg(sc, ISAPNP_CONFIG_CONTROL, ISAPNP_CC_RESET_DRV);\n\tDELAY(2000);\n\n\tisapnp_init(sc);\n\tDELAY(2000);\n\n\tfor (p = ISAPNP_RDDATA_MIN; p <= ISAPNP_RDDATA_MAX; p += 4) {\n\t\tsc->sc_read_port = p;\n\t\tif (isapnp_map_readport(sc))\n\t\t\tcontinue;\n\t\tDPRINTF((\"%s: Trying port %x\\n\", sc->sc_dev.dv_xname, p));\n\t\tif (isapnp_findcard(sc))\n\t\t\tbreak;\n\t\tisapnp_unmap_readport(sc);\n\t}\n\n\tif (p > ISAPNP_RDDATA_MAX) {\n\t\tsc->sc_read_port = 0;\n\t\treturn 0;\n\t}\n\n\tif (all)\n\t\twhile (isapnp_findcard(sc))\n\t\t\tcontinue;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "isapnp_submatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "603-637",
    "snippet": "int\nisapnp_submatch(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct cfdata *cf = match;\n\tstruct isa_attach_args *ipa = aux;\n\tconst char *dname;\n\tint i;\n\n\tfor (i = 0; isapnp_knowndevs[i].pnpid; i++) {\n\t\tdname = NULL;\n\n\t\tif (strcmp(isapnp_knowndevs[i].pnpid, ipa->ipa_devlogic) == 0)\n\t\t\tdname = isapnp_knowndevs[i].driver;\n\t\telse if (strcmp(isapnp_knowndevs[i].pnpid, ipa->ipa_devcompat) == 0)\n\t\t\tdname = isapnp_knowndevs[i].driver;\n\n\t\tif (dname && strcmp(dname, cf->cf_driver->cd_name) == 0) {\n\t\t\t/*\n\t\t\t * We found a match.  Configure the card and call the\n\t\t\t * ISA probe...\n\t\t\t */\n\t\t\tif (isapnp_config(ipa->ia_iot, ipa->ia_memt, ipa)) {\n\t\t\t\tprintf(\"%s: error in region allocation\\n\",\n\t\t\t\t    cf->cf_driver->cd_name);\n\t\t\t\treturn (0);\n\t\t\t}\n\n\t\t\treturn ((*cf->cf_attach->ca_match)(parent, match, ipa));\n\t\t}\n\t}\n\n\treturn (0);\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int isapnp_submatch",
      "struct isa_attach_args **ipa;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "parent",
            "match",
            "ipa"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: error in region allocation\\n\"",
            "cf->cf_driver->cd_name"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_config",
          "args": [
            "ipa->ia_iot",
            "ipa->ia_memt",
            "ipa"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_configure",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "685-816",
          "snippet": "void\nisapnp_configure(sc, ipa)\n\tstruct isapnp_softc *sc;\n\tconst struct isa_attach_args *ipa;\n{\n\tint i;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\tstruct isapnp_region rz;\n\tstruct isapnp_pin pz;\n\n\tbzero(&pz, sizeof(pz));\n\tbzero(&rz, sizeof(rz));\n\n#define B0(a) ((a) & 0xff)\n#define B1(a) (((a) >> 8) & 0xff)\n#define B2(a) (((a) >> 16) & 0xff)\n#define B3(a) (((a) >> 24) & 0xff)\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tif (i < ipa->ipa_nio)\n\t\t\tr = &ipa->ipa_io[i];\n\t\telse\n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8, B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0, B0(r->base));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tif (i < ipa->ipa_nmem)\n\t\t\tr = &ipa->ipa_mem[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16, B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8, B1(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8,\n\t\t    B1(r->length));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_nirq)\n\t\t\tp = &ipa->ipa_irq[i];\n\t\telse\n\t\t\tp = &pz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER, p->num);\n\n\t\tswitch (p->flags) {\n\t\tcase ISAPNP_IRQTYPE_LEVEL_PLUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_EDGE_PLUS:\n\t\t\tv = ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_LEVEL_MINUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\tcase ISAPNP_IRQTYPE_EDGE_MINUS:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\t}\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_CONTROL, v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_ndrq)\n\t\t\tv = ipa->ipa_drq[i].num;\n\t\telse\n\t\t\tv = 4;\n\n\t\tisapnp_write_reg(sc, isapnp_drq_range[i], v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tif (i < ipa->ipa_nmem32)\n\t\t\tr = &ipa->ipa_mem32[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24,\n\t\t    B3(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16,\n\t\t    B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8,\n\t\t    B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0,\n\t\t    B0(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24,\n\t\t    B3(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8,\n\t\t    B1(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0,\n\t\t    B0(r->length));\n\t}\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_configure",
            "struct isapnp_softc *sc;",
            "struct isa_attach_args **ipa;",
            "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_configure;\nstruct isapnp_softc *sc;\nstruct isa_attach_args **ipa;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nvoid\nisapnp_configure(sc, ipa)\n\tstruct isapnp_softc *sc;\n\tconst struct isa_attach_args *ipa;\n{\n\tint i;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\tstruct isapnp_region rz;\n\tstruct isapnp_pin pz;\n\n\tbzero(&pz, sizeof(pz));\n\tbzero(&rz, sizeof(rz));\n\n#define B0(a) ((a) & 0xff)\n#define B1(a) (((a) >> 8) & 0xff)\n#define B2(a) (((a) >> 16) & 0xff)\n#define B3(a) (((a) >> 24) & 0xff)\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tif (i < ipa->ipa_nio)\n\t\t\tr = &ipa->ipa_io[i];\n\t\telse\n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8, B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0, B0(r->base));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tif (i < ipa->ipa_nmem)\n\t\t\tr = &ipa->ipa_mem[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16, B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8, B1(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8,\n\t\t    B1(r->length));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_nirq)\n\t\t\tp = &ipa->ipa_irq[i];\n\t\telse\n\t\t\tp = &pz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER, p->num);\n\n\t\tswitch (p->flags) {\n\t\tcase ISAPNP_IRQTYPE_LEVEL_PLUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_EDGE_PLUS:\n\t\t\tv = ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_LEVEL_MINUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\tcase ISAPNP_IRQTYPE_EDGE_MINUS:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\t}\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_CONTROL, v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_ndrq)\n\t\t\tv = ipa->ipa_drq[i].num;\n\t\telse\n\t\t\tv = 4;\n\n\t\tisapnp_write_reg(sc, isapnp_drq_range[i], v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tif (i < ipa->ipa_nmem32)\n\t\t\tr = &ipa->ipa_mem32[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24,\n\t\t    B3(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16,\n\t\t    B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8,\n\t\t    B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0,\n\t\t    B0(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24,\n\t\t    B3(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8,\n\t\t    B1(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0,\n\t\t    B0(r->length));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "dname",
            "cf->cf_driver->cd_name"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "isapnp_knowndevs[i].pnpid",
            "ipa->ipa_devcompat"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "isapnp_knowndevs[i].pnpid",
            "ipa->ipa_devlogic"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_submatch;\nstruct isa_attach_args **ipa;\n\nint\nisapnp_submatch(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct cfdata *cf = match;\n\tstruct isa_attach_args *ipa = aux;\n\tconst char *dname;\n\tint i;\n\n\tfor (i = 0; isapnp_knowndevs[i].pnpid; i++) {\n\t\tdname = NULL;\n\n\t\tif (strcmp(isapnp_knowndevs[i].pnpid, ipa->ipa_devlogic) == 0)\n\t\t\tdname = isapnp_knowndevs[i].driver;\n\t\telse if (strcmp(isapnp_knowndevs[i].pnpid, ipa->ipa_devcompat) == 0)\n\t\t\tdname = isapnp_knowndevs[i].driver;\n\n\t\tif (dname && strcmp(dname, cf->cf_driver->cd_name) == 0) {\n\t\t\t/*\n\t\t\t * We found a match.  Configure the card and call the\n\t\t\t * ISA probe...\n\t\t\t */\n\t\t\tif (isapnp_config(ipa->ia_iot, ipa->ia_memt, ipa)) {\n\t\t\t\tprintf(\"%s: error in region allocation\\n\",\n\t\t\t\t    cf->cf_driver->cd_name);\n\t\t\t\treturn (0);\n\t\t\t}\n\n\t\t\treturn ((*cf->cf_attach->ca_match)(parent, match, ipa));\n\t\t}\n\t}\n\n\treturn (0);\n}"
  },
  {
    "function_name": "isapnp_com_submatch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "577-598",
    "snippet": "int\nisapnp_com_submatch(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct cfdata *cf = match;\n\tstruct isa_attach_args *ipa = aux;\n\n\tif ((strcmp(\"com\", cf->cf_driver->cd_name) == 0 ||\n\t    strcmp(\"pccom\", cf->cf_driver->cd_name) == 0) &&\n\t    ipa->ipa_nio == 1 && ipa->ipa_nirq == 1 &&\n\t    ipa->ipa_ndrq == 0 && ipa->ipa_nmem == 0 &&\n\t    ipa->ipa_io[0].length == 8) {\n\t\tif (isapnp_config(ipa->ia_iot, ipa->ia_memt, ipa)) {\n\t\t\tprintf(\"%s: error in region allocation\\n\",\n\t\t\t    cf->cf_driver->cd_name);\n\t\t\treturn (0);\n\t\t}\n\t\treturn ((*cf->cf_attach->ca_match)(parent, match, ipa));\n\t}\n\treturn (0);\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int isapnp_com_submatch",
      "struct isa_attach_args **ipa;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "parent",
            "match",
            "ipa"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: error in region allocation\\n\"",
            "cf->cf_driver->cd_name"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_config",
          "args": [
            "ipa->ia_iot",
            "ipa->ia_memt",
            "ipa"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_configure",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "685-816",
          "snippet": "void\nisapnp_configure(sc, ipa)\n\tstruct isapnp_softc *sc;\n\tconst struct isa_attach_args *ipa;\n{\n\tint i;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\tstruct isapnp_region rz;\n\tstruct isapnp_pin pz;\n\n\tbzero(&pz, sizeof(pz));\n\tbzero(&rz, sizeof(rz));\n\n#define B0(a) ((a) & 0xff)\n#define B1(a) (((a) >> 8) & 0xff)\n#define B2(a) (((a) >> 16) & 0xff)\n#define B3(a) (((a) >> 24) & 0xff)\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tif (i < ipa->ipa_nio)\n\t\t\tr = &ipa->ipa_io[i];\n\t\telse\n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8, B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0, B0(r->base));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tif (i < ipa->ipa_nmem)\n\t\t\tr = &ipa->ipa_mem[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16, B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8, B1(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8,\n\t\t    B1(r->length));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_nirq)\n\t\t\tp = &ipa->ipa_irq[i];\n\t\telse\n\t\t\tp = &pz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER, p->num);\n\n\t\tswitch (p->flags) {\n\t\tcase ISAPNP_IRQTYPE_LEVEL_PLUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_EDGE_PLUS:\n\t\t\tv = ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_LEVEL_MINUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\tcase ISAPNP_IRQTYPE_EDGE_MINUS:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\t}\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_CONTROL, v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_ndrq)\n\t\t\tv = ipa->ipa_drq[i].num;\n\t\telse\n\t\t\tv = 4;\n\n\t\tisapnp_write_reg(sc, isapnp_drq_range[i], v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tif (i < ipa->ipa_nmem32)\n\t\t\tr = &ipa->ipa_mem32[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24,\n\t\t    B3(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16,\n\t\t    B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8,\n\t\t    B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0,\n\t\t    B0(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24,\n\t\t    B3(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8,\n\t\t    B1(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0,\n\t\t    B0(r->length));\n\t}\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_configure",
            "struct isapnp_softc *sc;",
            "struct isa_attach_args **ipa;",
            "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_configure;\nstruct isapnp_softc *sc;\nstruct isa_attach_args **ipa;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nvoid\nisapnp_configure(sc, ipa)\n\tstruct isapnp_softc *sc;\n\tconst struct isa_attach_args *ipa;\n{\n\tint i;\n\tstatic u_char isapnp_mem_range[] = ISAPNP_MEM_DESC;\n\tstatic u_char isapnp_io_range[] = ISAPNP_IO_DESC;\n\tstatic u_char isapnp_irq_range[] = ISAPNP_IRQ_DESC;\n\tstatic u_char isapnp_drq_range[] = ISAPNP_DRQ_DESC;\n\tstatic u_char isapnp_mem32_range[] = ISAPNP_MEM32_DESC;\n\tconst struct isapnp_region *r;\n\tconst struct isapnp_pin *p;\n\tstruct isapnp_region rz;\n\tstruct isapnp_pin pz;\n\n\tbzero(&pz, sizeof(pz));\n\tbzero(&rz, sizeof(rz));\n\n#define B0(a) ((a) & 0xff)\n#define B1(a) (((a) >> 8) & 0xff)\n#define B2(a) (((a) >> 16) & 0xff)\n#define B3(a) (((a) >> 24) & 0xff)\n\n\tfor (i = 0; i < sizeof(isapnp_io_range); i++) {\n\t\tif (i < ipa->ipa_nio)\n\t\t\tr = &ipa->ipa_io[i];\n\t\telse\n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_15_8, B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_io_range[i] + ISAPNP_IO_BASE_7_0, B0(r->base));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem_range); i++) {\n\t\tif (i < ipa->ipa_nmem)\n\t\t\tr = &ipa->ipa_mem[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_23_16, B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_BASE_15_8, B1(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem_range[i] + ISAPNP_MEM_LRANGE_15_8,\n\t\t    B1(r->length));\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_irq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_nirq)\n\t\t\tp = &ipa->ipa_irq[i];\n\t\telse\n\t\t\tp = &pz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_NUMBER, p->num);\n\n\t\tswitch (p->flags) {\n\t\tcase ISAPNP_IRQTYPE_LEVEL_PLUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL|ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_EDGE_PLUS:\n\t\t\tv = ISAPNP_IRQ_HIGH;\n\t\t\tbreak;\n\n\t\tcase ISAPNP_IRQTYPE_LEVEL_MINUS:\n\t\t\tv = ISAPNP_IRQ_LEVEL;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\tcase ISAPNP_IRQTYPE_EDGE_MINUS:\n\t\t\tv = 0;\n\t\t\tbreak;\n\t\t}\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_irq_range[i] + ISAPNP_IRQ_CONTROL, v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_drq_range); i++) {\n\t\tu_char v;\n\n\t\tif (i < ipa->ipa_ndrq)\n\t\t\tv = ipa->ipa_drq[i].num;\n\t\telse\n\t\t\tv = 4;\n\n\t\tisapnp_write_reg(sc, isapnp_drq_range[i], v);\n\t}\n\n\tfor (i = 0; i < sizeof(isapnp_mem32_range); i++) {\n\t\tif (i < ipa->ipa_nmem32)\n\t\t\tr = &ipa->ipa_mem32[i];\n\t\telse \n\t\t\tr = &rz;\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_31_24,\n\t\t    B3(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_23_16,\n\t\t    B2(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_15_8,\n\t\t    B1(r->base));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_BASE_7_0,\n\t\t    B0(r->base));\n\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_31_24,\n\t\t    B3(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_23_16,\n\t\t    B2(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_15_8,\n\t\t    B1(r->length));\n\t\tisapnp_write_reg(sc,\n\t\t    isapnp_mem32_range[i] + ISAPNP_MEM32_LRANGE_7_0,\n\t\t    B0(r->length));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "\"pccom\"",
            "cf->cf_driver->cd_name"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "\"com\"",
            "cf->cf_driver->cd_name"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_com_submatch;\nstruct isa_attach_args **ipa;\n\nint\nisapnp_com_submatch(parent, match, aux)\n\tstruct device *parent;\n\tvoid *match, *aux;\n{\n\tstruct cfdata *cf = match;\n\tstruct isa_attach_args *ipa = aux;\n\n\tif ((strcmp(\"com\", cf->cf_driver->cd_name) == 0 ||\n\t    strcmp(\"pccom\", cf->cf_driver->cd_name) == 0) &&\n\t    ipa->ipa_nio == 1 && ipa->ipa_nirq == 1 &&\n\t    ipa->ipa_ndrq == 0 && ipa->ipa_nmem == 0 &&\n\t    ipa->ipa_io[0].length == 8) {\n\t\tif (isapnp_config(ipa->ia_iot, ipa->ia_memt, ipa)) {\n\t\t\tprintf(\"%s: error in region allocation\\n\",\n\t\t\t    cf->cf_driver->cd_name);\n\t\t\treturn (0);\n\t\t}\n\t\treturn ((*cf->cf_attach->ca_match)(parent, match, ipa));\n\t}\n\treturn (0);\n}"
  },
  {
    "function_name": "isapnp_print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "548-569",
    "snippet": "int\nisapnp_print(aux, str)\n\tvoid *aux;\n\tconst char *str;\n{\n\tstruct isa_attach_args *ipa = aux;\n\n\tif (!str)\n\t\tprintf(\" \");\n\tprintf(\"\\\"%s, %s, %s, %s\\\"\", ipa->ipa_devident,\n\t    ipa->ipa_devlogic, ipa->ipa_devcompat, ipa->ipa_devclass);\n\n\tif (str)\n\t\tprintf(\" at %s\", str);\n\n\tisapnp_print_region(\"port\", ipa->ipa_io, ipa->ipa_nio);\n\tisapnp_print_region(\"mem\", ipa->ipa_mem, ipa->ipa_nmem);\n\tisapnp_print_region(\"mem32\", ipa->ipa_mem32, ipa->ipa_nmem32);\n\tisapnp_print_pin(\"irq\", ipa->ipa_irq, ipa->ipa_nirq);\n\tisapnp_print_pin(\"drq\", ipa->ipa_drq, ipa->ipa_ndrq);\n\treturn UNCONF;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_print_region",
      "void isapnp_print_pin",
      "int isapnp_print",
      "struct isa_attach_args **ipa;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_print_pin",
          "args": [
            "\"drq\"",
            "ipa->ipa_drq",
            "ipa->ipa_ndrq"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_pin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "526-543",
          "snippet": "void\nisapnp_print_pin(str, p, n)\n\tconst char *str;\n\tstruct isapnp_pin *p;\n\tsize_t n;\n{\n\tsize_t i;\n\n\tif (n == 0)\n\t\treturn;\n\n\tprintf(\" %s \", str);\n\tfor (i = 0; i < n; i++, p++) {\n\t\tprintf(\"%d\", p->num);\n\t\tif (i != n - 1)\n\t\t\tprintf(\",\");\n\t}\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_print_pin"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_print_pin;\n\nvoid\nisapnp_print_pin(str, p, n)\n\tconst char *str;\n\tstruct isapnp_pin *p;\n\tsize_t n;\n{\n\tsize_t i;\n\n\tif (n == 0)\n\t\treturn;\n\n\tprintf(\" %s \", str);\n\tfor (i = 0; i < n; i++, p++) {\n\t\tprintf(\"%d\", p->num);\n\t\tif (i != n - 1)\n\t\t\tprintf(\",\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_print_region",
          "args": [
            "\"mem32\"",
            "ipa->ipa_mem32",
            "ipa->ipa_nmem32"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "501-520",
          "snippet": "void\nisapnp_print_region(str, r, n)\n\tconst char *str;\n\tstruct isapnp_region *r;\n\tsize_t n;\n{\n\tsize_t i;\n\n\tif (n == 0)\n\t\treturn;\n\n\tprintf(\" %s \", str);\n\tfor (i = 0; i < n; i++, r++) {\n\t\tprintf(\"0x%x\", r->base);\n\t\tif (r->length)\n\t\t\tprintf(\"/%d\", r->length);\n\t\tif (i != n - 1)\n\t\t\tprintf(\",\");\n\t}\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_print_region"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_print_region;\n\nvoid\nisapnp_print_region(str, r, n)\n\tconst char *str;\n\tstruct isapnp_region *r;\n\tsize_t n;\n{\n\tsize_t i;\n\n\tif (n == 0)\n\t\treturn;\n\n\tprintf(\" %s \", str);\n\tfor (i = 0; i < n; i++, r++) {\n\t\tprintf(\"0x%x\", r->base);\n\t\tif (r->length)\n\t\t\tprintf(\"/%d\", r->length);\n\t\tif (i != n - 1)\n\t\t\tprintf(\",\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\" at %s\"",
            "str"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_print_region;\nvoid isapnp_print_pin;\nint isapnp_print;\nstruct isa_attach_args **ipa;\n\nint\nisapnp_print(aux, str)\n\tvoid *aux;\n\tconst char *str;\n{\n\tstruct isa_attach_args *ipa = aux;\n\n\tif (!str)\n\t\tprintf(\" \");\n\tprintf(\"\\\"%s, %s, %s, %s\\\"\", ipa->ipa_devident,\n\t    ipa->ipa_devlogic, ipa->ipa_devcompat, ipa->ipa_devclass);\n\n\tif (str)\n\t\tprintf(\" at %s\", str);\n\n\tisapnp_print_region(\"port\", ipa->ipa_io, ipa->ipa_nio);\n\tisapnp_print_region(\"mem\", ipa->ipa_mem, ipa->ipa_nmem);\n\tisapnp_print_region(\"mem32\", ipa->ipa_mem32, ipa->ipa_nmem32);\n\tisapnp_print_pin(\"irq\", ipa->ipa_irq, ipa->ipa_nirq);\n\tisapnp_print_pin(\"drq\", ipa->ipa_drq, ipa->ipa_ndrq);\n\treturn UNCONF;\n}"
  },
  {
    "function_name": "isapnp_print_pin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "526-543",
    "snippet": "void\nisapnp_print_pin(str, p, n)\n\tconst char *str;\n\tstruct isapnp_pin *p;\n\tsize_t n;\n{\n\tsize_t i;\n\n\tif (n == 0)\n\t\treturn;\n\n\tprintf(\" %s \", str);\n\tfor (i = 0; i < n; i++, p++) {\n\t\tprintf(\"%d\", p->num);\n\t\tif (i != n - 1)\n\t\t\tprintf(\",\");\n\t}\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_print_pin"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\",\""
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_print_pin;\n\nvoid\nisapnp_print_pin(str, p, n)\n\tconst char *str;\n\tstruct isapnp_pin *p;\n\tsize_t n;\n{\n\tsize_t i;\n\n\tif (n == 0)\n\t\treturn;\n\n\tprintf(\" %s \", str);\n\tfor (i = 0; i < n; i++, p++) {\n\t\tprintf(\"%d\", p->num);\n\t\tif (i != n - 1)\n\t\t\tprintf(\",\");\n\t}\n}"
  },
  {
    "function_name": "isapnp_print_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "501-520",
    "snippet": "void\nisapnp_print_region(str, r, n)\n\tconst char *str;\n\tstruct isapnp_region *r;\n\tsize_t n;\n{\n\tsize_t i;\n\n\tif (n == 0)\n\t\treturn;\n\n\tprintf(\" %s \", str);\n\tfor (i = 0; i < n; i++, r++) {\n\t\tprintf(\"0x%x\", r->base);\n\t\tif (r->length)\n\t\t\tprintf(\"/%d\", r->length);\n\t\tif (i != n - 1)\n\t\t\tprintf(\",\");\n\t}\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_print_region"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\",\""
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_print_region;\n\nvoid\nisapnp_print_region(str, r, n)\n\tconst char *str;\n\tstruct isapnp_region *r;\n\tsize_t n;\n{\n\tsize_t i;\n\n\tif (n == 0)\n\t\treturn;\n\n\tprintf(\" %s \", str);\n\tfor (i = 0; i < n; i++, r++) {\n\t\tprintf(\"0x%x\", r->base);\n\t\tif (r->length)\n\t\t\tprintf(\"/%d\", r->length);\n\t\tif (i != n - 1)\n\t\t\tprintf(\",\");\n\t}\n}"
  },
  {
    "function_name": "isapnp_unconfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "364-387",
    "snippet": "void\nisapnp_unconfig(iot, memt, ipa)\n\tbus_space_tag_t iot, memt;\n\tstruct isa_attach_args *ipa;\n{\n\tint i;\n\n#ifdef notyet\n\tfor (i = 0; i < ipa->ipa_ndrq; i++)\n\t\tisapnp_free_pin(&ipa->ipa_drq[i]);\n\n\tfor (i = 0; i < ipa->ipa_nirq; i++)\n\t\tisapnp_free_pin(&ipa->ipa_irq[i]);\n#endif\n\n\tfor (i = 0; i < ipa->ipa_nmem32; i++)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem32[i]);\n\n\tfor (i = 0; i < ipa->ipa_nmem; i++)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem[i]);\n\n\tfor (i = 0; i < ipa->ipa_nio; i++)\n\t\tisapnp_free_region(iot, &ipa->ipa_io[i]);\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_free_region",
      "struct isa_attach_args **ipa;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_free_region",
          "args": [
            "iot",
            "&ipa->ipa_io[i]"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_free_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "192-202",
          "snippet": "void\nisapnp_free_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tif (r->length == 0)\n\t\treturn;\n\n\tbus_space_unmap(t, r->h, r->length);\n\tr->h = NULL;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_free_region"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_free_region;\n\nvoid\nisapnp_free_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tif (r->length == 0)\n\t\treturn;\n\n\tbus_space_unmap(t, r->h, r->length);\n\tr->h = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_free_pin",
          "args": [
            "&ipa->ipa_irq[i]"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_free_pin",
          "args": [
            "&ipa->ipa_drq[i]"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_free_region;\nstruct isa_attach_args **ipa;\n\nvoid\nisapnp_unconfig(iot, memt, ipa)\n\tbus_space_tag_t iot, memt;\n\tstruct isa_attach_args *ipa;\n{\n\tint i;\n\n#ifdef notyet\n\tfor (i = 0; i < ipa->ipa_ndrq; i++)\n\t\tisapnp_free_pin(&ipa->ipa_drq[i]);\n\n\tfor (i = 0; i < ipa->ipa_nirq; i++)\n\t\tisapnp_free_pin(&ipa->ipa_irq[i]);\n#endif\n\n\tfor (i = 0; i < ipa->ipa_nmem32; i++)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem32[i]);\n\n\tfor (i = 0; i < ipa->ipa_nmem; i++)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem[i]);\n\n\tfor (i = 0; i < ipa->ipa_nio; i++)\n\t\tisapnp_free_region(iot, &ipa->ipa_io[i]);\n}"
  },
  {
    "function_name": "isapnp_config",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "352-358",
    "snippet": "int\nisapnp_config(iot, memt, ipa)\n\tbus_space_tag_t iot, memt;\n\tstruct isa_attach_args *ipa;\n{\n\treturn isapnp_testconfig(iot, memt, ipa, 1);\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int isapnp_testconfig",
      "struct isa_attach_args **ipa;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_testconfig",
          "args": [
            "iot",
            "memt",
            "ipa",
            "1"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_testconfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "281-346",
          "snippet": "int\nisapnp_testconfig(iot, memt, ipa, alloc)\n\tbus_space_tag_t iot, memt;\n\tstruct isa_attach_args *ipa;\n\tint alloc;\n{\n\tint nio = 0, nmem = 0, nmem32 = 0, nirq = 0, ndrq = 0;\n\tint error = 0;\n\n#ifdef DEBUG_ISAPNP\n\tisapnp_print_attach(ipa);\n#endif\n\n\tfor (; nio < ipa->ipa_nio; nio++) {\n\t\terror = isapnp_alloc_region(iot, &ipa->ipa_io[nio]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nmem < ipa->ipa_nmem; nmem++) {\n\t\terror = isapnp_alloc_region(memt, &ipa->ipa_mem[nmem]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nmem32 < ipa->ipa_nmem32; nmem32++) {\n\t\terror = isapnp_alloc_region(memt, &ipa->ipa_mem32[nmem32]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nirq < ipa->ipa_nirq; nirq++) {\n\t\terror = isapnp_alloc_irq(ipa->ia_ic, &ipa->ipa_irq[nirq]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; ndrq < ipa->ipa_ndrq; ndrq++) {\n\t\terror = isapnp_alloc_drq(ipa->ia_isa, &ipa->ipa_drq[ndrq]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tif (alloc)\n\t\treturn error;\n\nbad:\n#ifdef notyet\n\tfor (ndrq--; ndrq >= 0; ndrq--)\n\t\tisapnp_free_pin(&ipa->ipa_drq[ndrq]);\n\n\tfor (nirq--; nirq >= 0; nirq--)\n\t\tisapnp_free_pin(&ipa->ipa_irq[nirq]);\n#endif\n\n\tfor (nmem32--; nmem32 >= 0; nmem32--)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem32[nmem32]);\n\n\tfor (nmem--; nmem >= 0; nmem--)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem[nmem]);\n\n\tfor (nio--; nio >= 0; nio--)\n\t\tisapnp_free_region(iot, &ipa->ipa_io[nio]);\n\n\treturn error;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_free_region",
            "int isapnp_alloc_region",
            "int isapnp_alloc_irq",
            "int isapnp_alloc_drq",
            "int isapnp_testconfig",
            "struct isa_attach_args **ipa;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_free_region;\nint isapnp_alloc_region;\nint isapnp_alloc_irq;\nint isapnp_alloc_drq;\nint isapnp_testconfig;\nstruct isa_attach_args **ipa;\n\nint\nisapnp_testconfig(iot, memt, ipa, alloc)\n\tbus_space_tag_t iot, memt;\n\tstruct isa_attach_args *ipa;\n\tint alloc;\n{\n\tint nio = 0, nmem = 0, nmem32 = 0, nirq = 0, ndrq = 0;\n\tint error = 0;\n\n#ifdef DEBUG_ISAPNP\n\tisapnp_print_attach(ipa);\n#endif\n\n\tfor (; nio < ipa->ipa_nio; nio++) {\n\t\terror = isapnp_alloc_region(iot, &ipa->ipa_io[nio]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nmem < ipa->ipa_nmem; nmem++) {\n\t\terror = isapnp_alloc_region(memt, &ipa->ipa_mem[nmem]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nmem32 < ipa->ipa_nmem32; nmem32++) {\n\t\terror = isapnp_alloc_region(memt, &ipa->ipa_mem32[nmem32]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nirq < ipa->ipa_nirq; nirq++) {\n\t\terror = isapnp_alloc_irq(ipa->ia_ic, &ipa->ipa_irq[nirq]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; ndrq < ipa->ipa_ndrq; ndrq++) {\n\t\terror = isapnp_alloc_drq(ipa->ia_isa, &ipa->ipa_drq[ndrq]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tif (alloc)\n\t\treturn error;\n\nbad:\n#ifdef notyet\n\tfor (ndrq--; ndrq >= 0; ndrq--)\n\t\tisapnp_free_pin(&ipa->ipa_drq[ndrq]);\n\n\tfor (nirq--; nirq >= 0; nirq--)\n\t\tisapnp_free_pin(&ipa->ipa_irq[nirq]);\n#endif\n\n\tfor (nmem32--; nmem32 >= 0; nmem32--)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem32[nmem32]);\n\n\tfor (nmem--; nmem >= 0; nmem--)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem[nmem]);\n\n\tfor (nio--; nio >= 0; nio--)\n\t\tisapnp_free_region(iot, &ipa->ipa_io[nio]);\n\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_testconfig;\nstruct isa_attach_args **ipa;\n\nint\nisapnp_config(iot, memt, ipa)\n\tbus_space_tag_t iot, memt;\n\tstruct isa_attach_args *ipa;\n{\n\treturn isapnp_testconfig(iot, memt, ipa, 1);\n}"
  },
  {
    "function_name": "isapnp_testconfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "281-346",
    "snippet": "int\nisapnp_testconfig(iot, memt, ipa, alloc)\n\tbus_space_tag_t iot, memt;\n\tstruct isa_attach_args *ipa;\n\tint alloc;\n{\n\tint nio = 0, nmem = 0, nmem32 = 0, nirq = 0, ndrq = 0;\n\tint error = 0;\n\n#ifdef DEBUG_ISAPNP\n\tisapnp_print_attach(ipa);\n#endif\n\n\tfor (; nio < ipa->ipa_nio; nio++) {\n\t\terror = isapnp_alloc_region(iot, &ipa->ipa_io[nio]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nmem < ipa->ipa_nmem; nmem++) {\n\t\terror = isapnp_alloc_region(memt, &ipa->ipa_mem[nmem]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nmem32 < ipa->ipa_nmem32; nmem32++) {\n\t\terror = isapnp_alloc_region(memt, &ipa->ipa_mem32[nmem32]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nirq < ipa->ipa_nirq; nirq++) {\n\t\terror = isapnp_alloc_irq(ipa->ia_ic, &ipa->ipa_irq[nirq]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; ndrq < ipa->ipa_ndrq; ndrq++) {\n\t\terror = isapnp_alloc_drq(ipa->ia_isa, &ipa->ipa_drq[ndrq]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tif (alloc)\n\t\treturn error;\n\nbad:\n#ifdef notyet\n\tfor (ndrq--; ndrq >= 0; ndrq--)\n\t\tisapnp_free_pin(&ipa->ipa_drq[ndrq]);\n\n\tfor (nirq--; nirq >= 0; nirq--)\n\t\tisapnp_free_pin(&ipa->ipa_irq[nirq]);\n#endif\n\n\tfor (nmem32--; nmem32 >= 0; nmem32--)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem32[nmem32]);\n\n\tfor (nmem--; nmem >= 0; nmem--)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem[nmem]);\n\n\tfor (nio--; nio >= 0; nio--)\n\t\tisapnp_free_region(iot, &ipa->ipa_io[nio]);\n\n\treturn error;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_free_region",
      "int isapnp_alloc_region",
      "int isapnp_alloc_irq",
      "int isapnp_alloc_drq",
      "int isapnp_testconfig",
      "struct isa_attach_args **ipa;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_free_region",
          "args": [
            "iot",
            "&ipa->ipa_io[nio]"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_free_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "192-202",
          "snippet": "void\nisapnp_free_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tif (r->length == 0)\n\t\treturn;\n\n\tbus_space_unmap(t, r->h, r->length);\n\tr->h = NULL;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void isapnp_free_region"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_free_region;\n\nvoid\nisapnp_free_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tif (r->length == 0)\n\t\treturn;\n\n\tbus_space_unmap(t, r->h, r->length);\n\tr->h = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_free_pin",
          "args": [
            "&ipa->ipa_irq[nirq]"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_free_pin",
          "args": [
            "&ipa->ipa_drq[ndrq]"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isapnp_alloc_drq",
          "args": [
            "ipa->ia_isa",
            "&ipa->ipa_drq[ndrq]"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_alloc_drq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "257-276",
          "snippet": "int\nisapnp_alloc_drq(isa, i)\n\tstruct device *isa;\n\tstruct isapnp_pin *i;\n{\n\tint b;\n\n\tif (i->bits == 0) {\n\t\ti->num = 0;\n\t\treturn 0;\n\t}\n\n\tfor (b = 0; b < 16; b++)\n\t\tif ((i->bits & (1 << b)) && isa_drq_isfree(isa, b)) {\n\t\t\ti->num = b;\n\t\t\treturn 0;\n\t\t}\n\n\treturn EINVAL;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int isapnp_alloc_drq",
            "struct isa_attach_args *\nisapnp_bestconfig(isa, sc, ipa)\n\tstruct device *isa;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_alloc_drq;\nstruct isa_attach_args *\nisapnp_bestconfig(isa, sc, ipa)\n\tstruct device *isa;\n\nint\nisapnp_alloc_drq(isa, i)\n\tstruct device *isa;\n\tstruct isapnp_pin *i;\n{\n\tint b;\n\n\tif (i->bits == 0) {\n\t\ti->num = 0;\n\t\treturn 0;\n\t}\n\n\tfor (b = 0; b < 16; b++)\n\t\tif ((i->bits & (1 << b)) && isa_drq_isfree(isa, b)) {\n\t\t\ti->num = b;\n\t\t\treturn 0;\n\t\t}\n\n\treturn EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_alloc_irq",
          "args": [
            "ipa->ia_ic",
            "&ipa->ipa_irq[nirq]"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_alloc_irq",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "232-252",
          "snippet": "int\nisapnp_alloc_irq(ic, i)\n\tisa_chipset_tag_t ic;\n\tstruct isapnp_pin *i;\n{\n\tint irq;\n#define LEVEL_IRQ (ISAPNP_IRQTYPE_LEVEL_PLUS|ISAPNP_IRQTYPE_LEVEL_MINUS)\n\ti->type = (i->flags & LEVEL_IRQ) ? IST_LEVEL : IST_EDGE;\n\n\tif (i->bits == 0) {\n\t\ti->num = 0;\n\t\treturn 0;\n\t}\n\n\tif (isa_intr_alloc(ic, i->bits, i->type, &irq) == 0) {\n\t\ti->num = irq;\n\t\treturn 0;\n\t}\n\n\treturn EINVAL;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [
            "#define LEVEL_IRQ (ISAPNP_IRQTYPE_LEVEL_PLUS|ISAPNP_IRQTYPE_LEVEL_MINUS)"
          ],
          "globals_used": [
            "int isapnp_alloc_irq"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define LEVEL_IRQ (ISAPNP_IRQTYPE_LEVEL_PLUS|ISAPNP_IRQTYPE_LEVEL_MINUS)\n\nint isapnp_alloc_irq;\n\nint\nisapnp_alloc_irq(ic, i)\n\tisa_chipset_tag_t ic;\n\tstruct isapnp_pin *i;\n{\n\tint irq;\n#define LEVEL_IRQ (ISAPNP_IRQTYPE_LEVEL_PLUS|ISAPNP_IRQTYPE_LEVEL_MINUS)\n\ti->type = (i->flags & LEVEL_IRQ) ? IST_LEVEL : IST_EDGE;\n\n\tif (i->bits == 0) {\n\t\ti->num = 0;\n\t\treturn 0;\n\t}\n\n\tif (isa_intr_alloc(ic, i->bits, i->type, &irq) == 0) {\n\t\ti->num = irq;\n\t\treturn 0;\n\t}\n\n\treturn EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_alloc_region",
          "args": [
            "memt",
            "&ipa->ipa_mem32[nmem32]"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_alloc_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "208-226",
          "snippet": "int\nisapnp_alloc_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tint error = 0;\n\n\tif (r->length == 0)\n\t\treturn 0;\n\n\tr->h = NULL;\n\tfor (r->base = r->minbase; r->base <= r->maxbase;\n\t     r->base += r->align) {\n\t\terror = bus_space_map(t, r->base, r->length, 0, &r->h);\n\t\tif (error == 0)\n\t\t\treturn 0;\n\t}\n\treturn error;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int isapnp_alloc_region"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_alloc_region;\n\nint\nisapnp_alloc_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tint error = 0;\n\n\tif (r->length == 0)\n\t\treturn 0;\n\n\tr->h = NULL;\n\tfor (r->base = r->minbase; r->base <= r->maxbase;\n\t     r->base += r->align) {\n\t\terror = bus_space_map(t, r->base, r->length, 0, &r->h);\n\t\tif (error == 0)\n\t\t\treturn 0;\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_print_attach",
          "args": [
            "ipa"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_print_attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnpdebug.c",
          "lines": "218-242",
          "snippet": "void\nisapnp_print_attach(pa)\n\tconst struct isa_attach_args *pa;\n{\n\tint i;\n\n\tprintf(\"Found <%s, %s, %s, %s> \", pa->ipa_devident,\n\t    pa->ipa_devlogic, pa->ipa_devcompat, pa->ipa_devclass);\n\tisapnp_print_dep_start(\"\", pa->ipa_pref);\n\n\tfor (i = 0; i < pa->ipa_nio; i++)\n\t\tisapnp_print_io(\"\", &pa->ipa_io[i]);\n\n\tfor (i = 0; i < pa->ipa_nmem; i++)\n\t\tisapnp_print_mem(\"\", &pa->ipa_mem[i]);\n\n\tfor (i = 0; i < pa->ipa_nirq; i++)\n\t\tisapnp_print_irq(\"\", &pa->ipa_irq[i]);\n\n\tfor (i = 0; i < pa->ipa_ndrq; i++)\n\t\tisapnp_print_drq(\"\", &pa->ipa_drq[i]);\n\n\tfor (i = 0; i < pa->ipa_nmem32; i++)\n\t\tisapnp_print_mem(\"\", &pa->ipa_mem32[i]);\n}",
          "includes": [
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid\nisapnp_print_attach(pa)\n\tconst struct isa_attach_args *pa;\n{\n\tint i;\n\n\tprintf(\"Found <%s, %s, %s, %s> \", pa->ipa_devident,\n\t    pa->ipa_devlogic, pa->ipa_devcompat, pa->ipa_devclass);\n\tisapnp_print_dep_start(\"\", pa->ipa_pref);\n\n\tfor (i = 0; i < pa->ipa_nio; i++)\n\t\tisapnp_print_io(\"\", &pa->ipa_io[i]);\n\n\tfor (i = 0; i < pa->ipa_nmem; i++)\n\t\tisapnp_print_mem(\"\", &pa->ipa_mem[i]);\n\n\tfor (i = 0; i < pa->ipa_nirq; i++)\n\t\tisapnp_print_irq(\"\", &pa->ipa_irq[i]);\n\n\tfor (i = 0; i < pa->ipa_ndrq; i++)\n\t\tisapnp_print_drq(\"\", &pa->ipa_drq[i]);\n\n\tfor (i = 0; i < pa->ipa_nmem32; i++)\n\t\tisapnp_print_mem(\"\", &pa->ipa_mem32[i]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_free_region;\nint isapnp_alloc_region;\nint isapnp_alloc_irq;\nint isapnp_alloc_drq;\nint isapnp_testconfig;\nstruct isa_attach_args **ipa;\n\nint\nisapnp_testconfig(iot, memt, ipa, alloc)\n\tbus_space_tag_t iot, memt;\n\tstruct isa_attach_args *ipa;\n\tint alloc;\n{\n\tint nio = 0, nmem = 0, nmem32 = 0, nirq = 0, ndrq = 0;\n\tint error = 0;\n\n#ifdef DEBUG_ISAPNP\n\tisapnp_print_attach(ipa);\n#endif\n\n\tfor (; nio < ipa->ipa_nio; nio++) {\n\t\terror = isapnp_alloc_region(iot, &ipa->ipa_io[nio]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nmem < ipa->ipa_nmem; nmem++) {\n\t\terror = isapnp_alloc_region(memt, &ipa->ipa_mem[nmem]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nmem32 < ipa->ipa_nmem32; nmem32++) {\n\t\terror = isapnp_alloc_region(memt, &ipa->ipa_mem32[nmem32]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; nirq < ipa->ipa_nirq; nirq++) {\n\t\terror = isapnp_alloc_irq(ipa->ia_ic, &ipa->ipa_irq[nirq]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tfor (; ndrq < ipa->ipa_ndrq; ndrq++) {\n\t\terror = isapnp_alloc_drq(ipa->ia_isa, &ipa->ipa_drq[ndrq]);\n\t\tif (error)\n\t\t\tgoto bad;\n\t}\n\n\tif (alloc)\n\t\treturn error;\n\nbad:\n#ifdef notyet\n\tfor (ndrq--; ndrq >= 0; ndrq--)\n\t\tisapnp_free_pin(&ipa->ipa_drq[ndrq]);\n\n\tfor (nirq--; nirq >= 0; nirq--)\n\t\tisapnp_free_pin(&ipa->ipa_irq[nirq]);\n#endif\n\n\tfor (nmem32--; nmem32 >= 0; nmem32--)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem32[nmem32]);\n\n\tfor (nmem--; nmem >= 0; nmem--)\n\t\tisapnp_free_region(memt, &ipa->ipa_mem[nmem]);\n\n\tfor (nio--; nio >= 0; nio--)\n\t\tisapnp_free_region(iot, &ipa->ipa_io[nio]);\n\n\treturn error;\n}"
  },
  {
    "function_name": "isapnp_alloc_drq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "257-276",
    "snippet": "int\nisapnp_alloc_drq(isa, i)\n\tstruct device *isa;\n\tstruct isapnp_pin *i;\n{\n\tint b;\n\n\tif (i->bits == 0) {\n\t\ti->num = 0;\n\t\treturn 0;\n\t}\n\n\tfor (b = 0; b < 16; b++)\n\t\tif ((i->bits & (1 << b)) && isa_drq_isfree(isa, b)) {\n\t\t\ti->num = b;\n\t\t\treturn 0;\n\t\t}\n\n\treturn EINVAL;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int isapnp_alloc_drq",
      "struct isa_attach_args *\nisapnp_bestconfig(isa, sc, ipa)\n\tstruct device *isa;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isa_drq_isfree",
          "args": [
            "isa",
            "b"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "isa_drq_isfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isadma.c",
          "lines": "658-669",
          "snippet": "int\nisa_drq_isfree(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_drq_isfree: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\treturn ISA_DRQ_ISFREE(sc, chan);\n}",
          "includes": [
            "#include <sys/malloc.h>",
            "#include <dev/isa/isadmareg.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isareg.h>",
            "#include <machine/bus.h>",
            "#include <vm/vm.h>",
            "#include <sys/device.h>",
            "#include <sys/proc.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;",
            "int chan;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/malloc.h>\n#include <dev/isa/isadmareg.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isareg.h>\n#include <machine/bus.h>\n#include <vm/vm.h>\n#include <sys/device.h>\n#include <sys/proc.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid *\nisa_malloc(isadev, chan, size, pool, flags)\n\tstruct device *isadev;\nint chan;\n\nint\nisa_drq_isfree(isadev, chan)\n\tstruct device *isadev;\n\tint chan;\n{\n\tstruct isa_softc *sc = (struct isa_softc *)isadev;\n\tif (chan < 0 || chan > 7) {\n\t\tpanic(\"isa_drq_isfree: %s: bogus drq %d\", sc->sc_dev.dv_xname,\n\t\t    chan);\n\t}\n\treturn ISA_DRQ_ISFREE(sc, chan);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_alloc_drq;\nstruct isa_attach_args *\nisapnp_bestconfig(isa, sc, ipa)\n\tstruct device *isa;\n\nint\nisapnp_alloc_drq(isa, i)\n\tstruct device *isa;\n\tstruct isapnp_pin *i;\n{\n\tint b;\n\n\tif (i->bits == 0) {\n\t\ti->num = 0;\n\t\treturn 0;\n\t}\n\n\tfor (b = 0; b < 16; b++)\n\t\tif ((i->bits & (1 << b)) && isa_drq_isfree(isa, b)) {\n\t\t\ti->num = b;\n\t\t\treturn 0;\n\t\t}\n\n\treturn EINVAL;\n}"
  },
  {
    "function_name": "isapnp_alloc_irq",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "232-252",
    "snippet": "int\nisapnp_alloc_irq(ic, i)\n\tisa_chipset_tag_t ic;\n\tstruct isapnp_pin *i;\n{\n\tint irq;\n#define LEVEL_IRQ (ISAPNP_IRQTYPE_LEVEL_PLUS|ISAPNP_IRQTYPE_LEVEL_MINUS)\n\ti->type = (i->flags & LEVEL_IRQ) ? IST_LEVEL : IST_EDGE;\n\n\tif (i->bits == 0) {\n\t\ti->num = 0;\n\t\treturn 0;\n\t}\n\n\tif (isa_intr_alloc(ic, i->bits, i->type, &irq) == 0) {\n\t\ti->num = irq;\n\t\treturn 0;\n\t}\n\n\treturn EINVAL;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [
      "#define LEVEL_IRQ (ISAPNP_IRQTYPE_LEVEL_PLUS|ISAPNP_IRQTYPE_LEVEL_MINUS)"
    ],
    "globals_used": [
      "int isapnp_alloc_irq"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isa_intr_alloc",
          "args": [
            "ic",
            "i->bits",
            "i->type",
            "&irq"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\n#define LEVEL_IRQ (ISAPNP_IRQTYPE_LEVEL_PLUS|ISAPNP_IRQTYPE_LEVEL_MINUS)\n\nint isapnp_alloc_irq;\n\nint\nisapnp_alloc_irq(ic, i)\n\tisa_chipset_tag_t ic;\n\tstruct isapnp_pin *i;\n{\n\tint irq;\n#define LEVEL_IRQ (ISAPNP_IRQTYPE_LEVEL_PLUS|ISAPNP_IRQTYPE_LEVEL_MINUS)\n\ti->type = (i->flags & LEVEL_IRQ) ? IST_LEVEL : IST_EDGE;\n\n\tif (i->bits == 0) {\n\t\ti->num = 0;\n\t\treturn 0;\n\t}\n\n\tif (isa_intr_alloc(ic, i->bits, i->type, &irq) == 0) {\n\t\ti->num = irq;\n\t\treturn 0;\n\t}\n\n\treturn EINVAL;\n}"
  },
  {
    "function_name": "isapnp_alloc_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "208-226",
    "snippet": "int\nisapnp_alloc_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tint error = 0;\n\n\tif (r->length == 0)\n\t\treturn 0;\n\n\tr->h = NULL;\n\tfor (r->base = r->minbase; r->base <= r->maxbase;\n\t     r->base += r->align) {\n\t\terror = bus_space_map(t, r->base, r->length, 0, &r->h);\n\t\tif (error == 0)\n\t\t\treturn 0;\n\t}\n\treturn error;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int isapnp_alloc_region"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_map",
          "args": [
            "t",
            "r->base",
            "r->length",
            "0",
            "&r->h"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nint isapnp_alloc_region;\n\nint\nisapnp_alloc_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tint error = 0;\n\n\tif (r->length == 0)\n\t\treturn 0;\n\n\tr->h = NULL;\n\tfor (r->base = r->minbase; r->base <= r->maxbase;\n\t     r->base += r->align) {\n\t\terror = bus_space_map(t, r->base, r->length, 0, &r->h);\n\t\tif (error == 0)\n\t\t\treturn 0;\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "isapnp_free_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "192-202",
    "snippet": "void\nisapnp_free_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tif (r->length == 0)\n\t\treturn;\n\n\tbus_space_unmap(t, r->h, r->length);\n\tr->h = NULL;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_free_region"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bus_space_unmap",
          "args": [
            "t",
            "r->h",
            "r->length"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_free_region;\n\nvoid\nisapnp_free_region(t, r)\n\tbus_space_tag_t t;\n\tstruct isapnp_region *r;\n{\n\tif (r->length == 0)\n\t\treturn;\n\n\tbus_space_unmap(t, r->h, r->length);\n\tr->h = NULL;\n}"
  },
  {
    "function_name": "isapnp_findcard",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "137-186",
    "snippet": "int\nisapnp_findcard(sc)\n\tstruct isapnp_softc *sc;\n{\n\tu_char v = ISAPNP_LFSR_INIT, csum, w;\n\tint i, b;\n\n\tif (sc->sc_ncards == ISAPNP_MAX_CARDS) {\n\t\tprintf(\"%s: Too many pnp cards\\n\", sc->sc_dev.dv_xname);\n\t\treturn 0;\n\t}\n\n\t/* Set the read port */\n\tisapnp_write_reg(sc, ISAPNP_WAKE, 0);\n\tisapnp_write_reg(sc, ISAPNP_SET_RD_PORT, sc->sc_read_port >> 2);\n\tsc->sc_read_port |= 3;\n\tDELAY(1000);\n\n\tISAPNP_WRITE_ADDR(sc, ISAPNP_SERIAL_ISOLATION);\n\tDELAY(1000);\n\n\t/* Read the 8 bytes of the Vendor ID and Serial Number */\n\tfor(i = 0; i < 8; i++) {\n\t\t/* Read each bit separately */\n\t\tfor (w = 0, b = 0; b < 8; b++) {\n\t\t\tu_char neg = isapnp_shift_bit(sc);\n\n\t\t\tw >>= 1;\n\t\t\tw |= neg;\n\t\t\tv = ISAPNP_LFSR_NEXT(v) ^ neg;\n\t\t}\n\t\tsc->sc_id[sc->sc_ncards][i] = w;\n\t}\n\n\t/* Read the remaining checksum byte */\n\tfor (csum = 0, b = 0; b < 8; b++) {\n\t\tu_char neg = isapnp_shift_bit(sc);\n\n\t\tcsum >>= 1;\n\t\tcsum |= neg;\n\t}\n\tsc->sc_id[sc->sc_ncards][8] = csum;\n\n\tif (csum == v) {\n\t\tsc->sc_ncards++;\n\t\tisapnp_write_reg(sc, ISAPNP_CARD_SELECT_NUM, sc->sc_ncards);\n\t\treturn 1;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline u_char isapnp_shift_bit",
      "int isapnp_findcard",
      "struct isapnp_softc *sc;",
      "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "isapnp_write_reg",
          "args": [
            "sc",
            "ISAPNP_CARD_SELECT_NUM",
            "sc->sc_ncards"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_write_reg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isavar.h",
          "lines": "423-431",
          "snippet": "static __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}",
          "includes": [
            "#include <alpha/isa/isapnp_machdep.h>",
            "#include <i386/isa/isapnp_machdep.h>",
            "#include \"isapnp.h\"",
            "#include <hppa/isa/isa_machdep.h>",
            "#include <powerpc/isa/isa_machdep.h>",
            "#include <wgrisc/isa/isa_machdep.h>",
            "#include <arc/isa/isa_machdep.h>",
            "#include <i386/isa/isa_machdep.h>",
            "#include <amiga/isa/isa_machdep.h>",
            "#include <alpha/isa/isa_machdep.h>",
            "#include \"isadma.h\"",
            "#include <machine/bus.h>",
            "#include <sys/queue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <alpha/isa/isapnp_machdep.h>\n#include <i386/isa/isapnp_machdep.h>\n#include \"isapnp.h\"\n#include <hppa/isa/isa_machdep.h>\n#include <powerpc/isa/isa_machdep.h>\n#include <wgrisc/isa/isa_machdep.h>\n#include <arc/isa/isa_machdep.h>\n#include <i386/isa/isa_machdep.h>\n#include <amiga/isa/isa_machdep.h>\n#include <alpha/isa/isa_machdep.h>\n#include \"isadma.h\"\n#include <machine/bus.h>\n#include <sys/queue.h>\n\nstatic __inline void\nisapnp_write_reg(sc, r, v)\n\tstruct isapnp_softc *sc;\n\tint r;\n\tu_char v;\n{\n\tISAPNP_WRITE_ADDR(sc, r);\n\tISAPNP_WRITE_DATA(sc, v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "isapnp_shift_bit",
          "args": [
            "sc"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "isapnp_shift_bit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
          "lines": "114-129",
          "snippet": "static __inline u_char\nisapnp_shift_bit(sc)\n\tstruct isapnp_softc *sc;\n{\n\tu_char c1, c2;\n\n\tDELAY(250);\n\tc1 = ISAPNP_READ_DATA(sc);\n\tDELAY(250);\n\tc2 = ISAPNP_READ_DATA(sc);\n\n\tif (c1 == 0x55 && c2 == 0xAA)\n\t\treturn 0x80;\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include <dev/isa/pnpdevs.h>",
            "#include <dev/isa/isadmavar.h>",
            "#include <dev/isa/isavar.h>",
            "#include <dev/isa/isapnpreg.h>",
            "#include <machine/bus.h>",
            "#include <sys/malloc.h>",
            "#include <sys/device.h>",
            "#include <sys/systm.h>",
            "#include <sys/param.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __inline u_char isapnp_shift_bit",
            "struct isapnp_softc *sc;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline u_char isapnp_shift_bit;\nstruct isapnp_softc *sc;\n\nstatic __inline u_char\nisapnp_shift_bit(sc)\n\tstruct isapnp_softc *sc;\n{\n\tu_char c1, c2;\n\n\tDELAY(250);\n\tc1 = ISAPNP_READ_DATA(sc);\n\tDELAY(250);\n\tc2 = ISAPNP_READ_DATA(sc);\n\n\tif (c1 == 0x55 && c2 == 0xAA)\n\t\treturn 0x80;\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ISAPNP_LFSR_NEXT",
          "args": [
            "v"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1000"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISAPNP_WRITE_ADDR",
          "args": [
            "sc",
            "ISAPNP_SERIAL_ISOLATION"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "1000"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s: Too many pnp cards\\n\"",
            "sc->sc_dev.dv_xname"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "rf_debug_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/raidframe/rf_debugprint.c",
          "lines": "82-108",
          "snippet": "void \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}",
          "includes": [
            "#include <sys/param.h>",
            "#include \"rf_options.h\"",
            "#include \"rf_general.h\"",
            "#include \"rf_debugprint.h\"",
            "#include \"rf_threadstuff.h\"",
            "#include \"rf_types.h\""
          ],
          "macros_used": [
            "#define BUFMASK  (BUFSIZE-1)"
          ],
          "globals_used": [
            "static struct RF_Entry_s rf_debugprint_buf[BUFSIZE];",
            "static int rf_debugprint_index = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/param.h>\n#include \"rf_options.h\"\n#include \"rf_general.h\"\n#include \"rf_debugprint.h\"\n#include \"rf_threadstuff.h\"\n#include \"rf_types.h\"\n\n#define BUFMASK  (BUFSIZE-1)\n\nstatic struct RF_Entry_s rf_debugprint_buf[BUFSIZE];\nstatic int rf_debugprint_index = 0;\n\nvoid \nrf_debug_printf(s, a1, a2, a3, a4, a5, a6, a7, a8)\n\tchar   *s;\n\tvoid   *a1, *a2, *a3, *a4, *a5, *a6, *a7, *a8;\n{\n\tint     idx;\n\n\tif (rf_debugPrintUseBuffer) {\n\n\t\tRF_LOCK_MUTEX(rf_debug_print_mutex);\n\t\tidx = rf_debugprint_index;\n\t\trf_debugprint_index = (rf_debugprint_index + 1) & BUFMASK;\n\t\tRF_UNLOCK_MUTEX(rf_debug_print_mutex);\n\n\t\trf_debugprint_buf[idx].cstring = s;\n\t\trf_debugprint_buf[idx].a1 = a1;\n\t\trf_debugprint_buf[idx].a2 = a2;\n\t\trf_debugprint_buf[idx].a3 = a3;\n\t\trf_debugprint_buf[idx].a4 = a4;\n\t\trf_debugprint_buf[idx].a5 = a5;\n\t\trf_debugprint_buf[idx].a6 = a6;\n\t\trf_debugprint_buf[idx].a7 = a7;\n\t\trf_debugprint_buf[idx].a8 = a8;\n\t} else {\n\t\tprintf(s, a1, a2, a3, a4, a5, a6, a7, a8);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline u_char isapnp_shift_bit;\nint isapnp_findcard;\nstruct isapnp_softc *sc;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nint\nisapnp_findcard(sc)\n\tstruct isapnp_softc *sc;\n{\n\tu_char v = ISAPNP_LFSR_INIT, csum, w;\n\tint i, b;\n\n\tif (sc->sc_ncards == ISAPNP_MAX_CARDS) {\n\t\tprintf(\"%s: Too many pnp cards\\n\", sc->sc_dev.dv_xname);\n\t\treturn 0;\n\t}\n\n\t/* Set the read port */\n\tisapnp_write_reg(sc, ISAPNP_WAKE, 0);\n\tisapnp_write_reg(sc, ISAPNP_SET_RD_PORT, sc->sc_read_port >> 2);\n\tsc->sc_read_port |= 3;\n\tDELAY(1000);\n\n\tISAPNP_WRITE_ADDR(sc, ISAPNP_SERIAL_ISOLATION);\n\tDELAY(1000);\n\n\t/* Read the 8 bytes of the Vendor ID and Serial Number */\n\tfor(i = 0; i < 8; i++) {\n\t\t/* Read each bit separately */\n\t\tfor (w = 0, b = 0; b < 8; b++) {\n\t\t\tu_char neg = isapnp_shift_bit(sc);\n\n\t\t\tw >>= 1;\n\t\t\tw |= neg;\n\t\t\tv = ISAPNP_LFSR_NEXT(v) ^ neg;\n\t\t}\n\t\tsc->sc_id[sc->sc_ncards][i] = w;\n\t}\n\n\t/* Read the remaining checksum byte */\n\tfor (csum = 0, b = 0; b < 8; b++) {\n\t\tu_char neg = isapnp_shift_bit(sc);\n\n\t\tcsum >>= 1;\n\t\tcsum |= neg;\n\t}\n\tsc->sc_id[sc->sc_ncards][8] = csum;\n\n\tif (csum == v) {\n\t\tsc->sc_ncards++;\n\t\tisapnp_write_reg(sc, ISAPNP_CARD_SELECT_NUM, sc->sc_ncards);\n\t\treturn 1;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "isapnp_shift_bit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "114-129",
    "snippet": "static __inline u_char\nisapnp_shift_bit(sc)\n\tstruct isapnp_softc *sc;\n{\n\tu_char c1, c2;\n\n\tDELAY(250);\n\tc1 = ISAPNP_READ_DATA(sc);\n\tDELAY(250);\n\tc2 = ISAPNP_READ_DATA(sc);\n\n\tif (c1 == 0x55 && c2 == 0xAA)\n\t\treturn 0x80;\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __inline u_char isapnp_shift_bit",
      "struct isapnp_softc *sc;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ISAPNP_READ_DATA",
          "args": [
            "sc"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "250"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISAPNP_READ_DATA",
          "args": [
            "sc"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DELAY",
          "args": [
            "250"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nstatic __inline u_char isapnp_shift_bit;\nstruct isapnp_softc *sc;\n\nstatic __inline u_char\nisapnp_shift_bit(sc)\n\tstruct isapnp_softc *sc;\n{\n\tu_char c1, c2;\n\n\tDELAY(250);\n\tc1 = ISAPNP_READ_DATA(sc);\n\tDELAY(250);\n\tc2 = ISAPNP_READ_DATA(sc);\n\n\tif (c1 == 0x55 && c2 == 0xAA)\n\t\treturn 0x80;\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "isapnp_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c_ICV/CVE-2023-40216/repo/sys/dev/isa/isapnp.c",
    "lines": "92-108",
    "snippet": "void\nisapnp_init(sc)\n\tstruct isapnp_softc *sc;\n{\n\tint i;\n\tu_char v = ISAPNP_LFSR_INIT;\n\n\t/* First write 0's twice to enter the Wait for Key state */\n\tISAPNP_WRITE_ADDR(sc, 0);\n\tISAPNP_WRITE_ADDR(sc, 0);\n\n\t/* Send the 32 byte sequence to awake the logic */\n\tfor (i = 0; i < ISAPNP_LFSR_LENGTH; i++) {\n\t\tISAPNP_WRITE_ADDR(sc, v);\n\t\tv = ISAPNP_LFSR_NEXT(v);\n\t}\n}",
    "includes": [
      "#include <dev/isa/pnpdevs.h>",
      "#include <dev/isa/isadmavar.h>",
      "#include <dev/isa/isavar.h>",
      "#include <dev/isa/isapnpreg.h>",
      "#include <machine/bus.h>",
      "#include <sys/malloc.h>",
      "#include <sys/device.h>",
      "#include <sys/systm.h>",
      "#include <sys/param.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "void isapnp_init",
      "struct isapnp_softc *sc;",
      "char *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ISAPNP_LFSR_NEXT",
          "args": [
            "v"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISAPNP_WRITE_ADDR",
          "args": [
            "sc",
            "v"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISAPNP_WRITE_ADDR",
          "args": [
            "sc",
            "0"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ISAPNP_WRITE_ADDR",
          "args": [
            "sc",
            "0"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dev/isa/pnpdevs.h>\n#include <dev/isa/isadmavar.h>\n#include <dev/isa/isavar.h>\n#include <dev/isa/isapnpreg.h>\n#include <machine/bus.h>\n#include <sys/malloc.h>\n#include <sys/device.h>\n#include <sys/systm.h>\n#include <sys/param.h>\n\nvoid isapnp_init;\nstruct isapnp_softc *sc;\nchar *\nisapnp_id_to_vendor(v, id)\n\tchar   *v;\n\nvoid\nisapnp_init(sc)\n\tstruct isapnp_softc *sc;\n{\n\tint i;\n\tu_char v = ISAPNP_LFSR_INIT;\n\n\t/* First write 0's twice to enter the Wait for Key state */\n\tISAPNP_WRITE_ADDR(sc, 0);\n\tISAPNP_WRITE_ADDR(sc, 0);\n\n\t/* Send the 32 byte sequence to awake the logic */\n\tfor (i = 0; i < ISAPNP_LFSR_LENGTH; i++) {\n\t\tISAPNP_WRITE_ADDR(sc, v);\n\t\tv = ISAPNP_LFSR_NEXT(v);\n\t}\n}"
  }
]