[
  {
    "function_name": "chrdev_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "667-670",
    "snippet": "void __init chrdev_init(void)\n{\n\tcdev_map = kobj_map_init(base_probe, &chrdevs_lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_map *cdev_map;",
      "static DEFINE_MUTEX(chrdevs_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobj_map_init",
          "args": [
            "base_probe",
            "&chrdevs_lock"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nvoid __init chrdev_init(void)\n{\n\tcdev_map = kobj_map_init(base_probe, &chrdevs_lock);\n}"
  },
  {
    "function_name": "base_probe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "659-665",
    "snippet": "static struct kobject *base_probe(dev_t dev, int *part, void *data)\n{\n\tif (request_module(\"char-major-%d-%d\", MAJOR(dev), MINOR(dev)) > 0)\n\t\t/* Make old-style 2.4 aliases work */\n\t\trequest_module(\"char-major-%d\", MAJOR(dev));\n\treturn NULL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "\"char-major-%d\"",
            "MAJOR(dev)"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "dev"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "\"char-major-%d-%d\"",
            "MAJOR(dev)",
            "MINOR(dev)"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "dev"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "dev"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *base_probe(dev_t dev, int *part, void *data)\n{\n\tif (request_module(\"char-major-%d-%d\", MAJOR(dev), MINOR(dev)) > 0)\n\t\t/* Make old-style 2.4 aliases work */\n\t\trequest_module(\"char-major-%d\", MAJOR(dev));\n\treturn NULL;\n}"
  },
  {
    "function_name": "cdev_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "651-657",
    "snippet": "void cdev_init(struct cdev *cdev, const struct file_operations *fops)\n{\n\tmemset(cdev, 0, sizeof *cdev);\n\tINIT_LIST_HEAD(&cdev->list);\n\tkobject_init(&cdev->kobj, &ktype_cdev_default);\n\tcdev->ops = fops;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_type ktype_cdev_default = {\n\t.release\t= cdev_default_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_init",
          "args": [
            "&cdev->kobj",
            "&ktype_cdev_default"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&cdev->list"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "cdev",
            "0",
            "sizeof *cdev"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_type ktype_cdev_default = {\n\t.release\t= cdev_default_release,\n};\n\nvoid cdev_init(struct cdev *cdev, const struct file_operations *fops)\n{\n\tmemset(cdev, 0, sizeof *cdev);\n\tINIT_LIST_HEAD(&cdev->list);\n\tkobject_init(&cdev->kobj, &ktype_cdev_default);\n\tcdev->ops = fops;\n}"
  },
  {
    "function_name": "cdev_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "633-641",
    "snippet": "struct cdev *cdev_alloc(void)\n{\n\tstruct cdev *p = kzalloc(sizeof(struct cdev), GFP_KERNEL);\n\tif (p) {\n\t\tINIT_LIST_HEAD(&p->list);\n\t\tkobject_init(&p->kobj, &ktype_cdev_dynamic);\n\t}\n\treturn p;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_type ktype_cdev_dynamic = {\n\t.release\t= cdev_dynamic_release,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_init",
          "args": [
            "&p->kobj",
            "&ktype_cdev_dynamic"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&p->list"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct cdev)",
            "GFP_KERNEL"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_type ktype_cdev_dynamic = {\n\t.release\t= cdev_dynamic_release,\n};\n\nstruct cdev *cdev_alloc(void)\n{\n\tstruct cdev *p = kzalloc(sizeof(struct cdev), GFP_KERNEL);\n\tif (p) {\n\t\tINIT_LIST_HEAD(&p->list);\n\t\tkobject_init(&p->kobj, &ktype_cdev_dynamic);\n\t}\n\treturn p;\n}"
  },
  {
    "function_name": "cdev_dynamic_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "610-618",
    "snippet": "static void cdev_dynamic_release(struct kobject *kobj)\n{\n\tstruct cdev *p = container_of(kobj, struct cdev, kobj);\n\tstruct kobject *parent = kobj->parent;\n\n\tcdev_purge(p);\n\tkfree(p);\n\tkobject_put(parent);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "parent"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "p"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cdev_purge",
          "args": [
            "p"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_purge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "438-448",
          "snippet": "static void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cdev_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nstatic void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structcdev",
            "kobj"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic void cdev_dynamic_release(struct kobject *kobj)\n{\n\tstruct cdev *p = container_of(kobj, struct cdev, kobj);\n\tstruct kobject *parent = kobj->parent;\n\n\tcdev_purge(p);\n\tkfree(p);\n\tkobject_put(parent);\n}"
  },
  {
    "function_name": "cdev_default_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "601-608",
    "snippet": "static void cdev_default_release(struct kobject *kobj)\n{\n\tstruct cdev *p = container_of(kobj, struct cdev, kobj);\n\tstruct kobject *parent = kobj->parent;\n\n\tcdev_purge(p);\n\tkobject_put(parent);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "parent"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_purge",
          "args": [
            "p"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_purge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "438-448",
          "snippet": "static void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cdev_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nstatic void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structcdev",
            "kobj"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic void cdev_default_release(struct kobject *kobj)\n{\n\tstruct cdev *p = container_of(kobj, struct cdev, kobj);\n\tstruct kobject *parent = kobj->parent;\n\n\tcdev_purge(p);\n\tkobject_put(parent);\n}"
  },
  {
    "function_name": "cdev_del",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "594-598",
    "snippet": "void cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&p->kobj"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_unmap",
          "args": [
            "p->dev",
            "p->count"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_unmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "578-581",
          "snippet": "static void cdev_unmap(dev_t dev, unsigned count)\n{\n\tkobj_unmap(cdev_map, dev, count);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_map *cdev_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nstatic void cdev_unmap(dev_t dev, unsigned count)\n{\n\tkobj_unmap(cdev_map, dev, count);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}"
  },
  {
    "function_name": "cdev_unmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "578-581",
    "snippet": "static void cdev_unmap(dev_t dev, unsigned count)\n{\n\tkobj_unmap(cdev_map, dev, count);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_map *cdev_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobj_unmap",
          "args": [
            "cdev_map",
            "dev",
            "count"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nstatic void cdev_unmap(dev_t dev, unsigned count)\n{\n\tkobj_unmap(cdev_map, dev, count);\n}"
  },
  {
    "function_name": "cdev_device_del",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "571-576",
    "snippet": "void cdev_device_del(struct cdev *cdev, struct device *dev)\n{\n\tdevice_del(dev);\n\tif (dev->devt)\n\t\tcdev_del(cdev);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cdev_del",
          "args": [
            "cdev"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "594-598",
          "snippet": "void cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_del",
          "args": [
            "dev"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_device_del(struct cdev *cdev, struct device *dev)\n{\n\tdevice_del(dev);\n\tif (dev->devt)\n\t\tcdev_del(cdev);\n}"
  },
  {
    "function_name": "cdev_device_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "537-554",
    "snippet": "int cdev_device_add(struct cdev *cdev, struct device *dev)\n{\n\tint rc = 0;\n\n\tif (dev->devt) {\n\t\tcdev_set_parent(cdev, &dev->kobj);\n\n\t\trc = cdev_add(cdev, dev->devt, 1);\n\t\tif (rc)\n\t\t\treturn rc;\n\t}\n\n\trc = device_add(dev);\n\tif (rc)\n\t\tcdev_del(cdev);\n\n\treturn rc;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cdev_del",
          "args": [
            "cdev"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "594-598",
          "snippet": "void cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "device_add",
          "args": [
            "dev"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_add",
          "args": [
            "cdev",
            "dev->devt",
            "1"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "482-497",
          "snippet": "int cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_map *cdev_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nint cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cdev_set_parent",
          "args": [
            "cdev",
            "&dev->kobj"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_set_parent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "508-512",
          "snippet": "void cdev_set_parent(struct cdev *p, struct kobject *kobj)\n{\n\tWARN_ON(!kobj->state_initialized);\n\tp->kobj.parent = kobj;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_set_parent(struct cdev *p, struct kobject *kobj)\n{\n\tWARN_ON(!kobj->state_initialized);\n\tp->kobj.parent = kobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nint cdev_device_add(struct cdev *cdev, struct device *dev)\n{\n\tint rc = 0;\n\n\tif (dev->devt) {\n\t\tcdev_set_parent(cdev, &dev->kobj);\n\n\t\trc = cdev_add(cdev, dev->devt, 1);\n\t\tif (rc)\n\t\t\treturn rc;\n\t}\n\n\trc = device_add(dev);\n\tif (rc)\n\t\tcdev_del(cdev);\n\n\treturn rc;\n}"
  },
  {
    "function_name": "cdev_set_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "508-512",
    "snippet": "void cdev_set_parent(struct cdev *p, struct kobject *kobj)\n{\n\tWARN_ON(!kobj->state_initialized);\n\tp->kobj.parent = kobj;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!kobj->state_initialized"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_set_parent(struct cdev *p, struct kobject *kobj)\n{\n\tWARN_ON(!kobj->state_initialized);\n\tp->kobj.parent = kobj;\n}"
  },
  {
    "function_name": "cdev_add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "482-497",
    "snippet": "int cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_map *cdev_map;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kobject_get",
          "args": [
            "p->kobj.parent"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobj_map",
          "args": [
            "cdev_map",
            "dev",
            "count",
            "NULL",
            "exact_match",
            "exact_lock",
            "p"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nint cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "exact_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "466-470",
    "snippet": "static int exact_lock(dev_t dev, void *data)\n{\n\tstruct cdev *p = data;\n\treturn cdev_get(p) ? 0 : -1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cdev_get",
          "args": [
            "p"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "351-362",
          "snippet": "static struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic int exact_lock(dev_t dev, void *data)\n{\n\tstruct cdev *p = data;\n\treturn cdev_get(p) ? 0 : -1;\n}"
  },
  {
    "function_name": "exact_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "460-464",
    "snippet": "static struct kobject *exact_match(dev_t dev, int *part, void *data)\n{\n\tstruct cdev *p = data;\n\treturn &p->kobj;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *exact_match(dev_t dev, int *part, void *data)\n{\n\tstruct cdev *p = data;\n\treturn &p->kobj;\n}"
  },
  {
    "function_name": "cdev_purge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "438-448",
    "snippet": "static void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(cdev_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cdev_lock"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&inode->i_devices"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cdev->list.next",
            "structinode",
            "i_devices"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&cdev->list"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "577-586",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cdev_lock"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nstatic void cdev_purge(struct cdev *cdev)\n{\n\tspin_lock(&cdev_lock);\n\twhile (!list_empty(&cdev->list)) {\n\t\tstruct inode *inode;\n\t\tinode = container_of(cdev->list.next, struct inode, i_devices);\n\t\tlist_del_init(&inode->i_devices);\n\t\tinode->i_cdev = NULL;\n\t}\n\tspin_unlock(&cdev_lock);\n}"
  },
  {
    "function_name": "cd_forget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "429-436",
    "snippet": "void cd_forget(struct inode *inode)\n{\n\tspin_lock(&cdev_lock);\n\tlist_del_init(&inode->i_devices);\n\tinode->i_cdev = NULL;\n\tinode->i_mapping = &inode->i_data;\n\tspin_unlock(&cdev_lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(cdev_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cdev_lock"
          ],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&inode->i_devices"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cdev_lock"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nvoid cd_forget(struct inode *inode)\n{\n\tspin_lock(&cdev_lock);\n\tlist_del_init(&inode->i_devices);\n\tinode->i_cdev = NULL;\n\tinode->i_mapping = &inode->i_data;\n\tspin_unlock(&cdev_lock);\n}"
  },
  {
    "function_name": "chrdev_open",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "376-427",
    "snippet": "static int chrdev_open(struct inode *inode, struct file *filp)\n{\n\tconst struct file_operations *fops;\n\tstruct cdev *p;\n\tstruct cdev *new = NULL;\n\tint ret = 0;\n\n\tspin_lock(&cdev_lock);\n\tp = inode->i_cdev;\n\tif (!p) {\n\t\tstruct kobject *kobj;\n\t\tint idx;\n\t\tspin_unlock(&cdev_lock);\n\t\tkobj = kobj_lookup(cdev_map, inode->i_rdev, &idx);\n\t\tif (!kobj)\n\t\t\treturn -ENXIO;\n\t\tnew = container_of(kobj, struct cdev, kobj);\n\t\tspin_lock(&cdev_lock);\n\t\t/* Check i_cdev again in case somebody beat us to it while\n\t\t   we dropped the lock. */\n\t\tp = inode->i_cdev;\n\t\tif (!p) {\n\t\t\tinode->i_cdev = p = new;\n\t\t\tlist_add(&inode->i_devices, &p->list);\n\t\t\tnew = NULL;\n\t\t} else if (!cdev_get(p))\n\t\t\tret = -ENXIO;\n\t} else if (!cdev_get(p))\n\t\tret = -ENXIO;\n\tspin_unlock(&cdev_lock);\n\tcdev_put(new);\n\tif (ret)\n\t\treturn ret;\n\n\tret = -ENXIO;\n\tfops = fops_get(p->ops);\n\tif (!fops)\n\t\tgoto out_cdev_put;\n\n\treplace_fops(filp, fops);\n\tif (filp->f_op->open) {\n\t\tret = filp->f_op->open(inode, filp);\n\t\tif (ret)\n\t\t\tgoto out_cdev_put;\n\t}\n\n\treturn 0;\n\n out_cdev_put:\n\tcdev_put(p);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kobj_map *cdev_map;",
      "static DEFINE_SPINLOCK(cdev_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cdev_put",
          "args": [
            "p"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "364-371",
          "snippet": "void cdev_put(struct cdev *p)\n{\n\tif (p) {\n\t\tstruct module *owner = p->owner;\n\t\tkobject_put(&p->kobj);\n\t\tmodule_put(owner);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_put(struct cdev *p)\n{\n\tif (p) {\n\t\tstruct module *owner = p->owner;\n\t\tkobject_put(&p->kobj);\n\t\tmodule_put(owner);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "filp->f_op->open",
          "args": [
            "inode",
            "filp"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "replace_fops",
          "args": [
            "filp",
            "fops"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fops_get",
          "args": [
            "p->ops"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cdev_lock"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cdev_get",
          "args": [
            "p"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "351-362",
          "snippet": "static struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&inode->i_devices",
            "&p->list"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/xattr.c",
          "lines": "985-991",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cdev_lock"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kobj",
            "structcdev",
            "kobj"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobj_lookup",
          "args": [
            "cdev_map",
            "inode->i_rdev",
            "&idx"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\nstatic DEFINE_SPINLOCK(cdev_lock);\n\nstatic int chrdev_open(struct inode *inode, struct file *filp)\n{\n\tconst struct file_operations *fops;\n\tstruct cdev *p;\n\tstruct cdev *new = NULL;\n\tint ret = 0;\n\n\tspin_lock(&cdev_lock);\n\tp = inode->i_cdev;\n\tif (!p) {\n\t\tstruct kobject *kobj;\n\t\tint idx;\n\t\tspin_unlock(&cdev_lock);\n\t\tkobj = kobj_lookup(cdev_map, inode->i_rdev, &idx);\n\t\tif (!kobj)\n\t\t\treturn -ENXIO;\n\t\tnew = container_of(kobj, struct cdev, kobj);\n\t\tspin_lock(&cdev_lock);\n\t\t/* Check i_cdev again in case somebody beat us to it while\n\t\t   we dropped the lock. */\n\t\tp = inode->i_cdev;\n\t\tif (!p) {\n\t\t\tinode->i_cdev = p = new;\n\t\t\tlist_add(&inode->i_devices, &p->list);\n\t\t\tnew = NULL;\n\t\t} else if (!cdev_get(p))\n\t\t\tret = -ENXIO;\n\t} else if (!cdev_get(p))\n\t\tret = -ENXIO;\n\tspin_unlock(&cdev_lock);\n\tcdev_put(new);\n\tif (ret)\n\t\treturn ret;\n\n\tret = -ENXIO;\n\tfops = fops_get(p->ops);\n\tif (!fops)\n\t\tgoto out_cdev_put;\n\n\treplace_fops(filp, fops);\n\tif (filp->f_op->open) {\n\t\tret = filp->f_op->open(inode, filp);\n\t\tif (ret)\n\t\t\tgoto out_cdev_put;\n\t}\n\n\treturn 0;\n\n out_cdev_put:\n\tcdev_put(p);\n\treturn ret;\n}"
  },
  {
    "function_name": "cdev_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "364-371",
    "snippet": "void cdev_put(struct cdev *p)\n{\n\tif (p) {\n\t\tstruct module *owner = p->owner;\n\t\tkobject_put(&p->kobj);\n\t\tmodule_put(owner);\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "owner"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&p->kobj"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_put(struct cdev *p)\n{\n\tif (p) {\n\t\tstruct module *owner = p->owner;\n\t\tkobject_put(&p->kobj);\n\t\tmodule_put(owner);\n\t}\n}"
  },
  {
    "function_name": "cdev_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "351-362",
    "snippet": "static struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "owner"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_get",
          "args": [
            "&p->kobj"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "owner"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobject *cdev_get(struct cdev *p)\n{\n\tstruct module *owner = p->owner;\n\tstruct kobject *kobj;\n\n\tif (owner && !try_module_get(owner))\n\t\treturn NULL;\n\tkobj = kobject_get(&p->kobj);\n\tif (!kobj)\n\t\tmodule_put(owner);\n\treturn kobj;\n}"
  },
  {
    "function_name": "__unregister_chrdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "338-347",
    "snippet": "void __unregister_chrdev(unsigned int major, unsigned int baseminor,\n\t\t\t unsigned int count, const char *name)\n{\n\tstruct char_device_struct *cd;\n\n\tcd = __unregister_chrdev_region(major, baseminor, count);\n\tif (cd && cd->cdev)\n\t\tcdev_del(cd->cdev);\n\tkfree(cd);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cd"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cdev_del",
          "args": [
            "cd->cdev"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "594-598",
          "snippet": "void cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid cdev_del(struct cdev *p)\n{\n\tcdev_unmap(p->dev, p->count);\n\tkobject_put(&p->kobj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__unregister_chrdev_region",
          "args": [
            "major",
            "baseminor",
            "count"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "__unregister_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "174-192",
          "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nvoid __unregister_chrdev(unsigned int major, unsigned int baseminor,\n\t\t\t unsigned int count, const char *name)\n{\n\tstruct char_device_struct *cd;\n\n\tcd = __unregister_chrdev_region(major, baseminor, count);\n\tif (cd && cd->cdev)\n\t\tcdev_del(cd->cdev);\n\tkfree(cd);\n}"
  },
  {
    "function_name": "unregister_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "314-325",
    "snippet": "void unregister_chrdev_region(dev_t from, unsigned count)\n{\n\tdev_t to = from + count;\n\tdev_t n, next;\n\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tif (next > to)\n\t\t\tnext = to;\n\t\tkfree(__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n));\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n)"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__unregister_chrdev_region",
          "args": [
            "MAJOR(n)",
            "MINOR(n)",
            "next - n"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "__unregister_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "174-192",
          "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "n"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "MAJOR(n)+1",
            "0"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nvoid unregister_chrdev_region(dev_t from, unsigned count)\n{\n\tdev_t to = from + count;\n\tdev_t n, next;\n\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tif (next > to)\n\t\t\tnext = to;\n\t\tkfree(__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n));\n\t}\n}"
  },
  {
    "function_name": "__register_chrdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "271-303",
    "snippet": "int __register_chrdev(unsigned int major, unsigned int baseminor,\n\t\t      unsigned int count, const char *name,\n\t\t      const struct file_operations *fops)\n{\n\tstruct char_device_struct *cd;\n\tstruct cdev *cdev;\n\tint err = -ENOMEM;\n\n\tcd = __register_chrdev_region(major, baseminor, count, name);\n\tif (IS_ERR(cd))\n\t\treturn PTR_ERR(cd);\n\n\tcdev = cdev_alloc();\n\tif (!cdev)\n\t\tgoto out2;\n\n\tcdev->owner = fops->owner;\n\tcdev->ops = fops;\n\tkobject_set_name(&cdev->kobj, \"%s\", name);\n\n\terr = cdev_add(cdev, MKDEV(cd->major, baseminor), count);\n\tif (err)\n\t\tgoto out;\n\n\tcd->cdev = cdev;\n\n\treturn major ? 0 : cd->major;\nout:\n\tkobject_put(&cdev->kobj);\nout2:\n\tkfree(__unregister_chrdev_region(cd->major, baseminor, count));\n\treturn err;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "__unregister_chrdev_region(cd->major, baseminor, count)"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__unregister_chrdev_region",
          "args": [
            "cd->major",
            "baseminor",
            "count"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "__unregister_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "174-192",
          "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kobject_put",
          "args": [
            "&cdev->kobj"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_add",
          "args": [
            "cdev",
            "MKDEV(cd->major, baseminor)",
            "count"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "482-497",
          "snippet": "int cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_map *cdev_map;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_map *cdev_map;\n\nint cdev_add(struct cdev *p, dev_t dev, unsigned count)\n{\n\tint error;\n\n\tp->dev = dev;\n\tp->count = count;\n\n\terror = kobj_map(cdev_map, dev, count, NULL,\n\t\t\t exact_match, exact_lock, p);\n\tif (error)\n\t\treturn error;\n\n\tkobject_get(p->kobj.parent);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "cd->major",
            "baseminor"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kobject_set_name",
          "args": [
            "&cdev->kobj",
            "\"%s\"",
            "name"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cdev_alloc",
          "args": [],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "cdev_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "633-641",
          "snippet": "struct cdev *cdev_alloc(void)\n{\n\tstruct cdev *p = kzalloc(sizeof(struct cdev), GFP_KERNEL);\n\tif (p) {\n\t\tINIT_LIST_HEAD(&p->list);\n\t\tkobject_init(&p->kobj, &ktype_cdev_dynamic);\n\t}\n\treturn p;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kobj_type ktype_cdev_dynamic = {\n\t.release\t= cdev_dynamic_release,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct kobj_type ktype_cdev_dynamic = {\n\t.release\t= cdev_dynamic_release,\n};\n\nstruct cdev *cdev_alloc(void)\n{\n\tstruct cdev *p = kzalloc(sizeof(struct cdev), GFP_KERNEL);\n\tif (p) {\n\t\tINIT_LIST_HEAD(&p->list);\n\t\tkobject_init(&p->kobj, &ktype_cdev_dynamic);\n\t}\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "cd"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "cd"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__register_chrdev_region",
          "args": [
            "major",
            "baseminor",
            "count",
            "name"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "__register_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "99-172",
          "snippet": "static struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\tif (major == 0) {\n\t\tret = find_dynamic_major();\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\",\n\t\t\t       name);\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = ret;\n\t}\n\n\tif (major >= CHRDEV_MAJOR_MAX) {\n\t\tpr_err(\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\",\n\t\t       name, major, CHRDEV_MAJOR_MAX-1);\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);",
            "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nstatic struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\tif (major == 0) {\n\t\tret = find_dynamic_major();\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\",\n\t\t\t       name);\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = ret;\n\t}\n\n\tif (major >= CHRDEV_MAJOR_MAX) {\n\t\tpr_err(\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\",\n\t\t       name, major, CHRDEV_MAJOR_MAX-1);\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nint __register_chrdev(unsigned int major, unsigned int baseminor,\n\t\t      unsigned int count, const char *name,\n\t\t      const struct file_operations *fops)\n{\n\tstruct char_device_struct *cd;\n\tstruct cdev *cdev;\n\tint err = -ENOMEM;\n\n\tcd = __register_chrdev_region(major, baseminor, count, name);\n\tif (IS_ERR(cd))\n\t\treturn PTR_ERR(cd);\n\n\tcdev = cdev_alloc();\n\tif (!cdev)\n\t\tgoto out2;\n\n\tcdev->owner = fops->owner;\n\tcdev->ops = fops;\n\tkobject_set_name(&cdev->kobj, \"%s\", name);\n\n\terr = cdev_add(cdev, MKDEV(cd->major, baseminor), count);\n\tif (err)\n\t\tgoto out;\n\n\tcd->cdev = cdev;\n\n\treturn major ? 0 : cd->major;\nout:\n\tkobject_put(&cdev->kobj);\nout2:\n\tkfree(__unregister_chrdev_region(cd->major, baseminor, count));\n\treturn err;\n}"
  },
  {
    "function_name": "alloc_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "239-248",
    "snippet": "int alloc_chrdev_region(dev_t *dev, unsigned baseminor, unsigned count,\n\t\t\tconst char *name)\n{\n\tstruct char_device_struct *cd;\n\tcd = __register_chrdev_region(0, baseminor, count, name);\n\tif (IS_ERR(cd))\n\t\treturn PTR_ERR(cd);\n\t*dev = MKDEV(cd->major, cd->baseminor);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "cd->major",
            "cd->baseminor"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "cd"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "cd"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__register_chrdev_region",
          "args": [
            "0",
            "baseminor",
            "count",
            "name"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "__register_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "99-172",
          "snippet": "static struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\tif (major == 0) {\n\t\tret = find_dynamic_major();\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\",\n\t\t\t       name);\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = ret;\n\t}\n\n\tif (major >= CHRDEV_MAJOR_MAX) {\n\t\tpr_err(\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\",\n\t\t       name, major, CHRDEV_MAJOR_MAX-1);\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);",
            "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nstatic struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\tif (major == 0) {\n\t\tret = find_dynamic_major();\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\",\n\t\t\t       name);\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = ret;\n\t}\n\n\tif (major >= CHRDEV_MAJOR_MAX) {\n\t\tpr_err(\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\",\n\t\t       name, major, CHRDEV_MAJOR_MAX-1);\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nint alloc_chrdev_region(dev_t *dev, unsigned baseminor, unsigned count,\n\t\t\tconst char *name)\n{\n\tstruct char_device_struct *cd;\n\tcd = __register_chrdev_region(0, baseminor, count, name);\n\tif (IS_ERR(cd))\n\t\treturn PTR_ERR(cd);\n\t*dev = MKDEV(cd->major, cd->baseminor);\n\treturn 0;\n}"
  },
  {
    "function_name": "register_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "203-226",
    "snippet": "int register_chrdev_region(dev_t from, unsigned count, const char *name)\n{\n\tstruct char_device_struct *cd;\n\tdev_t to = from + count;\n\tdev_t n, next;\n\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tif (next > to)\n\t\t\tnext = to;\n\t\tcd = __register_chrdev_region(MAJOR(n), MINOR(n),\n\t\t\t       next - n, name);\n\t\tif (IS_ERR(cd))\n\t\t\tgoto fail;\n\t}\n\treturn 0;\nfail:\n\tto = n;\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tkfree(__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n));\n\t}\n\treturn PTR_ERR(cd);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "cd"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n)"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__unregister_chrdev_region",
          "args": [
            "MAJOR(n)",
            "MINOR(n)",
            "next - n"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "__unregister_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "174-192",
          "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "n"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "MAJOR(n)+1",
            "0"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "cd"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__register_chrdev_region",
          "args": [
            "MAJOR(n)",
            "MINOR(n)",
            "next - n",
            "name"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "__register_chrdev_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "99-172",
          "snippet": "static struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\tif (major == 0) {\n\t\tret = find_dynamic_major();\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\",\n\t\t\t       name);\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = ret;\n\t}\n\n\tif (major >= CHRDEV_MAJOR_MAX) {\n\t\tpr_err(\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\",\n\t\t       name, major, CHRDEV_MAJOR_MAX-1);\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(chrdevs_lock);",
            "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nstatic struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\tif (major == 0) {\n\t\tret = find_dynamic_major();\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\",\n\t\t\t       name);\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = ret;\n\t}\n\n\tif (major >= CHRDEV_MAJOR_MAX) {\n\t\tpr_err(\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\",\n\t\t       name, major, CHRDEV_MAJOR_MAX-1);\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "n"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "MAJOR(n)+1",
            "0"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "n"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nint register_chrdev_region(dev_t from, unsigned count, const char *name)\n{\n\tstruct char_device_struct *cd;\n\tdev_t to = from + count;\n\tdev_t n, next;\n\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tif (next > to)\n\t\t\tnext = to;\n\t\tcd = __register_chrdev_region(MAJOR(n), MINOR(n),\n\t\t\t       next - n, name);\n\t\tif (IS_ERR(cd))\n\t\t\tgoto fail;\n\t}\n\treturn 0;\nfail:\n\tto = n;\n\tfor (n = from; n < to; n = next) {\n\t\tnext = MKDEV(MAJOR(n)+1, 0);\n\t\tkfree(__unregister_chrdev_region(MAJOR(n), MINOR(n), next - n));\n\t}\n\treturn PTR_ERR(cd);\n}"
  },
  {
    "function_name": "__unregister_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "174-192",
    "snippet": "static struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(chrdevs_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major_to_index",
          "args": [
            "major"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "major_to_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "44-47",
          "snippet": "static inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [
            "#define CHRDEV_MAJOR_HASH_SIZE 255"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\n#define CHRDEV_MAJOR_HASH_SIZE 255\n\nstatic inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\n\nstatic struct char_device_struct *\n__unregister_chrdev_region(unsigned major, unsigned baseminor, int minorct)\n{\n\tstruct char_device_struct *cd = NULL, **cp;\n\tint i = major_to_index(major);\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major == major &&\n\t\t    (*cp)->baseminor == baseminor &&\n\t\t    (*cp)->minorct == minorct)\n\t\t\tbreak;\n\tif (*cp) {\n\t\tcd = *cp;\n\t\t*cp = cd->next;\n\t}\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\n}"
  },
  {
    "function_name": "__register_chrdev_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "99-172",
    "snippet": "static struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\tif (major == 0) {\n\t\tret = find_dynamic_major();\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\",\n\t\t\t       name);\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = ret;\n\t}\n\n\tif (major >= CHRDEV_MAJOR_MAX) {\n\t\tpr_err(\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\",\n\t\t       name, major, CHRDEV_MAJOR_MAX-1);\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(chrdevs_lock);",
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ret"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cd"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major_to_index",
          "args": [
            "major"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "major_to_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "44-47",
          "snippet": "static inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [
            "#define CHRDEV_MAJOR_HASH_SIZE 255"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\n#define CHRDEV_MAJOR_HASH_SIZE 255\n\nstatic inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "cd->name",
            "name",
            "sizeof(cd->name)"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\"",
            "name",
            "major",
            "CHRDEV_MAJOR_MAX-1"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\"",
            "name"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_dynamic_major",
          "args": [],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "find_dynamic_major",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "65-86",
          "snippet": "static int find_dynamic_major(void)\n{\n\tint i;\n\tstruct char_device_struct *cd;\n\n\tfor (i = ARRAY_SIZE(chrdevs)-1; i >= CHRDEV_MAJOR_DYN_END; i--) {\n\t\tif (chrdevs[i] == NULL)\n\t\t\treturn i;\n\t}\n\n\tfor (i = CHRDEV_MAJOR_DYN_EXT_START;\n\t     i >= CHRDEV_MAJOR_DYN_EXT_END; i--) {\n\t\tfor (cd = chrdevs[major_to_index(i)]; cd; cd = cd->next)\n\t\t\tif (cd->major == i)\n\t\t\t\tbreak;\n\n\t\tif (cd == NULL)\n\t\t\treturn i;\n\t}\n\n\treturn -EBUSY;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic int find_dynamic_major(void)\n{\n\tint i;\n\tstruct char_device_struct *cd;\n\n\tfor (i = ARRAY_SIZE(chrdevs)-1; i >= CHRDEV_MAJOR_DYN_END; i--) {\n\t\tif (chrdevs[i] == NULL)\n\t\t\treturn i;\n\t}\n\n\tfor (i = CHRDEV_MAJOR_DYN_EXT_START;\n\t     i >= CHRDEV_MAJOR_DYN_EXT_END; i--) {\n\t\tfor (cd = chrdevs[major_to_index(i)]; cd; cd = cd->next)\n\t\t\tif (cd->major == i)\n\t\t\t\tbreak;\n\n\t\tif (cd == NULL)\n\t\t\treturn i;\n\t}\n\n\treturn -EBUSY;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct char_device_struct)",
            "GFP_KERNEL"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nstatic struct char_device_struct *\n__register_chrdev_region(unsigned int major, unsigned int baseminor,\n\t\t\t   int minorct, const char *name)\n{\n\tstruct char_device_struct *cd, **cp;\n\tint ret = 0;\n\tint i;\n\n\tcd = kzalloc(sizeof(struct char_device_struct), GFP_KERNEL);\n\tif (cd == NULL)\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tmutex_lock(&chrdevs_lock);\n\n\tif (major == 0) {\n\t\tret = find_dynamic_major();\n\t\tif (ret < 0) {\n\t\t\tpr_err(\"CHRDEV \\\"%s\\\" dynamic allocation region is full\\n\",\n\t\t\t       name);\n\t\t\tgoto out;\n\t\t}\n\t\tmajor = ret;\n\t}\n\n\tif (major >= CHRDEV_MAJOR_MAX) {\n\t\tpr_err(\"CHRDEV \\\"%s\\\" major requested (%u) is greater than the maximum (%u)\\n\",\n\t\t       name, major, CHRDEV_MAJOR_MAX-1);\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tcd->major = major;\n\tcd->baseminor = baseminor;\n\tcd->minorct = minorct;\n\tstrlcpy(cd->name, name, sizeof(cd->name));\n\n\ti = major_to_index(major);\n\n\tfor (cp = &chrdevs[i]; *cp; cp = &(*cp)->next)\n\t\tif ((*cp)->major > major ||\n\t\t    ((*cp)->major == major &&\n\t\t     (((*cp)->baseminor >= baseminor) ||\n\t\t      ((*cp)->baseminor + (*cp)->minorct > baseminor))))\n\t\t\tbreak;\n\n\t/* Check for overlapping minor ranges.  */\n\tif (*cp && (*cp)->major == major) {\n\t\tint old_min = (*cp)->baseminor;\n\t\tint old_max = (*cp)->baseminor + (*cp)->minorct - 1;\n\t\tint new_min = baseminor;\n\t\tint new_max = baseminor + minorct - 1;\n\n\t\t/* New driver overlaps from the left.  */\n\t\tif (new_max >= old_min && new_max <= old_max) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\n\t\t/* New driver overlaps from the right.  */\n\t\tif (new_min <= old_max && new_min >= old_min) {\n\t\t\tret = -EBUSY;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\tcd->next = *cp;\n\t*cp = cd;\n\tmutex_unlock(&chrdevs_lock);\n\treturn cd;\nout:\n\tmutex_unlock(&chrdevs_lock);\n\tkfree(cd);\n\treturn ERR_PTR(ret);\n}"
  },
  {
    "function_name": "find_dynamic_major",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "65-86",
    "snippet": "static int find_dynamic_major(void)\n{\n\tint i;\n\tstruct char_device_struct *cd;\n\n\tfor (i = ARRAY_SIZE(chrdevs)-1; i >= CHRDEV_MAJOR_DYN_END; i--) {\n\t\tif (chrdevs[i] == NULL)\n\t\t\treturn i;\n\t}\n\n\tfor (i = CHRDEV_MAJOR_DYN_EXT_START;\n\t     i >= CHRDEV_MAJOR_DYN_EXT_END; i--) {\n\t\tfor (cd = chrdevs[major_to_index(i)]; cd; cd = cd->next)\n\t\t\tif (cd->major == i)\n\t\t\t\tbreak;\n\n\t\tif (cd == NULL)\n\t\t\treturn i;\n\t}\n\n\treturn -EBUSY;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "major_to_index",
          "args": [
            "i"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "major_to_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "44-47",
          "snippet": "static inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [
            "#define CHRDEV_MAJOR_HASH_SIZE 255"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\n#define CHRDEV_MAJOR_HASH_SIZE 255\n\nstatic inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "chrdevs"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic int find_dynamic_major(void)\n{\n\tint i;\n\tstruct char_device_struct *cd;\n\n\tfor (i = ARRAY_SIZE(chrdevs)-1; i >= CHRDEV_MAJOR_DYN_END; i--) {\n\t\tif (chrdevs[i] == NULL)\n\t\t\treturn i;\n\t}\n\n\tfor (i = CHRDEV_MAJOR_DYN_EXT_START;\n\t     i >= CHRDEV_MAJOR_DYN_EXT_END; i--) {\n\t\tfor (cd = chrdevs[major_to_index(i)]; cd; cd = cd->next)\n\t\t\tif (cd->major == i)\n\t\t\t\tbreak;\n\n\t\tif (cd == NULL)\n\t\t\treturn i;\n\t}\n\n\treturn -EBUSY;\n}"
  },
  {
    "function_name": "chrdev_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "51-61",
    "snippet": "void chrdev_show(struct seq_file *f, off_t offset)\n{\n\tstruct char_device_struct *cd;\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cd = chrdevs[major_to_index(offset)]; cd; cd = cd->next) {\n\t\tif (cd->major == offset)\n\t\t\tseq_printf(f, \"%3d %s\\n\", cd->major, cd->name);\n\t}\n\tmutex_unlock(&chrdevs_lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(chrdevs_lock);",
      "static struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "f",
            "\"%3d %s\\n\"",
            "cd->major",
            "cd->name"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/seq_file.c",
          "lines": "401-408",
          "snippet": "void seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tva_list args;\n\n\tva_start(args, f);\n\tseq_vprintf(m, f, args);\n\tva_end(args);\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/string_helpers.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>",
            "#include <linux/cache.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <linux/uaccess.h>\n#include <linux/string_helpers.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n#include <linux/cache.h>\n\nvoid seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tva_list args;\n\n\tva_start(args, f);\n\tseq_vprintf(m, f, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "major_to_index",
          "args": [
            "offset"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "major_to_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
          "lines": "44-47",
          "snippet": "static inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/tty.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cdev.h>",
            "#include <linux/kobj_map.h>",
            "#include <linux/kobject.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/major.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/kdev_t.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [
            "#define CHRDEV_MAJOR_HASH_SIZE 255"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\n#define CHRDEV_MAJOR_HASH_SIZE 255\n\nstatic inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&chrdevs_lock"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(chrdevs_lock);\nstatic struct char_device_struct {\n\tstruct char_device_struct *next;\n\tunsigned int major;\n\tunsigned int baseminor;\n\tint minorct;\n\tchar name[64];\n\tstruct cdev *cdev;\t\t/* will die */\n} *chrdevs[CHRDEV_MAJOR_HASH_SIZE];\n\nvoid chrdev_show(struct seq_file *f, off_t offset)\n{\n\tstruct char_device_struct *cd;\n\n\tmutex_lock(&chrdevs_lock);\n\tfor (cd = chrdevs[major_to_index(offset)]; cd; cd = cd->next) {\n\t\tif (cd->major == offset)\n\t\t\tseq_printf(f, \"%3d %s\\n\", cd->major, cd->name);\n\t}\n\tmutex_unlock(&chrdevs_lock);\n}"
  },
  {
    "function_name": "major_to_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/char_dev.c",
    "lines": "44-47",
    "snippet": "static inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <linux/tty.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/mutex.h>",
      "#include <linux/cdev.h>",
      "#include <linux/kobj_map.h>",
      "#include <linux/kobject.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>",
      "#include <linux/errno.h>",
      "#include <linux/major.h>",
      "#include <linux/string.h>",
      "#include <linux/slab.h>",
      "#include <linux/kdev_t.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [
      "#define CHRDEV_MAJOR_HASH_SIZE 255"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <linux/tty.h>\n#include <linux/backing-dev.h>\n#include <linux/mutex.h>\n#include <linux/cdev.h>\n#include <linux/kobj_map.h>\n#include <linux/kobject.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/major.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/kdev_t.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n\n#define CHRDEV_MAJOR_HASH_SIZE 255\n\nstatic inline int major_to_index(unsigned major)\n{\n\treturn major % CHRDEV_MAJOR_HASH_SIZE;\n}"
  }
]