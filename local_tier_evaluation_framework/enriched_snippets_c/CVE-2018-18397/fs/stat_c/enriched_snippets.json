[
  {
    "function_name": "inode_set_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "730-736",
    "snippet": "void inode_set_bytes(struct inode *inode, loff_t bytes)\n{\n\t/* Caller is here responsible for sufficient locking\n\t * (ie. inode->i_lock) */\n\tinode->i_blocks = bytes >> 9;\n\tinode->i_bytes = bytes & 511;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid inode_set_bytes(struct inode *inode, loff_t bytes)\n{\n\t/* Caller is here responsible for sufficient locking\n\t * (ie. inode->i_lock) */\n\tinode->i_blocks = bytes >> 9;\n\tinode->i_bytes = bytes & 511;\n}"
  },
  {
    "function_name": "inode_get_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "718-726",
    "snippet": "loff_t inode_get_bytes(struct inode *inode)\n{\n\tloff_t ret;\n\n\tspin_lock(&inode->i_lock);\n\tret = __inode_get_bytes(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__inode_get_bytes",
          "args": [
            "inode"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 722
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nloff_t inode_get_bytes(struct inode *inode)\n{\n\tloff_t ret;\n\n\tspin_lock(&inode->i_lock);\n\tret = __inode_get_bytes(inode);\n\tspin_unlock(&inode->i_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "inode_sub_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "709-714",
    "snippet": "void inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tspin_lock(&inode->i_lock);\n\t__inode_sub_bytes(inode, bytes);\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__inode_sub_bytes",
          "args": [
            "inode",
            "bytes"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "__inode_sub_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
          "lines": "696-705",
          "snippet": "void __inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks -= bytes >> 9;\n\tbytes &= 511;\n\tif (inode->i_bytes < bytes) {\n\t\tinode->i_blocks--;\n\t\tinode->i_bytes += 512;\n\t}\n\tinode->i_bytes -= bytes;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid __inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks -= bytes >> 9;\n\tbytes &= 511;\n\tif (inode->i_bytes < bytes) {\n\t\tinode->i_blocks--;\n\t\tinode->i_bytes += 512;\n\t}\n\tinode->i_bytes -= bytes;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tspin_lock(&inode->i_lock);\n\t__inode_sub_bytes(inode, bytes);\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "__inode_sub_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "696-705",
    "snippet": "void __inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks -= bytes >> 9;\n\tbytes &= 511;\n\tif (inode->i_bytes < bytes) {\n\t\tinode->i_blocks--;\n\t\tinode->i_bytes += 512;\n\t}\n\tinode->i_bytes -= bytes;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid __inode_sub_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks -= bytes >> 9;\n\tbytes &= 511;\n\tif (inode->i_bytes < bytes) {\n\t\tinode->i_blocks--;\n\t\tinode->i_bytes += 512;\n\t}\n\tinode->i_bytes -= bytes;\n}"
  },
  {
    "function_name": "inode_add_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "687-692",
    "snippet": "void inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tspin_lock(&inode->i_lock);\n\t__inode_add_bytes(inode, bytes);\n\tspin_unlock(&inode->i_lock);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__inode_add_bytes",
          "args": [
            "inode",
            "bytes"
          ],
          "line": 690
        },
        "resolved": true,
        "details": {
          "function_name": "__inode_add_bytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
          "lines": "675-684",
          "snippet": "void __inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks += bytes >> 9;\n\tbytes &= 511;\n\tinode->i_bytes += bytes;\n\tif (inode->i_bytes >= 512) {\n\t\tinode->i_blocks++;\n\t\tinode->i_bytes -= 512;\n\t}\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid __inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks += bytes >> 9;\n\tbytes &= 511;\n\tinode->i_bytes += bytes;\n\tif (inode->i_bytes >= 512) {\n\t\tinode->i_blocks++;\n\t\tinode->i_bytes -= 512;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tspin_lock(&inode->i_lock);\n\t__inode_add_bytes(inode, bytes);\n\tspin_unlock(&inode->i_lock);\n}"
  },
  {
    "function_name": "__inode_add_bytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "675-684",
    "snippet": "void __inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks += bytes >> 9;\n\tbytes &= 511;\n\tinode->i_bytes += bytes;\n\tif (inode->i_bytes >= 512) {\n\t\tinode->i_blocks++;\n\t\tinode->i_bytes -= 512;\n\t}\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid __inode_add_bytes(struct inode *inode, loff_t bytes)\n{\n\tinode->i_blocks += bytes >> 9;\n\tbytes &= 511;\n\tinode->i_bytes += bytes;\n\tif (inode->i_bytes >= 512) {\n\t\tinode->i_blocks++;\n\t\tinode->i_bytes -= 512;\n\t}\n}"
  },
  {
    "function_name": "cp_compat_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "590-621",
    "snippet": "static int cp_compat_stat(struct kstat *stat, struct compat_stat __user *ubuf)\n{\n\tstruct compat_stat tmp;\n\n\tif (!old_valid_dev(stat->dev) || !old_valid_dev(stat->rdev))\n\t\treturn -EOVERFLOW;\n\n\tmemset(&tmp, 0, sizeof(tmp));\n\ttmp.st_dev = old_encode_dev(stat->dev);\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\tif (tmp.st_nlink != stat->nlink)\n\t\treturn -EOVERFLOW;\n\tSET_UID(tmp.st_uid, from_kuid_munged(current_user_ns(), stat->uid));\n\tSET_GID(tmp.st_gid, from_kgid_munged(current_user_ns(), stat->gid));\n\ttmp.st_rdev = old_encode_dev(stat->rdev);\n\tif ((u64) stat->size > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n\ttmp.st_size = stat->size;\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_atime_nsec = stat->atime.tv_nsec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_mtime_nsec = stat->mtime.tv_nsec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n\ttmp.st_ctime_nsec = stat->ctime.tv_nsec;\n\ttmp.st_blocks = stat->blocks;\n\ttmp.st_blksize = stat->blksize;\n\treturn copy_to_user(ubuf, &tmp, sizeof(tmp)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "ubuf",
            "&tmp",
            "sizeof(tmp)"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_encode_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_GID",
          "args": [
            "tmp.st_gid",
            "from_kgid_munged(current_user_ns(), stat->gid)"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "current_user_ns()",
            "stat->gid"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_UID",
          "args": [
            "tmp.st_uid",
            "from_kuid_munged(current_user_ns(), stat->uid)"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "current_user_ns()",
            "stat->uid"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_encode_dev",
          "args": [
            "stat->dev"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&tmp",
            "0",
            "sizeof(tmp)"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_valid_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_valid_dev",
          "args": [
            "stat->dev"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int cp_compat_stat(struct kstat *stat, struct compat_stat __user *ubuf)\n{\n\tstruct compat_stat tmp;\n\n\tif (!old_valid_dev(stat->dev) || !old_valid_dev(stat->rdev))\n\t\treturn -EOVERFLOW;\n\n\tmemset(&tmp, 0, sizeof(tmp));\n\ttmp.st_dev = old_encode_dev(stat->dev);\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\tif (tmp.st_nlink != stat->nlink)\n\t\treturn -EOVERFLOW;\n\tSET_UID(tmp.st_uid, from_kuid_munged(current_user_ns(), stat->uid));\n\tSET_GID(tmp.st_gid, from_kgid_munged(current_user_ns(), stat->gid));\n\ttmp.st_rdev = old_encode_dev(stat->rdev);\n\tif ((u64) stat->size > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n\ttmp.st_size = stat->size;\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_atime_nsec = stat->atime.tv_nsec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_mtime_nsec = stat->mtime.tv_nsec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n\ttmp.st_ctime_nsec = stat->ctime.tv_nsec;\n\ttmp.st_blocks = stat->blocks;\n\ttmp.st_blksize = stat->blksize;\n\treturn copy_to_user(ubuf, &tmp, sizeof(tmp)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "cp_statx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "524-556",
    "snippet": "static noinline_for_stack int\ncp_statx(const struct kstat *stat, struct statx __user *buffer)\n{\n\tstruct statx tmp;\n\n\tmemset(&tmp, 0, sizeof(tmp));\n\n\ttmp.stx_mask = stat->result_mask;\n\ttmp.stx_blksize = stat->blksize;\n\ttmp.stx_attributes = stat->attributes;\n\ttmp.stx_nlink = stat->nlink;\n\ttmp.stx_uid = from_kuid_munged(current_user_ns(), stat->uid);\n\ttmp.stx_gid = from_kgid_munged(current_user_ns(), stat->gid);\n\ttmp.stx_mode = stat->mode;\n\ttmp.stx_ino = stat->ino;\n\ttmp.stx_size = stat->size;\n\ttmp.stx_blocks = stat->blocks;\n\ttmp.stx_attributes_mask = stat->attributes_mask;\n\ttmp.stx_atime.tv_sec = stat->atime.tv_sec;\n\ttmp.stx_atime.tv_nsec = stat->atime.tv_nsec;\n\ttmp.stx_btime.tv_sec = stat->btime.tv_sec;\n\ttmp.stx_btime.tv_nsec = stat->btime.tv_nsec;\n\ttmp.stx_ctime.tv_sec = stat->ctime.tv_sec;\n\ttmp.stx_ctime.tv_nsec = stat->ctime.tv_nsec;\n\ttmp.stx_mtime.tv_sec = stat->mtime.tv_sec;\n\ttmp.stx_mtime.tv_nsec = stat->mtime.tv_nsec;\n\ttmp.stx_rdev_major = MAJOR(stat->rdev);\n\ttmp.stx_rdev_minor = MINOR(stat->rdev);\n\ttmp.stx_dev_major = MAJOR(stat->dev);\n\ttmp.stx_dev_minor = MINOR(stat->dev);\n\n\treturn copy_to_user(buffer, &tmp, sizeof(tmp)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "buffer",
            "&tmp",
            "sizeof(tmp)"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "stat->dev"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "stat->dev"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "stat->rdev"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "stat->rdev"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "current_user_ns()",
            "stat->gid"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "current_user_ns()",
            "stat->uid"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&tmp",
            "0",
            "sizeof(tmp)"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic noinline_for_stack int\ncp_statx(const struct kstat *stat, struct statx __user *buffer)\n{\n\tstruct statx tmp;\n\n\tmemset(&tmp, 0, sizeof(tmp));\n\n\ttmp.stx_mask = stat->result_mask;\n\ttmp.stx_blksize = stat->blksize;\n\ttmp.stx_attributes = stat->attributes;\n\ttmp.stx_nlink = stat->nlink;\n\ttmp.stx_uid = from_kuid_munged(current_user_ns(), stat->uid);\n\ttmp.stx_gid = from_kgid_munged(current_user_ns(), stat->gid);\n\ttmp.stx_mode = stat->mode;\n\ttmp.stx_ino = stat->ino;\n\ttmp.stx_size = stat->size;\n\ttmp.stx_blocks = stat->blocks;\n\ttmp.stx_attributes_mask = stat->attributes_mask;\n\ttmp.stx_atime.tv_sec = stat->atime.tv_sec;\n\ttmp.stx_atime.tv_nsec = stat->atime.tv_nsec;\n\ttmp.stx_btime.tv_sec = stat->btime.tv_sec;\n\ttmp.stx_btime.tv_nsec = stat->btime.tv_nsec;\n\ttmp.stx_ctime.tv_sec = stat->ctime.tv_sec;\n\ttmp.stx_ctime.tv_nsec = stat->ctime.tv_nsec;\n\ttmp.stx_mtime.tv_sec = stat->mtime.tv_sec;\n\ttmp.stx_mtime.tv_nsec = stat->mtime.tv_nsec;\n\ttmp.stx_rdev_major = MAJOR(stat->rdev);\n\ttmp.stx_rdev_minor = MINOR(stat->rdev);\n\ttmp.stx_dev_major = MAJOR(stat->dev);\n\ttmp.stx_dev_minor = MINOR(stat->dev);\n\n\treturn copy_to_user(buffer, &tmp, sizeof(tmp)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "cp_new_stat64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "441-474",
    "snippet": "static long cp_new_stat64(struct kstat *stat, struct stat64 __user *statbuf)\n{\n\tstruct stat64 tmp;\n\n\tINIT_STRUCT_STAT64_PADDING(tmp);\n#ifdef CONFIG_MIPS\n\t/* mips has weird padding, so we don't get 64 bits there */\n\ttmp.st_dev = new_encode_dev(stat->dev);\n\ttmp.st_rdev = new_encode_dev(stat->rdev);\n#else\n\ttmp.st_dev = huge_encode_dev(stat->dev);\n\ttmp.st_rdev = huge_encode_dev(stat->rdev);\n#endif\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n#ifdef STAT64_HAS_BROKEN_ST_INO\n\ttmp.__st_ino = stat->ino;\n#endif\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\ttmp.st_uid = from_kuid_munged(current_user_ns(), stat->uid);\n\ttmp.st_gid = from_kgid_munged(current_user_ns(), stat->gid);\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_atime_nsec = stat->atime.tv_nsec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_mtime_nsec = stat->mtime.tv_nsec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n\ttmp.st_ctime_nsec = stat->ctime.tv_nsec;\n\ttmp.st_size = stat->size;\n\ttmp.st_blocks = stat->blocks;\n\ttmp.st_blksize = stat->blksize;\n\treturn copy_to_user(statbuf,&tmp,sizeof(tmp)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "statbuf",
            "&tmp",
            "sizeof(tmp)"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "current_user_ns()",
            "stat->gid"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "current_user_ns()",
            "stat->uid"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "huge_encode_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "huge_encode_dev",
          "args": [
            "stat->dev"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_encode_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_encode_dev",
          "args": [
            "stat->dev"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_STRUCT_STAT64_PADDING",
          "args": [
            "tmp"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic long cp_new_stat64(struct kstat *stat, struct stat64 __user *statbuf)\n{\n\tstruct stat64 tmp;\n\n\tINIT_STRUCT_STAT64_PADDING(tmp);\n#ifdef CONFIG_MIPS\n\t/* mips has weird padding, so we don't get 64 bits there */\n\ttmp.st_dev = new_encode_dev(stat->dev);\n\ttmp.st_rdev = new_encode_dev(stat->rdev);\n#else\n\ttmp.st_dev = huge_encode_dev(stat->dev);\n\ttmp.st_rdev = huge_encode_dev(stat->rdev);\n#endif\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n#ifdef STAT64_HAS_BROKEN_ST_INO\n\ttmp.__st_ino = stat->ino;\n#endif\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\ttmp.st_uid = from_kuid_munged(current_user_ns(), stat->uid);\n\ttmp.st_gid = from_kgid_munged(current_user_ns(), stat->gid);\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_atime_nsec = stat->atime.tv_nsec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_mtime_nsec = stat->mtime.tv_nsec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n\ttmp.st_ctime_nsec = stat->ctime.tv_nsec;\n\ttmp.st_size = stat->size;\n\ttmp.st_blocks = stat->blocks;\n\ttmp.st_blksize = stat->blksize;\n\treturn copy_to_user(statbuf,&tmp,sizeof(tmp)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "do_readlinkat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "385-419",
    "snippet": "static int do_readlinkat(int dfd, const char __user *pathname,\n\t\t\t char __user *buf, int bufsiz)\n{\n\tstruct path path;\n\tint error;\n\tint empty = 0;\n\tunsigned int lookup_flags = LOOKUP_EMPTY;\n\n\tif (bufsiz <= 0)\n\t\treturn -EINVAL;\n\nretry:\n\terror = user_path_at_empty(dfd, pathname, lookup_flags, &path, &empty);\n\tif (!error) {\n\t\tstruct inode *inode = d_backing_inode(path.dentry);\n\n\t\terror = empty ? -ENOENT : -EINVAL;\n\t\t/*\n\t\t * AFS mountpoints allow readlink(2) but are not symlinks\n\t\t */\n\t\tif (d_is_symlink(path.dentry) || inode->i_op->readlink) {\n\t\t\terror = security_inode_readlink(path.dentry);\n\t\t\tif (!error) {\n\t\t\t\ttouch_atime(&path);\n\t\t\t\terror = vfs_readlink(path.dentry, buf, bufsiz);\n\t\t\t}\n\t\t}\n\t\tpath_put(&path);\n\t\tif (retry_estale(error, lookup_flags)) {\n\t\t\tlookup_flags |= LOOKUP_REVAL;\n\t\t\tgoto retry;\n\t\t}\n\t}\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "retry_estale",
          "args": [
            "error",
            "lookup_flags"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "&path"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "path_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/namei.c",
          "lines": "482-486",
          "snippet": "void path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/build_bug.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/init_task.h>",
            "#include <linux/bitops.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/build_bug.h>\n#include <linux/uaccess.h>\n#include <linux/init_task.h>\n#include <linux/bitops.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vfs_readlink",
          "args": [
            "path.dentry",
            "buf",
            "bufsiz"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_readlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/namei.c",
          "lines": "4715-4743",
          "snippet": "int vfs_readlink(struct dentry *dentry, char __user *buffer, int buflen)\n{\n\tstruct inode *inode = d_inode(dentry);\n\tDEFINE_DELAYED_CALL(done);\n\tconst char *link;\n\tint res;\n\n\tif (unlikely(!(inode->i_opflags & IOP_DEFAULT_READLINK))) {\n\t\tif (unlikely(inode->i_op->readlink))\n\t\t\treturn inode->i_op->readlink(dentry, buffer, buflen);\n\n\t\tif (!d_is_symlink(dentry))\n\t\t\treturn -EINVAL;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tinode->i_opflags |= IOP_DEFAULT_READLINK;\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tlink = inode->i_link;\n\tif (!link) {\n\t\tlink = inode->i_op->get_link(dentry, inode, &done);\n\t\tif (IS_ERR(link))\n\t\t\treturn PTR_ERR(link);\n\t}\n\tres = readlink_copy(buffer, buflen, link);\n\tdo_delayed_call(&done);\n\treturn res;\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/build_bug.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/init_task.h>",
            "#include <linux/bitops.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/build_bug.h>\n#include <linux/uaccess.h>\n#include <linux/init_task.h>\n#include <linux/bitops.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nint vfs_readlink(struct dentry *dentry, char __user *buffer, int buflen)\n{\n\tstruct inode *inode = d_inode(dentry);\n\tDEFINE_DELAYED_CALL(done);\n\tconst char *link;\n\tint res;\n\n\tif (unlikely(!(inode->i_opflags & IOP_DEFAULT_READLINK))) {\n\t\tif (unlikely(inode->i_op->readlink))\n\t\t\treturn inode->i_op->readlink(dentry, buffer, buflen);\n\n\t\tif (!d_is_symlink(dentry))\n\t\t\treturn -EINVAL;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tinode->i_opflags |= IOP_DEFAULT_READLINK;\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tlink = inode->i_link;\n\tif (!link) {\n\t\tlink = inode->i_op->get_link(dentry, inode, &done);\n\t\tif (IS_ERR(link))\n\t\t\treturn PTR_ERR(link);\n\t}\n\tres = readlink_copy(buffer, buflen, link);\n\tdo_delayed_call(&done);\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "touch_atime",
          "args": [
            "&path"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "touch_atime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/inode.c",
          "lines": "1717-1745",
          "snippet": "void touch_atime(const struct path *path)\n{\n\tstruct vfsmount *mnt = path->mnt;\n\tstruct inode *inode = d_inode(path->dentry);\n\tstruct timespec64 now;\n\n\tif (!atime_needs_update(path, inode))\n\t\treturn;\n\n\tif (!sb_start_write_trylock(inode->i_sb))\n\t\treturn;\n\n\tif (__mnt_want_write(mnt) != 0)\n\t\tgoto skip_update;\n\t/*\n\t * File systems can error out when updating inodes if they need to\n\t * allocate new space to modify an inode (such is the case for\n\t * Btrfs), but since we touch atime while walking down the path we\n\t * really don't care if we failed to update the atime of the file,\n\t * so just ignore the return value.\n\t * We may also fail on filesystems that have the ability to make parts\n\t * of the fs read only, e.g. subvolumes in Btrfs.\n\t */\n\tnow = current_time(inode);\n\tupdate_time(inode, &now, S_ATIME);\n\t__mnt_drop_write(mnt);\nskip_update:\n\tsb_end_write(inode->i_sb);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/iversion.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/memblock.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/iversion.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/memblock.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nvoid touch_atime(const struct path *path)\n{\n\tstruct vfsmount *mnt = path->mnt;\n\tstruct inode *inode = d_inode(path->dentry);\n\tstruct timespec64 now;\n\n\tif (!atime_needs_update(path, inode))\n\t\treturn;\n\n\tif (!sb_start_write_trylock(inode->i_sb))\n\t\treturn;\n\n\tif (__mnt_want_write(mnt) != 0)\n\t\tgoto skip_update;\n\t/*\n\t * File systems can error out when updating inodes if they need to\n\t * allocate new space to modify an inode (such is the case for\n\t * Btrfs), but since we touch atime while walking down the path we\n\t * really don't care if we failed to update the atime of the file,\n\t * so just ignore the return value.\n\t * We may also fail on filesystems that have the ability to make parts\n\t * of the fs read only, e.g. subvolumes in Btrfs.\n\t */\n\tnow = current_time(inode);\n\tupdate_time(inode, &now, S_ATIME);\n\t__mnt_drop_write(mnt);\nskip_update:\n\tsb_end_write(inode->i_sb);\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_inode_readlink",
          "args": [
            "path.dentry"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_is_symlink",
          "args": [
            "path.dentry"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_backing_inode",
          "args": [
            "path.dentry"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_path_at_empty",
          "args": [
            "dfd",
            "pathname",
            "lookup_flags",
            "&path",
            "&empty"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "user_path_at_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/namei.c",
          "lines": "2605-2610",
          "snippet": "int user_path_at_empty(int dfd, const char __user *name, unsigned flags,\n\t\t struct path *path, int *empty)\n{\n\treturn filename_lookup(dfd, getname_flags(name, flags, empty),\n\t\t\t       flags, path, NULL);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/build_bug.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/init_task.h>",
            "#include <linux/bitops.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/build_bug.h>\n#include <linux/uaccess.h>\n#include <linux/init_task.h>\n#include <linux/bitops.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nint user_path_at_empty(int dfd, const char __user *name, unsigned flags,\n\t\t struct path *path, int *empty)\n{\n\treturn filename_lookup(dfd, getname_flags(name, flags, empty),\n\t\t\t       flags, path, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int do_readlinkat(int dfd, const char __user *pathname,\n\t\t\t char __user *buf, int bufsiz)\n{\n\tstruct path path;\n\tint error;\n\tint empty = 0;\n\tunsigned int lookup_flags = LOOKUP_EMPTY;\n\n\tif (bufsiz <= 0)\n\t\treturn -EINVAL;\n\nretry:\n\terror = user_path_at_empty(dfd, pathname, lookup_flags, &path, &empty);\n\tif (!error) {\n\t\tstruct inode *inode = d_backing_inode(path.dentry);\n\n\t\terror = empty ? -ENOENT : -EINVAL;\n\t\t/*\n\t\t * AFS mountpoints allow readlink(2) but are not symlinks\n\t\t */\n\t\tif (d_is_symlink(path.dentry) || inode->i_op->readlink) {\n\t\t\terror = security_inode_readlink(path.dentry);\n\t\t\tif (!error) {\n\t\t\t\ttouch_atime(&path);\n\t\t\t\terror = vfs_readlink(path.dentry, buf, bufsiz);\n\t\t\t}\n\t\t}\n\t\tpath_put(&path);\n\t\tif (retry_estale(error, lookup_flags)) {\n\t\t\tlookup_flags |= LOOKUP_REVAL;\n\t\t\tgoto retry;\n\t\t}\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "cp_new_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "298-333",
    "snippet": "static int cp_new_stat(struct kstat *stat, struct stat __user *statbuf)\n{\n\tstruct stat tmp;\n\n\tif (!valid_dev(stat->dev) || !valid_dev(stat->rdev))\n\t\treturn -EOVERFLOW;\n#if BITS_PER_LONG == 32\n\tif (stat->size > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n#endif\n\n\tINIT_STRUCT_STAT_PADDING(tmp);\n\ttmp.st_dev = encode_dev(stat->dev);\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\tif (tmp.st_nlink != stat->nlink)\n\t\treturn -EOVERFLOW;\n\tSET_UID(tmp.st_uid, from_kuid_munged(current_user_ns(), stat->uid));\n\tSET_GID(tmp.st_gid, from_kgid_munged(current_user_ns(), stat->gid));\n\ttmp.st_rdev = encode_dev(stat->rdev);\n\ttmp.st_size = stat->size;\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n#ifdef STAT_HAVE_NSEC\n\ttmp.st_atime_nsec = stat->atime.tv_nsec;\n\ttmp.st_mtime_nsec = stat->mtime.tv_nsec;\n\ttmp.st_ctime_nsec = stat->ctime.tv_nsec;\n#endif\n\ttmp.st_blocks = stat->blocks;\n\ttmp.st_blksize = stat->blksize;\n\treturn copy_to_user(statbuf,&tmp,sizeof(tmp)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "statbuf",
            "&tmp",
            "sizeof(tmp)"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_GID",
          "args": [
            "tmp.st_gid",
            "from_kgid_munged(current_user_ns(), stat->gid)"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "current_user_ns()",
            "stat->gid"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_UID",
          "args": [
            "tmp.st_uid",
            "from_kuid_munged(current_user_ns(), stat->uid)"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "current_user_ns()",
            "stat->uid"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encode_dev",
          "args": [
            "stat->dev"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_STRUCT_STAT_PADDING",
          "args": [
            "tmp"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valid_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "valid_dev",
          "args": [
            "stat->dev"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int cp_new_stat(struct kstat *stat, struct stat __user *statbuf)\n{\n\tstruct stat tmp;\n\n\tif (!valid_dev(stat->dev) || !valid_dev(stat->rdev))\n\t\treturn -EOVERFLOW;\n#if BITS_PER_LONG == 32\n\tif (stat->size > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n#endif\n\n\tINIT_STRUCT_STAT_PADDING(tmp);\n\ttmp.st_dev = encode_dev(stat->dev);\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\tif (tmp.st_nlink != stat->nlink)\n\t\treturn -EOVERFLOW;\n\tSET_UID(tmp.st_uid, from_kuid_munged(current_user_ns(), stat->uid));\n\tSET_GID(tmp.st_gid, from_kgid_munged(current_user_ns(), stat->gid));\n\ttmp.st_rdev = encode_dev(stat->rdev);\n\ttmp.st_size = stat->size;\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n#ifdef STAT_HAVE_NSEC\n\ttmp.st_atime_nsec = stat->atime.tv_nsec;\n\ttmp.st_mtime_nsec = stat->mtime.tv_nsec;\n\ttmp.st_ctime_nsec = stat->ctime.tv_nsec;\n#endif\n\ttmp.st_blocks = stat->blocks;\n\ttmp.st_blksize = stat->blksize;\n\treturn copy_to_user(statbuf,&tmp,sizeof(tmp)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "cp_old_stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "207-242",
    "snippet": "static int cp_old_stat(struct kstat *stat, struct __old_kernel_stat __user * statbuf)\n{\n\tstatic int warncount = 5;\n\tstruct __old_kernel_stat tmp;\n\n\tif (warncount > 0) {\n\t\twarncount--;\n\t\tprintk(KERN_WARNING \"VFS: Warning: %s using old stat() call. Recompile your binary.\\n\",\n\t\t\tcurrent->comm);\n\t} else if (warncount < 0) {\n\t\t/* it's laughable, but... */\n\t\twarncount = 0;\n\t}\n\n\tmemset(&tmp, 0, sizeof(struct __old_kernel_stat));\n\ttmp.st_dev = old_encode_dev(stat->dev);\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\tif (tmp.st_nlink != stat->nlink)\n\t\treturn -EOVERFLOW;\n\tSET_UID(tmp.st_uid, from_kuid_munged(current_user_ns(), stat->uid));\n\tSET_GID(tmp.st_gid, from_kgid_munged(current_user_ns(), stat->gid));\n\ttmp.st_rdev = old_encode_dev(stat->rdev);\n#if BITS_PER_LONG == 32\n\tif (stat->size > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n#endif\n\ttmp.st_size = stat->size;\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n\treturn copy_to_user(statbuf,&tmp,sizeof(tmp)) ? -EFAULT : 0;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "statbuf",
            "&tmp",
            "sizeof(tmp)"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_encode_dev",
          "args": [
            "stat->rdev"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_GID",
          "args": [
            "tmp.st_gid",
            "from_kgid_munged(current_user_ns(), stat->gid)"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "current_user_ns()",
            "stat->gid"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_UID",
          "args": [
            "tmp.st_uid",
            "from_kuid_munged(current_user_ns(), stat->uid)"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "current_user_ns()",
            "stat->uid"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old_encode_dev",
          "args": [
            "stat->dev"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&tmp",
            "0",
            "sizeof(struct __old_kernel_stat)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"VFS: Warning: %s using old stat() call. Recompile your binary.\\n\"",
            "current->comm"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "cachefiles_printk_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/cachefiles/namei.c",
          "lines": "74-81",
          "snippet": "static noinline void cachefiles_printk_object(struct cachefiles_object *object,\n\t\t\t\t\t      struct cachefiles_object *xobject)\n{\n\tif (object)\n\t\t__cachefiles_printk_object(object, \"\");\n\tif (xobject)\n\t\t__cachefiles_printk_object(xobject, \"x\");\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/quotaops.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n\nstatic noinline void cachefiles_printk_object(struct cachefiles_object *object,\n\t\t\t\t\t      struct cachefiles_object *xobject)\n{\n\tif (object)\n\t\t__cachefiles_printk_object(object, \"\");\n\tif (xobject)\n\t\t__cachefiles_printk_object(xobject, \"x\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstatic int cp_old_stat(struct kstat *stat, struct __old_kernel_stat __user * statbuf)\n{\n\tstatic int warncount = 5;\n\tstruct __old_kernel_stat tmp;\n\n\tif (warncount > 0) {\n\t\twarncount--;\n\t\tprintk(KERN_WARNING \"VFS: Warning: %s using old stat() call. Recompile your binary.\\n\",\n\t\t\tcurrent->comm);\n\t} else if (warncount < 0) {\n\t\t/* it's laughable, but... */\n\t\twarncount = 0;\n\t}\n\n\tmemset(&tmp, 0, sizeof(struct __old_kernel_stat));\n\ttmp.st_dev = old_encode_dev(stat->dev);\n\ttmp.st_ino = stat->ino;\n\tif (sizeof(tmp.st_ino) < sizeof(stat->ino) && tmp.st_ino != stat->ino)\n\t\treturn -EOVERFLOW;\n\ttmp.st_mode = stat->mode;\n\ttmp.st_nlink = stat->nlink;\n\tif (tmp.st_nlink != stat->nlink)\n\t\treturn -EOVERFLOW;\n\tSET_UID(tmp.st_uid, from_kuid_munged(current_user_ns(), stat->uid));\n\tSET_GID(tmp.st_gid, from_kgid_munged(current_user_ns(), stat->gid));\n\ttmp.st_rdev = old_encode_dev(stat->rdev);\n#if BITS_PER_LONG == 32\n\tif (stat->size > MAX_NON_LFS)\n\t\treturn -EOVERFLOW;\n#endif\n\ttmp.st_size = stat->size;\n\ttmp.st_atime = stat->atime.tv_sec;\n\ttmp.st_mtime = stat->mtime.tv_sec;\n\ttmp.st_ctime = stat->ctime.tv_sec;\n\treturn copy_to_user(statbuf,&tmp,sizeof(tmp)) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "vfs_statx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "166-197",
    "snippet": "int vfs_statx(int dfd, const char __user *filename, int flags,\n\t      struct kstat *stat, u32 request_mask)\n{\n\tstruct path path;\n\tint error = -EINVAL;\n\tunsigned int lookup_flags = LOOKUP_FOLLOW | LOOKUP_AUTOMOUNT;\n\n\tif ((flags & ~(AT_SYMLINK_NOFOLLOW | AT_NO_AUTOMOUNT |\n\t\t       AT_EMPTY_PATH | KSTAT_QUERY_FLAGS)) != 0)\n\t\treturn -EINVAL;\n\n\tif (flags & AT_SYMLINK_NOFOLLOW)\n\t\tlookup_flags &= ~LOOKUP_FOLLOW;\n\tif (flags & AT_NO_AUTOMOUNT)\n\t\tlookup_flags &= ~LOOKUP_AUTOMOUNT;\n\tif (flags & AT_EMPTY_PATH)\n\t\tlookup_flags |= LOOKUP_EMPTY;\n\nretry:\n\terror = user_path_at(dfd, filename, lookup_flags, &path);\n\tif (error)\n\t\tgoto out;\n\n\terror = vfs_getattr(&path, stat, request_mask, flags);\n\tpath_put(&path);\n\tif (retry_estale(error, lookup_flags)) {\n\t\tlookup_flags |= LOOKUP_REVAL;\n\t\tgoto retry;\n\t}\nout:\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "retry_estale",
          "args": [
            "error",
            "lookup_flags"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path_put",
          "args": [
            "&path"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "path_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/namei.c",
          "lines": "482-486",
          "snippet": "void path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}",
          "includes": [
            "#include <asm/word-at-a-time.h>",
            "#include \"mount.h\"",
            "#include \"internal.h\"",
            "#include <linux/build_bug.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/init_task.h>",
            "#include <linux/bitops.h>",
            "#include <linux/hash.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/device_cgroup.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ima.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/word-at-a-time.h>\n#include \"mount.h\"\n#include \"internal.h\"\n#include <linux/build_bug.h>\n#include <linux/uaccess.h>\n#include <linux/init_task.h>\n#include <linux/bitops.h>\n#include <linux/hash.h>\n#include <linux/posix_acl.h>\n#include <linux/fs_struct.h>\n#include <linux/device_cgroup.h>\n#include <linux/fcntl.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/syscalls.h>\n#include <linux/ima.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fsnotify.h>\n#include <linux/pagemap.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n#include <linux/init.h>\n\nvoid path_put(const struct path *path)\n{\n\tdput(path->dentry);\n\tmntput(path->mnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "vfs_getattr",
          "args": [
            "&path",
            "stat",
            "request_mask",
            "flags"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_getattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
          "lines": "108-117",
          "snippet": "int vfs_getattr(const struct path *path, struct kstat *stat,\n\t\tu32 request_mask, unsigned int query_flags)\n{\n\tint retval;\n\n\tretval = security_inode_getattr(path);\n\tif (retval)\n\t\treturn retval;\n\treturn vfs_getattr_nosec(path, stat, request_mask, query_flags);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint vfs_getattr(const struct path *path, struct kstat *stat,\n\t\tu32 request_mask, unsigned int query_flags)\n{\n\tint retval;\n\n\tretval = security_inode_getattr(path);\n\tif (retval)\n\t\treturn retval;\n\treturn vfs_getattr_nosec(path, stat, request_mask, query_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_path_at",
          "args": [
            "dfd",
            "filename",
            "lookup_flags",
            "&path"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint vfs_statx(int dfd, const char __user *filename, int flags,\n\t      struct kstat *stat, u32 request_mask)\n{\n\tstruct path path;\n\tint error = -EINVAL;\n\tunsigned int lookup_flags = LOOKUP_FOLLOW | LOOKUP_AUTOMOUNT;\n\n\tif ((flags & ~(AT_SYMLINK_NOFOLLOW | AT_NO_AUTOMOUNT |\n\t\t       AT_EMPTY_PATH | KSTAT_QUERY_FLAGS)) != 0)\n\t\treturn -EINVAL;\n\n\tif (flags & AT_SYMLINK_NOFOLLOW)\n\t\tlookup_flags &= ~LOOKUP_FOLLOW;\n\tif (flags & AT_NO_AUTOMOUNT)\n\t\tlookup_flags &= ~LOOKUP_AUTOMOUNT;\n\tif (flags & AT_EMPTY_PATH)\n\t\tlookup_flags |= LOOKUP_EMPTY;\n\nretry:\n\terror = user_path_at(dfd, filename, lookup_flags, &path);\n\tif (error)\n\t\tgoto out;\n\n\terror = vfs_getattr(&path, stat, request_mask, flags);\n\tpath_put(&path);\n\tif (retry_estale(error, lookup_flags)) {\n\t\tlookup_flags |= LOOKUP_REVAL;\n\t\tgoto retry;\n\t}\nout:\n\treturn error;\n}"
  },
  {
    "function_name": "vfs_statx_fd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "132-148",
    "snippet": "int vfs_statx_fd(unsigned int fd, struct kstat *stat,\n\t\t u32 request_mask, unsigned int query_flags)\n{\n\tstruct fd f;\n\tint error = -EBADF;\n\n\tif (query_flags & ~KSTAT_QUERY_FLAGS)\n\t\treturn -EINVAL;\n\n\tf = fdget_raw(fd);\n\tif (f.file) {\n\t\terror = vfs_getattr(&f.file->f_path, stat,\n\t\t\t\t    request_mask, query_flags);\n\t\tfdput(f);\n\t}\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfs_getattr",
          "args": [
            "&f.file->f_path",
            "stat",
            "request_mask",
            "query_flags"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_getattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
          "lines": "108-117",
          "snippet": "int vfs_getattr(const struct path *path, struct kstat *stat,\n\t\tu32 request_mask, unsigned int query_flags)\n{\n\tint retval;\n\n\tretval = security_inode_getattr(path);\n\tif (retval)\n\t\treturn retval;\n\treturn vfs_getattr_nosec(path, stat, request_mask, query_flags);\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint vfs_getattr(const struct path *path, struct kstat *stat,\n\t\tu32 request_mask, unsigned int query_flags)\n{\n\tint retval;\n\n\tretval = security_inode_getattr(path);\n\tif (retval)\n\t\treturn retval;\n\treturn vfs_getattr_nosec(path, stat, request_mask, query_flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdget_raw",
          "args": [
            "fd"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "__fdget_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/file.c",
          "lines": "753-756",
          "snippet": "unsigned long __fdget_raw(unsigned int fd)\n{\n\treturn __fget_light(fd, 0);\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nunsigned long __fdget_raw(unsigned int fd)\n{\n\treturn __fget_light(fd, 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint vfs_statx_fd(unsigned int fd, struct kstat *stat,\n\t\t u32 request_mask, unsigned int query_flags)\n{\n\tstruct fd f;\n\tint error = -EBADF;\n\n\tif (query_flags & ~KSTAT_QUERY_FLAGS)\n\t\treturn -EINVAL;\n\n\tf = fdget_raw(fd);\n\tif (f.file) {\n\t\terror = vfs_getattr(&f.file->f_path, stat,\n\t\t\t\t    request_mask, query_flags);\n\t\tfdput(f);\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "vfs_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "108-117",
    "snippet": "int vfs_getattr(const struct path *path, struct kstat *stat,\n\t\tu32 request_mask, unsigned int query_flags)\n{\n\tint retval;\n\n\tretval = security_inode_getattr(path);\n\tif (retval)\n\t\treturn retval;\n\treturn vfs_getattr_nosec(path, stat, request_mask, query_flags);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfs_getattr_nosec",
          "args": [
            "path",
            "stat",
            "request_mask",
            "query_flags"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_getattr_nosec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
          "lines": "69-84",
          "snippet": "int vfs_getattr_nosec(const struct path *path, struct kstat *stat,\n\t\t      u32 request_mask, unsigned int query_flags)\n{\n\tstruct inode *inode = d_backing_inode(path->dentry);\n\n\tmemset(stat, 0, sizeof(*stat));\n\tstat->result_mask |= STATX_BASIC_STATS;\n\trequest_mask &= STATX_ALL;\n\tquery_flags &= KSTAT_QUERY_FLAGS;\n\tif (inode->i_op->getattr)\n\t\treturn inode->i_op->getattr(path, stat, request_mask,\n\t\t\t\t\t    query_flags);\n\n\tgeneric_fillattr(inode, stat);\n\treturn 0;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint vfs_getattr_nosec(const struct path *path, struct kstat *stat,\n\t\t      u32 request_mask, unsigned int query_flags)\n{\n\tstruct inode *inode = d_backing_inode(path->dentry);\n\n\tmemset(stat, 0, sizeof(*stat));\n\tstat->result_mask |= STATX_BASIC_STATS;\n\trequest_mask &= STATX_ALL;\n\tquery_flags &= KSTAT_QUERY_FLAGS;\n\tif (inode->i_op->getattr)\n\t\treturn inode->i_op->getattr(path, stat, request_mask,\n\t\t\t\t\t    query_flags);\n\n\tgeneric_fillattr(inode, stat);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_inode_getattr",
          "args": [
            "path"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint vfs_getattr(const struct path *path, struct kstat *stat,\n\t\tu32 request_mask, unsigned int query_flags)\n{\n\tint retval;\n\n\tretval = security_inode_getattr(path);\n\tif (retval)\n\t\treturn retval;\n\treturn vfs_getattr_nosec(path, stat, request_mask, query_flags);\n}"
  },
  {
    "function_name": "vfs_getattr_nosec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "69-84",
    "snippet": "int vfs_getattr_nosec(const struct path *path, struct kstat *stat,\n\t\t      u32 request_mask, unsigned int query_flags)\n{\n\tstruct inode *inode = d_backing_inode(path->dentry);\n\n\tmemset(stat, 0, sizeof(*stat));\n\tstat->result_mask |= STATX_BASIC_STATS;\n\trequest_mask &= STATX_ALL;\n\tquery_flags &= KSTAT_QUERY_FLAGS;\n\tif (inode->i_op->getattr)\n\t\treturn inode->i_op->getattr(path, stat, request_mask,\n\t\t\t\t\t    query_flags);\n\n\tgeneric_fillattr(inode, stat);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generic_fillattr",
          "args": [
            "inode",
            "stat"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "generic_fillattr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
          "lines": "33-53",
          "snippet": "void generic_fillattr(struct inode *inode, struct kstat *stat)\n{\n\tstat->dev = inode->i_sb->s_dev;\n\tstat->ino = inode->i_ino;\n\tstat->mode = inode->i_mode;\n\tstat->nlink = inode->i_nlink;\n\tstat->uid = inode->i_uid;\n\tstat->gid = inode->i_gid;\n\tstat->rdev = inode->i_rdev;\n\tstat->size = i_size_read(inode);\n\tstat->atime = inode->i_atime;\n\tstat->mtime = inode->i_mtime;\n\tstat->ctime = inode->i_ctime;\n\tstat->blksize = i_blocksize(inode);\n\tstat->blocks = inode->i_blocks;\n\n\tif (IS_NOATIME(inode))\n\t\tstat->result_mask &= ~STATX_ATIME;\n\tif (IS_AUTOMOUNT(inode))\n\t\tstat->attributes |= STATX_ATTR_AUTOMOUNT;\n}",
          "includes": [
            "#include <asm/unistd.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/compat.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/fs.h>",
            "#include <linux/highuid.h>",
            "#include <linux/file.h>",
            "#include <linux/errno.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid generic_fillattr(struct inode *inode, struct kstat *stat)\n{\n\tstat->dev = inode->i_sb->s_dev;\n\tstat->ino = inode->i_ino;\n\tstat->mode = inode->i_mode;\n\tstat->nlink = inode->i_nlink;\n\tstat->uid = inode->i_uid;\n\tstat->gid = inode->i_gid;\n\tstat->rdev = inode->i_rdev;\n\tstat->size = i_size_read(inode);\n\tstat->atime = inode->i_atime;\n\tstat->mtime = inode->i_mtime;\n\tstat->ctime = inode->i_ctime;\n\tstat->blksize = i_blocksize(inode);\n\tstat->blocks = inode->i_blocks;\n\n\tif (IS_NOATIME(inode))\n\t\tstat->result_mask &= ~STATX_ATIME;\n\tif (IS_AUTOMOUNT(inode))\n\t\tstat->attributes |= STATX_ATTR_AUTOMOUNT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode->i_op->getattr",
          "args": [
            "path",
            "stat",
            "request_mask",
            "query_flags"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "stat",
            "0",
            "sizeof(*stat)"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_backing_inode",
          "args": [
            "path->dentry"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nint vfs_getattr_nosec(const struct path *path, struct kstat *stat,\n\t\t      u32 request_mask, unsigned int query_flags)\n{\n\tstruct inode *inode = d_backing_inode(path->dentry);\n\n\tmemset(stat, 0, sizeof(*stat));\n\tstat->result_mask |= STATX_BASIC_STATS;\n\trequest_mask &= STATX_ALL;\n\tquery_flags &= KSTAT_QUERY_FLAGS;\n\tif (inode->i_op->getattr)\n\t\treturn inode->i_op->getattr(path, stat, request_mask,\n\t\t\t\t\t    query_flags);\n\n\tgeneric_fillattr(inode, stat);\n\treturn 0;\n}"
  },
  {
    "function_name": "generic_fillattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "33-53",
    "snippet": "void generic_fillattr(struct inode *inode, struct kstat *stat)\n{\n\tstat->dev = inode->i_sb->s_dev;\n\tstat->ino = inode->i_ino;\n\tstat->mode = inode->i_mode;\n\tstat->nlink = inode->i_nlink;\n\tstat->uid = inode->i_uid;\n\tstat->gid = inode->i_gid;\n\tstat->rdev = inode->i_rdev;\n\tstat->size = i_size_read(inode);\n\tstat->atime = inode->i_atime;\n\tstat->mtime = inode->i_mtime;\n\tstat->ctime = inode->i_ctime;\n\tstat->blksize = i_blocksize(inode);\n\tstat->blocks = inode->i_blocks;\n\n\tif (IS_NOATIME(inode))\n\t\tstat->result_mask &= ~STATX_ATIME;\n\tif (IS_AUTOMOUNT(inode))\n\t\tstat->attributes |= STATX_ATTR_AUTOMOUNT;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_AUTOMOUNT",
          "args": [
            "inode"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_NOATIME",
          "args": [
            "inode"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_blocksize",
          "args": [
            "inode"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid generic_fillattr(struct inode *inode, struct kstat *stat)\n{\n\tstat->dev = inode->i_sb->s_dev;\n\tstat->ino = inode->i_ino;\n\tstat->mode = inode->i_mode;\n\tstat->nlink = inode->i_nlink;\n\tstat->uid = inode->i_uid;\n\tstat->gid = inode->i_gid;\n\tstat->rdev = inode->i_rdev;\n\tstat->size = i_size_read(inode);\n\tstat->atime = inode->i_atime;\n\tstat->mtime = inode->i_mtime;\n\tstat->ctime = inode->i_ctime;\n\tstat->blksize = i_blocksize(inode);\n\tstat->blocks = inode->i_blocks;\n\n\tif (IS_NOATIME(inode))\n\t\tstat->result_mask &= ~STATX_ATIME;\n\tif (IS_AUTOMOUNT(inode))\n\t\tstat->attributes |= STATX_ATTR_AUTOMOUNT;\n}"
  },
  {
    "function_name": "stat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "244-255",
    "snippet": "SYSCALL_DEFINE2(stat, const char __user *, filename,\n\t\tstruct __old_kernel_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_stat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\n\treturn cp_old_stat(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(stat, const char __user *, filename,\n\t\tstruct __old_kernel_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_stat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\n\treturn cp_old_stat(&stat, statbuf);\n}"
  },
  {
    "function_name": "lstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "257-268",
    "snippet": "SYSCALL_DEFINE2(lstat, const char __user *, filename,\n\t\tstruct __old_kernel_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_lstat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\n\treturn cp_old_stat(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(lstat, const char __user *, filename,\n\t\tstruct __old_kernel_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_lstat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\n\treturn cp_old_stat(&stat, statbuf);\n}"
  },
  {
    "function_name": "fstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "270-279",
    "snippet": "SYSCALL_DEFINE2(fstat, unsigned int, fd, struct __old_kernel_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_fstat(fd, &stat);\n\n\tif (!error)\n\t\terror = cp_old_stat(&stat, statbuf);\n\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(fstat, unsigned int, fd, struct __old_kernel_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_fstat(fd, &stat);\n\n\tif (!error)\n\t\terror = cp_old_stat(&stat, statbuf);\n\n\treturn error;\n}"
  },
  {
    "function_name": "newstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "335-344",
    "snippet": "SYSCALL_DEFINE2(newstat, const char __user *, filename,\n\t\tstruct stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_stat(filename, &stat);\n\n\tif (error)\n\t\treturn error;\n\treturn cp_new_stat(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(newstat, const char __user *, filename,\n\t\tstruct stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_stat(filename, &stat);\n\n\tif (error)\n\t\treturn error;\n\treturn cp_new_stat(&stat, statbuf);\n}"
  },
  {
    "function_name": "newlstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "346-357",
    "snippet": "SYSCALL_DEFINE2(newlstat, const char __user *, filename,\n\t\tstruct stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_lstat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\n\treturn cp_new_stat(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(newlstat, const char __user *, filename,\n\t\tstruct stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_lstat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\n\treturn cp_new_stat(&stat, statbuf);\n}"
  },
  {
    "function_name": "newfstatat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "360-370",
    "snippet": "SYSCALL_DEFINE4(newfstatat, int, dfd, const char __user *, filename,\n\t\tstruct stat __user *, statbuf, int, flag)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_fstatat(dfd, filename, &stat, flag);\n\tif (error)\n\t\treturn error;\n\treturn cp_new_stat(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE4(newfstatat, int, dfd, const char __user *, filename,\n\t\tstruct stat __user *, statbuf, int, flag)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_fstatat(dfd, filename, &stat, flag);\n\tif (error)\n\t\treturn error;\n\treturn cp_new_stat(&stat, statbuf);\n}"
  },
  {
    "function_name": "newfstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "373-382",
    "snippet": "SYSCALL_DEFINE2(newfstat, unsigned int, fd, struct stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_fstat(fd, &stat);\n\n\tif (!error)\n\t\terror = cp_new_stat(&stat, statbuf);\n\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(newfstat, unsigned int, fd, struct stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_fstat(fd, &stat);\n\n\tif (!error)\n\t\terror = cp_new_stat(&stat, statbuf);\n\n\treturn error;\n}"
  },
  {
    "function_name": "readlinkat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "421-425",
    "snippet": "SYSCALL_DEFINE4(readlinkat, int, dfd, const char __user *, pathname,\n\t\tchar __user *, buf, int, bufsiz)\n{\n\treturn do_readlinkat(dfd, pathname, buf, bufsiz);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE4(readlinkat, int, dfd, const char __user *, pathname,\n\t\tchar __user *, buf, int, bufsiz)\n{\n\treturn do_readlinkat(dfd, pathname, buf, bufsiz);\n}"
  },
  {
    "function_name": "readlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "427-431",
    "snippet": "SYSCALL_DEFINE3(readlink, const char __user *, path, char __user *, buf,\n\t\tint, bufsiz)\n{\n\treturn do_readlinkat(AT_FDCWD, path, buf, bufsiz);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE3(readlink, const char __user *, path, char __user *, buf,\n\t\tint, bufsiz)\n{\n\treturn do_readlinkat(AT_FDCWD, path, buf, bufsiz);\n}"
  },
  {
    "function_name": "stat64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "476-486",
    "snippet": "SYSCALL_DEFINE2(stat64, const char __user *, filename,\n\t\tstruct stat64 __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_stat(filename, &stat);\n\n\tif (!error)\n\t\terror = cp_new_stat64(&stat, statbuf);\n\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(stat64, const char __user *, filename,\n\t\tstruct stat64 __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_stat(filename, &stat);\n\n\tif (!error)\n\t\terror = cp_new_stat64(&stat, statbuf);\n\n\treturn error;\n}"
  },
  {
    "function_name": "lstat64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "488-498",
    "snippet": "SYSCALL_DEFINE2(lstat64, const char __user *, filename,\n\t\tstruct stat64 __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_lstat(filename, &stat);\n\n\tif (!error)\n\t\terror = cp_new_stat64(&stat, statbuf);\n\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(lstat64, const char __user *, filename,\n\t\tstruct stat64 __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_lstat(filename, &stat);\n\n\tif (!error)\n\t\terror = cp_new_stat64(&stat, statbuf);\n\n\treturn error;\n}"
  },
  {
    "function_name": "fstat64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "500-509",
    "snippet": "SYSCALL_DEFINE2(fstat64, unsigned long, fd, struct stat64 __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_fstat(fd, &stat);\n\n\tif (!error)\n\t\terror = cp_new_stat64(&stat, statbuf);\n\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(fstat64, unsigned long, fd, struct stat64 __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_fstat(fd, &stat);\n\n\tif (!error)\n\t\terror = cp_new_stat64(&stat, statbuf);\n\n\treturn error;\n}"
  },
  {
    "function_name": "fstatat64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "511-521",
    "snippet": "SYSCALL_DEFINE4(fstatat64, int, dfd, const char __user *, filename,\n\t\tstruct stat64 __user *, statbuf, int, flag)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_fstatat(dfd, filename, &stat, flag);\n\tif (error)\n\t\treturn error;\n\treturn cp_new_stat64(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE4(fstatat64, int, dfd, const char __user *, filename,\n\t\tstruct stat64 __user *, statbuf, int, flag)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_fstatat(dfd, filename, &stat, flag);\n\tif (error)\n\t\treturn error;\n\treturn cp_new_stat64(&stat, statbuf);\n}"
  },
  {
    "function_name": "statx",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "569-587",
    "snippet": "SYSCALL_DEFINE5(statx,\n\t\tint, dfd, const char __user *, filename, unsigned, flags,\n\t\tunsigned int, mask,\n\t\tstruct statx __user *, buffer)\n{\n\tstruct kstat stat;\n\tint error;\n\n\tif (mask & STATX__RESERVED)\n\t\treturn -EINVAL;\n\tif ((flags & AT_STATX_SYNC_TYPE) == AT_STATX_SYNC_TYPE)\n\t\treturn -EINVAL;\n\n\terror = vfs_statx(dfd, filename, flags, &stat, mask);\n\tif (error)\n\t\treturn error;\n\n\treturn cp_statx(&stat, buffer);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE5(statx,\n\t\tint, dfd, const char __user *, filename, unsigned, flags,\n\t\tunsigned int, mask,\n\t\tstruct statx __user *, buffer)\n{\n\tstruct kstat stat;\n\tint error;\n\n\tif (mask & STATX__RESERVED)\n\t\treturn -EINVAL;\n\tif ((flags & AT_STATX_SYNC_TYPE) == AT_STATX_SYNC_TYPE)\n\t\treturn -EINVAL;\n\n\terror = vfs_statx(dfd, filename, flags, &stat, mask);\n\tif (error)\n\t\treturn error;\n\n\treturn cp_statx(&stat, buffer);\n}"
  },
  {
    "function_name": "newstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "623-633",
    "snippet": "SYSCALL_DEFINE2(newstat, const char __user *, filename,\n\t\t       struct compat_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_stat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\treturn cp_compat_stat(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(newstat, const char __user *, filename,\n\t\t       struct compat_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_stat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\treturn cp_compat_stat(&stat, statbuf);\n}"
  },
  {
    "function_name": "newlstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "635-645",
    "snippet": "SYSCALL_DEFINE2(newlstat, const char __user *, filename,\n\t\t       struct compat_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_lstat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\treturn cp_compat_stat(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(newlstat, const char __user *, filename,\n\t\t       struct compat_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_lstat(filename, &stat);\n\tif (error)\n\t\treturn error;\n\treturn cp_compat_stat(&stat, statbuf);\n}"
  },
  {
    "function_name": "newfstatat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "648-659",
    "snippet": "SYSCALL_DEFINE4(newfstatat, unsigned int, dfd,\n\t\t       const char __user *, filename,\n\t\t       struct compat_stat __user *, statbuf, int, flag)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_fstatat(dfd, filename, &stat, flag);\n\tif (error)\n\t\treturn error;\n\treturn cp_compat_stat(&stat, statbuf);\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE4(newfstatat, unsigned int, dfd,\n\t\t       const char __user *, filename,\n\t\t       struct compat_stat __user *, statbuf, int, flag)\n{\n\tstruct kstat stat;\n\tint error;\n\n\terror = vfs_fstatat(dfd, filename, &stat, flag);\n\tif (error)\n\t\treturn error;\n\treturn cp_compat_stat(&stat, statbuf);\n}"
  },
  {
    "function_name": "newfstat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/stat.c",
    "lines": "662-671",
    "snippet": "SYSCALL_DEFINE2(newfstat, unsigned int, fd,\n\t\t       struct compat_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_fstat(fd, &stat);\n\n\tif (!error)\n\t\terror = cp_compat_stat(&stat, statbuf);\n\treturn error;\n}",
    "includes": [
      "#include <asm/unistd.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/compat.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/cred.h>",
      "#include <linux/security.h>",
      "#include <linux/namei.h>",
      "#include <linux/fs.h>",
      "#include <linux/highuid.h>",
      "#include <linux/file.h>",
      "#include <linux/errno.h>",
      "#include <linux/mm.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/unistd.h>\n#include <linux/uaccess.h>\n#include <linux/compat.h>\n#include <linux/pagemap.h>\n#include <linux/syscalls.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/fs.h>\n#include <linux/highuid.h>\n#include <linux/file.h>\n#include <linux/errno.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nSYSCALL_DEFINE2(newfstat, unsigned int, fd,\n\t\t       struct compat_stat __user *, statbuf)\n{\n\tstruct kstat stat;\n\tint error = vfs_fstat(fd, &stat);\n\n\tif (!error)\n\t\terror = cp_compat_stat(&stat, statbuf);\n\treturn error;\n}"
  }
]