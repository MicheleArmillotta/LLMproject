[
  {
    "function_name": "init_sys32_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "1093-1098",
    "snippet": "static int __init init_sys32_ioctl(void)\n{\n\tsort(ioctl_pointer, ARRAY_SIZE(ioctl_pointer), sizeof(*ioctl_pointer),\n\t\tinit_sys32_ioctl_cmp, NULL);\n\treturn 0;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int ioctl_pointer[] = {\n/* compatible ioctls first */\n/* Little t */\nCOMPATIBLE_IOCTL(TIOCOUTQ)\n/* Little f */\nCOMPATIBLE_IOCTL(FIOCLEX)\nCOMPATIBLE_IOCTL(FIONCLEX)\nCOMPATIBLE_IOCTL(FIOASYNC)\nCOMPATIBLE_IOCTL(FIONBIO)\nCOMPATIBLE_IOCTL(FIONREAD)  /* This is also TIOCINQ */\nCOMPATIBLE_IOCTL(FS_IOC_FIEMAP)\n/* 0x00 */\nCOMPATIBLE_IOCTL(FIBMAP)\nCOMPATIBLE_IOCTL(FIGETBSZ)\n/* 'X' - originally XFS but some now in the VFS */\nCOMPATIBLE_IOCTL(FIFREEZE)\nCOMPATIBLE_IOCTL(FITHAW)\nCOMPATIBLE_IOCTL(FITRIM)\n#ifdef CONFIG_BLOCK\n/* Big S */\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_IDLUN)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORUNLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_TEST_UNIT_READY)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_BUS_NUMBER)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_SEND_COMMAND)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_PROBE_HOST)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_PCI)\n#endif\n/* Big V (don't complain on serial console) */\nIGNORE_IOCTL(VT_OPENQRY)\nIGNORE_IOCTL(VT_GETMODE)\n/* Little p (/dev/rtc, /dev/envctrl, etc.) */\nCOMPATIBLE_IOCTL(RTC_AIE_ON)\nCOMPATIBLE_IOCTL(RTC_AIE_OFF)\nCOMPATIBLE_IOCTL(RTC_UIE_ON)\nCOMPATIBLE_IOCTL(RTC_UIE_OFF)\nCOMPATIBLE_IOCTL(RTC_PIE_ON)\nCOMPATIBLE_IOCTL(RTC_PIE_OFF)\nCOMPATIBLE_IOCTL(RTC_WIE_ON)\nCOMPATIBLE_IOCTL(RTC_WIE_OFF)\nCOMPATIBLE_IOCTL(RTC_ALM_SET)\nCOMPATIBLE_IOCTL(RTC_ALM_READ)\nCOMPATIBLE_IOCTL(RTC_RD_TIME)\nCOMPATIBLE_IOCTL(RTC_SET_TIME)\nCOMPATIBLE_IOCTL(RTC_WKALM_SET)\nCOMPATIBLE_IOCTL(RTC_WKALM_RD)\n/*\n * These two are only for the sbus rtc driver, but\n * hwclock tries them on every rtc device first when\n * running on sparc.  On other architectures the entries\n * are useless but harmless.\n */\nCOMPATIBLE_IOCTL(_IOR('p', 20, int[7])) /* RTCGET */\nCOMPATIBLE_IOCTL(_IOW('p', 21, int[7])) /* RTCSET */\n/* Little m */\nCOMPATIBLE_IOCTL(MTIOCTOP)\n/* Socket level stuff */\nCOMPATIBLE_IOCTL(FIOQSIZE)\n#ifdef CONFIG_BLOCK\n/* md calls this on random blockdevs */\nIGNORE_IOCTL(RAID_VERSION)\n/* qemu/qemu-img might call these two on plain files for probing */\nIGNORE_IOCTL(CDROM_DRIVE_STATUS)\nIGNORE_IOCTL(FDGETPRM32)\n/* SG stuff */\nCOMPATIBLE_IOCTL(SG_SET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_GET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_EMULATED_HOST)\nCOMPATIBLE_IOCTL(SG_GET_TRANSFORM)\nCOMPATIBLE_IOCTL(SG_SET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_SCSI_ID)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_GET_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_NUM_WAITING)\nCOMPATIBLE_IOCTL(SG_SET_DEBUG)\nCOMPATIBLE_IOCTL(SG_GET_SG_TABLESIZE)\nCOMPATIBLE_IOCTL(SG_GET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_SET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_GET_VERSION_NUM)\nCOMPATIBLE_IOCTL(SG_NEXT_CMD_LEN)\nCOMPATIBLE_IOCTL(SG_SCSI_RESET)\nCOMPATIBLE_IOCTL(SG_GET_REQUEST_TABLE)\nCOMPATIBLE_IOCTL(SG_SET_KEEP_ORPHAN)\nCOMPATIBLE_IOCTL(SG_GET_KEEP_ORPHAN)\n#endif\n/* PPP stuff */\nCOMPATIBLE_IOCTL(PPPIOCGFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCSFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCGASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGUNIT)\nCOMPATIBLE_IOCTL(PPPIOCGRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMAXCID)\nCOMPATIBLE_IOCTL(PPPIOCGXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCXFERUNIT)\n/* PPPIOCSCOMPRESS is translated */\nCOMPATIBLE_IOCTL(PPPIOCGNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCSNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCGDEBUG)\nCOMPATIBLE_IOCTL(PPPIOCSDEBUG)\n/* PPPIOCSPASS is translated */\n/* PPPIOCSACTIVE is translated */\n/* PPPIOCGIDLE is translated */\nCOMPATIBLE_IOCTL(PPPIOCNEWUNIT)\nCOMPATIBLE_IOCTL(PPPIOCATTACH)\nCOMPATIBLE_IOCTL(PPPIOCDETACH)\nCOMPATIBLE_IOCTL(PPPIOCSMRRU)\nCOMPATIBLE_IOCTL(PPPIOCCONNECT)\nCOMPATIBLE_IOCTL(PPPIOCDISCONN)\nCOMPATIBLE_IOCTL(PPPIOCATTCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGL2TPSTATS)\n/* PPPOX */\nCOMPATIBLE_IOCTL(PPPOEIOCSFWD)\nCOMPATIBLE_IOCTL(PPPOEIOCDFWD)\n/* Big A */\n/* sparc only */\n/* Big Q for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_CTRLRATE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETOUTCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETINCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PERCMODE)\nCOMPATIBLE_IOCTL(SNDCTL_FM_LOAD_INSTR)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_TESTMIDI)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESETSAMPLES)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRSYNTHS)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRMIDIS)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_THRESHOLD)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_MEMAVL)\nCOMPATIBLE_IOCTL(SNDCTL_FM_4OP_ENABLE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PANIC)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_OUTOFBAND)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETTIME)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_ID)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_CONTROL)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_REMOVESAMPLE)\n/* Big T for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TIMEBASE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_START)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_STOP)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_CONTINUE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TEMPO)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SOURCE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_METRONOME)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SELECT)\n/* Little m for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_PRETIME)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUMODE)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUCMD)\n/* Big P for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SPEED)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_STEREO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETBLKSIZE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_WRITE_FILTER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_POST)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SUBDIVIDE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFRAGMENT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETFMTS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFMT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOSPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETISPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_NONBLOCK)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETCAPS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETIPTR)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOPTR)\n/* SNDCTL_DSP_MAPINBUF,  XXX needs translation */\n/* SNDCTL_DSP_MAPOUTBUF,  XXX needs translation */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETSYNCRO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETDUPLEX)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETODELAY)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_PROFILE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_RATE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_BITS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_FILTER)\n/* Big C for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_LOAD)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RUN)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_HALT)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_SENDMSG)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCVMSG)\n/* Big M for sound/OSS */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE3)\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MUTE)\n/* SOUND_MIXER_READ_ENHANCE,  same value as READ_MUTE */\n/* SOUND_MIXER_READ_LOUD,  same value as READ_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_DEVMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_STEREODEVS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CAPS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE3)\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MUTE)\n/* SOUND_MIXER_WRITE_ENHANCE,  same value as WRITE_MUTE */\n/* SOUND_MIXER_WRITE_LOUD,  same value as WRITE_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_OLD_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_MIXER_ACCESS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_AGC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_3DSE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE3)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE4)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE5)\nCOMPATIBLE_IOCTL(SOUND_MIXER_GETLEVELS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_SETLEVELS)\nCOMPATIBLE_IOCTL(OSS_GETVERSION)\n/* Raw devices */\nCOMPATIBLE_IOCTL(RAW_SETBIND)\nCOMPATIBLE_IOCTL(RAW_GETBIND)\n/* Watchdog */\nCOMPATIBLE_IOCTL(WDIOC_GETSUPPORT)\nCOMPATIBLE_IOCTL(WDIOC_GETSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETBOOTSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETTEMP)\nCOMPATIBLE_IOCTL(WDIOC_SETOPTIONS)\nCOMPATIBLE_IOCTL(WDIOC_KEEPALIVE)\nCOMPATIBLE_IOCTL(WDIOC_SETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_SETPRETIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETPRETIMEOUT)\n/* Big R */\nCOMPATIBLE_IOCTL(RNDGETENTCNT)\nCOMPATIBLE_IOCTL(RNDADDTOENTCNT)\nCOMPATIBLE_IOCTL(RNDGETPOOL)\nCOMPATIBLE_IOCTL(RNDADDENTROPY)\nCOMPATIBLE_IOCTL(RNDZAPENTCNT)\nCOMPATIBLE_IOCTL(RNDCLEARPOOL)\n/* Bluetooth */\nCOMPATIBLE_IOCTL(HCIDEVUP)\nCOMPATIBLE_IOCTL(HCIDEVDOWN)\nCOMPATIBLE_IOCTL(HCIDEVRESET)\nCOMPATIBLE_IOCTL(HCIDEVRESTAT)\nCOMPATIBLE_IOCTL(HCIGETDEVLIST)\nCOMPATIBLE_IOCTL(HCIGETDEVINFO)\nCOMPATIBLE_IOCTL(HCIGETCONNLIST)\nCOMPATIBLE_IOCTL(HCIGETCONNINFO)\nCOMPATIBLE_IOCTL(HCIGETAUTHINFO)\nCOMPATIBLE_IOCTL(HCISETRAW)\nCOMPATIBLE_IOCTL(HCISETSCAN)\nCOMPATIBLE_IOCTL(HCISETAUTH)\nCOMPATIBLE_IOCTL(HCISETENCRYPT)\nCOMPATIBLE_IOCTL(HCISETPTYPE)\nCOMPATIBLE_IOCTL(HCISETLINKPOL)\nCOMPATIBLE_IOCTL(HCISETLINKMODE)\nCOMPATIBLE_IOCTL(HCISETACLMTU)\nCOMPATIBLE_IOCTL(HCISETSCOMTU)\nCOMPATIBLE_IOCTL(HCIBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIUNBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIINQUIRY)\nCOMPATIBLE_IOCTL(HCIUARTSETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETDEVICE)\nCOMPATIBLE_IOCTL(HCIUARTSETFLAGS)\nCOMPATIBLE_IOCTL(HCIUARTGETFLAGS)\nCOMPATIBLE_IOCTL(RFCOMMCREATEDEV)\nCOMPATIBLE_IOCTL(RFCOMMRELEASEDEV)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVLIST)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVINFO)\nCOMPATIBLE_IOCTL(RFCOMMSTEALDLC)\n/* CAPI */\nCOMPATIBLE_IOCTL(CAPI_REGISTER)\nCOMPATIBLE_IOCTL(CAPI_GET_MANUFACTURER)\nCOMPATIBLE_IOCTL(CAPI_GET_VERSION)\nCOMPATIBLE_IOCTL(CAPI_GET_SERIAL)\nCOMPATIBLE_IOCTL(CAPI_GET_PROFILE)\nCOMPATIBLE_IOCTL(CAPI_MANUFACTURER_CMD)\nCOMPATIBLE_IOCTL(CAPI_GET_ERRCODE)\nCOMPATIBLE_IOCTL(CAPI_INSTALLED)\nCOMPATIBLE_IOCTL(CAPI_GET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_SET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_CLR_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_NCCI_OPENCOUNT)\nCOMPATIBLE_IOCTL(CAPI_NCCI_GETUNIT)\n/* Misc. */\nCOMPATIBLE_IOCTL(0x41545900)\t\t/* ATYIO_CLKR */\nCOMPATIBLE_IOCTL(0x41545901)\t\t/* ATYIO_CLKW */\nCOMPATIBLE_IOCTL(PCIIOC_CONTROLLER)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_IO)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_MEM)\nCOMPATIBLE_IOCTL(PCIIOC_WRITE_COMBINE)\n/* hiddev */\nCOMPATIBLE_IOCTL(HIDIOCGVERSION)\nCOMPATIBLE_IOCTL(HIDIOCAPPLICATION)\nCOMPATIBLE_IOCTL(HIDIOCGDEVINFO)\nCOMPATIBLE_IOCTL(HIDIOCGSTRING)\nCOMPATIBLE_IOCTL(HIDIOCINITREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORT)\nCOMPATIBLE_IOCTL(HIDIOCSREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORTINFO)\nCOMPATIBLE_IOCTL(HIDIOCGFIELDINFO)\nCOMPATIBLE_IOCTL(HIDIOCGUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCSUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCGUCODE)\nCOMPATIBLE_IOCTL(HIDIOCGFLAG)\nCOMPATIBLE_IOCTL(HIDIOCSFLAG)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINDEX)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINFO)\n/* joystick */\nCOMPATIBLE_IOCTL(JSIOCGVERSION)\nCOMPATIBLE_IOCTL(JSIOCGAXES)\nCOMPATIBLE_IOCTL(JSIOCGBUTTONS)\nCOMPATIBLE_IOCTL(JSIOCGNAME(0))\n\n/* fat 'r' ioctls. These are handled by fat with ->compat_ioctl,\n   but we don't want warnings on other file systems. So declare\n   them as compatible here. */\n#define VFAT_IOCTL_READDIR_BOTH32       _IOR('r', 1, struct compat_dirent[2])\n#define VFAT_IOCTL_READDIR_SHORT32      _IOR('r', 2, struct compat_dirent[2])\n\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_BOTH32)\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_SHORT32)\n\n#ifdef CONFIG_SPARC\n/* Sparc framebuffers, handled in sbusfb_compat_ioctl() */\nIGNORE_IOCTL(FBIOGTYPE)\nIGNORE_IOCTL(FBIOSATTR)\nIGNORE_IOCTL(FBIOGATTR)\nIGNORE_IOCTL(FBIOSVIDEO)\nIGNORE_IOCTL(FBIOGVIDEO)\nIGNORE_IOCTL(FBIOSCURPOS)\nIGNORE_IOCTL(FBIOGCURPOS)\nIGNORE_IOCTL(FBIOGCURMAX)\nIGNORE_IOCTL(FBIOPUTCMAP32)\nIGNORE_IOCTL(FBIOGETCMAP32)\nIGNORE_IOCTL(FBIOSCURSOR32)\nIGNORE_IOCTL(FBIOGCURSOR32)\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sort",
          "args": [
            "ioctl_pointer",
            "ARRAY_SIZE(ioctl_pointer)",
            "sizeof(*ioctl_pointer)",
            "init_sys32_ioctl_cmp",
            "NULL"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "ioctl_pointer"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic unsigned int ioctl_pointer[] = {\n/* compatible ioctls first */\n/* Little t */\nCOMPATIBLE_IOCTL(TIOCOUTQ)\n/* Little f */\nCOMPATIBLE_IOCTL(FIOCLEX)\nCOMPATIBLE_IOCTL(FIONCLEX)\nCOMPATIBLE_IOCTL(FIOASYNC)\nCOMPATIBLE_IOCTL(FIONBIO)\nCOMPATIBLE_IOCTL(FIONREAD)  /* This is also TIOCINQ */\nCOMPATIBLE_IOCTL(FS_IOC_FIEMAP)\n/* 0x00 */\nCOMPATIBLE_IOCTL(FIBMAP)\nCOMPATIBLE_IOCTL(FIGETBSZ)\n/* 'X' - originally XFS but some now in the VFS */\nCOMPATIBLE_IOCTL(FIFREEZE)\nCOMPATIBLE_IOCTL(FITHAW)\nCOMPATIBLE_IOCTL(FITRIM)\n#ifdef CONFIG_BLOCK\n/* Big S */\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_IDLUN)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORUNLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_TEST_UNIT_READY)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_BUS_NUMBER)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_SEND_COMMAND)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_PROBE_HOST)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_PCI)\n#endif\n/* Big V (don't complain on serial console) */\nIGNORE_IOCTL(VT_OPENQRY)\nIGNORE_IOCTL(VT_GETMODE)\n/* Little p (/dev/rtc, /dev/envctrl, etc.) */\nCOMPATIBLE_IOCTL(RTC_AIE_ON)\nCOMPATIBLE_IOCTL(RTC_AIE_OFF)\nCOMPATIBLE_IOCTL(RTC_UIE_ON)\nCOMPATIBLE_IOCTL(RTC_UIE_OFF)\nCOMPATIBLE_IOCTL(RTC_PIE_ON)\nCOMPATIBLE_IOCTL(RTC_PIE_OFF)\nCOMPATIBLE_IOCTL(RTC_WIE_ON)\nCOMPATIBLE_IOCTL(RTC_WIE_OFF)\nCOMPATIBLE_IOCTL(RTC_ALM_SET)\nCOMPATIBLE_IOCTL(RTC_ALM_READ)\nCOMPATIBLE_IOCTL(RTC_RD_TIME)\nCOMPATIBLE_IOCTL(RTC_SET_TIME)\nCOMPATIBLE_IOCTL(RTC_WKALM_SET)\nCOMPATIBLE_IOCTL(RTC_WKALM_RD)\n/*\n * These two are only for the sbus rtc driver, but\n * hwclock tries them on every rtc device first when\n * running on sparc.  On other architectures the entries\n * are useless but harmless.\n */\nCOMPATIBLE_IOCTL(_IOR('p', 20, int[7])) /* RTCGET */\nCOMPATIBLE_IOCTL(_IOW('p', 21, int[7])) /* RTCSET */\n/* Little m */\nCOMPATIBLE_IOCTL(MTIOCTOP)\n/* Socket level stuff */\nCOMPATIBLE_IOCTL(FIOQSIZE)\n#ifdef CONFIG_BLOCK\n/* md calls this on random blockdevs */\nIGNORE_IOCTL(RAID_VERSION)\n/* qemu/qemu-img might call these two on plain files for probing */\nIGNORE_IOCTL(CDROM_DRIVE_STATUS)\nIGNORE_IOCTL(FDGETPRM32)\n/* SG stuff */\nCOMPATIBLE_IOCTL(SG_SET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_GET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_EMULATED_HOST)\nCOMPATIBLE_IOCTL(SG_GET_TRANSFORM)\nCOMPATIBLE_IOCTL(SG_SET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_SCSI_ID)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_GET_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_NUM_WAITING)\nCOMPATIBLE_IOCTL(SG_SET_DEBUG)\nCOMPATIBLE_IOCTL(SG_GET_SG_TABLESIZE)\nCOMPATIBLE_IOCTL(SG_GET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_SET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_GET_VERSION_NUM)\nCOMPATIBLE_IOCTL(SG_NEXT_CMD_LEN)\nCOMPATIBLE_IOCTL(SG_SCSI_RESET)\nCOMPATIBLE_IOCTL(SG_GET_REQUEST_TABLE)\nCOMPATIBLE_IOCTL(SG_SET_KEEP_ORPHAN)\nCOMPATIBLE_IOCTL(SG_GET_KEEP_ORPHAN)\n#endif\n/* PPP stuff */\nCOMPATIBLE_IOCTL(PPPIOCGFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCSFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCGASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGUNIT)\nCOMPATIBLE_IOCTL(PPPIOCGRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMAXCID)\nCOMPATIBLE_IOCTL(PPPIOCGXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCXFERUNIT)\n/* PPPIOCSCOMPRESS is translated */\nCOMPATIBLE_IOCTL(PPPIOCGNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCSNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCGDEBUG)\nCOMPATIBLE_IOCTL(PPPIOCSDEBUG)\n/* PPPIOCSPASS is translated */\n/* PPPIOCSACTIVE is translated */\n/* PPPIOCGIDLE is translated */\nCOMPATIBLE_IOCTL(PPPIOCNEWUNIT)\nCOMPATIBLE_IOCTL(PPPIOCATTACH)\nCOMPATIBLE_IOCTL(PPPIOCDETACH)\nCOMPATIBLE_IOCTL(PPPIOCSMRRU)\nCOMPATIBLE_IOCTL(PPPIOCCONNECT)\nCOMPATIBLE_IOCTL(PPPIOCDISCONN)\nCOMPATIBLE_IOCTL(PPPIOCATTCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGL2TPSTATS)\n/* PPPOX */\nCOMPATIBLE_IOCTL(PPPOEIOCSFWD)\nCOMPATIBLE_IOCTL(PPPOEIOCDFWD)\n/* Big A */\n/* sparc only */\n/* Big Q for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_CTRLRATE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETOUTCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETINCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PERCMODE)\nCOMPATIBLE_IOCTL(SNDCTL_FM_LOAD_INSTR)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_TESTMIDI)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESETSAMPLES)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRSYNTHS)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRMIDIS)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_THRESHOLD)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_MEMAVL)\nCOMPATIBLE_IOCTL(SNDCTL_FM_4OP_ENABLE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PANIC)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_OUTOFBAND)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETTIME)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_ID)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_CONTROL)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_REMOVESAMPLE)\n/* Big T for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TIMEBASE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_START)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_STOP)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_CONTINUE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TEMPO)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SOURCE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_METRONOME)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SELECT)\n/* Little m for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_PRETIME)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUMODE)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUCMD)\n/* Big P for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SPEED)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_STEREO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETBLKSIZE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_WRITE_FILTER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_POST)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SUBDIVIDE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFRAGMENT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETFMTS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFMT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOSPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETISPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_NONBLOCK)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETCAPS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETIPTR)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOPTR)\n/* SNDCTL_DSP_MAPINBUF,  XXX needs translation */\n/* SNDCTL_DSP_MAPOUTBUF,  XXX needs translation */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETSYNCRO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETDUPLEX)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETODELAY)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_PROFILE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_RATE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_BITS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_FILTER)\n/* Big C for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_LOAD)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RUN)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_HALT)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_SENDMSG)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCVMSG)\n/* Big M for sound/OSS */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE3)\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MUTE)\n/* SOUND_MIXER_READ_ENHANCE,  same value as READ_MUTE */\n/* SOUND_MIXER_READ_LOUD,  same value as READ_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_DEVMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_STEREODEVS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CAPS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE3)\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MUTE)\n/* SOUND_MIXER_WRITE_ENHANCE,  same value as WRITE_MUTE */\n/* SOUND_MIXER_WRITE_LOUD,  same value as WRITE_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_OLD_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_MIXER_ACCESS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_AGC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_3DSE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE3)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE4)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE5)\nCOMPATIBLE_IOCTL(SOUND_MIXER_GETLEVELS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_SETLEVELS)\nCOMPATIBLE_IOCTL(OSS_GETVERSION)\n/* Raw devices */\nCOMPATIBLE_IOCTL(RAW_SETBIND)\nCOMPATIBLE_IOCTL(RAW_GETBIND)\n/* Watchdog */\nCOMPATIBLE_IOCTL(WDIOC_GETSUPPORT)\nCOMPATIBLE_IOCTL(WDIOC_GETSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETBOOTSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETTEMP)\nCOMPATIBLE_IOCTL(WDIOC_SETOPTIONS)\nCOMPATIBLE_IOCTL(WDIOC_KEEPALIVE)\nCOMPATIBLE_IOCTL(WDIOC_SETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_SETPRETIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETPRETIMEOUT)\n/* Big R */\nCOMPATIBLE_IOCTL(RNDGETENTCNT)\nCOMPATIBLE_IOCTL(RNDADDTOENTCNT)\nCOMPATIBLE_IOCTL(RNDGETPOOL)\nCOMPATIBLE_IOCTL(RNDADDENTROPY)\nCOMPATIBLE_IOCTL(RNDZAPENTCNT)\nCOMPATIBLE_IOCTL(RNDCLEARPOOL)\n/* Bluetooth */\nCOMPATIBLE_IOCTL(HCIDEVUP)\nCOMPATIBLE_IOCTL(HCIDEVDOWN)\nCOMPATIBLE_IOCTL(HCIDEVRESET)\nCOMPATIBLE_IOCTL(HCIDEVRESTAT)\nCOMPATIBLE_IOCTL(HCIGETDEVLIST)\nCOMPATIBLE_IOCTL(HCIGETDEVINFO)\nCOMPATIBLE_IOCTL(HCIGETCONNLIST)\nCOMPATIBLE_IOCTL(HCIGETCONNINFO)\nCOMPATIBLE_IOCTL(HCIGETAUTHINFO)\nCOMPATIBLE_IOCTL(HCISETRAW)\nCOMPATIBLE_IOCTL(HCISETSCAN)\nCOMPATIBLE_IOCTL(HCISETAUTH)\nCOMPATIBLE_IOCTL(HCISETENCRYPT)\nCOMPATIBLE_IOCTL(HCISETPTYPE)\nCOMPATIBLE_IOCTL(HCISETLINKPOL)\nCOMPATIBLE_IOCTL(HCISETLINKMODE)\nCOMPATIBLE_IOCTL(HCISETACLMTU)\nCOMPATIBLE_IOCTL(HCISETSCOMTU)\nCOMPATIBLE_IOCTL(HCIBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIUNBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIINQUIRY)\nCOMPATIBLE_IOCTL(HCIUARTSETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETDEVICE)\nCOMPATIBLE_IOCTL(HCIUARTSETFLAGS)\nCOMPATIBLE_IOCTL(HCIUARTGETFLAGS)\nCOMPATIBLE_IOCTL(RFCOMMCREATEDEV)\nCOMPATIBLE_IOCTL(RFCOMMRELEASEDEV)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVLIST)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVINFO)\nCOMPATIBLE_IOCTL(RFCOMMSTEALDLC)\n/* CAPI */\nCOMPATIBLE_IOCTL(CAPI_REGISTER)\nCOMPATIBLE_IOCTL(CAPI_GET_MANUFACTURER)\nCOMPATIBLE_IOCTL(CAPI_GET_VERSION)\nCOMPATIBLE_IOCTL(CAPI_GET_SERIAL)\nCOMPATIBLE_IOCTL(CAPI_GET_PROFILE)\nCOMPATIBLE_IOCTL(CAPI_MANUFACTURER_CMD)\nCOMPATIBLE_IOCTL(CAPI_GET_ERRCODE)\nCOMPATIBLE_IOCTL(CAPI_INSTALLED)\nCOMPATIBLE_IOCTL(CAPI_GET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_SET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_CLR_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_NCCI_OPENCOUNT)\nCOMPATIBLE_IOCTL(CAPI_NCCI_GETUNIT)\n/* Misc. */\nCOMPATIBLE_IOCTL(0x41545900)\t\t/* ATYIO_CLKR */\nCOMPATIBLE_IOCTL(0x41545901)\t\t/* ATYIO_CLKW */\nCOMPATIBLE_IOCTL(PCIIOC_CONTROLLER)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_IO)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_MEM)\nCOMPATIBLE_IOCTL(PCIIOC_WRITE_COMBINE)\n/* hiddev */\nCOMPATIBLE_IOCTL(HIDIOCGVERSION)\nCOMPATIBLE_IOCTL(HIDIOCAPPLICATION)\nCOMPATIBLE_IOCTL(HIDIOCGDEVINFO)\nCOMPATIBLE_IOCTL(HIDIOCGSTRING)\nCOMPATIBLE_IOCTL(HIDIOCINITREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORT)\nCOMPATIBLE_IOCTL(HIDIOCSREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORTINFO)\nCOMPATIBLE_IOCTL(HIDIOCGFIELDINFO)\nCOMPATIBLE_IOCTL(HIDIOCGUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCSUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCGUCODE)\nCOMPATIBLE_IOCTL(HIDIOCGFLAG)\nCOMPATIBLE_IOCTL(HIDIOCSFLAG)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINDEX)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINFO)\n/* joystick */\nCOMPATIBLE_IOCTL(JSIOCGVERSION)\nCOMPATIBLE_IOCTL(JSIOCGAXES)\nCOMPATIBLE_IOCTL(JSIOCGBUTTONS)\nCOMPATIBLE_IOCTL(JSIOCGNAME(0))\n\n/* fat 'r' ioctls. These are handled by fat with ->compat_ioctl,\n   but we don't want warnings on other file systems. So declare\n   them as compatible here. */\n#define VFAT_IOCTL_READDIR_BOTH32       _IOR('r', 1, struct compat_dirent[2])\n#define VFAT_IOCTL_READDIR_SHORT32      _IOR('r', 2, struct compat_dirent[2])\n\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_BOTH32)\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_SHORT32)\n\n#ifdef CONFIG_SPARC\n/* Sparc framebuffers, handled in sbusfb_compat_ioctl() */\nIGNORE_IOCTL(FBIOGTYPE)\nIGNORE_IOCTL(FBIOSATTR)\nIGNORE_IOCTL(FBIOGATTR)\nIGNORE_IOCTL(FBIOSVIDEO)\nIGNORE_IOCTL(FBIOGVIDEO)\nIGNORE_IOCTL(FBIOSCURPOS)\nIGNORE_IOCTL(FBIOGCURPOS)\nIGNORE_IOCTL(FBIOGCURMAX)\nIGNORE_IOCTL(FBIOPUTCMAP32)\nIGNORE_IOCTL(FBIOGETCMAP32)\nIGNORE_IOCTL(FBIOSCURSOR32)\nIGNORE_IOCTL(FBIOGCURSOR32)\n#endif\n};\n\nstatic int __init init_sys32_ioctl(void)\n{\n\tsort(ioctl_pointer, ARRAY_SIZE(ioctl_pointer), sizeof(*ioctl_pointer),\n\t\tinit_sys32_ioctl_cmp, NULL);\n\treturn 0;\n}"
  },
  {
    "function_name": "init_sys32_ioctl_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "1081-1091",
    "snippet": "static int __init init_sys32_ioctl_cmp(const void *p, const void *q)\n{\n\tunsigned int a, b;\n\ta = *(unsigned int *)p;\n\tb = *(unsigned int *)q;\n\tif (a > b)\n\t\treturn 1;\n\tif (a < b)\n\t\treturn -1;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int __init init_sys32_ioctl_cmp(const void *p, const void *q)\n{\n\tunsigned int a, b;\n\ta = *(unsigned int *)p;\n\tb = *(unsigned int *)q;\n\tif (a > b)\n\t\treturn 1;\n\tif (a < b)\n\t\treturn -1;\n\treturn 0;\n}"
  },
  {
    "function_name": "compat_ioctl_check_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "976-996",
    "snippet": "static int compat_ioctl_check_table(unsigned int xcmd)\n{\n\tint i;\n\tconst int max = ARRAY_SIZE(ioctl_pointer) - 1;\n\n\tBUILD_BUG_ON(max >= (1 << 16));\n\n\t/* guess initial offset into table, assuming a\n\t   normalized distribution */\n\ti = ((xcmd >> 16) * max) >> 16;\n\n\t/* do linear search up first, until greater or equal */\n\twhile (ioctl_pointer[i] < xcmd && i < max)\n\t\ti++;\n\n\t/* then do linear search down */\n\twhile (ioctl_pointer[i] > xcmd && i > 0)\n\t\ti--;\n\n\treturn ioctl_pointer[i] == xcmd;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned int ioctl_pointer[] = {\n/* compatible ioctls first */\n/* Little t */\nCOMPATIBLE_IOCTL(TIOCOUTQ)\n/* Little f */\nCOMPATIBLE_IOCTL(FIOCLEX)\nCOMPATIBLE_IOCTL(FIONCLEX)\nCOMPATIBLE_IOCTL(FIOASYNC)\nCOMPATIBLE_IOCTL(FIONBIO)\nCOMPATIBLE_IOCTL(FIONREAD)  /* This is also TIOCINQ */\nCOMPATIBLE_IOCTL(FS_IOC_FIEMAP)\n/* 0x00 */\nCOMPATIBLE_IOCTL(FIBMAP)\nCOMPATIBLE_IOCTL(FIGETBSZ)\n/* 'X' - originally XFS but some now in the VFS */\nCOMPATIBLE_IOCTL(FIFREEZE)\nCOMPATIBLE_IOCTL(FITHAW)\nCOMPATIBLE_IOCTL(FITRIM)\n#ifdef CONFIG_BLOCK\n/* Big S */\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_IDLUN)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORUNLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_TEST_UNIT_READY)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_BUS_NUMBER)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_SEND_COMMAND)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_PROBE_HOST)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_PCI)\n#endif\n/* Big V (don't complain on serial console) */\nIGNORE_IOCTL(VT_OPENQRY)\nIGNORE_IOCTL(VT_GETMODE)\n/* Little p (/dev/rtc, /dev/envctrl, etc.) */\nCOMPATIBLE_IOCTL(RTC_AIE_ON)\nCOMPATIBLE_IOCTL(RTC_AIE_OFF)\nCOMPATIBLE_IOCTL(RTC_UIE_ON)\nCOMPATIBLE_IOCTL(RTC_UIE_OFF)\nCOMPATIBLE_IOCTL(RTC_PIE_ON)\nCOMPATIBLE_IOCTL(RTC_PIE_OFF)\nCOMPATIBLE_IOCTL(RTC_WIE_ON)\nCOMPATIBLE_IOCTL(RTC_WIE_OFF)\nCOMPATIBLE_IOCTL(RTC_ALM_SET)\nCOMPATIBLE_IOCTL(RTC_ALM_READ)\nCOMPATIBLE_IOCTL(RTC_RD_TIME)\nCOMPATIBLE_IOCTL(RTC_SET_TIME)\nCOMPATIBLE_IOCTL(RTC_WKALM_SET)\nCOMPATIBLE_IOCTL(RTC_WKALM_RD)\n/*\n * These two are only for the sbus rtc driver, but\n * hwclock tries them on every rtc device first when\n * running on sparc.  On other architectures the entries\n * are useless but harmless.\n */\nCOMPATIBLE_IOCTL(_IOR('p', 20, int[7])) /* RTCGET */\nCOMPATIBLE_IOCTL(_IOW('p', 21, int[7])) /* RTCSET */\n/* Little m */\nCOMPATIBLE_IOCTL(MTIOCTOP)\n/* Socket level stuff */\nCOMPATIBLE_IOCTL(FIOQSIZE)\n#ifdef CONFIG_BLOCK\n/* md calls this on random blockdevs */\nIGNORE_IOCTL(RAID_VERSION)\n/* qemu/qemu-img might call these two on plain files for probing */\nIGNORE_IOCTL(CDROM_DRIVE_STATUS)\nIGNORE_IOCTL(FDGETPRM32)\n/* SG stuff */\nCOMPATIBLE_IOCTL(SG_SET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_GET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_EMULATED_HOST)\nCOMPATIBLE_IOCTL(SG_GET_TRANSFORM)\nCOMPATIBLE_IOCTL(SG_SET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_SCSI_ID)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_GET_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_NUM_WAITING)\nCOMPATIBLE_IOCTL(SG_SET_DEBUG)\nCOMPATIBLE_IOCTL(SG_GET_SG_TABLESIZE)\nCOMPATIBLE_IOCTL(SG_GET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_SET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_GET_VERSION_NUM)\nCOMPATIBLE_IOCTL(SG_NEXT_CMD_LEN)\nCOMPATIBLE_IOCTL(SG_SCSI_RESET)\nCOMPATIBLE_IOCTL(SG_GET_REQUEST_TABLE)\nCOMPATIBLE_IOCTL(SG_SET_KEEP_ORPHAN)\nCOMPATIBLE_IOCTL(SG_GET_KEEP_ORPHAN)\n#endif\n/* PPP stuff */\nCOMPATIBLE_IOCTL(PPPIOCGFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCSFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCGASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGUNIT)\nCOMPATIBLE_IOCTL(PPPIOCGRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMAXCID)\nCOMPATIBLE_IOCTL(PPPIOCGXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCXFERUNIT)\n/* PPPIOCSCOMPRESS is translated */\nCOMPATIBLE_IOCTL(PPPIOCGNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCSNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCGDEBUG)\nCOMPATIBLE_IOCTL(PPPIOCSDEBUG)\n/* PPPIOCSPASS is translated */\n/* PPPIOCSACTIVE is translated */\n/* PPPIOCGIDLE is translated */\nCOMPATIBLE_IOCTL(PPPIOCNEWUNIT)\nCOMPATIBLE_IOCTL(PPPIOCATTACH)\nCOMPATIBLE_IOCTL(PPPIOCDETACH)\nCOMPATIBLE_IOCTL(PPPIOCSMRRU)\nCOMPATIBLE_IOCTL(PPPIOCCONNECT)\nCOMPATIBLE_IOCTL(PPPIOCDISCONN)\nCOMPATIBLE_IOCTL(PPPIOCATTCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGL2TPSTATS)\n/* PPPOX */\nCOMPATIBLE_IOCTL(PPPOEIOCSFWD)\nCOMPATIBLE_IOCTL(PPPOEIOCDFWD)\n/* Big A */\n/* sparc only */\n/* Big Q for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_CTRLRATE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETOUTCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETINCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PERCMODE)\nCOMPATIBLE_IOCTL(SNDCTL_FM_LOAD_INSTR)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_TESTMIDI)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESETSAMPLES)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRSYNTHS)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRMIDIS)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_THRESHOLD)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_MEMAVL)\nCOMPATIBLE_IOCTL(SNDCTL_FM_4OP_ENABLE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PANIC)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_OUTOFBAND)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETTIME)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_ID)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_CONTROL)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_REMOVESAMPLE)\n/* Big T for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TIMEBASE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_START)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_STOP)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_CONTINUE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TEMPO)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SOURCE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_METRONOME)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SELECT)\n/* Little m for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_PRETIME)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUMODE)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUCMD)\n/* Big P for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SPEED)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_STEREO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETBLKSIZE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_WRITE_FILTER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_POST)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SUBDIVIDE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFRAGMENT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETFMTS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFMT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOSPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETISPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_NONBLOCK)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETCAPS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETIPTR)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOPTR)\n/* SNDCTL_DSP_MAPINBUF,  XXX needs translation */\n/* SNDCTL_DSP_MAPOUTBUF,  XXX needs translation */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETSYNCRO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETDUPLEX)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETODELAY)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_PROFILE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_RATE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_BITS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_FILTER)\n/* Big C for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_LOAD)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RUN)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_HALT)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_SENDMSG)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCVMSG)\n/* Big M for sound/OSS */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE3)\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MUTE)\n/* SOUND_MIXER_READ_ENHANCE,  same value as READ_MUTE */\n/* SOUND_MIXER_READ_LOUD,  same value as READ_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_DEVMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_STEREODEVS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CAPS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE3)\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MUTE)\n/* SOUND_MIXER_WRITE_ENHANCE,  same value as WRITE_MUTE */\n/* SOUND_MIXER_WRITE_LOUD,  same value as WRITE_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_OLD_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_MIXER_ACCESS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_AGC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_3DSE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE3)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE4)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE5)\nCOMPATIBLE_IOCTL(SOUND_MIXER_GETLEVELS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_SETLEVELS)\nCOMPATIBLE_IOCTL(OSS_GETVERSION)\n/* Raw devices */\nCOMPATIBLE_IOCTL(RAW_SETBIND)\nCOMPATIBLE_IOCTL(RAW_GETBIND)\n/* Watchdog */\nCOMPATIBLE_IOCTL(WDIOC_GETSUPPORT)\nCOMPATIBLE_IOCTL(WDIOC_GETSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETBOOTSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETTEMP)\nCOMPATIBLE_IOCTL(WDIOC_SETOPTIONS)\nCOMPATIBLE_IOCTL(WDIOC_KEEPALIVE)\nCOMPATIBLE_IOCTL(WDIOC_SETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_SETPRETIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETPRETIMEOUT)\n/* Big R */\nCOMPATIBLE_IOCTL(RNDGETENTCNT)\nCOMPATIBLE_IOCTL(RNDADDTOENTCNT)\nCOMPATIBLE_IOCTL(RNDGETPOOL)\nCOMPATIBLE_IOCTL(RNDADDENTROPY)\nCOMPATIBLE_IOCTL(RNDZAPENTCNT)\nCOMPATIBLE_IOCTL(RNDCLEARPOOL)\n/* Bluetooth */\nCOMPATIBLE_IOCTL(HCIDEVUP)\nCOMPATIBLE_IOCTL(HCIDEVDOWN)\nCOMPATIBLE_IOCTL(HCIDEVRESET)\nCOMPATIBLE_IOCTL(HCIDEVRESTAT)\nCOMPATIBLE_IOCTL(HCIGETDEVLIST)\nCOMPATIBLE_IOCTL(HCIGETDEVINFO)\nCOMPATIBLE_IOCTL(HCIGETCONNLIST)\nCOMPATIBLE_IOCTL(HCIGETCONNINFO)\nCOMPATIBLE_IOCTL(HCIGETAUTHINFO)\nCOMPATIBLE_IOCTL(HCISETRAW)\nCOMPATIBLE_IOCTL(HCISETSCAN)\nCOMPATIBLE_IOCTL(HCISETAUTH)\nCOMPATIBLE_IOCTL(HCISETENCRYPT)\nCOMPATIBLE_IOCTL(HCISETPTYPE)\nCOMPATIBLE_IOCTL(HCISETLINKPOL)\nCOMPATIBLE_IOCTL(HCISETLINKMODE)\nCOMPATIBLE_IOCTL(HCISETACLMTU)\nCOMPATIBLE_IOCTL(HCISETSCOMTU)\nCOMPATIBLE_IOCTL(HCIBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIUNBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIINQUIRY)\nCOMPATIBLE_IOCTL(HCIUARTSETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETDEVICE)\nCOMPATIBLE_IOCTL(HCIUARTSETFLAGS)\nCOMPATIBLE_IOCTL(HCIUARTGETFLAGS)\nCOMPATIBLE_IOCTL(RFCOMMCREATEDEV)\nCOMPATIBLE_IOCTL(RFCOMMRELEASEDEV)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVLIST)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVINFO)\nCOMPATIBLE_IOCTL(RFCOMMSTEALDLC)\n/* CAPI */\nCOMPATIBLE_IOCTL(CAPI_REGISTER)\nCOMPATIBLE_IOCTL(CAPI_GET_MANUFACTURER)\nCOMPATIBLE_IOCTL(CAPI_GET_VERSION)\nCOMPATIBLE_IOCTL(CAPI_GET_SERIAL)\nCOMPATIBLE_IOCTL(CAPI_GET_PROFILE)\nCOMPATIBLE_IOCTL(CAPI_MANUFACTURER_CMD)\nCOMPATIBLE_IOCTL(CAPI_GET_ERRCODE)\nCOMPATIBLE_IOCTL(CAPI_INSTALLED)\nCOMPATIBLE_IOCTL(CAPI_GET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_SET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_CLR_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_NCCI_OPENCOUNT)\nCOMPATIBLE_IOCTL(CAPI_NCCI_GETUNIT)\n/* Misc. */\nCOMPATIBLE_IOCTL(0x41545900)\t\t/* ATYIO_CLKR */\nCOMPATIBLE_IOCTL(0x41545901)\t\t/* ATYIO_CLKW */\nCOMPATIBLE_IOCTL(PCIIOC_CONTROLLER)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_IO)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_MEM)\nCOMPATIBLE_IOCTL(PCIIOC_WRITE_COMBINE)\n/* hiddev */\nCOMPATIBLE_IOCTL(HIDIOCGVERSION)\nCOMPATIBLE_IOCTL(HIDIOCAPPLICATION)\nCOMPATIBLE_IOCTL(HIDIOCGDEVINFO)\nCOMPATIBLE_IOCTL(HIDIOCGSTRING)\nCOMPATIBLE_IOCTL(HIDIOCINITREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORT)\nCOMPATIBLE_IOCTL(HIDIOCSREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORTINFO)\nCOMPATIBLE_IOCTL(HIDIOCGFIELDINFO)\nCOMPATIBLE_IOCTL(HIDIOCGUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCSUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCGUCODE)\nCOMPATIBLE_IOCTL(HIDIOCGFLAG)\nCOMPATIBLE_IOCTL(HIDIOCSFLAG)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINDEX)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINFO)\n/* joystick */\nCOMPATIBLE_IOCTL(JSIOCGVERSION)\nCOMPATIBLE_IOCTL(JSIOCGAXES)\nCOMPATIBLE_IOCTL(JSIOCGBUTTONS)\nCOMPATIBLE_IOCTL(JSIOCGNAME(0))\n\n/* fat 'r' ioctls. These are handled by fat with ->compat_ioctl,\n   but we don't want warnings on other file systems. So declare\n   them as compatible here. */\n#define VFAT_IOCTL_READDIR_BOTH32       _IOR('r', 1, struct compat_dirent[2])\n#define VFAT_IOCTL_READDIR_SHORT32      _IOR('r', 2, struct compat_dirent[2])\n\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_BOTH32)\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_SHORT32)\n\n#ifdef CONFIG_SPARC\n/* Sparc framebuffers, handled in sbusfb_compat_ioctl() */\nIGNORE_IOCTL(FBIOGTYPE)\nIGNORE_IOCTL(FBIOSATTR)\nIGNORE_IOCTL(FBIOGATTR)\nIGNORE_IOCTL(FBIOSVIDEO)\nIGNORE_IOCTL(FBIOGVIDEO)\nIGNORE_IOCTL(FBIOSCURPOS)\nIGNORE_IOCTL(FBIOGCURPOS)\nIGNORE_IOCTL(FBIOGCURMAX)\nIGNORE_IOCTL(FBIOPUTCMAP32)\nIGNORE_IOCTL(FBIOGETCMAP32)\nIGNORE_IOCTL(FBIOSCURSOR32)\nIGNORE_IOCTL(FBIOGCURSOR32)\n#endif\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "max >= (1 << 16)"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "ioctl_pointer"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic unsigned int ioctl_pointer[] = {\n/* compatible ioctls first */\n/* Little t */\nCOMPATIBLE_IOCTL(TIOCOUTQ)\n/* Little f */\nCOMPATIBLE_IOCTL(FIOCLEX)\nCOMPATIBLE_IOCTL(FIONCLEX)\nCOMPATIBLE_IOCTL(FIOASYNC)\nCOMPATIBLE_IOCTL(FIONBIO)\nCOMPATIBLE_IOCTL(FIONREAD)  /* This is also TIOCINQ */\nCOMPATIBLE_IOCTL(FS_IOC_FIEMAP)\n/* 0x00 */\nCOMPATIBLE_IOCTL(FIBMAP)\nCOMPATIBLE_IOCTL(FIGETBSZ)\n/* 'X' - originally XFS but some now in the VFS */\nCOMPATIBLE_IOCTL(FIFREEZE)\nCOMPATIBLE_IOCTL(FITHAW)\nCOMPATIBLE_IOCTL(FITRIM)\n#ifdef CONFIG_BLOCK\n/* Big S */\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_IDLUN)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_DOORUNLOCK)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_TEST_UNIT_READY)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_BUS_NUMBER)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_SEND_COMMAND)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_PROBE_HOST)\nCOMPATIBLE_IOCTL(SCSI_IOCTL_GET_PCI)\n#endif\n/* Big V (don't complain on serial console) */\nIGNORE_IOCTL(VT_OPENQRY)\nIGNORE_IOCTL(VT_GETMODE)\n/* Little p (/dev/rtc, /dev/envctrl, etc.) */\nCOMPATIBLE_IOCTL(RTC_AIE_ON)\nCOMPATIBLE_IOCTL(RTC_AIE_OFF)\nCOMPATIBLE_IOCTL(RTC_UIE_ON)\nCOMPATIBLE_IOCTL(RTC_UIE_OFF)\nCOMPATIBLE_IOCTL(RTC_PIE_ON)\nCOMPATIBLE_IOCTL(RTC_PIE_OFF)\nCOMPATIBLE_IOCTL(RTC_WIE_ON)\nCOMPATIBLE_IOCTL(RTC_WIE_OFF)\nCOMPATIBLE_IOCTL(RTC_ALM_SET)\nCOMPATIBLE_IOCTL(RTC_ALM_READ)\nCOMPATIBLE_IOCTL(RTC_RD_TIME)\nCOMPATIBLE_IOCTL(RTC_SET_TIME)\nCOMPATIBLE_IOCTL(RTC_WKALM_SET)\nCOMPATIBLE_IOCTL(RTC_WKALM_RD)\n/*\n * These two are only for the sbus rtc driver, but\n * hwclock tries them on every rtc device first when\n * running on sparc.  On other architectures the entries\n * are useless but harmless.\n */\nCOMPATIBLE_IOCTL(_IOR('p', 20, int[7])) /* RTCGET */\nCOMPATIBLE_IOCTL(_IOW('p', 21, int[7])) /* RTCSET */\n/* Little m */\nCOMPATIBLE_IOCTL(MTIOCTOP)\n/* Socket level stuff */\nCOMPATIBLE_IOCTL(FIOQSIZE)\n#ifdef CONFIG_BLOCK\n/* md calls this on random blockdevs */\nIGNORE_IOCTL(RAID_VERSION)\n/* qemu/qemu-img might call these two on plain files for probing */\nIGNORE_IOCTL(CDROM_DRIVE_STATUS)\nIGNORE_IOCTL(FDGETPRM32)\n/* SG stuff */\nCOMPATIBLE_IOCTL(SG_SET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_GET_TIMEOUT)\nCOMPATIBLE_IOCTL(SG_EMULATED_HOST)\nCOMPATIBLE_IOCTL(SG_GET_TRANSFORM)\nCOMPATIBLE_IOCTL(SG_SET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_RESERVED_SIZE)\nCOMPATIBLE_IOCTL(SG_GET_SCSI_ID)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_GET_LOW_DMA)\nCOMPATIBLE_IOCTL(SG_SET_FORCE_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_PACK_ID)\nCOMPATIBLE_IOCTL(SG_GET_NUM_WAITING)\nCOMPATIBLE_IOCTL(SG_SET_DEBUG)\nCOMPATIBLE_IOCTL(SG_GET_SG_TABLESIZE)\nCOMPATIBLE_IOCTL(SG_GET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_SET_COMMAND_Q)\nCOMPATIBLE_IOCTL(SG_GET_VERSION_NUM)\nCOMPATIBLE_IOCTL(SG_NEXT_CMD_LEN)\nCOMPATIBLE_IOCTL(SG_SCSI_RESET)\nCOMPATIBLE_IOCTL(SG_GET_REQUEST_TABLE)\nCOMPATIBLE_IOCTL(SG_SET_KEEP_ORPHAN)\nCOMPATIBLE_IOCTL(SG_GET_KEEP_ORPHAN)\n#endif\n/* PPP stuff */\nCOMPATIBLE_IOCTL(PPPIOCGFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCSFLAGS)\nCOMPATIBLE_IOCTL(PPPIOCGASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGUNIT)\nCOMPATIBLE_IOCTL(PPPIOCGRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSRASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCGMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMRU)\nCOMPATIBLE_IOCTL(PPPIOCSMAXCID)\nCOMPATIBLE_IOCTL(PPPIOCGXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCSXASYNCMAP)\nCOMPATIBLE_IOCTL(PPPIOCXFERUNIT)\n/* PPPIOCSCOMPRESS is translated */\nCOMPATIBLE_IOCTL(PPPIOCGNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCSNPMODE)\nCOMPATIBLE_IOCTL(PPPIOCGDEBUG)\nCOMPATIBLE_IOCTL(PPPIOCSDEBUG)\n/* PPPIOCSPASS is translated */\n/* PPPIOCSACTIVE is translated */\n/* PPPIOCGIDLE is translated */\nCOMPATIBLE_IOCTL(PPPIOCNEWUNIT)\nCOMPATIBLE_IOCTL(PPPIOCATTACH)\nCOMPATIBLE_IOCTL(PPPIOCDETACH)\nCOMPATIBLE_IOCTL(PPPIOCSMRRU)\nCOMPATIBLE_IOCTL(PPPIOCCONNECT)\nCOMPATIBLE_IOCTL(PPPIOCDISCONN)\nCOMPATIBLE_IOCTL(PPPIOCATTCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGCHAN)\nCOMPATIBLE_IOCTL(PPPIOCGL2TPSTATS)\n/* PPPOX */\nCOMPATIBLE_IOCTL(PPPOEIOCSFWD)\nCOMPATIBLE_IOCTL(PPPOEIOCDFWD)\n/* Big A */\n/* sparc only */\n/* Big Q for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_CTRLRATE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETOUTCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETINCOUNT)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PERCMODE)\nCOMPATIBLE_IOCTL(SNDCTL_FM_LOAD_INSTR)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_TESTMIDI)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_RESETSAMPLES)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRSYNTHS)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_NRMIDIS)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_INFO)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_THRESHOLD)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_MEMAVL)\nCOMPATIBLE_IOCTL(SNDCTL_FM_4OP_ENABLE)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_PANIC)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_OUTOFBAND)\nCOMPATIBLE_IOCTL(SNDCTL_SEQ_GETTIME)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_ID)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_CONTROL)\nCOMPATIBLE_IOCTL(SNDCTL_SYNTH_REMOVESAMPLE)\n/* Big T for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TIMEBASE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_START)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_STOP)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_CONTINUE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_TEMPO)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SOURCE)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_METRONOME)\nCOMPATIBLE_IOCTL(SNDCTL_TMR_SELECT)\n/* Little m for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_PRETIME)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUMODE)\nCOMPATIBLE_IOCTL(SNDCTL_MIDI_MPUCMD)\n/* Big P for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SYNC)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SPEED)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_STEREO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETBLKSIZE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_WRITE_FILTER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_POST)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SUBDIVIDE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFRAGMENT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETFMTS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETFMT)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOSPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETISPACE)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_NONBLOCK)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETCAPS)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETTRIGGER)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETIPTR)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETOPTR)\n/* SNDCTL_DSP_MAPINBUF,  XXX needs translation */\n/* SNDCTL_DSP_MAPOUTBUF,  XXX needs translation */\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETSYNCRO)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_SETDUPLEX)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_GETODELAY)\nCOMPATIBLE_IOCTL(SNDCTL_DSP_PROFILE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_RATE)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_CHANNELS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_BITS)\nCOMPATIBLE_IOCTL(SOUND_PCM_READ_FILTER)\n/* Big C for sound/OSS */\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RESET)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_LOAD)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WDATA)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_WCODE)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RUN)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_HALT)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_SENDMSG)\nCOMPATIBLE_IOCTL(SNDCTL_COPR_RCVMSG)\n/* Big M for sound/OSS */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_LINE3)\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_READ(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_MUTE)\n/* SOUND_MIXER_READ_ENHANCE,  same value as READ_MUTE */\n/* SOUND_MIXER_READ_LOUD,  same value as READ_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_DEVMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_RECMASK)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_STEREODEVS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_READ_CAPS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_VOLUME)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_BASS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_TREBLE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SYNTH)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_PCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_SPEAKER)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MIC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_CD)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IMIX)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_ALTPCM)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECLEV)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_IGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_OGAIN)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_LINE3)\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL1))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL2))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_DIGITAL3))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEIN))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_PHONEOUT))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_VIDEO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_RADIO))\nCOMPATIBLE_IOCTL(MIXER_WRITE(SOUND_MIXER_MONITOR))\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_MUTE)\n/* SOUND_MIXER_WRITE_ENHANCE,  same value as WRITE_MUTE */\n/* SOUND_MIXER_WRITE_LOUD,  same value as WRITE_MUTE */\nCOMPATIBLE_IOCTL(SOUND_MIXER_WRITE_RECSRC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_OLD_MIXER_INFO)\nCOMPATIBLE_IOCTL(SOUND_MIXER_ACCESS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_AGC)\nCOMPATIBLE_IOCTL(SOUND_MIXER_3DSE)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE1)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE2)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE3)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE4)\nCOMPATIBLE_IOCTL(SOUND_MIXER_PRIVATE5)\nCOMPATIBLE_IOCTL(SOUND_MIXER_GETLEVELS)\nCOMPATIBLE_IOCTL(SOUND_MIXER_SETLEVELS)\nCOMPATIBLE_IOCTL(OSS_GETVERSION)\n/* Raw devices */\nCOMPATIBLE_IOCTL(RAW_SETBIND)\nCOMPATIBLE_IOCTL(RAW_GETBIND)\n/* Watchdog */\nCOMPATIBLE_IOCTL(WDIOC_GETSUPPORT)\nCOMPATIBLE_IOCTL(WDIOC_GETSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETBOOTSTATUS)\nCOMPATIBLE_IOCTL(WDIOC_GETTEMP)\nCOMPATIBLE_IOCTL(WDIOC_SETOPTIONS)\nCOMPATIBLE_IOCTL(WDIOC_KEEPALIVE)\nCOMPATIBLE_IOCTL(WDIOC_SETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETTIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_SETPRETIMEOUT)\nCOMPATIBLE_IOCTL(WDIOC_GETPRETIMEOUT)\n/* Big R */\nCOMPATIBLE_IOCTL(RNDGETENTCNT)\nCOMPATIBLE_IOCTL(RNDADDTOENTCNT)\nCOMPATIBLE_IOCTL(RNDGETPOOL)\nCOMPATIBLE_IOCTL(RNDADDENTROPY)\nCOMPATIBLE_IOCTL(RNDZAPENTCNT)\nCOMPATIBLE_IOCTL(RNDCLEARPOOL)\n/* Bluetooth */\nCOMPATIBLE_IOCTL(HCIDEVUP)\nCOMPATIBLE_IOCTL(HCIDEVDOWN)\nCOMPATIBLE_IOCTL(HCIDEVRESET)\nCOMPATIBLE_IOCTL(HCIDEVRESTAT)\nCOMPATIBLE_IOCTL(HCIGETDEVLIST)\nCOMPATIBLE_IOCTL(HCIGETDEVINFO)\nCOMPATIBLE_IOCTL(HCIGETCONNLIST)\nCOMPATIBLE_IOCTL(HCIGETCONNINFO)\nCOMPATIBLE_IOCTL(HCIGETAUTHINFO)\nCOMPATIBLE_IOCTL(HCISETRAW)\nCOMPATIBLE_IOCTL(HCISETSCAN)\nCOMPATIBLE_IOCTL(HCISETAUTH)\nCOMPATIBLE_IOCTL(HCISETENCRYPT)\nCOMPATIBLE_IOCTL(HCISETPTYPE)\nCOMPATIBLE_IOCTL(HCISETLINKPOL)\nCOMPATIBLE_IOCTL(HCISETLINKMODE)\nCOMPATIBLE_IOCTL(HCISETACLMTU)\nCOMPATIBLE_IOCTL(HCISETSCOMTU)\nCOMPATIBLE_IOCTL(HCIBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIUNBLOCKADDR)\nCOMPATIBLE_IOCTL(HCIINQUIRY)\nCOMPATIBLE_IOCTL(HCIUARTSETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETPROTO)\nCOMPATIBLE_IOCTL(HCIUARTGETDEVICE)\nCOMPATIBLE_IOCTL(HCIUARTSETFLAGS)\nCOMPATIBLE_IOCTL(HCIUARTGETFLAGS)\nCOMPATIBLE_IOCTL(RFCOMMCREATEDEV)\nCOMPATIBLE_IOCTL(RFCOMMRELEASEDEV)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVLIST)\nCOMPATIBLE_IOCTL(RFCOMMGETDEVINFO)\nCOMPATIBLE_IOCTL(RFCOMMSTEALDLC)\n/* CAPI */\nCOMPATIBLE_IOCTL(CAPI_REGISTER)\nCOMPATIBLE_IOCTL(CAPI_GET_MANUFACTURER)\nCOMPATIBLE_IOCTL(CAPI_GET_VERSION)\nCOMPATIBLE_IOCTL(CAPI_GET_SERIAL)\nCOMPATIBLE_IOCTL(CAPI_GET_PROFILE)\nCOMPATIBLE_IOCTL(CAPI_MANUFACTURER_CMD)\nCOMPATIBLE_IOCTL(CAPI_GET_ERRCODE)\nCOMPATIBLE_IOCTL(CAPI_INSTALLED)\nCOMPATIBLE_IOCTL(CAPI_GET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_SET_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_CLR_FLAGS)\nCOMPATIBLE_IOCTL(CAPI_NCCI_OPENCOUNT)\nCOMPATIBLE_IOCTL(CAPI_NCCI_GETUNIT)\n/* Misc. */\nCOMPATIBLE_IOCTL(0x41545900)\t\t/* ATYIO_CLKR */\nCOMPATIBLE_IOCTL(0x41545901)\t\t/* ATYIO_CLKW */\nCOMPATIBLE_IOCTL(PCIIOC_CONTROLLER)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_IO)\nCOMPATIBLE_IOCTL(PCIIOC_MMAP_IS_MEM)\nCOMPATIBLE_IOCTL(PCIIOC_WRITE_COMBINE)\n/* hiddev */\nCOMPATIBLE_IOCTL(HIDIOCGVERSION)\nCOMPATIBLE_IOCTL(HIDIOCAPPLICATION)\nCOMPATIBLE_IOCTL(HIDIOCGDEVINFO)\nCOMPATIBLE_IOCTL(HIDIOCGSTRING)\nCOMPATIBLE_IOCTL(HIDIOCINITREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORT)\nCOMPATIBLE_IOCTL(HIDIOCSREPORT)\nCOMPATIBLE_IOCTL(HIDIOCGREPORTINFO)\nCOMPATIBLE_IOCTL(HIDIOCGFIELDINFO)\nCOMPATIBLE_IOCTL(HIDIOCGUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCSUSAGE)\nCOMPATIBLE_IOCTL(HIDIOCGUCODE)\nCOMPATIBLE_IOCTL(HIDIOCGFLAG)\nCOMPATIBLE_IOCTL(HIDIOCSFLAG)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINDEX)\nCOMPATIBLE_IOCTL(HIDIOCGCOLLECTIONINFO)\n/* joystick */\nCOMPATIBLE_IOCTL(JSIOCGVERSION)\nCOMPATIBLE_IOCTL(JSIOCGAXES)\nCOMPATIBLE_IOCTL(JSIOCGBUTTONS)\nCOMPATIBLE_IOCTL(JSIOCGNAME(0))\n\n/* fat 'r' ioctls. These are handled by fat with ->compat_ioctl,\n   but we don't want warnings on other file systems. So declare\n   them as compatible here. */\n#define VFAT_IOCTL_READDIR_BOTH32       _IOR('r', 1, struct compat_dirent[2])\n#define VFAT_IOCTL_READDIR_SHORT32      _IOR('r', 2, struct compat_dirent[2])\n\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_BOTH32)\nIGNORE_IOCTL(VFAT_IOCTL_READDIR_SHORT32)\n\n#ifdef CONFIG_SPARC\n/* Sparc framebuffers, handled in sbusfb_compat_ioctl() */\nIGNORE_IOCTL(FBIOGTYPE)\nIGNORE_IOCTL(FBIOSATTR)\nIGNORE_IOCTL(FBIOGATTR)\nIGNORE_IOCTL(FBIOSVIDEO)\nIGNORE_IOCTL(FBIOGVIDEO)\nIGNORE_IOCTL(FBIOSCURPOS)\nIGNORE_IOCTL(FBIOGCURPOS)\nIGNORE_IOCTL(FBIOGCURMAX)\nIGNORE_IOCTL(FBIOPUTCMAP32)\nIGNORE_IOCTL(FBIOGETCMAP32)\nIGNORE_IOCTL(FBIOSCURSOR32)\nIGNORE_IOCTL(FBIOGCURSOR32)\n#endif\n};\n\nstatic int compat_ioctl_check_table(unsigned int xcmd)\n{\n\tint i;\n\tconst int max = ARRAY_SIZE(ioctl_pointer) - 1;\n\n\tBUILD_BUG_ON(max >= (1 << 16));\n\n\t/* guess initial offset into table, assuming a\n\t   normalized distribution */\n\ti = ((xcmd >> 16) * max) >> 16;\n\n\t/* do linear search up first, until greater or equal */\n\twhile (ioctl_pointer[i] < xcmd && i < max)\n\t\ti++;\n\n\t/* then do linear search down */\n\twhile (ioctl_pointer[i] > xcmd && i > 0)\n\t\ti--;\n\n\treturn ioctl_pointer[i] == xcmd;\n}"
  },
  {
    "function_name": "do_ioctl_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "930-974",
    "snippet": "static long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
      "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
      "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
      "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
      "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
      "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
      "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
      "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
      "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
      "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfs_ioctl",
          "args": [
            "file",
            "cmd",
            "arg"
          ],
          "line": 970
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_ioctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ioctl.c",
          "lines": "39-51",
          "snippet": "long vfs_ioctl(struct file *filp, unsigned int cmd, unsigned long arg)\n{\n\tint error = -ENOTTY;\n\n\tif (!filp->f_op->unlocked_ioctl)\n\t\tgoto out;\n\n\terror = filp->f_op->unlocked_ioctl(filp, cmd, arg);\n\tif (error == -ENOIOCTLCMD)\n\t\terror = -ENOTTY;\n out:\n\treturn error;\n}",
          "includes": [
            "#include <asm/ioctls.h>",
            "#include \"internal.h\"",
            "#include <linux/sched/signal.h>",
            "#include <linux/falloc.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/mm.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ioctls.h>\n#include \"internal.h\"\n#include <linux/sched/signal.h>\n#include <linux/falloc.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/uaccess.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n\nlong vfs_ioctl(struct file *filp, unsigned int cmd, unsigned long arg)\n{\n\tint error = -ENOTTY;\n\n\tif (!filp->f_op->unlocked_ioctl)\n\t\tgoto out;\n\n\terror = filp->f_op->unlocked_ioctl(filp, cmd, arg);\n\tif (error == -ENOIOCTLCMD)\n\t\terror = -ENOTTY;\n out:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rtc_ioctl",
          "args": [
            "file",
            "cmd",
            "argp"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "rtc_ioctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "444-468",
          "snippet": "static int rtc_ioctl(struct file *file,\n\t\tunsigned cmd, void __user *argp)\n{\n\tunsigned long __user *valp = compat_alloc_user_space(sizeof(*valp));\n\tint ret;\n\n\tif (valp == NULL)\n\t\treturn -EFAULT;\n\tswitch (cmd) {\n\tcase RTC_IRQP_READ32:\n\tcase RTC_EPOCH_READ32:\n\t\tret = do_ioctl(file, (cmd == RTC_IRQP_READ32) ?\n\t\t\t\t\tRTC_IRQP_READ : RTC_EPOCH_READ,\n\t\t\t\t\t(unsigned long)valp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\treturn convert_in_user(valp, (unsigned int __user *)argp);\n\tcase RTC_IRQP_SET32:\n\t\treturn do_ioctl(file, RTC_IRQP_SET, (unsigned long)argp);\n\tcase RTC_EPOCH_SET32:\n\t\treturn do_ioctl(file, RTC_EPOCH_SET, (unsigned long)argp);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
            "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
            "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
            "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n\nstatic int rtc_ioctl(struct file *file,\n\t\tunsigned cmd, void __user *argp)\n{\n\tunsigned long __user *valp = compat_alloc_user_space(sizeof(*valp));\n\tint ret;\n\n\tif (valp == NULL)\n\t\treturn -EFAULT;\n\tswitch (cmd) {\n\tcase RTC_IRQP_READ32:\n\tcase RTC_EPOCH_READ32:\n\t\tret = do_ioctl(file, (cmd == RTC_IRQP_READ32) ?\n\t\t\t\t\tRTC_IRQP_READ : RTC_EPOCH_READ,\n\t\t\t\t\t(unsigned long)valp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\treturn convert_in_user(valp, (unsigned int __user *)argp);\n\tcase RTC_IRQP_SET32:\n\t\treturn do_ioctl(file, RTC_IRQP_SET, (unsigned long)argp);\n\tcase RTC_EPOCH_SET32:\n\t\treturn do_ioctl(file, RTC_EPOCH_SET, (unsigned long)argp);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mt_ioctl_trans",
          "args": [
            "file",
            "cmd",
            "argp"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "mt_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "382-428",
          "snippet": "static int mt_ioctl_trans(struct file *file,\n\t\tunsigned int cmd, void __user *argp)\n{\n\t/* NULL initialization to make gcc shut up */\n\tstruct mtget __user *get = NULL;\n\tstruct mtget32 __user *umget32;\n\tstruct mtpos __user *pos = NULL;\n\tstruct mtpos32 __user *upos32;\n\tunsigned long kcmd;\n\tvoid *karg;\n\tint err = 0;\n\n\tswitch(cmd) {\n\tcase MTIOCPOS32:\n\t\tkcmd = MTIOCPOS;\n\t\tpos = compat_alloc_user_space(sizeof(*pos));\n\t\tkarg = pos;\n\t\tbreak;\n\tdefault:\t/* MTIOCGET32 */\n\t\tkcmd = MTIOCGET;\n\t\tget = compat_alloc_user_space(sizeof(*get));\n\t\tkarg = get;\n\t\tbreak;\n\t}\n\tif (karg == NULL)\n\t\treturn -EFAULT;\n\terr = do_ioctl(file, kcmd, (unsigned long)karg);\n\tif (err)\n\t\treturn err;\n\tswitch (cmd) {\n\tcase MTIOCPOS32:\n\t\tupos32 = argp;\n\t\terr = convert_in_user(&pos->mt_blkno, &upos32->mt_blkno);\n\t\tbreak;\n\tcase MTIOCGET32:\n\t\tumget32 = argp;\n\t\terr = convert_in_user(&get->mt_type, &umget32->mt_type);\n\t\terr |= convert_in_user(&get->mt_resid, &umget32->mt_resid);\n\t\terr |= convert_in_user(&get->mt_dsreg, &umget32->mt_dsreg);\n\t\terr |= convert_in_user(&get->mt_gstat, &umget32->mt_gstat);\n\t\terr |= convert_in_user(&get->mt_erreg, &umget32->mt_erreg);\n\t\terr |= convert_in_user(&get->mt_fileno, &umget32->mt_fileno);\n\t\terr |= convert_in_user(&get->mt_blkno, &umget32->mt_blkno);\n\t\tbreak;\n\t}\n\treturn err ? -EFAULT: 0;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
            "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n\nstatic int mt_ioctl_trans(struct file *file,\n\t\tunsigned int cmd, void __user *argp)\n{\n\t/* NULL initialization to make gcc shut up */\n\tstruct mtget __user *get = NULL;\n\tstruct mtget32 __user *umget32;\n\tstruct mtpos __user *pos = NULL;\n\tstruct mtpos32 __user *upos32;\n\tunsigned long kcmd;\n\tvoid *karg;\n\tint err = 0;\n\n\tswitch(cmd) {\n\tcase MTIOCPOS32:\n\t\tkcmd = MTIOCPOS;\n\t\tpos = compat_alloc_user_space(sizeof(*pos));\n\t\tkarg = pos;\n\t\tbreak;\n\tdefault:\t/* MTIOCGET32 */\n\t\tkcmd = MTIOCGET;\n\t\tget = compat_alloc_user_space(sizeof(*get));\n\t\tkarg = get;\n\t\tbreak;\n\t}\n\tif (karg == NULL)\n\t\treturn -EFAULT;\n\terr = do_ioctl(file, kcmd, (unsigned long)karg);\n\tif (err)\n\t\treturn err;\n\tswitch (cmd) {\n\tcase MTIOCPOS32:\n\t\tupos32 = argp;\n\t\terr = convert_in_user(&pos->mt_blkno, &upos32->mt_blkno);\n\t\tbreak;\n\tcase MTIOCGET32:\n\t\tumget32 = argp;\n\t\terr = convert_in_user(&get->mt_type, &umget32->mt_type);\n\t\terr |= convert_in_user(&get->mt_resid, &umget32->mt_resid);\n\t\terr |= convert_in_user(&get->mt_dsreg, &umget32->mt_dsreg);\n\t\terr |= convert_in_user(&get->mt_gstat, &umget32->mt_gstat);\n\t\terr |= convert_in_user(&get->mt_erreg, &umget32->mt_erreg);\n\t\terr |= convert_in_user(&get->mt_fileno, &umget32->mt_fileno);\n\t\terr |= convert_in_user(&get->mt_blkno, &umget32->mt_blkno);\n\t\tbreak;\n\t}\n\treturn err ? -EFAULT: 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sg_grt_trans",
          "args": [
            "file",
            "cmd",
            "argp"
          ],
          "line": 947
        },
        "resolved": true,
        "details": {
          "function_name": "sg_grt_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "250-271",
          "snippet": "static int sg_grt_trans(struct file *file,\n\t\tunsigned int cmd, struct compat_sg_req_info __user *o)\n{\n\tint err, i;\n\tsg_req_info_t __user *r;\n\tr = compat_alloc_user_space(sizeof(sg_req_info_t)*SG_MAX_QUEUE);\n\terr = do_ioctl(file, cmd, (unsigned long)r);\n\tif (err < 0)\n\t\treturn err;\n\tfor (i = 0; i < SG_MAX_QUEUE; i++) {\n\t\tvoid __user *ptr;\n\t\tint d;\n\n\t\tif (copy_in_user(o + i, r + i, offsetof(sg_req_info_t, usr_ptr)) ||\n\t\t    get_user(ptr, &r[i].usr_ptr) ||\n\t\t    get_user(d, &r[i].duration) ||\n\t\t    put_user((u32)(unsigned long)(ptr), &o[i].usr_ptr) ||\n\t\t    put_user(d, &o[i].duration))\n\t\t\treturn -EFAULT;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_grt_trans(struct file *file,\n\t\tunsigned int cmd, struct compat_sg_req_info __user *o)\n{\n\tint err, i;\n\tsg_req_info_t __user *r;\n\tr = compat_alloc_user_space(sizeof(sg_req_info_t)*SG_MAX_QUEUE);\n\terr = do_ioctl(file, cmd, (unsigned long)r);\n\tif (err < 0)\n\t\treturn err;\n\tfor (i = 0; i < SG_MAX_QUEUE; i++) {\n\t\tvoid __user *ptr;\n\t\tint d;\n\n\t\tif (copy_in_user(o + i, r + i, offsetof(sg_req_info_t, usr_ptr)) ||\n\t\t    get_user(ptr, &r[i].usr_ptr) ||\n\t\t    get_user(d, &r[i].duration) ||\n\t\t    put_user((u32)(unsigned long)(ptr), &o[i].usr_ptr) ||\n\t\t    put_user(d, &o[i].duration))\n\t\t\treturn -EFAULT;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sg_ioctl_trans",
          "args": [
            "file",
            "cmd",
            "argp"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "sg_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "146-237",
          "snippet": "static int sg_ioctl_trans(struct file *file, unsigned int cmd,\n\t\t\tsg_io_hdr32_t __user *sgio32)\n{\n\tsg_io_hdr_t __user *sgio;\n\tu16 iovec_count;\n\tu32 data;\n\tvoid __user *dxferp;\n\tint err;\n\tint interface_id;\n\n\tif (get_user(interface_id, &sgio32->interface_id))\n\t\treturn -EFAULT;\n\tif (interface_id != 'S')\n\t\treturn do_ioctl(file, cmd, (unsigned long)sgio32);\n\n\tif (get_user(iovec_count, &sgio32->iovec_count))\n\t\treturn -EFAULT;\n\n\t{\n\t\tvoid __user *top = compat_alloc_user_space(0);\n\t\tvoid __user *new = compat_alloc_user_space(sizeof(sg_io_hdr_t) +\n\t\t\t\t       (iovec_count * sizeof(sg_iovec_t)));\n\t\tif (new > top)\n\t\t\treturn -EINVAL;\n\n\t\tsgio = new;\n\t}\n\n\t/* Ok, now construct.  */\n\tif (copy_in_user(&sgio->interface_id, &sgio32->interface_id,\n\t\t\t (2 * sizeof(int)) +\n\t\t\t (2 * sizeof(unsigned char)) +\n\t\t\t (1 * sizeof(unsigned short)) +\n\t\t\t (1 * sizeof(unsigned int))))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->dxferp))\n\t\treturn -EFAULT;\n\tdxferp = compat_ptr(data);\n\tif (iovec_count) {\n\t\tif (sg_build_iovec(sgio, dxferp, iovec_count))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tif (put_user(dxferp, &sgio->dxferp))\n\t\t\treturn -EFAULT;\n\t}\n\n\t{\n\t\tunsigned char __user *cmdp;\n\t\tunsigned char __user *sbp;\n\n\t\tif (get_user(data, &sgio32->cmdp))\n\t\t\treturn -EFAULT;\n\t\tcmdp = compat_ptr(data);\n\n\t\tif (get_user(data, &sgio32->sbp))\n\t\t\treturn -EFAULT;\n\t\tsbp = compat_ptr(data);\n\n\t\tif (put_user(cmdp, &sgio->cmdp) ||\n\t\t    put_user(sbp, &sgio->sbp))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (copy_in_user(&sgio->timeout, &sgio32->timeout,\n\t\t\t 3 * sizeof(int)))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->usr_ptr))\n\t\treturn -EFAULT;\n\tif (put_user(compat_ptr(data), &sgio->usr_ptr))\n\t\treturn -EFAULT;\n\n\terr = do_ioctl(file, cmd, (unsigned long) sgio);\n\n\tif (err >= 0) {\n\t\tvoid __user *datap;\n\n\t\tif (copy_in_user(&sgio32->pack_id, &sgio->pack_id,\n\t\t\t\t sizeof(int)) ||\n\t\t    get_user(datap, &sgio->usr_ptr) ||\n\t\t    put_user((u32)(unsigned long)datap,\n\t\t\t     &sgio32->usr_ptr) ||\n\t\t    copy_in_user(&sgio32->status, &sgio->status,\n\t\t\t\t (4 * sizeof(unsigned char)) +\n\t\t\t\t (2 * sizeof(unsigned short)) +\n\t\t\t\t (3 * sizeof(int))))\n\t\t\terr = -EFAULT;\n\t}\n\n\treturn err;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_ioctl_trans(struct file *file, unsigned int cmd,\n\t\t\tsg_io_hdr32_t __user *sgio32)\n{\n\tsg_io_hdr_t __user *sgio;\n\tu16 iovec_count;\n\tu32 data;\n\tvoid __user *dxferp;\n\tint err;\n\tint interface_id;\n\n\tif (get_user(interface_id, &sgio32->interface_id))\n\t\treturn -EFAULT;\n\tif (interface_id != 'S')\n\t\treturn do_ioctl(file, cmd, (unsigned long)sgio32);\n\n\tif (get_user(iovec_count, &sgio32->iovec_count))\n\t\treturn -EFAULT;\n\n\t{\n\t\tvoid __user *top = compat_alloc_user_space(0);\n\t\tvoid __user *new = compat_alloc_user_space(sizeof(sg_io_hdr_t) +\n\t\t\t\t       (iovec_count * sizeof(sg_iovec_t)));\n\t\tif (new > top)\n\t\t\treturn -EINVAL;\n\n\t\tsgio = new;\n\t}\n\n\t/* Ok, now construct.  */\n\tif (copy_in_user(&sgio->interface_id, &sgio32->interface_id,\n\t\t\t (2 * sizeof(int)) +\n\t\t\t (2 * sizeof(unsigned char)) +\n\t\t\t (1 * sizeof(unsigned short)) +\n\t\t\t (1 * sizeof(unsigned int))))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->dxferp))\n\t\treturn -EFAULT;\n\tdxferp = compat_ptr(data);\n\tif (iovec_count) {\n\t\tif (sg_build_iovec(sgio, dxferp, iovec_count))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tif (put_user(dxferp, &sgio->dxferp))\n\t\t\treturn -EFAULT;\n\t}\n\n\t{\n\t\tunsigned char __user *cmdp;\n\t\tunsigned char __user *sbp;\n\n\t\tif (get_user(data, &sgio32->cmdp))\n\t\t\treturn -EFAULT;\n\t\tcmdp = compat_ptr(data);\n\n\t\tif (get_user(data, &sgio32->sbp))\n\t\t\treturn -EFAULT;\n\t\tsbp = compat_ptr(data);\n\n\t\tif (put_user(cmdp, &sgio->cmdp) ||\n\t\t    put_user(sbp, &sgio->sbp))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (copy_in_user(&sgio->timeout, &sgio32->timeout,\n\t\t\t 3 * sizeof(int)))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->usr_ptr))\n\t\treturn -EFAULT;\n\tif (put_user(compat_ptr(data), &sgio->usr_ptr))\n\t\treturn -EFAULT;\n\n\terr = do_ioctl(file, cmd, (unsigned long) sgio);\n\n\tif (err >= 0) {\n\t\tvoid __user *datap;\n\n\t\tif (copy_in_user(&sgio32->pack_id, &sgio->pack_id,\n\t\t\t\t sizeof(int)) ||\n\t\t    get_user(datap, &sgio->usr_ptr) ||\n\t\t    put_user((u32)(unsigned long)datap,\n\t\t\t     &sgio32->usr_ptr) ||\n\t\t    copy_in_user(&sgio32->status, &sgio->status,\n\t\t\t\t (4 * sizeof(unsigned char)) +\n\t\t\t\t (2 * sizeof(unsigned short)) +\n\t\t\t\t (3 * sizeof(int))))\n\t\t\terr = -EFAULT;\n\t}\n\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppp_sock_fprog_ioctl_trans",
          "args": [
            "file",
            "cmd",
            "argp"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "ppp_sock_fprog_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "282-306",
          "snippet": "static int ppp_sock_fprog_ioctl_trans(struct file *file,\n\t\tunsigned int cmd, struct sock_fprog32 __user *u_fprog32)\n{\n\tstruct sock_fprog __user *u_fprog64 = compat_alloc_user_space(sizeof(struct sock_fprog));\n\tvoid __user *fptr64;\n\tu32 fptr32;\n\tu16 flen;\n\n\tif (get_user(flen, &u_fprog32->len) ||\n\t    get_user(fptr32, &u_fprog32->filter))\n\t\treturn -EFAULT;\n\n\tfptr64 = compat_ptr(fptr32);\n\n\tif (put_user(flen, &u_fprog64->len) ||\n\t    put_user(fptr64, &u_fprog64->filter))\n\t\treturn -EFAULT;\n\n\tif (cmd == PPPIOCSPASS32)\n\t\tcmd = PPPIOCSPASS;\n\telse\n\t\tcmd = PPPIOCSACTIVE;\n\n\treturn do_ioctl(file, cmd, (unsigned long) u_fprog64);\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic int ppp_sock_fprog_ioctl_trans(struct file *file,\n\t\tunsigned int cmd, struct sock_fprog32 __user *u_fprog32)\n{\n\tstruct sock_fprog __user *u_fprog64 = compat_alloc_user_space(sizeof(struct sock_fprog));\n\tvoid __user *fptr64;\n\tu32 fptr32;\n\tu16 flen;\n\n\tif (get_user(flen, &u_fprog32->len) ||\n\t    get_user(fptr32, &u_fprog32->filter))\n\t\treturn -EFAULT;\n\n\tfptr64 = compat_ptr(fptr32);\n\n\tif (put_user(flen, &u_fprog64->len) ||\n\t    put_user(fptr64, &u_fprog64->filter))\n\t\treturn -EFAULT;\n\n\tif (cmd == PPPIOCSPASS32)\n\t\tcmd = PPPIOCSPASS;\n\telse\n\t\tcmd = PPPIOCSACTIVE;\n\n\treturn do_ioctl(file, cmd, (unsigned long) u_fprog64);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppp_scompress",
          "args": [
            "file",
            "cmd",
            "argp"
          ],
          "line": 939
        },
        "resolved": true,
        "details": {
          "function_name": "ppp_scompress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "342-363",
          "snippet": "static int ppp_scompress(struct file *file, unsigned int cmd,\n\tstruct ppp_option_data32 __user *odata32)\n{\n\tstruct ppp_option_data __user *odata;\n\t__u32 data;\n\tvoid __user *datap;\n\n\todata = compat_alloc_user_space(sizeof(*odata));\n\n\tif (get_user(data, &odata32->ptr))\n\t\treturn -EFAULT;\n\n\tdatap = compat_ptr(data);\n\tif (put_user(datap, &odata->ptr))\n\t\treturn -EFAULT;\n\n\tif (copy_in_user(&odata->length, &odata32->length,\n\t\t\t sizeof(__u32) + sizeof(int)))\n\t\treturn -EFAULT;\n\n\treturn do_ioctl(file, PPPIOCSCOMPRESS, (unsigned long) odata);\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int ppp_scompress(struct file *file, unsigned int cmd,\n\tstruct ppp_option_data32 __user *odata32)\n{\n\tstruct ppp_option_data __user *odata;\n\t__u32 data;\n\tvoid __user *datap;\n\n\todata = compat_alloc_user_space(sizeof(*odata));\n\n\tif (get_user(data, &odata32->ptr))\n\t\treturn -EFAULT;\n\n\tdatap = compat_ptr(data);\n\tif (put_user(datap, &odata->ptr))\n\t\treturn -EFAULT;\n\n\tif (copy_in_user(&odata->length, &odata32->length,\n\t\t\t sizeof(__u32) + sizeof(int)))\n\t\treturn -EFAULT;\n\n\treturn do_ioctl(file, PPPIOCSCOMPRESS, (unsigned long) odata);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ppp_gidle",
          "args": [
            "file",
            "cmd",
            "argp"
          ],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "ppp_gidle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "321-340",
          "snippet": "static int ppp_gidle(struct file *file, unsigned int cmd,\n\t\tstruct ppp_idle32 __user *idle32)\n{\n\tstruct ppp_idle __user *idle;\n\t__kernel_time_t xmit, recv;\n\tint err;\n\n\tidle = compat_alloc_user_space(sizeof(*idle));\n\n\terr = do_ioctl(file, PPPIOCGIDLE, (unsigned long) idle);\n\n\tif (!err) {\n\t\tif (get_user(xmit, &idle->xmit_idle) ||\n\t\t    get_user(recv, &idle->recv_idle) ||\n\t\t    put_user(xmit, &idle32->xmit_idle) ||\n\t\t    put_user(recv, &idle32->recv_idle))\n\t\t\terr = -EFAULT;\n\t}\n\treturn err;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int ppp_gidle(struct file *file, unsigned int cmd,\n\t\tstruct ppp_idle32 __user *idle32)\n{\n\tstruct ppp_idle __user *idle;\n\t__kernel_time_t xmit, recv;\n\tint err;\n\n\tidle = compat_alloc_user_space(sizeof(*idle));\n\n\terr = do_ioctl(file, PPPIOCGIDLE, (unsigned long) idle);\n\n\tif (!err) {\n\t\tif (get_user(xmit, &idle->xmit_idle) ||\n\t\t    get_user(recv, &idle->recv_idle) ||\n\t\t    put_user(xmit, &idle32->xmit_idle) ||\n\t\t    put_user(recv, &idle32->recv_idle))\n\t\t\terr = -EFAULT;\n\t}\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "arg"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
  },
  {
    "function_name": "compat_ioctl_preallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "487-502",
    "snippet": "static int compat_ioctl_preallocate(struct file *file,\n\t\t\tstruct space_resv_32    __user *p32)\n{\n\tstruct space_resv\t__user *p = compat_alloc_user_space(sizeof(*p));\n\n\tif (copy_in_user(&p->l_type,\t&p32->l_type,\tsizeof(s16)) ||\n\t    copy_in_user(&p->l_whence,\t&p32->l_whence, sizeof(s16)) ||\n\t    copy_in_user(&p->l_start,\t&p32->l_start,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_len,\t&p32->l_len,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_sysid,\t&p32->l_sysid,\tsizeof(s32)) ||\n\t    copy_in_user(&p->l_pid,\t&p32->l_pid,\tsizeof(u32)) ||\n\t    copy_in_user(&p->l_pad,\t&p32->l_pad,\t4*sizeof(u32)))\n\t\treturn -EFAULT;\n\n\treturn ioctl_preallocate(file, p);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl_preallocate",
          "args": [
            "file",
            "p"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "compat_ioctl_preallocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "487-502",
          "snippet": "static int compat_ioctl_preallocate(struct file *file,\n\t\t\tstruct space_resv_32    __user *p32)\n{\n\tstruct space_resv\t__user *p = compat_alloc_user_space(sizeof(*p));\n\n\tif (copy_in_user(&p->l_type,\t&p32->l_type,\tsizeof(s16)) ||\n\t    copy_in_user(&p->l_whence,\t&p32->l_whence, sizeof(s16)) ||\n\t    copy_in_user(&p->l_start,\t&p32->l_start,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_len,\t&p32->l_len,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_sysid,\t&p32->l_sysid,\tsizeof(s32)) ||\n\t    copy_in_user(&p->l_pid,\t&p32->l_pid,\tsizeof(u32)) ||\n\t    copy_in_user(&p->l_pad,\t&p32->l_pad,\t4*sizeof(u32)))\n\t\treturn -EFAULT;\n\n\treturn ioctl_preallocate(file, p);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_pad",
            "&p32->l_pad",
            "4*sizeof(u32)"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_pid",
            "&p32->l_pid",
            "sizeof(u32)"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_sysid",
            "&p32->l_sysid",
            "sizeof(s32)"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_len",
            "&p32->l_len",
            "sizeof(s64)"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_start",
            "&p32->l_start",
            "sizeof(s64)"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_whence",
            "&p32->l_whence",
            "sizeof(s16)"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&p->l_type",
            "&p32->l_type",
            "sizeof(s16)"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*p)"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int compat_ioctl_preallocate(struct file *file,\n\t\t\tstruct space_resv_32    __user *p32)\n{\n\tstruct space_resv\t__user *p = compat_alloc_user_space(sizeof(*p));\n\n\tif (copy_in_user(&p->l_type,\t&p32->l_type,\tsizeof(s16)) ||\n\t    copy_in_user(&p->l_whence,\t&p32->l_whence, sizeof(s16)) ||\n\t    copy_in_user(&p->l_start,\t&p32->l_start,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_len,\t&p32->l_len,\tsizeof(s64)) ||\n\t    copy_in_user(&p->l_sysid,\t&p32->l_sysid,\tsizeof(s32)) ||\n\t    copy_in_user(&p->l_pid,\t&p32->l_pid,\tsizeof(u32)) ||\n\t    copy_in_user(&p->l_pad,\t&p32->l_pad,\t4*sizeof(u32)))\n\t\treturn -EFAULT;\n\n\treturn ioctl_preallocate(file, p);\n}"
  },
  {
    "function_name": "rtc_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "444-468",
    "snippet": "static int rtc_ioctl(struct file *file,\n\t\tunsigned cmd, void __user *argp)\n{\n\tunsigned long __user *valp = compat_alloc_user_space(sizeof(*valp));\n\tint ret;\n\n\tif (valp == NULL)\n\t\treturn -EFAULT;\n\tswitch (cmd) {\n\tcase RTC_IRQP_READ32:\n\tcase RTC_EPOCH_READ32:\n\t\tret = do_ioctl(file, (cmd == RTC_IRQP_READ32) ?\n\t\t\t\t\tRTC_IRQP_READ : RTC_EPOCH_READ,\n\t\t\t\t\t(unsigned long)valp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\treturn convert_in_user(valp, (unsigned int __user *)argp);\n\tcase RTC_IRQP_SET32:\n\t\treturn do_ioctl(file, RTC_IRQP_SET, (unsigned long)argp);\n\tcase RTC_EPOCH_SET32:\n\t\treturn do_ioctl(file, RTC_EPOCH_SET, (unsigned long)argp);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
      "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
      "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
      "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_ioctl",
          "args": [
            "file",
            "RTC_EPOCH_SET",
            "(unsigned long)argp"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "do_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "930-974",
          "snippet": "static long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
            "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
            "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
            "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
            "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
            "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
            "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
            "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
            "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
            "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "valp",
            "(unsigned int __user *)argp"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*valp)"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n\nstatic int rtc_ioctl(struct file *file,\n\t\tunsigned cmd, void __user *argp)\n{\n\tunsigned long __user *valp = compat_alloc_user_space(sizeof(*valp));\n\tint ret;\n\n\tif (valp == NULL)\n\t\treturn -EFAULT;\n\tswitch (cmd) {\n\tcase RTC_IRQP_READ32:\n\tcase RTC_EPOCH_READ32:\n\t\tret = do_ioctl(file, (cmd == RTC_IRQP_READ32) ?\n\t\t\t\t\tRTC_IRQP_READ : RTC_EPOCH_READ,\n\t\t\t\t\t(unsigned long)valp);\n\t\tif (ret)\n\t\t\treturn ret;\n\t\treturn convert_in_user(valp, (unsigned int __user *)argp);\n\tcase RTC_IRQP_SET32:\n\t\treturn do_ioctl(file, RTC_IRQP_SET, (unsigned long)argp);\n\tcase RTC_EPOCH_SET32:\n\t\treturn do_ioctl(file, RTC_EPOCH_SET, (unsigned long)argp);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
  },
  {
    "function_name": "mt_ioctl_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "382-428",
    "snippet": "static int mt_ioctl_trans(struct file *file,\n\t\tunsigned int cmd, void __user *argp)\n{\n\t/* NULL initialization to make gcc shut up */\n\tstruct mtget __user *get = NULL;\n\tstruct mtget32 __user *umget32;\n\tstruct mtpos __user *pos = NULL;\n\tstruct mtpos32 __user *upos32;\n\tunsigned long kcmd;\n\tvoid *karg;\n\tint err = 0;\n\n\tswitch(cmd) {\n\tcase MTIOCPOS32:\n\t\tkcmd = MTIOCPOS;\n\t\tpos = compat_alloc_user_space(sizeof(*pos));\n\t\tkarg = pos;\n\t\tbreak;\n\tdefault:\t/* MTIOCGET32 */\n\t\tkcmd = MTIOCGET;\n\t\tget = compat_alloc_user_space(sizeof(*get));\n\t\tkarg = get;\n\t\tbreak;\n\t}\n\tif (karg == NULL)\n\t\treturn -EFAULT;\n\terr = do_ioctl(file, kcmd, (unsigned long)karg);\n\tif (err)\n\t\treturn err;\n\tswitch (cmd) {\n\tcase MTIOCPOS32:\n\t\tupos32 = argp;\n\t\terr = convert_in_user(&pos->mt_blkno, &upos32->mt_blkno);\n\t\tbreak;\n\tcase MTIOCGET32:\n\t\tumget32 = argp;\n\t\terr = convert_in_user(&get->mt_type, &umget32->mt_type);\n\t\terr |= convert_in_user(&get->mt_resid, &umget32->mt_resid);\n\t\terr |= convert_in_user(&get->mt_dsreg, &umget32->mt_dsreg);\n\t\terr |= convert_in_user(&get->mt_gstat, &umget32->mt_gstat);\n\t\terr |= convert_in_user(&get->mt_erreg, &umget32->mt_erreg);\n\t\terr |= convert_in_user(&get->mt_fileno, &umget32->mt_fileno);\n\t\terr |= convert_in_user(&get->mt_blkno, &umget32->mt_blkno);\n\t\tbreak;\n\t}\n\treturn err ? -EFAULT: 0;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
      "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "&get->mt_blkno",
            "&umget32->mt_blkno"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "&get->mt_fileno",
            "&umget32->mt_fileno"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "&get->mt_erreg",
            "&umget32->mt_erreg"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "&get->mt_gstat",
            "&umget32->mt_gstat"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "&get->mt_dsreg",
            "&umget32->mt_dsreg"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "&get->mt_resid",
            "&umget32->mt_resid"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "&get->mt_type",
            "&umget32->mt_type"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert_in_user",
          "args": [
            "&pos->mt_blkno",
            "&upos32->mt_blkno"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_ioctl",
          "args": [
            "file",
            "kcmd",
            "(unsigned long)karg"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "do_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "930-974",
          "snippet": "static long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
            "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
            "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
            "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
            "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
            "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
            "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
            "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
            "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
            "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*get)"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*pos)"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n\nstatic int mt_ioctl_trans(struct file *file,\n\t\tunsigned int cmd, void __user *argp)\n{\n\t/* NULL initialization to make gcc shut up */\n\tstruct mtget __user *get = NULL;\n\tstruct mtget32 __user *umget32;\n\tstruct mtpos __user *pos = NULL;\n\tstruct mtpos32 __user *upos32;\n\tunsigned long kcmd;\n\tvoid *karg;\n\tint err = 0;\n\n\tswitch(cmd) {\n\tcase MTIOCPOS32:\n\t\tkcmd = MTIOCPOS;\n\t\tpos = compat_alloc_user_space(sizeof(*pos));\n\t\tkarg = pos;\n\t\tbreak;\n\tdefault:\t/* MTIOCGET32 */\n\t\tkcmd = MTIOCGET;\n\t\tget = compat_alloc_user_space(sizeof(*get));\n\t\tkarg = get;\n\t\tbreak;\n\t}\n\tif (karg == NULL)\n\t\treturn -EFAULT;\n\terr = do_ioctl(file, kcmd, (unsigned long)karg);\n\tif (err)\n\t\treturn err;\n\tswitch (cmd) {\n\tcase MTIOCPOS32:\n\t\tupos32 = argp;\n\t\terr = convert_in_user(&pos->mt_blkno, &upos32->mt_blkno);\n\t\tbreak;\n\tcase MTIOCGET32:\n\t\tumget32 = argp;\n\t\terr = convert_in_user(&get->mt_type, &umget32->mt_type);\n\t\terr |= convert_in_user(&get->mt_resid, &umget32->mt_resid);\n\t\terr |= convert_in_user(&get->mt_dsreg, &umget32->mt_dsreg);\n\t\terr |= convert_in_user(&get->mt_gstat, &umget32->mt_gstat);\n\t\terr |= convert_in_user(&get->mt_erreg, &umget32->mt_erreg);\n\t\terr |= convert_in_user(&get->mt_fileno, &umget32->mt_fileno);\n\t\terr |= convert_in_user(&get->mt_blkno, &umget32->mt_blkno);\n\t\tbreak;\n\t}\n\treturn err ? -EFAULT: 0;\n}"
  },
  {
    "function_name": "ppp_scompress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "342-363",
    "snippet": "static int ppp_scompress(struct file *file, unsigned int cmd,\n\tstruct ppp_option_data32 __user *odata32)\n{\n\tstruct ppp_option_data __user *odata;\n\t__u32 data;\n\tvoid __user *datap;\n\n\todata = compat_alloc_user_space(sizeof(*odata));\n\n\tif (get_user(data, &odata32->ptr))\n\t\treturn -EFAULT;\n\n\tdatap = compat_ptr(data);\n\tif (put_user(datap, &odata->ptr))\n\t\treturn -EFAULT;\n\n\tif (copy_in_user(&odata->length, &odata32->length,\n\t\t\t sizeof(__u32) + sizeof(int)))\n\t\treturn -EFAULT;\n\n\treturn do_ioctl(file, PPPIOCSCOMPRESS, (unsigned long) odata);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_ioctl",
          "args": [
            "file",
            "PPPIOCSCOMPRESS",
            "(unsigned long) odata"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "do_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "930-974",
          "snippet": "static long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
            "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
            "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
            "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
            "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
            "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
            "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
            "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
            "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
            "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&odata->length",
            "&odata32->length",
            "sizeof(__u32) + sizeof(int)"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "datap",
            "&odata->ptr"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "data",
            "&odata32->ptr"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/exec.c",
          "lines": "446-465",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/vmalloc.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*odata)"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int ppp_scompress(struct file *file, unsigned int cmd,\n\tstruct ppp_option_data32 __user *odata32)\n{\n\tstruct ppp_option_data __user *odata;\n\t__u32 data;\n\tvoid __user *datap;\n\n\todata = compat_alloc_user_space(sizeof(*odata));\n\n\tif (get_user(data, &odata32->ptr))\n\t\treturn -EFAULT;\n\n\tdatap = compat_ptr(data);\n\tif (put_user(datap, &odata->ptr))\n\t\treturn -EFAULT;\n\n\tif (copy_in_user(&odata->length, &odata32->length,\n\t\t\t sizeof(__u32) + sizeof(int)))\n\t\treturn -EFAULT;\n\n\treturn do_ioctl(file, PPPIOCSCOMPRESS, (unsigned long) odata);\n}"
  },
  {
    "function_name": "ppp_gidle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "321-340",
    "snippet": "static int ppp_gidle(struct file *file, unsigned int cmd,\n\t\tstruct ppp_idle32 __user *idle32)\n{\n\tstruct ppp_idle __user *idle;\n\t__kernel_time_t xmit, recv;\n\tint err;\n\n\tidle = compat_alloc_user_space(sizeof(*idle));\n\n\terr = do_ioctl(file, PPPIOCGIDLE, (unsigned long) idle);\n\n\tif (!err) {\n\t\tif (get_user(xmit, &idle->xmit_idle) ||\n\t\t    get_user(recv, &idle->recv_idle) ||\n\t\t    put_user(xmit, &idle32->xmit_idle) ||\n\t\t    put_user(recv, &idle32->recv_idle))\n\t\t\terr = -EFAULT;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "recv",
            "&idle32->recv_idle"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "xmit",
            "&idle32->xmit_idle"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "recv",
            "&idle->recv_idle"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/exec.c",
          "lines": "446-465",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/vmalloc.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "do_ioctl",
          "args": [
            "file",
            "PPPIOCGIDLE",
            "(unsigned long) idle"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "do_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "930-974",
          "snippet": "static long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
            "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
            "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
            "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
            "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
            "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
            "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
            "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
            "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
            "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(*idle)"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int ppp_gidle(struct file *file, unsigned int cmd,\n\t\tstruct ppp_idle32 __user *idle32)\n{\n\tstruct ppp_idle __user *idle;\n\t__kernel_time_t xmit, recv;\n\tint err;\n\n\tidle = compat_alloc_user_space(sizeof(*idle));\n\n\terr = do_ioctl(file, PPPIOCGIDLE, (unsigned long) idle);\n\n\tif (!err) {\n\t\tif (get_user(xmit, &idle->xmit_idle) ||\n\t\t    get_user(recv, &idle->recv_idle) ||\n\t\t    put_user(xmit, &idle32->xmit_idle) ||\n\t\t    put_user(recv, &idle32->recv_idle))\n\t\t\terr = -EFAULT;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "ppp_sock_fprog_ioctl_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "282-306",
    "snippet": "static int ppp_sock_fprog_ioctl_trans(struct file *file,\n\t\tunsigned int cmd, struct sock_fprog32 __user *u_fprog32)\n{\n\tstruct sock_fprog __user *u_fprog64 = compat_alloc_user_space(sizeof(struct sock_fprog));\n\tvoid __user *fptr64;\n\tu32 fptr32;\n\tu16 flen;\n\n\tif (get_user(flen, &u_fprog32->len) ||\n\t    get_user(fptr32, &u_fprog32->filter))\n\t\treturn -EFAULT;\n\n\tfptr64 = compat_ptr(fptr32);\n\n\tif (put_user(flen, &u_fprog64->len) ||\n\t    put_user(fptr64, &u_fprog64->filter))\n\t\treturn -EFAULT;\n\n\tif (cmd == PPPIOCSPASS32)\n\t\tcmd = PPPIOCSPASS;\n\telse\n\t\tcmd = PPPIOCSACTIVE;\n\n\treturn do_ioctl(file, cmd, (unsigned long) u_fprog64);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "do_ioctl",
          "args": [
            "file",
            "cmd",
            "(unsigned long) u_fprog64"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "do_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "930-974",
          "snippet": "static long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
            "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
            "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
            "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
            "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
            "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
            "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
            "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
            "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
            "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "fptr64",
            "&u_fprog64->filter"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "flen",
            "&u_fprog64->len"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "fptr32"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "fptr32",
            "&u_fprog32->filter"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/exec.c",
          "lines": "446-465",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/vmalloc.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(struct sock_fprog)"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic int ppp_sock_fprog_ioctl_trans(struct file *file,\n\t\tunsigned int cmd, struct sock_fprog32 __user *u_fprog32)\n{\n\tstruct sock_fprog __user *u_fprog64 = compat_alloc_user_space(sizeof(struct sock_fprog));\n\tvoid __user *fptr64;\n\tu32 fptr32;\n\tu16 flen;\n\n\tif (get_user(flen, &u_fprog32->len) ||\n\t    get_user(fptr32, &u_fprog32->filter))\n\t\treturn -EFAULT;\n\n\tfptr64 = compat_ptr(fptr32);\n\n\tif (put_user(flen, &u_fprog64->len) ||\n\t    put_user(fptr64, &u_fprog64->filter))\n\t\treturn -EFAULT;\n\n\tif (cmd == PPPIOCSPASS32)\n\t\tcmd = PPPIOCSPASS;\n\telse\n\t\tcmd = PPPIOCSACTIVE;\n\n\treturn do_ioctl(file, cmd, (unsigned long) u_fprog64);\n}"
  },
  {
    "function_name": "sg_grt_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "250-271",
    "snippet": "static int sg_grt_trans(struct file *file,\n\t\tunsigned int cmd, struct compat_sg_req_info __user *o)\n{\n\tint err, i;\n\tsg_req_info_t __user *r;\n\tr = compat_alloc_user_space(sizeof(sg_req_info_t)*SG_MAX_QUEUE);\n\terr = do_ioctl(file, cmd, (unsigned long)r);\n\tif (err < 0)\n\t\treturn err;\n\tfor (i = 0; i < SG_MAX_QUEUE; i++) {\n\t\tvoid __user *ptr;\n\t\tint d;\n\n\t\tif (copy_in_user(o + i, r + i, offsetof(sg_req_info_t, usr_ptr)) ||\n\t\t    get_user(ptr, &r[i].usr_ptr) ||\n\t\t    get_user(d, &r[i].duration) ||\n\t\t    put_user((u32)(unsigned long)(ptr), &o[i].usr_ptr) ||\n\t\t    put_user(d, &o[i].duration))\n\t\t\treturn -EFAULT;\n\t}\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "d",
            "&o[i].duration"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "(u32)(unsigned long)(ptr)",
            "&o[i].usr_ptr"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "d",
            "&r[i].duration"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/exec.c",
          "lines": "446-465",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/vmalloc.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "o + i",
            "r + i",
            "offsetof(sg_req_info_t, usr_ptr)"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_ioctl",
          "args": [
            "file",
            "cmd",
            "(unsigned long)r"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "do_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "930-974",
          "snippet": "static long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
            "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
            "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
            "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
            "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
            "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
            "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
            "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
            "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
            "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(sg_req_info_t)*SG_MAX_QUEUE"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_grt_trans(struct file *file,\n\t\tunsigned int cmd, struct compat_sg_req_info __user *o)\n{\n\tint err, i;\n\tsg_req_info_t __user *r;\n\tr = compat_alloc_user_space(sizeof(sg_req_info_t)*SG_MAX_QUEUE);\n\terr = do_ioctl(file, cmd, (unsigned long)r);\n\tif (err < 0)\n\t\treturn err;\n\tfor (i = 0; i < SG_MAX_QUEUE; i++) {\n\t\tvoid __user *ptr;\n\t\tint d;\n\n\t\tif (copy_in_user(o + i, r + i, offsetof(sg_req_info_t, usr_ptr)) ||\n\t\t    get_user(ptr, &r[i].usr_ptr) ||\n\t\t    get_user(d, &r[i].duration) ||\n\t\t    put_user((u32)(unsigned long)(ptr), &o[i].usr_ptr) ||\n\t\t    put_user(d, &o[i].duration))\n\t\t\treturn -EFAULT;\n\t}\n\treturn err;\n}"
  },
  {
    "function_name": "sg_ioctl_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "146-237",
    "snippet": "static int sg_ioctl_trans(struct file *file, unsigned int cmd,\n\t\t\tsg_io_hdr32_t __user *sgio32)\n{\n\tsg_io_hdr_t __user *sgio;\n\tu16 iovec_count;\n\tu32 data;\n\tvoid __user *dxferp;\n\tint err;\n\tint interface_id;\n\n\tif (get_user(interface_id, &sgio32->interface_id))\n\t\treturn -EFAULT;\n\tif (interface_id != 'S')\n\t\treturn do_ioctl(file, cmd, (unsigned long)sgio32);\n\n\tif (get_user(iovec_count, &sgio32->iovec_count))\n\t\treturn -EFAULT;\n\n\t{\n\t\tvoid __user *top = compat_alloc_user_space(0);\n\t\tvoid __user *new = compat_alloc_user_space(sizeof(sg_io_hdr_t) +\n\t\t\t\t       (iovec_count * sizeof(sg_iovec_t)));\n\t\tif (new > top)\n\t\t\treturn -EINVAL;\n\n\t\tsgio = new;\n\t}\n\n\t/* Ok, now construct.  */\n\tif (copy_in_user(&sgio->interface_id, &sgio32->interface_id,\n\t\t\t (2 * sizeof(int)) +\n\t\t\t (2 * sizeof(unsigned char)) +\n\t\t\t (1 * sizeof(unsigned short)) +\n\t\t\t (1 * sizeof(unsigned int))))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->dxferp))\n\t\treturn -EFAULT;\n\tdxferp = compat_ptr(data);\n\tif (iovec_count) {\n\t\tif (sg_build_iovec(sgio, dxferp, iovec_count))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tif (put_user(dxferp, &sgio->dxferp))\n\t\t\treturn -EFAULT;\n\t}\n\n\t{\n\t\tunsigned char __user *cmdp;\n\t\tunsigned char __user *sbp;\n\n\t\tif (get_user(data, &sgio32->cmdp))\n\t\t\treturn -EFAULT;\n\t\tcmdp = compat_ptr(data);\n\n\t\tif (get_user(data, &sgio32->sbp))\n\t\t\treturn -EFAULT;\n\t\tsbp = compat_ptr(data);\n\n\t\tif (put_user(cmdp, &sgio->cmdp) ||\n\t\t    put_user(sbp, &sgio->sbp))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (copy_in_user(&sgio->timeout, &sgio32->timeout,\n\t\t\t 3 * sizeof(int)))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->usr_ptr))\n\t\treturn -EFAULT;\n\tif (put_user(compat_ptr(data), &sgio->usr_ptr))\n\t\treturn -EFAULT;\n\n\terr = do_ioctl(file, cmd, (unsigned long) sgio);\n\n\tif (err >= 0) {\n\t\tvoid __user *datap;\n\n\t\tif (copy_in_user(&sgio32->pack_id, &sgio->pack_id,\n\t\t\t\t sizeof(int)) ||\n\t\t    get_user(datap, &sgio->usr_ptr) ||\n\t\t    put_user((u32)(unsigned long)datap,\n\t\t\t     &sgio32->usr_ptr) ||\n\t\t    copy_in_user(&sgio32->status, &sgio->status,\n\t\t\t\t (4 * sizeof(unsigned char)) +\n\t\t\t\t (2 * sizeof(unsigned short)) +\n\t\t\t\t (3 * sizeof(int))))\n\t\t\terr = -EFAULT;\n\t}\n\n\treturn err;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&sgio32->status",
            "&sgio->status",
            "(4 * sizeof(unsigned char)) +\n\t\t\t\t (2 * sizeof(unsigned short)) +\n\t\t\t\t (3 * sizeof(int))"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "(u32)(unsigned long)datap",
            "&sgio32->usr_ptr"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "datap",
            "&sgio->usr_ptr"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/exec.c",
          "lines": "446-465",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/vmalloc.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&sgio32->pack_id",
            "&sgio->pack_id",
            "sizeof(int)"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_ioctl",
          "args": [
            "file",
            "cmd",
            "(unsigned long) sgio"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "do_ioctl_trans",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "930-974",
          "snippet": "static long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [
            "#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)",
            "#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)",
            "#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)",
            "#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)",
            "#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)",
            "#define MTIOCGET32\t_IOR('m', 2, struct mtget32)",
            "#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)",
            "#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)",
            "#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)",
            "#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define RTC_EPOCH_SET32\t\t_IOW('p', 0x0e, compat_ulong_t)\n#define RTC_EPOCH_READ32\t_IOR('p', 0x0d, compat_ulong_t)\n#define RTC_IRQP_SET32\t\t_IOW('p', 0x0c, compat_ulong_t)\n#define RTC_IRQP_READ32\t\t_IOR('p', 0x0b, compat_ulong_t)\n#define MTIOCPOS32\t_IOR('m', 3, struct mtpos32)\n#define MTIOCGET32\t_IOR('m', 2, struct mtget32)\n#define PPPIOCGIDLE32\t\t_IOR('t', 63, struct ppp_idle32)\n#define PPPIOCSCOMPRESS32\t_IOW('t', 77, struct ppp_option_data32)\n#define PPPIOCSACTIVE32\t_IOW('t', 70, struct sock_fprog32)\n#define PPPIOCSPASS32\t_IOW('t', 71, struct sock_fprog32)\n\nstatic long do_ioctl_trans(unsigned int cmd,\n\t\t unsigned long arg, struct file *file)\n{\n\tvoid __user *argp = compat_ptr(arg);\n\n\tswitch (cmd) {\n\tcase PPPIOCGIDLE32:\n\t\treturn ppp_gidle(file, cmd, argp);\n\tcase PPPIOCSCOMPRESS32:\n\t\treturn ppp_scompress(file, cmd, argp);\n\tcase PPPIOCSPASS32:\n\tcase PPPIOCSACTIVE32:\n\t\treturn ppp_sock_fprog_ioctl_trans(file, cmd, argp);\n#ifdef CONFIG_BLOCK\n\tcase SG_IO:\n\t\treturn sg_ioctl_trans(file, cmd, argp);\n\tcase SG_GET_REQUEST_TABLE:\n\t\treturn sg_grt_trans(file, cmd, argp);\n\tcase MTIOCGET32:\n\tcase MTIOCPOS32:\n\t\treturn mt_ioctl_trans(file, cmd, argp);\n#endif\n\t/* Not implemented in the native kernel */\n\tcase RTC_IRQP_READ32:\n\tcase RTC_IRQP_SET32:\n\tcase RTC_EPOCH_READ32:\n\tcase RTC_EPOCH_SET32:\n\t\treturn rtc_ioctl(file, cmd, argp);\n\t}\n\n\t/*\n\t * These take an integer instead of a pointer as 'arg',\n\t * so we must not do a compat_ptr() translation.\n\t */\n\tswitch (cmd) {\n\t/* RAID */\n\tcase HOT_REMOVE_DISK:\n\tcase HOT_ADD_DISK:\n\tcase SET_DISK_FAULTY:\n\tcase SET_BITMAP_FILE:\n\t\treturn vfs_ioctl(file, cmd, arg);\n\t}\n\n\treturn -ENOIOCTLCMD;\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "compat_ptr(data)",
            "&sgio->usr_ptr"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&sgio->timeout",
            "&sgio32->timeout",
            "3 * sizeof(int)"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "sbp",
            "&sgio->sbp"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "cmdp",
            "&sgio->cmdp"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "dxferp",
            "&sgio->dxferp"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sg_build_iovec",
          "args": [
            "sgio",
            "dxferp",
            "iovec_count"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "sg_build_iovec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
          "lines": "125-144",
          "snippet": "static int sg_build_iovec(sg_io_hdr_t __user *sgio, void __user *dxferp, u16 iovec_count)\n{\n\tsg_iovec_t __user *iov = (sg_iovec_t __user *) (sgio + 1);\n\tsg_iovec32_t __user *iov32 = dxferp;\n\tint i;\n\n\tfor (i = 0; i < iovec_count; i++) {\n\t\tu32 base, len;\n\n\t\tif (get_user(base, &iov32[i].iov_base) ||\n\t\t    get_user(len, &iov32[i].iov_len) ||\n\t\t    put_user(compat_ptr(base), &iov[i].iov_base) ||\n\t\t    put_user(len, &iov[i].iov_len))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (put_user(iov, &sgio->dxferp))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
          "includes": [
            "#include <asm/fbio.h>",
            "#include <linux/fb.h>",
            "#include <linux/sort.h>",
            "#include <linux/hiddev.h>",
            "#include <linux/soundcard.h>",
            "#include <linux/watchdog.h>",
            "#include <linux/uaccess.h>",
            "#include <scsi/sg.h>",
            "#include <scsi/scsi_ioctl.h>",
            "#include <scsi/scsi.h>",
            "#include <linux/fd.h>",
            "#include <linux/cdrom.h>",
            "#include <linux/gigaset_dev.h>",
            "#include <linux/capi.h>",
            "#include <net/bluetooth/rfcomm.h>",
            "#include <net/bluetooth/hci_sock.h>",
            "#include <net/bluetooth/bluetooth.h>",
            "#include \"internal.h\"",
            "#include <linux/cec.h>",
            "#include <linux/gfp.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/ctype.h>",
            "#include <linux/serial.h>",
            "#include <linux/pci.h>",
            "#include <linux/rtc.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/raw.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/tty.h>",
            "#include <linux/mtio.h>",
            "#include <linux/if_pppox.h>",
            "#include <linux/ppp-ioctl.h>",
            "#include <linux/file.h>",
            "#include <linux/falloc.h>",
            "#include <linux/raid/md_u.h>",
            "#include <linux/if.h>",
            "#include <linux/ioctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/compiler.h>",
            "#include <linux/capability.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compat.h>",
            "#include <linux/types.h>",
            "#include <linux/joystick.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_build_iovec(sg_io_hdr_t __user *sgio, void __user *dxferp, u16 iovec_count)\n{\n\tsg_iovec_t __user *iov = (sg_iovec_t __user *) (sgio + 1);\n\tsg_iovec32_t __user *iov32 = dxferp;\n\tint i;\n\n\tfor (i = 0; i < iovec_count; i++) {\n\t\tu32 base, len;\n\n\t\tif (get_user(base, &iov32[i].iov_base) ||\n\t\t    get_user(len, &iov32[i].iov_len) ||\n\t\t    put_user(compat_ptr(base), &iov[i].iov_base) ||\n\t\t    put_user(len, &iov[i].iov_len))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (put_user(iov, &sgio->dxferp))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "data"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_in_user",
          "args": [
            "&sgio->interface_id",
            "&sgio32->interface_id",
            "(2 * sizeof(int)) +\n\t\t\t (2 * sizeof(unsigned char)) +\n\t\t\t (1 * sizeof(unsigned short)) +\n\t\t\t (1 * sizeof(unsigned int))"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "sizeof(sg_io_hdr_t) +\n\t\t\t\t       (iovec_count * sizeof(sg_iovec_t))"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_alloc_user_space",
          "args": [
            "0"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_ioctl_trans(struct file *file, unsigned int cmd,\n\t\t\tsg_io_hdr32_t __user *sgio32)\n{\n\tsg_io_hdr_t __user *sgio;\n\tu16 iovec_count;\n\tu32 data;\n\tvoid __user *dxferp;\n\tint err;\n\tint interface_id;\n\n\tif (get_user(interface_id, &sgio32->interface_id))\n\t\treturn -EFAULT;\n\tif (interface_id != 'S')\n\t\treturn do_ioctl(file, cmd, (unsigned long)sgio32);\n\n\tif (get_user(iovec_count, &sgio32->iovec_count))\n\t\treturn -EFAULT;\n\n\t{\n\t\tvoid __user *top = compat_alloc_user_space(0);\n\t\tvoid __user *new = compat_alloc_user_space(sizeof(sg_io_hdr_t) +\n\t\t\t\t       (iovec_count * sizeof(sg_iovec_t)));\n\t\tif (new > top)\n\t\t\treturn -EINVAL;\n\n\t\tsgio = new;\n\t}\n\n\t/* Ok, now construct.  */\n\tif (copy_in_user(&sgio->interface_id, &sgio32->interface_id,\n\t\t\t (2 * sizeof(int)) +\n\t\t\t (2 * sizeof(unsigned char)) +\n\t\t\t (1 * sizeof(unsigned short)) +\n\t\t\t (1 * sizeof(unsigned int))))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->dxferp))\n\t\treturn -EFAULT;\n\tdxferp = compat_ptr(data);\n\tif (iovec_count) {\n\t\tif (sg_build_iovec(sgio, dxferp, iovec_count))\n\t\t\treturn -EFAULT;\n\t} else {\n\t\tif (put_user(dxferp, &sgio->dxferp))\n\t\t\treturn -EFAULT;\n\t}\n\n\t{\n\t\tunsigned char __user *cmdp;\n\t\tunsigned char __user *sbp;\n\n\t\tif (get_user(data, &sgio32->cmdp))\n\t\t\treturn -EFAULT;\n\t\tcmdp = compat_ptr(data);\n\n\t\tif (get_user(data, &sgio32->sbp))\n\t\t\treturn -EFAULT;\n\t\tsbp = compat_ptr(data);\n\n\t\tif (put_user(cmdp, &sgio->cmdp) ||\n\t\t    put_user(sbp, &sgio->sbp))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (copy_in_user(&sgio->timeout, &sgio32->timeout,\n\t\t\t 3 * sizeof(int)))\n\t\treturn -EFAULT;\n\n\tif (get_user(data, &sgio32->usr_ptr))\n\t\treturn -EFAULT;\n\tif (put_user(compat_ptr(data), &sgio->usr_ptr))\n\t\treturn -EFAULT;\n\n\terr = do_ioctl(file, cmd, (unsigned long) sgio);\n\n\tif (err >= 0) {\n\t\tvoid __user *datap;\n\n\t\tif (copy_in_user(&sgio32->pack_id, &sgio->pack_id,\n\t\t\t\t sizeof(int)) ||\n\t\t    get_user(datap, &sgio->usr_ptr) ||\n\t\t    put_user((u32)(unsigned long)datap,\n\t\t\t     &sgio32->usr_ptr) ||\n\t\t    copy_in_user(&sgio32->status, &sgio->status,\n\t\t\t\t (4 * sizeof(unsigned char)) +\n\t\t\t\t (2 * sizeof(unsigned short)) +\n\t\t\t\t (3 * sizeof(int))))\n\t\t\terr = -EFAULT;\n\t}\n\n\treturn err;\n}"
  },
  {
    "function_name": "sg_build_iovec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "125-144",
    "snippet": "static int sg_build_iovec(sg_io_hdr_t __user *sgio, void __user *dxferp, u16 iovec_count)\n{\n\tsg_iovec_t __user *iov = (sg_iovec_t __user *) (sgio + 1);\n\tsg_iovec32_t __user *iov32 = dxferp;\n\tint i;\n\n\tfor (i = 0; i < iovec_count; i++) {\n\t\tu32 base, len;\n\n\t\tif (get_user(base, &iov32[i].iov_base) ||\n\t\t    get_user(len, &iov32[i].iov_len) ||\n\t\t    put_user(compat_ptr(base), &iov[i].iov_base) ||\n\t\t    put_user(len, &iov[i].iov_len))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (put_user(iov, &sgio->dxferp))\n\t\treturn -EFAULT;\n\treturn 0;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "iov",
            "&sgio->dxferp"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "len",
            "&iov[i].iov_len"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "compat_ptr(base)",
            "&iov[i].iov_base"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compat_ptr",
          "args": [
            "base"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user",
          "args": [
            "len",
            "&iov32[i].iov_len"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "get_user_arg_ptr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/exec.c",
          "lines": "446-465",
          "snippet": "static const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}",
          "includes": [
            "#include <trace/events/sched.h>",
            "#include \"internal.h\"",
            "#include <trace/events/task.h>",
            "#include <asm/tlb.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/freezer.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/compat.h>",
            "#include <linux/oom.h>",
            "#include <linux/pipe_fs_i.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/kmod.h>",
            "#include <linux/tracehook.h>",
            "#include <linux/audit.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/mount.h>",
            "#include <linux/namei.h>",
            "#include <linux/module.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/utsname.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/personality.h>",
            "#include <linux/key.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/highmem.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/string.h>",
            "#include <linux/swap.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/stat.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/sched.h>\n#include \"internal.h\"\n#include <trace/events/task.h>\n#include <asm/tlb.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/freezer.h>\n#include <linux/vmalloc.h>\n#include <linux/compat.h>\n#include <linux/oom.h>\n#include <linux/pipe_fs_i.h>\n#include <linux/fs_struct.h>\n#include <linux/fsnotify.h>\n#include <linux/kmod.h>\n#include <linux/tracehook.h>\n#include <linux/audit.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/mount.h>\n#include <linux/namei.h>\n#include <linux/module.h>\n#include <linux/pid_namespace.h>\n#include <linux/utsname.h>\n#include <linux/binfmts.h>\n#include <linux/personality.h>\n#include <linux/key.h>\n#include <linux/spinlock.h>\n#include <linux/highmem.h>\n#include <linux/perf_event.h>\n#include <linux/pagemap.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/init.h>\n#include <linux/string.h>\n#include <linux/swap.h>\n#include <linux/fcntl.h>\n#include <linux/stat.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n\nstatic const char __user *get_user_arg_ptr(struct user_arg_ptr argv, int nr)\n{\n\tconst char __user *native;\n\n#ifdef CONFIG_COMPAT\n\tif (unlikely(argv.is_compat)) {\n\t\tcompat_uptr_t compat;\n\n\t\tif (get_user(compat, argv.ptr.compat + nr))\n\t\t\treturn ERR_PTR(-EFAULT);\n\n\t\treturn compat_ptr(compat);\n\t}\n#endif\n\n\tif (get_user(native, argv.ptr.native + nr))\n\t\treturn ERR_PTR(-EFAULT);\n\n\treturn native;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int sg_build_iovec(sg_io_hdr_t __user *sgio, void __user *dxferp, u16 iovec_count)\n{\n\tsg_iovec_t __user *iov = (sg_iovec_t __user *) (sgio + 1);\n\tsg_iovec32_t __user *iov32 = dxferp;\n\tint i;\n\n\tfor (i = 0; i < iovec_count; i++) {\n\t\tu32 base, len;\n\n\t\tif (get_user(base, &iov32[i].iov_base) ||\n\t\t    get_user(len, &iov32[i].iov_len) ||\n\t\t    put_user(compat_ptr(base), &iov[i].iov_base) ||\n\t\t    put_user(len, &iov[i].iov_len))\n\t\t\treturn -EFAULT;\n\t}\n\n\tif (put_user(iov, &sgio->dxferp))\n\t\treturn -EFAULT;\n\treturn 0;\n}"
  },
  {
    "function_name": "do_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "82-91",
    "snippet": "static int do_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n{\n\tint err;\n\n\terr = security_file_ioctl(file, cmd, arg);\n\tif (err)\n\t\treturn err;\n\n\treturn vfs_ioctl(file, cmd, arg);\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfs_ioctl",
          "args": [
            "file",
            "cmd",
            "arg"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "vfs_ioctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ioctl.c",
          "lines": "39-51",
          "snippet": "long vfs_ioctl(struct file *filp, unsigned int cmd, unsigned long arg)\n{\n\tint error = -ENOTTY;\n\n\tif (!filp->f_op->unlocked_ioctl)\n\t\tgoto out;\n\n\terror = filp->f_op->unlocked_ioctl(filp, cmd, arg);\n\tif (error == -ENOIOCTLCMD)\n\t\terror = -ENOTTY;\n out:\n\treturn error;\n}",
          "includes": [
            "#include <asm/ioctls.h>",
            "#include \"internal.h\"",
            "#include <linux/sched/signal.h>",
            "#include <linux/falloc.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/writeback.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/export.h>",
            "#include <linux/security.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>",
            "#include <linux/mm.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/ioctls.h>\n#include \"internal.h\"\n#include <linux/sched/signal.h>\n#include <linux/falloc.h>\n#include <linux/buffer_head.h>\n#include <linux/writeback.h>\n#include <linux/uaccess.h>\n#include <linux/export.h>\n#include <linux/security.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n#include <linux/mm.h>\n#include <linux/syscalls.h>\n\nlong vfs_ioctl(struct file *filp, unsigned int cmd, unsigned long arg)\n{\n\tint error = -ENOTTY;\n\n\tif (!filp->f_op->unlocked_ioctl)\n\t\tgoto out;\n\n\terror = filp->f_op->unlocked_ioctl(filp, cmd, arg);\n\tif (error == -ENOIOCTLCMD)\n\t\terror = -ENOTTY;\n out:\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "security_file_ioctl",
          "args": [
            "file",
            "cmd",
            "arg"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\nstatic int do_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n{\n\tint err;\n\n\terr = security_file_ioctl(file, cmd, arg);\n\tif (err)\n\t\treturn err;\n\n\treturn vfs_ioctl(file, cmd, arg);\n}"
  },
  {
    "function_name": "ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/compat_ioctl.c",
    "lines": "998-1079",
    "snippet": "SYSCALL_DEFINE3(ioctl, unsigned int, fd, unsigned int, cmd,\n\t\t       compat_ulong_t, arg32)\n{\n\tunsigned long arg = arg32;\n\tstruct fd f = fdget(fd);\n\tint error = -EBADF;\n\tif (!f.file)\n\t\tgoto out;\n\n\t/* RED-PEN how should LSM module know it's handling 32bit? */\n\terror = security_file_ioctl(f.file, cmd, arg);\n\tif (error)\n\t\tgoto out_fput;\n\n\t/*\n\t * To allow the compat_ioctl handlers to be self contained\n\t * we need to check the common ioctls here first.\n\t * Just handle them with the standard handlers below.\n\t */\n\tswitch (cmd) {\n\tcase FIOCLEX:\n\tcase FIONCLEX:\n\tcase FIONBIO:\n\tcase FIOASYNC:\n\tcase FIOQSIZE:\n\t\tbreak;\n\n#if defined(CONFIG_IA64) || defined(CONFIG_X86_64)\n\tcase FS_IOC_RESVSP_32:\n\tcase FS_IOC_RESVSP64_32:\n\t\terror = compat_ioctl_preallocate(f.file, compat_ptr(arg));\n\t\tgoto out_fput;\n#else\n\tcase FS_IOC_RESVSP:\n\tcase FS_IOC_RESVSP64:\n\t\terror = ioctl_preallocate(f.file, compat_ptr(arg));\n\t\tgoto out_fput;\n#endif\n\n\tcase FICLONE:\n\tcase FICLONERANGE:\n\tcase FIDEDUPERANGE:\n\tcase FS_IOC_FIEMAP:\n\t\tgoto do_ioctl;\n\n\tcase FIBMAP:\n\tcase FIGETBSZ:\n\tcase FIONREAD:\n\t\tif (S_ISREG(file_inode(f.file)->i_mode))\n\t\t\tbreak;\n\t\t/*FALL THROUGH*/\n\n\tdefault:\n\t\tif (f.file->f_op->compat_ioctl) {\n\t\t\terror = f.file->f_op->compat_ioctl(f.file, cmd, arg);\n\t\t\tif (error != -ENOIOCTLCMD)\n\t\t\t\tgoto out_fput;\n\t\t}\n\n\t\tif (!f.file->f_op->unlocked_ioctl)\n\t\t\tgoto do_ioctl;\n\t\tbreak;\n\t}\n\n\tif (compat_ioctl_check_table(XFORM(cmd)))\n\t\tgoto found_handler;\n\n\terror = do_ioctl_trans(cmd, arg, f.file);\n\tif (error == -ENOIOCTLCMD)\n\t\terror = -ENOTTY;\n\n\tgoto out_fput;\n\n found_handler:\n\targ = (unsigned long)compat_ptr(arg);\n do_ioctl:\n\terror = do_vfs_ioctl(f.file, fd, cmd, arg);\n out_fput:\n\tfdput(f);\n out:\n\treturn error;\n}",
    "includes": [
      "#include <asm/fbio.h>",
      "#include <linux/fb.h>",
      "#include <linux/sort.h>",
      "#include <linux/hiddev.h>",
      "#include <linux/soundcard.h>",
      "#include <linux/watchdog.h>",
      "#include <linux/uaccess.h>",
      "#include <scsi/sg.h>",
      "#include <scsi/scsi_ioctl.h>",
      "#include <scsi/scsi.h>",
      "#include <linux/fd.h>",
      "#include <linux/cdrom.h>",
      "#include <linux/gigaset_dev.h>",
      "#include <linux/capi.h>",
      "#include <net/bluetooth/rfcomm.h>",
      "#include <net/bluetooth/hci_sock.h>",
      "#include <net/bluetooth/bluetooth.h>",
      "#include \"internal.h\"",
      "#include <linux/cec.h>",
      "#include <linux/gfp.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/ctype.h>",
      "#include <linux/serial.h>",
      "#include <linux/pci.h>",
      "#include <linux/rtc.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/raw.h>",
      "#include <linux/vt_kern.h>",
      "#include <linux/tty.h>",
      "#include <linux/mtio.h>",
      "#include <linux/if_pppox.h>",
      "#include <linux/ppp-ioctl.h>",
      "#include <linux/file.h>",
      "#include <linux/falloc.h>",
      "#include <linux/raid/md_u.h>",
      "#include <linux/if.h>",
      "#include <linux/ioctl.h>",
      "#include <linux/smp.h>",
      "#include <linux/sched.h>",
      "#include <linux/compiler.h>",
      "#include <linux/capability.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compat.h>",
      "#include <linux/types.h>",
      "#include <linux/joystick.h>"
    ],
    "macros_used": [
      "#define FS_IOC_RESVSP64_32\t_IOW ('X', 42, struct space_resv_32)",
      "#define FS_IOC_RESVSP_32\t\t_IOW ('X', 40, struct space_resv_32)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <asm/fbio.h>\n#include <linux/fb.h>\n#include <linux/sort.h>\n#include <linux/hiddev.h>\n#include <linux/soundcard.h>\n#include <linux/watchdog.h>\n#include <linux/uaccess.h>\n#include <scsi/sg.h>\n#include <scsi/scsi_ioctl.h>\n#include <scsi/scsi.h>\n#include <linux/fd.h>\n#include <linux/cdrom.h>\n#include <linux/gigaset_dev.h>\n#include <linux/capi.h>\n#include <net/bluetooth/rfcomm.h>\n#include <net/bluetooth/hci_sock.h>\n#include <net/bluetooth/bluetooth.h>\n#include \"internal.h\"\n#include <linux/cec.h>\n#include <linux/gfp.h>\n#include <linux/syscalls.h>\n#include <linux/ctype.h>\n#include <linux/serial.h>\n#include <linux/pci.h>\n#include <linux/rtc.h>\n#include <linux/blkdev.h>\n#include <linux/raw.h>\n#include <linux/vt_kern.h>\n#include <linux/tty.h>\n#include <linux/mtio.h>\n#include <linux/if_pppox.h>\n#include <linux/ppp-ioctl.h>\n#include <linux/file.h>\n#include <linux/falloc.h>\n#include <linux/raid/md_u.h>\n#include <linux/if.h>\n#include <linux/ioctl.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/compiler.h>\n#include <linux/capability.h>\n#include <linux/kernel.h>\n#include <linux/compat.h>\n#include <linux/types.h>\n#include <linux/joystick.h>\n\n#define FS_IOC_RESVSP64_32\t_IOW ('X', 42, struct space_resv_32)\n#define FS_IOC_RESVSP_32\t\t_IOW ('X', 40, struct space_resv_32)\n\nSYSCALL_DEFINE3(ioctl, unsigned int, fd, unsigned int, cmd,\n\t\t       compat_ulong_t, arg32)\n{\n\tunsigned long arg = arg32;\n\tstruct fd f = fdget(fd);\n\tint error = -EBADF;\n\tif (!f.file)\n\t\tgoto out;\n\n\t/* RED-PEN how should LSM module know it's handling 32bit? */\n\terror = security_file_ioctl(f.file, cmd, arg);\n\tif (error)\n\t\tgoto out_fput;\n\n\t/*\n\t * To allow the compat_ioctl handlers to be self contained\n\t * we need to check the common ioctls here first.\n\t * Just handle them with the standard handlers below.\n\t */\n\tswitch (cmd) {\n\tcase FIOCLEX:\n\tcase FIONCLEX:\n\tcase FIONBIO:\n\tcase FIOASYNC:\n\tcase FIOQSIZE:\n\t\tbreak;\n\n#if defined(CONFIG_IA64) || defined(CONFIG_X86_64)\n\tcase FS_IOC_RESVSP_32:\n\tcase FS_IOC_RESVSP64_32:\n\t\terror = compat_ioctl_preallocate(f.file, compat_ptr(arg));\n\t\tgoto out_fput;\n#else\n\tcase FS_IOC_RESVSP:\n\tcase FS_IOC_RESVSP64:\n\t\terror = ioctl_preallocate(f.file, compat_ptr(arg));\n\t\tgoto out_fput;\n#endif\n\n\tcase FICLONE:\n\tcase FICLONERANGE:\n\tcase FIDEDUPERANGE:\n\tcase FS_IOC_FIEMAP:\n\t\tgoto do_ioctl;\n\n\tcase FIBMAP:\n\tcase FIGETBSZ:\n\tcase FIONREAD:\n\t\tif (S_ISREG(file_inode(f.file)->i_mode))\n\t\t\tbreak;\n\t\t/*FALL THROUGH*/\n\n\tdefault:\n\t\tif (f.file->f_op->compat_ioctl) {\n\t\t\terror = f.file->f_op->compat_ioctl(f.file, cmd, arg);\n\t\t\tif (error != -ENOIOCTLCMD)\n\t\t\t\tgoto out_fput;\n\t\t}\n\n\t\tif (!f.file->f_op->unlocked_ioctl)\n\t\t\tgoto do_ioctl;\n\t\tbreak;\n\t}\n\n\tif (compat_ioctl_check_table(XFORM(cmd)))\n\t\tgoto found_handler;\n\n\terror = do_ioctl_trans(cmd, arg, f.file);\n\tif (error == -ENOIOCTLCMD)\n\t\terror = -ENOTTY;\n\n\tgoto out_fput;\n\n found_handler:\n\targ = (unsigned long)compat_ptr(arg);\n do_ioctl:\n\terror = do_vfs_ioctl(f.file, fd, cmd, arg);\n out_fput:\n\tfdput(f);\n out:\n\treturn error;\n}"
  }
]