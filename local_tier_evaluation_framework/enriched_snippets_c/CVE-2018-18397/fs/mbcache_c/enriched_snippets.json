[
  {
    "function_name": "mbcache_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "426-429",
    "snippet": "static void __exit mbcache_exit(void)\n{\n\tkmem_cache_destroy(mb_entry_cache);\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *mb_entry_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "mb_entry_cache"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic struct kmem_cache *mb_entry_cache;\n\nstatic void __exit mbcache_exit(void)\n{\n\tkmem_cache_destroy(mb_entry_cache);\n}"
  },
  {
    "function_name": "mbcache_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "416-424",
    "snippet": "static int __init mbcache_init(void)\n{\n\tmb_entry_cache = kmem_cache_create(\"mbcache\",\n\t\t\t\tsizeof(struct mb_cache_entry), 0,\n\t\t\t\tSLAB_RECLAIM_ACCOUNT|SLAB_MEM_SPREAD, NULL);\n\tif (!mb_entry_cache)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *mb_entry_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"mbcache\"",
            "sizeof(struct mb_cache_entry)",
            "0",
            "SLAB_RECLAIM_ACCOUNT|SLAB_MEM_SPREAD",
            "NULL"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic struct kmem_cache *mb_entry_cache;\n\nstatic int __init mbcache_init(void)\n{\n\tmb_entry_cache = kmem_cache_create(\"mbcache\",\n\t\t\t\tsizeof(struct mb_cache_entry), 0,\n\t\t\t\tSLAB_RECLAIM_ACCOUNT|SLAB_MEM_SPREAD, NULL);\n\tif (!mb_entry_cache)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
  },
  {
    "function_name": "mb_cache_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "391-413",
    "snippet": "void mb_cache_destroy(struct mb_cache *cache)\n{\n\tstruct mb_cache_entry *entry, *next;\n\n\tunregister_shrinker(&cache->c_shrink);\n\n\t/*\n\t * We don't bother with any locking. Cache must not be used at this\n\t * point.\n\t */\n\tlist_for_each_entry_safe(entry, next, &cache->c_list, e_list) {\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t} else\n\t\t\tWARN_ON(1);\n\t\tlist_del(&entry->e_list);\n\t\tWARN_ON(atomic_read(&entry->e_refcnt) != 1);\n\t\tmb_cache_entry_put(cache, entry);\n\t}\n\tkfree(cache->c_hash);\n\tkfree(cache);\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_cache_entry_put",
          "args": [
            "cache",
            "entry"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "atomic_read(&entry->e_refcnt) != 1"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&entry->e_refcnt"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&entry->e_list"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "inode_sb_list_del",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/inode.c",
          "lines": "449-456",
          "snippet": "static inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode->i_sb->s_inode_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode->i_sb->s_inode_list_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/iversion.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/memblock.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/iversion.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/memblock.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nstatic inline void inode_sb_list_del(struct inode *inode)\n{\n\tif (!list_empty(&inode->i_sb_list)) {\n\t\tspin_lock(&inode->i_sb->s_inode_list_lock);\n\t\tlist_del_init(&inode->i_sb_list);\n\t\tspin_unlock(&inode->i_sb->s_inode_list_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "1"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&entry->e_refcnt"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_del_init",
          "args": [
            "&entry->e_hash_list"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unhashed",
          "args": [
            "&entry->e_hash_list"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "entry",
            "next",
            "&cache->c_list",
            "e_list"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_shrinker",
          "args": [
            "&cache->c_shrink"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ext4/extents_status.c",
          "lines": "1294-1299",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nvoid mb_cache_destroy(struct mb_cache *cache)\n{\n\tstruct mb_cache_entry *entry, *next;\n\n\tunregister_shrinker(&cache->c_shrink);\n\n\t/*\n\t * We don't bother with any locking. Cache must not be used at this\n\t * point.\n\t */\n\tlist_for_each_entry_safe(entry, next, &cache->c_list, e_list) {\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t} else\n\t\t\tWARN_ON(1);\n\t\tlist_del(&entry->e_list);\n\t\tWARN_ON(atomic_read(&entry->e_refcnt) != 1);\n\t\tmb_cache_entry_put(cache, entry);\n\t}\n\tkfree(cache->c_hash);\n\tkfree(cache);\n}"
  },
  {
    "function_name": "mb_cache_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "343-381",
    "snippet": "struct mb_cache *mb_cache_create(int bucket_bits)\n{\n\tstruct mb_cache *cache;\n\tunsigned long bucket_count = 1UL << bucket_bits;\n\tunsigned long i;\n\n\tcache = kzalloc(sizeof(struct mb_cache), GFP_KERNEL);\n\tif (!cache)\n\t\tgoto err_out;\n\tcache->c_bucket_bits = bucket_bits;\n\tcache->c_max_entries = bucket_count << 4;\n\tINIT_LIST_HEAD(&cache->c_list);\n\tspin_lock_init(&cache->c_list_lock);\n\tcache->c_hash = kmalloc_array(bucket_count,\n\t\t\t\t      sizeof(struct hlist_bl_head),\n\t\t\t\t      GFP_KERNEL);\n\tif (!cache->c_hash) {\n\t\tkfree(cache);\n\t\tgoto err_out;\n\t}\n\tfor (i = 0; i < bucket_count; i++)\n\t\tINIT_HLIST_BL_HEAD(&cache->c_hash[i]);\n\n\tcache->c_shrink.count_objects = mb_cache_count;\n\tcache->c_shrink.scan_objects = mb_cache_scan;\n\tcache->c_shrink.seeks = DEFAULT_SEEKS;\n\tif (register_shrinker(&cache->c_shrink)) {\n\t\tkfree(cache->c_hash);\n\t\tkfree(cache);\n\t\tgoto err_out;\n\t}\n\n\tINIT_WORK(&cache->c_shrink_work, mb_cache_shrink_worker);\n\n\treturn cache;\n\nerr_out:\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_WORK",
          "args": [
            "&cache->c_shrink_work",
            "mb_cache_shrink_worker"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "cache"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_shrinker",
          "args": [
            "&cache->c_shrink"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "ext4_es_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ext4/extents_status.c",
          "lines": "1294-1299",
          "snippet": "void ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}",
          "includes": [
            "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */",
            "#include <trace/events/ext4.h>",
            "#include \"ext4.h\"",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/list_sort.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ext4_extents.h\"\t/* Needed when ES_AGGRESSIVE_TEST is defined */\n#include <trace/events/ext4.h>\n#include \"ext4.h\"\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/list_sort.h>\n\nvoid ext4_es_unregister_shrinker(struct ext4_sb_info *sbi)\n{\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_all_cnt);\n\tpercpu_counter_destroy(&sbi->s_es_stats.es_stats_shk_cnt);\n\tunregister_shrinker(&sbi->s_es_shrinker);\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_HLIST_BL_HEAD",
          "args": [
            "&cache->c_hash[i]"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc_array",
          "args": [
            "bucket_count",
            "sizeof(struct hlist_bl_head)",
            "GFP_KERNEL"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&cache->c_list_lock"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&cache->c_list"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct mb_cache)",
            "GFP_KERNEL"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstruct mb_cache *mb_cache_create(int bucket_bits)\n{\n\tstruct mb_cache *cache;\n\tunsigned long bucket_count = 1UL << bucket_bits;\n\tunsigned long i;\n\n\tcache = kzalloc(sizeof(struct mb_cache), GFP_KERNEL);\n\tif (!cache)\n\t\tgoto err_out;\n\tcache->c_bucket_bits = bucket_bits;\n\tcache->c_max_entries = bucket_count << 4;\n\tINIT_LIST_HEAD(&cache->c_list);\n\tspin_lock_init(&cache->c_list_lock);\n\tcache->c_hash = kmalloc_array(bucket_count,\n\t\t\t\t      sizeof(struct hlist_bl_head),\n\t\t\t\t      GFP_KERNEL);\n\tif (!cache->c_hash) {\n\t\tkfree(cache);\n\t\tgoto err_out;\n\t}\n\tfor (i = 0; i < bucket_count; i++)\n\t\tINIT_HLIST_BL_HEAD(&cache->c_hash[i]);\n\n\tcache->c_shrink.count_objects = mb_cache_count;\n\tcache->c_shrink.scan_objects = mb_cache_scan;\n\tcache->c_shrink.seeks = DEFAULT_SEEKS;\n\tif (register_shrinker(&cache->c_shrink)) {\n\t\tkfree(cache->c_hash);\n\t\tkfree(cache);\n\t\tgoto err_out;\n\t}\n\n\tINIT_WORK(&cache->c_shrink_work, mb_cache_shrink_worker);\n\n\treturn cache;\n\nerr_out:\n\treturn NULL;\n}"
  },
  {
    "function_name": "mb_cache_shrink_worker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "330-335",
    "snippet": "static void mb_cache_shrink_worker(struct work_struct *work)\n{\n\tstruct mb_cache *cache = container_of(work, struct mb_cache,\n\t\t\t\t\t      c_shrink_work);\n\tmb_cache_shrink(cache, cache->c_max_entries / SHRINK_DIVISOR);\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [
      "#define SHRINK_DIVISOR 16"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mb_cache_shrink",
          "args": [
            "cache",
            "cache->c_max_entries / SHRINK_DIVISOR"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "mb_cache_shrink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "279-317",
          "snippet": "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan)\n{\n\tstruct mb_cache_entry *entry;\n\tstruct hlist_bl_head *head;\n\tunsigned long shrunk = 0;\n\n\tspin_lock(&cache->c_list_lock);\n\twhile (nr_to_scan-- && !list_empty(&cache->c_list)) {\n\t\tentry = list_first_entry(&cache->c_list,\n\t\t\t\t\t struct mb_cache_entry, e_list);\n\t\tif (entry->e_referenced) {\n\t\t\tentry->e_referenced = 0;\n\t\t\tlist_move_tail(&entry->e_list, &cache->c_list);\n\t\t\tcontinue;\n\t\t}\n\t\tlist_del_init(&entry->e_list);\n\t\tcache->c_entry_count--;\n\t\t/*\n\t\t * We keep LRU list reference so that entry doesn't go away\n\t\t * from under us.\n\t\t */\n\t\tspin_unlock(&cache->c_list_lock);\n\t\thead = mb_cache_entry_head(cache, entry->e_key);\n\t\thlist_bl_lock(head);\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t}\n\t\thlist_bl_unlock(head);\n\t\tif (mb_cache_entry_put(cache, entry))\n\t\t\tshrunk++;\n\t\tcond_resched();\n\t\tspin_lock(&cache->c_list_lock);\n\t}\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn shrunk;\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan)\n{\n\tstruct mb_cache_entry *entry;\n\tstruct hlist_bl_head *head;\n\tunsigned long shrunk = 0;\n\n\tspin_lock(&cache->c_list_lock);\n\twhile (nr_to_scan-- && !list_empty(&cache->c_list)) {\n\t\tentry = list_first_entry(&cache->c_list,\n\t\t\t\t\t struct mb_cache_entry, e_list);\n\t\tif (entry->e_referenced) {\n\t\t\tentry->e_referenced = 0;\n\t\t\tlist_move_tail(&entry->e_list, &cache->c_list);\n\t\t\tcontinue;\n\t\t}\n\t\tlist_del_init(&entry->e_list);\n\t\tcache->c_entry_count--;\n\t\t/*\n\t\t * We keep LRU list reference so that entry doesn't go away\n\t\t * from under us.\n\t\t */\n\t\tspin_unlock(&cache->c_list_lock);\n\t\thead = mb_cache_entry_head(cache, entry->e_key);\n\t\thlist_bl_lock(head);\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t}\n\t\thlist_bl_unlock(head);\n\t\tif (mb_cache_entry_put(cache, entry))\n\t\t\tshrunk++;\n\t\tcond_resched();\n\t\tspin_lock(&cache->c_list_lock);\n\t}\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn shrunk;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "work",
            "structmb_cache",
            "c_shrink_work"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\n#define SHRINK_DIVISOR 16\n\nstatic void mb_cache_shrink_worker(struct work_struct *work)\n{\n\tstruct mb_cache *cache = container_of(work, struct mb_cache,\n\t\t\t\t\t      c_shrink_work);\n\tmb_cache_shrink(cache, cache->c_max_entries / SHRINK_DIVISOR);\n}"
  },
  {
    "function_name": "mb_cache_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "319-325",
    "snippet": "static unsigned long mb_cache_scan(struct shrinker *shrink,\n\t\t\t\t   struct shrink_control *sc)\n{\n\tstruct mb_cache *cache = container_of(shrink, struct mb_cache,\n\t\t\t\t\t      c_shrink);\n\treturn mb_cache_shrink(cache, sc->nr_to_scan);\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mb_cache_shrink",
          "args": [
            "cache",
            "sc->nr_to_scan"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "mb_cache_shrink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "279-317",
          "snippet": "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan)\n{\n\tstruct mb_cache_entry *entry;\n\tstruct hlist_bl_head *head;\n\tunsigned long shrunk = 0;\n\n\tspin_lock(&cache->c_list_lock);\n\twhile (nr_to_scan-- && !list_empty(&cache->c_list)) {\n\t\tentry = list_first_entry(&cache->c_list,\n\t\t\t\t\t struct mb_cache_entry, e_list);\n\t\tif (entry->e_referenced) {\n\t\t\tentry->e_referenced = 0;\n\t\t\tlist_move_tail(&entry->e_list, &cache->c_list);\n\t\t\tcontinue;\n\t\t}\n\t\tlist_del_init(&entry->e_list);\n\t\tcache->c_entry_count--;\n\t\t/*\n\t\t * We keep LRU list reference so that entry doesn't go away\n\t\t * from under us.\n\t\t */\n\t\tspin_unlock(&cache->c_list_lock);\n\t\thead = mb_cache_entry_head(cache, entry->e_key);\n\t\thlist_bl_lock(head);\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t}\n\t\thlist_bl_unlock(head);\n\t\tif (mb_cache_entry_put(cache, entry))\n\t\t\tshrunk++;\n\t\tcond_resched();\n\t\tspin_lock(&cache->c_list_lock);\n\t}\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn shrunk;\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan)\n{\n\tstruct mb_cache_entry *entry;\n\tstruct hlist_bl_head *head;\n\tunsigned long shrunk = 0;\n\n\tspin_lock(&cache->c_list_lock);\n\twhile (nr_to_scan-- && !list_empty(&cache->c_list)) {\n\t\tentry = list_first_entry(&cache->c_list,\n\t\t\t\t\t struct mb_cache_entry, e_list);\n\t\tif (entry->e_referenced) {\n\t\t\tentry->e_referenced = 0;\n\t\t\tlist_move_tail(&entry->e_list, &cache->c_list);\n\t\t\tcontinue;\n\t\t}\n\t\tlist_del_init(&entry->e_list);\n\t\tcache->c_entry_count--;\n\t\t/*\n\t\t * We keep LRU list reference so that entry doesn't go away\n\t\t * from under us.\n\t\t */\n\t\tspin_unlock(&cache->c_list_lock);\n\t\thead = mb_cache_entry_head(cache, entry->e_key);\n\t\thlist_bl_lock(head);\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t}\n\t\thlist_bl_unlock(head);\n\t\tif (mb_cache_entry_put(cache, entry))\n\t\t\tshrunk++;\n\t\tcond_resched();\n\t\tspin_lock(&cache->c_list_lock);\n\t}\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn shrunk;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "shrink",
            "structmb_cache",
            "c_shrink"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);\n\nstatic unsigned long mb_cache_scan(struct shrinker *shrink,\n\t\t\t\t   struct shrink_control *sc)\n{\n\tstruct mb_cache *cache = container_of(shrink, struct mb_cache,\n\t\t\t\t\t      c_shrink);\n\treturn mb_cache_shrink(cache, sc->nr_to_scan);\n}"
  },
  {
    "function_name": "mb_cache_shrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "279-317",
    "snippet": "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan)\n{\n\tstruct mb_cache_entry *entry;\n\tstruct hlist_bl_head *head;\n\tunsigned long shrunk = 0;\n\n\tspin_lock(&cache->c_list_lock);\n\twhile (nr_to_scan-- && !list_empty(&cache->c_list)) {\n\t\tentry = list_first_entry(&cache->c_list,\n\t\t\t\t\t struct mb_cache_entry, e_list);\n\t\tif (entry->e_referenced) {\n\t\t\tentry->e_referenced = 0;\n\t\t\tlist_move_tail(&entry->e_list, &cache->c_list);\n\t\t\tcontinue;\n\t\t}\n\t\tlist_del_init(&entry->e_list);\n\t\tcache->c_entry_count--;\n\t\t/*\n\t\t * We keep LRU list reference so that entry doesn't go away\n\t\t * from under us.\n\t\t */\n\t\tspin_unlock(&cache->c_list_lock);\n\t\thead = mb_cache_entry_head(cache, entry->e_key);\n\t\thlist_bl_lock(head);\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t}\n\t\thlist_bl_unlock(head);\n\t\tif (mb_cache_entry_put(cache, entry))\n\t\t\tshrunk++;\n\t\tcond_resched();\n\t\tspin_lock(&cache->c_list_lock);\n\t}\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn shrunk;\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cache->c_list_lock"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cache->c_list_lock"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_cache_entry_put",
          "args": [
            "cache",
            "entry"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&entry->e_refcnt"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_del_init",
          "args": [
            "&entry->e_hash_list"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unhashed",
          "args": [
            "&entry->e_hash_list"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "head"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_cache_entry_head",
          "args": [
            "cache",
            "entry->e_key"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "mb_cache_entry_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "49-53",
          "snippet": "static inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&entry->e_list"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_move_tail",
          "args": [
            "&entry->e_list",
            "&cache->c_list"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry",
          "args": [
            "&cache->c_list",
            "structmb_cache_entry",
            "e_list"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&cache->c_list"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "577-586",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan)\n{\n\tstruct mb_cache_entry *entry;\n\tstruct hlist_bl_head *head;\n\tunsigned long shrunk = 0;\n\n\tspin_lock(&cache->c_list_lock);\n\twhile (nr_to_scan-- && !list_empty(&cache->c_list)) {\n\t\tentry = list_first_entry(&cache->c_list,\n\t\t\t\t\t struct mb_cache_entry, e_list);\n\t\tif (entry->e_referenced) {\n\t\t\tentry->e_referenced = 0;\n\t\t\tlist_move_tail(&entry->e_list, &cache->c_list);\n\t\t\tcontinue;\n\t\t}\n\t\tlist_del_init(&entry->e_list);\n\t\tcache->c_entry_count--;\n\t\t/*\n\t\t * We keep LRU list reference so that entry doesn't go away\n\t\t * from under us.\n\t\t */\n\t\tspin_unlock(&cache->c_list_lock);\n\t\thead = mb_cache_entry_head(cache, entry->e_key);\n\t\thlist_bl_lock(head);\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t}\n\t\thlist_bl_unlock(head);\n\t\tif (mb_cache_entry_put(cache, entry))\n\t\t\tshrunk++;\n\t\tcond_resched();\n\t\tspin_lock(&cache->c_list_lock);\n\t}\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn shrunk;\n}"
  },
  {
    "function_name": "mb_cache_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "269-276",
    "snippet": "static unsigned long mb_cache_count(struct shrinker *shrink,\n\t\t\t\t    struct shrink_control *sc)\n{\n\tstruct mb_cache *cache = container_of(shrink, struct mb_cache,\n\t\t\t\t\t      c_shrink);\n\n\treturn cache->c_entry_count;\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "shrink",
            "structmb_cache",
            "c_shrink"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic unsigned long mb_cache_count(struct shrinker *shrink,\n\t\t\t\t    struct shrink_control *sc)\n{\n\tstruct mb_cache *cache = container_of(shrink, struct mb_cache,\n\t\t\t\t\t      c_shrink);\n\n\treturn cache->c_entry_count;\n}"
  },
  {
    "function_name": "mb_cache_entry_touch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "262-266",
    "snippet": "void mb_cache_entry_touch(struct mb_cache *cache,\n\t\t\t  struct mb_cache_entry *entry)\n{\n\tentry->e_referenced = 1;\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nvoid mb_cache_entry_touch(struct mb_cache *cache,\n\t\t\t  struct mb_cache_entry *entry)\n{\n\tentry->e_referenced = 1;\n}"
  },
  {
    "function_name": "mb_cache_entry_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "226-253",
    "snippet": "void mb_cache_entry_delete(struct mb_cache *cache, u32 key, u64 value)\n{\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\tstruct mb_cache_entry *entry;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\thlist_bl_for_each_entry(entry, node, head, e_hash_list) {\n\t\tif (entry->e_key == key && entry->e_value == value) {\n\t\t\t/* We keep hash list reference to keep entry alive */\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\thlist_bl_unlock(head);\n\t\t\tspin_lock(&cache->c_list_lock);\n\t\t\tif (!list_empty(&entry->e_list)) {\n\t\t\t\tlist_del_init(&entry->e_list);\n\t\t\t\tif (!WARN_ONCE(cache->c_entry_count == 0,\n\t\t\"mbcache: attempt to decrement c_entry_count past zero\"))\n\t\t\t\t\tcache->c_entry_count--;\n\t\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t\t}\n\t\t\tspin_unlock(&cache->c_list_lock);\n\t\t\tmb_cache_entry_put(cache, entry);\n\t\t\treturn;\n\t\t}\n\t}\n\thlist_bl_unlock(head);\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_cache_entry_put",
          "args": [
            "cache",
            "entry"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cache->c_list_lock"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&entry->e_refcnt"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "cache->c_entry_count == 0",
            "\"mbcache: attempt to decrement c_entry_count past zero\""
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&entry->e_list"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&entry->e_list"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "dlm_dirty_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/dlm/dlmthread.c",
          "lines": "577-586",
          "snippet": "static int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}",
          "includes": [
            "#include \"cluster/masklog.h\"",
            "#include \"dlmdomain.h\"",
            "#include \"dlmcommon.h\"",
            "#include \"dlmapi.h\"",
            "#include \"cluster/tcp.h\"",
            "#include \"cluster/nodemanager.h\"",
            "#include \"cluster/heartbeat.h\"",
            "#include <linux/delay.h>",
            "#include <linux/kthread.h>",
            "#include <linux/timer.h>",
            "#include <linux/inet.h>",
            "#include <linux/socket.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/random.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>",
            "#include <linux/highmem.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void dlm_flush_asts(struct dlm_ctxt *dlm);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"cluster/masklog.h\"\n#include \"dlmdomain.h\"\n#include \"dlmcommon.h\"\n#include \"dlmapi.h\"\n#include \"cluster/tcp.h\"\n#include \"cluster/nodemanager.h\"\n#include \"cluster/heartbeat.h\"\n#include <linux/delay.h>\n#include <linux/kthread.h>\n#include <linux/timer.h>\n#include <linux/inet.h>\n#include <linux/socket.h>\n#include <linux/blkdev.h>\n#include <linux/random.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n#include <linux/highmem.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n#include <linux/module.h>\n\nstatic void dlm_flush_asts(struct dlm_ctxt *dlm);\n\nstatic int dlm_dirty_list_empty(struct dlm_ctxt *dlm)\n{\n\tint empty;\n\n\tspin_lock(&dlm->spinlock);\n\tempty = list_empty(&dlm->dirty_list);\n\tspin_unlock(&dlm->spinlock);\n\n\treturn empty;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cache->c_list_lock"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_del_init",
          "args": [
            "&entry->e_hash_list"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_for_each_entry",
          "args": [
            "entry",
            "node",
            "head",
            "e_hash_list"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "head"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_cache_entry_head",
          "args": [
            "cache",
            "key"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "mb_cache_entry_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "49-53",
          "snippet": "static inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nvoid mb_cache_entry_delete(struct mb_cache *cache, u32 key, u64 value)\n{\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\tstruct mb_cache_entry *entry;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\thlist_bl_for_each_entry(entry, node, head, e_hash_list) {\n\t\tif (entry->e_key == key && entry->e_value == value) {\n\t\t\t/* We keep hash list reference to keep entry alive */\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\thlist_bl_unlock(head);\n\t\t\tspin_lock(&cache->c_list_lock);\n\t\t\tif (!list_empty(&entry->e_list)) {\n\t\t\t\tlist_del_init(&entry->e_list);\n\t\t\t\tif (!WARN_ONCE(cache->c_entry_count == 0,\n\t\t\"mbcache: attempt to decrement c_entry_count past zero\"))\n\t\t\t\t\tcache->c_entry_count--;\n\t\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t\t}\n\t\t\tspin_unlock(&cache->c_list_lock);\n\t\t\tmb_cache_entry_put(cache, entry);\n\t\t\treturn;\n\t\t}\n\t}\n\thlist_bl_unlock(head);\n}"
  },
  {
    "function_name": "mb_cache_entry_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "197-216",
    "snippet": "struct mb_cache_entry *mb_cache_entry_get(struct mb_cache *cache, u32 key,\n\t\t\t\t\t  u64 value)\n{\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\tstruct mb_cache_entry *entry;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\thlist_bl_for_each_entry(entry, node, head, e_hash_list) {\n\t\tif (entry->e_key == key && entry->e_value == value) {\n\t\t\tatomic_inc(&entry->e_refcnt);\n\t\t\tgoto out;\n\t\t}\n\t}\n\tentry = NULL;\nout:\n\thlist_bl_unlock(head);\n\treturn entry;\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&entry->e_refcnt"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_for_each_entry",
          "args": [
            "entry",
            "node",
            "head",
            "e_hash_list"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "head"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_cache_entry_head",
          "args": [
            "cache",
            "key"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "mb_cache_entry_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "49-53",
          "snippet": "static inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstruct mb_cache_entry *mb_cache_entry_get(struct mb_cache *cache, u32 key,\n\t\t\t\t\t  u64 value)\n{\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\tstruct mb_cache_entry *entry;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\thlist_bl_for_each_entry(entry, node, head, e_hash_list) {\n\t\tif (entry->e_key == key && entry->e_value == value) {\n\t\t\tatomic_inc(&entry->e_refcnt);\n\t\t\tgoto out;\n\t\t}\n\t}\n\tentry = NULL;\nout:\n\thlist_bl_unlock(head);\n\treturn entry;\n}"
  },
  {
    "function_name": "mb_cache_entry_find_next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "184-188",
    "snippet": "struct mb_cache_entry *mb_cache_entry_find_next(struct mb_cache *cache,\n\t\t\t\t\t\tstruct mb_cache_entry *entry)\n{\n\treturn __entry_find(cache, entry, entry->e_key);\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__entry_find",
          "args": [
            "cache",
            "entry",
            "entry->e_key"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "__entry_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "127-157",
          "snippet": "static struct mb_cache_entry *__entry_find(struct mb_cache *cache,\n\t\t\t\t\t   struct mb_cache_entry *entry,\n\t\t\t\t\t   u32 key)\n{\n\tstruct mb_cache_entry *old_entry = entry;\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\tif (entry && !hlist_bl_unhashed(&entry->e_hash_list))\n\t\tnode = entry->e_hash_list.next;\n\telse\n\t\tnode = hlist_bl_first(head);\n\twhile (node) {\n\t\tentry = hlist_bl_entry(node, struct mb_cache_entry,\n\t\t\t\t       e_hash_list);\n\t\tif (entry->e_key == key && entry->e_reusable) {\n\t\t\tatomic_inc(&entry->e_refcnt);\n\t\t\tgoto out;\n\t\t}\n\t\tnode = node->next;\n\t}\n\tentry = NULL;\nout:\n\thlist_bl_unlock(head);\n\tif (old_entry)\n\t\tmb_cache_entry_put(cache, old_entry);\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic struct mb_cache_entry *__entry_find(struct mb_cache *cache,\n\t\t\t\t\t   struct mb_cache_entry *entry,\n\t\t\t\t\t   u32 key)\n{\n\tstruct mb_cache_entry *old_entry = entry;\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\tif (entry && !hlist_bl_unhashed(&entry->e_hash_list))\n\t\tnode = entry->e_hash_list.next;\n\telse\n\t\tnode = hlist_bl_first(head);\n\twhile (node) {\n\t\tentry = hlist_bl_entry(node, struct mb_cache_entry,\n\t\t\t\t       e_hash_list);\n\t\tif (entry->e_key == key && entry->e_reusable) {\n\t\t\tatomic_inc(&entry->e_refcnt);\n\t\t\tgoto out;\n\t\t}\n\t\tnode = node->next;\n\t}\n\tentry = NULL;\nout:\n\thlist_bl_unlock(head);\n\tif (old_entry)\n\t\tmb_cache_entry_put(cache, old_entry);\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstruct mb_cache_entry *mb_cache_entry_find_next(struct mb_cache *cache,\n\t\t\t\t\t\tstruct mb_cache_entry *entry)\n{\n\treturn __entry_find(cache, entry, entry->e_key);\n}"
  },
  {
    "function_name": "mb_cache_entry_find_first",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "167-171",
    "snippet": "struct mb_cache_entry *mb_cache_entry_find_first(struct mb_cache *cache,\n\t\t\t\t\t\t u32 key)\n{\n\treturn __entry_find(cache, NULL, key);\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__entry_find",
          "args": [
            "cache",
            "NULL",
            "key"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "__entry_find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "127-157",
          "snippet": "static struct mb_cache_entry *__entry_find(struct mb_cache *cache,\n\t\t\t\t\t   struct mb_cache_entry *entry,\n\t\t\t\t\t   u32 key)\n{\n\tstruct mb_cache_entry *old_entry = entry;\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\tif (entry && !hlist_bl_unhashed(&entry->e_hash_list))\n\t\tnode = entry->e_hash_list.next;\n\telse\n\t\tnode = hlist_bl_first(head);\n\twhile (node) {\n\t\tentry = hlist_bl_entry(node, struct mb_cache_entry,\n\t\t\t\t       e_hash_list);\n\t\tif (entry->e_key == key && entry->e_reusable) {\n\t\t\tatomic_inc(&entry->e_refcnt);\n\t\t\tgoto out;\n\t\t}\n\t\tnode = node->next;\n\t}\n\tentry = NULL;\nout:\n\thlist_bl_unlock(head);\n\tif (old_entry)\n\t\tmb_cache_entry_put(cache, old_entry);\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic struct mb_cache_entry *__entry_find(struct mb_cache *cache,\n\t\t\t\t\t   struct mb_cache_entry *entry,\n\t\t\t\t\t   u32 key)\n{\n\tstruct mb_cache_entry *old_entry = entry;\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\tif (entry && !hlist_bl_unhashed(&entry->e_hash_list))\n\t\tnode = entry->e_hash_list.next;\n\telse\n\t\tnode = hlist_bl_first(head);\n\twhile (node) {\n\t\tentry = hlist_bl_entry(node, struct mb_cache_entry,\n\t\t\t\t       e_hash_list);\n\t\tif (entry->e_key == key && entry->e_reusable) {\n\t\t\tatomic_inc(&entry->e_refcnt);\n\t\t\tgoto out;\n\t\t}\n\t\tnode = node->next;\n\t}\n\tentry = NULL;\nout:\n\thlist_bl_unlock(head);\n\tif (old_entry)\n\t\tmb_cache_entry_put(cache, old_entry);\n\n\treturn entry;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstruct mb_cache_entry *mb_cache_entry_find_first(struct mb_cache *cache,\n\t\t\t\t\t\t u32 key)\n{\n\treturn __entry_find(cache, NULL, key);\n}"
  },
  {
    "function_name": "__entry_find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "127-157",
    "snippet": "static struct mb_cache_entry *__entry_find(struct mb_cache *cache,\n\t\t\t\t\t   struct mb_cache_entry *entry,\n\t\t\t\t\t   u32 key)\n{\n\tstruct mb_cache_entry *old_entry = entry;\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\tif (entry && !hlist_bl_unhashed(&entry->e_hash_list))\n\t\tnode = entry->e_hash_list.next;\n\telse\n\t\tnode = hlist_bl_first(head);\n\twhile (node) {\n\t\tentry = hlist_bl_entry(node, struct mb_cache_entry,\n\t\t\t\t       e_hash_list);\n\t\tif (entry->e_key == key && entry->e_reusable) {\n\t\t\tatomic_inc(&entry->e_refcnt);\n\t\t\tgoto out;\n\t\t}\n\t\tnode = node->next;\n\t}\n\tentry = NULL;\nout:\n\thlist_bl_unlock(head);\n\tif (old_entry)\n\t\tmb_cache_entry_put(cache, old_entry);\n\n\treturn entry;\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mb_cache_entry_put",
          "args": [
            "cache",
            "old_entry"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&entry->e_refcnt"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_entry",
          "args": [
            "node",
            "structmb_cache_entry",
            "e_hash_list"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_first",
          "args": [
            "head"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unhashed",
          "args": [
            "&entry->e_hash_list"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "head"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_cache_entry_head",
          "args": [
            "cache",
            "key"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "mb_cache_entry_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "49-53",
          "snippet": "static inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic struct mb_cache_entry *__entry_find(struct mb_cache *cache,\n\t\t\t\t\t   struct mb_cache_entry *entry,\n\t\t\t\t\t   u32 key)\n{\n\tstruct mb_cache_entry *old_entry = entry;\n\tstruct hlist_bl_node *node;\n\tstruct hlist_bl_head *head;\n\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\tif (entry && !hlist_bl_unhashed(&entry->e_hash_list))\n\t\tnode = entry->e_hash_list.next;\n\telse\n\t\tnode = hlist_bl_first(head);\n\twhile (node) {\n\t\tentry = hlist_bl_entry(node, struct mb_cache_entry,\n\t\t\t\t       e_hash_list);\n\t\tif (entry->e_key == key && entry->e_reusable) {\n\t\t\tatomic_inc(&entry->e_refcnt);\n\t\t\tgoto out;\n\t\t}\n\t\tnode = node->next;\n\t}\n\tentry = NULL;\nout:\n\thlist_bl_unlock(head);\n\tif (old_entry)\n\t\tmb_cache_entry_put(cache, old_entry);\n\n\treturn entry;\n}"
  },
  {
    "function_name": "__mb_cache_entry_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "121-124",
    "snippet": "void __mb_cache_entry_free(struct mb_cache_entry *entry)\n{\n\tkmem_cache_free(mb_entry_cache, entry);\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *mb_entry_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "mb_entry_cache",
            "entry"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic struct kmem_cache *mb_entry_cache;\n\nvoid __mb_cache_entry_free(struct mb_cache_entry *entry)\n{\n\tkmem_cache_free(mb_entry_cache, entry);\n}"
  },
  {
    "function_name": "mb_cache_entry_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "73-118",
    "snippet": "int mb_cache_entry_create(struct mb_cache *cache, gfp_t mask, u32 key,\n\t\t\t  u64 value, bool reusable)\n{\n\tstruct mb_cache_entry *entry, *dup;\n\tstruct hlist_bl_node *dup_node;\n\tstruct hlist_bl_head *head;\n\n\t/* Schedule background reclaim if there are too many entries */\n\tif (cache->c_entry_count >= cache->c_max_entries)\n\t\tschedule_work(&cache->c_shrink_work);\n\t/* Do some sync reclaim if background reclaim cannot keep up */\n\tif (cache->c_entry_count >= 2*cache->c_max_entries)\n\t\tmb_cache_shrink(cache, SYNC_SHRINK_BATCH);\n\n\tentry = kmem_cache_alloc(mb_entry_cache, mask);\n\tif (!entry)\n\t\treturn -ENOMEM;\n\n\tINIT_LIST_HEAD(&entry->e_list);\n\t/* One ref for hash, one ref returned */\n\tatomic_set(&entry->e_refcnt, 1);\n\tentry->e_key = key;\n\tentry->e_value = value;\n\tentry->e_reusable = reusable;\n\tentry->e_referenced = 0;\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\thlist_bl_for_each_entry(dup, dup_node, head, e_hash_list) {\n\t\tif (dup->e_key == key && dup->e_value == value) {\n\t\t\thlist_bl_unlock(head);\n\t\t\tkmem_cache_free(mb_entry_cache, entry);\n\t\t\treturn -EBUSY;\n\t\t}\n\t}\n\thlist_bl_add_head(&entry->e_hash_list, head);\n\thlist_bl_unlock(head);\n\n\tspin_lock(&cache->c_list_lock);\n\tlist_add_tail(&entry->e_list, &cache->c_list);\n\t/* Grab ref for LRU list */\n\tatomic_inc(&entry->e_refcnt);\n\tcache->c_entry_count++;\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [
      "#define SYNC_SHRINK_BATCH 64"
    ],
    "globals_used": [
      "static struct kmem_cache *mb_entry_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cache->c_list_lock"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&entry->e_refcnt"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&entry->e_list",
            "&cache->c_list"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cache->c_list_lock"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_add_head",
          "args": [
            "&entry->e_hash_list",
            "head"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "mb_entry_cache",
            "entry"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_unlock",
          "args": [
            "head"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_for_each_entry",
          "args": [
            "dup",
            "dup_node",
            "head",
            "e_hash_list"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_bl_lock",
          "args": [
            "head"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mb_cache_entry_head",
          "args": [
            "cache",
            "key"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "mb_cache_entry_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "49-53",
          "snippet": "static inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&entry->e_refcnt",
            "1"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&entry->e_list"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "mb_entry_cache",
            "mask"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "f2fs_kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/f2fs/f2fs.h",
          "lines": "2114-2123",
          "snippet": "static inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\n\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry)\n\t\tentry = kmem_cache_alloc(cachep, flags | __GFP_NOFAIL);\n\treturn entry;\n}",
          "includes": [
            "#include <linux/fscrypt.h>",
            "#include <crypto/hash.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/bio.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cred.h>",
            "#include <linux/sched.h>",
            "#include <linux/kobject.h>",
            "#include <linux/magic.h>",
            "#include <linux/crc32.h>",
            "#include <linux/slab.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/types.h>",
            "#include <linux/uio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fscrypt.h>\n#include <crypto/hash.h>\n#include <linux/quotaops.h>\n#include <linux/blkdev.h>\n#include <linux/bio.h>\n#include <linux/vmalloc.h>\n#include <linux/cred.h>\n#include <linux/sched.h>\n#include <linux/kobject.h>\n#include <linux/magic.h>\n#include <linux/crc32.h>\n#include <linux/slab.h>\n#include <linux/buffer_head.h>\n#include <linux/page-flags.h>\n#include <linux/types.h>\n#include <linux/uio.h>\n\nstatic inline void *f2fs_kmem_cache_alloc(struct kmem_cache *cachep,\n\t\t\t\t\t\tgfp_t flags)\n{\n\tvoid *entry;\n\n\tentry = kmem_cache_alloc(cachep, flags);\n\tif (!entry)\n\t\tentry = kmem_cache_alloc(cachep, flags | __GFP_NOFAIL);\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mb_cache_shrink",
          "args": [
            "cache",
            "SYNC_SHRINK_BATCH"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "mb_cache_shrink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
          "lines": "279-317",
          "snippet": "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan)\n{\n\tstruct mb_cache_entry *entry;\n\tstruct hlist_bl_head *head;\n\tunsigned long shrunk = 0;\n\n\tspin_lock(&cache->c_list_lock);\n\twhile (nr_to_scan-- && !list_empty(&cache->c_list)) {\n\t\tentry = list_first_entry(&cache->c_list,\n\t\t\t\t\t struct mb_cache_entry, e_list);\n\t\tif (entry->e_referenced) {\n\t\t\tentry->e_referenced = 0;\n\t\t\tlist_move_tail(&entry->e_list, &cache->c_list);\n\t\t\tcontinue;\n\t\t}\n\t\tlist_del_init(&entry->e_list);\n\t\tcache->c_entry_count--;\n\t\t/*\n\t\t * We keep LRU list reference so that entry doesn't go away\n\t\t * from under us.\n\t\t */\n\t\tspin_unlock(&cache->c_list_lock);\n\t\thead = mb_cache_entry_head(cache, entry->e_key);\n\t\thlist_bl_lock(head);\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t}\n\t\thlist_bl_unlock(head);\n\t\tif (mb_cache_entry_put(cache, entry))\n\t\t\tshrunk++;\n\t\tcond_resched();\n\t\tspin_lock(&cache->c_list_lock);\n\t}\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn shrunk;\n}",
          "includes": [
            "#include <linux/mbcache.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>",
            "#include <linux/list_bl.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan);\n\nstatic unsigned long mb_cache_shrink(struct mb_cache *cache,\n\t\t\t\t     unsigned long nr_to_scan)\n{\n\tstruct mb_cache_entry *entry;\n\tstruct hlist_bl_head *head;\n\tunsigned long shrunk = 0;\n\n\tspin_lock(&cache->c_list_lock);\n\twhile (nr_to_scan-- && !list_empty(&cache->c_list)) {\n\t\tentry = list_first_entry(&cache->c_list,\n\t\t\t\t\t struct mb_cache_entry, e_list);\n\t\tif (entry->e_referenced) {\n\t\t\tentry->e_referenced = 0;\n\t\t\tlist_move_tail(&entry->e_list, &cache->c_list);\n\t\t\tcontinue;\n\t\t}\n\t\tlist_del_init(&entry->e_list);\n\t\tcache->c_entry_count--;\n\t\t/*\n\t\t * We keep LRU list reference so that entry doesn't go away\n\t\t * from under us.\n\t\t */\n\t\tspin_unlock(&cache->c_list_lock);\n\t\thead = mb_cache_entry_head(cache, entry->e_key);\n\t\thlist_bl_lock(head);\n\t\tif (!hlist_bl_unhashed(&entry->e_hash_list)) {\n\t\t\thlist_bl_del_init(&entry->e_hash_list);\n\t\t\tatomic_dec(&entry->e_refcnt);\n\t\t}\n\t\thlist_bl_unlock(head);\n\t\tif (mb_cache_entry_put(cache, entry))\n\t\t\tshrunk++;\n\t\tcond_resched();\n\t\tspin_lock(&cache->c_list_lock);\n\t}\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn shrunk;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&cache->c_shrink_work"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "nfs_direct_write_schedule_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/nfs/direct.c",
          "lines": "740-757",
          "snippet": "static void nfs_direct_write_schedule_work(struct work_struct *work)\n{\n\tstruct nfs_direct_req *dreq = container_of(work, struct nfs_direct_req, work);\n\tint flags = dreq->flags;\n\n\tdreq->flags = 0;\n\tswitch (flags) {\n\t\tcase NFS_ODIRECT_DO_COMMIT:\n\t\t\tnfs_direct_commit_schedule(dreq);\n\t\t\tbreak;\n\t\tcase NFS_ODIRECT_RESCHED_WRITES:\n\t\t\tnfs_direct_write_reschedule(dreq);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tnfs_zap_mapping(dreq->inode, dreq->inode->i_mapping);\n\t\t\tnfs_direct_complete(dreq);\n\t}\n}",
          "includes": [
            "#include \"pnfs.h\"",
            "#include \"iostat.h\"",
            "#include \"internal.h\"",
            "#include <linux/atomic.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sunrpc/clnt.h>",
            "#include <linux/nfs_page.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/module.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/slab.h>",
            "#include <linux/kref.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/file.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/errno.h>"
          ],
          "macros_used": [
            "#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */",
            "#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */"
          ],
          "globals_used": [
            "static void nfs_direct_write_complete(struct nfs_direct_req *dreq);",
            "static void nfs_direct_write_schedule_work(struct work_struct *work);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pnfs.h\"\n#include \"iostat.h\"\n#include \"internal.h\"\n#include <linux/atomic.h>\n#include <linux/uaccess.h>\n#include <linux/sunrpc/clnt.h>\n#include <linux/nfs_page.h>\n#include <linux/nfs_fs.h>\n#include <linux/module.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/slab.h>\n#include <linux/kref.h>\n#include <linux/pagemap.h>\n#include <linux/file.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/errno.h>\n\n#define NFS_ODIRECT_RESCHED_WRITES\t(2)\t/* write verification failed */\n#define NFS_ODIRECT_DO_COMMIT\t\t(1)\t/* an unstable reply was received */\n\nstatic void nfs_direct_write_complete(struct nfs_direct_req *dreq);\nstatic void nfs_direct_write_schedule_work(struct work_struct *work);\n\nstatic void nfs_direct_write_schedule_work(struct work_struct *work)\n{\n\tstruct nfs_direct_req *dreq = container_of(work, struct nfs_direct_req, work);\n\tint flags = dreq->flags;\n\n\tdreq->flags = 0;\n\tswitch (flags) {\n\t\tcase NFS_ODIRECT_DO_COMMIT:\n\t\t\tnfs_direct_commit_schedule(dreq);\n\t\t\tbreak;\n\t\tcase NFS_ODIRECT_RESCHED_WRITES:\n\t\t\tnfs_direct_write_reschedule(dreq);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tnfs_zap_mapping(dreq->inode, dreq->inode->i_mapping);\n\t\t\tnfs_direct_complete(dreq);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\n#define SYNC_SHRINK_BATCH 64\n\nstatic struct kmem_cache *mb_entry_cache;\n\nint mb_cache_entry_create(struct mb_cache *cache, gfp_t mask, u32 key,\n\t\t\t  u64 value, bool reusable)\n{\n\tstruct mb_cache_entry *entry, *dup;\n\tstruct hlist_bl_node *dup_node;\n\tstruct hlist_bl_head *head;\n\n\t/* Schedule background reclaim if there are too many entries */\n\tif (cache->c_entry_count >= cache->c_max_entries)\n\t\tschedule_work(&cache->c_shrink_work);\n\t/* Do some sync reclaim if background reclaim cannot keep up */\n\tif (cache->c_entry_count >= 2*cache->c_max_entries)\n\t\tmb_cache_shrink(cache, SYNC_SHRINK_BATCH);\n\n\tentry = kmem_cache_alloc(mb_entry_cache, mask);\n\tif (!entry)\n\t\treturn -ENOMEM;\n\n\tINIT_LIST_HEAD(&entry->e_list);\n\t/* One ref for hash, one ref returned */\n\tatomic_set(&entry->e_refcnt, 1);\n\tentry->e_key = key;\n\tentry->e_value = value;\n\tentry->e_reusable = reusable;\n\tentry->e_referenced = 0;\n\thead = mb_cache_entry_head(cache, key);\n\thlist_bl_lock(head);\n\thlist_bl_for_each_entry(dup, dup_node, head, e_hash_list) {\n\t\tif (dup->e_key == key && dup->e_value == value) {\n\t\t\thlist_bl_unlock(head);\n\t\t\tkmem_cache_free(mb_entry_cache, entry);\n\t\t\treturn -EBUSY;\n\t\t}\n\t}\n\thlist_bl_add_head(&entry->e_hash_list, head);\n\thlist_bl_unlock(head);\n\n\tspin_lock(&cache->c_list_lock);\n\tlist_add_tail(&entry->e_list, &cache->c_list);\n\t/* Grab ref for LRU list */\n\tatomic_inc(&entry->e_refcnt);\n\tcache->c_entry_count++;\n\tspin_unlock(&cache->c_list_lock);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "mb_cache_entry_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mbcache.c",
    "lines": "49-53",
    "snippet": "static inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}",
    "includes": [
      "#include <linux/mbcache.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/sched.h>",
      "#include <linux/module.h>",
      "#include <linux/list_bl.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/spinlock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_32",
          "args": [
            "key",
            "cache->c_bucket_bits"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/mbcache.h>\n#include <linux/workqueue.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n#include <linux/list_bl.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/spinlock.h>\n\nstatic inline struct hlist_bl_head *mb_cache_entry_head(struct mb_cache *cache,\n\t\t\t\t\t\t\tu32 key)\n{\n\treturn &cache->c_hash[hash_32(key, cache->c_bucket_bits)];\n}"
  }
]