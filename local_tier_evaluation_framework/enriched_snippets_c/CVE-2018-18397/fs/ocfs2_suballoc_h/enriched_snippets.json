[
  {
    "function_name": "ocfs2_is_cluster_bitmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/suballoc.h",
    "lines": "179-183",
    "snippet": "static inline int ocfs2_is_cluster_bitmap(struct inode *inode)\n{\n\tstruct ocfs2_super *osb = OCFS2_SB(inode->i_sb);\n\treturn osb->bitmap_blkno == OCFS2_I(inode)->ip_blkno;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OCFS2_I",
          "args": [
            "inode"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "OCFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/inode.h",
          "lines": "118-121",
          "snippet": "static inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"extent_map.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"extent_map.h\"\n\nstatic inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OCFS2_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "static inline int ocfs2_is_cluster_bitmap(struct inode *inode)\n{\n\tstruct ocfs2_super *osb = OCFS2_SB(inode->i_sb);\n\treturn osb->bitmap_blkno == OCFS2_I(inode)->ip_blkno;\n}"
  },
  {
    "function_name": "ocfs2_cluster_from_desc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/suballoc.h",
    "lines": "163-177",
    "snippet": "static inline u32 ocfs2_cluster_from_desc(struct ocfs2_super *osb,\n\t\t\t\t\t  u64 bg_blkno)\n{\n\t/* This should work for all block group descriptors as only\n\t * the 1st group descriptor of the cluster bitmap is\n\t * different. */\n\n\tif (bg_blkno == osb->first_cluster_group_blkno)\n\t\treturn 0;\n\n\t/* the rest of the block groups are located at the beginning\n\t * of their 1st cluster, so a direct translation just\n\t * works. */\n\treturn ocfs2_blocks_to_clusters(osb->sb, bg_blkno);\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_blocks_to_clusters",
          "args": [
            "osb->sb",
            "bg_blkno"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_blocks_to_clusters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/ocfs2.h",
          "lines": "748-755",
          "snippet": "static inline u32 ocfs2_blocks_to_clusters(struct super_block *sb,\n\t\t\t\t\t   u64 blocks)\n{\n\tint b_to_c_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u32)(blocks >> b_to_c_bits);\n}",
          "includes": [
            "#include \"filecheck.h\"",
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filecheck.h\"\n#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline u32 ocfs2_blocks_to_clusters(struct super_block *sb,\n\t\t\t\t\t   u64 blocks)\n{\n\tint b_to_c_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u32)(blocks >> b_to_c_bits);\n}"
        }
      }
    ],
    "contextual_snippet": "static inline u32 ocfs2_cluster_from_desc(struct ocfs2_super *osb,\n\t\t\t\t\t  u64 bg_blkno)\n{\n\t/* This should work for all block group descriptors as only\n\t * the 1st group descriptor of the cluster bitmap is\n\t * different. */\n\n\tif (bg_blkno == osb->first_cluster_group_blkno)\n\t\treturn 0;\n\n\t/* the rest of the block groups are located at the beginning\n\t * of their 1st cluster, so a direct translation just\n\t * works. */\n\treturn ocfs2_blocks_to_clusters(osb->sb, bg_blkno);\n}"
  },
  {
    "function_name": "ocfs2_which_suballoc_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/suballoc.h",
    "lines": "156-161",
    "snippet": "static inline u64 ocfs2_which_suballoc_group(u64 block, unsigned int bit)\n{\n\tu64 group = block - (u64) bit;\n\n\treturn group;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline u64 ocfs2_which_suballoc_group(u64 block, unsigned int bit)\n{\n\tu64 group = block - (u64) bit;\n\n\treturn group;\n}"
  },
  {
    "function_name": "ocfs2_alloc_context_bits_left",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/suballoc.h",
    "lines": "67-70",
    "snippet": "static inline int ocfs2_alloc_context_bits_left(struct ocfs2_alloc_context *ac)\n{\n\treturn ac->ac_bits_wanted - ac->ac_bits_given;\n}",
    "includes": [],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "static inline int ocfs2_alloc_context_bits_left(struct ocfs2_alloc_context *ac)\n{\n\treturn ac->ac_bits_wanted - ac->ac_bits_given;\n}"
  }
]