[
  {
    "function_name": "ocfs2_update_inode_fsync_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "634-643",
    "snippet": "static inline void ocfs2_update_inode_fsync_trans(handle_t *handle,\n\t\t\t\t\t\t  struct inode *inode,\n\t\t\t\t\t\t  int datasync)\n{\n\tstruct ocfs2_inode_info *oi = OCFS2_I(inode);\n\n\toi->i_sync_tid = handle->h_transaction->t_tid;\n\tif (datasync)\n\t\toi->i_datasync_tid = handle->h_transaction->t_tid;\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OCFS2_I",
          "args": [
            "inode"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "OCFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/inode.h",
          "lines": "118-121",
          "snippet": "static inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"extent_map.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"extent_map.h\"\n\nstatic inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline void ocfs2_update_inode_fsync_trans(handle_t *handle,\n\t\t\t\t\t\t  struct inode *inode,\n\t\t\t\t\t\t  int datasync)\n{\n\tstruct ocfs2_inode_info *oi = OCFS2_I(inode);\n\n\toi->i_sync_tid = handle->h_transaction->t_tid;\n\tif (datasync)\n\t\toi->i_datasync_tid = handle->h_transaction->t_tid;\n}"
  },
  {
    "function_name": "ocfs2_begin_ordered_truncate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "625-632",
    "snippet": "static inline int ocfs2_begin_ordered_truncate(struct inode *inode,\n\t\t\t\t\t       loff_t new_size)\n{\n\treturn jbd2_journal_begin_ordered_truncate(\n\t\t\t\tOCFS2_SB(inode->i_sb)->journal->j_journal,\n\t\t\t\t&OCFS2_I(inode)->ip_jinode,\n\t\t\t\tnew_size);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "jbd2_journal_begin_ordered_truncate",
          "args": [
            "OCFS2_SB(inode->i_sb)->journal->j_journal",
            "&OCFS2_I(inode)->ip_jinode",
            "new_size"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "jbd2_journal_begin_ordered_truncate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/jbd2/transaction.c",
          "lines": "2588-2615",
          "snippet": "int jbd2_journal_begin_ordered_truncate(journal_t *journal,\n\t\t\t\t\tstruct jbd2_inode *jinode,\n\t\t\t\t\tloff_t new_size)\n{\n\ttransaction_t *inode_trans, *commit_trans;\n\tint ret = 0;\n\n\t/* This is a quick check to avoid locking if not necessary */\n\tif (!jinode->i_transaction)\n\t\tgoto out;\n\t/* Locks are here just to force reading of recent values, it is\n\t * enough that the transaction was not committing before we started\n\t * a transaction adding the inode to orphan list */\n\tread_lock(&journal->j_state_lock);\n\tcommit_trans = journal->j_committing_transaction;\n\tread_unlock(&journal->j_state_lock);\n\tspin_lock(&journal->j_list_lock);\n\tinode_trans = jinode->i_transaction;\n\tspin_unlock(&journal->j_list_lock);\n\tif (inode_trans == commit_trans) {\n\t\tret = filemap_fdatawrite_range(jinode->i_vfs_inode->i_mapping,\n\t\t\tnew_size, LLONG_MAX);\n\t\tif (ret)\n\t\t\tjbd2_journal_abort(journal, ret);\n\t}\nout:\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/jbd2.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/bug.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/timer.h>",
            "#include <linux/slab.h>",
            "#include <linux/errno.h>",
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/jbd2.h>\n#include <linux/sched/mm.h>\n#include <linux/module.h>\n#include <linux/bug.h>\n#include <linux/backing-dev.h>\n#include <linux/hrtimer.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/timer.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n\nint jbd2_journal_begin_ordered_truncate(journal_t *journal,\n\t\t\t\t\tstruct jbd2_inode *jinode,\n\t\t\t\t\tloff_t new_size)\n{\n\ttransaction_t *inode_trans, *commit_trans;\n\tint ret = 0;\n\n\t/* This is a quick check to avoid locking if not necessary */\n\tif (!jinode->i_transaction)\n\t\tgoto out;\n\t/* Locks are here just to force reading of recent values, it is\n\t * enough that the transaction was not committing before we started\n\t * a transaction adding the inode to orphan list */\n\tread_lock(&journal->j_state_lock);\n\tcommit_trans = journal->j_committing_transaction;\n\tread_unlock(&journal->j_state_lock);\n\tspin_lock(&journal->j_list_lock);\n\tinode_trans = jinode->i_transaction;\n\tspin_unlock(&journal->j_list_lock);\n\tif (inode_trans == commit_trans) {\n\t\tret = filemap_fdatawrite_range(jinode->i_vfs_inode->i_mapping,\n\t\t\tnew_size, LLONG_MAX);\n\t\tif (ret)\n\t\t\tjbd2_journal_abort(journal, ret);\n\t}\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "OCFS2_I",
          "args": [
            "inode"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "OCFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/inode.h",
          "lines": "118-121",
          "snippet": "static inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"extent_map.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"extent_map.h\"\n\nstatic inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OCFS2_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_begin_ordered_truncate(struct inode *inode,\n\t\t\t\t\t       loff_t new_size)\n{\n\treturn jbd2_journal_begin_ordered_truncate(\n\t\t\t\tOCFS2_SB(inode->i_sb)->journal->j_journal,\n\t\t\t\t&OCFS2_I(inode)->ip_jinode,\n\t\t\t\tnew_size);\n}"
  },
  {
    "function_name": "ocfs2_jbd2_file_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "620-623",
    "snippet": "static inline int ocfs2_jbd2_file_inode(handle_t *handle, struct inode *inode)\n{\n\treturn jbd2_journal_inode_add_write(handle, &OCFS2_I(inode)->ip_jinode);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "jbd2_journal_inode_add_write",
          "args": [
            "handle",
            "&OCFS2_I(inode)->ip_jinode"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "jbd2_journal_inode_add_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/jbd2/transaction.c",
          "lines": "2557-2561",
          "snippet": "int jbd2_journal_inode_add_write(handle_t *handle, struct jbd2_inode *jinode)\n{\n\treturn jbd2_journal_file_inode(handle, jinode,\n\t\t\t\t       JI_WRITE_DATA | JI_WAIT_DATA);\n}",
          "includes": [
            "#include <trace/events/jbd2.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/bug.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/timer.h>",
            "#include <linux/slab.h>",
            "#include <linux/errno.h>",
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/jbd2.h>\n#include <linux/sched/mm.h>\n#include <linux/module.h>\n#include <linux/bug.h>\n#include <linux/backing-dev.h>\n#include <linux/hrtimer.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/timer.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/jbd2.h>\n#include <linux/fs.h>\n#include <linux/time.h>\n\nint jbd2_journal_inode_add_write(handle_t *handle, struct jbd2_inode *jinode)\n{\n\treturn jbd2_journal_file_inode(handle, jinode,\n\t\t\t\t       JI_WRITE_DATA | JI_WAIT_DATA);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OCFS2_I",
          "args": [
            "inode"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "OCFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/inode.h",
          "lines": "118-121",
          "snippet": "static inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"extent_map.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"extent_map.h\"\n\nstatic inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_jbd2_file_inode(handle_t *handle, struct inode *inode)\n{\n\treturn jbd2_journal_inode_add_write(handle, &OCFS2_I(inode)->ip_jinode);\n}"
  },
  {
    "function_name": "ocfs2_calc_tree_trunc_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "592-618",
    "snippet": "static inline int ocfs2_calc_tree_trunc_credits(struct super_block *sb,\n\t\t\t\t\t\tunsigned int clusters_to_del,\n\t\t\t\t\t\tstruct ocfs2_dinode *fe,\n\t\t\t\t\t\tstruct ocfs2_extent_list *last_el)\n{\n \t/* for dinode + all headers in this pass + update to next leaf */\n\tu16 next_free = le16_to_cpu(last_el->l_next_free_rec);\n\tu16 tree_depth = le16_to_cpu(fe->id2.i_list.l_tree_depth);\n\tint credits = 1 + tree_depth + 1;\n\tint i;\n\n\ti = next_free - 1;\n\tBUG_ON(i < 0);\n\n\t/* We may be deleting metadata blocks, so metadata alloc dinode +\n\t   one desc. block for each possible delete. */\n\tif (tree_depth && next_free == 1 &&\n\t    ocfs2_rec_clusters(last_el, &last_el->l_recs[i]) == clusters_to_del)\n\t\tcredits += 1 + tree_depth;\n\n\t/* update to the truncate log. */\n\tcredits += OCFS2_TRUNCATE_LOG_UPDATE;\n\n\tcredits += ocfs2_quota_trans_credits(sb);\n\n\treturn credits;\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_TRUNCATE_LOG_UPDATE OCFS2_INODE_UPDATE_CREDITS"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_quota_trans_credits",
          "args": [
            "sb"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_quota_trans_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "378-387",
          "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_rec_clusters",
          "args": [
            "last_el",
            "&last_el->l_recs[i]"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_rec_clusters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/alloc.h",
          "lines": "248-262",
          "snippet": "static inline unsigned int ocfs2_rec_clusters(struct ocfs2_extent_list *el,\n\t\t\t\t\t      struct ocfs2_extent_rec *rec)\n{\n\t/*\n\t * Cluster count in extent records is slightly different\n\t * between interior nodes and leaf nodes. This is to support\n\t * unwritten extents which need a flags field in leaf node\n\t * records, thus shrinking the available space for a clusters\n\t * field.\n\t */\n\tif (el->l_tree_depth)\n\t\treturn le32_to_cpu(rec->e_int_clusters);\n\telse\n\t\treturn le16_to_cpu(rec->e_leaf_clusters);\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline unsigned int ocfs2_rec_clusters(struct ocfs2_extent_list *el,\n\t\t\t\t\t      struct ocfs2_extent_rec *rec)\n{\n\t/*\n\t * Cluster count in extent records is slightly different\n\t * between interior nodes and leaf nodes. This is to support\n\t * unwritten extents which need a flags field in leaf node\n\t * records, thus shrinking the available space for a clusters\n\t * field.\n\t */\n\tif (el->l_tree_depth)\n\t\treturn le32_to_cpu(rec->e_int_clusters);\n\telse\n\t\treturn le16_to_cpu(rec->e_leaf_clusters);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "i < 0"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "le16_to_cpu",
          "args": [
            "fe->id2.i_list.l_tree_depth"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "sle16_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ntfs/endian.h",
          "lines": "48-51",
          "snippet": "static inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_TRUNCATE_LOG_UPDATE OCFS2_INODE_UPDATE_CREDITS\n\nstatic inline int ocfs2_calc_tree_trunc_credits(struct super_block *sb,\n\t\t\t\t\t\tunsigned int clusters_to_del,\n\t\t\t\t\t\tstruct ocfs2_dinode *fe,\n\t\t\t\t\t\tstruct ocfs2_extent_list *last_el)\n{\n \t/* for dinode + all headers in this pass + update to next leaf */\n\tu16 next_free = le16_to_cpu(last_el->l_next_free_rec);\n\tu16 tree_depth = le16_to_cpu(fe->id2.i_list.l_tree_depth);\n\tint credits = 1 + tree_depth + 1;\n\tint i;\n\n\ti = next_free - 1;\n\tBUG_ON(i < 0);\n\n\t/* We may be deleting metadata blocks, so metadata alloc dinode +\n\t   one desc. block for each possible delete. */\n\tif (tree_depth && next_free == 1 &&\n\t    ocfs2_rec_clusters(last_el, &last_el->l_recs[i]) == clusters_to_del)\n\t\tcredits += 1 + tree_depth;\n\n\t/* update to the truncate log. */\n\tcredits += OCFS2_TRUNCATE_LOG_UPDATE;\n\n\tcredits += ocfs2_quota_trans_credits(sb);\n\n\treturn credits;\n}"
  },
  {
    "function_name": "ocfs2_calc_bg_discontig_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "587-590",
    "snippet": "static inline int ocfs2_calc_bg_discontig_credits(struct super_block *sb)\n{\n\treturn ocfs2_extent_recs_per_gd(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_extent_recs_per_gd",
          "args": [
            "sb"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_extent_recs_per_gd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/ocfs2_fs.h",
          "lines": "1526-1534",
          "snippet": "static inline int ocfs2_extent_recs_per_gd(int blocksize)\n{\n\tint size;\n\n\tsize = blocksize -\n\t\toffsetof(struct ocfs2_group_desc, bg_list.l_recs);\n\n\treturn size / sizeof(struct ocfs2_extent_rec);\n}",
          "includes": [
            "#include <linux/magic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/magic.h>\n\nstatic inline int ocfs2_extent_recs_per_gd(int blocksize)\n{\n\tint size;\n\n\tsize = blocksize -\n\t\toffsetof(struct ocfs2_group_desc, bg_list.l_recs);\n\n\treturn size / sizeof(struct ocfs2_extent_rec);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_calc_bg_discontig_credits(struct super_block *sb)\n{\n\treturn ocfs2_extent_recs_per_gd(sb);\n}"
  },
  {
    "function_name": "ocfs2_calc_group_alloc_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "569-578",
    "snippet": "static inline int ocfs2_calc_group_alloc_credits(struct super_block *sb,\n\t\t\t\t\t\t unsigned int cpg)\n{\n\tint blocks;\n\tint bitmap_blocks = OCFS2_SUBALLOC_ALLOC + 1;\n\t/* parent inode update + new block group header + bitmap inode update\n\t   + bitmap blocks affected */\n\tblocks = 1 + 1 + 1 + bitmap_blocks;\n\treturn blocks;\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_SUBALLOC_ALLOC (3)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_SUBALLOC_ALLOC (3)\n\nstatic inline int ocfs2_calc_group_alloc_credits(struct super_block *sb,\n\t\t\t\t\t\t unsigned int cpg)\n{\n\tint blocks;\n\tint bitmap_blocks = OCFS2_SUBALLOC_ALLOC + 1;\n\t/* parent inode update + new block group header + bitmap inode update\n\t   + bitmap blocks affected */\n\tblocks = 1 + 1 + 1 + bitmap_blocks;\n\treturn blocks;\n}"
  },
  {
    "function_name": "ocfs2_calc_symlink_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "558-567",
    "snippet": "static inline int ocfs2_calc_symlink_credits(struct super_block *sb)\n{\n\tint blocks = ocfs2_mknod_credits(sb, 0, 0);\n\n\t/* links can be longer than one block so we may update many\n\t * within our single allocated extent. */\n\tblocks += ocfs2_clusters_to_blocks(sb, 1);\n\n\treturn blocks + ocfs2_quota_trans_credits(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_quota_trans_credits",
          "args": [
            "sb"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_quota_trans_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "378-387",
          "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_clusters_to_blocks",
          "args": [
            "sb",
            "1"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clusters_to_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/ocfs2.h",
          "lines": "729-736",
          "snippet": "static inline u64 ocfs2_clusters_to_blocks(struct super_block *sb,\n\t\t\t\t\t   u32 clusters)\n{\n\tint c_to_b_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u64)clusters << c_to_b_bits;\n}",
          "includes": [
            "#include \"filecheck.h\"",
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filecheck.h\"\n#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline u64 ocfs2_clusters_to_blocks(struct super_block *sb,\n\t\t\t\t\t   u32 clusters)\n{\n\tint c_to_b_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u64)clusters << c_to_b_bits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_mknod_credits",
          "args": [
            "sb",
            "0",
            "0"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_mknod_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "433-443",
          "snippet": "static inline int ocfs2_mknod_credits(struct super_block *sb, int is_dir,\n\t\t\t\t      int xattr_credits)\n{\n\tint dir_credits = OCFS2_DIR_LINK_ADDITIONAL_CREDITS;\n\n\tif (is_dir)\n\t\tdir_credits += ocfs2_add_dir_index_credits(sb);\n\n\treturn 4 + OCFS2_SUBALLOC_ALLOC + dir_credits + xattr_credits +\n\t       ocfs2_quota_trans_credits(sb);\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_DIR_LINK_ADDITIONAL_CREDITS (1 + OCFS2_SUBALLOC_ALLOC + 1)",
            "#define OCFS2_SUBALLOC_ALLOC (3)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_DIR_LINK_ADDITIONAL_CREDITS (1 + OCFS2_SUBALLOC_ALLOC + 1)\n#define OCFS2_SUBALLOC_ALLOC (3)\n\nstatic inline int ocfs2_mknod_credits(struct super_block *sb, int is_dir,\n\t\t\t\t      int xattr_credits)\n{\n\tint dir_credits = OCFS2_DIR_LINK_ADDITIONAL_CREDITS;\n\n\tif (is_dir)\n\t\tdir_credits += ocfs2_add_dir_index_credits(sb);\n\n\treturn 4 + OCFS2_SUBALLOC_ALLOC + dir_credits + xattr_credits +\n\t       ocfs2_quota_trans_credits(sb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_calc_symlink_credits(struct super_block *sb)\n{\n\tint blocks = ocfs2_mknod_credits(sb, 0, 0);\n\n\t/* links can be longer than one block so we may update many\n\t * within our single allocated extent. */\n\tblocks += ocfs2_clusters_to_blocks(sb, 1);\n\n\treturn blocks + ocfs2_quota_trans_credits(sb);\n}"
  },
  {
    "function_name": "ocfs2_calc_extend_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "531-556",
    "snippet": "static inline int ocfs2_calc_extend_credits(struct super_block *sb,\n\t\t\t\t\t    struct ocfs2_extent_list *root_el)\n{\n\tint bitmap_blocks, sysfile_bitmap_blocks, extent_blocks;\n\n\t/* bitmap dinode, group desc. + relinked group. */\n\tbitmap_blocks = OCFS2_SUBALLOC_ALLOC;\n\n\t/* we might need to shift tree depth so lets assume an\n\t * absolute worst case of complete fragmentation.  Even with\n\t * that, we only need one update for the dinode, and then\n\t * however many metadata chunks needed * a remaining suballoc\n\t * alloc. */\n\tsysfile_bitmap_blocks = 1 +\n\t\t(OCFS2_SUBALLOC_ALLOC - 1) * ocfs2_extend_meta_needed(root_el);\n\n\t/* this does not include *new* metadata blocks, which are\n\t * accounted for in sysfile_bitmap_blocks. root_el +\n\t * prev. last_eb_blk + blocks along edge of tree.\n\t * calc_symlink_credits passes because we just need 1\n\t * credit for the dinode there. */\n\textent_blocks = 1 + 1 + le16_to_cpu(root_el->l_tree_depth);\n\n\treturn bitmap_blocks + sysfile_bitmap_blocks + extent_blocks +\n\t       ocfs2_quota_trans_credits(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_SUBALLOC_ALLOC (3)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_quota_trans_credits",
          "args": [
            "sb"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_quota_trans_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "378-387",
          "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "le16_to_cpu",
          "args": [
            "root_el->l_tree_depth"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "sle16_to_cpup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ntfs/endian.h",
          "lines": "48-51",
          "snippet": "static inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}",
          "includes": [
            "#include \"types.h\"",
            "#include <asm/byteorder.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"types.h\"\n#include <asm/byteorder.h>\n\nstatic inline s16 sle16_to_cpup(sle16 *x)\n{\n\treturn le16_to_cpu(*(__force le16*)x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_extend_meta_needed",
          "args": [
            "root_el"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_extend_meta_needed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/alloc.h",
          "lines": "157-168",
          "snippet": "static inline int ocfs2_extend_meta_needed(struct ocfs2_extent_list *root_el)\n{\n\t/*\n\t * Rather than do all the work of determining how much we need\n\t * (involves a ton of reads and locks), just ask for the\n\t * maximal limit.  That's a tree depth shift.  So, one block for\n\t * level of the tree (current l_tree_depth), one block for the\n\t * new tree_depth==0 extent_block, and one block at the new\n\t * top-of-the tree.\n\t */\n\treturn le16_to_cpu(root_el->l_tree_depth) + 2;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int ocfs2_extend_meta_needed(struct ocfs2_extent_list *root_el)\n{\n\t/*\n\t * Rather than do all the work of determining how much we need\n\t * (involves a ton of reads and locks), just ask for the\n\t * maximal limit.  That's a tree depth shift.  So, one block for\n\t * level of the tree (current l_tree_depth), one block for the\n\t * new tree_depth==0 extent_block, and one block at the new\n\t * top-of-the tree.\n\t */\n\treturn le16_to_cpu(root_el->l_tree_depth) + 2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_SUBALLOC_ALLOC (3)\n\nstatic inline int ocfs2_calc_extend_credits(struct super_block *sb,\n\t\t\t\t\t    struct ocfs2_extent_list *root_el)\n{\n\tint bitmap_blocks, sysfile_bitmap_blocks, extent_blocks;\n\n\t/* bitmap dinode, group desc. + relinked group. */\n\tbitmap_blocks = OCFS2_SUBALLOC_ALLOC;\n\n\t/* we might need to shift tree depth so lets assume an\n\t * absolute worst case of complete fragmentation.  Even with\n\t * that, we only need one update for the dinode, and then\n\t * however many metadata chunks needed * a remaining suballoc\n\t * alloc. */\n\tsysfile_bitmap_blocks = 1 +\n\t\t(OCFS2_SUBALLOC_ALLOC - 1) * ocfs2_extend_meta_needed(root_el);\n\n\t/* this does not include *new* metadata blocks, which are\n\t * accounted for in sysfile_bitmap_blocks. root_el +\n\t * prev. last_eb_blk + blocks along edge of tree.\n\t * calc_symlink_credits passes because we just need 1\n\t * credit for the dinode there. */\n\textent_blocks = 1 + 1 + le16_to_cpu(root_el->l_tree_depth);\n\n\treturn bitmap_blocks + sysfile_bitmap_blocks + extent_blocks +\n\t       ocfs2_quota_trans_credits(sb);\n}"
  },
  {
    "function_name": "ocfs2_calc_dxi_expand_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "499-507",
    "snippet": "static inline int ocfs2_calc_dxi_expand_credits(struct super_block *sb)\n{\n\tint credits = 1 + OCFS2_SUBALLOC_ALLOC;\n\n\tcredits += ocfs2_clusters_to_blocks(sb, 1);\n\tcredits += ocfs2_quota_trans_credits(sb);\n\n\treturn credits;\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_SUBALLOC_ALLOC (3)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_quota_trans_credits",
          "args": [
            "sb"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_quota_trans_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "378-387",
          "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_clusters_to_blocks",
          "args": [
            "sb",
            "1"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clusters_to_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/ocfs2.h",
          "lines": "729-736",
          "snippet": "static inline u64 ocfs2_clusters_to_blocks(struct super_block *sb,\n\t\t\t\t\t   u32 clusters)\n{\n\tint c_to_b_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u64)clusters << c_to_b_bits;\n}",
          "includes": [
            "#include \"filecheck.h\"",
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filecheck.h\"\n#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline u64 ocfs2_clusters_to_blocks(struct super_block *sb,\n\t\t\t\t\t   u32 clusters)\n{\n\tint c_to_b_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u64)clusters << c_to_b_bits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_SUBALLOC_ALLOC (3)\n\nstatic inline int ocfs2_calc_dxi_expand_credits(struct super_block *sb)\n{\n\tint credits = 1 + OCFS2_SUBALLOC_ALLOC;\n\n\tcredits += ocfs2_clusters_to_blocks(sb, 1);\n\tcredits += ocfs2_quota_trans_credits(sb);\n\n\treturn credits;\n}"
  },
  {
    "function_name": "ocfs2_rename_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "483-486",
    "snippet": "static inline int ocfs2_rename_credits(struct super_block *sb)\n{\n\treturn 3 * OCFS2_INODE_UPDATE_CREDITS + 6 + ocfs2_unlink_credits(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_INODE_UPDATE_CREDITS 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_unlink_credits",
          "args": [
            "sb"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_unlink_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "464-468",
          "snippet": "static inline int ocfs2_unlink_credits(struct super_block *sb)\n{\n\t/* The quota update from ocfs2_link_credits is unused here... */\n\treturn 2 * OCFS2_INODE_UPDATE_CREDITS + 3 + ocfs2_link_credits(sb);\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_INODE_UPDATE_CREDITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_INODE_UPDATE_CREDITS 1\n\nstatic inline int ocfs2_unlink_credits(struct super_block *sb)\n{\n\t/* The quota update from ocfs2_link_credits is unused here... */\n\treturn 2 * OCFS2_INODE_UPDATE_CREDITS + 3 + ocfs2_link_credits(sb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_INODE_UPDATE_CREDITS 1\n\nstatic inline int ocfs2_rename_credits(struct super_block *sb)\n{\n\treturn 3 * OCFS2_INODE_UPDATE_CREDITS + 6 + ocfs2_unlink_credits(sb);\n}"
  },
  {
    "function_name": "ocfs2_unlink_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "464-468",
    "snippet": "static inline int ocfs2_unlink_credits(struct super_block *sb)\n{\n\t/* The quota update from ocfs2_link_credits is unused here... */\n\treturn 2 * OCFS2_INODE_UPDATE_CREDITS + 3 + ocfs2_link_credits(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_INODE_UPDATE_CREDITS 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_link_credits",
          "args": [
            "sb"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_link_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "456-460",
          "snippet": "static inline int ocfs2_link_credits(struct super_block *sb)\n{\n\treturn 2*OCFS2_INODE_UPDATE_CREDITS + 4 +\n\t       ocfs2_quota_trans_credits(sb);\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_INODE_UPDATE_CREDITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_INODE_UPDATE_CREDITS 1\n\nstatic inline int ocfs2_link_credits(struct super_block *sb)\n{\n\treturn 2*OCFS2_INODE_UPDATE_CREDITS + 4 +\n\t       ocfs2_quota_trans_credits(sb);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_INODE_UPDATE_CREDITS 1\n\nstatic inline int ocfs2_unlink_credits(struct super_block *sb)\n{\n\t/* The quota update from ocfs2_link_credits is unused here... */\n\treturn 2 * OCFS2_INODE_UPDATE_CREDITS + 3 + ocfs2_link_credits(sb);\n}"
  },
  {
    "function_name": "ocfs2_link_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "456-460",
    "snippet": "static inline int ocfs2_link_credits(struct super_block *sb)\n{\n\treturn 2*OCFS2_INODE_UPDATE_CREDITS + 4 +\n\t       ocfs2_quota_trans_credits(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_INODE_UPDATE_CREDITS 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_quota_trans_credits",
          "args": [
            "sb"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_quota_trans_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "378-387",
          "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_INODE_UPDATE_CREDITS 1\n\nstatic inline int ocfs2_link_credits(struct super_block *sb)\n{\n\treturn 2*OCFS2_INODE_UPDATE_CREDITS + 4 +\n\t       ocfs2_quota_trans_credits(sb);\n}"
  },
  {
    "function_name": "ocfs2_mknod_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "433-443",
    "snippet": "static inline int ocfs2_mknod_credits(struct super_block *sb, int is_dir,\n\t\t\t\t      int xattr_credits)\n{\n\tint dir_credits = OCFS2_DIR_LINK_ADDITIONAL_CREDITS;\n\n\tif (is_dir)\n\t\tdir_credits += ocfs2_add_dir_index_credits(sb);\n\n\treturn 4 + OCFS2_SUBALLOC_ALLOC + dir_credits + xattr_credits +\n\t       ocfs2_quota_trans_credits(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_DIR_LINK_ADDITIONAL_CREDITS (1 + OCFS2_SUBALLOC_ALLOC + 1)",
      "#define OCFS2_SUBALLOC_ALLOC (3)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_quota_trans_credits",
          "args": [
            "sb"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_quota_trans_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "378-387",
          "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_add_dir_index_credits",
          "args": [
            "sb"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_add_dir_index_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "422-428",
          "snippet": "static inline int ocfs2_add_dir_index_credits(struct super_block *sb)\n{\n\t/* 1 block for index, 2 allocs (data, metadata), 1 clusters\n\t * worth of blocks for initial extent. */\n\treturn 1 + 2 * OCFS2_SUBALLOC_ALLOC +\n\t\tocfs2_clusters_to_blocks(sb, 1);\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_SUBALLOC_ALLOC (3)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_SUBALLOC_ALLOC (3)\n\nstatic inline int ocfs2_add_dir_index_credits(struct super_block *sb)\n{\n\t/* 1 block for index, 2 allocs (data, metadata), 1 clusters\n\t * worth of blocks for initial extent. */\n\treturn 1 + 2 * OCFS2_SUBALLOC_ALLOC +\n\t\tocfs2_clusters_to_blocks(sb, 1);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_DIR_LINK_ADDITIONAL_CREDITS (1 + OCFS2_SUBALLOC_ALLOC + 1)\n#define OCFS2_SUBALLOC_ALLOC (3)\n\nstatic inline int ocfs2_mknod_credits(struct super_block *sb, int is_dir,\n\t\t\t\t      int xattr_credits)\n{\n\tint dir_credits = OCFS2_DIR_LINK_ADDITIONAL_CREDITS;\n\n\tif (is_dir)\n\t\tdir_credits += ocfs2_add_dir_index_credits(sb);\n\n\treturn 4 + OCFS2_SUBALLOC_ALLOC + dir_credits + xattr_credits +\n\t       ocfs2_quota_trans_credits(sb);\n}"
  },
  {
    "function_name": "ocfs2_add_dir_index_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "422-428",
    "snippet": "static inline int ocfs2_add_dir_index_credits(struct super_block *sb)\n{\n\t/* 1 block for index, 2 allocs (data, metadata), 1 clusters\n\t * worth of blocks for initial extent. */\n\treturn 1 + 2 * OCFS2_SUBALLOC_ALLOC +\n\t\tocfs2_clusters_to_blocks(sb, 1);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_SUBALLOC_ALLOC (3)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_clusters_to_blocks",
          "args": [
            "sb",
            "1"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_clusters_to_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/ocfs2.h",
          "lines": "729-736",
          "snippet": "static inline u64 ocfs2_clusters_to_blocks(struct super_block *sb,\n\t\t\t\t\t   u32 clusters)\n{\n\tint c_to_b_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u64)clusters << c_to_b_bits;\n}",
          "includes": [
            "#include \"filecheck.h\"",
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filecheck.h\"\n#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline u64 ocfs2_clusters_to_blocks(struct super_block *sb,\n\t\t\t\t\t   u32 clusters)\n{\n\tint c_to_b_bits = OCFS2_SB(sb)->s_clustersize_bits -\n\t\tsb->s_blocksize_bits;\n\n\treturn (u64)clusters << c_to_b_bits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_SUBALLOC_ALLOC (3)\n\nstatic inline int ocfs2_add_dir_index_credits(struct super_block *sb)\n{\n\t/* 1 block for index, 2 allocs (data, metadata), 1 clusters\n\t * worth of blocks for initial extent. */\n\treturn 1 + 2 * OCFS2_SUBALLOC_ALLOC +\n\t\tocfs2_clusters_to_blocks(sb, 1);\n}"
  },
  {
    "function_name": "ocfs2_remove_extent_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "412-416",
    "snippet": "static inline int ocfs2_remove_extent_credits(struct super_block *sb)\n{\n\treturn OCFS2_TRUNCATE_LOG_UPDATE + OCFS2_INODE_UPDATE_CREDITS +\n\t       ocfs2_quota_trans_credits(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_TRUNCATE_LOG_UPDATE OCFS2_INODE_UPDATE_CREDITS",
      "#define OCFS2_INODE_UPDATE_CREDITS 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_quota_trans_credits",
          "args": [
            "sb"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_quota_trans_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "378-387",
          "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_TRUNCATE_LOG_UPDATE OCFS2_INODE_UPDATE_CREDITS\n#define OCFS2_INODE_UPDATE_CREDITS 1\n\nstatic inline int ocfs2_remove_extent_credits(struct super_block *sb)\n{\n\treturn OCFS2_TRUNCATE_LOG_UPDATE + OCFS2_INODE_UPDATE_CREDITS +\n\t       ocfs2_quota_trans_credits(sb);\n}"
  },
  {
    "function_name": "ocfs2_inline_to_extents_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "399-403",
    "snippet": "static inline int ocfs2_inline_to_extents_credits(struct super_block *sb)\n{\n\treturn OCFS2_SUBALLOC_ALLOC + OCFS2_INODE_UPDATE_CREDITS +\n\t       ocfs2_quota_trans_credits(sb);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_SUBALLOC_ALLOC (3)",
      "#define OCFS2_INODE_UPDATE_CREDITS 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_quota_trans_credits",
          "args": [
            "sb"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_quota_trans_credits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "378-387",
          "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_SUBALLOC_ALLOC (3)\n#define OCFS2_INODE_UPDATE_CREDITS 1\n\nstatic inline int ocfs2_inline_to_extents_credits(struct super_block *sb)\n{\n\treturn OCFS2_SUBALLOC_ALLOC + OCFS2_INODE_UPDATE_CREDITS +\n\t       ocfs2_quota_trans_credits(sb);\n}"
  },
  {
    "function_name": "ocfs2_quota_trans_credits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "378-387",
    "snippet": "static inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OCFS2_HAS_RO_COMPAT_FEATURE",
          "args": [
            "sb",
            "OCFS2_FEATURE_RO_COMPAT_GRPQUOTA"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OCFS2_HAS_RO_COMPAT_FEATURE",
          "args": [
            "sb",
            "OCFS2_FEATURE_RO_COMPAT_USRQUOTA"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\n#define OCFS2_QWRITE_CREDITS (OCFS2_QINFO_WRITE_CREDITS + \\\n\t\t\t      OCFS2_QUOTA_BLOCK_UPDATE_CREDITS)\n\nstatic inline int ocfs2_quota_trans_credits(struct super_block *sb)\n{\n\tint credits = 0;\n\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_USRQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\tif (OCFS2_HAS_RO_COMPAT_FEATURE(sb, OCFS2_FEATURE_RO_COMPAT_GRPQUOTA))\n\t\tcredits += OCFS2_QWRITE_CREDITS;\n\treturn credits;\n}"
  },
  {
    "function_name": "ocfs2_checkpoint_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "206-225",
    "snippet": "static inline void ocfs2_checkpoint_inode(struct inode *inode)\n{\n\tstruct ocfs2_super *osb = OCFS2_SB(inode->i_sb);\n\n\tif (ocfs2_mount_local(osb))\n\t\treturn;\n\n\tif (!ocfs2_ci_fully_checkpointed(INODE_CACHE(inode))) {\n\t\t/* WARNING: This only kicks off a single\n\t\t * checkpoint. If someone races you and adds more\n\t\t * metadata to the journal, you won't know, and will\n\t\t * wind up waiting *a lot* longer than necessary. Right\n\t\t * now we only use this in clear_inode so that's\n\t\t * OK. */\n\t\tocfs2_start_checkpoint(osb);\n\n\t\twait_event(osb->journal->j_checkpointed,\n\t\t\t   ocfs2_ci_fully_checkpointed(INODE_CACHE(inode)));\n\t}\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_event",
          "args": [
            "osb->journal->j_checkpointed",
            "ocfs2_ci_fully_checkpointed(INODE_CACHE(inode))"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_ci_fully_checkpointed",
          "args": [
            "INODE_CACHE(inode)"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_ci_fully_checkpointed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "107-117",
          "snippet": "static inline int ocfs2_ci_fully_checkpointed(struct ocfs2_caching_info *ci)\n{\n\tint ret;\n\tstruct ocfs2_journal *journal =\n\t\tOCFS2_SB(ocfs2_metadata_cache_get_super(ci))->journal;\n\n\tspin_lock(&trans_inc_lock);\n\tret = time_after(journal->j_trans_id, ci->ci_last_trans);\n\tspin_unlock(&trans_inc_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_ci_fully_checkpointed(struct ocfs2_caching_info *ci)\n{\n\tint ret;\n\tstruct ocfs2_journal *journal =\n\t\tOCFS2_SB(ocfs2_metadata_cache_get_super(ci))->journal;\n\n\tspin_lock(&trans_inc_lock);\n\tret = time_after(journal->j_trans_id, ci->ci_last_trans);\n\tspin_unlock(&trans_inc_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "INODE_CACHE",
          "args": [
            "inode"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "INODE_CACHE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/inode.h",
          "lines": "129-132",
          "snippet": "static inline struct ocfs2_caching_info *INODE_CACHE(struct inode *inode)\n{\n\treturn &OCFS2_I(inode)->ip_metadata_cache;\n}",
          "includes": [
            "#include \"extent_map.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"extent_map.h\"\n\nstatic inline struct ocfs2_caching_info *INODE_CACHE(struct inode *inode)\n{\n\treturn &OCFS2_I(inode)->ip_metadata_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_start_checkpoint",
          "args": [
            "osb"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_start_checkpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "201-204",
          "snippet": "static inline void ocfs2_start_checkpoint(struct ocfs2_super *osb)\n{\n\twake_up(&osb->checkpoint_event);\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline void ocfs2_start_checkpoint(struct ocfs2_super *osb)\n{\n\twake_up(&osb->checkpoint_event);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_mount_local",
          "args": [
            "osb"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_mount_local",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/ocfs2.h",
          "lines": "686-689",
          "snippet": "static inline int ocfs2_mount_local(struct ocfs2_super *osb)\n{\n\treturn (osb->s_feature_incompat & OCFS2_FEATURE_INCOMPAT_LOCAL_MOUNT);\n}",
          "includes": [
            "#include \"filecheck.h\"",
            "#include \"reservations.h\"",
            "#include \"blockcheck.h\"",
            "#include \"ocfs2_ioctl.h\"",
            "#include \"ocfs2_lockid.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include \"stackglue.h\"",
            "#include <linux/jbd2.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/mutex.h>",
            "#include <linux/kref.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/llist.h>",
            "#include <linux/list.h>",
            "#include <linux/wait.h>",
            "#include <linux/sched.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filecheck.h\"\n#include \"reservations.h\"\n#include \"blockcheck.h\"\n#include \"ocfs2_ioctl.h\"\n#include \"ocfs2_lockid.h\"\n#include \"ocfs2_fs.h\"\n#include \"stackglue.h\"\n#include <linux/jbd2.h>\n#include <linux/lockdep.h>\n#include <linux/mutex.h>\n#include <linux/kref.h>\n#include <linux/workqueue.h>\n#include <linux/rbtree.h>\n#include <linux/llist.h>\n#include <linux/list.h>\n#include <linux/wait.h>\n#include <linux/sched.h>\n#include <linux/spinlock.h>\n\nstatic inline int ocfs2_mount_local(struct ocfs2_super *osb)\n{\n\treturn (osb->s_feature_incompat & OCFS2_FEATURE_INCOMPAT_LOCAL_MOUNT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OCFS2_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline void ocfs2_checkpoint_inode(struct inode *inode)\n{\n\tstruct ocfs2_super *osb = OCFS2_SB(inode->i_sb);\n\n\tif (ocfs2_mount_local(osb))\n\t\treturn;\n\n\tif (!ocfs2_ci_fully_checkpointed(INODE_CACHE(inode))) {\n\t\t/* WARNING: This only kicks off a single\n\t\t * checkpoint. If someone races you and adds more\n\t\t * metadata to the journal, you won't know, and will\n\t\t * wind up waiting *a lot* longer than necessary. Right\n\t\t * now we only use this in clear_inode so that's\n\t\t * OK. */\n\t\tocfs2_start_checkpoint(osb);\n\n\t\twait_event(osb->journal->j_checkpointed,\n\t\t\t   ocfs2_ci_fully_checkpointed(INODE_CACHE(inode)));\n\t}\n}"
  },
  {
    "function_name": "ocfs2_start_checkpoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "201-204",
    "snippet": "static inline void ocfs2_start_checkpoint(struct ocfs2_super *osb)\n{\n\twake_up(&osb->checkpoint_event);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up",
          "args": [
            "&osb->checkpoint_event"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "locks_wake_up_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/locks.c",
          "lines": "714-739",
          "snippet": "static void locks_wake_up_blocks(struct file_lock *blocker)\n{\n\t/*\n\t * Avoid taking global lock if list is empty. This is safe since new\n\t * blocked requests are only added to the list under the flc_lock, and\n\t * the flc_lock is always held here. Note that removal from the fl_block\n\t * list does not require the flc_lock, so we must recheck list_empty()\n\t * after acquiring the blocked_lock_lock.\n\t */\n\tif (list_empty(&blocker->fl_block))\n\t\treturn;\n\n\tspin_lock(&blocked_lock_lock);\n\twhile (!list_empty(&blocker->fl_block)) {\n\t\tstruct file_lock *waiter;\n\n\t\twaiter = list_first_entry(&blocker->fl_block,\n\t\t\t\tstruct file_lock, fl_block);\n\t\t__locks_delete_block(waiter);\n\t\tif (waiter->fl_lmops && waiter->fl_lmops->lm_notify)\n\t\t\twaiter->fl_lmops->lm_notify(waiter);\n\t\telse\n\t\t\twake_up(&waiter->fl_wait);\n\t}\n\tspin_unlock(&blocked_lock_lock);\n}",
          "includes": [
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/uaccess.h>",
            "#include <trace/events/filelock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/time.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(blocked_lock_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/uaccess.h>\n#include <trace/events/filelock.h>\n#include <linux/percpu.h>\n#include <linux/hashtable.h>\n#include <linux/pid_namespace.h>\n#include <linux/rcupdate.h>\n#include <linux/time.h>\n#include <linux/syscalls.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/capability.h>\n\nstatic DEFINE_SPINLOCK(blocked_lock_lock);\n\nstatic void locks_wake_up_blocks(struct file_lock *blocker)\n{\n\t/*\n\t * Avoid taking global lock if list is empty. This is safe since new\n\t * blocked requests are only added to the list under the flc_lock, and\n\t * the flc_lock is always held here. Note that removal from the fl_block\n\t * list does not require the flc_lock, so we must recheck list_empty()\n\t * after acquiring the blocked_lock_lock.\n\t */\n\tif (list_empty(&blocker->fl_block))\n\t\treturn;\n\n\tspin_lock(&blocked_lock_lock);\n\twhile (!list_empty(&blocker->fl_block)) {\n\t\tstruct file_lock *waiter;\n\n\t\twaiter = list_first_entry(&blocker->fl_block,\n\t\t\t\tstruct file_lock, fl_block);\n\t\t__locks_delete_block(waiter);\n\t\tif (waiter->fl_lmops && waiter->fl_lmops->lm_notify)\n\t\t\twaiter->fl_lmops->lm_notify(waiter);\n\t\telse\n\t\t\twake_up(&waiter->fl_wait);\n\t}\n\tspin_unlock(&blocked_lock_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline void ocfs2_start_checkpoint(struct ocfs2_super *osb)\n{\n\twake_up(&osb->checkpoint_event);\n}"
  },
  {
    "function_name": "ocfs2_ci_set_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "149-155",
    "snippet": "static inline void ocfs2_ci_set_new(struct ocfs2_super *osb,\n\t\t\t\t    struct ocfs2_caching_info *ci)\n{\n\tspin_lock(&trans_inc_lock);\n\tci->ci_created_trans = osb->journal->j_trans_id;\n\tspin_unlock(&trans_inc_lock);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline void ocfs2_ci_set_new(struct ocfs2_super *osb,\n\t\t\t\t    struct ocfs2_caching_info *ci)\n{\n\tspin_lock(&trans_inc_lock);\n\tci->ci_created_trans = osb->journal->j_trans_id;\n\tspin_unlock(&trans_inc_lock);\n}"
  },
  {
    "function_name": "ocfs2_inode_is_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "138-147",
    "snippet": "static inline int ocfs2_inode_is_new(struct inode *inode)\n{\n\t/* System files are never \"new\" as they're written out by\n\t * mkfs. This helps us early during mount, before we have the\n\t * journal open and j_trans_id could be junk. */\n\tif (OCFS2_I(inode)->ip_flags & OCFS2_INODE_SYSTEM_FILE)\n\t\treturn 0;\n\n\treturn ocfs2_ci_is_new(INODE_CACHE(inode));\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_ci_is_new",
          "args": [
            "INODE_CACHE(inode)"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_ci_is_new",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
          "lines": "123-135",
          "snippet": "static inline int ocfs2_ci_is_new(struct ocfs2_caching_info *ci)\n{\n\tint ret;\n\tstruct ocfs2_journal *journal =\n\t\tOCFS2_SB(ocfs2_metadata_cache_get_super(ci))->journal;\n\n\tspin_lock(&trans_inc_lock);\n\tret = !(time_after(journal->j_trans_id, ci->ci_created_trans));\n\tif (!ret)\n\t\tci->ci_created_trans = 0;\n\tspin_unlock(&trans_inc_lock);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/jbd2.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_ci_is_new(struct ocfs2_caching_info *ci)\n{\n\tint ret;\n\tstruct ocfs2_journal *journal =\n\t\tOCFS2_SB(ocfs2_metadata_cache_get_super(ci))->journal;\n\n\tspin_lock(&trans_inc_lock);\n\tret = !(time_after(journal->j_trans_id, ci->ci_created_trans));\n\tif (!ret)\n\t\tci->ci_created_trans = 0;\n\tspin_unlock(&trans_inc_lock);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "INODE_CACHE",
          "args": [
            "inode"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "INODE_CACHE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/inode.h",
          "lines": "129-132",
          "snippet": "static inline struct ocfs2_caching_info *INODE_CACHE(struct inode *inode)\n{\n\treturn &OCFS2_I(inode)->ip_metadata_cache;\n}",
          "includes": [
            "#include \"extent_map.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"extent_map.h\"\n\nstatic inline struct ocfs2_caching_info *INODE_CACHE(struct inode *inode)\n{\n\treturn &OCFS2_I(inode)->ip_metadata_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "OCFS2_I",
          "args": [
            "inode"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "OCFS2_I",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/inode.h",
          "lines": "118-121",
          "snippet": "static inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}",
          "includes": [
            "#include \"extent_map.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"extent_map.h\"\n\nstatic inline struct ocfs2_inode_info *OCFS2_I(struct inode *inode)\n{\n\treturn container_of(inode, struct ocfs2_inode_info, vfs_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_inode_is_new(struct inode *inode)\n{\n\t/* System files are never \"new\" as they're written out by\n\t * mkfs. This helps us early during mount, before we have the\n\t * journal open and j_trans_id could be junk. */\n\tif (OCFS2_I(inode)->ip_flags & OCFS2_INODE_SYSTEM_FILE)\n\t\treturn 0;\n\n\treturn ocfs2_ci_is_new(INODE_CACHE(inode));\n}"
  },
  {
    "function_name": "ocfs2_ci_is_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "123-135",
    "snippet": "static inline int ocfs2_ci_is_new(struct ocfs2_caching_info *ci)\n{\n\tint ret;\n\tstruct ocfs2_journal *journal =\n\t\tOCFS2_SB(ocfs2_metadata_cache_get_super(ci))->journal;\n\n\tspin_lock(&trans_inc_lock);\n\tret = !(time_after(journal->j_trans_id, ci->ci_created_trans));\n\tif (!ret)\n\t\tci->ci_created_trans = 0;\n\tspin_unlock(&trans_inc_lock);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "time_after",
          "args": [
            "journal->j_trans_id",
            "ci->ci_created_trans"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OCFS2_SB",
          "args": [
            "ocfs2_metadata_cache_get_super(ci)"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_get_super",
          "args": [
            "ci"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_get_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/uptodate.c",
          "lines": "79-84",
          "snippet": "struct super_block *ocfs2_metadata_cache_get_super(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_get_super(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstruct super_block *ocfs2_metadata_cache_get_super(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_get_super(ci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_ci_is_new(struct ocfs2_caching_info *ci)\n{\n\tint ret;\n\tstruct ocfs2_journal *journal =\n\t\tOCFS2_SB(ocfs2_metadata_cache_get_super(ci))->journal;\n\n\tspin_lock(&trans_inc_lock);\n\tret = !(time_after(journal->j_trans_id, ci->ci_created_trans));\n\tif (!ret)\n\t\tci->ci_created_trans = 0;\n\tspin_unlock(&trans_inc_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "ocfs2_ci_fully_checkpointed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "107-117",
    "snippet": "static inline int ocfs2_ci_fully_checkpointed(struct ocfs2_caching_info *ci)\n{\n\tint ret;\n\tstruct ocfs2_journal *journal =\n\t\tOCFS2_SB(ocfs2_metadata_cache_get_super(ci))->journal;\n\n\tspin_lock(&trans_inc_lock);\n\tret = time_after(journal->j_trans_id, ci->ci_last_trans);\n\tspin_unlock(&trans_inc_lock);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "time_after",
          "args": [
            "journal->j_trans_id",
            "ci->ci_last_trans"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "OCFS2_SB",
          "args": [
            "ocfs2_metadata_cache_get_super(ci)"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_metadata_cache_get_super",
          "args": [
            "ci"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_metadata_cache_get_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/uptodate.c",
          "lines": "79-84",
          "snippet": "struct super_block *ocfs2_metadata_cache_get_super(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_get_super(ci);\n}",
          "includes": [
            "#include \"ocfs2_trace.h\"",
            "#include \"uptodate.h\"",
            "#include \"inode.h\"",
            "#include \"ocfs2.h\"",
            "#include <cluster/masklog.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/highmem.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ocfs2_trace.h\"\n#include \"uptodate.h\"\n#include \"inode.h\"\n#include \"ocfs2.h\"\n#include <cluster/masklog.h>\n#include <linux/rbtree.h>\n#include <linux/buffer_head.h>\n#include <linux/highmem.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/fs.h>\n\nstruct super_block *ocfs2_metadata_cache_get_super(struct ocfs2_caching_info *ci)\n{\n\tBUG_ON(!ci || !ci->ci_ops);\n\n\treturn ci->ci_ops->co_get_super(ci);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline int ocfs2_ci_fully_checkpointed(struct ocfs2_caching_info *ci)\n{\n\tint ret;\n\tstruct ocfs2_journal *journal =\n\t\tOCFS2_SB(ocfs2_metadata_cache_get_super(ci))->journal;\n\n\tspin_lock(&trans_inc_lock);\n\tret = time_after(journal->j_trans_id, ci->ci_last_trans);\n\tspin_unlock(&trans_inc_lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "ocfs2_set_ci_lock_trans",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "94-100",
    "snippet": "static inline void ocfs2_set_ci_lock_trans(struct ocfs2_journal *journal,\n\t\t\t\t\t   struct ocfs2_caching_info *ci)\n{\n\tspin_lock(&trans_inc_lock);\n\tci->ci_last_trans = journal->j_trans_id;\n\tspin_unlock(&trans_inc_lock);\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline void ocfs2_set_ci_lock_trans(struct ocfs2_journal *journal,\n\t\t\t\t\t   struct ocfs2_caching_info *ci)\n{\n\tspin_lock(&trans_inc_lock);\n\tci->ci_last_trans = journal->j_trans_id;\n\tspin_unlock(&trans_inc_lock);\n}"
  },
  {
    "function_name": "ocfs2_inc_trans_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/journal.h",
    "lines": "83-92",
    "snippet": "static inline unsigned long ocfs2_inc_trans_id(struct ocfs2_journal *j)\n{\n\tunsigned long old_id;\n\tspin_lock(&trans_inc_lock);\n\told_id = j->j_trans_id++;\n\tif (unlikely(!j->j_trans_id))\n\t\tj->j_trans_id = 1;\n\tspin_unlock(&trans_inc_lock);\n\treturn old_id;\n}",
    "includes": [
      "#include <linux/jbd2.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!j->j_trans_id"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&trans_inc_lock"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/jbd2.h>\n#include <linux/fs.h>\n\nstatic inline unsigned long ocfs2_inc_trans_id(struct ocfs2_journal *j)\n{\n\tunsigned long old_id;\n\tspin_lock(&trans_inc_lock);\n\told_id = j->j_trans_id++;\n\tif (unlikely(!j->j_trans_id))\n\t\tj->j_trans_id = 1;\n\tspin_unlock(&trans_inc_lock);\n\treturn old_id;\n}"
  }
]