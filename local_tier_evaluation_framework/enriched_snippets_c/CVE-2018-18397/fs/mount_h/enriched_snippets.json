[
  {
    "function_name": "is_local_mountpoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "142-148",
    "snippet": "static inline bool is_local_mountpoint(struct dentry *dentry)\n{\n\tif (!d_mountpoint(dentry))\n\t\treturn false;\n\n\treturn __is_local_mountpoint(dentry);\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct mount *__lookup_mnt(struct vfsmount *, struct dentry *);",
      "extern void __detach_mounts(struct dentry *dentry);",
      "extern bool __is_local_mountpoint(struct dentry *dentry);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__is_local_mountpoint",
          "args": [
            "dentry"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "__is_local_mountpoint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/namespace.c",
          "lines": "671-689",
          "snippet": "bool __is_local_mountpoint(struct dentry *dentry)\n{\n\tstruct mnt_namespace *ns = current->nsproxy->mnt_ns;\n\tstruct mount *mnt;\n\tbool is_covered = false;\n\n\tif (!d_mountpoint(dentry))\n\t\tgoto out;\n\n\tdown_read(&namespace_sem);\n\tlist_for_each_entry(mnt, &ns->list, mnt_list) {\n\t\tis_covered = (mnt->mnt_mountpoint == dentry);\n\t\tif (is_covered)\n\t\t\tbreak;\n\t}\n\tup_read(&namespace_sem);\nout:\n\treturn is_covered;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/sched/task.h>",
            "#include <linux/task_work.h>",
            "#include <linux/memblock.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DECLARE_RWSEM(namespace_sem);",
            "static void shrink_submounts(struct mount *mnt);",
            "__latent_entropy\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/sched/task.h>\n#include <linux/task_work.h>\n#include <linux/memblock.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic DECLARE_RWSEM(namespace_sem);\nstatic void shrink_submounts(struct mount *mnt);\n__latent_entropy\nstruct;\n\nbool __is_local_mountpoint(struct dentry *dentry)\n{\n\tstruct mnt_namespace *ns = current->nsproxy->mnt_ns;\n\tstruct mount *mnt;\n\tbool is_covered = false;\n\n\tif (!d_mountpoint(dentry))\n\t\tgoto out;\n\n\tdown_read(&namespace_sem);\n\tlist_for_each_entry(mnt, &ns->list, mnt_list) {\n\t\tis_covered = (mnt->mnt_mountpoint == dentry);\n\t\tif (is_covered)\n\t\t\tbreak;\n\t}\n\tup_read(&namespace_sem);\nout:\n\treturn is_covered;\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_mountpoint",
          "args": [
            "dentry"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nextern struct mount *__lookup_mnt(struct vfsmount *, struct dentry *);\nextern void __detach_mounts(struct dentry *dentry);\nextern bool __is_local_mountpoint(struct dentry *dentry);\n\nstatic inline bool is_local_mountpoint(struct dentry *dentry)\n{\n\tif (!d_mountpoint(dentry))\n\t\treturn false;\n\n\treturn __is_local_mountpoint(dentry);\n}"
  },
  {
    "function_name": "unlock_mount_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "125-128",
    "snippet": "static inline void unlock_mount_hash(void)\n{\n\twrite_sequnlock(&mount_lock);\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern seqlock_t mount_lock;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_sequnlock",
          "args": [
            "&mount_lock"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nextern seqlock_t mount_lock;\n\nstatic inline void unlock_mount_hash(void)\n{\n\twrite_sequnlock(&mount_lock);\n}"
  },
  {
    "function_name": "lock_mount_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "120-123",
    "snippet": "static inline void lock_mount_hash(void)\n{\n\twrite_seqlock(&mount_lock);\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern seqlock_t mount_lock;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_seqlock",
          "args": [
            "&mount_lock"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nextern seqlock_t mount_lock;\n\nstatic inline void lock_mount_hash(void)\n{\n\twrite_seqlock(&mount_lock);\n}"
  },
  {
    "function_name": "get_mnt_ns",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "113-116",
    "snippet": "static inline void get_mnt_ns(struct mnt_namespace *ns)\n{\n\tatomic_inc(&ns->count);\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&ns->count"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nstatic inline void get_mnt_ns(struct mnt_namespace *ns)\n{\n\tatomic_inc(&ns->count);\n}"
  },
  {
    "function_name": "detach_mounts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "106-111",
    "snippet": "static inline void detach_mounts(struct dentry *dentry)\n{\n\tif (!d_mountpoint(dentry))\n\t\treturn;\n\t__detach_mounts(dentry);\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct mount *__lookup_mnt(struct vfsmount *, struct dentry *);",
      "extern void __detach_mounts(struct dentry *dentry);",
      "extern bool __is_local_mountpoint(struct dentry *dentry);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__detach_mounts",
          "args": [
            "dentry"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "__detach_mounts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/namespace.c",
          "lines": "1579-1603",
          "snippet": "void __detach_mounts(struct dentry *dentry)\n{\n\tstruct mountpoint *mp;\n\tstruct mount *mnt;\n\n\tnamespace_lock();\n\tlock_mount_hash();\n\tmp = lookup_mountpoint(dentry);\n\tif (IS_ERR_OR_NULL(mp))\n\t\tgoto out_unlock;\n\n\tevent++;\n\twhile (!hlist_empty(&mp->m_list)) {\n\t\tmnt = hlist_entry(mp->m_list.first, struct mount, mnt_mp_list);\n\t\tif (mnt->mnt.mnt_flags & MNT_UMOUNT) {\n\t\t\thlist_add_head(&mnt->mnt_umount.s_list, &unmounted);\n\t\t\tumount_mnt(mnt);\n\t\t}\n\t\telse umount_tree(mnt, UMOUNT_CONNECTED);\n\t}\n\tput_mountpoint(mp);\nout_unlock:\n\tunlock_mount_hash();\n\tnamespace_unlock();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/sched/task.h>",
            "#include <linux/task_work.h>",
            "#include <linux/memblock.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 event;",
            "static HLIST_HEAD(unmounted);",
            "static void shrink_submounts(struct mount *mnt);",
            "__latent_entropy\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/sched/task.h>\n#include <linux/task_work.h>\n#include <linux/memblock.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic u64 event;\nstatic HLIST_HEAD(unmounted);\nstatic void shrink_submounts(struct mount *mnt);\n__latent_entropy\nstruct;\n\nvoid __detach_mounts(struct dentry *dentry)\n{\n\tstruct mountpoint *mp;\n\tstruct mount *mnt;\n\n\tnamespace_lock();\n\tlock_mount_hash();\n\tmp = lookup_mountpoint(dentry);\n\tif (IS_ERR_OR_NULL(mp))\n\t\tgoto out_unlock;\n\n\tevent++;\n\twhile (!hlist_empty(&mp->m_list)) {\n\t\tmnt = hlist_entry(mp->m_list.first, struct mount, mnt_mp_list);\n\t\tif (mnt->mnt.mnt_flags & MNT_UMOUNT) {\n\t\t\thlist_add_head(&mnt->mnt_umount.s_list, &unmounted);\n\t\t\tumount_mnt(mnt);\n\t\t}\n\t\telse umount_tree(mnt, UMOUNT_CONNECTED);\n\t}\n\tput_mountpoint(mp);\nout_unlock:\n\tunlock_mount_hash();\n\tnamespace_unlock();\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_mountpoint",
          "args": [
            "dentry"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nextern struct mount *__lookup_mnt(struct vfsmount *, struct dentry *);\nextern void __detach_mounts(struct dentry *dentry);\nextern bool __is_local_mountpoint(struct dentry *dentry);\n\nstatic inline void detach_mounts(struct dentry *dentry)\n{\n\tif (!d_mountpoint(dentry))\n\t\treturn;\n\t__detach_mounts(dentry);\n}"
  },
  {
    "function_name": "__path_is_mountpoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "98-102",
    "snippet": "static inline bool __path_is_mountpoint(const struct path *path)\n{\n\tstruct mount *m = __lookup_mnt(path->mnt, path->dentry);\n\treturn m && likely(!(m->mnt.mnt_flags & MNT_SYNC_UMOUNT));\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern struct mount *__lookup_mnt(struct vfsmount *, struct dentry *);",
      "extern void __detach_mounts(struct dentry *dentry);",
      "extern bool __is_local_mountpoint(struct dentry *dentry);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!(m->mnt.mnt_flags & MNT_SYNC_UMOUNT)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__lookup_mnt",
          "args": [
            "path->mnt",
            "path->dentry"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "__lookup_mnt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/namespace.c",
          "lines": "613-622",
          "snippet": "struct mount *__lookup_mnt(struct vfsmount *mnt, struct dentry *dentry)\n{\n\tstruct hlist_head *head = m_hash(mnt, dentry);\n\tstruct mount *p;\n\n\thlist_for_each_entry_rcu(p, head, mnt_hash)\n\t\tif (&p->mnt_parent->mnt == mnt && p->mnt_mountpoint == dentry)\n\t\t\treturn p;\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/sched/task.h>",
            "#include <linux/task_work.h>",
            "#include <linux/memblock.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void shrink_submounts(struct mount *mnt);",
            "__latent_entropy\nstruct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/sched/task.h>\n#include <linux/task_work.h>\n#include <linux/memblock.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic void shrink_submounts(struct mount *mnt);\n__latent_entropy\nstruct;\n\nstruct mount *__lookup_mnt(struct vfsmount *mnt, struct dentry *dentry)\n{\n\tstruct hlist_head *head = m_hash(mnt, dentry);\n\tstruct mount *p;\n\n\thlist_for_each_entry_rcu(p, head, mnt_hash)\n\t\tif (&p->mnt_parent->mnt == mnt && p->mnt_mountpoint == dentry)\n\t\t\treturn p;\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nextern struct mount *__lookup_mnt(struct vfsmount *, struct dentry *);\nextern void __detach_mounts(struct dentry *dentry);\nextern bool __is_local_mountpoint(struct dentry *dentry);\n\nstatic inline bool __path_is_mountpoint(const struct path *path)\n{\n\tstruct mount *m = __lookup_mnt(path->mnt, path->dentry);\n\treturn m && likely(!(m->mnt.mnt_flags & MNT_SYNC_UMOUNT));\n}"
  },
  {
    "function_name": "is_mounted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "87-91",
    "snippet": "static inline int is_mounted(struct vfsmount *mnt)\n{\n\t/* neither detached nor internal? */\n\treturn !IS_ERR_OR_NULL(real_mount(mnt)->mnt_ns);\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern int __legitimize_mnt(struct vfsmount *, unsigned);",
      "extern bool legitimize_mnt(struct vfsmount *, unsigned);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "real_mount(mnt)->mnt_ns"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "real_mount",
          "args": [
            "mnt"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "real_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
          "lines": "77-80",
          "snippet": "static inline struct mount *real_mount(struct vfsmount *mnt)\n{\n\treturn container_of(mnt, struct mount, mnt);\n}",
          "includes": [
            "#include <linux/fs_pin.h>",
            "#include <linux/ns_common.h>",
            "#include <linux/poll.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/mount.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern int __legitimize_mnt(struct vfsmount *, unsigned);",
            "extern bool legitimize_mnt(struct vfsmount *, unsigned);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nextern int __legitimize_mnt(struct vfsmount *, unsigned);\nextern bool legitimize_mnt(struct vfsmount *, unsigned);\n\nstatic inline struct mount *real_mount(struct vfsmount *mnt)\n{\n\treturn container_of(mnt, struct mount, mnt);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nextern int __legitimize_mnt(struct vfsmount *, unsigned);\nextern bool legitimize_mnt(struct vfsmount *, unsigned);\n\nstatic inline int is_mounted(struct vfsmount *mnt)\n{\n\t/* neither detached nor internal? */\n\treturn !IS_ERR_OR_NULL(real_mount(mnt)->mnt_ns);\n}"
  },
  {
    "function_name": "mnt_has_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "82-85",
    "snippet": "static inline int mnt_has_parent(struct mount *mnt)\n{\n\treturn mnt != mnt->mnt_parent;\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nstatic inline int mnt_has_parent(struct mount *mnt)\n{\n\treturn mnt != mnt->mnt_parent;\n}"
  },
  {
    "function_name": "real_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/mount.h",
    "lines": "77-80",
    "snippet": "static inline struct mount *real_mount(struct vfsmount *mnt)\n{\n\treturn container_of(mnt, struct mount, mnt);\n}",
    "includes": [
      "#include <linux/fs_pin.h>",
      "#include <linux/ns_common.h>",
      "#include <linux/poll.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/mount.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "extern int __legitimize_mnt(struct vfsmount *, unsigned);",
      "extern bool legitimize_mnt(struct vfsmount *, unsigned);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "mnt",
            "structmount",
            "mnt"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs_pin.h>\n#include <linux/ns_common.h>\n#include <linux/poll.h>\n#include <linux/seq_file.h>\n#include <linux/mount.h>\n\nextern int __legitimize_mnt(struct vfsmount *, unsigned);\nextern bool legitimize_mnt(struct vfsmount *, unsigned);\n\nstatic inline struct mount *real_mount(struct vfsmount *mnt)\n{\n\treturn container_of(mnt, struct mount, mnt);\n}"
  }
]