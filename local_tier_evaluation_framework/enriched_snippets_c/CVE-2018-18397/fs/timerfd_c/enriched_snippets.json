[
  {
    "function_name": "do_timerfd_gettime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "503-533",
    "snippet": "static int do_timerfd_gettime(int ufd, struct itimerspec64 *t)\n{\n\tstruct fd f;\n\tstruct timerfd_ctx *ctx;\n\tint ret = timerfd_fget(ufd, &f);\n\tif (ret)\n\t\treturn ret;\n\tctx = f.file->private_data;\n\n\tspin_lock_irq(&ctx->wqh.lock);\n\tif (ctx->expired && ctx->tintv) {\n\t\tctx->expired = 0;\n\n\t\tif (isalarm(ctx)) {\n\t\t\tctx->ticks +=\n\t\t\t\talarm_forward_now(\n\t\t\t\t\t&ctx->t.alarm, ctx->tintv) - 1;\n\t\t\talarm_restart(&ctx->t.alarm);\n\t\t} else {\n\t\t\tctx->ticks +=\n\t\t\t\thrtimer_forward_now(&ctx->t.tmr, ctx->tintv)\n\t\t\t\t- 1;\n\t\t\thrtimer_restart(&ctx->t.tmr);\n\t\t}\n\t}\n\tt->it_value = ktime_to_timespec64(timerfd_get_remaining(ctx));\n\tt->it_interval = ktime_to_timespec64(ctx->tintv);\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tfdput(f);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec64",
          "args": [
            "ctx->tintv"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec64",
          "args": [
            "timerfd_get_remaining(ctx)"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_get_remaining",
          "args": [
            "ctx"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_get_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "160-170",
          "snippet": "static ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining_adjusted(&ctx->t.tmr);\n\n\treturn remaining < 0 ? 0: remaining;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining_adjusted(&ctx->t.tmr);\n\n\treturn remaining < 0 ? 0: remaining;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hrtimer_restart",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_forward_now",
          "args": [
            "&ctx->t.tmr",
            "ctx->tintv"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_restart",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_forward_now",
          "args": [
            "&ctx->t.alarm",
            "ctx->tintv"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "51-55",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_fget",
          "args": [
            "ufd",
            "&f"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_fget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "374-385",
          "snippet": "static int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};\n\nstatic int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int do_timerfd_gettime(int ufd, struct itimerspec64 *t)\n{\n\tstruct fd f;\n\tstruct timerfd_ctx *ctx;\n\tint ret = timerfd_fget(ufd, &f);\n\tif (ret)\n\t\treturn ret;\n\tctx = f.file->private_data;\n\n\tspin_lock_irq(&ctx->wqh.lock);\n\tif (ctx->expired && ctx->tintv) {\n\t\tctx->expired = 0;\n\n\t\tif (isalarm(ctx)) {\n\t\t\tctx->ticks +=\n\t\t\t\talarm_forward_now(\n\t\t\t\t\t&ctx->t.alarm, ctx->tintv) - 1;\n\t\t\talarm_restart(&ctx->t.alarm);\n\t\t} else {\n\t\t\tctx->ticks +=\n\t\t\t\thrtimer_forward_now(&ctx->t.tmr, ctx->tintv)\n\t\t\t\t- 1;\n\t\t\thrtimer_restart(&ctx->t.tmr);\n\t\t}\n\t}\n\tt->it_value = ktime_to_timespec64(timerfd_get_remaining(ctx));\n\tt->it_interval = ktime_to_timespec64(ctx->tintv);\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tfdput(f);\n\treturn 0;\n}"
  },
  {
    "function_name": "do_timerfd_settime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "435-501",
    "snippet": "static int do_timerfd_settime(int ufd, int flags, \n\t\tconst struct itimerspec64 *new,\n\t\tstruct itimerspec64 *old)\n{\n\tstruct fd f;\n\tstruct timerfd_ctx *ctx;\n\tint ret;\n\n\tif ((flags & ~TFD_SETTIME_FLAGS) ||\n\t\t !itimerspec64_valid(new))\n\t\treturn -EINVAL;\n\n\tret = timerfd_fget(ufd, &f);\n\tif (ret)\n\t\treturn ret;\n\tctx = f.file->private_data;\n\n\tif (isalarm(ctx) && !capable(CAP_WAKE_ALARM)) {\n\t\tfdput(f);\n\t\treturn -EPERM;\n\t}\n\n\ttimerfd_setup_cancel(ctx, flags);\n\n\t/*\n\t * We need to stop the existing timer before reprogramming\n\t * it to the new values.\n\t */\n\tfor (;;) {\n\t\tspin_lock_irq(&ctx->wqh.lock);\n\n\t\tif (isalarm(ctx)) {\n\t\t\tif (alarm_try_to_cancel(&ctx->t.alarm) >= 0)\n\t\t\t\tbreak;\n\t\t} else {\n\t\t\tif (hrtimer_try_to_cancel(&ctx->t.tmr) >= 0)\n\t\t\t\tbreak;\n\t\t}\n\t\tspin_unlock_irq(&ctx->wqh.lock);\n\t\tcpu_relax();\n\t}\n\n\t/*\n\t * If the timer is expired and it's periodic, we need to advance it\n\t * because the caller may want to know the previous expiration time.\n\t * We do not update \"ticks\" and \"expired\" since the timer will be\n\t * re-programmed again in the following timerfd_setup() call.\n\t */\n\tif (ctx->expired && ctx->tintv) {\n\t\tif (isalarm(ctx))\n\t\t\talarm_forward_now(&ctx->t.alarm, ctx->tintv);\n\t\telse\n\t\t\thrtimer_forward_now(&ctx->t.tmr, ctx->tintv);\n\t}\n\n\told->it_value = ktime_to_timespec64(timerfd_get_remaining(ctx));\n\told->it_interval = ktime_to_timespec64(ctx->tintv);\n\n\t/*\n\t * Re-program the timer to the new value ...\n\t */\n\tret = timerfd_setup(ctx, flags, new);\n\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tfdput(f);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_setup",
          "args": [
            "ctx",
            "flags",
            "new"
          ],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "172-214",
          "snippet": "static int timerfd_setup(struct timerfd_ctx *ctx, int flags,\n\t\t\t const struct itimerspec64 *ktmr)\n{\n\tenum hrtimer_mode htmode;\n\tktime_t texp;\n\tint clockid = ctx->clockid;\n\n\thtmode = (flags & TFD_TIMER_ABSTIME) ?\n\t\tHRTIMER_MODE_ABS: HRTIMER_MODE_REL;\n\n\ttexp = timespec64_to_ktime(ktmr->it_value);\n\tctx->expired = 0;\n\tctx->ticks = 0;\n\tctx->tintv = timespec64_to_ktime(ktmr->it_interval);\n\n\tif (isalarm(ctx)) {\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\t} else {\n\t\thrtimer_init(&ctx->t.tmr, clockid, htmode);\n\t\thrtimer_set_expires(&ctx->t.tmr, texp);\n\t\tctx->t.tmr.function = timerfd_tmrproc;\n\t}\n\n\tif (texp != 0) {\n\t\tif (isalarm(ctx)) {\n\t\t\tif (flags & TFD_TIMER_ABSTIME)\n\t\t\t\talarm_start(&ctx->t.alarm, texp);\n\t\t\telse\n\t\t\t\talarm_start_relative(&ctx->t.alarm, texp);\n\t\t} else {\n\t\t\thrtimer_start(&ctx->t.tmr, texp, htmode);\n\t\t}\n\n\t\tif (timerfd_canceled(ctx))\n\t\t\treturn -ECANCELED;\n\t}\n\n\tctx->settime_flags = flags & TFD_SETTIME_FLAGS;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int timerfd_setup(struct timerfd_ctx *ctx, int flags,\n\t\t\t const struct itimerspec64 *ktmr)\n{\n\tenum hrtimer_mode htmode;\n\tktime_t texp;\n\tint clockid = ctx->clockid;\n\n\thtmode = (flags & TFD_TIMER_ABSTIME) ?\n\t\tHRTIMER_MODE_ABS: HRTIMER_MODE_REL;\n\n\ttexp = timespec64_to_ktime(ktmr->it_value);\n\tctx->expired = 0;\n\tctx->ticks = 0;\n\tctx->tintv = timespec64_to_ktime(ktmr->it_interval);\n\n\tif (isalarm(ctx)) {\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\t} else {\n\t\thrtimer_init(&ctx->t.tmr, clockid, htmode);\n\t\thrtimer_set_expires(&ctx->t.tmr, texp);\n\t\tctx->t.tmr.function = timerfd_tmrproc;\n\t}\n\n\tif (texp != 0) {\n\t\tif (isalarm(ctx)) {\n\t\t\tif (flags & TFD_TIMER_ABSTIME)\n\t\t\t\talarm_start(&ctx->t.alarm, texp);\n\t\t\telse\n\t\t\t\talarm_start_relative(&ctx->t.alarm, texp);\n\t\t} else {\n\t\t\thrtimer_start(&ctx->t.tmr, texp, htmode);\n\t\t}\n\n\t\tif (timerfd_canceled(ctx))\n\t\t\treturn -ECANCELED;\n\t}\n\n\tctx->settime_flags = flags & TFD_SETTIME_FLAGS;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec64",
          "args": [
            "ctx->tintv"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec64",
          "args": [
            "timerfd_get_remaining(ctx)"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_get_remaining",
          "args": [
            "ctx"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_get_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "160-170",
          "snippet": "static ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining_adjusted(&ctx->t.tmr);\n\n\treturn remaining < 0 ? 0: remaining;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining_adjusted(&ctx->t.tmr);\n\n\treturn remaining < 0 ? 0: remaining;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hrtimer_forward_now",
          "args": [
            "&ctx->t.tmr",
            "ctx->tintv"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_forward_now",
          "args": [
            "&ctx->t.alarm",
            "ctx->tintv"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "51-55",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_relax",
          "args": [],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_try_to_cancel",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_try_to_cancel",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_setup_cancel",
          "args": [
            "ctx",
            "flags"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_setup_cancel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "142-158",
          "snippet": "static void timerfd_setup_cancel(struct timerfd_ctx *ctx, int flags)\n{\n\tspin_lock(&ctx->cancel_lock);\n\tif ((ctx->clockid == CLOCK_REALTIME ||\n\t     ctx->clockid == CLOCK_REALTIME_ALARM) &&\n\t    (flags & TFD_TIMER_ABSTIME) && (flags & TFD_TIMER_CANCEL_ON_SET)) {\n\t\tif (!ctx->might_cancel) {\n\t\t\tctx->might_cancel = true;\n\t\t\tspin_lock(&cancel_lock);\n\t\t\tlist_add_rcu(&ctx->clist, &cancel_list);\n\t\t\tspin_unlock(&cancel_lock);\n\t\t}\n\t} else {\n\t\t__timerfd_remove_cancel(ctx);\n\t}\n\tspin_unlock(&ctx->cancel_lock);\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(cancel_list);",
            "static DEFINE_SPINLOCK(cancel_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic LIST_HEAD(cancel_list);\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_setup_cancel(struct timerfd_ctx *ctx, int flags)\n{\n\tspin_lock(&ctx->cancel_lock);\n\tif ((ctx->clockid == CLOCK_REALTIME ||\n\t     ctx->clockid == CLOCK_REALTIME_ALARM) &&\n\t    (flags & TFD_TIMER_ABSTIME) && (flags & TFD_TIMER_CANCEL_ON_SET)) {\n\t\tif (!ctx->might_cancel) {\n\t\t\tctx->might_cancel = true;\n\t\t\tspin_lock(&cancel_lock);\n\t\t\tlist_add_rcu(&ctx->clist, &cancel_list);\n\t\t\tspin_unlock(&cancel_lock);\n\t\t}\n\t} else {\n\t\t__timerfd_remove_cancel(ctx);\n\t}\n\tspin_unlock(&ctx->cancel_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_WAKE_ALARM"
          ],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "inode_owner_or_capable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/inode.c",
          "lines": "2033-2044",
          "snippet": "bool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (kuid_has_mapping(ns, inode->i_uid) && ns_capable(ns, CAP_FOWNER))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/iversion.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/buffer_head.h> /* for inode_has_buffers */",
            "#include <linux/prefetch.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/mount.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/memblock.h>",
            "#include <linux/cdev.h>",
            "#include <linux/security.h>",
            "#include <linux/swap.h>",
            "#include <linux/hash.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __wait_on_freeing_inode(struct inode *inode);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/iversion.h>\n#include <linux/list_lru.h>\n#include <linux/ratelimit.h>\n#include <linux/buffer_head.h> /* for inode_has_buffers */\n#include <linux/prefetch.h>\n#include <linux/posix_acl.h>\n#include <linux/mount.h>\n#include <linux/fsnotify.h>\n#include <linux/memblock.h>\n#include <linux/cdev.h>\n#include <linux/security.h>\n#include <linux/swap.h>\n#include <linux/hash.h>\n#include <linux/backing-dev.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n\nstatic void __wait_on_freeing_inode(struct inode *inode);\n\nbool inode_owner_or_capable(const struct inode *inode)\n{\n\tstruct user_namespace *ns;\n\n\tif (uid_eq(current_fsuid(), inode->i_uid))\n\t\treturn true;\n\n\tns = current_user_ns();\n\tif (kuid_has_mapping(ns, inode->i_uid) && ns_capable(ns, CAP_FOWNER))\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timerfd_fget",
          "args": [
            "ufd",
            "&f"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_fget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "374-385",
          "snippet": "static int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};\n\nstatic int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "itimerspec64_valid",
          "args": [
            "new"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int do_timerfd_settime(int ufd, int flags, \n\t\tconst struct itimerspec64 *new,\n\t\tstruct itimerspec64 *old)\n{\n\tstruct fd f;\n\tstruct timerfd_ctx *ctx;\n\tint ret;\n\n\tif ((flags & ~TFD_SETTIME_FLAGS) ||\n\t\t !itimerspec64_valid(new))\n\t\treturn -EINVAL;\n\n\tret = timerfd_fget(ufd, &f);\n\tif (ret)\n\t\treturn ret;\n\tctx = f.file->private_data;\n\n\tif (isalarm(ctx) && !capable(CAP_WAKE_ALARM)) {\n\t\tfdput(f);\n\t\treturn -EPERM;\n\t}\n\n\ttimerfd_setup_cancel(ctx, flags);\n\n\t/*\n\t * We need to stop the existing timer before reprogramming\n\t * it to the new values.\n\t */\n\tfor (;;) {\n\t\tspin_lock_irq(&ctx->wqh.lock);\n\n\t\tif (isalarm(ctx)) {\n\t\t\tif (alarm_try_to_cancel(&ctx->t.alarm) >= 0)\n\t\t\t\tbreak;\n\t\t} else {\n\t\t\tif (hrtimer_try_to_cancel(&ctx->t.tmr) >= 0)\n\t\t\t\tbreak;\n\t\t}\n\t\tspin_unlock_irq(&ctx->wqh.lock);\n\t\tcpu_relax();\n\t}\n\n\t/*\n\t * If the timer is expired and it's periodic, we need to advance it\n\t * because the caller may want to know the previous expiration time.\n\t * We do not update \"ticks\" and \"expired\" since the timer will be\n\t * re-programmed again in the following timerfd_setup() call.\n\t */\n\tif (ctx->expired && ctx->tintv) {\n\t\tif (isalarm(ctx))\n\t\t\talarm_forward_now(&ctx->t.alarm, ctx->tintv);\n\t\telse\n\t\t\thrtimer_forward_now(&ctx->t.tmr, ctx->tintv);\n\t}\n\n\told->it_value = ktime_to_timespec64(timerfd_get_remaining(ctx));\n\told->it_interval = ktime_to_timespec64(ctx->tintv);\n\n\t/*\n\t * Re-program the timer to the new value ...\n\t */\n\tret = timerfd_setup(ctx, flags, new);\n\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tfdput(f);\n\treturn ret;\n}"
  },
  {
    "function_name": "timerfd_fget",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "374-385",
    "snippet": "static int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdput",
          "args": [
            "f"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fdget",
          "args": [
            "fd"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "__fdget_pos",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/file.c",
          "lines": "758-770",
          "snippet": "unsigned long __fdget_pos(unsigned int fd)\n{\n\tunsigned long v = __fdget(fd);\n\tstruct file *file = (struct file *)(v & ~3);\n\n\tif (file && (file->f_mode & FMODE_ATOMIC_POS)) {\n\t\tif (file_count(file) > 1) {\n\t\t\tv |= FDPUT_POS_UNLOCK;\n\t\t\tmutex_lock(&file->f_pos_lock);\n\t\t}\n\t}\n\treturn v;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nunsigned long __fdget_pos(unsigned int fd)\n{\n\tunsigned long v = __fdget(fd);\n\tstruct file *file = (struct file *)(v & ~3);\n\n\tif (file && (file->f_mode & FMODE_ATOMIC_POS)) {\n\t\tif (file_count(file) > 1) {\n\t\t\tv |= FDPUT_POS_UNLOCK;\n\t\t\tmutex_lock(&file->f_pos_lock);\n\t\t}\n\t}\n\treturn v;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};\n\nstatic int timerfd_fget(int fd, struct fd *p)\n{\n\tstruct fd f = fdget(fd);\n\tif (!f.file)\n\t\treturn -EBADF;\n\tif (f.file->f_op != &timerfd_fops) {\n\t\tfdput(f);\n\t\treturn -EINVAL;\n\t}\n\t*p = f;\n\treturn 0;\n}"
  },
  {
    "function_name": "timerfd_ioctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "331-360",
    "snippet": "static long timerfd_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tint ret = 0;\n\n\tswitch (cmd) {\n\tcase TFD_IOC_SET_TICKS: {\n\t\tu64 ticks;\n\n\t\tif (copy_from_user(&ticks, (u64 __user *)arg, sizeof(ticks)))\n\t\t\treturn -EFAULT;\n\t\tif (!ticks)\n\t\t\treturn -EINVAL;\n\n\t\tspin_lock_irq(&ctx->wqh.lock);\n\t\tif (!timerfd_canceled(ctx)) {\n\t\t\tctx->ticks = ticks;\n\t\t\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\t\t} else\n\t\t\tret = -ECANCELED;\n\t\tspin_unlock_irq(&ctx->wqh.lock);\n\t\tbreak;\n\t}\n\tdefault:\n\t\tret = -ENOTTY;\n\t\tbreak;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [
      "#define timerfd_ioctl NULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_locked_poll",
          "args": [
            "&ctx->wqh",
            "EPOLLIN"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_canceled",
          "args": [
            "ctx"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_canceled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "134-140",
          "snippet": "static bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real(0);\n\treturn true;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real(0);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "&ticks",
            "(u64 __user *)arg",
            "sizeof(ticks)"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "exact_copy_from_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/namespace.c",
          "lines": "2647-2669",
          "snippet": "static long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\tcurrent->kernel_uaccess_faults_ok++;\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\tcurrent->kernel_uaccess_faults_ok--;\n\treturn n;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"pnode.h\"",
            "#include <linux/sched/task.h>",
            "#include <linux/task_work.h>",
            "#include <linux/memblock.h>",
            "#include <linux/magic.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */",
            "#include <linux/fs_struct.h>\t/* get_fs_root et.al. */",
            "#include <linux/init.h>\t\t/* init_rootfs */",
            "#include <linux/idr.h>",
            "#include <linux/cred.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/mnt_namespace.h>",
            "#include <linux/capability.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"pnode.h\"\n#include <linux/sched/task.h>\n#include <linux/task_work.h>\n#include <linux/memblock.h>\n#include <linux/magic.h>\n#include <linux/proc_ns.h>\n#include <linux/uaccess.h>\n#include <linux/fsnotify.h>\t/* fsnotify_vfsmount_delete */\n#include <linux/fs_struct.h>\t/* get_fs_root et.al. */\n#include <linux/init.h>\t\t/* init_rootfs */\n#include <linux/idr.h>\n#include <linux/cred.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/user_namespace.h>\n#include <linux/mnt_namespace.h>\n#include <linux/capability.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n\nstatic long exact_copy_from_user(void *to, const void __user * from,\n\t\t\t\t unsigned long n)\n{\n\tchar *t = to;\n\tconst char __user *f = from;\n\tchar c;\n\n\tif (!access_ok(VERIFY_READ, from, n))\n\t\treturn n;\n\n\tcurrent->kernel_uaccess_faults_ok++;\n\twhile (n) {\n\t\tif (__get_user(c, f)) {\n\t\t\tmemset(t, 0, n);\n\t\t\tbreak;\n\t\t}\n\t\t*t++ = c;\n\t\tf++;\n\t\tn--;\n\t}\n\tcurrent->kernel_uaccess_faults_ok--;\n\treturn n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\n#define timerfd_ioctl NULL\n\nstatic long timerfd_ioctl(struct file *file, unsigned int cmd, unsigned long arg)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tint ret = 0;\n\n\tswitch (cmd) {\n\tcase TFD_IOC_SET_TICKS: {\n\t\tu64 ticks;\n\n\t\tif (copy_from_user(&ticks, (u64 __user *)arg, sizeof(ticks)))\n\t\t\treturn -EFAULT;\n\t\tif (!ticks)\n\t\t\treturn -EINVAL;\n\n\t\tspin_lock_irq(&ctx->wqh.lock);\n\t\tif (!timerfd_canceled(ctx)) {\n\t\t\tctx->ticks = ticks;\n\t\t\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\t\t} else\n\t\t\tret = -ECANCELED;\n\t\tspin_unlock_irq(&ctx->wqh.lock);\n\t\tbreak;\n\t}\n\tdefault:\n\t\tret = -ENOTTY;\n\t\tbreak;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "timerfd_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "302-325",
    "snippet": "static void timerfd_show(struct seq_file *m, struct file *file)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tstruct itimerspec t;\n\n\tspin_lock_irq(&ctx->wqh.lock);\n\tt.it_value = ktime_to_timespec(timerfd_get_remaining(ctx));\n\tt.it_interval = ktime_to_timespec(ctx->tintv);\n\tspin_unlock_irq(&ctx->wqh.lock);\n\n\tseq_printf(m,\n\t\t   \"clockid: %d\\n\"\n\t\t   \"ticks: %llu\\n\"\n\t\t   \"settime flags: 0%o\\n\"\n\t\t   \"it_value: (%llu, %llu)\\n\"\n\t\t   \"it_interval: (%llu, %llu)\\n\",\n\t\t   ctx->clockid,\n\t\t   (unsigned long long)ctx->ticks,\n\t\t   ctx->settime_flags,\n\t\t   (unsigned long long)t.it_value.tv_sec,\n\t\t   (unsigned long long)t.it_value.tv_nsec,\n\t\t   (unsigned long long)t.it_interval.tv_sec,\n\t\t   (unsigned long long)t.it_interval.tv_nsec);\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [
      "#define timerfd_show NULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"clockid: %d\\n\"\n\t\t   \"ticks: %llu\\n\"\n\t\t   \"settime flags: 0%o\\n\"\n\t\t   \"it_value: (%llu, %llu)\\n\"\n\t\t   \"it_interval: (%llu, %llu)\\n\"",
            "ctx->clockid",
            "(unsigned long long)ctx->ticks",
            "ctx->settime_flags",
            "(unsigned long long)t.it_value.tv_sec",
            "(unsigned long long)t.it_value.tv_nsec",
            "(unsigned long long)t.it_interval.tv_sec",
            "(unsigned long long)t.it_interval.tv_nsec"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "seq_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/seq_file.c",
          "lines": "401-408",
          "snippet": "void seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tva_list args;\n\n\tva_start(args, f);\n\tseq_vprintf(m, f, args);\n\tva_end(args);\n}",
          "includes": [
            "#include <asm/page.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/string_helpers.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/export.h>",
            "#include <linux/fs.h>",
            "#include <linux/cache.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/page.h>\n#include <linux/uaccess.h>\n#include <linux/string_helpers.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/vmalloc.h>\n#include <linux/seq_file.h>\n#include <linux/export.h>\n#include <linux/fs.h>\n#include <linux/cache.h>\n\nvoid seq_printf(struct seq_file *m, const char *f, ...)\n{\n\tva_list args;\n\n\tva_start(args, f);\n\tseq_vprintf(m, f, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec",
          "args": [
            "ctx->tintv"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_to_timespec",
          "args": [
            "timerfd_get_remaining(ctx)"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerfd_get_remaining",
          "args": [
            "ctx"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_get_remaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "160-170",
          "snippet": "static ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining_adjusted(&ctx->t.tmr);\n\n\treturn remaining < 0 ? 0: remaining;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining_adjusted(&ctx->t.tmr);\n\n\treturn remaining < 0 ? 0: remaining;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\n#define timerfd_show NULL\n\nstatic void timerfd_show(struct seq_file *m, struct file *file)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tstruct itimerspec t;\n\n\tspin_lock_irq(&ctx->wqh.lock);\n\tt.it_value = ktime_to_timespec(timerfd_get_remaining(ctx));\n\tt.it_interval = ktime_to_timespec(ctx->tintv);\n\tspin_unlock_irq(&ctx->wqh.lock);\n\n\tseq_printf(m,\n\t\t   \"clockid: %d\\n\"\n\t\t   \"ticks: %llu\\n\"\n\t\t   \"settime flags: 0%o\\n\"\n\t\t   \"it_value: (%llu, %llu)\\n\"\n\t\t   \"it_interval: (%llu, %llu)\\n\",\n\t\t   ctx->clockid,\n\t\t   (unsigned long long)ctx->ticks,\n\t\t   ctx->settime_flags,\n\t\t   (unsigned long long)t.it_value.tv_sec,\n\t\t   (unsigned long long)t.it_value.tv_nsec,\n\t\t   (unsigned long long)t.it_interval.tv_sec,\n\t\t   (unsigned long long)t.it_interval.tv_nsec);\n}"
  },
  {
    "function_name": "timerfd_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "246-299",
    "snippet": "static ssize_t timerfd_read(struct file *file, char __user *buf, size_t count,\n\t\t\t    loff_t *ppos)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tssize_t res;\n\tu64 ticks = 0;\n\n\tif (count < sizeof(ticks))\n\t\treturn -EINVAL;\n\tspin_lock_irq(&ctx->wqh.lock);\n\tif (file->f_flags & O_NONBLOCK)\n\t\tres = -EAGAIN;\n\telse\n\t\tres = wait_event_interruptible_locked_irq(ctx->wqh, ctx->ticks);\n\n\t/*\n\t * If clock has changed, we do not care about the\n\t * ticks and we do not rearm the timer. Userspace must\n\t * reevaluate anyway.\n\t */\n\tif (timerfd_canceled(ctx)) {\n\t\tctx->ticks = 0;\n\t\tctx->expired = 0;\n\t\tres = -ECANCELED;\n\t}\n\n\tif (ctx->ticks) {\n\t\tticks = ctx->ticks;\n\n\t\tif (ctx->expired && ctx->tintv) {\n\t\t\t/*\n\t\t\t * If tintv != 0, this is a periodic timer that\n\t\t\t * needs to be re-armed. We avoid doing it in the timer\n\t\t\t * callback to avoid DoS attacks specifying a very\n\t\t\t * short timer period.\n\t\t\t */\n\t\t\tif (isalarm(ctx)) {\n\t\t\t\tticks += alarm_forward_now(\n\t\t\t\t\t&ctx->t.alarm, ctx->tintv) - 1;\n\t\t\t\talarm_restart(&ctx->t.alarm);\n\t\t\t} else {\n\t\t\t\tticks += hrtimer_forward_now(&ctx->t.tmr,\n\t\t\t\t\t\t\t     ctx->tintv) - 1;\n\t\t\t\thrtimer_restart(&ctx->t.tmr);\n\t\t\t}\n\t\t}\n\t\tctx->expired = 0;\n\t\tctx->ticks = 0;\n\t}\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tif (ticks)\n\t\tres = put_user(ticks, (u64 __user *) buf) ? -EFAULT: sizeof(ticks);\n\treturn res;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_user",
          "args": [
            "ticks",
            "(u64 __user *) buf"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_restart",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_forward_now",
          "args": [
            "&ctx->t.tmr",
            "ctx->tintv"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_restart",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_forward_now",
          "args": [
            "&ctx->t.alarm",
            "ctx->tintv"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "51-55",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timerfd_canceled",
          "args": [
            "ctx"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_canceled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "134-140",
          "snippet": "static bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real(0);\n\treturn true;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real(0);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_event_interruptible_locked_irq",
          "args": [
            "ctx->wqh",
            "ctx->ticks"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&ctx->wqh.lock"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ssize_t timerfd_read(struct file *file, char __user *buf, size_t count,\n\t\t\t    loff_t *ppos)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\tssize_t res;\n\tu64 ticks = 0;\n\n\tif (count < sizeof(ticks))\n\t\treturn -EINVAL;\n\tspin_lock_irq(&ctx->wqh.lock);\n\tif (file->f_flags & O_NONBLOCK)\n\t\tres = -EAGAIN;\n\telse\n\t\tres = wait_event_interruptible_locked_irq(ctx->wqh, ctx->ticks);\n\n\t/*\n\t * If clock has changed, we do not care about the\n\t * ticks and we do not rearm the timer. Userspace must\n\t * reevaluate anyway.\n\t */\n\tif (timerfd_canceled(ctx)) {\n\t\tctx->ticks = 0;\n\t\tctx->expired = 0;\n\t\tres = -ECANCELED;\n\t}\n\n\tif (ctx->ticks) {\n\t\tticks = ctx->ticks;\n\n\t\tif (ctx->expired && ctx->tintv) {\n\t\t\t/*\n\t\t\t * If tintv != 0, this is a periodic timer that\n\t\t\t * needs to be re-armed. We avoid doing it in the timer\n\t\t\t * callback to avoid DoS attacks specifying a very\n\t\t\t * short timer period.\n\t\t\t */\n\t\t\tif (isalarm(ctx)) {\n\t\t\t\tticks += alarm_forward_now(\n\t\t\t\t\t&ctx->t.alarm, ctx->tintv) - 1;\n\t\t\t\talarm_restart(&ctx->t.alarm);\n\t\t\t} else {\n\t\t\t\tticks += hrtimer_forward_now(&ctx->t.tmr,\n\t\t\t\t\t\t\t     ctx->tintv) - 1;\n\t\t\t\thrtimer_restart(&ctx->t.tmr);\n\t\t\t}\n\t\t}\n\t\tctx->expired = 0;\n\t\tctx->ticks = 0;\n\t}\n\tspin_unlock_irq(&ctx->wqh.lock);\n\tif (ticks)\n\t\tres = put_user(ticks, (u64 __user *) buf) ? -EFAULT: sizeof(ticks);\n\treturn res;\n}"
  },
  {
    "function_name": "timerfd_poll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "230-244",
    "snippet": "static __poll_t timerfd_poll(struct file *file, poll_table *wait)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\t__poll_t events = 0;\n\tunsigned long flags;\n\n\tpoll_wait(file, &ctx->wqh, wait);\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tif (ctx->ticks)\n\t\tevents |= EPOLLIN;\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n\n\treturn events;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "poll_wait",
          "args": [
            "file",
            "&ctx->wqh",
            "wait"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic __poll_t timerfd_poll(struct file *file, poll_table *wait)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\t__poll_t events = 0;\n\tunsigned long flags;\n\n\tpoll_wait(file, &ctx->wqh, wait);\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tif (ctx->ticks)\n\t\tevents |= EPOLLIN;\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n\n\treturn events;\n}"
  },
  {
    "function_name": "timerfd_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "216-228",
    "snippet": "static int timerfd_release(struct inode *inode, struct file *file)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\n\ttimerfd_remove_cancel(ctx);\n\n\tif (isalarm(ctx))\n\t\talarm_cancel(&ctx->t.alarm);\n\telse\n\t\thrtimer_cancel(&ctx->t.tmr);\n\tkfree_rcu(ctx, rcu);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree_rcu",
          "args": [
            "ctx",
            "rcu"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_cancel",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_cancel",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "51-55",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "timerfd_remove_cancel",
          "args": [
            "ctx"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_remove_cancel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "127-132",
          "snippet": "static void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tspin_lock(&ctx->cancel_lock);\n\t__timerfd_remove_cancel(ctx);\n\tspin_unlock(&ctx->cancel_lock);\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cancel_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tspin_lock(&ctx->cancel_lock);\n\t__timerfd_remove_cancel(ctx);\n\tspin_unlock(&ctx->cancel_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int timerfd_release(struct inode *inode, struct file *file)\n{\n\tstruct timerfd_ctx *ctx = file->private_data;\n\n\ttimerfd_remove_cancel(ctx);\n\n\tif (isalarm(ctx))\n\t\talarm_cancel(&ctx->t.alarm);\n\telse\n\t\thrtimer_cancel(&ctx->t.tmr);\n\tkfree_rcu(ctx, rcu);\n\treturn 0;\n}"
  },
  {
    "function_name": "timerfd_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "172-214",
    "snippet": "static int timerfd_setup(struct timerfd_ctx *ctx, int flags,\n\t\t\t const struct itimerspec64 *ktmr)\n{\n\tenum hrtimer_mode htmode;\n\tktime_t texp;\n\tint clockid = ctx->clockid;\n\n\thtmode = (flags & TFD_TIMER_ABSTIME) ?\n\t\tHRTIMER_MODE_ABS: HRTIMER_MODE_REL;\n\n\ttexp = timespec64_to_ktime(ktmr->it_value);\n\tctx->expired = 0;\n\tctx->ticks = 0;\n\tctx->tintv = timespec64_to_ktime(ktmr->it_interval);\n\n\tif (isalarm(ctx)) {\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\t} else {\n\t\thrtimer_init(&ctx->t.tmr, clockid, htmode);\n\t\thrtimer_set_expires(&ctx->t.tmr, texp);\n\t\tctx->t.tmr.function = timerfd_tmrproc;\n\t}\n\n\tif (texp != 0) {\n\t\tif (isalarm(ctx)) {\n\t\t\tif (flags & TFD_TIMER_ABSTIME)\n\t\t\t\talarm_start(&ctx->t.alarm, texp);\n\t\t\telse\n\t\t\t\talarm_start_relative(&ctx->t.alarm, texp);\n\t\t} else {\n\t\t\thrtimer_start(&ctx->t.tmr, texp, htmode);\n\t\t}\n\n\t\tif (timerfd_canceled(ctx))\n\t\t\treturn -ECANCELED;\n\t}\n\n\tctx->settime_flags = flags & TFD_SETTIME_FLAGS;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timerfd_canceled",
          "args": [
            "ctx"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_canceled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "134-140",
          "snippet": "static bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real(0);\n\treturn true;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real(0);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hrtimer_start",
          "args": [
            "&ctx->t.tmr",
            "texp",
            "htmode"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_start_relative",
          "args": [
            "&ctx->t.alarm",
            "texp"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_start",
          "args": [
            "&ctx->t.alarm",
            "texp"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "51-55",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hrtimer_set_expires",
          "args": [
            "&ctx->t.tmr",
            "texp"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hrtimer_init",
          "args": [
            "&ctx->t.tmr",
            "clockid",
            "htmode"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_init",
          "args": [
            "&ctx->t.alarm",
            "ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME",
            "timerfd_alarmproc"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec64_to_ktime",
          "args": [
            "ktmr->it_interval"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timespec64_to_ktime",
          "args": [
            "ktmr->it_value"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic int timerfd_setup(struct timerfd_ctx *ctx, int flags,\n\t\t\t const struct itimerspec64 *ktmr)\n{\n\tenum hrtimer_mode htmode;\n\tktime_t texp;\n\tint clockid = ctx->clockid;\n\n\thtmode = (flags & TFD_TIMER_ABSTIME) ?\n\t\tHRTIMER_MODE_ABS: HRTIMER_MODE_REL;\n\n\ttexp = timespec64_to_ktime(ktmr->it_value);\n\tctx->expired = 0;\n\tctx->ticks = 0;\n\tctx->tintv = timespec64_to_ktime(ktmr->it_interval);\n\n\tif (isalarm(ctx)) {\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\t} else {\n\t\thrtimer_init(&ctx->t.tmr, clockid, htmode);\n\t\thrtimer_set_expires(&ctx->t.tmr, texp);\n\t\tctx->t.tmr.function = timerfd_tmrproc;\n\t}\n\n\tif (texp != 0) {\n\t\tif (isalarm(ctx)) {\n\t\t\tif (flags & TFD_TIMER_ABSTIME)\n\t\t\t\talarm_start(&ctx->t.alarm, texp);\n\t\t\telse\n\t\t\t\talarm_start_relative(&ctx->t.alarm, texp);\n\t\t} else {\n\t\t\thrtimer_start(&ctx->t.tmr, texp, htmode);\n\t\t}\n\n\t\tif (timerfd_canceled(ctx))\n\t\t\treturn -ECANCELED;\n\t}\n\n\tctx->settime_flags = flags & TFD_SETTIME_FLAGS;\n\treturn 0;\n}"
  },
  {
    "function_name": "timerfd_get_remaining",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "160-170",
    "snippet": "static ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining_adjusted(&ctx->t.tmr);\n\n\treturn remaining < 0 ? 0: remaining;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hrtimer_expires_remaining_adjusted",
          "args": [
            "&ctx->t.tmr"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alarm_expires_remaining",
          "args": [
            "&ctx->t.alarm"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalarm",
          "args": [
            "ctx"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "isalarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "51-55",
          "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic ktime_t timerfd_get_remaining(struct timerfd_ctx *ctx)\n{\n\tktime_t remaining;\n\n\tif (isalarm(ctx))\n\t\tremaining = alarm_expires_remaining(&ctx->t.alarm);\n\telse\n\t\tremaining = hrtimer_expires_remaining_adjusted(&ctx->t.tmr);\n\n\treturn remaining < 0 ? 0: remaining;\n}"
  },
  {
    "function_name": "timerfd_setup_cancel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "142-158",
    "snippet": "static void timerfd_setup_cancel(struct timerfd_ctx *ctx, int flags)\n{\n\tspin_lock(&ctx->cancel_lock);\n\tif ((ctx->clockid == CLOCK_REALTIME ||\n\t     ctx->clockid == CLOCK_REALTIME_ALARM) &&\n\t    (flags & TFD_TIMER_ABSTIME) && (flags & TFD_TIMER_CANCEL_ON_SET)) {\n\t\tif (!ctx->might_cancel) {\n\t\t\tctx->might_cancel = true;\n\t\t\tspin_lock(&cancel_lock);\n\t\t\tlist_add_rcu(&ctx->clist, &cancel_list);\n\t\t\tspin_unlock(&cancel_lock);\n\t\t}\n\t} else {\n\t\t__timerfd_remove_cancel(ctx);\n\t}\n\tspin_unlock(&ctx->cancel_lock);\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(cancel_list);",
      "static DEFINE_SPINLOCK(cancel_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ctx->cancel_lock"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__timerfd_remove_cancel",
          "args": [
            "ctx"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "__timerfd_remove_cancel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "117-125",
          "snippet": "static void __timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cancel_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void __timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_rcu",
          "args": [
            "&ctx->clist",
            "&cancel_list"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cancel_lock"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic LIST_HEAD(cancel_list);\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_setup_cancel(struct timerfd_ctx *ctx, int flags)\n{\n\tspin_lock(&ctx->cancel_lock);\n\tif ((ctx->clockid == CLOCK_REALTIME ||\n\t     ctx->clockid == CLOCK_REALTIME_ALARM) &&\n\t    (flags & TFD_TIMER_ABSTIME) && (flags & TFD_TIMER_CANCEL_ON_SET)) {\n\t\tif (!ctx->might_cancel) {\n\t\t\tctx->might_cancel = true;\n\t\t\tspin_lock(&cancel_lock);\n\t\t\tlist_add_rcu(&ctx->clist, &cancel_list);\n\t\t\tspin_unlock(&cancel_lock);\n\t\t}\n\t} else {\n\t\t__timerfd_remove_cancel(ctx);\n\t}\n\tspin_unlock(&ctx->cancel_lock);\n}"
  },
  {
    "function_name": "timerfd_canceled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "134-140",
    "snippet": "static bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real(0);\n\treturn true;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ktime_mono_to_real",
          "args": [
            "0"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "ktime_mono_to_real_seconds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/reiserfs/procfs.c",
          "lines": "300-305",
          "snippet": "static time64_t ktime_mono_to_real_seconds(time64_t mono)\n{\n\tktime_t kt = ktime_set(mono, NSEC_PER_SEC/2);\n\n\treturn ktime_divns(ktime_mono_to_real(kt), NSEC_PER_SEC);\n}",
          "includes": [
            "#include <linux/proc_fs.h>",
            "#include <linux/init.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_fs.h>\n#include <linux/init.h>\n#include \"reiserfs.h\"\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nstatic time64_t ktime_mono_to_real_seconds(time64_t mono)\n{\n\tktime_t kt = ktime_set(mono, NSEC_PER_SEC/2);\n\n\treturn ktime_divns(ktime_mono_to_real(kt), NSEC_PER_SEC);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic bool timerfd_canceled(struct timerfd_ctx *ctx)\n{\n\tif (!ctx->might_cancel || ctx->moffs != KTIME_MAX)\n\t\treturn false;\n\tctx->moffs = ktime_mono_to_real(0);\n\treturn true;\n}"
  },
  {
    "function_name": "timerfd_remove_cancel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "127-132",
    "snippet": "static void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tspin_lock(&ctx->cancel_lock);\n\t__timerfd_remove_cancel(ctx);\n\tspin_unlock(&ctx->cancel_lock);\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(cancel_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ctx->cancel_lock"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__timerfd_remove_cancel",
          "args": [
            "ctx"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "__timerfd_remove_cancel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "117-125",
          "snippet": "static void __timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(cancel_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void __timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ctx->cancel_lock"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tspin_lock(&ctx->cancel_lock);\n\t__timerfd_remove_cancel(ctx);\n\tspin_unlock(&ctx->cancel_lock);\n}"
  },
  {
    "function_name": "__timerfd_remove_cancel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "117-125",
    "snippet": "static void __timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(cancel_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&cancel_lock"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&ctx->clist"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&cancel_lock"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\n\nstatic void __timerfd_remove_cancel(struct timerfd_ctx *ctx)\n{\n\tif (ctx->might_cancel) {\n\t\tctx->might_cancel = false;\n\t\tspin_lock(&cancel_lock);\n\t\tlist_del_rcu(&ctx->clist);\n\t\tspin_unlock(&cancel_lock);\n\t}\n}"
  },
  {
    "function_name": "timerfd_clock_was_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "96-115",
    "snippet": "void timerfd_clock_was_set(void)\n{\n\tktime_t moffs = ktime_mono_to_real(0);\n\tstruct timerfd_ctx *ctx;\n\tunsigned long flags;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(ctx, &cancel_list, clist) {\n\t\tif (!ctx->might_cancel)\n\t\t\tcontinue;\n\t\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\t\tif (ctx->moffs != moffs) {\n\t\t\tctx->moffs = KTIME_MAX;\n\t\t\tctx->ticks++;\n\t\t\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\t\t}\n\t\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n\t}\n\trcu_read_unlock();\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(cancel_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_locked_poll",
          "args": [
            "&ctx->wqh",
            "EPOLLIN"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "ctx",
            "&cancel_list",
            "clist"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ktime_mono_to_real",
          "args": [
            "0"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "ktime_mono_to_real_seconds",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/reiserfs/procfs.c",
          "lines": "300-305",
          "snippet": "static time64_t ktime_mono_to_real_seconds(time64_t mono)\n{\n\tktime_t kt = ktime_set(mono, NSEC_PER_SEC/2);\n\n\treturn ktime_divns(ktime_mono_to_real(kt), NSEC_PER_SEC);\n}",
          "includes": [
            "#include <linux/proc_fs.h>",
            "#include <linux/init.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/time.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/proc_fs.h>\n#include <linux/init.h>\n#include \"reiserfs.h\"\n#include <linux/uaccess.h>\n#include <linux/seq_file.h>\n#include <linux/time.h>\n#include <linux/module.h>\n\nstatic time64_t ktime_mono_to_real_seconds(time64_t mono)\n{\n\tktime_t kt = ktime_set(mono, NSEC_PER_SEC/2);\n\n\treturn ktime_divns(ktime_mono_to_real(kt), NSEC_PER_SEC);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic LIST_HEAD(cancel_list);\n\nvoid timerfd_clock_was_set(void)\n{\n\tktime_t moffs = ktime_mono_to_real(0);\n\tstruct timerfd_ctx *ctx;\n\tunsigned long flags;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(ctx, &cancel_list, clist) {\n\t\tif (!ctx->might_cancel)\n\t\t\tcontinue;\n\t\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\t\tif (ctx->moffs != moffs) {\n\t\t\tctx->moffs = KTIME_MAX;\n\t\t\tctx->ticks++;\n\t\t\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\t\t}\n\t\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n\t}\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "timerfd_alarmproc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "81-88",
    "snippet": "static enum alarmtimer_restart timerfd_alarmproc(struct alarm *alarm,\n\tktime_t now)\n{\n\tstruct timerfd_ctx *ctx = container_of(alarm, struct timerfd_ctx,\n\t\t\t\t\t       t.alarm);\n\ttimerfd_triggered(ctx);\n\treturn ALARMTIMER_NORESTART;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timerfd_triggered",
          "args": [
            "ctx"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_triggered",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "62-71",
          "snippet": "static void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "alarm",
            "structtimerfd_ctx",
            "t.alarm"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic enum alarmtimer_restart timerfd_alarmproc(struct alarm *alarm,\n\tktime_t now)\n{\n\tstruct timerfd_ctx *ctx = container_of(alarm, struct timerfd_ctx,\n\t\t\t\t\t       t.alarm);\n\ttimerfd_triggered(ctx);\n\treturn ALARMTIMER_NORESTART;\n}"
  },
  {
    "function_name": "timerfd_tmrproc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "73-79",
    "snippet": "static enum hrtimer_restart timerfd_tmrproc(struct hrtimer *htmr)\n{\n\tstruct timerfd_ctx *ctx = container_of(htmr, struct timerfd_ctx,\n\t\t\t\t\t       t.tmr);\n\ttimerfd_triggered(ctx);\n\treturn HRTIMER_NORESTART;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timerfd_triggered",
          "args": [
            "ctx"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "timerfd_triggered",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
          "lines": "62-71",
          "snippet": "static void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}",
          "includes": [
            "#include <linux/rcupdate.h>",
            "#include <linux/compat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/timerfd.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/hrtimer.h>",
            "#include <linux/time.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/fs.h>",
            "#include <linux/init.h>",
            "#include <linux/poll.h>",
            "#include <linux/file.h>",
            "#include <linux/alarmtimer.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "htmr",
            "structtimerfd_ctx",
            "t.tmr"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic enum hrtimer_restart timerfd_tmrproc(struct hrtimer *htmr)\n{\n\tstruct timerfd_ctx *ctx = container_of(htmr, struct timerfd_ctx,\n\t\t\t\t\t       t.tmr);\n\ttimerfd_triggered(ctx);\n\treturn HRTIMER_NORESTART;\n}"
  },
  {
    "function_name": "timerfd_triggered",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "62-71",
    "snippet": "static void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wake_up_locked_poll",
          "args": [
            "&ctx->wqh",
            "EPOLLIN"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&ctx->wqh.lock",
            "flags"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic void timerfd_triggered(struct timerfd_ctx *ctx)\n{\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&ctx->wqh.lock, flags);\n\tctx->expired = 1;\n\tctx->ticks++;\n\twake_up_locked_poll(&ctx->wqh, EPOLLIN);\n\tspin_unlock_irqrestore(&ctx->wqh.lock, flags);\n}"
  },
  {
    "function_name": "isalarm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "51-55",
    "snippet": "static inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic inline bool isalarm(struct timerfd_ctx *ctx)\n{\n\treturn ctx->clockid == CLOCK_REALTIME_ALARM ||\n\t\tctx->clockid == CLOCK_BOOTTIME_ALARM;\n}"
  },
  {
    "function_name": "timerfd_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "387-433",
    "snippet": "SYSCALL_DEFINE2(timerfd_create, int, clockid, int, flags)\n{\n\tint ufd;\n\tstruct timerfd_ctx *ctx;\n\n\t/* Check the TFD_* constants for consistency.  */\n\tBUILD_BUG_ON(TFD_CLOEXEC != O_CLOEXEC);\n\tBUILD_BUG_ON(TFD_NONBLOCK != O_NONBLOCK);\n\n\tif ((flags & ~TFD_CREATE_FLAGS) ||\n\t    (clockid != CLOCK_MONOTONIC &&\n\t     clockid != CLOCK_REALTIME &&\n\t     clockid != CLOCK_REALTIME_ALARM &&\n\t     clockid != CLOCK_BOOTTIME &&\n\t     clockid != CLOCK_BOOTTIME_ALARM))\n\t\treturn -EINVAL;\n\n\tif ((clockid == CLOCK_REALTIME_ALARM ||\n\t     clockid == CLOCK_BOOTTIME_ALARM) &&\n\t    !capable(CAP_WAKE_ALARM))\n\t\treturn -EPERM;\n\n\tctx = kzalloc(sizeof(*ctx), GFP_KERNEL);\n\tif (!ctx)\n\t\treturn -ENOMEM;\n\n\tinit_waitqueue_head(&ctx->wqh);\n\tspin_lock_init(&ctx->cancel_lock);\n\tctx->clockid = clockid;\n\n\tif (isalarm(ctx))\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\telse\n\t\thrtimer_init(&ctx->t.tmr, clockid, HRTIMER_MODE_ABS);\n\n\tctx->moffs = ktime_mono_to_real(0);\n\n\tufd = anon_inode_getfd(\"[timerfd]\", &timerfd_fops, ctx,\n\t\t\t       O_RDWR | (flags & TFD_SHARED_FCNTL_FLAGS));\n\tif (ufd < 0)\n\t\tkfree(ctx);\n\n\treturn ufd;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(cancel_lock);",
      "static const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nstatic DEFINE_SPINLOCK(cancel_lock);\nstatic const struct file_operations timerfd_fops = {\n\t.release\t= timerfd_release,\n\t.poll\t\t= timerfd_poll,\n\t.read\t\t= timerfd_read,\n\t.llseek\t\t= noop_llseek,\n\t.show_fdinfo\t= timerfd_show,\n\t.unlocked_ioctl\t= timerfd_ioctl,\n};\n\nSYSCALL_DEFINE2(timerfd_create, int, clockid, int, flags)\n{\n\tint ufd;\n\tstruct timerfd_ctx *ctx;\n\n\t/* Check the TFD_* constants for consistency.  */\n\tBUILD_BUG_ON(TFD_CLOEXEC != O_CLOEXEC);\n\tBUILD_BUG_ON(TFD_NONBLOCK != O_NONBLOCK);\n\n\tif ((flags & ~TFD_CREATE_FLAGS) ||\n\t    (clockid != CLOCK_MONOTONIC &&\n\t     clockid != CLOCK_REALTIME &&\n\t     clockid != CLOCK_REALTIME_ALARM &&\n\t     clockid != CLOCK_BOOTTIME &&\n\t     clockid != CLOCK_BOOTTIME_ALARM))\n\t\treturn -EINVAL;\n\n\tif ((clockid == CLOCK_REALTIME_ALARM ||\n\t     clockid == CLOCK_BOOTTIME_ALARM) &&\n\t    !capable(CAP_WAKE_ALARM))\n\t\treturn -EPERM;\n\n\tctx = kzalloc(sizeof(*ctx), GFP_KERNEL);\n\tif (!ctx)\n\t\treturn -ENOMEM;\n\n\tinit_waitqueue_head(&ctx->wqh);\n\tspin_lock_init(&ctx->cancel_lock);\n\tctx->clockid = clockid;\n\n\tif (isalarm(ctx))\n\t\talarm_init(&ctx->t.alarm,\n\t\t\t   ctx->clockid == CLOCK_REALTIME_ALARM ?\n\t\t\t   ALARM_REALTIME : ALARM_BOOTTIME,\n\t\t\t   timerfd_alarmproc);\n\telse\n\t\thrtimer_init(&ctx->t.tmr, clockid, HRTIMER_MODE_ABS);\n\n\tctx->moffs = ktime_mono_to_real(0);\n\n\tufd = anon_inode_getfd(\"[timerfd]\", &timerfd_fops, ctx,\n\t\t\t       O_RDWR | (flags & TFD_SHARED_FCNTL_FLAGS));\n\tif (ufd < 0)\n\t\tkfree(ctx);\n\n\treturn ufd;\n}"
  },
  {
    "function_name": "timerfd_settime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "535-551",
    "snippet": "SYSCALL_DEFINE4(timerfd_settime, int, ufd, int, flags,\n\t\tconst struct __kernel_itimerspec __user *, utmr,\n\t\tstruct __kernel_itimerspec __user *, otmr)\n{\n\tstruct itimerspec64 new, old;\n\tint ret;\n\n\tif (get_itimerspec64(&new, utmr))\n\t\treturn -EFAULT;\n\tret = do_timerfd_settime(ufd, flags, &new, &old);\n\tif (ret)\n\t\treturn ret;\n\tif (otmr && put_itimerspec64(&old, otmr))\n\t\treturn -EFAULT;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nSYSCALL_DEFINE4(timerfd_settime, int, ufd, int, flags,\n\t\tconst struct __kernel_itimerspec __user *, utmr,\n\t\tstruct __kernel_itimerspec __user *, otmr)\n{\n\tstruct itimerspec64 new, old;\n\tint ret;\n\n\tif (get_itimerspec64(&new, utmr))\n\t\treturn -EFAULT;\n\tret = do_timerfd_settime(ufd, flags, &new, &old);\n\tif (ret)\n\t\treturn ret;\n\tif (otmr && put_itimerspec64(&old, otmr))\n\t\treturn -EFAULT;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "timerfd_gettime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "553-560",
    "snippet": "SYSCALL_DEFINE2(timerfd_gettime, int, ufd, struct __kernel_itimerspec __user *, otmr)\n{\n\tstruct itimerspec64 kotmr;\n\tint ret = do_timerfd_gettime(ufd, &kotmr);\n\tif (ret)\n\t\treturn ret;\n\treturn put_itimerspec64(&kotmr, otmr) ? -EFAULT : 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nSYSCALL_DEFINE2(timerfd_gettime, int, ufd, struct __kernel_itimerspec __user *, otmr)\n{\n\tstruct itimerspec64 kotmr;\n\tint ret = do_timerfd_gettime(ufd, &kotmr);\n\tif (ret)\n\t\treturn ret;\n\treturn put_itimerspec64(&kotmr, otmr) ? -EFAULT : 0;\n}"
  },
  {
    "function_name": "timerfd_settime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "563-578",
    "snippet": "SYSCALL_DEFINE4(timerfd_settime, int, ufd, int, flags,\n\t\tconst struct old_itimerspec32 __user *, utmr,\n\t\tstruct old_itimerspec32 __user *, otmr)\n{\n\tstruct itimerspec64 new, old;\n\tint ret;\n\n\tif (get_old_itimerspec32(&new, utmr))\n\t\treturn -EFAULT;\n\tret = do_timerfd_settime(ufd, flags, &new, &old);\n\tif (ret)\n\t\treturn ret;\n\tif (otmr && put_old_itimerspec32(&old, otmr))\n\t\treturn -EFAULT;\n\treturn ret;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nSYSCALL_DEFINE4(timerfd_settime, int, ufd, int, flags,\n\t\tconst struct old_itimerspec32 __user *, utmr,\n\t\tstruct old_itimerspec32 __user *, otmr)\n{\n\tstruct itimerspec64 new, old;\n\tint ret;\n\n\tif (get_old_itimerspec32(&new, utmr))\n\t\treturn -EFAULT;\n\tret = do_timerfd_settime(ufd, flags, &new, &old);\n\tif (ret)\n\t\treturn ret;\n\tif (otmr && put_old_itimerspec32(&old, otmr))\n\t\treturn -EFAULT;\n\treturn ret;\n}"
  },
  {
    "function_name": "timerfd_gettime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/timerfd.c",
    "lines": "580-588",
    "snippet": "SYSCALL_DEFINE2(timerfd_gettime, int, ufd,\n\t\tstruct old_itimerspec32 __user *, otmr)\n{\n\tstruct itimerspec64 kotmr;\n\tint ret = do_timerfd_gettime(ufd, &kotmr);\n\tif (ret)\n\t\treturn ret;\n\treturn put_old_itimerspec32(&kotmr, otmr) ? -EFAULT : 0;\n}",
    "includes": [
      "#include <linux/rcupdate.h>",
      "#include <linux/compat.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/timerfd.h>",
      "#include <linux/anon_inodes.h>",
      "#include <linux/hrtimer.h>",
      "#include <linux/time.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>",
      "#include <linux/slab.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/fs.h>",
      "#include <linux/init.h>",
      "#include <linux/poll.h>",
      "#include <linux/file.h>",
      "#include <linux/alarmtimer.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/rcupdate.h>\n#include <linux/compat.h>\n#include <linux/syscalls.h>\n#include <linux/timerfd.h>\n#include <linux/anon_inodes.h>\n#include <linux/hrtimer.h>\n#include <linux/time.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/fs.h>\n#include <linux/init.h>\n#include <linux/poll.h>\n#include <linux/file.h>\n#include <linux/alarmtimer.h>\n\nSYSCALL_DEFINE2(timerfd_gettime, int, ufd,\n\t\tstruct old_itimerspec32 __user *, otmr)\n{\n\tstruct itimerspec64 kotmr;\n\tint ret = do_timerfd_gettime(ufd, &kotmr);\n\tif (ret)\n\t\treturn ret;\n\treturn put_old_itimerspec32(&kotmr, otmr) ? -EFAULT : 0;\n}"
  }
]