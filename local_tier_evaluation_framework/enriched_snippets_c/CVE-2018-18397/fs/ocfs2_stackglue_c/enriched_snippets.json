[
  {
    "function_name": "ocfs2_stack_glue_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "734-741",
    "snippet": "static void __exit ocfs2_stack_glue_exit(void)\n{\n\tmemset(&locking_max_version, 0,\n\t       sizeof(struct ocfs2_protocol_version));\n\tocfs2_sysfs_exit();\n\tif (ocfs2_table_header)\n\t\tunregister_sysctl_table(ocfs2_table_header);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_protocol_version locking_max_version;",
      "static struct ctl_table_header *ocfs2_table_header;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_sysctl_table",
          "args": [
            "ocfs2_table_header"
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/proc/proc_sysctl.c",
          "lines": "1646-1673",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/cred.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/cred.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_sysfs_exit",
          "args": [],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_sysfs_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "635-638",
          "snippet": "static void ocfs2_sysfs_exit(void)\n{\n\tkset_unregister(ocfs2_kset);\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct kset *ocfs2_kset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstruct kset *ocfs2_kset;\n\nstatic void ocfs2_sysfs_exit(void)\n{\n\tkset_unregister(ocfs2_kset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&locking_max_version",
            "0",
            "sizeof(struct ocfs2_protocol_version)"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_protocol_version locking_max_version;\nstatic struct ctl_table_header *ocfs2_table_header;\n\nstatic void __exit ocfs2_stack_glue_exit(void)\n{\n\tmemset(&locking_max_version, 0,\n\t       sizeof(struct ocfs2_protocol_version));\n\tocfs2_sysfs_exit();\n\tif (ocfs2_table_header)\n\t\tunregister_sysctl_table(ocfs2_table_header);\n}"
  },
  {
    "function_name": "ocfs2_stack_glue_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "720-732",
    "snippet": "static int __init ocfs2_stack_glue_init(void)\n{\n\tstrcpy(cluster_stack_name, OCFS2_STACK_PLUGIN_O2CB);\n\n\tocfs2_table_header = register_sysctl_table(ocfs2_root_table);\n\tif (!ocfs2_table_header) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2 stack glue: unable to register sysctl\\n\");\n\t\treturn -ENOMEM; /* or something. */\n\t}\n\n\treturn ocfs2_sysfs_init();\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [
      "#define OCFS2_STACK_PLUGIN_O2CB\t\t\"o2cb\""
    ],
    "globals_used": [
      "static char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];",
      "static struct ctl_table ocfs2_root_table[] = {\n\t{\n\t\t.procname\t= \"fs\",\n\t\t.data\t\t= NULL,\n\t\t.maxlen\t\t= 0,\n\t\t.mode\t\t= 0555,\n\t\t.child\t\t= ocfs2_kern_table\n\t},\n\t{ }\n};",
      "static struct ctl_table_header *ocfs2_table_header;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_sysfs_init",
          "args": [],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_sysfs_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "640-657",
          "snippet": "static int ocfs2_sysfs_init(void)\n{\n\tint ret;\n\n\tocfs2_kset = kset_create_and_add(\"ocfs2\", NULL, fs_kobj);\n\tif (!ocfs2_kset)\n\t\treturn -ENOMEM;\n\n\tret = sysfs_create_group(&ocfs2_kset->kobj, &ocfs2_attr_group);\n\tif (ret)\n\t\tgoto error;\n\n\treturn 0;\n\nerror:\n\tkset_unregister(ocfs2_kset);\n\treturn ret;\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct attribute_group ocfs2_attr_group = {\n\t.attrs = ocfs2_attrs,\n};",
            "struct kset *ocfs2_kset;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic const struct attribute_group ocfs2_attr_group = {\n\t.attrs = ocfs2_attrs,\n};\nstruct kset *ocfs2_kset;\n\nstatic int ocfs2_sysfs_init(void)\n{\n\tint ret;\n\n\tocfs2_kset = kset_create_and_add(\"ocfs2\", NULL, fs_kobj);\n\tif (!ocfs2_kset)\n\t\treturn -ENOMEM;\n\n\tret = sysfs_create_group(&ocfs2_kset->kobj, &ocfs2_attr_group);\n\tif (ret)\n\t\tgoto error;\n\n\treturn 0;\n\nerror:\n\tkset_unregister(ocfs2_kset);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR\n\t\t       \"ocfs2 stack glue: unable to register sysctl\\n\""
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/reiserfs/prints.c",
          "lines": "310-314",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "register_sysctl_table",
          "args": [
            "ocfs2_root_table"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_sysctl_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/proc/proc_sysctl.c",
          "lines": "1646-1673",
          "snippet": "void unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/namei.h>",
            "#include <linux/cred.h>",
            "#include <linux/sched.h>",
            "#include <linux/security.h>",
            "#include <linux/printk.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/poll.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(sysctl_lock);",
            "static void drop_sysctl_table(struct ctl_table_header *header);",
            "static void put_links(struct ctl_table_header *header);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/namei.h>\n#include <linux/cred.h>\n#include <linux/sched.h>\n#include <linux/security.h>\n#include <linux/printk.h>\n#include <linux/proc_fs.h>\n#include <linux/poll.h>\n#include <linux/sysctl.h>\n#include <linux/init.h>\n\nstatic DEFINE_SPINLOCK(sysctl_lock);\nstatic void drop_sysctl_table(struct ctl_table_header *header);\nstatic void put_links(struct ctl_table_header *header);\n\nvoid unregister_sysctl_table(struct ctl_table_header * header)\n{\n\tint nr_subheaders;\n\tmight_sleep();\n\n\tif (header == NULL)\n\t\treturn;\n\n\tnr_subheaders = count_subheaders(header->ctl_table_arg);\n\tif (unlikely(nr_subheaders > 1)) {\n\t\tstruct ctl_table_header **subheaders;\n\t\tint i;\n\n\t\tsubheaders = (struct ctl_table_header **)(header + 1);\n\t\tfor (i = nr_subheaders -1; i >= 0; i--) {\n\t\t\tstruct ctl_table_header *subh = subheaders[i];\n\t\t\tstruct ctl_table *table = subh->ctl_table_arg;\n\t\t\tunregister_sysctl_table(subh);\n\t\t\tkfree(table);\n\t\t}\n\t\tkfree(header);\n\t\treturn;\n\t}\n\n\tspin_lock(&sysctl_lock);\n\tdrop_sysctl_table(header);\n\tspin_unlock(&sysctl_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "cluster_stack_name",
            "OCFS2_STACK_PLUGIN_O2CB"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\n#define OCFS2_STACK_PLUGIN_O2CB\t\t\"o2cb\"\n\nstatic char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];\nstatic struct ctl_table ocfs2_root_table[] = {\n\t{\n\t\t.procname\t= \"fs\",\n\t\t.data\t\t= NULL,\n\t\t.maxlen\t\t= 0,\n\t\t.mode\t\t= 0555,\n\t\t.child\t\t= ocfs2_kern_table\n\t},\n\t{ }\n};\nstatic struct ctl_table_header *ocfs2_table_header;\n\nstatic int __init ocfs2_stack_glue_init(void)\n{\n\tstrcpy(cluster_stack_name, OCFS2_STACK_PLUGIN_O2CB);\n\n\tocfs2_table_header = register_sysctl_table(ocfs2_root_table);\n\tif (!ocfs2_table_header) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2 stack glue: unable to register sysctl\\n\");\n\t\treturn -ENOMEM; /* or something. */\n\t}\n\n\treturn ocfs2_sysfs_init();\n}"
  },
  {
    "function_name": "ocfs2_sysfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "640-657",
    "snippet": "static int ocfs2_sysfs_init(void)\n{\n\tint ret;\n\n\tocfs2_kset = kset_create_and_add(\"ocfs2\", NULL, fs_kobj);\n\tif (!ocfs2_kset)\n\t\treturn -ENOMEM;\n\n\tret = sysfs_create_group(&ocfs2_kset->kobj, &ocfs2_attr_group);\n\tif (ret)\n\t\tgoto error;\n\n\treturn 0;\n\nerror:\n\tkset_unregister(ocfs2_kset);\n\treturn ret;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const struct attribute_group ocfs2_attr_group = {\n\t.attrs = ocfs2_attrs,\n};",
      "struct kset *ocfs2_kset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "ocfs2_kset"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_create_group",
          "args": [
            "&ocfs2_kset->kobj",
            "&ocfs2_attr_group"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "sysfs_create_groups",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/sysfs/group.c",
          "lines": "190-208",
          "snippet": "int sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"sysfs.h\"",
            "#include <linux/err.h>",
            "#include <linux/namei.h>",
            "#include <linux/dcache.h>",
            "#include <linux/module.h>",
            "#include <linux/kobject.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"sysfs.h\"\n#include <linux/err.h>\n#include <linux/namei.h>\n#include <linux/dcache.h>\n#include <linux/module.h>\n#include <linux/kobject.h>\n\nint sysfs_create_groups(struct kobject *kobj,\n\t\t\tconst struct attribute_group **groups)\n{\n\tint error = 0;\n\tint i;\n\n\tif (!groups)\n\t\treturn 0;\n\n\tfor (i = 0; groups[i]; i++) {\n\t\terror = sysfs_create_group(kobj, groups[i]);\n\t\tif (error) {\n\t\t\twhile (--i >= 0)\n\t\t\t\tsysfs_remove_group(kobj, groups[i]);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kset_create_and_add",
          "args": [
            "\"ocfs2\"",
            "NULL",
            "fs_kobj"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic const struct attribute_group ocfs2_attr_group = {\n\t.attrs = ocfs2_attrs,\n};\nstruct kset *ocfs2_kset;\n\nstatic int ocfs2_sysfs_init(void)\n{\n\tint ret;\n\n\tocfs2_kset = kset_create_and_add(\"ocfs2\", NULL, fs_kobj);\n\tif (!ocfs2_kset)\n\t\treturn -ENOMEM;\n\n\tret = sysfs_create_group(&ocfs2_kset->kobj, &ocfs2_attr_group);\n\tif (ret)\n\t\tgoto error;\n\n\treturn 0;\n\nerror:\n\tkset_unregister(ocfs2_kset);\n\treturn ret;\n}"
  },
  {
    "function_name": "ocfs2_sysfs_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "635-638",
    "snippet": "static void ocfs2_sysfs_exit(void)\n{\n\tkset_unregister(ocfs2_kset);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct kset *ocfs2_kset;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kset_unregister",
          "args": [
            "ocfs2_kset"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstruct kset *ocfs2_kset;\n\nstatic void ocfs2_sysfs_exit(void)\n{\n\tkset_unregister(ocfs2_kset);\n}"
  },
  {
    "function_name": "ocfs2_dlm_recover_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "608-613",
    "snippet": "static ssize_t ocfs2_dlm_recover_show(struct kobject *kobj,\n\t\t\t\t\tstruct kobj_attribute *attr,\n\t\t\t\t\tchar *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"1\\n\");\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"1\\n\""
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic ssize_t ocfs2_dlm_recover_show(struct kobject *kobj,\n\t\t\t\t\tstruct kobj_attribute *attr,\n\t\t\t\t\tchar *buf)\n{\n\treturn snprintf(buf, PAGE_SIZE, \"1\\n\");\n}"
  },
  {
    "function_name": "ocfs2_cluster_stack_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "568-598",
    "snippet": "static ssize_t ocfs2_cluster_stack_store(struct kobject *kobj,\n\t\t\t\t\t struct kobj_attribute *attr,\n\t\t\t\t\t const char *buf, size_t count)\n{\n\tsize_t len = count;\n\tssize_t ret;\n\n\tif (len == 0)\n\t\treturn len;\n\n\tif (buf[len - 1] == '\\n')\n\t\tlen--;\n\n\tif ((len != OCFS2_STACK_LABEL_LEN) ||\n\t    (strnlen(buf, len) != len))\n\t\treturn -EINVAL;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (active_stack) {\n\t\tif (!strncmp(buf, cluster_stack_name, len))\n\t\t\tret = count;\n\t\telse\n\t\t\tret = -EBUSY;\n\t} else {\n\t\tmemcpy(cluster_stack_name, buf, len);\n\t\tret = count;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];",
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "cluster_stack_name",
            "buf",
            "len"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "buf",
            "cluster_stack_name",
            "len"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strnlen",
          "args": [
            "buf",
            "len"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];\nstatic struct ocfs2_stack_plugin *active_stack;\n\nstatic ssize_t ocfs2_cluster_stack_store(struct kobject *kobj,\n\t\t\t\t\t struct kobj_attribute *attr,\n\t\t\t\t\t const char *buf, size_t count)\n{\n\tsize_t len = count;\n\tssize_t ret;\n\n\tif (len == 0)\n\t\treturn len;\n\n\tif (buf[len - 1] == '\\n')\n\t\tlen--;\n\n\tif ((len != OCFS2_STACK_LABEL_LEN) ||\n\t    (strnlen(buf, len) != len))\n\t\treturn -EINVAL;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (active_stack) {\n\t\tif (!strncmp(buf, cluster_stack_name, len))\n\t\t\tret = count;\n\t\telse\n\t\t\tret = -EBUSY;\n\t} else {\n\t\tmemcpy(cluster_stack_name, buf, len);\n\t\tret = count;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ocfs2_cluster_stack_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "556-566",
    "snippet": "static ssize_t ocfs2_cluster_stack_show(struct kobject *kobj,\n\t\t\t\t\tstruct kobj_attribute *attr,\n\t\t\t\t\tchar *buf)\n{\n\tssize_t ret;\n\tspin_lock(&ocfs2_stack_lock);\n\tret = snprintf(buf, PAGE_SIZE, \"%s\\n\", cluster_stack_name);\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%s\\n\"",
            "cluster_stack_name"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "dbg_snprintf_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ubifs/debug.c",
          "lines": "102-139",
          "snippet": "const char *dbg_snprintf_key(const struct ubifs_info *c,\n\t\t\t     const union ubifs_key *key, char *buffer, int len)\n{\n\tchar *p = buffer;\n\tint type = key_type(c, key);\n\n\tif (c->key_fmt == UBIFS_SIMPLE_KEY_FMT) {\n\t\tswitch (type) {\n\t\tcase UBIFS_INO_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tcase UBIFS_DENT_KEY:\n\t\tcase UBIFS_XENT_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %#08x)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_hash(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_DATA_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %u)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_block(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_TRUN_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlen -= snprintf(p, len, \"(bad key type: %#08x, %#08x)\",\n\t\t\t\t\tkey->u32[0], key->u32[1]);\n\t\t}\n\t} else\n\t\tlen -= snprintf(p, len, \"bad key format %d\", c->key_fmt);\n\tubifs_assert(c, len > 0);\n\treturn p;\n}",
          "includes": [
            "#include \"ubifs.h\"",
            "#include <linux/ctype.h>",
            "#include <linux/random.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/math64.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ubifs.h\"\n#include <linux/ctype.h>\n#include <linux/random.h>\n#include <linux/uaccess.h>\n#include <linux/math64.h>\n#include <linux/debugfs.h>\n#include <linux/module.h>\n\nconst char *dbg_snprintf_key(const struct ubifs_info *c,\n\t\t\t     const union ubifs_key *key, char *buffer, int len)\n{\n\tchar *p = buffer;\n\tint type = key_type(c, key);\n\n\tif (c->key_fmt == UBIFS_SIMPLE_KEY_FMT) {\n\t\tswitch (type) {\n\t\tcase UBIFS_INO_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tcase UBIFS_DENT_KEY:\n\t\tcase UBIFS_XENT_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %#08x)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_hash(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_DATA_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %u)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_block(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_TRUN_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlen -= snprintf(p, len, \"(bad key type: %#08x, %#08x)\",\n\t\t\t\t\tkey->u32[0], key->u32[1]);\n\t\t}\n\t} else\n\t\tlen -= snprintf(p, len, \"bad key format %d\", c->key_fmt);\n\tubifs_assert(c, len > 0);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];\n\nstatic ssize_t ocfs2_cluster_stack_show(struct kobject *kobj,\n\t\t\t\t\tstruct kobj_attribute *attr,\n\t\t\t\t\tchar *buf)\n{\n\tssize_t ret;\n\tspin_lock(&ocfs2_stack_lock);\n\tret = snprintf(buf, PAGE_SIZE, \"%s\\n\", cluster_stack_name);\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ocfs2_active_cluster_plugin_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "534-550",
    "snippet": "static ssize_t ocfs2_active_cluster_plugin_show(struct kobject *kobj,\n\t\t\t\t\t\tstruct kobj_attribute *attr,\n\t\t\t\t\t\tchar *buf)\n{\n\tssize_t ret = 0;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (active_stack) {\n\t\tret = snprintf(buf, PAGE_SIZE, \"%s\\n\",\n\t\t\t       active_stack->sp_name);\n\t\tif (ret == PAGE_SIZE)\n\t\t\tret = -E2BIG;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%s\\n\"",
            "active_stack->sp_name"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "dbg_snprintf_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ubifs/debug.c",
          "lines": "102-139",
          "snippet": "const char *dbg_snprintf_key(const struct ubifs_info *c,\n\t\t\t     const union ubifs_key *key, char *buffer, int len)\n{\n\tchar *p = buffer;\n\tint type = key_type(c, key);\n\n\tif (c->key_fmt == UBIFS_SIMPLE_KEY_FMT) {\n\t\tswitch (type) {\n\t\tcase UBIFS_INO_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tcase UBIFS_DENT_KEY:\n\t\tcase UBIFS_XENT_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %#08x)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_hash(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_DATA_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %u)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_block(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_TRUN_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlen -= snprintf(p, len, \"(bad key type: %#08x, %#08x)\",\n\t\t\t\t\tkey->u32[0], key->u32[1]);\n\t\t}\n\t} else\n\t\tlen -= snprintf(p, len, \"bad key format %d\", c->key_fmt);\n\tubifs_assert(c, len > 0);\n\treturn p;\n}",
          "includes": [
            "#include \"ubifs.h\"",
            "#include <linux/ctype.h>",
            "#include <linux/random.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/math64.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ubifs.h\"\n#include <linux/ctype.h>\n#include <linux/random.h>\n#include <linux/uaccess.h>\n#include <linux/math64.h>\n#include <linux/debugfs.h>\n#include <linux/module.h>\n\nconst char *dbg_snprintf_key(const struct ubifs_info *c,\n\t\t\t     const union ubifs_key *key, char *buffer, int len)\n{\n\tchar *p = buffer;\n\tint type = key_type(c, key);\n\n\tif (c->key_fmt == UBIFS_SIMPLE_KEY_FMT) {\n\t\tswitch (type) {\n\t\tcase UBIFS_INO_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tcase UBIFS_DENT_KEY:\n\t\tcase UBIFS_XENT_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %#08x)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_hash(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_DATA_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %u)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_block(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_TRUN_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlen -= snprintf(p, len, \"(bad key type: %#08x, %#08x)\",\n\t\t\t\t\tkey->u32[0], key->u32[1]);\n\t\t}\n\t} else\n\t\tlen -= snprintf(p, len, \"bad key format %d\", c->key_fmt);\n\tubifs_assert(c, len > 0);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic struct ocfs2_stack_plugin *active_stack;\n\nstatic ssize_t ocfs2_active_cluster_plugin_show(struct kobject *kobj,\n\t\t\t\t\t\tstruct kobj_attribute *attr,\n\t\t\t\t\t\tchar *buf)\n{\n\tssize_t ret = 0;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (active_stack) {\n\t\tret = snprintf(buf, PAGE_SIZE, \"%s\\n\",\n\t\t\t       active_stack->sp_name);\n\t\tif (ret == PAGE_SIZE)\n\t\t\tret = -E2BIG;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ocfs2_loaded_cluster_plugins_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "502-528",
    "snippet": "static ssize_t ocfs2_loaded_cluster_plugins_show(struct kobject *kobj,\n\t\t\t\t\t\t struct kobj_attribute *attr,\n\t\t\t\t\t\t char *buf)\n{\n\tssize_t ret = 0, total = 0, remain = PAGE_SIZE;\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tret = snprintf(buf, remain, \"%s\\n\",\n\t\t\t       p->sp_name);\n\t\tif (ret < 0) {\n\t\t\ttotal = ret;\n\t\t\tbreak;\n\t\t}\n\t\tif (ret == remain) {\n\t\t\t/* snprintf() didn't fit */\n\t\t\ttotal = -E2BIG;\n\t\t\tbreak;\n\t\t}\n\t\ttotal += ret;\n\t\tremain -= ret;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn total;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static LIST_HEAD(ocfs2_stack_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "remain",
            "\"%s\\n\"",
            "p->sp_name"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "dbg_snprintf_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ubifs/debug.c",
          "lines": "102-139",
          "snippet": "const char *dbg_snprintf_key(const struct ubifs_info *c,\n\t\t\t     const union ubifs_key *key, char *buffer, int len)\n{\n\tchar *p = buffer;\n\tint type = key_type(c, key);\n\n\tif (c->key_fmt == UBIFS_SIMPLE_KEY_FMT) {\n\t\tswitch (type) {\n\t\tcase UBIFS_INO_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tcase UBIFS_DENT_KEY:\n\t\tcase UBIFS_XENT_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %#08x)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_hash(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_DATA_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %u)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_block(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_TRUN_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlen -= snprintf(p, len, \"(bad key type: %#08x, %#08x)\",\n\t\t\t\t\tkey->u32[0], key->u32[1]);\n\t\t}\n\t} else\n\t\tlen -= snprintf(p, len, \"bad key format %d\", c->key_fmt);\n\tubifs_assert(c, len > 0);\n\treturn p;\n}",
          "includes": [
            "#include \"ubifs.h\"",
            "#include <linux/ctype.h>",
            "#include <linux/random.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/math64.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ubifs.h\"\n#include <linux/ctype.h>\n#include <linux/random.h>\n#include <linux/uaccess.h>\n#include <linux/math64.h>\n#include <linux/debugfs.h>\n#include <linux/module.h>\n\nconst char *dbg_snprintf_key(const struct ubifs_info *c,\n\t\t\t     const union ubifs_key *key, char *buffer, int len)\n{\n\tchar *p = buffer;\n\tint type = key_type(c, key);\n\n\tif (c->key_fmt == UBIFS_SIMPLE_KEY_FMT) {\n\t\tswitch (type) {\n\t\tcase UBIFS_INO_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tcase UBIFS_DENT_KEY:\n\t\tcase UBIFS_XENT_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %#08x)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_hash(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_DATA_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s, %u)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type), key_block(c, key));\n\t\t\tbreak;\n\t\tcase UBIFS_TRUN_KEY:\n\t\t\tlen -= snprintf(p, len, \"(%lu, %s)\",\n\t\t\t\t\t(unsigned long)key_inum(c, key),\n\t\t\t\t\tget_key_type(type));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tlen -= snprintf(p, len, \"(bad key type: %#08x, %#08x)\",\n\t\t\t\t\tkey->u32[0], key->u32[1]);\n\t\t}\n\t} else\n\t\tlen -= snprintf(p, len, \"bad key format %d\", c->key_fmt);\n\tubifs_assert(c, len > 0);\n\treturn p;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "p",
            "&ocfs2_stack_list",
            "sp_list"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic LIST_HEAD(ocfs2_stack_list);\n\nstatic ssize_t ocfs2_loaded_cluster_plugins_show(struct kobject *kobj,\n\t\t\t\t\t\t struct kobj_attribute *attr,\n\t\t\t\t\t\t char *buf)\n{\n\tssize_t ret = 0, total = 0, remain = PAGE_SIZE;\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tret = snprintf(buf, remain, \"%s\\n\",\n\t\t\t       p->sp_name);\n\t\tif (ret < 0) {\n\t\t\ttotal = ret;\n\t\t\tbreak;\n\t\t}\n\t\tif (ret == remain) {\n\t\t\t/* snprintf() didn't fit */\n\t\t\ttotal = -E2BIG;\n\t\t\tbreak;\n\t\t}\n\t\ttotal += ret;\n\t\tremain -= ret;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn total;\n}"
  },
  {
    "function_name": "ocfs2_max_locking_protocol_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "482-496",
    "snippet": "static ssize_t ocfs2_max_locking_protocol_show(struct kobject *kobj,\n\t\t\t\t\t       struct kobj_attribute *attr,\n\t\t\t\t\t       char *buf)\n{\n\tssize_t ret = 0;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (locking_max_version.pv_major)\n\t\tret = snprintf(buf, PAGE_SIZE, \"%u.%u\\n\",\n\t\t\t       locking_max_version.pv_major,\n\t\t\t       locking_max_version.pv_minor);\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_protocol_version locking_max_version;",
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "PAGE_SIZE",
            "\"%u.%u\\n\"",
            "locking_max_version.pv_major",
            "locking_max_version.pv_minor"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_protocol_version locking_max_version;\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\n\nstatic ssize_t ocfs2_max_locking_protocol_show(struct kobject *kobj,\n\t\t\t\t\t       struct kobj_attribute *attr,\n\t\t\t\t\t       char *buf)\n{\n\tssize_t ret = 0;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (locking_max_version.pv_major)\n\t\tret = snprintf(buf, PAGE_SIZE, \"%u.%u\\n\",\n\t\t\t       locking_max_version.pv_major,\n\t\t\t       locking_max_version.pv_minor);\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ocfs2_cluster_this_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "470-474",
    "snippet": "int ocfs2_cluster_this_node(struct ocfs2_cluster_connection *conn,\n\t\t\t    unsigned int *node)\n{\n\treturn active_stack->sp_ops->this_node(conn, node);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "active_stack->sp_ops->this_node",
          "args": [
            "conn",
            "node"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_cluster_this_node(struct ocfs2_cluster_connection *conn,\n\t\t\t    unsigned int *node)\n{\n\treturn active_stack->sp_ops->this_node(conn, node);\n}"
  },
  {
    "function_name": "ocfs2_cluster_hangup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "458-467",
    "snippet": "void ocfs2_cluster_hangup(const char *group, int grouplen)\n{\n\tBUG_ON(group == NULL);\n\tBUG_ON(group[grouplen] != '\\0');\n\n\tocfs2_leave_group(group);\n\n\t/* cluster_disconnect() was called with hangup_pending==1 */\n\tocfs2_stack_driver_put();\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_stack_driver_put",
          "args": [],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_stack_driver_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "158-170",
          "snippet": "static void ocfs2_stack_driver_put(void)\n{\n\tspin_lock(&ocfs2_stack_lock);\n\tBUG_ON(active_stack == NULL);\n\tBUG_ON(active_stack->sp_count == 0);\n\n\tactive_stack->sp_count--;\n\tif (!active_stack->sp_count) {\n\t\tmodule_put(active_stack->sp_owner);\n\t\tactive_stack = NULL;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
            "static struct ocfs2_stack_plugin *active_stack;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic struct ocfs2_stack_plugin *active_stack;\n\nstatic void ocfs2_stack_driver_put(void)\n{\n\tspin_lock(&ocfs2_stack_lock);\n\tBUG_ON(active_stack == NULL);\n\tBUG_ON(active_stack->sp_count == 0);\n\n\tactive_stack->sp_count--;\n\tif (!active_stack->sp_count) {\n\t\tmodule_put(active_stack->sp_owner);\n\t\tactive_stack = NULL;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_leave_group",
          "args": [
            "group"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_leave_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "426-449",
          "snippet": "static void ocfs2_leave_group(const char *group)\n{\n\tint ret;\n\tchar *argv[5], *envp[3];\n\n\targv[0] = ocfs2_hb_ctl_path;\n\targv[1] = \"-K\";\n\targv[2] = \"-u\";\n\targv[3] = (char *)group;\n\targv[4] = NULL;\n\n\t/* minimal command environment taken from cpu_run_sbin_hotplug */\n\tenvp[0] = \"HOME=/\";\n\tenvp[1] = \"PATH=/sbin:/bin:/usr/sbin:/usr/bin\";\n\tenvp[2] = NULL;\n\n\tret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_PROC);\n\tif (ret < 0) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: Error %d running user helper \"\n\t\t       \"\\\"%s %s %s %s\\\"\\n\",\n\t\t       ret, argv[0], argv[1], argv[2], argv[3]);\n\t}\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char ocfs2_hb_ctl_path[OCFS2_MAX_HB_CTL_PATH] = \"/sbin/ocfs2_hb_ctl\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic char ocfs2_hb_ctl_path[OCFS2_MAX_HB_CTL_PATH] = \"/sbin/ocfs2_hb_ctl\";\n\nstatic void ocfs2_leave_group(const char *group)\n{\n\tint ret;\n\tchar *argv[5], *envp[3];\n\n\targv[0] = ocfs2_hb_ctl_path;\n\targv[1] = \"-K\";\n\targv[2] = \"-u\";\n\targv[3] = (char *)group;\n\targv[4] = NULL;\n\n\t/* minimal command environment taken from cpu_run_sbin_hotplug */\n\tenvp[0] = \"HOME=/\";\n\tenvp[1] = \"PATH=/sbin:/bin:/usr/sbin:/usr/bin\";\n\tenvp[2] = NULL;\n\n\tret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_PROC);\n\tif (ret < 0) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: Error %d running user helper \"\n\t\t       \"\\\"%s %s %s %s\\\"\\n\",\n\t\t       ret, argv[0], argv[1], argv[2], argv[3]);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "group[grouplen] != '\\0'"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "group == NULL"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nvoid ocfs2_cluster_hangup(const char *group, int grouplen)\n{\n\tBUG_ON(group == NULL);\n\tBUG_ON(group[grouplen] != '\\0');\n\n\tocfs2_leave_group(group);\n\n\t/* cluster_disconnect() was called with hangup_pending==1 */\n\tocfs2_stack_driver_put();\n}"
  },
  {
    "function_name": "ocfs2_leave_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "426-449",
    "snippet": "static void ocfs2_leave_group(const char *group)\n{\n\tint ret;\n\tchar *argv[5], *envp[3];\n\n\targv[0] = ocfs2_hb_ctl_path;\n\targv[1] = \"-K\";\n\targv[2] = \"-u\";\n\targv[3] = (char *)group;\n\targv[4] = NULL;\n\n\t/* minimal command environment taken from cpu_run_sbin_hotplug */\n\tenvp[0] = \"HOME=/\";\n\tenvp[1] = \"PATH=/sbin:/bin:/usr/sbin:/usr/bin\";\n\tenvp[2] = NULL;\n\n\tret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_PROC);\n\tif (ret < 0) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: Error %d running user helper \"\n\t\t       \"\\\"%s %s %s %s\\\"\\n\",\n\t\t       ret, argv[0], argv[1], argv[2], argv[3]);\n\t}\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char ocfs2_hb_ctl_path[OCFS2_MAX_HB_CTL_PATH] = \"/sbin/ocfs2_hb_ctl\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR\n\t\t       \"ocfs2: Error %d running user helper \"\n\t\t       \"\\\"%s %s %s %s\\\"\\n\"",
            "ret",
            "argv[0]",
            "argv[1]",
            "argv[2]",
            "argv[3]"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/reiserfs/prints.c",
          "lines": "310-314",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_usermodehelper",
          "args": [
            "argv[0]",
            "argv",
            "envp",
            "UMH_WAIT_PROC"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic char ocfs2_hb_ctl_path[OCFS2_MAX_HB_CTL_PATH] = \"/sbin/ocfs2_hb_ctl\";\n\nstatic void ocfs2_leave_group(const char *group)\n{\n\tint ret;\n\tchar *argv[5], *envp[3];\n\n\targv[0] = ocfs2_hb_ctl_path;\n\targv[1] = \"-K\";\n\targv[2] = \"-u\";\n\targv[3] = (char *)group;\n\targv[4] = NULL;\n\n\t/* minimal command environment taken from cpu_run_sbin_hotplug */\n\tenvp[0] = \"HOME=/\";\n\tenvp[1] = \"PATH=/sbin:/bin:/usr/sbin:/usr/bin\";\n\tenvp[2] = NULL;\n\n\tret = call_usermodehelper(argv[0], argv, envp, UMH_WAIT_PROC);\n\tif (ret < 0) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: Error %d running user helper \"\n\t\t       \"\\\"%s %s %s %s\\\"\\n\",\n\t\t       ret, argv[0], argv[1], argv[2], argv[3]);\n\t}\n}"
  },
  {
    "function_name": "ocfs2_cluster_disconnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "402-419",
    "snippet": "int ocfs2_cluster_disconnect(struct ocfs2_cluster_connection *conn,\n\t\t\t     int hangup_pending)\n{\n\tint ret;\n\n\tBUG_ON(conn == NULL);\n\n\tret = active_stack->sp_ops->disconnect(conn);\n\n\t/* XXX Should we free it anyway? */\n\tif (!ret) {\n\t\tkfree(conn);\n\t\tif (!hangup_pending)\n\t\t\tocfs2_stack_driver_put();\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_stack_driver_put",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_stack_driver_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "158-170",
          "snippet": "static void ocfs2_stack_driver_put(void)\n{\n\tspin_lock(&ocfs2_stack_lock);\n\tBUG_ON(active_stack == NULL);\n\tBUG_ON(active_stack->sp_count == 0);\n\n\tactive_stack->sp_count--;\n\tif (!active_stack->sp_count) {\n\t\tmodule_put(active_stack->sp_owner);\n\t\tactive_stack = NULL;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
            "static struct ocfs2_stack_plugin *active_stack;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic struct ocfs2_stack_plugin *active_stack;\n\nstatic void ocfs2_stack_driver_put(void)\n{\n\tspin_lock(&ocfs2_stack_lock);\n\tBUG_ON(active_stack == NULL);\n\tBUG_ON(active_stack->sp_count == 0);\n\n\tactive_stack->sp_count--;\n\tif (!active_stack->sp_count) {\n\t\tmodule_put(active_stack->sp_owner);\n\t\tactive_stack = NULL;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "conn"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "active_stack->sp_ops->disconnect",
          "args": [
            "conn"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "conn == NULL"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_cluster_disconnect(struct ocfs2_cluster_connection *conn,\n\t\t\t     int hangup_pending)\n{\n\tint ret;\n\n\tBUG_ON(conn == NULL);\n\n\tret = active_stack->sp_ops->disconnect(conn);\n\n\t/* XXX Should we free it anyway? */\n\tif (!ret) {\n\t\tkfree(conn);\n\t\tif (!hangup_pending)\n\t\t\tocfs2_stack_driver_put();\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "ocfs2_cluster_connect_agnostic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "383-398",
    "snippet": "int ocfs2_cluster_connect_agnostic(const char *group,\n\t\t\t\t   int grouplen,\n\t\t\t\t   struct ocfs2_locking_protocol *lproto,\n\t\t\t\t   void (*recovery_handler)(int node_num,\n\t\t\t\t\t\t\t    void *recovery_data),\n\t\t\t\t   void *recovery_data,\n\t\t\t\t   struct ocfs2_cluster_connection **conn)\n{\n\tchar *stack_name = NULL;\n\n\tif (cluster_stack_name[0])\n\t\tstack_name = cluster_stack_name;\n\treturn ocfs2_cluster_connect(stack_name, NULL, 0, group, grouplen,\n\t\t\t\t     lproto, recovery_handler, recovery_data,\n\t\t\t\t     conn);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocfs2_cluster_connect",
          "args": [
            "stack_name",
            "NULL",
            "0",
            "group",
            "grouplen",
            "lproto",
            "recovery_handler",
            "recovery_data",
            "conn"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_cluster_connect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "311-379",
          "snippet": "int ocfs2_cluster_connect(const char *stack_name,\n\t\t\t  const char *cluster_name,\n\t\t\t  int cluster_name_len,\n\t\t\t  const char *group,\n\t\t\t  int grouplen,\n\t\t\t  struct ocfs2_locking_protocol *lproto,\n\t\t\t  void (*recovery_handler)(int node_num,\n\t\t\t\t\t\t   void *recovery_data),\n\t\t\t  void *recovery_data,\n\t\t\t  struct ocfs2_cluster_connection **conn)\n{\n\tint rc = 0;\n\tstruct ocfs2_cluster_connection *new_conn;\n\n\tBUG_ON(group == NULL);\n\tBUG_ON(conn == NULL);\n\tBUG_ON(recovery_handler == NULL);\n\n\tif (grouplen > GROUP_NAME_MAX) {\n\t\trc = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tif (memcmp(&lproto->lp_max_version, &locking_max_version,\n\t\t   sizeof(struct ocfs2_protocol_version))) {\n\t\trc = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tnew_conn = kzalloc(sizeof(struct ocfs2_cluster_connection),\n\t\t\t   GFP_KERNEL);\n\tif (!new_conn) {\n\t\trc = -ENOMEM;\n\t\tgoto out;\n\t}\n\n\tstrlcpy(new_conn->cc_name, group, GROUP_NAME_MAX + 1);\n\tnew_conn->cc_namelen = grouplen;\n\tif (cluster_name_len)\n\t\tstrlcpy(new_conn->cc_cluster_name, cluster_name,\n\t\t\tCLUSTER_NAME_MAX + 1);\n\tnew_conn->cc_cluster_name_len = cluster_name_len;\n\tnew_conn->cc_recovery_handler = recovery_handler;\n\tnew_conn->cc_recovery_data = recovery_data;\n\n\tnew_conn->cc_proto = lproto;\n\t/* Start the new connection at our maximum compatibility level */\n\tnew_conn->cc_version = lproto->lp_max_version;\n\n\t/* This will pin the stack driver if successful */\n\trc = ocfs2_stack_driver_get(stack_name);\n\tif (rc)\n\t\tgoto out_free;\n\n\trc = active_stack->sp_ops->connect(new_conn);\n\tif (rc) {\n\t\tocfs2_stack_driver_put();\n\t\tgoto out_free;\n\t}\n\n\t*conn = new_conn;\n\nout_free:\n\tif (rc)\n\t\tkfree(new_conn);\n\nout:\n\treturn rc;\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ocfs2_protocol_version locking_max_version;",
            "static struct ocfs2_stack_plugin *active_stack;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_protocol_version locking_max_version;\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_cluster_connect(const char *stack_name,\n\t\t\t  const char *cluster_name,\n\t\t\t  int cluster_name_len,\n\t\t\t  const char *group,\n\t\t\t  int grouplen,\n\t\t\t  struct ocfs2_locking_protocol *lproto,\n\t\t\t  void (*recovery_handler)(int node_num,\n\t\t\t\t\t\t   void *recovery_data),\n\t\t\t  void *recovery_data,\n\t\t\t  struct ocfs2_cluster_connection **conn)\n{\n\tint rc = 0;\n\tstruct ocfs2_cluster_connection *new_conn;\n\n\tBUG_ON(group == NULL);\n\tBUG_ON(conn == NULL);\n\tBUG_ON(recovery_handler == NULL);\n\n\tif (grouplen > GROUP_NAME_MAX) {\n\t\trc = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tif (memcmp(&lproto->lp_max_version, &locking_max_version,\n\t\t   sizeof(struct ocfs2_protocol_version))) {\n\t\trc = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tnew_conn = kzalloc(sizeof(struct ocfs2_cluster_connection),\n\t\t\t   GFP_KERNEL);\n\tif (!new_conn) {\n\t\trc = -ENOMEM;\n\t\tgoto out;\n\t}\n\n\tstrlcpy(new_conn->cc_name, group, GROUP_NAME_MAX + 1);\n\tnew_conn->cc_namelen = grouplen;\n\tif (cluster_name_len)\n\t\tstrlcpy(new_conn->cc_cluster_name, cluster_name,\n\t\t\tCLUSTER_NAME_MAX + 1);\n\tnew_conn->cc_cluster_name_len = cluster_name_len;\n\tnew_conn->cc_recovery_handler = recovery_handler;\n\tnew_conn->cc_recovery_data = recovery_data;\n\n\tnew_conn->cc_proto = lproto;\n\t/* Start the new connection at our maximum compatibility level */\n\tnew_conn->cc_version = lproto->lp_max_version;\n\n\t/* This will pin the stack driver if successful */\n\trc = ocfs2_stack_driver_get(stack_name);\n\tif (rc)\n\t\tgoto out_free;\n\n\trc = active_stack->sp_ops->connect(new_conn);\n\tif (rc) {\n\t\tocfs2_stack_driver_put();\n\t\tgoto out_free;\n\t}\n\n\t*conn = new_conn;\n\nout_free:\n\tif (rc)\n\t\tkfree(new_conn);\n\nout:\n\treturn rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];\n\nint ocfs2_cluster_connect_agnostic(const char *group,\n\t\t\t\t   int grouplen,\n\t\t\t\t   struct ocfs2_locking_protocol *lproto,\n\t\t\t\t   void (*recovery_handler)(int node_num,\n\t\t\t\t\t\t\t    void *recovery_data),\n\t\t\t\t   void *recovery_data,\n\t\t\t\t   struct ocfs2_cluster_connection **conn)\n{\n\tchar *stack_name = NULL;\n\n\tif (cluster_stack_name[0])\n\t\tstack_name = cluster_stack_name;\n\treturn ocfs2_cluster_connect(stack_name, NULL, 0, group, grouplen,\n\t\t\t\t     lproto, recovery_handler, recovery_data,\n\t\t\t\t     conn);\n}"
  },
  {
    "function_name": "ocfs2_cluster_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "311-379",
    "snippet": "int ocfs2_cluster_connect(const char *stack_name,\n\t\t\t  const char *cluster_name,\n\t\t\t  int cluster_name_len,\n\t\t\t  const char *group,\n\t\t\t  int grouplen,\n\t\t\t  struct ocfs2_locking_protocol *lproto,\n\t\t\t  void (*recovery_handler)(int node_num,\n\t\t\t\t\t\t   void *recovery_data),\n\t\t\t  void *recovery_data,\n\t\t\t  struct ocfs2_cluster_connection **conn)\n{\n\tint rc = 0;\n\tstruct ocfs2_cluster_connection *new_conn;\n\n\tBUG_ON(group == NULL);\n\tBUG_ON(conn == NULL);\n\tBUG_ON(recovery_handler == NULL);\n\n\tif (grouplen > GROUP_NAME_MAX) {\n\t\trc = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tif (memcmp(&lproto->lp_max_version, &locking_max_version,\n\t\t   sizeof(struct ocfs2_protocol_version))) {\n\t\trc = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tnew_conn = kzalloc(sizeof(struct ocfs2_cluster_connection),\n\t\t\t   GFP_KERNEL);\n\tif (!new_conn) {\n\t\trc = -ENOMEM;\n\t\tgoto out;\n\t}\n\n\tstrlcpy(new_conn->cc_name, group, GROUP_NAME_MAX + 1);\n\tnew_conn->cc_namelen = grouplen;\n\tif (cluster_name_len)\n\t\tstrlcpy(new_conn->cc_cluster_name, cluster_name,\n\t\t\tCLUSTER_NAME_MAX + 1);\n\tnew_conn->cc_cluster_name_len = cluster_name_len;\n\tnew_conn->cc_recovery_handler = recovery_handler;\n\tnew_conn->cc_recovery_data = recovery_data;\n\n\tnew_conn->cc_proto = lproto;\n\t/* Start the new connection at our maximum compatibility level */\n\tnew_conn->cc_version = lproto->lp_max_version;\n\n\t/* This will pin the stack driver if successful */\n\trc = ocfs2_stack_driver_get(stack_name);\n\tif (rc)\n\t\tgoto out_free;\n\n\trc = active_stack->sp_ops->connect(new_conn);\n\tif (rc) {\n\t\tocfs2_stack_driver_put();\n\t\tgoto out_free;\n\t}\n\n\t*conn = new_conn;\n\nout_free:\n\tif (rc)\n\t\tkfree(new_conn);\n\nout:\n\treturn rc;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_protocol_version locking_max_version;",
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "new_conn"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "kfree_link",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/libfs.c",
          "lines": "1103-1106",
          "snippet": "void kfree_link(void *p)\n{\n\tkfree(p);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/buffer_head.h> /* sync_mapping_buffers */",
            "#include <linux/writeback.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/namei.h>",
            "#include <linux/mutex.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/vfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/cred.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/blkdev.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/buffer_head.h> /* sync_mapping_buffers */\n#include <linux/writeback.h>\n#include <linux/exportfs.h>\n#include <linux/namei.h>\n#include <linux/mutex.h>\n#include <linux/quotaops.h>\n#include <linux/vfs.h>\n#include <linux/mount.h>\n#include <linux/cred.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/blkdev.h>\n\nvoid kfree_link(void *p)\n{\n\tkfree(p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_stack_driver_put",
          "args": [],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_stack_driver_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "158-170",
          "snippet": "static void ocfs2_stack_driver_put(void)\n{\n\tspin_lock(&ocfs2_stack_lock);\n\tBUG_ON(active_stack == NULL);\n\tBUG_ON(active_stack->sp_count == 0);\n\n\tactive_stack->sp_count--;\n\tif (!active_stack->sp_count) {\n\t\tmodule_put(active_stack->sp_owner);\n\t\tactive_stack = NULL;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
            "static struct ocfs2_stack_plugin *active_stack;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic struct ocfs2_stack_plugin *active_stack;\n\nstatic void ocfs2_stack_driver_put(void)\n{\n\tspin_lock(&ocfs2_stack_lock);\n\tBUG_ON(active_stack == NULL);\n\tBUG_ON(active_stack->sp_count == 0);\n\n\tactive_stack->sp_count--;\n\tif (!active_stack->sp_count) {\n\t\tmodule_put(active_stack->sp_owner);\n\t\tactive_stack = NULL;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "active_stack->sp_ops->connect",
          "args": [
            "new_conn"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_stack_driver_get",
          "args": [
            "stack_name"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_stack_driver_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "117-156",
          "snippet": "static int ocfs2_stack_driver_get(const char *stack_name)\n{\n\tint rc;\n\tchar *plugin_name = OCFS2_STACK_PLUGIN_O2CB;\n\n\t/*\n\t * Classic stack does not pass in a stack name.  This is\n\t * compatible with older tools as well.\n\t */\n\tif (!stack_name || !*stack_name)\n\t\tstack_name = OCFS2_STACK_PLUGIN_O2CB;\n\n\tif (strlen(stack_name) != OCFS2_STACK_LABEL_LEN) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2 passed an invalid cluster stack label: \\\"%s\\\"\\n\",\n\t\t       stack_name);\n\t\treturn -EINVAL;\n\t}\n\n\t/* Anything that isn't the classic stack is a user stack */\n\tif (strcmp(stack_name, OCFS2_STACK_PLUGIN_O2CB))\n\t\tplugin_name = OCFS2_STACK_PLUGIN_USER;\n\n\trc = ocfs2_stack_driver_request(stack_name, plugin_name);\n\tif (rc == -ENOENT) {\n\t\trequest_module(\"ocfs2_stack_%s\", plugin_name);\n\t\trc = ocfs2_stack_driver_request(stack_name, plugin_name);\n\t}\n\n\tif (rc == -ENOENT) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: Cluster stack driver \\\"%s\\\" cannot be found\\n\",\n\t\t       plugin_name);\n\t} else if (rc == -EBUSY) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: A different cluster stack is in use\\n\");\n\t}\n\n\treturn rc;\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [
            "#define OCFS2_STACK_PLUGIN_USER\t\t\"user\"",
            "#define OCFS2_STACK_PLUGIN_O2CB\t\t\"o2cb\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\n#define OCFS2_STACK_PLUGIN_USER\t\t\"user\"\n#define OCFS2_STACK_PLUGIN_O2CB\t\t\"o2cb\"\n\nstatic int ocfs2_stack_driver_get(const char *stack_name)\n{\n\tint rc;\n\tchar *plugin_name = OCFS2_STACK_PLUGIN_O2CB;\n\n\t/*\n\t * Classic stack does not pass in a stack name.  This is\n\t * compatible with older tools as well.\n\t */\n\tif (!stack_name || !*stack_name)\n\t\tstack_name = OCFS2_STACK_PLUGIN_O2CB;\n\n\tif (strlen(stack_name) != OCFS2_STACK_LABEL_LEN) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2 passed an invalid cluster stack label: \\\"%s\\\"\\n\",\n\t\t       stack_name);\n\t\treturn -EINVAL;\n\t}\n\n\t/* Anything that isn't the classic stack is a user stack */\n\tif (strcmp(stack_name, OCFS2_STACK_PLUGIN_O2CB))\n\t\tplugin_name = OCFS2_STACK_PLUGIN_USER;\n\n\trc = ocfs2_stack_driver_request(stack_name, plugin_name);\n\tif (rc == -ENOENT) {\n\t\trequest_module(\"ocfs2_stack_%s\", plugin_name);\n\t\trc = ocfs2_stack_driver_request(stack_name, plugin_name);\n\t}\n\n\tif (rc == -ENOENT) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: Cluster stack driver \\\"%s\\\" cannot be found\\n\",\n\t\t       plugin_name);\n\t} else if (rc == -EBUSY) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: A different cluster stack is in use\\n\");\n\t}\n\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "new_conn->cc_cluster_name",
            "cluster_name",
            "CLUSTER_NAME_MAX + 1"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "new_conn->cc_name",
            "group",
            "GROUP_NAME_MAX + 1"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct ocfs2_cluster_connection)",
            "GFP_KERNEL"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&lproto->lp_max_version",
            "&locking_max_version",
            "sizeof(struct ocfs2_protocol_version)"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "recovery_handler == NULL"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "conn == NULL"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "group == NULL"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_protocol_version locking_max_version;\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_cluster_connect(const char *stack_name,\n\t\t\t  const char *cluster_name,\n\t\t\t  int cluster_name_len,\n\t\t\t  const char *group,\n\t\t\t  int grouplen,\n\t\t\t  struct ocfs2_locking_protocol *lproto,\n\t\t\t  void (*recovery_handler)(int node_num,\n\t\t\t\t\t\t   void *recovery_data),\n\t\t\t  void *recovery_data,\n\t\t\t  struct ocfs2_cluster_connection **conn)\n{\n\tint rc = 0;\n\tstruct ocfs2_cluster_connection *new_conn;\n\n\tBUG_ON(group == NULL);\n\tBUG_ON(conn == NULL);\n\tBUG_ON(recovery_handler == NULL);\n\n\tif (grouplen > GROUP_NAME_MAX) {\n\t\trc = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tif (memcmp(&lproto->lp_max_version, &locking_max_version,\n\t\t   sizeof(struct ocfs2_protocol_version))) {\n\t\trc = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tnew_conn = kzalloc(sizeof(struct ocfs2_cluster_connection),\n\t\t\t   GFP_KERNEL);\n\tif (!new_conn) {\n\t\trc = -ENOMEM;\n\t\tgoto out;\n\t}\n\n\tstrlcpy(new_conn->cc_name, group, GROUP_NAME_MAX + 1);\n\tnew_conn->cc_namelen = grouplen;\n\tif (cluster_name_len)\n\t\tstrlcpy(new_conn->cc_cluster_name, cluster_name,\n\t\t\tCLUSTER_NAME_MAX + 1);\n\tnew_conn->cc_cluster_name_len = cluster_name_len;\n\tnew_conn->cc_recovery_handler = recovery_handler;\n\tnew_conn->cc_recovery_data = recovery_data;\n\n\tnew_conn->cc_proto = lproto;\n\t/* Start the new connection at our maximum compatibility level */\n\tnew_conn->cc_version = lproto->lp_max_version;\n\n\t/* This will pin the stack driver if successful */\n\trc = ocfs2_stack_driver_get(stack_name);\n\tif (rc)\n\t\tgoto out_free;\n\n\trc = active_stack->sp_ops->connect(new_conn);\n\tif (rc) {\n\t\tocfs2_stack_driver_put();\n\t\tgoto out_free;\n\t}\n\n\t*conn = new_conn;\n\nout_free:\n\tif (rc)\n\t\tkfree(new_conn);\n\nout:\n\treturn rc;\n}"
  },
  {
    "function_name": "ocfs2_plock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "301-308",
    "snippet": "int ocfs2_plock(struct ocfs2_cluster_connection *conn, u64 ino,\n\t\tstruct file *file, int cmd, struct file_lock *fl)\n{\n\tWARN_ON_ONCE(active_stack->sp_ops->plock == NULL);\n\tif (active_stack->sp_ops->plock)\n\t\treturn active_stack->sp_ops->plock(conn, ino, file, cmd, fl);\n\treturn -EOPNOTSUPP;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "active_stack->sp_ops->plock",
          "args": [
            "conn",
            "ino",
            "file",
            "cmd",
            "fl"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "active_stack->sp_ops->plock == NULL"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_plock(struct ocfs2_cluster_connection *conn, u64 ino,\n\t\tstruct file *file, int cmd, struct file_lock *fl)\n{\n\tWARN_ON_ONCE(active_stack->sp_ops->plock == NULL);\n\tif (active_stack->sp_ops->plock)\n\t\treturn active_stack->sp_ops->plock(conn, ino, file, cmd, fl);\n\treturn -EOPNOTSUPP;\n}"
  },
  {
    "function_name": "ocfs2_stack_supports_plocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "291-294",
    "snippet": "int ocfs2_stack_supports_plocks(void)\n{\n\treturn active_stack && active_stack->sp_ops->plock;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_stack_supports_plocks(void)\n{\n\treturn active_stack && active_stack->sp_ops->plock;\n}"
  },
  {
    "function_name": "ocfs2_dlm_dump_lksb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "285-288",
    "snippet": "void ocfs2_dlm_dump_lksb(struct ocfs2_dlm_lksb *lksb)\n{\n\tactive_stack->sp_ops->dump_lksb(lksb);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "active_stack->sp_ops->dump_lksb",
          "args": [
            "lksb"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nvoid ocfs2_dlm_dump_lksb(struct ocfs2_dlm_lksb *lksb)\n{\n\tactive_stack->sp_ops->dump_lksb(lksb);\n}"
  },
  {
    "function_name": "ocfs2_dlm_lvb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "279-282",
    "snippet": "void *ocfs2_dlm_lvb(struct ocfs2_dlm_lksb *lksb)\n{\n\treturn active_stack->sp_ops->lock_lvb(lksb);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "active_stack->sp_ops->lock_lvb",
          "args": [
            "lksb"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nvoid *ocfs2_dlm_lvb(struct ocfs2_dlm_lksb *lksb)\n{\n\treturn active_stack->sp_ops->lock_lvb(lksb);\n}"
  },
  {
    "function_name": "ocfs2_dlm_lvb_valid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "273-276",
    "snippet": "int ocfs2_dlm_lvb_valid(struct ocfs2_dlm_lksb *lksb)\n{\n\treturn active_stack->sp_ops->lvb_valid(lksb);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "active_stack->sp_ops->lvb_valid",
          "args": [
            "lksb"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_dlm_lvb_valid(struct ocfs2_dlm_lksb *lksb)\n{\n\treturn active_stack->sp_ops->lvb_valid(lksb);\n}"
  },
  {
    "function_name": "ocfs2_dlm_lock_status",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "267-270",
    "snippet": "int ocfs2_dlm_lock_status(struct ocfs2_dlm_lksb *lksb)\n{\n\treturn active_stack->sp_ops->lock_status(lksb);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "active_stack->sp_ops->lock_status",
          "args": [
            "lksb"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_dlm_lock_status(struct ocfs2_dlm_lksb *lksb)\n{\n\treturn active_stack->sp_ops->lock_status(lksb);\n}"
  },
  {
    "function_name": "ocfs2_dlm_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "257-264",
    "snippet": "int ocfs2_dlm_unlock(struct ocfs2_cluster_connection *conn,\n\t\t     struct ocfs2_dlm_lksb *lksb,\n\t\t     u32 flags)\n{\n\tBUG_ON(lksb->lksb_conn == NULL);\n\n\treturn active_stack->sp_ops->dlm_unlock(conn, lksb, flags);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "active_stack->sp_ops->dlm_unlock",
          "args": [
            "conn",
            "lksb",
            "flags"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "lksb->lksb_conn == NULL"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_dlm_unlock(struct ocfs2_cluster_connection *conn,\n\t\t     struct ocfs2_dlm_lksb *lksb,\n\t\t     u32 flags)\n{\n\tBUG_ON(lksb->lksb_conn == NULL);\n\n\treturn active_stack->sp_ops->dlm_unlock(conn, lksb, flags);\n}"
  },
  {
    "function_name": "ocfs2_dlm_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "241-254",
    "snippet": "int ocfs2_dlm_lock(struct ocfs2_cluster_connection *conn,\n\t\t   int mode,\n\t\t   struct ocfs2_dlm_lksb *lksb,\n\t\t   u32 flags,\n\t\t   void *name,\n\t\t   unsigned int namelen)\n{\n\tif (!lksb->lksb_conn)\n\t\tlksb->lksb_conn = conn;\n\telse\n\t\tBUG_ON(lksb->lksb_conn != conn);\n\treturn active_stack->sp_ops->dlm_lock(conn, mode, lksb, flags,\n\t\t\t\t\t      name, namelen);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "active_stack->sp_ops->dlm_lock",
          "args": [
            "conn",
            "mode",
            "lksb",
            "flags",
            "name",
            "namelen"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "lksb->lksb_conn != conn"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_stack_plugin *active_stack;\n\nint ocfs2_dlm_lock(struct ocfs2_cluster_connection *conn,\n\t\t   int mode,\n\t\t   struct ocfs2_dlm_lksb *lksb,\n\t\t   u32 flags,\n\t\t   void *name,\n\t\t   unsigned int namelen)\n{\n\tif (!lksb->lksb_conn)\n\t\tlksb->lksb_conn = conn;\n\telse\n\t\tBUG_ON(lksb->lksb_conn != conn);\n\treturn active_stack->sp_ops->dlm_lock(conn, mode, lksb, flags,\n\t\t\t\t\t      name, namelen);\n}"
  },
  {
    "function_name": "ocfs2_stack_glue_set_max_proto_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "216-231",
    "snippet": "void ocfs2_stack_glue_set_max_proto_version(struct ocfs2_protocol_version *max_proto)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (memcmp(max_proto, &locking_max_version,\n\t\t   sizeof(struct ocfs2_protocol_version))) {\n\t\tBUG_ON(locking_max_version.pv_major != 0);\n\n\t\tlocking_max_version = *max_proto;\n\t\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\t\tp->sp_max_proto = locking_max_version;\n\t\t}\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_protocol_version locking_max_version;",
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static LIST_HEAD(ocfs2_stack_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "p",
            "&ocfs2_stack_list",
            "sp_list"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "locking_max_version.pv_major != 0"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "max_proto",
            "&locking_max_version",
            "sizeof(struct ocfs2_protocol_version)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_protocol_version locking_max_version;\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic LIST_HEAD(ocfs2_stack_list);\n\nvoid ocfs2_stack_glue_set_max_proto_version(struct ocfs2_protocol_version *max_proto)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (memcmp(max_proto, &locking_max_version,\n\t\t   sizeof(struct ocfs2_protocol_version))) {\n\t\tBUG_ON(locking_max_version.pv_major != 0);\n\n\t\tlocking_max_version = *max_proto;\n\t\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\t\tp->sp_max_proto = locking_max_version;\n\t\t}\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}"
  },
  {
    "function_name": "ocfs2_stack_glue_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "195-213",
    "snippet": "void ocfs2_stack_glue_unregister(struct ocfs2_stack_plugin *plugin)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tp = ocfs2_stack_lookup(plugin->sp_name);\n\tif (p) {\n\t\tBUG_ON(p != plugin);\n\t\tBUG_ON(plugin == active_stack);\n\t\tBUG_ON(plugin->sp_count != 0);\n\t\tlist_del_init(&plugin->sp_list);\n\t\tprintk(KERN_INFO \"ocfs2: Unregistered cluster interface %s\\n\",\n\t\t       plugin->sp_name);\n\t} else {\n\t\tprintk(KERN_ERR \"Stack \\\"%s\\\" is not registered\\n\",\n\t\t       plugin->sp_name);\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"Stack \\\"%s\\\" is not registered\\n\"",
            "plugin->sp_name"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "cachefiles_printk_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/cachefiles/namei.c",
          "lines": "74-81",
          "snippet": "static noinline void cachefiles_printk_object(struct cachefiles_object *object,\n\t\t\t\t\t      struct cachefiles_object *xobject)\n{\n\tif (object)\n\t\t__cachefiles_printk_object(object, \"\");\n\tif (xobject)\n\t\t__cachefiles_printk_object(xobject, \"x\");\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/quotaops.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n\nstatic noinline void cachefiles_printk_object(struct cachefiles_object *object,\n\t\t\t\t\t      struct cachefiles_object *xobject)\n{\n\tif (object)\n\t\t__cachefiles_printk_object(object, \"\");\n\tif (xobject)\n\t\t__cachefiles_printk_object(xobject, \"x\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&plugin->sp_list"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "plugin->sp_count != 0"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "plugin == active_stack"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "p != plugin"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_stack_lookup",
          "args": [
            "plugin->sp_name"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_stack_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "51-63",
          "snippet": "static struct ocfs2_stack_plugin *ocfs2_stack_lookup(const char *name)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tassert_spin_locked(&ocfs2_stack_lock);\n\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tif (!strcmp(p->sp_name, name))\n\t\t\treturn p;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
            "static LIST_HEAD(ocfs2_stack_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic LIST_HEAD(ocfs2_stack_list);\n\nstatic struct ocfs2_stack_plugin *ocfs2_stack_lookup(const char *name)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tassert_spin_locked(&ocfs2_stack_lock);\n\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tif (!strcmp(p->sp_name, name))\n\t\t\treturn p;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic struct ocfs2_stack_plugin *active_stack;\n\nvoid ocfs2_stack_glue_unregister(struct ocfs2_stack_plugin *plugin)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tp = ocfs2_stack_lookup(plugin->sp_name);\n\tif (p) {\n\t\tBUG_ON(p != plugin);\n\t\tBUG_ON(plugin == active_stack);\n\t\tBUG_ON(plugin->sp_count != 0);\n\t\tlist_del_init(&plugin->sp_list);\n\t\tprintk(KERN_INFO \"ocfs2: Unregistered cluster interface %s\\n\",\n\t\t       plugin->sp_name);\n\t} else {\n\t\tprintk(KERN_ERR \"Stack \\\"%s\\\" is not registered\\n\",\n\t\t       plugin->sp_name);\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}"
  },
  {
    "function_name": "ocfs2_stack_glue_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "172-192",
    "snippet": "int ocfs2_stack_glue_register(struct ocfs2_stack_plugin *plugin)\n{\n\tint rc;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (!ocfs2_stack_lookup(plugin->sp_name)) {\n\t\tplugin->sp_count = 0;\n\t\tplugin->sp_max_proto = locking_max_version;\n\t\tlist_add(&plugin->sp_list, &ocfs2_stack_list);\n\t\tprintk(KERN_INFO \"ocfs2: Registered cluster interface %s\\n\",\n\t\t       plugin->sp_name);\n\t\trc = 0;\n\t} else {\n\t\tprintk(KERN_ERR \"ocfs2: Stack \\\"%s\\\" already registered\\n\",\n\t\t       plugin->sp_name);\n\t\trc = -EEXIST;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn rc;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ocfs2_protocol_version locking_max_version;",
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static LIST_HEAD(ocfs2_stack_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR \"ocfs2: Stack \\\"%s\\\" already registered\\n\"",
            "plugin->sp_name"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "cachefiles_printk_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/cachefiles/namei.c",
          "lines": "74-81",
          "snippet": "static noinline void cachefiles_printk_object(struct cachefiles_object *object,\n\t\t\t\t\t      struct cachefiles_object *xobject)\n{\n\tif (object)\n\t\t__cachefiles_printk_object(object, \"\");\n\tif (xobject)\n\t\t__cachefiles_printk_object(xobject, \"x\");\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/quotaops.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n\nstatic noinline void cachefiles_printk_object(struct cachefiles_object *object,\n\t\t\t\t\t      struct cachefiles_object *xobject)\n{\n\tif (object)\n\t\t__cachefiles_printk_object(object, \"\");\n\tif (xobject)\n\t\t__cachefiles_printk_object(xobject, \"x\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&plugin->sp_list",
            "&ocfs2_stack_list"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "simple_xattr_list_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/xattr.c",
          "lines": "985-991",
          "snippet": "void simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nvoid simple_xattr_list_add(struct simple_xattrs *xattrs,\n\t\t\t   struct simple_xattr *new_xattr)\n{\n\tspin_lock(&xattrs->lock);\n\tlist_add(&new_xattr->list, &xattrs->head);\n\tspin_unlock(&xattrs->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_stack_lookup",
          "args": [
            "plugin->sp_name"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_stack_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "51-63",
          "snippet": "static struct ocfs2_stack_plugin *ocfs2_stack_lookup(const char *name)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tassert_spin_locked(&ocfs2_stack_lock);\n\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tif (!strcmp(p->sp_name, name))\n\t\t\treturn p;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
            "static LIST_HEAD(ocfs2_stack_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic LIST_HEAD(ocfs2_stack_list);\n\nstatic struct ocfs2_stack_plugin *ocfs2_stack_lookup(const char *name)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tassert_spin_locked(&ocfs2_stack_lock);\n\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tif (!strcmp(p->sp_name, name))\n\t\t\treturn p;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic struct ocfs2_protocol_version locking_max_version;\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic LIST_HEAD(ocfs2_stack_list);\n\nint ocfs2_stack_glue_register(struct ocfs2_stack_plugin *plugin)\n{\n\tint rc;\n\n\tspin_lock(&ocfs2_stack_lock);\n\tif (!ocfs2_stack_lookup(plugin->sp_name)) {\n\t\tplugin->sp_count = 0;\n\t\tplugin->sp_max_proto = locking_max_version;\n\t\tlist_add(&plugin->sp_list, &ocfs2_stack_list);\n\t\tprintk(KERN_INFO \"ocfs2: Registered cluster interface %s\\n\",\n\t\t       plugin->sp_name);\n\t\trc = 0;\n\t} else {\n\t\tprintk(KERN_ERR \"ocfs2: Stack \\\"%s\\\" already registered\\n\",\n\t\t       plugin->sp_name);\n\t\trc = -EEXIST;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n\n\treturn rc;\n}"
  },
  {
    "function_name": "ocfs2_stack_driver_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "158-170",
    "snippet": "static void ocfs2_stack_driver_put(void)\n{\n\tspin_lock(&ocfs2_stack_lock);\n\tBUG_ON(active_stack == NULL);\n\tBUG_ON(active_stack->sp_count == 0);\n\n\tactive_stack->sp_count--;\n\tif (!active_stack->sp_count) {\n\t\tmodule_put(active_stack->sp_owner);\n\t\tactive_stack = NULL;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "active_stack->sp_owner"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "active_stack->sp_count == 0"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "active_stack == NULL"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic struct ocfs2_stack_plugin *active_stack;\n\nstatic void ocfs2_stack_driver_put(void)\n{\n\tspin_lock(&ocfs2_stack_lock);\n\tBUG_ON(active_stack == NULL);\n\tBUG_ON(active_stack->sp_count == 0);\n\n\tactive_stack->sp_count--;\n\tif (!active_stack->sp_count) {\n\t\tmodule_put(active_stack->sp_owner);\n\t\tactive_stack = NULL;\n\t}\n\tspin_unlock(&ocfs2_stack_lock);\n}"
  },
  {
    "function_name": "ocfs2_stack_driver_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "117-156",
    "snippet": "static int ocfs2_stack_driver_get(const char *stack_name)\n{\n\tint rc;\n\tchar *plugin_name = OCFS2_STACK_PLUGIN_O2CB;\n\n\t/*\n\t * Classic stack does not pass in a stack name.  This is\n\t * compatible with older tools as well.\n\t */\n\tif (!stack_name || !*stack_name)\n\t\tstack_name = OCFS2_STACK_PLUGIN_O2CB;\n\n\tif (strlen(stack_name) != OCFS2_STACK_LABEL_LEN) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2 passed an invalid cluster stack label: \\\"%s\\\"\\n\",\n\t\t       stack_name);\n\t\treturn -EINVAL;\n\t}\n\n\t/* Anything that isn't the classic stack is a user stack */\n\tif (strcmp(stack_name, OCFS2_STACK_PLUGIN_O2CB))\n\t\tplugin_name = OCFS2_STACK_PLUGIN_USER;\n\n\trc = ocfs2_stack_driver_request(stack_name, plugin_name);\n\tif (rc == -ENOENT) {\n\t\trequest_module(\"ocfs2_stack_%s\", plugin_name);\n\t\trc = ocfs2_stack_driver_request(stack_name, plugin_name);\n\t}\n\n\tif (rc == -ENOENT) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: Cluster stack driver \\\"%s\\\" cannot be found\\n\",\n\t\t       plugin_name);\n\t} else if (rc == -EBUSY) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: A different cluster stack is in use\\n\");\n\t}\n\n\treturn rc;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [
      "#define OCFS2_STACK_PLUGIN_USER\t\t\"user\"",
      "#define OCFS2_STACK_PLUGIN_O2CB\t\t\"o2cb\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR\n\t\t       \"ocfs2: A different cluster stack is in use\\n\""
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "reiserfs_printk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/reiserfs/prints.c",
          "lines": "310-314",
          "snippet": "static void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}",
          "includes": [
            "#include <stdarg.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/string.h>",
            "#include \"reiserfs.h\"",
            "#include <linux/fs.h>",
            "#include <linux/time.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static char error_buf[1024];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <stdarg.h>\n#include <linux/buffer_head.h>\n#include <linux/string.h>\n#include \"reiserfs.h\"\n#include <linux/fs.h>\n#include <linux/time.h>\n\nstatic char error_buf[1024];\n\nstatic void reiserfs_printk(const char *fmt, ...)\n{\n\tdo_reiserfs_warning(fmt);\n\tprintk(error_buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_ERR\n\t\t       \"ocfs2: Cluster stack driver \\\"%s\\\" cannot be found\\n\"",
            "plugin_name"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "cachefiles_printk_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/cachefiles/namei.c",
          "lines": "74-81",
          "snippet": "static noinline void cachefiles_printk_object(struct cachefiles_object *object,\n\t\t\t\t\t      struct cachefiles_object *xobject)\n{\n\tif (object)\n\t\t__cachefiles_printk_object(object, \"\");\n\tif (xobject)\n\t\t__cachefiles_printk_object(xobject, \"x\");\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/xattr.h>",
            "#include <linux/slab.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/quotaops.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/sched.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/xattr.h>\n#include <linux/slab.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/quotaops.h>\n#include <linux/fsnotify.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/sched.h>\n#include <linux/module.h>\n\nstatic noinline void cachefiles_printk_object(struct cachefiles_object *object,\n\t\t\t\t\t      struct cachefiles_object *xobject)\n{\n\tif (object)\n\t\t__cachefiles_printk_object(object, \"\");\n\tif (xobject)\n\t\t__cachefiles_printk_object(xobject, \"x\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "ocfs2_stack_driver_request",
          "args": [
            "stack_name",
            "plugin_name"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_stack_driver_request",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "65-110",
          "snippet": "static int ocfs2_stack_driver_request(const char *stack_name,\n\t\t\t\t      const char *plugin_name)\n{\n\tint rc;\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\n\t/*\n\t * If the stack passed by the filesystem isn't the selected one,\n\t * we can't continue.\n\t */\n\tif (strcmp(stack_name, cluster_stack_name)) {\n\t\trc = -EBUSY;\n\t\tgoto out;\n\t}\n\n\tif (active_stack) {\n\t\t/*\n\t\t * If the active stack isn't the one we want, it cannot\n\t\t * be selected right now.\n\t\t */\n\t\tif (!strcmp(active_stack->sp_name, plugin_name))\n\t\t\trc = 0;\n\t\telse\n\t\t\trc = -EBUSY;\n\t\tgoto out;\n\t}\n\n\tp = ocfs2_stack_lookup(plugin_name);\n\tif (!p || !try_module_get(p->sp_owner)) {\n\t\trc = -ENOENT;\n\t\tgoto out;\n\t}\n\n\tactive_stack = p;\n\trc = 0;\n\nout:\n\t/* If we found it, pin it */\n\tif (!rc)\n\t\tactive_stack->sp_count++;\n\n\tspin_unlock(&ocfs2_stack_lock);\n\treturn rc;\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
            "static char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];",
            "static struct ocfs2_stack_plugin *active_stack;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];\nstatic struct ocfs2_stack_plugin *active_stack;\n\nstatic int ocfs2_stack_driver_request(const char *stack_name,\n\t\t\t\t      const char *plugin_name)\n{\n\tint rc;\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\n\t/*\n\t * If the stack passed by the filesystem isn't the selected one,\n\t * we can't continue.\n\t */\n\tif (strcmp(stack_name, cluster_stack_name)) {\n\t\trc = -EBUSY;\n\t\tgoto out;\n\t}\n\n\tif (active_stack) {\n\t\t/*\n\t\t * If the active stack isn't the one we want, it cannot\n\t\t * be selected right now.\n\t\t */\n\t\tif (!strcmp(active_stack->sp_name, plugin_name))\n\t\t\trc = 0;\n\t\telse\n\t\t\trc = -EBUSY;\n\t\tgoto out;\n\t}\n\n\tp = ocfs2_stack_lookup(plugin_name);\n\tif (!p || !try_module_get(p->sp_owner)) {\n\t\trc = -ENOENT;\n\t\tgoto out;\n\t}\n\n\tactive_stack = p;\n\trc = 0;\n\nout:\n\t/* If we found it, pin it */\n\tif (!rc)\n\t\tactive_stack->sp_count++;\n\n\tspin_unlock(&ocfs2_stack_lock);\n\treturn rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "\"ocfs2_stack_%s\"",
            "plugin_name"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "stack_name",
            "OCFS2_STACK_PLUGIN_O2CB"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/xattr.c",
          "lines": "27-35",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "stack_name"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "xdr_strlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/afs/yfsclient.c",
          "lines": "67-70",
          "snippet": "static size_t xdr_strlen(unsigned int len)\n{\n\treturn sizeof(__be32) + round_up(len, sizeof(__be32));\n}",
          "includes": [
            "#include \"protocol_yfs.h\"",
            "#include \"xdr_fs.h\"",
            "#include \"afs_fs.h\"",
            "#include \"internal.h\"",
            "#include <linux/iversion.h>",
            "#include <linux/circ_buf.h>",
            "#include <linux/sched.h>",
            "#include <linux/slab.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"protocol_yfs.h\"\n#include \"xdr_fs.h\"\n#include \"afs_fs.h\"\n#include \"internal.h\"\n#include <linux/iversion.h>\n#include <linux/circ_buf.h>\n#include <linux/sched.h>\n#include <linux/slab.h>\n#include <linux/init.h>\n\nstatic size_t xdr_strlen(unsigned int len)\n{\n\treturn sizeof(__be32) + round_up(len, sizeof(__be32));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\n#define OCFS2_STACK_PLUGIN_USER\t\t\"user\"\n#define OCFS2_STACK_PLUGIN_O2CB\t\t\"o2cb\"\n\nstatic int ocfs2_stack_driver_get(const char *stack_name)\n{\n\tint rc;\n\tchar *plugin_name = OCFS2_STACK_PLUGIN_O2CB;\n\n\t/*\n\t * Classic stack does not pass in a stack name.  This is\n\t * compatible with older tools as well.\n\t */\n\tif (!stack_name || !*stack_name)\n\t\tstack_name = OCFS2_STACK_PLUGIN_O2CB;\n\n\tif (strlen(stack_name) != OCFS2_STACK_LABEL_LEN) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2 passed an invalid cluster stack label: \\\"%s\\\"\\n\",\n\t\t       stack_name);\n\t\treturn -EINVAL;\n\t}\n\n\t/* Anything that isn't the classic stack is a user stack */\n\tif (strcmp(stack_name, OCFS2_STACK_PLUGIN_O2CB))\n\t\tplugin_name = OCFS2_STACK_PLUGIN_USER;\n\n\trc = ocfs2_stack_driver_request(stack_name, plugin_name);\n\tif (rc == -ENOENT) {\n\t\trequest_module(\"ocfs2_stack_%s\", plugin_name);\n\t\trc = ocfs2_stack_driver_request(stack_name, plugin_name);\n\t}\n\n\tif (rc == -ENOENT) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: Cluster stack driver \\\"%s\\\" cannot be found\\n\",\n\t\t       plugin_name);\n\t} else if (rc == -EBUSY) {\n\t\tprintk(KERN_ERR\n\t\t       \"ocfs2: A different cluster stack is in use\\n\");\n\t}\n\n\treturn rc;\n}"
  },
  {
    "function_name": "ocfs2_stack_driver_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "65-110",
    "snippet": "static int ocfs2_stack_driver_request(const char *stack_name,\n\t\t\t\t      const char *plugin_name)\n{\n\tint rc;\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\n\t/*\n\t * If the stack passed by the filesystem isn't the selected one,\n\t * we can't continue.\n\t */\n\tif (strcmp(stack_name, cluster_stack_name)) {\n\t\trc = -EBUSY;\n\t\tgoto out;\n\t}\n\n\tif (active_stack) {\n\t\t/*\n\t\t * If the active stack isn't the one we want, it cannot\n\t\t * be selected right now.\n\t\t */\n\t\tif (!strcmp(active_stack->sp_name, plugin_name))\n\t\t\trc = 0;\n\t\telse\n\t\t\trc = -EBUSY;\n\t\tgoto out;\n\t}\n\n\tp = ocfs2_stack_lookup(plugin_name);\n\tif (!p || !try_module_get(p->sp_owner)) {\n\t\trc = -ENOENT;\n\t\tgoto out;\n\t}\n\n\tactive_stack = p;\n\trc = 0;\n\nout:\n\t/* If we found it, pin it */\n\tif (!rc)\n\t\tactive_stack->sp_count++;\n\n\tspin_unlock(&ocfs2_stack_lock);\n\treturn rc;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];",
      "static struct ocfs2_stack_plugin *active_stack;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "spin_unlock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "104-107",
          "snippet": "static inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_unlock_bucket(unsigned int hash)\n{\n        hlist_bl_unlock(&qd_hash_table[hash]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "p->sp_owner"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ocfs2_stack_lookup",
          "args": [
            "plugin_name"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "ocfs2_stack_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
          "lines": "51-63",
          "snippet": "static struct ocfs2_stack_plugin *ocfs2_stack_lookup(const char *name)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tassert_spin_locked(&ocfs2_stack_lock);\n\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tif (!strcmp(p->sp_name, name))\n\t\t\treturn p;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"stackglue.h\"",
            "#include \"ocfs2_fs.h\"",
            "#include <linux/sysctl.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/fs.h>",
            "#include <linux/kmod.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
            "static LIST_HEAD(ocfs2_stack_list);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic LIST_HEAD(ocfs2_stack_list);\n\nstatic struct ocfs2_stack_plugin *ocfs2_stack_lookup(const char *name)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tassert_spin_locked(&ocfs2_stack_lock);\n\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tif (!strcmp(p->sp_name, name))\n\t\t\treturn p;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "active_stack->sp_name",
            "plugin_name"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/xattr.c",
          "lines": "27-35",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "spin_lock_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/gfs2/quota.c",
          "lines": "99-102",
          "snippet": "static inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"inode.h\"",
            "#include \"trans.h\"",
            "#include \"super.h\"",
            "#include \"rgrp.h\"",
            "#include \"quota.h\"",
            "#include \"meta_io.h\"",
            "#include \"log.h\"",
            "#include \"glops.h\"",
            "#include \"glock.h\"",
            "#include \"bmap.h\"",
            "#include \"incore.h\"",
            "#include \"gfs2.h\"",
            "#include <linux/vmalloc.h>",
            "#include <linux/jhash.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/rculist_bl.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/list_lru.h>",
            "#include <linux/lockref.h>",
            "#include <linux/dqblk_xfs.h>",
            "#include <linux/quota.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/gfs2_ondisk.h>",
            "#include <linux/bio.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/completion.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"inode.h\"\n#include \"trans.h\"\n#include \"super.h\"\n#include \"rgrp.h\"\n#include \"quota.h\"\n#include \"meta_io.h\"\n#include \"log.h\"\n#include \"glops.h\"\n#include \"glock.h\"\n#include \"bmap.h\"\n#include \"incore.h\"\n#include \"gfs2.h\"\n#include <linux/vmalloc.h>\n#include <linux/jhash.h>\n#include <linux/bit_spinlock.h>\n#include <linux/rculist_bl.h>\n#include <linux/rcupdate.h>\n#include <linux/list_lru.h>\n#include <linux/lockref.h>\n#include <linux/dqblk_xfs.h>\n#include <linux/quota.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/gfs2_ondisk.h>\n#include <linux/bio.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/buffer_head.h>\n#include <linux/completion.h>\n#include <linux/spinlock.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n\nstatic struct hlist_bl_head qd_hash_table[GFS2_QD_HASH_SIZE];\n\nstatic inline void spin_lock_bucket(unsigned int hash)\n{\n        hlist_bl_lock(&qd_hash_table[hash]);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic char cluster_stack_name[OCFS2_STACK_LABEL_LEN + 1];\nstatic struct ocfs2_stack_plugin *active_stack;\n\nstatic int ocfs2_stack_driver_request(const char *stack_name,\n\t\t\t\t      const char *plugin_name)\n{\n\tint rc;\n\tstruct ocfs2_stack_plugin *p;\n\n\tspin_lock(&ocfs2_stack_lock);\n\n\t/*\n\t * If the stack passed by the filesystem isn't the selected one,\n\t * we can't continue.\n\t */\n\tif (strcmp(stack_name, cluster_stack_name)) {\n\t\trc = -EBUSY;\n\t\tgoto out;\n\t}\n\n\tif (active_stack) {\n\t\t/*\n\t\t * If the active stack isn't the one we want, it cannot\n\t\t * be selected right now.\n\t\t */\n\t\tif (!strcmp(active_stack->sp_name, plugin_name))\n\t\t\trc = 0;\n\t\telse\n\t\t\trc = -EBUSY;\n\t\tgoto out;\n\t}\n\n\tp = ocfs2_stack_lookup(plugin_name);\n\tif (!p || !try_module_get(p->sp_owner)) {\n\t\trc = -ENOENT;\n\t\tgoto out;\n\t}\n\n\tactive_stack = p;\n\trc = 0;\n\nout:\n\t/* If we found it, pin it */\n\tif (!rc)\n\t\tactive_stack->sp_count++;\n\n\tspin_unlock(&ocfs2_stack_lock);\n\treturn rc;\n}"
  },
  {
    "function_name": "ocfs2_stack_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/ocfs2/stackglue.c",
    "lines": "51-63",
    "snippet": "static struct ocfs2_stack_plugin *ocfs2_stack_lookup(const char *name)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tassert_spin_locked(&ocfs2_stack_lock);\n\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tif (!strcmp(p->sp_name, name))\n\t\t\treturn p;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include \"stackglue.h\"",
      "#include \"ocfs2_fs.h\"",
      "#include <linux/sysctl.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/kobject.h>",
      "#include <linux/fs.h>",
      "#include <linux/kmod.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(ocfs2_stack_lock);",
      "static LIST_HEAD(ocfs2_stack_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "p->sp_name",
            "name"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "strcmp_prefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/fs/xattr.c",
          "lines": "27-35",
          "snippet": "static const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/audit.h>",
            "#include <linux/fsnotify.h>",
            "#include <linux/export.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/evm.h>",
            "#include <linux/security.h>",
            "#include <linux/namei.h>",
            "#include <linux/mount.h>",
            "#include <linux/xattr.h>",
            "#include <linux/file.h>",
            "#include <linux/slab.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/vmalloc.h>\n#include <linux/audit.h>\n#include <linux/fsnotify.h>\n#include <linux/export.h>\n#include <linux/syscalls.h>\n#include <linux/evm.h>\n#include <linux/security.h>\n#include <linux/namei.h>\n#include <linux/mount.h>\n#include <linux/xattr.h>\n#include <linux/file.h>\n#include <linux/slab.h>\n#include <linux/fs.h>\n\nstatic const char *\nstrcmp_prefix(const char *a, const char *a_prefix)\n{\n\twhile (*a_prefix && *a == *a_prefix) {\n\t\ta++;\n\t\ta_prefix++;\n\t}\n\treturn *a_prefix ? NULL : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "p",
            "&ocfs2_stack_list",
            "sp_list"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&ocfs2_stack_lock"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"stackglue.h\"\n#include \"ocfs2_fs.h\"\n#include <linux/sysctl.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/fs.h>\n#include <linux/kmod.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(ocfs2_stack_lock);\nstatic LIST_HEAD(ocfs2_stack_list);\n\nstatic struct ocfs2_stack_plugin *ocfs2_stack_lookup(const char *name)\n{\n\tstruct ocfs2_stack_plugin *p;\n\n\tassert_spin_locked(&ocfs2_stack_lock);\n\n\tlist_for_each_entry(p, &ocfs2_stack_list, sp_list) {\n\t\tif (!strcmp(p->sp_name, name))\n\t\t\treturn p;\n\t}\n\n\treturn NULL;\n}"
  }
]