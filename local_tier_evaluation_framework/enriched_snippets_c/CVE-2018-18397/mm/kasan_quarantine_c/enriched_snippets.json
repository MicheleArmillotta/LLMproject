[
  {
    "function_name": "quarantine_remove_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "299-328",
    "snippet": "void quarantine_remove_cache(struct kmem_cache *cache)\n{\n\tunsigned long flags, i;\n\tstruct qlist_head to_free = QLIST_INIT;\n\n\t/*\n\t * Must be careful to not miss any objects that are being moved from\n\t * per-cpu list to the global quarantine in quarantine_put(),\n\t * nor objects being freed in quarantine_reduce(). on_each_cpu()\n\t * achieves the first goal, while synchronize_srcu() achieves the\n\t * second.\n\t */\n\ton_each_cpu(per_cpu_remove_cache, cache, 1);\n\n\traw_spin_lock_irqsave(&quarantine_lock, flags);\n\tfor (i = 0; i < QUARANTINE_BATCHES; i++) {\n\t\tif (qlist_empty(&global_quarantine[i]))\n\t\t\tcontinue;\n\t\tqlist_move_cache(&global_quarantine[i], &to_free, cache);\n\t\t/* Scanning whole quarantine can take a while. */\n\t\traw_spin_unlock_irqrestore(&quarantine_lock, flags);\n\t\tcond_resched();\n\t\traw_spin_lock_irqsave(&quarantine_lock, flags);\n\t}\n\traw_spin_unlock_irqrestore(&quarantine_lock, flags);\n\n\tqlist_free_all(&to_free, cache);\n\n\tsynchronize_srcu(&remove_cache_srcu);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [
      "#define QUARANTINE_BATCHES \\\n\t(1024 > 4 * CONFIG_NR_CPUS ? 1024 : 4 * CONFIG_NR_CPUS)",
      "#define QLIST_INIT { NULL, NULL, 0 }"
    ],
    "globals_used": [
      "static struct qlist_head global_quarantine[QUARANTINE_BATCHES];",
      "static DEFINE_RAW_SPINLOCK(quarantine_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "synchronize_srcu",
          "args": [
            "&remove_cache_srcu"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_free_all",
          "args": [
            "&to_free",
            "cache"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_free_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "153-170",
          "snippet": "static void qlist_free_all(struct qlist_head *q, struct kmem_cache *cache)\n{\n\tstruct qlist_node *qlink;\n\n\tif (unlikely(qlist_empty(q)))\n\t\treturn;\n\n\tqlink = q->head;\n\twhile (qlink) {\n\t\tstruct kmem_cache *obj_cache =\n\t\t\tcache ? cache :\tqlink_to_cache(qlink);\n\t\tstruct qlist_node *next = qlink->next;\n\n\t\tqlink_free(qlink, obj_cache);\n\t\tqlink = next;\n\t}\n\tqlist_init(q);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_free_all(struct qlist_head *q, struct kmem_cache *cache)\n{\n\tstruct qlist_node *qlink;\n\n\tif (unlikely(qlist_empty(q)))\n\t\treturn;\n\n\tqlink = q->head;\n\twhile (qlink) {\n\t\tstruct kmem_cache *obj_cache =\n\t\t\tcache ? cache :\tqlink_to_cache(qlink);\n\t\tstruct qlist_node *next = qlink->next;\n\n\t\tqlink_free(qlink, obj_cache);\n\t\tqlink = next;\n\t}\n\tqlist_init(q);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&quarantine_lock",
            "flags"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&quarantine_lock",
            "flags"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&quarantine_lock",
            "flags"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_move_cache",
          "args": [
            "&global_quarantine[i]",
            "&to_free",
            "cache"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_move_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "263-285",
          "snippet": "static void qlist_move_cache(struct qlist_head *from,\n\t\t\t\t   struct qlist_head *to,\n\t\t\t\t   struct kmem_cache *cache)\n{\n\tstruct qlist_node *curr;\n\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tcurr = from->head;\n\tqlist_init(from);\n\twhile (curr) {\n\t\tstruct qlist_node *next = curr->next;\n\t\tstruct kmem_cache *obj_cache = qlink_to_cache(curr);\n\n\t\tif (obj_cache == cache)\n\t\t\tqlist_put(to, curr, obj_cache->size);\n\t\telse\n\t\t\tqlist_put(from, curr, obj_cache->size);\n\n\t\tcurr = next;\n\t}\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_move_cache(struct qlist_head *from,\n\t\t\t\t   struct qlist_head *to,\n\t\t\t\t   struct kmem_cache *cache)\n{\n\tstruct qlist_node *curr;\n\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tcurr = from->head;\n\tqlist_init(from);\n\twhile (curr) {\n\t\tstruct qlist_node *next = curr->next;\n\t\tstruct kmem_cache *obj_cache = qlink_to_cache(curr);\n\n\t\tif (obj_cache == cache)\n\t\t\tqlist_put(to, curr, obj_cache->size);\n\t\telse\n\t\t\tqlist_put(from, curr, obj_cache->size);\n\n\t\tcurr = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "qlist_empty",
          "args": [
            "&global_quarantine[i]"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "49-52",
          "snippet": "static bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&quarantine_lock",
            "flags"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "on_each_cpu",
          "args": [
            "per_cpu_remove_cache",
            "cache",
            "1"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\n#define QUARANTINE_BATCHES \\\n\t(1024 > 4 * CONFIG_NR_CPUS ? 1024 : 4 * CONFIG_NR_CPUS)\n#define QLIST_INIT { NULL, NULL, 0 }\n\nstatic struct qlist_head global_quarantine[QUARANTINE_BATCHES];\nstatic DEFINE_RAW_SPINLOCK(quarantine_lock);\n\nvoid quarantine_remove_cache(struct kmem_cache *cache)\n{\n\tunsigned long flags, i;\n\tstruct qlist_head to_free = QLIST_INIT;\n\n\t/*\n\t * Must be careful to not miss any objects that are being moved from\n\t * per-cpu list to the global quarantine in quarantine_put(),\n\t * nor objects being freed in quarantine_reduce(). on_each_cpu()\n\t * achieves the first goal, while synchronize_srcu() achieves the\n\t * second.\n\t */\n\ton_each_cpu(per_cpu_remove_cache, cache, 1);\n\n\traw_spin_lock_irqsave(&quarantine_lock, flags);\n\tfor (i = 0; i < QUARANTINE_BATCHES; i++) {\n\t\tif (qlist_empty(&global_quarantine[i]))\n\t\t\tcontinue;\n\t\tqlist_move_cache(&global_quarantine[i], &to_free, cache);\n\t\t/* Scanning whole quarantine can take a while. */\n\t\traw_spin_unlock_irqrestore(&quarantine_lock, flags);\n\t\tcond_resched();\n\t\traw_spin_lock_irqsave(&quarantine_lock, flags);\n\t}\n\traw_spin_unlock_irqrestore(&quarantine_lock, flags);\n\n\tqlist_free_all(&to_free, cache);\n\n\tsynchronize_srcu(&remove_cache_srcu);\n}"
  },
  {
    "function_name": "per_cpu_remove_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "287-296",
    "snippet": "static void per_cpu_remove_cache(void *arg)\n{\n\tstruct kmem_cache *cache = arg;\n\tstruct qlist_head to_free = QLIST_INIT;\n\tstruct qlist_head *q;\n\n\tq = this_cpu_ptr(&cpu_quarantine);\n\tqlist_move_cache(q, &to_free, cache);\n\tqlist_free_all(&to_free, cache);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [
      "#define QLIST_INIT { NULL, NULL, 0 }"
    ],
    "globals_used": [
      "static DEFINE_PER_CPU(struct qlist_head, cpu_quarantine);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qlist_free_all",
          "args": [
            "&to_free",
            "cache"
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_free_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "153-170",
          "snippet": "static void qlist_free_all(struct qlist_head *q, struct kmem_cache *cache)\n{\n\tstruct qlist_node *qlink;\n\n\tif (unlikely(qlist_empty(q)))\n\t\treturn;\n\n\tqlink = q->head;\n\twhile (qlink) {\n\t\tstruct kmem_cache *obj_cache =\n\t\t\tcache ? cache :\tqlink_to_cache(qlink);\n\t\tstruct qlist_node *next = qlink->next;\n\n\t\tqlink_free(qlink, obj_cache);\n\t\tqlink = next;\n\t}\n\tqlist_init(q);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_free_all(struct qlist_head *q, struct kmem_cache *cache)\n{\n\tstruct qlist_node *qlink;\n\n\tif (unlikely(qlist_empty(q)))\n\t\treturn;\n\n\tqlink = q->head;\n\twhile (qlink) {\n\t\tstruct kmem_cache *obj_cache =\n\t\t\tcache ? cache :\tqlink_to_cache(qlink);\n\t\tstruct qlist_node *next = qlink->next;\n\n\t\tqlink_free(qlink, obj_cache);\n\t\tqlink = next;\n\t}\n\tqlist_init(q);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qlist_move_cache",
          "args": [
            "q",
            "&to_free",
            "cache"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_move_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "263-285",
          "snippet": "static void qlist_move_cache(struct qlist_head *from,\n\t\t\t\t   struct qlist_head *to,\n\t\t\t\t   struct kmem_cache *cache)\n{\n\tstruct qlist_node *curr;\n\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tcurr = from->head;\n\tqlist_init(from);\n\twhile (curr) {\n\t\tstruct qlist_node *next = curr->next;\n\t\tstruct kmem_cache *obj_cache = qlink_to_cache(curr);\n\n\t\tif (obj_cache == cache)\n\t\t\tqlist_put(to, curr, obj_cache->size);\n\t\telse\n\t\t\tqlist_put(from, curr, obj_cache->size);\n\n\t\tcurr = next;\n\t}\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_move_cache(struct qlist_head *from,\n\t\t\t\t   struct qlist_head *to,\n\t\t\t\t   struct kmem_cache *cache)\n{\n\tstruct qlist_node *curr;\n\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tcurr = from->head;\n\tqlist_init(from);\n\twhile (curr) {\n\t\tstruct qlist_node *next = curr->next;\n\t\tstruct kmem_cache *obj_cache = qlink_to_cache(curr);\n\n\t\tif (obj_cache == cache)\n\t\t\tqlist_put(to, curr, obj_cache->size);\n\t\telse\n\t\t\tqlist_put(from, curr, obj_cache->size);\n\n\t\tcurr = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&cpu_quarantine"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\n#define QLIST_INIT { NULL, NULL, 0 }\n\nstatic DEFINE_PER_CPU(struct qlist_head, cpu_quarantine);\n\nstatic void per_cpu_remove_cache(void *arg)\n{\n\tstruct kmem_cache *cache = arg;\n\tstruct qlist_head to_free = QLIST_INIT;\n\tstruct qlist_head *q;\n\n\tq = this_cpu_ptr(&cpu_quarantine);\n\tqlist_move_cache(q, &to_free, cache);\n\tqlist_free_all(&to_free, cache);\n}"
  },
  {
    "function_name": "qlist_move_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "263-285",
    "snippet": "static void qlist_move_cache(struct qlist_head *from,\n\t\t\t\t   struct qlist_head *to,\n\t\t\t\t   struct kmem_cache *cache)\n{\n\tstruct qlist_node *curr;\n\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tcurr = from->head;\n\tqlist_init(from);\n\twhile (curr) {\n\t\tstruct qlist_node *next = curr->next;\n\t\tstruct kmem_cache *obj_cache = qlink_to_cache(curr);\n\n\t\tif (obj_cache == cache)\n\t\t\tqlist_put(to, curr, obj_cache->size);\n\t\telse\n\t\t\tqlist_put(from, curr, obj_cache->size);\n\n\t\tcurr = next;\n\t}\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qlist_put",
          "args": [
            "from",
            "curr",
            "obj_cache->size"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "60-70",
          "snippet": "static void qlist_put(struct qlist_head *q, struct qlist_node *qlink,\n\t\tsize_t size)\n{\n\tif (unlikely(qlist_empty(q)))\n\t\tq->head = qlink;\n\telse\n\t\tq->tail->next = qlink;\n\tq->tail = qlink;\n\tqlink->next = NULL;\n\tq->bytes += size;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_put(struct qlist_head *q, struct qlist_node *qlink,\n\t\tsize_t size)\n{\n\tif (unlikely(qlist_empty(q)))\n\t\tq->head = qlink;\n\telse\n\t\tq->tail->next = qlink;\n\tq->tail = qlink;\n\tqlink->next = NULL;\n\tq->bytes += size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qlink_to_cache",
          "args": [
            "curr"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "qlink_to_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "125-128",
          "snippet": "static struct kmem_cache *qlink_to_cache(struct qlist_node *qlink)\n{\n\treturn virt_to_head_page(qlink)->slab_cache;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic struct kmem_cache *qlink_to_cache(struct qlist_node *qlink)\n{\n\treturn virt_to_head_page(qlink)->slab_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qlist_init",
          "args": [
            "from"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "54-58",
          "snippet": "static void qlist_init(struct qlist_head *q)\n{\n\tq->head = q->tail = NULL;\n\tq->bytes = 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_init(struct qlist_head *q)\n{\n\tq->head = q->tail = NULL;\n\tq->bytes = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "qlist_empty(from)"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_empty",
          "args": [
            "from"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "49-52",
          "snippet": "static bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_move_cache(struct qlist_head *from,\n\t\t\t\t   struct qlist_head *to,\n\t\t\t\t   struct kmem_cache *cache)\n{\n\tstruct qlist_node *curr;\n\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tcurr = from->head;\n\tqlist_init(from);\n\twhile (curr) {\n\t\tstruct qlist_node *next = curr->next;\n\t\tstruct kmem_cache *obj_cache = qlink_to_cache(curr);\n\n\t\tif (obj_cache == cache)\n\t\t\tqlist_put(to, curr, obj_cache->size);\n\t\telse\n\t\t\tqlist_put(from, curr, obj_cache->size);\n\n\t\tcurr = next;\n\t}\n}"
  },
  {
    "function_name": "quarantine_reduce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "212-261",
    "snippet": "void quarantine_reduce(void)\n{\n\tsize_t total_size, new_quarantine_size, percpu_quarantines;\n\tunsigned long flags;\n\tint srcu_idx;\n\tstruct qlist_head to_free = QLIST_INIT;\n\n\tif (likely(READ_ONCE(quarantine_size) <=\n\t\t   READ_ONCE(quarantine_max_size)))\n\t\treturn;\n\n\t/*\n\t * srcu critical section ensures that quarantine_remove_cache()\n\t * will not miss objects belonging to the cache while they are in our\n\t * local to_free list. srcu is chosen because (1) it gives us private\n\t * grace period domain that does not interfere with anything else,\n\t * and (2) it allows synchronize_srcu() to return without waiting\n\t * if there are no pending read critical sections (which is the\n\t * expected case).\n\t */\n\tsrcu_idx = srcu_read_lock(&remove_cache_srcu);\n\traw_spin_lock_irqsave(&quarantine_lock, flags);\n\n\t/*\n\t * Update quarantine size in case of hotplug. Allocate a fraction of\n\t * the installed memory to quarantine minus per-cpu queue limits.\n\t */\n\ttotal_size = (READ_ONCE(totalram_pages) << PAGE_SHIFT) /\n\t\tQUARANTINE_FRACTION;\n\tpercpu_quarantines = QUARANTINE_PERCPU_SIZE * num_online_cpus();\n\tnew_quarantine_size = (total_size < percpu_quarantines) ?\n\t\t0 : total_size - percpu_quarantines;\n\tWRITE_ONCE(quarantine_max_size, new_quarantine_size);\n\t/* Aim at consuming at most 1/2 of slots in quarantine. */\n\tWRITE_ONCE(quarantine_batch_size, max((size_t)QUARANTINE_PERCPU_SIZE,\n\t\t2 * total_size / QUARANTINE_BATCHES));\n\n\tif (likely(quarantine_size > quarantine_max_size)) {\n\t\tqlist_move_all(&global_quarantine[quarantine_head], &to_free);\n\t\tWRITE_ONCE(quarantine_size, quarantine_size - to_free.bytes);\n\t\tquarantine_head++;\n\t\tif (quarantine_head == QUARANTINE_BATCHES)\n\t\t\tquarantine_head = 0;\n\t}\n\n\traw_spin_unlock_irqrestore(&quarantine_lock, flags);\n\n\tqlist_free_all(&to_free, NULL);\n\tsrcu_read_unlock(&remove_cache_srcu, srcu_idx);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [
      "#define QUARANTINE_FRACTION 32",
      "#define QUARANTINE_BATCHES \\\n\t(1024 > 4 * CONFIG_NR_CPUS ? 1024 : 4 * CONFIG_NR_CPUS)",
      "#define QUARANTINE_PERCPU_SIZE (1 << 20)",
      "#define QLIST_INIT { NULL, NULL, 0 }"
    ],
    "globals_used": [
      "static struct qlist_head global_quarantine[QUARANTINE_BATCHES];",
      "static int quarantine_head;",
      "static unsigned long quarantine_size;",
      "static DEFINE_RAW_SPINLOCK(quarantine_lock);",
      "static unsigned long quarantine_max_size;",
      "static unsigned long quarantine_batch_size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "srcu_read_unlock",
          "args": [
            "&remove_cache_srcu",
            "srcu_idx"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_free_all",
          "args": [
            "&to_free",
            "NULL"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_free_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "153-170",
          "snippet": "static void qlist_free_all(struct qlist_head *q, struct kmem_cache *cache)\n{\n\tstruct qlist_node *qlink;\n\n\tif (unlikely(qlist_empty(q)))\n\t\treturn;\n\n\tqlink = q->head;\n\twhile (qlink) {\n\t\tstruct kmem_cache *obj_cache =\n\t\t\tcache ? cache :\tqlink_to_cache(qlink);\n\t\tstruct qlist_node *next = qlink->next;\n\n\t\tqlink_free(qlink, obj_cache);\n\t\tqlink = next;\n\t}\n\tqlist_init(q);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_free_all(struct qlist_head *q, struct kmem_cache *cache)\n{\n\tstruct qlist_node *qlink;\n\n\tif (unlikely(qlist_empty(q)))\n\t\treturn;\n\n\tqlink = q->head;\n\twhile (qlink) {\n\t\tstruct kmem_cache *obj_cache =\n\t\t\tcache ? cache :\tqlink_to_cache(qlink);\n\t\tstruct qlist_node *next = qlink->next;\n\n\t\tqlink_free(qlink, obj_cache);\n\t\tqlink = next;\n\t}\n\tqlist_init(q);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&quarantine_lock",
            "flags"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "quarantine_size",
            "quarantine_size - to_free.bytes"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_move_all",
          "args": [
            "&global_quarantine[quarantine_head]",
            "&to_free"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_move_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "72-88",
          "snippet": "static void qlist_move_all(struct qlist_head *from, struct qlist_head *to)\n{\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tif (qlist_empty(to)) {\n\t\t*to = *from;\n\t\tqlist_init(from);\n\t\treturn;\n\t}\n\n\tto->tail->next = from->head;\n\tto->tail = from->tail;\n\tto->bytes += from->bytes;\n\n\tqlist_init(from);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_move_all(struct qlist_head *from, struct qlist_head *to)\n{\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tif (qlist_empty(to)) {\n\t\t*to = *from;\n\t\tqlist_init(from);\n\t\treturn;\n\t}\n\n\tto->tail->next = from->head;\n\tto->tail = from->tail;\n\tto->bytes += from->bytes;\n\n\tqlist_init(from);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "quarantine_size > quarantine_max_size"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "quarantine_batch_size",
            "max((size_t)QUARANTINE_PERCPU_SIZE,\n\t\t2 * total_size / QUARANTINE_BATCHES)"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "(size_t)QUARANTINE_PERCPU_SIZE",
            "2 * total_size / QUARANTINE_BATCHES"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "wb_max_pause",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "1418-1435",
          "snippet": "static unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_PAUSE\t\tmax(HZ/5, 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define MAX_PAUSE\t\tmax(HZ/5, 1)\n\nstatic unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "quarantine_max_size",
            "new_quarantine_size"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "num_online_cpus",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "totalram_pages"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&quarantine_lock",
            "flags"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "srcu_read_lock",
          "args": [
            "&remove_cache_srcu"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "READ_ONCE(quarantine_size) <=\n\t\t   READ_ONCE(quarantine_max_size)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "quarantine_max_size"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "quarantine_size"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\n#define QUARANTINE_FRACTION 32\n#define QUARANTINE_BATCHES \\\n\t(1024 > 4 * CONFIG_NR_CPUS ? 1024 : 4 * CONFIG_NR_CPUS)\n#define QUARANTINE_PERCPU_SIZE (1 << 20)\n#define QLIST_INIT { NULL, NULL, 0 }\n\nstatic struct qlist_head global_quarantine[QUARANTINE_BATCHES];\nstatic int quarantine_head;\nstatic unsigned long quarantine_size;\nstatic DEFINE_RAW_SPINLOCK(quarantine_lock);\nstatic unsigned long quarantine_max_size;\nstatic unsigned long quarantine_batch_size;\n\nvoid quarantine_reduce(void)\n{\n\tsize_t total_size, new_quarantine_size, percpu_quarantines;\n\tunsigned long flags;\n\tint srcu_idx;\n\tstruct qlist_head to_free = QLIST_INIT;\n\n\tif (likely(READ_ONCE(quarantine_size) <=\n\t\t   READ_ONCE(quarantine_max_size)))\n\t\treturn;\n\n\t/*\n\t * srcu critical section ensures that quarantine_remove_cache()\n\t * will not miss objects belonging to the cache while they are in our\n\t * local to_free list. srcu is chosen because (1) it gives us private\n\t * grace period domain that does not interfere with anything else,\n\t * and (2) it allows synchronize_srcu() to return without waiting\n\t * if there are no pending read critical sections (which is the\n\t * expected case).\n\t */\n\tsrcu_idx = srcu_read_lock(&remove_cache_srcu);\n\traw_spin_lock_irqsave(&quarantine_lock, flags);\n\n\t/*\n\t * Update quarantine size in case of hotplug. Allocate a fraction of\n\t * the installed memory to quarantine minus per-cpu queue limits.\n\t */\n\ttotal_size = (READ_ONCE(totalram_pages) << PAGE_SHIFT) /\n\t\tQUARANTINE_FRACTION;\n\tpercpu_quarantines = QUARANTINE_PERCPU_SIZE * num_online_cpus();\n\tnew_quarantine_size = (total_size < percpu_quarantines) ?\n\t\t0 : total_size - percpu_quarantines;\n\tWRITE_ONCE(quarantine_max_size, new_quarantine_size);\n\t/* Aim at consuming at most 1/2 of slots in quarantine. */\n\tWRITE_ONCE(quarantine_batch_size, max((size_t)QUARANTINE_PERCPU_SIZE,\n\t\t2 * total_size / QUARANTINE_BATCHES));\n\n\tif (likely(quarantine_size > quarantine_max_size)) {\n\t\tqlist_move_all(&global_quarantine[quarantine_head], &to_free);\n\t\tWRITE_ONCE(quarantine_size, quarantine_size - to_free.bytes);\n\t\tquarantine_head++;\n\t\tif (quarantine_head == QUARANTINE_BATCHES)\n\t\t\tquarantine_head = 0;\n\t}\n\n\traw_spin_unlock_irqrestore(&quarantine_lock, flags);\n\n\tqlist_free_all(&to_free, NULL);\n\tsrcu_read_unlock(&remove_cache_srcu, srcu_idx);\n}"
  },
  {
    "function_name": "quarantine_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "172-210",
    "snippet": "void quarantine_put(struct kasan_free_meta *info, struct kmem_cache *cache)\n{\n\tunsigned long flags;\n\tstruct qlist_head *q;\n\tstruct qlist_head temp = QLIST_INIT;\n\n\t/*\n\t * Note: irq must be disabled until after we move the batch to the\n\t * global quarantine. Otherwise quarantine_remove_cache() can miss\n\t * some objects belonging to the cache if they are in our local temp\n\t * list. quarantine_remove_cache() executes on_each_cpu() at the\n\t * beginning which ensures that it either sees the objects in per-cpu\n\t * lists or in the global quarantine.\n\t */\n\tlocal_irq_save(flags);\n\n\tq = this_cpu_ptr(&cpu_quarantine);\n\tqlist_put(q, &info->quarantine_link, cache->size);\n\tif (unlikely(q->bytes > QUARANTINE_PERCPU_SIZE)) {\n\t\tqlist_move_all(q, &temp);\n\n\t\traw_spin_lock(&quarantine_lock);\n\t\tWRITE_ONCE(quarantine_size, quarantine_size + temp.bytes);\n\t\tqlist_move_all(&temp, &global_quarantine[quarantine_tail]);\n\t\tif (global_quarantine[quarantine_tail].bytes >=\n\t\t\t\tREAD_ONCE(quarantine_batch_size)) {\n\t\t\tint new_tail;\n\n\t\t\tnew_tail = quarantine_tail + 1;\n\t\t\tif (new_tail == QUARANTINE_BATCHES)\n\t\t\t\tnew_tail = 0;\n\t\t\tif (new_tail != quarantine_head)\n\t\t\t\tquarantine_tail = new_tail;\n\t\t}\n\t\traw_spin_unlock(&quarantine_lock);\n\t}\n\n\tlocal_irq_restore(flags);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [
      "#define QUARANTINE_BATCHES \\\n\t(1024 > 4 * CONFIG_NR_CPUS ? 1024 : 4 * CONFIG_NR_CPUS)",
      "#define QUARANTINE_PERCPU_SIZE (1 << 20)",
      "#define QLIST_INIT { NULL, NULL, 0 }"
    ],
    "globals_used": [
      "static DEFINE_PER_CPU(struct qlist_head, cpu_quarantine);",
      "static struct qlist_head global_quarantine[QUARANTINE_BATCHES];",
      "static int quarantine_head;",
      "static int quarantine_tail;",
      "static unsigned long quarantine_size;",
      "static DEFINE_RAW_SPINLOCK(quarantine_lock);",
      "static unsigned long quarantine_batch_size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock",
          "args": [
            "&quarantine_lock"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "quarantine_batch_size"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_move_all",
          "args": [
            "&temp",
            "&global_quarantine[quarantine_tail]"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_move_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "72-88",
          "snippet": "static void qlist_move_all(struct qlist_head *from, struct qlist_head *to)\n{\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tif (qlist_empty(to)) {\n\t\t*to = *from;\n\t\tqlist_init(from);\n\t\treturn;\n\t}\n\n\tto->tail->next = from->head;\n\tto->tail = from->tail;\n\tto->bytes += from->bytes;\n\n\tqlist_init(from);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_move_all(struct qlist_head *from, struct qlist_head *to)\n{\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tif (qlist_empty(to)) {\n\t\t*to = *from;\n\t\tqlist_init(from);\n\t\treturn;\n\t}\n\n\tto->tail->next = from->head;\n\tto->tail = from->tail;\n\tto->bytes += from->bytes;\n\n\tqlist_init(from);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "quarantine_size",
            "quarantine_size + temp.bytes"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock",
          "args": [
            "&quarantine_lock"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "q->bytes > QUARANTINE_PERCPU_SIZE"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_put",
          "args": [
            "q",
            "&info->quarantine_link",
            "cache->size"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "60-70",
          "snippet": "static void qlist_put(struct qlist_head *q, struct qlist_node *qlink,\n\t\tsize_t size)\n{\n\tif (unlikely(qlist_empty(q)))\n\t\tq->head = qlink;\n\telse\n\t\tq->tail->next = qlink;\n\tq->tail = qlink;\n\tqlink->next = NULL;\n\tq->bytes += size;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_put(struct qlist_head *q, struct qlist_node *qlink,\n\t\tsize_t size)\n{\n\tif (unlikely(qlist_empty(q)))\n\t\tq->head = qlink;\n\telse\n\t\tq->tail->next = qlink;\n\tq->tail = qlink;\n\tqlink->next = NULL;\n\tq->bytes += size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&cpu_quarantine"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\n#define QUARANTINE_BATCHES \\\n\t(1024 > 4 * CONFIG_NR_CPUS ? 1024 : 4 * CONFIG_NR_CPUS)\n#define QUARANTINE_PERCPU_SIZE (1 << 20)\n#define QLIST_INIT { NULL, NULL, 0 }\n\nstatic DEFINE_PER_CPU(struct qlist_head, cpu_quarantine);\nstatic struct qlist_head global_quarantine[QUARANTINE_BATCHES];\nstatic int quarantine_head;\nstatic int quarantine_tail;\nstatic unsigned long quarantine_size;\nstatic DEFINE_RAW_SPINLOCK(quarantine_lock);\nstatic unsigned long quarantine_batch_size;\n\nvoid quarantine_put(struct kasan_free_meta *info, struct kmem_cache *cache)\n{\n\tunsigned long flags;\n\tstruct qlist_head *q;\n\tstruct qlist_head temp = QLIST_INIT;\n\n\t/*\n\t * Note: irq must be disabled until after we move the batch to the\n\t * global quarantine. Otherwise quarantine_remove_cache() can miss\n\t * some objects belonging to the cache if they are in our local temp\n\t * list. quarantine_remove_cache() executes on_each_cpu() at the\n\t * beginning which ensures that it either sees the objects in per-cpu\n\t * lists or in the global quarantine.\n\t */\n\tlocal_irq_save(flags);\n\n\tq = this_cpu_ptr(&cpu_quarantine);\n\tqlist_put(q, &info->quarantine_link, cache->size);\n\tif (unlikely(q->bytes > QUARANTINE_PERCPU_SIZE)) {\n\t\tqlist_move_all(q, &temp);\n\n\t\traw_spin_lock(&quarantine_lock);\n\t\tWRITE_ONCE(quarantine_size, quarantine_size + temp.bytes);\n\t\tqlist_move_all(&temp, &global_quarantine[quarantine_tail]);\n\t\tif (global_quarantine[quarantine_tail].bytes >=\n\t\t\t\tREAD_ONCE(quarantine_batch_size)) {\n\t\t\tint new_tail;\n\n\t\t\tnew_tail = quarantine_tail + 1;\n\t\t\tif (new_tail == QUARANTINE_BATCHES)\n\t\t\t\tnew_tail = 0;\n\t\t\tif (new_tail != quarantine_head)\n\t\t\t\tquarantine_tail = new_tail;\n\t\t}\n\t\traw_spin_unlock(&quarantine_lock);\n\t}\n\n\tlocal_irq_restore(flags);\n}"
  },
  {
    "function_name": "qlist_free_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "153-170",
    "snippet": "static void qlist_free_all(struct qlist_head *q, struct kmem_cache *cache)\n{\n\tstruct qlist_node *qlink;\n\n\tif (unlikely(qlist_empty(q)))\n\t\treturn;\n\n\tqlink = q->head;\n\twhile (qlink) {\n\t\tstruct kmem_cache *obj_cache =\n\t\t\tcache ? cache :\tqlink_to_cache(qlink);\n\t\tstruct qlist_node *next = qlink->next;\n\n\t\tqlink_free(qlink, obj_cache);\n\t\tqlink = next;\n\t}\n\tqlist_init(q);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qlist_init",
          "args": [
            "q"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "54-58",
          "snippet": "static void qlist_init(struct qlist_head *q)\n{\n\tq->head = q->tail = NULL;\n\tq->bytes = 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_init(struct qlist_head *q)\n{\n\tq->head = q->tail = NULL;\n\tq->bytes = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qlink_free",
          "args": [
            "qlink",
            "obj_cache"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "qlink_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "139-151",
          "snippet": "static void qlink_free(struct qlist_node *qlink, struct kmem_cache *cache)\n{\n\tvoid *object = qlink_to_object(qlink, cache);\n\tunsigned long flags;\n\n\tif (IS_ENABLED(CONFIG_SLAB))\n\t\tlocal_irq_save(flags);\n\n\t___cache_free(cache, object, _THIS_IP_);\n\n\tif (IS_ENABLED(CONFIG_SLAB))\n\t\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlink_free(struct qlist_node *qlink, struct kmem_cache *cache)\n{\n\tvoid *object = qlink_to_object(qlink, cache);\n\tunsigned long flags;\n\n\tif (IS_ENABLED(CONFIG_SLAB))\n\t\tlocal_irq_save(flags);\n\n\t___cache_free(cache, object, _THIS_IP_);\n\n\tif (IS_ENABLED(CONFIG_SLAB))\n\t\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qlink_to_cache",
          "args": [
            "qlink"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "qlink_to_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "125-128",
          "snippet": "static struct kmem_cache *qlink_to_cache(struct qlist_node *qlink)\n{\n\treturn virt_to_head_page(qlink)->slab_cache;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic struct kmem_cache *qlink_to_cache(struct qlist_node *qlink)\n{\n\treturn virt_to_head_page(qlink)->slab_cache;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "qlist_empty(q)"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_empty",
          "args": [
            "q"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "49-52",
          "snippet": "static bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_free_all(struct qlist_head *q, struct kmem_cache *cache)\n{\n\tstruct qlist_node *qlink;\n\n\tif (unlikely(qlist_empty(q)))\n\t\treturn;\n\n\tqlink = q->head;\n\twhile (qlink) {\n\t\tstruct kmem_cache *obj_cache =\n\t\t\tcache ? cache :\tqlink_to_cache(qlink);\n\t\tstruct qlist_node *next = qlink->next;\n\n\t\tqlink_free(qlink, obj_cache);\n\t\tqlink = next;\n\t}\n\tqlist_init(q);\n}"
  },
  {
    "function_name": "qlink_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "139-151",
    "snippet": "static void qlink_free(struct qlist_node *qlink, struct kmem_cache *cache)\n{\n\tvoid *object = qlink_to_object(qlink, cache);\n\tunsigned long flags;\n\n\tif (IS_ENABLED(CONFIG_SLAB))\n\t\tlocal_irq_save(flags);\n\n\t___cache_free(cache, object, _THIS_IP_);\n\n\tif (IS_ENABLED(CONFIG_SLAB))\n\t\tlocal_irq_restore(flags);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_SLAB"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___cache_free",
          "args": [
            "cache",
            "object",
            "_THIS_IP_"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "___cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3504-3540",
          "snippet": "void ___cache_free(struct kmem_cache *cachep, void *objp,\n\t\tunsigned long caller)\n{\n\tstruct array_cache *ac = cpu_cache_get(cachep);\n\n\tcheck_irq_off();\n\tkmemleak_free_recursive(objp, cachep->flags);\n\tobjp = cache_free_debugcheck(cachep, objp, caller);\n\n\t/*\n\t * Skip calling cache_free_alien() when the platform is not numa.\n\t * This will avoid cache misses that happen while accessing slabp (which\n\t * is per page memory  reference) to get nodeid. Instead use a global\n\t * variable to skip the call, which is mostly likely to be present in\n\t * the cache.\n\t */\n\tif (nr_online_nodes > 1 && cache_free_alien(cachep, objp))\n\t\treturn;\n\n\tif (ac->avail < ac->limit) {\n\t\tSTATS_INC_FREEHIT(cachep);\n\t} else {\n\t\tSTATS_INC_FREEMISS(cachep);\n\t\tcache_flusharray(cachep, ac);\n\t}\n\n\tif (sk_memalloc_socks()) {\n\t\tstruct page *page = virt_to_head_page(objp);\n\n\t\tif (unlikely(PageSlabPfmemalloc(page))) {\n\t\t\tcache_free_pfmemalloc(cachep, page, objp);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tac->entry[ac->avail++] = objp;\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid ___cache_free(struct kmem_cache *cachep, void *objp,\n\t\tunsigned long caller)\n{\n\tstruct array_cache *ac = cpu_cache_get(cachep);\n\n\tcheck_irq_off();\n\tkmemleak_free_recursive(objp, cachep->flags);\n\tobjp = cache_free_debugcheck(cachep, objp, caller);\n\n\t/*\n\t * Skip calling cache_free_alien() when the platform is not numa.\n\t * This will avoid cache misses that happen while accessing slabp (which\n\t * is per page memory  reference) to get nodeid. Instead use a global\n\t * variable to skip the call, which is mostly likely to be present in\n\t * the cache.\n\t */\n\tif (nr_online_nodes > 1 && cache_free_alien(cachep, objp))\n\t\treturn;\n\n\tif (ac->avail < ac->limit) {\n\t\tSTATS_INC_FREEHIT(cachep);\n\t} else {\n\t\tSTATS_INC_FREEMISS(cachep);\n\t\tcache_flusharray(cachep, ac);\n\t}\n\n\tif (sk_memalloc_socks()) {\n\t\tstruct page *page = virt_to_head_page(objp);\n\n\t\tif (unlikely(PageSlabPfmemalloc(page))) {\n\t\t\tcache_free_pfmemalloc(cachep, page, objp);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tac->entry[ac->avail++] = objp;\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_SLAB"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlink_to_object",
          "args": [
            "qlink",
            "cache"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "qlink_to_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "130-137",
          "snippet": "static void *qlink_to_object(struct qlist_node *qlink, struct kmem_cache *cache)\n{\n\tstruct kasan_free_meta *free_info =\n\t\tcontainer_of(qlink, struct kasan_free_meta,\n\t\t\t     quarantine_link);\n\n\treturn ((void *)free_info) - cache->kasan_info.free_meta_offset;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void *qlink_to_object(struct qlist_node *qlink, struct kmem_cache *cache)\n{\n\tstruct kasan_free_meta *free_info =\n\t\tcontainer_of(qlink, struct kasan_free_meta,\n\t\t\t     quarantine_link);\n\n\treturn ((void *)free_info) - cache->kasan_info.free_meta_offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlink_free(struct qlist_node *qlink, struct kmem_cache *cache)\n{\n\tvoid *object = qlink_to_object(qlink, cache);\n\tunsigned long flags;\n\n\tif (IS_ENABLED(CONFIG_SLAB))\n\t\tlocal_irq_save(flags);\n\n\t___cache_free(cache, object, _THIS_IP_);\n\n\tif (IS_ENABLED(CONFIG_SLAB))\n\t\tlocal_irq_restore(flags);\n}"
  },
  {
    "function_name": "qlink_to_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "130-137",
    "snippet": "static void *qlink_to_object(struct qlist_node *qlink, struct kmem_cache *cache)\n{\n\tstruct kasan_free_meta *free_info =\n\t\tcontainer_of(qlink, struct kasan_free_meta,\n\t\t\t     quarantine_link);\n\n\treturn ((void *)free_info) - cache->kasan_info.free_meta_offset;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "qlink",
            "structkasan_free_meta",
            "quarantine_link"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void *qlink_to_object(struct qlist_node *qlink, struct kmem_cache *cache)\n{\n\tstruct kasan_free_meta *free_info =\n\t\tcontainer_of(qlink, struct kasan_free_meta,\n\t\t\t     quarantine_link);\n\n\treturn ((void *)free_info) - cache->kasan_info.free_meta_offset;\n}"
  },
  {
    "function_name": "qlink_to_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "125-128",
    "snippet": "static struct kmem_cache *qlink_to_cache(struct qlist_node *qlink)\n{\n\treturn virt_to_head_page(qlink)->slab_cache;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_head_page",
          "args": [
            "qlink"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic struct kmem_cache *qlink_to_cache(struct qlist_node *qlink)\n{\n\treturn virt_to_head_page(qlink)->slab_cache;\n}"
  },
  {
    "function_name": "qlist_move_all",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "72-88",
    "snippet": "static void qlist_move_all(struct qlist_head *from, struct qlist_head *to)\n{\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tif (qlist_empty(to)) {\n\t\t*to = *from;\n\t\tqlist_init(from);\n\t\treturn;\n\t}\n\n\tto->tail->next = from->head;\n\tto->tail = from->tail;\n\tto->bytes += from->bytes;\n\n\tqlist_init(from);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qlist_init",
          "args": [
            "from"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "54-58",
          "snippet": "static void qlist_init(struct qlist_head *q)\n{\n\tq->head = q->tail = NULL;\n\tq->bytes = 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_init(struct qlist_head *q)\n{\n\tq->head = q->tail = NULL;\n\tq->bytes = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qlist_empty",
          "args": [
            "to"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "49-52",
          "snippet": "static bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "qlist_empty(from)"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_move_all(struct qlist_head *from, struct qlist_head *to)\n{\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tif (qlist_empty(to)) {\n\t\t*to = *from;\n\t\tqlist_init(from);\n\t\treturn;\n\t}\n\n\tto->tail->next = from->head;\n\tto->tail = from->tail;\n\tto->bytes += from->bytes;\n\n\tqlist_init(from);\n}"
  },
  {
    "function_name": "qlist_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "60-70",
    "snippet": "static void qlist_put(struct qlist_head *q, struct qlist_node *qlink,\n\t\tsize_t size)\n{\n\tif (unlikely(qlist_empty(q)))\n\t\tq->head = qlink;\n\telse\n\t\tq->tail->next = qlink;\n\tq->tail = qlink;\n\tqlink->next = NULL;\n\tq->bytes += size;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "qlist_empty(q)"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qlist_empty",
          "args": [
            "q"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "49-52",
          "snippet": "static bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_put(struct qlist_head *q, struct qlist_node *qlink,\n\t\tsize_t size)\n{\n\tif (unlikely(qlist_empty(q)))\n\t\tq->head = qlink;\n\telse\n\t\tq->tail->next = qlink;\n\tq->tail = qlink;\n\tqlink->next = NULL;\n\tq->bytes += size;\n}"
  },
  {
    "function_name": "qlist_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "54-58",
    "snippet": "static void qlist_init(struct qlist_head *q)\n{\n\tq->head = q->tail = NULL;\n\tq->bytes = 0;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_init(struct qlist_head *q)\n{\n\tq->head = q->tail = NULL;\n\tq->bytes = 0;\n}"
  },
  {
    "function_name": "qlist_empty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
    "lines": "49-52",
    "snippet": "static bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include \"../slab.h\"",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/srcu.h>",
      "#include <linux/slab.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/printk.h>",
      "#include <linux/percpu.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/hash.h>",
      "#include <linux/gfp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic bool qlist_empty(struct qlist_head *q)\n{\n\treturn !q->head;\n}"
  }
]