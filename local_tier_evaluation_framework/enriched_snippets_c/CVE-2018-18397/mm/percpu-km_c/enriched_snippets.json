[
  {
    "function_name": "pcpu_verify_alloc_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-km.c",
    "lines": "101-119",
    "snippet": "static int __init pcpu_verify_alloc_info(const struct pcpu_alloc_info *ai)\n{\n\tsize_t nr_pages, alloc_pages;\n\n\t/* all units must be in a single group */\n\tif (ai->nr_groups != 1) {\n\t\tpr_crit(\"can't handle more than one group\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tnr_pages = (ai->groups[0].nr_units * ai->unit_size) >> PAGE_SHIFT;\n\talloc_pages = roundup_pow_of_two(nr_pages);\n\n\tif (alloc_pages > nr_pages)\n\t\tpr_warn(\"wasting %zu pages per chunk\\n\",\n\t\t\talloc_pages - nr_pages);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/log2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"wasting %zu pages per chunk\\n\"",
            "alloc_pages - nr_pages"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundup_pow_of_two",
          "args": [
            "nr_pages"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_crit",
          "args": [
            "\"can't handle more than one group\\n\""
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n\nstatic int __init pcpu_verify_alloc_info(const struct pcpu_alloc_info *ai)\n{\n\tsize_t nr_pages, alloc_pages;\n\n\t/* all units must be in a single group */\n\tif (ai->nr_groups != 1) {\n\t\tpr_crit(\"can't handle more than one group\\n\");\n\t\treturn -EINVAL;\n\t}\n\n\tnr_pages = (ai->groups[0].nr_units * ai->unit_size) >> PAGE_SHIFT;\n\talloc_pages = roundup_pow_of_two(nr_pages);\n\n\tif (alloc_pages > nr_pages)\n\t\tpr_warn(\"wasting %zu pages per chunk\\n\",\n\t\t\talloc_pages - nr_pages);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "pcpu_addr_to_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-km.c",
    "lines": "96-99",
    "snippet": "static struct page *pcpu_addr_to_page(void *addr)\n{\n\treturn virt_to_page(addr);\n}",
    "includes": [
      "#include <linux/log2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "addr"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n\nstatic struct page *pcpu_addr_to_page(void *addr)\n{\n\treturn virt_to_page(addr);\n}"
  },
  {
    "function_name": "pcpu_destroy_chunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-km.c",
    "lines": "81-94",
    "snippet": "static void pcpu_destroy_chunk(struct pcpu_chunk *chunk)\n{\n\tconst int nr_pages = pcpu_group_sizes[0] >> PAGE_SHIFT;\n\n\tif (!chunk)\n\t\treturn;\n\n\tpcpu_stats_chunk_dealloc();\n\ttrace_percpu_destroy_chunk(chunk->base_addr);\n\n\tif (chunk->data)\n\t\t__free_pages(chunk->data, order_base_2(nr_pages));\n\tpcpu_free_chunk(chunk);\n}",
    "includes": [
      "#include <linux/log2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pcpu_free_chunk",
          "args": [
            "chunk"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_free_chunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "1211-1219",
          "snippet": "static void pcpu_free_chunk(struct pcpu_chunk *chunk)\n{\n\tif (!chunk)\n\t\treturn;\n\tpcpu_mem_free(chunk->md_blocks);\n\tpcpu_mem_free(chunk->bound_map);\n\tpcpu_mem_free(chunk->alloc_map);\n\tpcpu_mem_free(chunk);\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void pcpu_destroy_chunk(struct pcpu_chunk *chunk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic void pcpu_destroy_chunk(struct pcpu_chunk *chunk);\n\nstatic void pcpu_free_chunk(struct pcpu_chunk *chunk)\n{\n\tif (!chunk)\n\t\treturn;\n\tpcpu_mem_free(chunk->md_blocks);\n\tpcpu_mem_free(chunk->bound_map);\n\tpcpu_mem_free(chunk->alloc_map);\n\tpcpu_mem_free(chunk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__free_pages",
          "args": [
            "chunk->data",
            "order_base_2(nr_pages)"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "__free_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "4430-4438",
          "snippet": "void __free_pages(struct page *page, unsigned int order)\n{\n\tif (put_page_testzero(page)) {\n\t\tif (order == 0)\n\t\t\tfree_unref_page(page);\n\t\telse\n\t\t\t__free_pages_ok(page, order);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __free_pages_ok(struct page *page, unsigned int order);",
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void __free_pages_ok(struct page *page, unsigned int order);\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nvoid __free_pages(struct page *page, unsigned int order)\n{\n\tif (put_page_testzero(page)) {\n\t\tif (order == 0)\n\t\t\tfree_unref_page(page);\n\t\telse\n\t\t\t__free_pages_ok(page, order);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "order_base_2",
          "args": [
            "nr_pages"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_percpu_destroy_chunk",
          "args": [
            "chunk->base_addr"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcpu_stats_chunk_dealloc",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_stats_chunk_dealloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
          "lines": "219-221",
          "snippet": "static inline void pcpu_stats_chunk_dealloc(void)\n{\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_chunk_dealloc(void)\n{\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n\nstatic void pcpu_destroy_chunk(struct pcpu_chunk *chunk)\n{\n\tconst int nr_pages = pcpu_group_sizes[0] >> PAGE_SHIFT;\n\n\tif (!chunk)\n\t\treturn;\n\n\tpcpu_stats_chunk_dealloc();\n\ttrace_percpu_destroy_chunk(chunk->base_addr);\n\n\tif (chunk->data)\n\t\t__free_pages(chunk->data, order_base_2(nr_pages));\n\tpcpu_free_chunk(chunk);\n}"
  },
  {
    "function_name": "pcpu_create_chunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-km.c",
    "lines": "48-79",
    "snippet": "static struct pcpu_chunk *pcpu_create_chunk(gfp_t gfp)\n{\n\tconst int nr_pages = pcpu_group_sizes[0] >> PAGE_SHIFT;\n\tstruct pcpu_chunk *chunk;\n\tstruct page *pages;\n\tint i;\n\n\tchunk = pcpu_alloc_chunk(gfp);\n\tif (!chunk)\n\t\treturn NULL;\n\n\tpages = alloc_pages(gfp, order_base_2(nr_pages));\n\tif (!pages) {\n\t\tpcpu_free_chunk(chunk);\n\t\treturn NULL;\n\t}\n\n\tfor (i = 0; i < nr_pages; i++)\n\t\tpcpu_set_page_chunk(nth_page(pages, i), chunk);\n\n\tchunk->data = pages;\n\tchunk->base_addr = page_address(pages) - pcpu_group_offsets[0];\n\n\tspin_lock_irq(&pcpu_lock);\n\tpcpu_chunk_populated(chunk, 0, nr_pages, false);\n\tspin_unlock_irq(&pcpu_lock);\n\n\tpcpu_stats_chunk_alloc();\n\ttrace_percpu_create_chunk(chunk->base_addr);\n\n\treturn chunk;\n}",
    "includes": [
      "#include <linux/log2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_percpu_create_chunk",
          "args": [
            "chunk->base_addr"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcpu_stats_chunk_alloc",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_stats_chunk_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
          "lines": "215-217",
          "snippet": "static inline void pcpu_stats_chunk_alloc(void)\n{\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_chunk_alloc(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&pcpu_lock"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcpu_chunk_populated",
          "args": [
            "chunk",
            "0",
            "nr_pages",
            "false"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_chunk_populated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "1235-1250",
          "snippet": "static void pcpu_chunk_populated(struct pcpu_chunk *chunk, int page_start,\n\t\t\t\t int page_end, bool for_alloc)\n{\n\tint nr = page_end - page_start;\n\n\tlockdep_assert_held(&pcpu_lock);\n\n\tbitmap_set(chunk->populated, page_start, nr);\n\tchunk->nr_populated += nr;\n\tpcpu_nr_populated += nr;\n\n\tif (!for_alloc) {\n\t\tchunk->nr_empty_pop_pages += nr;\n\t\tpcpu_nr_empty_pop_pages += nr;\n\t}\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "int pcpu_nr_empty_pop_pages;",
            "static unsigned long pcpu_nr_populated;",
            "static void pcpu_depopulate_chunk(struct pcpu_chunk *chunk,\n\t\t\t\t  int page_start, int page_end);",
            "static void pcpu_destroy_chunk(struct pcpu_chunk *chunk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nint pcpu_nr_empty_pop_pages;\nstatic unsigned long pcpu_nr_populated;\nstatic void pcpu_depopulate_chunk(struct pcpu_chunk *chunk,\n\t\t\t\t  int page_start, int page_end);\nstatic void pcpu_destroy_chunk(struct pcpu_chunk *chunk);\n\nstatic void pcpu_chunk_populated(struct pcpu_chunk *chunk, int page_start,\n\t\t\t\t int page_end, bool for_alloc)\n{\n\tint nr = page_end - page_start;\n\n\tlockdep_assert_held(&pcpu_lock);\n\n\tbitmap_set(chunk->populated, page_start, nr);\n\tchunk->nr_populated += nr;\n\tpcpu_nr_populated += nr;\n\n\tif (!for_alloc) {\n\t\tchunk->nr_empty_pop_pages += nr;\n\t\tpcpu_nr_empty_pop_pages += nr;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&pcpu_lock"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "pages"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "page_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/highmem.c",
          "lines": "409-434",
          "snippet": "void *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/tlbflush.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/mempool.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/tlbflush.h>\n#include <linux/kgdb.h>\n#include <linux/highmem.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/mempool.h>\n#include <linux/pagemap.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pcpu_set_page_chunk",
          "args": [
            "nth_page(pages, i)",
            "chunk"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_set_page_chunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "241-244",
          "snippet": "static void pcpu_set_page_chunk(struct page *page, struct pcpu_chunk *pcpu)\n{\n\tpage->index = (unsigned long)pcpu;\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic void pcpu_set_page_chunk(struct page *page, struct pcpu_chunk *pcpu)\n{\n\tpage->index = (unsigned long)pcpu;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nth_page",
          "args": [
            "pages",
            "i"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcpu_free_chunk",
          "args": [
            "chunk"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_free_chunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "1211-1219",
          "snippet": "static void pcpu_free_chunk(struct pcpu_chunk *chunk)\n{\n\tif (!chunk)\n\t\treturn;\n\tpcpu_mem_free(chunk->md_blocks);\n\tpcpu_mem_free(chunk->bound_map);\n\tpcpu_mem_free(chunk->alloc_map);\n\tpcpu_mem_free(chunk);\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void pcpu_destroy_chunk(struct pcpu_chunk *chunk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic void pcpu_destroy_chunk(struct pcpu_chunk *chunk);\n\nstatic void pcpu_free_chunk(struct pcpu_chunk *chunk)\n{\n\tif (!chunk)\n\t\treturn;\n\tpcpu_mem_free(chunk->md_blocks);\n\tpcpu_mem_free(chunk->bound_map);\n\tpcpu_mem_free(chunk->alloc_map);\n\tpcpu_mem_free(chunk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_pages",
          "args": [
            "gfp",
            "order_base_2(nr_pages)"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_pages_exact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "4594-4601",
          "snippet": "void *alloc_pages_exact(size_t size, gfp_t gfp_mask)\n{\n\tunsigned int order = get_order(size);\n\tunsigned long addr;\n\n\taddr = __get_free_pages(gfp_mask, order);\n\treturn make_alloc_exact(addr, order, size);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __free_pages_ok(struct page *page, unsigned int order);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void __free_pages_ok(struct page *page, unsigned int order);\n\nvoid *alloc_pages_exact(size_t size, gfp_t gfp_mask)\n{\n\tunsigned int order = get_order(size);\n\tunsigned long addr;\n\n\taddr = __get_free_pages(gfp_mask, order);\n\treturn make_alloc_exact(addr, order, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "order_base_2",
          "args": [
            "nr_pages"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pcpu_alloc_chunk",
          "args": [
            "gfp"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_alloc_chunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "1165-1209",
          "snippet": "static struct pcpu_chunk *pcpu_alloc_chunk(gfp_t gfp)\n{\n\tstruct pcpu_chunk *chunk;\n\tint region_bits;\n\n\tchunk = pcpu_mem_zalloc(pcpu_chunk_struct_size, gfp);\n\tif (!chunk)\n\t\treturn NULL;\n\n\tINIT_LIST_HEAD(&chunk->list);\n\tchunk->nr_pages = pcpu_unit_pages;\n\tregion_bits = pcpu_chunk_map_bits(chunk);\n\n\tchunk->alloc_map = pcpu_mem_zalloc(BITS_TO_LONGS(region_bits) *\n\t\t\t\t\t   sizeof(chunk->alloc_map[0]), gfp);\n\tif (!chunk->alloc_map)\n\t\tgoto alloc_map_fail;\n\n\tchunk->bound_map = pcpu_mem_zalloc(BITS_TO_LONGS(region_bits + 1) *\n\t\t\t\t\t   sizeof(chunk->bound_map[0]), gfp);\n\tif (!chunk->bound_map)\n\t\tgoto bound_map_fail;\n\n\tchunk->md_blocks = pcpu_mem_zalloc(pcpu_chunk_nr_blocks(chunk) *\n\t\t\t\t\t   sizeof(chunk->md_blocks[0]), gfp);\n\tif (!chunk->md_blocks)\n\t\tgoto md_blocks_fail;\n\n\tpcpu_init_md_blocks(chunk);\n\n\t/* init metadata */\n\tchunk->contig_bits = region_bits;\n\tchunk->free_bytes = chunk->nr_pages * PAGE_SIZE;\n\n\treturn chunk;\n\nmd_blocks_fail:\n\tpcpu_mem_free(chunk->bound_map);\nbound_map_fail:\n\tpcpu_mem_free(chunk->alloc_map);\nalloc_map_fail:\n\tpcpu_mem_free(chunk);\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int pcpu_unit_pages",
            "static size_t pcpu_chunk_struct_size",
            "static int pcpu_populate_chunk(struct pcpu_chunk *chunk,\n\t\t\t       int page_start, int page_end, gfp_t gfp);",
            "static struct pcpu_chunk *pcpu_create_chunk(gfp_t gfp);",
            "static void pcpu_destroy_chunk(struct pcpu_chunk *chunk);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic int pcpu_unit_pages;\nstatic size_t pcpu_chunk_struct_size;\nstatic int pcpu_populate_chunk(struct pcpu_chunk *chunk,\n\t\t\t       int page_start, int page_end, gfp_t gfp);\nstatic struct pcpu_chunk *pcpu_create_chunk(gfp_t gfp);\nstatic void pcpu_destroy_chunk(struct pcpu_chunk *chunk);\n\nstatic struct pcpu_chunk *pcpu_alloc_chunk(gfp_t gfp)\n{\n\tstruct pcpu_chunk *chunk;\n\tint region_bits;\n\n\tchunk = pcpu_mem_zalloc(pcpu_chunk_struct_size, gfp);\n\tif (!chunk)\n\t\treturn NULL;\n\n\tINIT_LIST_HEAD(&chunk->list);\n\tchunk->nr_pages = pcpu_unit_pages;\n\tregion_bits = pcpu_chunk_map_bits(chunk);\n\n\tchunk->alloc_map = pcpu_mem_zalloc(BITS_TO_LONGS(region_bits) *\n\t\t\t\t\t   sizeof(chunk->alloc_map[0]), gfp);\n\tif (!chunk->alloc_map)\n\t\tgoto alloc_map_fail;\n\n\tchunk->bound_map = pcpu_mem_zalloc(BITS_TO_LONGS(region_bits + 1) *\n\t\t\t\t\t   sizeof(chunk->bound_map[0]), gfp);\n\tif (!chunk->bound_map)\n\t\tgoto bound_map_fail;\n\n\tchunk->md_blocks = pcpu_mem_zalloc(pcpu_chunk_nr_blocks(chunk) *\n\t\t\t\t\t   sizeof(chunk->md_blocks[0]), gfp);\n\tif (!chunk->md_blocks)\n\t\tgoto md_blocks_fail;\n\n\tpcpu_init_md_blocks(chunk);\n\n\t/* init metadata */\n\tchunk->contig_bits = region_bits;\n\tchunk->free_bytes = chunk->nr_pages * PAGE_SIZE;\n\n\treturn chunk;\n\nmd_blocks_fail:\n\tpcpu_mem_free(chunk->bound_map);\nbound_map_fail:\n\tpcpu_mem_free(chunk->alloc_map);\nalloc_map_fail:\n\tpcpu_mem_free(chunk);\n\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/log2.h>\n\nstatic struct pcpu_chunk *pcpu_create_chunk(gfp_t gfp)\n{\n\tconst int nr_pages = pcpu_group_sizes[0] >> PAGE_SHIFT;\n\tstruct pcpu_chunk *chunk;\n\tstruct page *pages;\n\tint i;\n\n\tchunk = pcpu_alloc_chunk(gfp);\n\tif (!chunk)\n\t\treturn NULL;\n\n\tpages = alloc_pages(gfp, order_base_2(nr_pages));\n\tif (!pages) {\n\t\tpcpu_free_chunk(chunk);\n\t\treturn NULL;\n\t}\n\n\tfor (i = 0; i < nr_pages; i++)\n\t\tpcpu_set_page_chunk(nth_page(pages, i), chunk);\n\n\tchunk->data = pages;\n\tchunk->base_addr = page_address(pages) - pcpu_group_offsets[0];\n\n\tspin_lock_irq(&pcpu_lock);\n\tpcpu_chunk_populated(chunk, 0, nr_pages, false);\n\tspin_unlock_irq(&pcpu_lock);\n\n\tpcpu_stats_chunk_alloc();\n\ttrace_percpu_create_chunk(chunk->base_addr);\n\n\treturn chunk;\n}"
  },
  {
    "function_name": "pcpu_depopulate_chunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-km.c",
    "lines": "42-46",
    "snippet": "static void pcpu_depopulate_chunk(struct pcpu_chunk *chunk,\n\t\t\t\t  int page_start, int page_end)\n{\n\t/* nada */\n}",
    "includes": [
      "#include <linux/log2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/log2.h>\n\nstatic void pcpu_depopulate_chunk(struct pcpu_chunk *chunk,\n\t\t\t\t  int page_start, int page_end)\n{\n\t/* nada */\n}"
  },
  {
    "function_name": "pcpu_populate_chunk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-km.c",
    "lines": "36-40",
    "snippet": "static int pcpu_populate_chunk(struct pcpu_chunk *chunk,\n\t\t\t       int page_start, int page_end, gfp_t gfp)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <linux/log2.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/log2.h>\n\nstatic int pcpu_populate_chunk(struct pcpu_chunk *chunk,\n\t\t\t       int page_start, int page_end, gfp_t gfp)\n{\n\treturn 0;\n}"
  }
]