[
  {
    "function_name": "kmemleak_test_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kmemleak-test.c",
    "lines": "98-108",
    "snippet": "static void __exit kmemleak_test_exit(void)\n{\n\tstruct test_node *elem, *tmp;\n\n\t/*\n\t * Remove the list elements without actually freeing the\n\t * memory.\n\t */\n\tlist_for_each_entry_safe(elem, tmp, &test_list, list)\n\t\tlist_del(&elem->list);\n}",
    "includes": [
      "#include <linux/kmemleak.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/percpu.h>",
      "#include <linux/list.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(test_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&elem->list"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "elem",
            "tmp",
            "&test_list",
            "list"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kmemleak.h>\n#include <linux/fdtable.h>\n#include <linux/percpu.h>\n#include <linux/list.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nstatic LIST_HEAD(test_list);\n\nstatic void __exit kmemleak_test_exit(void)\n{\n\tstruct test_node *elem, *tmp;\n\n\t/*\n\t * Remove the list elements without actually freeing the\n\t * memory.\n\t */\n\tlist_for_each_entry_safe(elem, tmp, &test_list, list)\n\t\tlist_del(&elem->list);\n}"
  },
  {
    "function_name": "kmemleak_test_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kmemleak-test.c",
    "lines": "47-95",
    "snippet": "static int __init kmemleak_test_init(void)\n{\n\tstruct test_node *elem;\n\tint i;\n\n\tpr_info(\"Kmemleak testing\\n\");\n\n\t/* make some orphan objects */\n\tpr_info(\"kmalloc(32) = %p\\n\", kmalloc(32, GFP_KERNEL));\n\tpr_info(\"kmalloc(32) = %p\\n\", kmalloc(32, GFP_KERNEL));\n\tpr_info(\"kmalloc(1024) = %p\\n\", kmalloc(1024, GFP_KERNEL));\n\tpr_info(\"kmalloc(1024) = %p\\n\", kmalloc(1024, GFP_KERNEL));\n\tpr_info(\"kmalloc(2048) = %p\\n\", kmalloc(2048, GFP_KERNEL));\n\tpr_info(\"kmalloc(2048) = %p\\n\", kmalloc(2048, GFP_KERNEL));\n\tpr_info(\"kmalloc(4096) = %p\\n\", kmalloc(4096, GFP_KERNEL));\n\tpr_info(\"kmalloc(4096) = %p\\n\", kmalloc(4096, GFP_KERNEL));\n#ifndef CONFIG_MODULES\n\tpr_info(\"kmem_cache_alloc(files_cachep) = %p\\n\",\n\t\tkmem_cache_alloc(files_cachep, GFP_KERNEL));\n\tpr_info(\"kmem_cache_alloc(files_cachep) = %p\\n\",\n\t\tkmem_cache_alloc(files_cachep, GFP_KERNEL));\n#endif\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\n\t/*\n\t * Add elements to a list. They should only appear as orphan\n\t * after the module is removed.\n\t */\n\tfor (i = 0; i < 10; i++) {\n\t\telem = kzalloc(sizeof(*elem), GFP_KERNEL);\n\t\tpr_info(\"kzalloc(sizeof(*elem)) = %p\\n\", elem);\n\t\tif (!elem)\n\t\t\treturn -ENOMEM;\n\t\tINIT_LIST_HEAD(&elem->list);\n\t\tlist_add_tail(&elem->list, &test_list);\n\t}\n\n\tfor_each_possible_cpu(i) {\n\t\tper_cpu(kmemleak_test_pointer, i) = kmalloc(129, GFP_KERNEL);\n\t\tpr_info(\"kmalloc(129) = %p\\n\",\n\t\t\tper_cpu(kmemleak_test_pointer, i));\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/kmemleak.h>",
      "#include <linux/fdtable.h>",
      "#include <linux/percpu.h>",
      "#include <linux/list.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/slab.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(test_list);",
      "static DEFINE_PER_CPU(void *, kmemleak_test_pointer);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(129) = %p\\n\"",
            "per_cpu(kmemleak_test_pointer, i)"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "kmemleak_test_pointer",
            "i"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "129",
            "GFP_KERNEL"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "__kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3729-3732",
          "snippet": "void *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nvoid *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "kmemleak_test_pointer",
            "i"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&elem->list",
            "&test_list"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&elem->list"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kzalloc(sizeof(*elem)) = %p\\n\"",
            "elem"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*elem)",
            "GFP_KERNEL"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"vmalloc(64) = %p\\n\"",
            "vmalloc(64)"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vmalloc",
          "args": [
            "64"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "vmalloc_32_user",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/nommu.c",
          "lines": "407-414",
          "snippet": "void *vmalloc_32_user(unsigned long size)\n{\n\t/*\n\t * We'll have to sort out the ZONE_DMA bits for 64-bit,\n\t * but for now this can simply use vmalloc_user() directly.\n\t */\n\treturn vmalloc_user(size);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/mmu_context.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/printk.h>",
            "#include <linux/audit.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/mount.h>",
            "#include <linux/compiler.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/file.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/mmu_context.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <linux/printk.h>\n#include <linux/audit.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/mount.h>\n#include <linux/compiler.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/file.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/vmacache.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid *vmalloc_32_user(unsigned long size)\n{\n\t/*\n\t * We'll have to sort out the ZONE_DMA bits for 64-bit,\n\t * but for now this can simply use vmalloc_user() directly.\n\t */\n\treturn vmalloc_user(size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"vmalloc(64) = %p\\n\"",
            "vmalloc(64)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"vmalloc(64) = %p\\n\"",
            "vmalloc(64)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"vmalloc(64) = %p\\n\"",
            "vmalloc(64)"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"vmalloc(64) = %p\\n\"",
            "vmalloc(64)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmem_cache_alloc(files_cachep) = %p\\n\"",
            "kmem_cache_alloc(files_cachep, GFP_KERNEL)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "files_cachep",
            "GFP_KERNEL"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3550-3559",
          "snippet": "void *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmem_cache_alloc(files_cachep) = %p\\n\"",
            "kmem_cache_alloc(files_cachep, GFP_KERNEL)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(4096) = %p\\n\"",
            "kmalloc(4096, GFP_KERNEL)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(4096) = %p\\n\"",
            "kmalloc(4096, GFP_KERNEL)"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(2048) = %p\\n\"",
            "kmalloc(2048, GFP_KERNEL)"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(2048) = %p\\n\"",
            "kmalloc(2048, GFP_KERNEL)"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(1024) = %p\\n\"",
            "kmalloc(1024, GFP_KERNEL)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(1024) = %p\\n\"",
            "kmalloc(1024, GFP_KERNEL)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(32) = %p\\n\"",
            "kmalloc(32, GFP_KERNEL)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"kmalloc(32) = %p\\n\"",
            "kmalloc(32, GFP_KERNEL)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Kmemleak testing\\n\""
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/kmemleak.h>\n#include <linux/fdtable.h>\n#include <linux/percpu.h>\n#include <linux/list.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nstatic LIST_HEAD(test_list);\nstatic DEFINE_PER_CPU(void *, kmemleak_test_pointer);\n\nstatic int __init kmemleak_test_init(void)\n{\n\tstruct test_node *elem;\n\tint i;\n\n\tpr_info(\"Kmemleak testing\\n\");\n\n\t/* make some orphan objects */\n\tpr_info(\"kmalloc(32) = %p\\n\", kmalloc(32, GFP_KERNEL));\n\tpr_info(\"kmalloc(32) = %p\\n\", kmalloc(32, GFP_KERNEL));\n\tpr_info(\"kmalloc(1024) = %p\\n\", kmalloc(1024, GFP_KERNEL));\n\tpr_info(\"kmalloc(1024) = %p\\n\", kmalloc(1024, GFP_KERNEL));\n\tpr_info(\"kmalloc(2048) = %p\\n\", kmalloc(2048, GFP_KERNEL));\n\tpr_info(\"kmalloc(2048) = %p\\n\", kmalloc(2048, GFP_KERNEL));\n\tpr_info(\"kmalloc(4096) = %p\\n\", kmalloc(4096, GFP_KERNEL));\n\tpr_info(\"kmalloc(4096) = %p\\n\", kmalloc(4096, GFP_KERNEL));\n#ifndef CONFIG_MODULES\n\tpr_info(\"kmem_cache_alloc(files_cachep) = %p\\n\",\n\t\tkmem_cache_alloc(files_cachep, GFP_KERNEL));\n\tpr_info(\"kmem_cache_alloc(files_cachep) = %p\\n\",\n\t\tkmem_cache_alloc(files_cachep, GFP_KERNEL));\n#endif\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\tpr_info(\"vmalloc(64) = %p\\n\", vmalloc(64));\n\n\t/*\n\t * Add elements to a list. They should only appear as orphan\n\t * after the module is removed.\n\t */\n\tfor (i = 0; i < 10; i++) {\n\t\telem = kzalloc(sizeof(*elem), GFP_KERNEL);\n\t\tpr_info(\"kzalloc(sizeof(*elem)) = %p\\n\", elem);\n\t\tif (!elem)\n\t\t\treturn -ENOMEM;\n\t\tINIT_LIST_HEAD(&elem->list);\n\t\tlist_add_tail(&elem->list, &test_list);\n\t}\n\n\tfor_each_possible_cpu(i) {\n\t\tper_cpu(kmemleak_test_pointer, i) = kmalloc(129, GFP_KERNEL);\n\t\tpr_info(\"kmalloc(129) = %p\\n\",\n\t\t\tper_cpu(kmemleak_test_pointer, i));\n\t}\n\n\treturn 0;\n}"
  }
]