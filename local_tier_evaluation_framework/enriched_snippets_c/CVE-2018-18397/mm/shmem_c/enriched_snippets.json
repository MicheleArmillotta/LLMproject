[
  {
    "function_name": "shmem_read_mapping_page_gfp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3978-4000",
    "snippet": "struct page *shmem_read_mapping_page_gfp(struct address_space *mapping,\n\t\t\t\t\t pgoff_t index, gfp_t gfp)\n{\n#ifdef CONFIG_SHMEM\n\tstruct inode *inode = mapping->host;\n\tstruct page *page;\n\tint error;\n\n\tBUG_ON(mapping->a_ops != &shmem_aops);\n\terror = shmem_getpage_gfp(inode, index, &page, SGP_CACHE,\n\t\t\t\t  gfp, NULL, NULL, NULL);\n\tif (error)\n\t\tpage = ERR_PTR(error);\n\telse\n\t\tunlock_page(page);\n\treturn page;\n#else\n\t/*\n\t * The tiny !SHMEM case uses ramfs without swap\n\t */\n\treturn read_cache_page_gfp(mapping, index, gfp);\n#endif\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_cache_page_gfp",
          "args": [
            "mapping",
            "index",
            "gfp"
          ],
          "line": 3998
        },
        "resolved": true,
        "details": {
          "function_name": "read_cache_page_gfp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/filemap.c",
          "lines": "2817-2824",
          "snippet": "struct page *read_cache_page_gfp(struct address_space *mapping,\n\t\t\t\tpgoff_t index,\n\t\t\t\tgfp_t gfp)\n{\n\tfiller_t *filler = (filler_t *)mapping->a_ops->readpage;\n\n\treturn do_read_cache_page(mapping, index, filler, NULL, gfp);\n}",
          "includes": [
            "#include <asm/mman.h>",
            "#include <linux/buffer_head.h> /* for try_to_free_buffers */",
            "#include <trace/events/filemap.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/rmap.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/security.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/hash.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/capability.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/fs.h>",
            "#include <linux/dax.h>",
            "#include <linux/compiler.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/mman.h>\n#include <linux/buffer_head.h> /* for try_to_free_buffers */\n#include <trace/events/filemap.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/delayacct.h>\n#include <linux/rmap.h>\n#include <linux/shmem_fs.h>\n#include <linux/cleancache.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/cpuset.h>\n#include <linux/security.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/hash.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/capability.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/dax.h>\n#include <linux/compiler.h>\n#include <linux/export.h>\n\nstruct page *read_cache_page_gfp(struct address_space *mapping,\n\t\t\t\tpgoff_t index,\n\t\t\t\tgfp_t gfp)\n{\n\tfiller_t *filler = (filler_t *)mapping->a_ops->readpage;\n\n\treturn do_read_cache_page(mapping, index, filler, NULL, gfp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 3992
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 3990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_getpage_gfp",
          "args": [
            "inode",
            "index",
            "&page",
            "SGP_CACHE",
            "gfp",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 3987
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage_gfp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1584-1895",
          "snippet": "static int shmem_getpage_gfp(struct inode *inode, pgoff_t index,\n\tstruct page **pagep, enum sgp_type sgp, gfp_t gfp,\n\tstruct vm_area_struct *vma, struct vm_fault *vmf,\n\t\t\tvm_fault_t *fault_type)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo;\n\tstruct mm_struct *charge_mm;\n\tstruct mem_cgroup *memcg;\n\tstruct page *page;\n\tswp_entry_t swap;\n\tenum sgp_type sgp_huge = sgp;\n\tpgoff_t hindex = index;\n\tint error;\n\tint once = 0;\n\tint alloced = 0;\n\n\tif (index > (MAX_LFS_FILESIZE >> PAGE_SHIFT))\n\t\treturn -EFBIG;\n\tif (sgp == SGP_NOHUGE || sgp == SGP_HUGE)\n\t\tsgp = SGP_CACHE;\nrepeat:\n\tswap.val = 0;\n\tpage = find_lock_entry(mapping, index);\n\tif (xa_is_value(page)) {\n\t\tswap = radix_to_swp_entry(page);\n\t\tpage = NULL;\n\t}\n\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\n\tif (page && sgp == SGP_WRITE)\n\t\tmark_page_accessed(page);\n\n\t/* fallocated page? */\n\tif (page && !PageUptodate(page)) {\n\t\tif (sgp != SGP_READ)\n\t\t\tgoto clear;\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tpage = NULL;\n\t}\n\tif (page || (sgp == SGP_READ && !swap.val)) {\n\t\t*pagep = page;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Fast cache lookup did not find it:\n\t * bring it back from swap or allocate.\n\t */\n\tsbinfo = SHMEM_SB(inode->i_sb);\n\tcharge_mm = vma ? vma->vm_mm : current->mm;\n\n\tif (swap.val) {\n\t\t/* Look it up and read it in.. */\n\t\tpage = lookup_swap_cache(swap, NULL, 0);\n\t\tif (!page) {\n\t\t\t/* Or update major stats only when swapin succeeds?? */\n\t\t\tif (fault_type) {\n\t\t\t\t*fault_type |= VM_FAULT_MAJOR;\n\t\t\t\tcount_vm_event(PGMAJFAULT);\n\t\t\t\tcount_memcg_event_mm(charge_mm, PGMAJFAULT);\n\t\t\t}\n\t\t\t/* Here we actually start the io */\n\t\t\tpage = shmem_swapin(swap, gfp, info, index);\n\t\t\tif (!page) {\n\t\t\t\terror = -ENOMEM;\n\t\t\t\tgoto failed;\n\t\t\t}\n\t\t}\n\n\t\t/* We have to do this with page locked to prevent races */\n\t\tlock_page(page);\n\t\tif (!PageSwapCache(page) || page_private(page) != swap.val ||\n\t\t    !shmem_confirm_swap(mapping, index, swap)) {\n\t\t\terror = -EEXIST;\t/* try again */\n\t\t\tgoto unlock;\n\t\t}\n\t\tif (!PageUptodate(page)) {\n\t\t\terror = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t\twait_on_page_writeback(page);\n\n\t\tif (shmem_should_replace_page(page, gfp)) {\n\t\t\terror = shmem_replace_page(&page, gfp, info, index);\n\t\t\tif (error)\n\t\t\t\tgoto failed;\n\t\t}\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tfalse);\n\t\tif (!error) {\n\t\t\terror = shmem_add_to_page_cache(page, mapping, index,\n\t\t\t\t\t\tswp_to_radix_entry(swap), gfp);\n\t\t\t/*\n\t\t\t * We already confirmed swap under page lock, and make\n\t\t\t * no memory allocation here, so usually no possibility\n\t\t\t * of error; but free_swap_and_cache() only trylocks a\n\t\t\t * page, so it is just possible that the entry has been\n\t\t\t * truncated or holepunched since swap was confirmed.\n\t\t\t * shmem_undo_range() will have done some of the\n\t\t\t * unaccounting, now delete_from_swap_cache() will do\n\t\t\t * the rest.\n\t\t\t * Reset swap.val? No, leave it so \"failed\" goes back to\n\t\t\t * \"repeat\": reading a hole and writing should succeed.\n\t\t\t */\n\t\t\tif (error) {\n\t\t\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t\t\t\tdelete_from_swap_cache(page);\n\t\t\t}\n\t\t}\n\t\tif (error)\n\t\t\tgoto failed;\n\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->swapped--;\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\tmark_page_accessed(page);\n\n\t\tdelete_from_swap_cache(page);\n\t\tset_page_dirty(page);\n\t\tswap_free(swap);\n\n\t} else {\n\t\tif (vma && userfaultfd_missing(vma)) {\n\t\t\t*fault_type = handle_userfault(vmf, VM_UFFD_MISSING);\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* shmem_symlink() */\n\t\tif (mapping->a_ops != &shmem_aops)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_DENY || sgp_huge == SGP_NOHUGE)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\t\tgoto alloc_huge;\n\t\tswitch (sbinfo->huge) {\n\t\t\tloff_t i_size;\n\t\t\tpgoff_t off;\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\tgoto alloc_nohuge;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(index, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* fallthrough */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\tif (sgp_huge == SGP_HUGE)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\tgoto alloc_nohuge;\n\t\t}\n\nalloc_huge:\n\t\tpage = shmem_alloc_and_acct_page(gfp, inode, index, true);\n\t\tif (IS_ERR(page)) {\nalloc_nohuge:\t\tpage = shmem_alloc_and_acct_page(gfp, inode,\n\t\t\t\t\tindex, false);\n\t\t}\n\t\tif (IS_ERR(page)) {\n\t\t\tint retry = 5;\n\t\t\terror = PTR_ERR(page);\n\t\t\tpage = NULL;\n\t\t\tif (error != -ENOSPC)\n\t\t\t\tgoto failed;\n\t\t\t/*\n\t\t\t * Try to reclaim some spece by splitting a huge page\n\t\t\t * beyond i_size on the filesystem.\n\t\t\t */\n\t\t\twhile (retry--) {\n\t\t\t\tint ret;\n\t\t\t\tret = shmem_unused_huge_shrink(sbinfo, NULL, 1);\n\t\t\t\tif (ret == SHRINK_STOP)\n\t\t\t\t\tbreak;\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto alloc_nohuge;\n\t\t\t}\n\t\t\tgoto failed;\n\t\t}\n\n\t\tif (PageTransHuge(page))\n\t\t\thindex = round_down(index, HPAGE_PMD_NR);\n\t\telse\n\t\t\thindex = index;\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\t__SetPageReferenced(page);\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tPageTransHuge(page));\n\t\tif (error)\n\t\t\tgoto unacct;\n\t\terror = shmem_add_to_page_cache(page, mapping, hindex,\n\t\t\t\t\t\tNULL, gfp & GFP_RECLAIM_MASK);\n\t\tif (error) {\n\t\t\tmem_cgroup_cancel_charge(page, memcg,\n\t\t\t\t\tPageTransHuge(page));\n\t\t\tgoto unacct;\n\t\t}\n\t\tmem_cgroup_commit_charge(page, memcg, false,\n\t\t\t\tPageTransHuge(page));\n\t\tlru_cache_add_anon(page);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->alloced += 1 << compound_order(page);\n\t\tinode->i_blocks += BLOCKS_PER_PAGE << compound_order(page);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\talloced = true;\n\n\t\tif (PageTransHuge(page) &&\n\t\t\t\tDIV_ROUND_UP(i_size_read(inode), PAGE_SIZE) <\n\t\t\t\thindex + HPAGE_PMD_NR - 1) {\n\t\t\t/*\n\t\t\t * Part of the huge page is beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t/*\n\t\t\t * _careful to defend against unlocked access to\n\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t */\n\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\n\t\t/*\n\t\t * Let SGP_FALLOC use the SGP_WRITE optimization on a new page.\n\t\t */\n\t\tif (sgp == SGP_FALLOC)\n\t\t\tsgp = SGP_WRITE;\nclear:\n\t\t/*\n\t\t * Let SGP_WRITE caller clear ends if write does not fill page;\n\t\t * but SGP_FALLOC on a page fallocated earlier must initialize\n\t\t * it now, lest undo on failure cancel our earlier guarantee.\n\t\t */\n\t\tif (sgp != SGP_WRITE && !PageUptodate(page)) {\n\t\t\tstruct page *head = compound_head(page);\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < (1 << compound_order(head)); i++) {\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t\tSetPageUptodate(head);\n\t\t}\n\t}\n\n\t/* Perhaps the file has been truncated since we checked */\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\tif (alloced) {\n\t\t\tClearPageDirty(page);\n\t\t\tdelete_from_page_cache(page);\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tshmem_recalc_inode(inode);\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t}\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\t*pagep = page + index - hindex;\n\treturn 0;\n\n\t/*\n\t * Error recovery.\n\t */\nunacct:\n\tshmem_inode_unacct_blocks(inode, 1 << compound_order(page));\n\n\tif (PageTransHuge(page)) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tgoto alloc_nohuge;\n\t}\nfailed:\n\tif (swap.val && !shmem_confirm_swap(mapping, index, swap))\n\t\terror = -EEXIST;\nunlock:\n\tif (page) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tif (error == -ENOSPC && !once++) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\tgoto repeat;\n\t}\n\tif (error == -EEXIST)\n\t\tgoto repeat;\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_huge SHMEM_HUGE_DENY",
            "#define SHMEM_HUGE_FORCE\t(-2)",
            "#define SHMEM_HUGE_DENY\t\t(-1)",
            "#define SHMEM_HUGE_ADVISE\t3",
            "#define SHMEM_HUGE_WITHIN_SIZE\t2",
            "#define SHMEM_HUGE_NEVER\t0",
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_NEVER\t0\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic int shmem_getpage_gfp(struct inode *inode, pgoff_t index,\n\tstruct page **pagep, enum sgp_type sgp, gfp_t gfp,\n\tstruct vm_area_struct *vma, struct vm_fault *vmf,\n\t\t\tvm_fault_t *fault_type)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo;\n\tstruct mm_struct *charge_mm;\n\tstruct mem_cgroup *memcg;\n\tstruct page *page;\n\tswp_entry_t swap;\n\tenum sgp_type sgp_huge = sgp;\n\tpgoff_t hindex = index;\n\tint error;\n\tint once = 0;\n\tint alloced = 0;\n\n\tif (index > (MAX_LFS_FILESIZE >> PAGE_SHIFT))\n\t\treturn -EFBIG;\n\tif (sgp == SGP_NOHUGE || sgp == SGP_HUGE)\n\t\tsgp = SGP_CACHE;\nrepeat:\n\tswap.val = 0;\n\tpage = find_lock_entry(mapping, index);\n\tif (xa_is_value(page)) {\n\t\tswap = radix_to_swp_entry(page);\n\t\tpage = NULL;\n\t}\n\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\n\tif (page && sgp == SGP_WRITE)\n\t\tmark_page_accessed(page);\n\n\t/* fallocated page? */\n\tif (page && !PageUptodate(page)) {\n\t\tif (sgp != SGP_READ)\n\t\t\tgoto clear;\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tpage = NULL;\n\t}\n\tif (page || (sgp == SGP_READ && !swap.val)) {\n\t\t*pagep = page;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Fast cache lookup did not find it:\n\t * bring it back from swap or allocate.\n\t */\n\tsbinfo = SHMEM_SB(inode->i_sb);\n\tcharge_mm = vma ? vma->vm_mm : current->mm;\n\n\tif (swap.val) {\n\t\t/* Look it up and read it in.. */\n\t\tpage = lookup_swap_cache(swap, NULL, 0);\n\t\tif (!page) {\n\t\t\t/* Or update major stats only when swapin succeeds?? */\n\t\t\tif (fault_type) {\n\t\t\t\t*fault_type |= VM_FAULT_MAJOR;\n\t\t\t\tcount_vm_event(PGMAJFAULT);\n\t\t\t\tcount_memcg_event_mm(charge_mm, PGMAJFAULT);\n\t\t\t}\n\t\t\t/* Here we actually start the io */\n\t\t\tpage = shmem_swapin(swap, gfp, info, index);\n\t\t\tif (!page) {\n\t\t\t\terror = -ENOMEM;\n\t\t\t\tgoto failed;\n\t\t\t}\n\t\t}\n\n\t\t/* We have to do this with page locked to prevent races */\n\t\tlock_page(page);\n\t\tif (!PageSwapCache(page) || page_private(page) != swap.val ||\n\t\t    !shmem_confirm_swap(mapping, index, swap)) {\n\t\t\terror = -EEXIST;\t/* try again */\n\t\t\tgoto unlock;\n\t\t}\n\t\tif (!PageUptodate(page)) {\n\t\t\terror = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t\twait_on_page_writeback(page);\n\n\t\tif (shmem_should_replace_page(page, gfp)) {\n\t\t\terror = shmem_replace_page(&page, gfp, info, index);\n\t\t\tif (error)\n\t\t\t\tgoto failed;\n\t\t}\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tfalse);\n\t\tif (!error) {\n\t\t\terror = shmem_add_to_page_cache(page, mapping, index,\n\t\t\t\t\t\tswp_to_radix_entry(swap), gfp);\n\t\t\t/*\n\t\t\t * We already confirmed swap under page lock, and make\n\t\t\t * no memory allocation here, so usually no possibility\n\t\t\t * of error; but free_swap_and_cache() only trylocks a\n\t\t\t * page, so it is just possible that the entry has been\n\t\t\t * truncated or holepunched since swap was confirmed.\n\t\t\t * shmem_undo_range() will have done some of the\n\t\t\t * unaccounting, now delete_from_swap_cache() will do\n\t\t\t * the rest.\n\t\t\t * Reset swap.val? No, leave it so \"failed\" goes back to\n\t\t\t * \"repeat\": reading a hole and writing should succeed.\n\t\t\t */\n\t\t\tif (error) {\n\t\t\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t\t\t\tdelete_from_swap_cache(page);\n\t\t\t}\n\t\t}\n\t\tif (error)\n\t\t\tgoto failed;\n\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->swapped--;\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\tmark_page_accessed(page);\n\n\t\tdelete_from_swap_cache(page);\n\t\tset_page_dirty(page);\n\t\tswap_free(swap);\n\n\t} else {\n\t\tif (vma && userfaultfd_missing(vma)) {\n\t\t\t*fault_type = handle_userfault(vmf, VM_UFFD_MISSING);\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* shmem_symlink() */\n\t\tif (mapping->a_ops != &shmem_aops)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_DENY || sgp_huge == SGP_NOHUGE)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\t\tgoto alloc_huge;\n\t\tswitch (sbinfo->huge) {\n\t\t\tloff_t i_size;\n\t\t\tpgoff_t off;\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\tgoto alloc_nohuge;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(index, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* fallthrough */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\tif (sgp_huge == SGP_HUGE)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\tgoto alloc_nohuge;\n\t\t}\n\nalloc_huge:\n\t\tpage = shmem_alloc_and_acct_page(gfp, inode, index, true);\n\t\tif (IS_ERR(page)) {\nalloc_nohuge:\t\tpage = shmem_alloc_and_acct_page(gfp, inode,\n\t\t\t\t\tindex, false);\n\t\t}\n\t\tif (IS_ERR(page)) {\n\t\t\tint retry = 5;\n\t\t\terror = PTR_ERR(page);\n\t\t\tpage = NULL;\n\t\t\tif (error != -ENOSPC)\n\t\t\t\tgoto failed;\n\t\t\t/*\n\t\t\t * Try to reclaim some spece by splitting a huge page\n\t\t\t * beyond i_size on the filesystem.\n\t\t\t */\n\t\t\twhile (retry--) {\n\t\t\t\tint ret;\n\t\t\t\tret = shmem_unused_huge_shrink(sbinfo, NULL, 1);\n\t\t\t\tif (ret == SHRINK_STOP)\n\t\t\t\t\tbreak;\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto alloc_nohuge;\n\t\t\t}\n\t\t\tgoto failed;\n\t\t}\n\n\t\tif (PageTransHuge(page))\n\t\t\thindex = round_down(index, HPAGE_PMD_NR);\n\t\telse\n\t\t\thindex = index;\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\t__SetPageReferenced(page);\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tPageTransHuge(page));\n\t\tif (error)\n\t\t\tgoto unacct;\n\t\terror = shmem_add_to_page_cache(page, mapping, hindex,\n\t\t\t\t\t\tNULL, gfp & GFP_RECLAIM_MASK);\n\t\tif (error) {\n\t\t\tmem_cgroup_cancel_charge(page, memcg,\n\t\t\t\t\tPageTransHuge(page));\n\t\t\tgoto unacct;\n\t\t}\n\t\tmem_cgroup_commit_charge(page, memcg, false,\n\t\t\t\tPageTransHuge(page));\n\t\tlru_cache_add_anon(page);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->alloced += 1 << compound_order(page);\n\t\tinode->i_blocks += BLOCKS_PER_PAGE << compound_order(page);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\talloced = true;\n\n\t\tif (PageTransHuge(page) &&\n\t\t\t\tDIV_ROUND_UP(i_size_read(inode), PAGE_SIZE) <\n\t\t\t\thindex + HPAGE_PMD_NR - 1) {\n\t\t\t/*\n\t\t\t * Part of the huge page is beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t/*\n\t\t\t * _careful to defend against unlocked access to\n\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t */\n\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\n\t\t/*\n\t\t * Let SGP_FALLOC use the SGP_WRITE optimization on a new page.\n\t\t */\n\t\tif (sgp == SGP_FALLOC)\n\t\t\tsgp = SGP_WRITE;\nclear:\n\t\t/*\n\t\t * Let SGP_WRITE caller clear ends if write does not fill page;\n\t\t * but SGP_FALLOC on a page fallocated earlier must initialize\n\t\t * it now, lest undo on failure cancel our earlier guarantee.\n\t\t */\n\t\tif (sgp != SGP_WRITE && !PageUptodate(page)) {\n\t\t\tstruct page *head = compound_head(page);\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < (1 << compound_order(head)); i++) {\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t\tSetPageUptodate(head);\n\t\t}\n\t}\n\n\t/* Perhaps the file has been truncated since we checked */\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\tif (alloced) {\n\t\t\tClearPageDirty(page);\n\t\t\tdelete_from_page_cache(page);\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tshmem_recalc_inode(inode);\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t}\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\t*pagep = page + index - hindex;\n\treturn 0;\n\n\t/*\n\t * Error recovery.\n\t */\nunacct:\n\tshmem_inode_unacct_blocks(inode, 1 << compound_order(page));\n\n\tif (PageTransHuge(page)) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tgoto alloc_nohuge;\n\t}\nfailed:\n\tif (swap.val && !shmem_confirm_swap(mapping, index, swap))\n\t\terror = -EEXIST;\nunlock:\n\tif (page) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tif (error == -ENOSPC && !once++) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\tgoto repeat;\n\t}\n\tif (error == -EEXIST)\n\t\tgoto repeat;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "mapping->a_ops != &shmem_aops"
          ],
          "line": 3986
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstruct page *shmem_read_mapping_page_gfp(struct address_space *mapping,\n\t\t\t\t\t pgoff_t index, gfp_t gfp)\n{\n#ifdef CONFIG_SHMEM\n\tstruct inode *inode = mapping->host;\n\tstruct page *page;\n\tint error;\n\n\tBUG_ON(mapping->a_ops != &shmem_aops);\n\terror = shmem_getpage_gfp(inode, index, &page, SGP_CACHE,\n\t\t\t\t  gfp, NULL, NULL, NULL);\n\tif (error)\n\t\tpage = ERR_PTR(error);\n\telse\n\t\tunlock_page(page);\n\treturn page;\n#else\n\t/*\n\t * The tiny !SHMEM case uses ramfs without swap\n\t */\n\treturn read_cache_page_gfp(mapping, index, gfp);\n#endif\n}"
  },
  {
    "function_name": "shmem_zero_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3934-3961",
    "snippet": "int shmem_zero_setup(struct vm_area_struct *vma)\n{\n\tstruct file *file;\n\tloff_t size = vma->vm_end - vma->vm_start;\n\n\t/*\n\t * Cloning a new file under mmap_sem leads to a lock ordering conflict\n\t * between XFS directory reading and selinux: since this file is only\n\t * accessible to the user through its mapping, use S_PRIVATE flag to\n\t * bypass file security, in the same way as shmem_kernel_file_setup().\n\t */\n\tfile = shmem_kernel_file_setup(\"dev/zero\", size, vma->vm_flags);\n\tif (IS_ERR(file))\n\t\treturn PTR_ERR(file);\n\n\tif (vma->vm_file)\n\t\tfput(vma->vm_file);\n\tvma->vm_file = file;\n\tvma->vm_ops = &shmem_vm_ops;\n\n\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE) &&\n\t\t\t((vma->vm_start + ~HPAGE_PMD_MASK) & HPAGE_PMD_MASK) <\n\t\t\t(vma->vm_end & HPAGE_PMD_MASK)) {\n\t\tkhugepaged_enter(vma, vma->vm_flags);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_vm_ops\t\t\t\tgeneric_file_vm_ops"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "khugepaged_enter",
          "args": [
            "vma",
            "vma->vm_flags"
          ],
          "line": 3957
        },
        "resolved": true,
        "details": {
          "function_name": "khugepaged_enter_vma_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/khugepaged.c",
          "lines": "453-470",
          "snippet": "int khugepaged_enter_vma_merge(struct vm_area_struct *vma,\n\t\t\t       unsigned long vm_flags)\n{\n\tunsigned long hstart, hend;\n\n\t/*\n\t * khugepaged does not yet work on non-shmem files or special\n\t * mappings. And file-private shmem THP is not supported.\n\t */\n\tif (!hugepage_vma_check(vma, vm_flags))\n\t\treturn 0;\n\n\thstart = (vma->vm_start + ~HPAGE_PMD_MASK) & HPAGE_PMD_MASK;\n\thend = vma->vm_end & HPAGE_PMD_MASK;\n\tif (hstart < hend)\n\t\treturn khugepaged_enter(vma, vm_flags);\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/huge_memory.h>",
            "#include \"internal.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/tlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page_idle.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/mman.h>",
            "#include <linux/freezer.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/swap.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/huge_memory.h>\n#include \"internal.h\"\n#include <asm/pgalloc.h>\n#include <asm/tlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/swapops.h>\n#include <linux/page_idle.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/hashtable.h>\n#include <linux/mman.h>\n#include <linux/freezer.h>\n#include <linux/khugepaged.h>\n#include <linux/kthread.h>\n#include <linux/mm_inline.h>\n#include <linux/swap.h>\n#include <linux/rmap.h>\n#include <linux/mmu_notifier.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nint khugepaged_enter_vma_merge(struct vm_area_struct *vma,\n\t\t\t       unsigned long vm_flags)\n{\n\tunsigned long hstart, hend;\n\n\t/*\n\t * khugepaged does not yet work on non-shmem files or special\n\t * mappings. And file-private shmem THP is not supported.\n\t */\n\tif (!hugepage_vma_check(vma, vm_flags))\n\t\treturn 0;\n\n\thstart = (vma->vm_start + ~HPAGE_PMD_MASK) & HPAGE_PMD_MASK;\n\thend = vma->vm_end & HPAGE_PMD_MASK;\n\tif (hstart < hend)\n\t\treturn khugepaged_enter(vma, vm_flags);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_TRANSPARENT_HUGE_PAGECACHE"
          ],
          "line": 3954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fput",
          "args": [
            "vma->vm_file"
          ],
          "line": 3950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "file"
          ],
          "line": 3947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "file"
          ],
          "line": 3946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_kernel_file_setup",
          "args": [
            "\"dev/zero\"",
            "size",
            "vma->vm_flags"
          ],
          "line": 3945
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_kernel_file_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3899-3902",
          "snippet": "struct file *shmem_kernel_file_setup(const char *name, loff_t size, unsigned long flags)\n{\n\treturn __shmem_file_setup(shm_mnt, name, size, flags, S_PRIVATE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct vfsmount *shm_mnt;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct vfsmount *shm_mnt;\n\nstruct file *shmem_kernel_file_setup(const char *name, loff_t size, unsigned long flags)\n{\n\treturn __shmem_file_setup(shm_mnt, name, size, flags, S_PRIVATE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_vm_ops\t\t\t\tgeneric_file_vm_ops\n\nint shmem_zero_setup(struct vm_area_struct *vma)\n{\n\tstruct file *file;\n\tloff_t size = vma->vm_end - vma->vm_start;\n\n\t/*\n\t * Cloning a new file under mmap_sem leads to a lock ordering conflict\n\t * between XFS directory reading and selinux: since this file is only\n\t * accessible to the user through its mapping, use S_PRIVATE flag to\n\t * bypass file security, in the same way as shmem_kernel_file_setup().\n\t */\n\tfile = shmem_kernel_file_setup(\"dev/zero\", size, vma->vm_flags);\n\tif (IS_ERR(file))\n\t\treturn PTR_ERR(file);\n\n\tif (vma->vm_file)\n\t\tfput(vma->vm_file);\n\tvma->vm_file = file;\n\tvma->vm_ops = &shmem_vm_ops;\n\n\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE) &&\n\t\t\t((vma->vm_start + ~HPAGE_PMD_MASK) & HPAGE_PMD_MASK) <\n\t\t\t(vma->vm_end & HPAGE_PMD_MASK)) {\n\t\tkhugepaged_enter(vma, vma->vm_flags);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_file_setup_with_mnt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3923-3927",
    "snippet": "struct file *shmem_file_setup_with_mnt(struct vfsmount *mnt, const char *name,\n\t\t\t\t       loff_t size, unsigned long flags)\n{\n\treturn __shmem_file_setup(mnt, name, size, flags, 0);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__shmem_file_setup",
          "args": [
            "mnt",
            "name",
            "size",
            "flags",
            "0"
          ],
          "line": 3926
        },
        "resolved": true,
        "details": {
          "function_name": "__shmem_file_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3856-3887",
          "snippet": "static struct file *__shmem_file_setup(struct vfsmount *mnt, const char *name, loff_t size,\n\t\t\t\t       unsigned long flags, unsigned int i_flags)\n{\n\tstruct inode *inode;\n\tstruct file *res;\n\n\tif (IS_ERR(mnt))\n\t\treturn ERR_CAST(mnt);\n\n\tif (size < 0 || size > MAX_LFS_FILESIZE)\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (shmem_acct_size(flags, size))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tinode = shmem_get_inode(mnt->mnt_sb, NULL, S_IFREG | S_IRWXUGO, 0,\n\t\t\t\tflags);\n\tif (unlikely(!inode)) {\n\t\tshmem_unacct_size(flags, size);\n\t\treturn ERR_PTR(-ENOSPC);\n\t}\n\tinode->i_flags |= i_flags;\n\tinode->i_size = size;\n\tclear_nlink(inode);\t/* It is unlinked */\n\tres = ERR_PTR(ramfs_nommu_expand_for_mapping(inode, size));\n\tif (!IS_ERR(res))\n\t\tres = alloc_file_pseudo(inode, mnt, name, O_RDWR,\n\t\t\t\t&shmem_file_operations);\n\tif (IS_ERR(res))\n\t\tiput(inode);\n\treturn res;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_file_operations\t\t\tramfs_file_operations"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n\nstatic struct file *__shmem_file_setup(struct vfsmount *mnt, const char *name, loff_t size,\n\t\t\t\t       unsigned long flags, unsigned int i_flags)\n{\n\tstruct inode *inode;\n\tstruct file *res;\n\n\tif (IS_ERR(mnt))\n\t\treturn ERR_CAST(mnt);\n\n\tif (size < 0 || size > MAX_LFS_FILESIZE)\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (shmem_acct_size(flags, size))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tinode = shmem_get_inode(mnt->mnt_sb, NULL, S_IFREG | S_IRWXUGO, 0,\n\t\t\t\tflags);\n\tif (unlikely(!inode)) {\n\t\tshmem_unacct_size(flags, size);\n\t\treturn ERR_PTR(-ENOSPC);\n\t}\n\tinode->i_flags |= i_flags;\n\tinode->i_size = size;\n\tclear_nlink(inode);\t/* It is unlinked */\n\tres = ERR_PTR(ramfs_nommu_expand_for_mapping(inode, size));\n\tif (!IS_ERR(res))\n\t\tres = alloc_file_pseudo(inode, mnt, name, O_RDWR,\n\t\t\t\t&shmem_file_operations);\n\tif (IS_ERR(res))\n\t\tiput(inode);\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstruct file *shmem_file_setup_with_mnt(struct vfsmount *mnt, const char *name,\n\t\t\t\t       loff_t size, unsigned long flags)\n{\n\treturn __shmem_file_setup(mnt, name, size, flags, 0);\n}"
  },
  {
    "function_name": "shmem_file_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3910-3913",
    "snippet": "struct file *shmem_file_setup(const char *name, loff_t size, unsigned long flags)\n{\n\treturn __shmem_file_setup(shm_mnt, name, size, flags, 0);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct vfsmount *shm_mnt;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__shmem_file_setup",
          "args": [
            "shm_mnt",
            "name",
            "size",
            "flags",
            "0"
          ],
          "line": 3912
        },
        "resolved": true,
        "details": {
          "function_name": "__shmem_file_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3856-3887",
          "snippet": "static struct file *__shmem_file_setup(struct vfsmount *mnt, const char *name, loff_t size,\n\t\t\t\t       unsigned long flags, unsigned int i_flags)\n{\n\tstruct inode *inode;\n\tstruct file *res;\n\n\tif (IS_ERR(mnt))\n\t\treturn ERR_CAST(mnt);\n\n\tif (size < 0 || size > MAX_LFS_FILESIZE)\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (shmem_acct_size(flags, size))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tinode = shmem_get_inode(mnt->mnt_sb, NULL, S_IFREG | S_IRWXUGO, 0,\n\t\t\t\tflags);\n\tif (unlikely(!inode)) {\n\t\tshmem_unacct_size(flags, size);\n\t\treturn ERR_PTR(-ENOSPC);\n\t}\n\tinode->i_flags |= i_flags;\n\tinode->i_size = size;\n\tclear_nlink(inode);\t/* It is unlinked */\n\tres = ERR_PTR(ramfs_nommu_expand_for_mapping(inode, size));\n\tif (!IS_ERR(res))\n\t\tres = alloc_file_pseudo(inode, mnt, name, O_RDWR,\n\t\t\t\t&shmem_file_operations);\n\tif (IS_ERR(res))\n\t\tiput(inode);\n\treturn res;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_file_operations\t\t\tramfs_file_operations"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n\nstatic struct file *__shmem_file_setup(struct vfsmount *mnt, const char *name, loff_t size,\n\t\t\t\t       unsigned long flags, unsigned int i_flags)\n{\n\tstruct inode *inode;\n\tstruct file *res;\n\n\tif (IS_ERR(mnt))\n\t\treturn ERR_CAST(mnt);\n\n\tif (size < 0 || size > MAX_LFS_FILESIZE)\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (shmem_acct_size(flags, size))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tinode = shmem_get_inode(mnt->mnt_sb, NULL, S_IFREG | S_IRWXUGO, 0,\n\t\t\t\tflags);\n\tif (unlikely(!inode)) {\n\t\tshmem_unacct_size(flags, size);\n\t\treturn ERR_PTR(-ENOSPC);\n\t}\n\tinode->i_flags |= i_flags;\n\tinode->i_size = size;\n\tclear_nlink(inode);\t/* It is unlinked */\n\tres = ERR_PTR(ramfs_nommu_expand_for_mapping(inode, size));\n\tif (!IS_ERR(res))\n\t\tres = alloc_file_pseudo(inode, mnt, name, O_RDWR,\n\t\t\t\t&shmem_file_operations);\n\tif (IS_ERR(res))\n\t\tiput(inode);\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct vfsmount *shm_mnt;\n\nstruct file *shmem_file_setup(const char *name, loff_t size, unsigned long flags)\n{\n\treturn __shmem_file_setup(shm_mnt, name, size, flags, 0);\n}"
  },
  {
    "function_name": "shmem_kernel_file_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3899-3902",
    "snippet": "struct file *shmem_kernel_file_setup(const char *name, loff_t size, unsigned long flags)\n{\n\treturn __shmem_file_setup(shm_mnt, name, size, flags, S_PRIVATE);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct vfsmount *shm_mnt;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__shmem_file_setup",
          "args": [
            "shm_mnt",
            "name",
            "size",
            "flags",
            "S_PRIVATE"
          ],
          "line": 3901
        },
        "resolved": true,
        "details": {
          "function_name": "__shmem_file_setup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3856-3887",
          "snippet": "static struct file *__shmem_file_setup(struct vfsmount *mnt, const char *name, loff_t size,\n\t\t\t\t       unsigned long flags, unsigned int i_flags)\n{\n\tstruct inode *inode;\n\tstruct file *res;\n\n\tif (IS_ERR(mnt))\n\t\treturn ERR_CAST(mnt);\n\n\tif (size < 0 || size > MAX_LFS_FILESIZE)\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (shmem_acct_size(flags, size))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tinode = shmem_get_inode(mnt->mnt_sb, NULL, S_IFREG | S_IRWXUGO, 0,\n\t\t\t\tflags);\n\tif (unlikely(!inode)) {\n\t\tshmem_unacct_size(flags, size);\n\t\treturn ERR_PTR(-ENOSPC);\n\t}\n\tinode->i_flags |= i_flags;\n\tinode->i_size = size;\n\tclear_nlink(inode);\t/* It is unlinked */\n\tres = ERR_PTR(ramfs_nommu_expand_for_mapping(inode, size));\n\tif (!IS_ERR(res))\n\t\tres = alloc_file_pseudo(inode, mnt, name, O_RDWR,\n\t\t\t\t&shmem_file_operations);\n\tif (IS_ERR(res))\n\t\tiput(inode);\n\treturn res;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_file_operations\t\t\tramfs_file_operations"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n\nstatic struct file *__shmem_file_setup(struct vfsmount *mnt, const char *name, loff_t size,\n\t\t\t\t       unsigned long flags, unsigned int i_flags)\n{\n\tstruct inode *inode;\n\tstruct file *res;\n\n\tif (IS_ERR(mnt))\n\t\treturn ERR_CAST(mnt);\n\n\tif (size < 0 || size > MAX_LFS_FILESIZE)\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (shmem_acct_size(flags, size))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tinode = shmem_get_inode(mnt->mnt_sb, NULL, S_IFREG | S_IRWXUGO, 0,\n\t\t\t\tflags);\n\tif (unlikely(!inode)) {\n\t\tshmem_unacct_size(flags, size);\n\t\treturn ERR_PTR(-ENOSPC);\n\t}\n\tinode->i_flags |= i_flags;\n\tinode->i_size = size;\n\tclear_nlink(inode);\t/* It is unlinked */\n\tres = ERR_PTR(ramfs_nommu_expand_for_mapping(inode, size));\n\tif (!IS_ERR(res))\n\t\tres = alloc_file_pseudo(inode, mnt, name, O_RDWR,\n\t\t\t\t&shmem_file_operations);\n\tif (IS_ERR(res))\n\t\tiput(inode);\n\treturn res;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct vfsmount *shm_mnt;\n\nstruct file *shmem_kernel_file_setup(const char *name, loff_t size, unsigned long flags)\n{\n\treturn __shmem_file_setup(shm_mnt, name, size, flags, S_PRIVATE);\n}"
  },
  {
    "function_name": "__shmem_file_setup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3856-3887",
    "snippet": "static struct file *__shmem_file_setup(struct vfsmount *mnt, const char *name, loff_t size,\n\t\t\t\t       unsigned long flags, unsigned int i_flags)\n{\n\tstruct inode *inode;\n\tstruct file *res;\n\n\tif (IS_ERR(mnt))\n\t\treturn ERR_CAST(mnt);\n\n\tif (size < 0 || size > MAX_LFS_FILESIZE)\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (shmem_acct_size(flags, size))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tinode = shmem_get_inode(mnt->mnt_sb, NULL, S_IFREG | S_IRWXUGO, 0,\n\t\t\t\tflags);\n\tif (unlikely(!inode)) {\n\t\tshmem_unacct_size(flags, size);\n\t\treturn ERR_PTR(-ENOSPC);\n\t}\n\tinode->i_flags |= i_flags;\n\tinode->i_size = size;\n\tclear_nlink(inode);\t/* It is unlinked */\n\tres = ERR_PTR(ramfs_nommu_expand_for_mapping(inode, size));\n\tif (!IS_ERR(res))\n\t\tres = alloc_file_pseudo(inode, mnt, name, O_RDWR,\n\t\t\t\t&shmem_file_operations);\n\tif (IS_ERR(res))\n\t\tiput(inode);\n\treturn res;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_file_operations\t\t\tramfs_file_operations"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 3885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "res"
          ],
          "line": 3884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_file_pseudo",
          "args": [
            "inode",
            "mnt",
            "name",
            "O_RDWR",
            "&shmem_file_operations"
          ],
          "line": 3882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "res"
          ],
          "line": 3881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "ramfs_nommu_expand_for_mapping(inode, size)"
          ],
          "line": 3880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ramfs_nommu_expand_for_mapping",
          "args": [
            "inode",
            "size"
          ],
          "line": 3880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_nlink",
          "args": [
            "inode"
          ],
          "line": 3879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOSPC"
          ],
          "line": 3875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_unacct_size",
          "args": [
            "flags",
            "size"
          ],
          "line": 3874
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unacct_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "153-157",
          "snippet": "static inline void shmem_unacct_size(unsigned long flags, loff_t size)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\tvm_unacct_memory(VM_ACCT(size));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_unacct_size(unsigned long flags, loff_t size)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\tvm_unacct_memory(VM_ACCT(size));\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!inode"
          ],
          "line": 3873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_get_inode",
          "args": [
            "mnt->mnt_sb",
            "NULL",
            "S_IFREG | S_IRWXUGO",
            "0",
            "flags"
          ],
          "line": 3871
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2134-2193",
          "snippet": "static struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_file_operations\t\t\tramfs_file_operations",
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n#define BOGO_DIRENT_SIZE 20\n\nstatic struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ENOMEM"
          ],
          "line": 3869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_acct_size",
          "args": [
            "flags",
            "size"
          ],
          "line": 3868
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_acct_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "147-151",
          "snippet": "static inline int shmem_acct_size(unsigned long flags, loff_t size)\n{\n\treturn (flags & VM_NORESERVE) ?\n\t\t0 : security_vm_enough_memory_mm(current->mm, VM_ACCT(size));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline int shmem_acct_size(unsigned long flags, loff_t size)\n{\n\treturn (flags & VM_NORESERVE) ?\n\t\t0 : security_vm_enough_memory_mm(current->mm, VM_ACCT(size));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-EINVAL"
          ],
          "line": 3866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_CAST",
          "args": [
            "mnt"
          ],
          "line": 3863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "mnt"
          ],
          "line": 3862
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n\nstatic struct file *__shmem_file_setup(struct vfsmount *mnt, const char *name, loff_t size,\n\t\t\t\t       unsigned long flags, unsigned int i_flags)\n{\n\tstruct inode *inode;\n\tstruct file *res;\n\n\tif (IS_ERR(mnt))\n\t\treturn ERR_CAST(mnt);\n\n\tif (size < 0 || size > MAX_LFS_FILESIZE)\n\t\treturn ERR_PTR(-EINVAL);\n\n\tif (shmem_acct_size(flags, size))\n\t\treturn ERR_PTR(-ENOMEM);\n\n\tinode = shmem_get_inode(mnt->mnt_sb, NULL, S_IFREG | S_IRWXUGO, 0,\n\t\t\t\tflags);\n\tif (unlikely(!inode)) {\n\t\tshmem_unacct_size(flags, size);\n\t\treturn ERR_PTR(-ENOSPC);\n\t}\n\tinode->i_flags |= i_flags;\n\tinode->i_size = size;\n\tclear_nlink(inode);\t/* It is unlinked */\n\tres = ERR_PTR(ramfs_nommu_expand_for_mapping(inode, size));\n\tif (!IS_ERR(res))\n\t\tres = alloc_file_pseudo(inode, mnt, name, O_RDWR,\n\t\t\t\t&shmem_file_operations);\n\tif (IS_ERR(res))\n\t\tiput(inode);\n\treturn res;\n}"
  },
  {
    "function_name": "shmem_truncate_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3840-3843",
    "snippet": "void shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\ttruncate_inode_pages_range(inode->i_mapping, lstart, lend);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "truncate_inode_pages_range",
          "args": [
            "inode->i_mapping",
            "lstart",
            "lend"
          ],
          "line": 3842
        },
        "resolved": true,
        "details": {
          "function_name": "truncate_inode_pages_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/truncate.c",
          "lines": "290-458",
          "snippet": "void truncate_inode_pages_range(struct address_space *mapping,\n\t\t\t\tloff_t lstart, loff_t lend)\n{\n\tpgoff_t\t\tstart;\t\t/* inclusive */\n\tpgoff_t\t\tend;\t\t/* exclusive */\n\tunsigned int\tpartial_start;\t/* inclusive */\n\tunsigned int\tpartial_end;\t/* exclusive */\n\tstruct pagevec\tpvec;\n\tpgoff_t\t\tindices[PAGEVEC_SIZE];\n\tpgoff_t\t\tindex;\n\tint\t\ti;\n\n\tif (mapping->nrpages == 0 && mapping->nrexceptional == 0)\n\t\tgoto out;\n\n\t/* Offsets within partial pages */\n\tpartial_start = lstart & (PAGE_SIZE - 1);\n\tpartial_end = (lend + 1) & (PAGE_SIZE - 1);\n\n\t/*\n\t * 'start' and 'end' always covers the range of pages to be fully\n\t * truncated. Partial pages are covered with 'partial_start' at the\n\t * start of the range and 'partial_end' at the end of the range.\n\t * Note that 'end' is exclusive while 'lend' is inclusive.\n\t */\n\tstart = (lstart + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tif (lend == -1)\n\t\t/*\n\t\t * lend == -1 indicates end-of-file so we have to set 'end'\n\t\t * to the highest possible pgoff_t and since the type is\n\t\t * unsigned we're using -1.\n\t\t */\n\t\tend = -1;\n\telse\n\t\tend = (lend + 1) >> PAGE_SHIFT;\n\n\tpagevec_init(&pvec);\n\tindex = start;\n\twhile (index < end && pagevec_lookup_entries(&pvec, mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\tindices)) {\n\t\t/*\n\t\t * Pagevec array has exceptional entries and we may also fail\n\t\t * to lock some pages. So we store pages that can be deleted\n\t\t * in a new pagevec.\n\t\t */\n\t\tstruct pagevec locked_pvec;\n\n\t\tpagevec_init(&locked_pvec);\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\t/* We rely upon deletion not changing page->index */\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page))\n\t\t\t\tcontinue;\n\n\t\t\tif (!trylock_page(page))\n\t\t\t\tcontinue;\n\t\t\tWARN_ON(page_to_index(page) != index);\n\t\t\tif (PageWriteback(page)) {\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (page->mapping != mapping) {\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tpagevec_add(&locked_pvec, page);\n\t\t}\n\t\tfor (i = 0; i < pagevec_count(&locked_pvec); i++)\n\t\t\ttruncate_cleanup_page(mapping, locked_pvec.pages[i]);\n\t\tdelete_from_page_cache_batch(mapping, &locked_pvec);\n\t\tfor (i = 0; i < pagevec_count(&locked_pvec); i++)\n\t\t\tunlock_page(locked_pvec.pages[i]);\n\t\ttruncate_exceptional_pvec_entries(mapping, &pvec, indices, end);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t\tindex++;\n\t}\n\tif (partial_start) {\n\t\tstruct page *page = find_lock_page(mapping, start - 1);\n\t\tif (page) {\n\t\t\tunsigned int top = PAGE_SIZE;\n\t\t\tif (start > end) {\n\t\t\t\t/* Truncation within a single page */\n\t\t\t\ttop = partial_end;\n\t\t\t\tpartial_end = 0;\n\t\t\t}\n\t\t\twait_on_page_writeback(page);\n\t\t\tzero_user_segment(page, partial_start, top);\n\t\t\tcleancache_invalidate_page(mapping, page);\n\t\t\tif (page_has_private(page))\n\t\t\t\tdo_invalidatepage(page, partial_start,\n\t\t\t\t\t\t  top - partial_start);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (partial_end) {\n\t\tstruct page *page = find_lock_page(mapping, end);\n\t\tif (page) {\n\t\t\twait_on_page_writeback(page);\n\t\t\tzero_user_segment(page, 0, partial_end);\n\t\t\tcleancache_invalidate_page(mapping, page);\n\t\t\tif (page_has_private(page))\n\t\t\t\tdo_invalidatepage(page, 0,\n\t\t\t\t\t\t  partial_end);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\t/*\n\t * If the truncation happened within a single page no pages\n\t * will be released, just zeroed, so we can bail out now.\n\t */\n\tif (start >= end)\n\t\tgoto out;\n\n\tindex = start;\n\tfor ( ; ; ) {\n\t\tcond_resched();\n\t\tif (!pagevec_lookup_entries(&pvec, mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE), indices)) {\n\t\t\t/* If all gone from start onwards, we're done */\n\t\t\tif (index == start)\n\t\t\t\tbreak;\n\t\t\t/* Otherwise restart to make sure all gone */\n\t\t\tindex = start;\n\t\t\tcontinue;\n\t\t}\n\t\tif (index == start && indices[0] >= end) {\n\t\t\t/* All gone out of hole to be punched, we're done */\n\t\t\tpagevec_remove_exceptionals(&pvec);\n\t\t\tpagevec_release(&pvec);\n\t\t\tbreak;\n\t\t}\n\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\t/* We rely upon deletion not changing page->index */\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end) {\n\t\t\t\t/* Restart punch to make sure all gone */\n\t\t\t\tindex = start - 1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (xa_is_value(page))\n\t\t\t\tcontinue;\n\n\t\t\tlock_page(page);\n\t\t\tWARN_ON(page_to_index(page) != index);\n\t\t\twait_on_page_writeback(page);\n\t\t\ttruncate_inode_page(mapping, page);\n\t\t\tunlock_page(page);\n\t\t}\n\t\ttruncate_exceptional_pvec_entries(mapping, &pvec, indices, end);\n\t\tpagevec_release(&pvec);\n\t\tindex++;\n\t}\n\nout:\n\tcleancache_invalidate_inode(mapping);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/rmap.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/buffer_head.h>\t/* grr. try_to_release_page,\n\t\t\t\t   do_invalidatepage */",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/dax.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/rmap.h>\n#include <linux/cleancache.h>\n#include <linux/shmem_fs.h>\n#include <linux/buffer_head.h>\t/* grr. try_to_release_page,\n\t\t\t\t   do_invalidatepage */\n#include <linux/task_io_accounting_ops.h>\n#include <linux/pagevec.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/dax.h>\n#include <linux/backing-dev.h>\n#include <linux/kernel.h>\n\nvoid truncate_inode_pages_range(struct address_space *mapping,\n\t\t\t\tloff_t lstart, loff_t lend)\n{\n\tpgoff_t\t\tstart;\t\t/* inclusive */\n\tpgoff_t\t\tend;\t\t/* exclusive */\n\tunsigned int\tpartial_start;\t/* inclusive */\n\tunsigned int\tpartial_end;\t/* exclusive */\n\tstruct pagevec\tpvec;\n\tpgoff_t\t\tindices[PAGEVEC_SIZE];\n\tpgoff_t\t\tindex;\n\tint\t\ti;\n\n\tif (mapping->nrpages == 0 && mapping->nrexceptional == 0)\n\t\tgoto out;\n\n\t/* Offsets within partial pages */\n\tpartial_start = lstart & (PAGE_SIZE - 1);\n\tpartial_end = (lend + 1) & (PAGE_SIZE - 1);\n\n\t/*\n\t * 'start' and 'end' always covers the range of pages to be fully\n\t * truncated. Partial pages are covered with 'partial_start' at the\n\t * start of the range and 'partial_end' at the end of the range.\n\t * Note that 'end' is exclusive while 'lend' is inclusive.\n\t */\n\tstart = (lstart + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tif (lend == -1)\n\t\t/*\n\t\t * lend == -1 indicates end-of-file so we have to set 'end'\n\t\t * to the highest possible pgoff_t and since the type is\n\t\t * unsigned we're using -1.\n\t\t */\n\t\tend = -1;\n\telse\n\t\tend = (lend + 1) >> PAGE_SHIFT;\n\n\tpagevec_init(&pvec);\n\tindex = start;\n\twhile (index < end && pagevec_lookup_entries(&pvec, mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\tindices)) {\n\t\t/*\n\t\t * Pagevec array has exceptional entries and we may also fail\n\t\t * to lock some pages. So we store pages that can be deleted\n\t\t * in a new pagevec.\n\t\t */\n\t\tstruct pagevec locked_pvec;\n\n\t\tpagevec_init(&locked_pvec);\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\t/* We rely upon deletion not changing page->index */\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page))\n\t\t\t\tcontinue;\n\n\t\t\tif (!trylock_page(page))\n\t\t\t\tcontinue;\n\t\t\tWARN_ON(page_to_index(page) != index);\n\t\t\tif (PageWriteback(page)) {\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (page->mapping != mapping) {\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tpagevec_add(&locked_pvec, page);\n\t\t}\n\t\tfor (i = 0; i < pagevec_count(&locked_pvec); i++)\n\t\t\ttruncate_cleanup_page(mapping, locked_pvec.pages[i]);\n\t\tdelete_from_page_cache_batch(mapping, &locked_pvec);\n\t\tfor (i = 0; i < pagevec_count(&locked_pvec); i++)\n\t\t\tunlock_page(locked_pvec.pages[i]);\n\t\ttruncate_exceptional_pvec_entries(mapping, &pvec, indices, end);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t\tindex++;\n\t}\n\tif (partial_start) {\n\t\tstruct page *page = find_lock_page(mapping, start - 1);\n\t\tif (page) {\n\t\t\tunsigned int top = PAGE_SIZE;\n\t\t\tif (start > end) {\n\t\t\t\t/* Truncation within a single page */\n\t\t\t\ttop = partial_end;\n\t\t\t\tpartial_end = 0;\n\t\t\t}\n\t\t\twait_on_page_writeback(page);\n\t\t\tzero_user_segment(page, partial_start, top);\n\t\t\tcleancache_invalidate_page(mapping, page);\n\t\t\tif (page_has_private(page))\n\t\t\t\tdo_invalidatepage(page, partial_start,\n\t\t\t\t\t\t  top - partial_start);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (partial_end) {\n\t\tstruct page *page = find_lock_page(mapping, end);\n\t\tif (page) {\n\t\t\twait_on_page_writeback(page);\n\t\t\tzero_user_segment(page, 0, partial_end);\n\t\t\tcleancache_invalidate_page(mapping, page);\n\t\t\tif (page_has_private(page))\n\t\t\t\tdo_invalidatepage(page, 0,\n\t\t\t\t\t\t  partial_end);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\t/*\n\t * If the truncation happened within a single page no pages\n\t * will be released, just zeroed, so we can bail out now.\n\t */\n\tif (start >= end)\n\t\tgoto out;\n\n\tindex = start;\n\tfor ( ; ; ) {\n\t\tcond_resched();\n\t\tif (!pagevec_lookup_entries(&pvec, mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE), indices)) {\n\t\t\t/* If all gone from start onwards, we're done */\n\t\t\tif (index == start)\n\t\t\t\tbreak;\n\t\t\t/* Otherwise restart to make sure all gone */\n\t\t\tindex = start;\n\t\t\tcontinue;\n\t\t}\n\t\tif (index == start && indices[0] >= end) {\n\t\t\t/* All gone out of hole to be punched, we're done */\n\t\t\tpagevec_remove_exceptionals(&pvec);\n\t\t\tpagevec_release(&pvec);\n\t\t\tbreak;\n\t\t}\n\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\t/* We rely upon deletion not changing page->index */\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end) {\n\t\t\t\t/* Restart punch to make sure all gone */\n\t\t\t\tindex = start - 1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (xa_is_value(page))\n\t\t\t\tcontinue;\n\n\t\t\tlock_page(page);\n\t\t\tWARN_ON(page_to_index(page) != index);\n\t\t\twait_on_page_writeback(page);\n\t\t\ttruncate_inode_page(mapping, page);\n\t\t\tunlock_page(page);\n\t\t}\n\t\ttruncate_exceptional_pvec_entries(mapping, &pvec, indices, end);\n\t\tpagevec_release(&pvec);\n\t\tindex++;\n\t}\n\nout:\n\tcleancache_invalidate_inode(mapping);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nvoid shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\ttruncate_inode_pages_range(inode->i_mapping, lstart, lend);\n}"
  },
  {
    "function_name": "shmem_get_unmapped_area",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3832-3837",
    "snippet": "unsigned long shmem_get_unmapped_area(struct file *file,\n\t\t\t\t      unsigned long addr, unsigned long len,\n\t\t\t\t      unsigned long pgoff, unsigned long flags)\n{\n\treturn current->mm->get_unmapped_area(file, addr, len, pgoff, flags);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current->mm->get_unmapped_area",
          "args": [
            "file",
            "addr",
            "len",
            "pgoff",
            "flags"
          ],
          "line": 3836
        },
        "resolved": true,
        "details": {
          "function_name": "get_unmapped_area",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mmap.c",
          "lines": "2170-2210",
          "snippet": "unsigned long\nget_unmapped_area(struct file *file, unsigned long addr, unsigned long len,\n\t\tunsigned long pgoff, unsigned long flags)\n{\n\tunsigned long (*get_area)(struct file *, unsigned long,\n\t\t\t\t  unsigned long, unsigned long, unsigned long);\n\n\tunsigned long error = arch_mmap_check(addr, len, flags);\n\tif (error)\n\t\treturn error;\n\n\t/* Careful about overflows.. */\n\tif (len > TASK_SIZE)\n\t\treturn -ENOMEM;\n\n\tget_area = current->mm->get_unmapped_area;\n\tif (file) {\n\t\tif (file->f_op->get_unmapped_area)\n\t\t\tget_area = file->f_op->get_unmapped_area;\n\t} else if (flags & MAP_SHARED) {\n\t\t/*\n\t\t * mmap_region() will call shmem_zero_setup() to create a file,\n\t\t * so use shmem's get_unmapped_area in case it can be huge.\n\t\t * do_mmap_pgoff() will clear pgoff, so match alignment.\n\t\t */\n\t\tpgoff = 0;\n\t\tget_area = shmem_get_unmapped_area;\n\t}\n\n\taddr = get_area(file, addr, len, pgoff, flags);\n\tif (IS_ERR_VALUE(addr))\n\t\treturn addr;\n\n\tif (addr > TASK_SIZE - len)\n\t\treturn -ENOMEM;\n\tif (offset_in_page(addr))\n\t\treturn -EINVAL;\n\n\terror = security_mmap_addr(addr);\n\treturn error ? error : addr;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/mmu_context.h>",
            "#include <asm/tlb.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/oom.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/printk.h>",
            "#include <linux/memory.h>",
            "#include <linux/notifier.h>",
            "#include <linux/rbtree_augmented.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/audit.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/mmdebug.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/profile.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/init.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/shm.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/mmu_context.h>\n#include <asm/tlb.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/oom.h>\n#include <linux/pkeys.h>\n#include <linux/moduleparam.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/printk.h>\n#include <linux/memory.h>\n#include <linux/notifier.h>\n#include <linux/rbtree_augmented.h>\n#include <linux/uprobes.h>\n#include <linux/khugepaged.h>\n#include <linux/audit.h>\n#include <linux/perf_event.h>\n#include <linux/mmdebug.h>\n#include <linux/mmu_notifier.h>\n#include <linux/rmap.h>\n#include <linux/mempolicy.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/profile.h>\n#include <linux/shmem_fs.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/init.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/shm.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nunsigned long\nget_unmapped_area(struct file *file, unsigned long addr, unsigned long len,\n\t\tunsigned long pgoff, unsigned long flags)\n{\n\tunsigned long (*get_area)(struct file *, unsigned long,\n\t\t\t\t  unsigned long, unsigned long, unsigned long);\n\n\tunsigned long error = arch_mmap_check(addr, len, flags);\n\tif (error)\n\t\treturn error;\n\n\t/* Careful about overflows.. */\n\tif (len > TASK_SIZE)\n\t\treturn -ENOMEM;\n\n\tget_area = current->mm->get_unmapped_area;\n\tif (file) {\n\t\tif (file->f_op->get_unmapped_area)\n\t\t\tget_area = file->f_op->get_unmapped_area;\n\t} else if (flags & MAP_SHARED) {\n\t\t/*\n\t\t * mmap_region() will call shmem_zero_setup() to create a file,\n\t\t * so use shmem's get_unmapped_area in case it can be huge.\n\t\t * do_mmap_pgoff() will clear pgoff, so match alignment.\n\t\t */\n\t\tpgoff = 0;\n\t\tget_area = shmem_get_unmapped_area;\n\t}\n\n\taddr = get_area(file, addr, len, pgoff, flags);\n\tif (IS_ERR_VALUE(addr))\n\t\treturn addr;\n\n\tif (addr > TASK_SIZE - len)\n\t\treturn -ENOMEM;\n\tif (offset_in_page(addr))\n\t\treturn -EINVAL;\n\n\terror = security_mmap_addr(addr);\n\treturn error ? error : addr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nunsigned long shmem_get_unmapped_area(struct file *file,\n\t\t\t\t      unsigned long addr, unsigned long len,\n\t\t\t\t      unsigned long pgoff, unsigned long flags)\n{\n\treturn current->mm->get_unmapped_area(file, addr, len, pgoff, flags);\n}"
  },
  {
    "function_name": "shmem_unlock_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3827-3829",
    "snippet": "void shmem_unlock_mapping(struct address_space *mapping)\n{\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nvoid shmem_unlock_mapping(struct address_space *mapping)\n{\n}"
  },
  {
    "function_name": "shmem_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3822-3825",
    "snippet": "int shmem_lock(struct file *file, int lock, struct user_struct *user)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_lock(struct file *file, int lock, struct user_struct *user)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_unuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3817-3820",
    "snippet": "int shmem_unuse(swp_entry_t swap, struct page *page)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_unuse(swp_entry_t swap, struct page *page)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3807-3815",
    "snippet": "int __init shmem_init(void)\n{\n\tBUG_ON(register_filesystem(&shmem_fs_type) != 0);\n\n\tshm_mnt = kern_mount(&shmem_fs_type);\n\tBUG_ON(IS_ERR(shm_mnt));\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct vfsmount *shm_mnt;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "IS_ERR(shm_mnt)"
          ],
          "line": 3812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "shm_mnt"
          ],
          "line": 3812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kern_mount",
          "args": [
            "&shmem_fs_type"
          ],
          "line": 3811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "register_filesystem(&shmem_fs_type) != 0"
          ],
          "line": 3809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_filesystem",
          "args": [
            "&shmem_fs_type"
          ],
          "line": 3809
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct vfsmount *shm_mnt;\n\nint __init shmem_init(void)\n{\n\tBUG_ON(register_filesystem(&shmem_fs_type) != 0);\n\n\tshm_mnt = kern_mount(&shmem_fs_type);\n\tBUG_ON(IS_ERR(shm_mnt));\n\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_huge_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3756-3786",
    "snippet": "bool shmem_huge_enabled(struct vm_area_struct *vma)\n{\n\tstruct inode *inode = file_inode(vma->vm_file);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\tloff_t i_size;\n\tpgoff_t off;\n\n\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\treturn true;\n\tif (shmem_huge == SHMEM_HUGE_DENY)\n\t\treturn false;\n\tswitch (sbinfo->huge) {\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\treturn false;\n\t\tcase SHMEM_HUGE_ALWAYS:\n\t\t\treturn true;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(vma->vm_pgoff, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\treturn true;\n\t\t\t/* fall through */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\treturn (vma->vm_flags & VM_HUGEPAGE);\n\t\tdefault:\n\t\t\tVM_BUG_ON(1);\n\t\t\treturn false;\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_huge SHMEM_HUGE_DENY",
      "#define SHMEM_HUGE_FORCE\t(-2)",
      "#define SHMEM_HUGE_DENY\t\t(-1)",
      "#define SHMEM_HUGE_ADVISE\t3",
      "#define SHMEM_HUGE_WITHIN_SIZE\t2",
      "#define SHMEM_HUGE_ALWAYS\t1",
      "#define SHMEM_HUGE_NEVER\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "1"
          ],
          "line": 3783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "i_size_read(inode)",
            "PAGE_SIZE"
          ],
          "line": 3774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 3774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "vma->vm_pgoff",
            "HPAGE_PMD_NR"
          ],
          "line": 3773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 3759
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "vma->vm_file"
          ],
          "line": 3758
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_ALWAYS\t1\n#define SHMEM_HUGE_NEVER\t0\n\nbool shmem_huge_enabled(struct vm_area_struct *vma)\n{\n\tstruct inode *inode = file_inode(vma->vm_file);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\tloff_t i_size;\n\tpgoff_t off;\n\n\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\treturn true;\n\tif (shmem_huge == SHMEM_HUGE_DENY)\n\t\treturn false;\n\tswitch (sbinfo->huge) {\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\treturn false;\n\t\tcase SHMEM_HUGE_ALWAYS:\n\t\t\treturn true;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(vma->vm_pgoff, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\treturn true;\n\t\t\t/* fall through */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\treturn (vma->vm_flags & VM_HUGEPAGE);\n\t\tdefault:\n\t\t\tVM_BUG_ON(1);\n\t\t\treturn false;\n\t}\n}"
  },
  {
    "function_name": "shmem_enabled_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3725-3749",
    "snippet": "static ssize_t shmem_enabled_store(struct kobject *kobj,\n\t\tstruct kobj_attribute *attr, const char *buf, size_t count)\n{\n\tchar tmp[16];\n\tint huge;\n\n\tif (count + 1 > sizeof(tmp))\n\t\treturn -EINVAL;\n\tmemcpy(tmp, buf, count);\n\ttmp[count] = '\\0';\n\tif (count && tmp[count - 1] == '\\n')\n\t\ttmp[count - 1] = '\\0';\n\n\thuge = shmem_parse_huge(tmp);\n\tif (huge == -EINVAL)\n\t\treturn -EINVAL;\n\tif (!has_transparent_hugepage() &&\n\t\t\thuge != SHMEM_HUGE_NEVER && huge != SHMEM_HUGE_DENY)\n\t\treturn -EINVAL;\n\n\tshmem_huge = huge;\n\tif (shmem_huge > SHMEM_HUGE_DENY)\n\t\tSHMEM_SB(shm_mnt->mnt_sb)->huge = shmem_huge;\n\treturn count;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_huge SHMEM_HUGE_DENY",
      "#define SHMEM_HUGE_DENY\t\t(-1)",
      "#define SHMEM_HUGE_NEVER\t0"
    ],
    "globals_used": [
      "static struct vfsmount *shm_mnt;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "shm_mnt->mnt_sb"
          ],
          "line": 3747
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "has_transparent_hugepage",
          "args": [],
          "line": 3741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_parse_huge",
          "args": [
            "tmp"
          ],
          "line": 3738
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_parse_huge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "393-408",
          "snippet": "static int shmem_parse_huge(const char *str)\n{\n\tif (!strcmp(str, \"never\"))\n\t\treturn SHMEM_HUGE_NEVER;\n\tif (!strcmp(str, \"always\"))\n\t\treturn SHMEM_HUGE_ALWAYS;\n\tif (!strcmp(str, \"within_size\"))\n\t\treturn SHMEM_HUGE_WITHIN_SIZE;\n\tif (!strcmp(str, \"advise\"))\n\t\treturn SHMEM_HUGE_ADVISE;\n\tif (!strcmp(str, \"deny\"))\n\t\treturn SHMEM_HUGE_DENY;\n\tif (!strcmp(str, \"force\"))\n\t\treturn SHMEM_HUGE_FORCE;\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define SHMEM_HUGE_FORCE\t(-2)",
            "#define SHMEM_HUGE_DENY\t\t(-1)",
            "#define SHMEM_HUGE_ADVISE\t3",
            "#define SHMEM_HUGE_WITHIN_SIZE\t2",
            "#define SHMEM_HUGE_ALWAYS\t1",
            "#define SHMEM_HUGE_NEVER\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_ALWAYS\t1\n#define SHMEM_HUGE_NEVER\t0\n\nstatic int shmem_parse_huge(const char *str)\n{\n\tif (!strcmp(str, \"never\"))\n\t\treturn SHMEM_HUGE_NEVER;\n\tif (!strcmp(str, \"always\"))\n\t\treturn SHMEM_HUGE_ALWAYS;\n\tif (!strcmp(str, \"within_size\"))\n\t\treturn SHMEM_HUGE_WITHIN_SIZE;\n\tif (!strcmp(str, \"advise\"))\n\t\treturn SHMEM_HUGE_ADVISE;\n\tif (!strcmp(str, \"deny\"))\n\t\treturn SHMEM_HUGE_DENY;\n\tif (!strcmp(str, \"force\"))\n\t\treturn SHMEM_HUGE_FORCE;\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "tmp",
            "buf",
            "count"
          ],
          "line": 3733
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_NEVER\t0\n\nstatic struct vfsmount *shm_mnt;\n\nstatic ssize_t shmem_enabled_store(struct kobject *kobj,\n\t\tstruct kobj_attribute *attr, const char *buf, size_t count)\n{\n\tchar tmp[16];\n\tint huge;\n\n\tif (count + 1 > sizeof(tmp))\n\t\treturn -EINVAL;\n\tmemcpy(tmp, buf, count);\n\ttmp[count] = '\\0';\n\tif (count && tmp[count - 1] == '\\n')\n\t\ttmp[count - 1] = '\\0';\n\n\thuge = shmem_parse_huge(tmp);\n\tif (huge == -EINVAL)\n\t\treturn -EINVAL;\n\tif (!has_transparent_hugepage() &&\n\t\t\thuge != SHMEM_HUGE_NEVER && huge != SHMEM_HUGE_DENY)\n\t\treturn -EINVAL;\n\n\tshmem_huge = huge;\n\tif (shmem_huge > SHMEM_HUGE_DENY)\n\t\tSHMEM_SB(shm_mnt->mnt_sb)->huge = shmem_huge;\n\treturn count;\n}"
  },
  {
    "function_name": "shmem_enabled_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3702-3723",
    "snippet": "static ssize_t shmem_enabled_show(struct kobject *kobj,\n\t\tstruct kobj_attribute *attr, char *buf)\n{\n\tint values[] = {\n\t\tSHMEM_HUGE_ALWAYS,\n\t\tSHMEM_HUGE_WITHIN_SIZE,\n\t\tSHMEM_HUGE_ADVISE,\n\t\tSHMEM_HUGE_NEVER,\n\t\tSHMEM_HUGE_DENY,\n\t\tSHMEM_HUGE_FORCE,\n\t};\n\tint i, count;\n\n\tfor (i = 0, count = 0; i < ARRAY_SIZE(values); i++) {\n\t\tconst char *fmt = shmem_huge == values[i] ? \"[%s] \" : \"%s \";\n\n\t\tcount += sprintf(buf + count, fmt,\n\t\t\t\tshmem_format_huge(values[i]));\n\t}\n\tbuf[count - 1] = '\\n';\n\treturn count;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_huge SHMEM_HUGE_DENY",
      "#define SHMEM_HUGE_FORCE\t(-2)",
      "#define SHMEM_HUGE_DENY\t\t(-1)",
      "#define SHMEM_HUGE_ADVISE\t3",
      "#define SHMEM_HUGE_WITHIN_SIZE\t2",
      "#define SHMEM_HUGE_ALWAYS\t1",
      "#define SHMEM_HUGE_NEVER\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf + count",
            "fmt",
            "shmem_format_huge(values[i])"
          ],
          "line": 3718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_format_huge",
          "args": [
            "values[i]"
          ],
          "line": 3719
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_format_huge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "410-429",
          "snippet": "static const char *shmem_format_huge(int huge)\n{\n\tswitch (huge) {\n\tcase SHMEM_HUGE_NEVER:\n\t\treturn \"never\";\n\tcase SHMEM_HUGE_ALWAYS:\n\t\treturn \"always\";\n\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\treturn \"within_size\";\n\tcase SHMEM_HUGE_ADVISE:\n\t\treturn \"advise\";\n\tcase SHMEM_HUGE_DENY:\n\t\treturn \"deny\";\n\tcase SHMEM_HUGE_FORCE:\n\t\treturn \"force\";\n\tdefault:\n\t\tVM_BUG_ON(1);\n\t\treturn \"bad_val\";\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define SHMEM_HUGE_FORCE\t(-2)",
            "#define SHMEM_HUGE_DENY\t\t(-1)",
            "#define SHMEM_HUGE_ADVISE\t3",
            "#define SHMEM_HUGE_WITHIN_SIZE\t2",
            "#define SHMEM_HUGE_ALWAYS\t1",
            "#define SHMEM_HUGE_NEVER\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_ALWAYS\t1\n#define SHMEM_HUGE_NEVER\t0\n\nstatic const char *shmem_format_huge(int huge)\n{\n\tswitch (huge) {\n\tcase SHMEM_HUGE_NEVER:\n\t\treturn \"never\";\n\tcase SHMEM_HUGE_ALWAYS:\n\t\treturn \"always\";\n\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\treturn \"within_size\";\n\tcase SHMEM_HUGE_ADVISE:\n\t\treturn \"advise\";\n\tcase SHMEM_HUGE_DENY:\n\t\treturn \"deny\";\n\tcase SHMEM_HUGE_FORCE:\n\t\treturn \"force\";\n\tdefault:\n\t\tVM_BUG_ON(1);\n\t\treturn \"bad_val\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ARRAY_SIZE",
          "args": [
            "values"
          ],
          "line": 3715
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_ALWAYS\t1\n#define SHMEM_HUGE_NEVER\t0\n\nstatic ssize_t shmem_enabled_show(struct kobject *kobj,\n\t\tstruct kobj_attribute *attr, char *buf)\n{\n\tint values[] = {\n\t\tSHMEM_HUGE_ALWAYS,\n\t\tSHMEM_HUGE_WITHIN_SIZE,\n\t\tSHMEM_HUGE_ADVISE,\n\t\tSHMEM_HUGE_NEVER,\n\t\tSHMEM_HUGE_DENY,\n\t\tSHMEM_HUGE_FORCE,\n\t};\n\tint i, count;\n\n\tfor (i = 0, count = 0; i < ARRAY_SIZE(values); i++) {\n\t\tconst char *fmt = shmem_huge == values[i] ? \"[%s] \" : \"%s \";\n\n\t\tcount += sprintf(buf + count, fmt,\n\t\t\t\tshmem_format_huge(values[i]));\n\t}\n\tbuf[count - 1] = '\\n';\n\treturn count;\n}"
  },
  {
    "function_name": "shmem_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3662-3699",
    "snippet": "int __init shmem_init(void)\n{\n\tint error;\n\n\t/* If rootfs called this, don't re-init */\n\tif (shmem_inode_cachep)\n\t\treturn 0;\n\n\tshmem_init_inodecache();\n\n\terror = register_filesystem(&shmem_fs_type);\n\tif (error) {\n\t\tpr_err(\"Could not register tmpfs\\n\");\n\t\tgoto out2;\n\t}\n\n\tshm_mnt = kern_mount(&shmem_fs_type);\n\tif (IS_ERR(shm_mnt)) {\n\t\terror = PTR_ERR(shm_mnt);\n\t\tpr_err(\"Could not kern_mount tmpfs\\n\");\n\t\tgoto out1;\n\t}\n\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\tif (has_transparent_hugepage() && shmem_huge > SHMEM_HUGE_DENY)\n\t\tSHMEM_SB(shm_mnt->mnt_sb)->huge = shmem_huge;\n\telse\n\t\tshmem_huge = 0; /* just in case it was patched */\n#endif\n\treturn 0;\n\nout1:\n\tunregister_filesystem(&shmem_fs_type);\nout2:\n\tshmem_destroy_inodecache();\n\tshm_mnt = ERR_PTR(error);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_huge SHMEM_HUGE_DENY",
      "#define SHMEM_HUGE_DENY\t\t(-1)"
    ],
    "globals_used": [
      "static struct vfsmount *shm_mnt;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 3697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_destroy_inodecache",
          "args": [],
          "line": 3696
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_destroy_inodecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3549-3552",
          "snippet": "static void shmem_destroy_inodecache(void)\n{\n\tkmem_cache_destroy(shmem_inode_cachep);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_destroy_inodecache(void)\n{\n\tkmem_cache_destroy(shmem_inode_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unregister_filesystem",
          "args": [
            "&shmem_fs_type"
          ],
          "line": 3694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "shm_mnt->mnt_sb"
          ],
          "line": 3687
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "has_transparent_hugepage",
          "args": [],
          "line": 3686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Could not kern_mount tmpfs\\n\""
          ],
          "line": 3681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "shm_mnt"
          ],
          "line": 3680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "shm_mnt"
          ],
          "line": 3679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kern_mount",
          "args": [
            "&shmem_fs_type"
          ],
          "line": 3678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Could not register tmpfs\\n\""
          ],
          "line": 3674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "register_filesystem",
          "args": [
            "&shmem_fs_type"
          ],
          "line": 3672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_init_inodecache",
          "args": [],
          "line": 3670
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_init_inodecache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3542-3547",
          "snippet": "static void shmem_init_inodecache(void)\n{\n\tshmem_inode_cachep = kmem_cache_create(\"shmem_inode_cache\",\n\t\t\t\tsizeof(struct shmem_inode_info),\n\t\t\t\t0, SLAB_PANIC|SLAB_ACCOUNT, shmem_init_inode);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_init_inodecache(void)\n{\n\tshmem_inode_cachep = kmem_cache_create(\"shmem_inode_cache\",\n\t\t\t\tsizeof(struct shmem_inode_info),\n\t\t\t\t0, SLAB_PANIC|SLAB_ACCOUNT, shmem_init_inode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_DENY\t\t(-1)\n\nstatic struct vfsmount *shm_mnt;\n\nint __init shmem_init(void)\n{\n\tint error;\n\n\t/* If rootfs called this, don't re-init */\n\tif (shmem_inode_cachep)\n\t\treturn 0;\n\n\tshmem_init_inodecache();\n\n\terror = register_filesystem(&shmem_fs_type);\n\tif (error) {\n\t\tpr_err(\"Could not register tmpfs\\n\");\n\t\tgoto out2;\n\t}\n\n\tshm_mnt = kern_mount(&shmem_fs_type);\n\tif (IS_ERR(shm_mnt)) {\n\t\terror = PTR_ERR(shm_mnt);\n\t\tpr_err(\"Could not kern_mount tmpfs\\n\");\n\t\tgoto out1;\n\t}\n\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\tif (has_transparent_hugepage() && shmem_huge > SHMEM_HUGE_DENY)\n\t\tSHMEM_SB(shm_mnt->mnt_sb)->huge = shmem_huge;\n\telse\n\t\tshmem_huge = 0; /* just in case it was patched */\n#endif\n\treturn 0;\n\nout1:\n\tunregister_filesystem(&shmem_fs_type);\nout2:\n\tshmem_destroy_inodecache();\n\tshm_mnt = ERR_PTR(error);\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3648-3652",
    "snippet": "static struct dentry *shmem_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *data)\n{\n\treturn mount_nodev(fs_type, flags, data, shmem_fill_super);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mount_nodev",
          "args": [
            "fs_type",
            "flags",
            "data",
            "shmem_fill_super"
          ],
          "line": 3651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct dentry *shmem_mount(struct file_system_type *fs_type,\n\tint flags, const char *dev_name, void *data)\n{\n\treturn mount_nodev(fs_type, flags, data, shmem_fill_super);\n}"
  },
  {
    "function_name": "shmem_destroy_inodecache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3549-3552",
    "snippet": "static void shmem_destroy_inodecache(void)\n{\n\tkmem_cache_destroy(shmem_inode_cachep);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "shmem_inode_cachep"
          ],
          "line": 3551
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "874-906",
          "snippet": "void kmem_cache_destroy(struct kmem_cache *s)\n{\n\tint err;\n\n\tif (unlikely(!s))\n\t\treturn;\n\n\tflush_memcg_workqueue(s);\n\n\tget_online_cpus();\n\tget_online_mems();\n\n\tmutex_lock(&slab_mutex);\n\n\ts->refcount--;\n\tif (s->refcount)\n\t\tgoto out_unlock;\n\n\terr = shutdown_memcg_caches(s);\n\tif (!err)\n\t\terr = shutdown_cache(s);\n\n\tif (err) {\n\t\tpr_err(\"kmem_cache_destroy %s: Slab cache still has objects\\n\",\n\t\t       s->name);\n\t\tdump_stack();\n\t}\nout_unlock:\n\tmutex_unlock(&slab_mutex);\n\n\tput_online_mems();\n\tput_online_cpus();\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct kmem_cache *kmem_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nstruct kmem_cache *kmem_cache;\n\nvoid kmem_cache_destroy(struct kmem_cache *s)\n{\n\tint err;\n\n\tif (unlikely(!s))\n\t\treturn;\n\n\tflush_memcg_workqueue(s);\n\n\tget_online_cpus();\n\tget_online_mems();\n\n\tmutex_lock(&slab_mutex);\n\n\ts->refcount--;\n\tif (s->refcount)\n\t\tgoto out_unlock;\n\n\terr = shutdown_memcg_caches(s);\n\tif (!err)\n\t\terr = shutdown_cache(s);\n\n\tif (err) {\n\t\tpr_err(\"kmem_cache_destroy %s: Slab cache still has objects\\n\",\n\t\t       s->name);\n\t\tdump_stack();\n\t}\nout_unlock:\n\tmutex_unlock(&slab_mutex);\n\n\tput_online_mems();\n\tput_online_cpus();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_destroy_inodecache(void)\n{\n\tkmem_cache_destroy(shmem_inode_cachep);\n}"
  },
  {
    "function_name": "shmem_init_inodecache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3542-3547",
    "snippet": "static void shmem_init_inodecache(void)\n{\n\tshmem_inode_cachep = kmem_cache_create(\"shmem_inode_cache\",\n\t\t\t\tsizeof(struct shmem_inode_info),\n\t\t\t\t0, SLAB_PANIC|SLAB_ACCOUNT, shmem_init_inode);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"shmem_inode_cache\"",
            "sizeof(struct shmem_inode_info)",
            "0",
            "SLAB_PANIC|SLAB_ACCOUNT",
            "shmem_init_inode"
          ],
          "line": 3544
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "517-523",
          "snippet": "struct kmem_cache *\nkmem_cache_create(const char *name, unsigned int size, unsigned int align,\n\t\tslab_flags_t flags, void (*ctor)(void *))\n{\n\treturn kmem_cache_create_usercopy(name, size, align, flags, 0, 0,\n\t\t\t\t\t  ctor);\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct kmem_cache *kmem_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nstruct kmem_cache *kmem_cache;\n\nstruct kmem_cache *\nkmem_cache_create(const char *name, unsigned int size, unsigned int align,\n\t\tslab_flags_t flags, void (*ctor)(void *))\n{\n\treturn kmem_cache_create_usercopy(name, size, align, flags, 0, 0,\n\t\t\t\t\t  ctor);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_init_inodecache(void)\n{\n\tshmem_inode_cachep = kmem_cache_create(\"shmem_inode_cache\",\n\t\t\t\tsizeof(struct shmem_inode_info),\n\t\t\t\t0, SLAB_PANIC|SLAB_ACCOUNT, shmem_init_inode);\n}"
  },
  {
    "function_name": "shmem_init_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3536-3540",
    "snippet": "static void shmem_init_inode(void *foo)\n{\n\tstruct shmem_inode_info *info = foo;\n\tinode_init_once(&info->vfs_inode);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode_init_once",
          "args": [
            "&info->vfs_inode"
          ],
          "line": 3539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_init_inode(void *foo)\n{\n\tstruct shmem_inode_info *info = foo;\n\tinode_init_once(&info->vfs_inode);\n}"
  },
  {
    "function_name": "shmem_destroy_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3529-3534",
    "snippet": "static void shmem_destroy_inode(struct inode *inode)\n{\n\tif (S_ISREG(inode->i_mode))\n\t\tmpol_free_shared_policy(&SHMEM_I(inode)->policy);\n\tcall_rcu(&inode->i_rcu, shmem_destroy_callback);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "call_rcu",
          "args": [
            "&inode->i_rcu",
            "shmem_destroy_callback"
          ],
          "line": 3533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mpol_free_shared_policy",
          "args": [
            "&SHMEM_I(inode)->policy"
          ],
          "line": 3532
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_free_shared_policy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2532-2547",
          "snippet": "void mpol_free_shared_policy(struct shared_policy *p)\n{\n\tstruct sp_node *n;\n\tstruct rb_node *next;\n\n\tif (!p->root.rb_node)\n\t\treturn;\n\twrite_lock(&p->lock);\n\tnext = rb_first(&p->root);\n\twhile (next) {\n\t\tn = rb_entry(next, struct sp_node, nd);\n\t\tnext = rb_next(&n->nd);\n\t\tsp_delete(p, n);\n\t}\n\twrite_unlock(&p->lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nvoid mpol_free_shared_policy(struct shared_policy *p)\n{\n\tstruct sp_node *n;\n\tstruct rb_node *next;\n\n\tif (!p->root.rb_node)\n\t\treturn;\n\twrite_lock(&p->lock);\n\tnext = rb_first(&p->root);\n\twhile (next) {\n\t\tn = rb_entry(next, struct sp_node, nd);\n\t\tnext = rb_next(&n->nd);\n\t\tsp_delete(p, n);\n\t}\n\twrite_unlock(&p->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 3532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 3531
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_destroy_inode(struct inode *inode)\n{\n\tif (S_ISREG(inode->i_mode))\n\t\tmpol_free_shared_policy(&SHMEM_I(inode)->policy);\n\tcall_rcu(&inode->i_rcu, shmem_destroy_callback);\n}"
  },
  {
    "function_name": "shmem_destroy_callback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3521-3527",
    "snippet": "static void shmem_destroy_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\tif (S_ISLNK(inode->i_mode))\n\t\tkfree(inode->i_link);\n\tkmem_cache_free(shmem_inode_cachep, SHMEM_I(inode));\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "shmem_inode_cachep",
            "SHMEM_I(inode)"
          ],
          "line": 3526
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3749-3764",
          "snippet": "void kmem_cache_free(struct kmem_cache *cachep, void *objp)\n{\n\tunsigned long flags;\n\tcachep = cache_from_obj(cachep, objp);\n\tif (!cachep)\n\t\treturn;\n\n\tlocal_irq_save(flags);\n\tdebug_check_no_locks_freed(objp, cachep->object_size);\n\tif (!(cachep->flags & SLAB_DEBUG_OBJECTS))\n\t\tdebug_check_no_obj_freed(objp, cachep->object_size);\n\t__cache_free(cachep, objp, _RET_IP_);\n\tlocal_irq_restore(flags);\n\n\ttrace_kmem_cache_free(_RET_IP_, objp);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid kmem_cache_free(struct kmem_cache *cachep, void *objp)\n{\n\tunsigned long flags;\n\tcachep = cache_from_obj(cachep, objp);\n\tif (!cachep)\n\t\treturn;\n\n\tlocal_irq_save(flags);\n\tdebug_check_no_locks_freed(objp, cachep->object_size);\n\tif (!(cachep->flags & SLAB_DEBUG_OBJECTS))\n\t\tdebug_check_no_obj_freed(objp, cachep->object_size);\n\t__cache_free(cachep, objp, _RET_IP_);\n\tlocal_irq_restore(flags);\n\n\ttrace_kmem_cache_free(_RET_IP_, objp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 3526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "inode->i_link"
          ],
          "line": 3525
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "inode->i_mode"
          ],
          "line": 3524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "head",
            "structinode",
            "i_rcu"
          ],
          "line": 3523
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_destroy_callback(struct rcu_head *head)\n{\n\tstruct inode *inode = container_of(head, struct inode, i_rcu);\n\tif (S_ISLNK(inode->i_mode))\n\t\tkfree(inode->i_link);\n\tkmem_cache_free(shmem_inode_cachep, SHMEM_I(inode));\n}"
  },
  {
    "function_name": "shmem_alloc_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3512-3519",
    "snippet": "static struct inode *shmem_alloc_inode(struct super_block *sb)\n{\n\tstruct shmem_inode_info *info;\n\tinfo = kmem_cache_alloc(shmem_inode_cachep, GFP_KERNEL);\n\tif (!info)\n\t\treturn NULL;\n\treturn &info->vfs_inode;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "shmem_inode_cachep",
            "GFP_KERNEL"
          ],
          "line": 3515
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3550-3559",
          "snippet": "void *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct inode *shmem_alloc_inode(struct super_block *sb)\n{\n\tstruct shmem_inode_info *info;\n\tinfo = kmem_cache_alloc(shmem_inode_cachep, GFP_KERNEL);\n\tif (!info)\n\t\treturn NULL;\n\treturn &info->vfs_inode;\n}"
  },
  {
    "function_name": "shmem_fill_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3435-3508",
    "snippet": "int shmem_fill_super(struct super_block *sb, void *data, int silent)\n{\n\tstruct inode *inode;\n\tstruct shmem_sb_info *sbinfo;\n\tint err = -ENOMEM;\n\n\t/* Round up to L1_CACHE_BYTES to resist false sharing */\n\tsbinfo = kzalloc(max((int)sizeof(struct shmem_sb_info),\n\t\t\t\tL1_CACHE_BYTES), GFP_KERNEL);\n\tif (!sbinfo)\n\t\treturn -ENOMEM;\n\n\tsbinfo->mode = 0777 | S_ISVTX;\n\tsbinfo->uid = current_fsuid();\n\tsbinfo->gid = current_fsgid();\n\tsb->s_fs_info = sbinfo;\n\n#ifdef CONFIG_TMPFS\n\t/*\n\t * Per default we only allow half of the physical ram per\n\t * tmpfs instance, limiting inodes to one per page of lowmem;\n\t * but the internal instance is left unlimited.\n\t */\n\tif (!(sb->s_flags & SB_KERNMOUNT)) {\n\t\tsbinfo->max_blocks = shmem_default_max_blocks();\n\t\tsbinfo->max_inodes = shmem_default_max_inodes();\n\t\tif (shmem_parse_options(data, sbinfo, false)) {\n\t\t\terr = -EINVAL;\n\t\t\tgoto failed;\n\t\t}\n\t} else {\n\t\tsb->s_flags |= SB_NOUSER;\n\t}\n\tsb->s_export_op = &shmem_export_ops;\n\tsb->s_flags |= SB_NOSEC;\n#else\n\tsb->s_flags |= SB_NOUSER;\n#endif\n\n\tspin_lock_init(&sbinfo->stat_lock);\n\tif (percpu_counter_init(&sbinfo->used_blocks, 0, GFP_KERNEL))\n\t\tgoto failed;\n\tsbinfo->free_inodes = sbinfo->max_inodes;\n\tspin_lock_init(&sbinfo->shrinklist_lock);\n\tINIT_LIST_HEAD(&sbinfo->shrinklist);\n\n\tsb->s_maxbytes = MAX_LFS_FILESIZE;\n\tsb->s_blocksize = PAGE_SIZE;\n\tsb->s_blocksize_bits = PAGE_SHIFT;\n\tsb->s_magic = TMPFS_MAGIC;\n\tsb->s_op = &shmem_ops;\n\tsb->s_time_gran = 1;\n#ifdef CONFIG_TMPFS_XATTR\n\tsb->s_xattr = shmem_xattr_handlers;\n#endif\n#ifdef CONFIG_TMPFS_POSIX_ACL\n\tsb->s_flags |= SB_POSIXACL;\n#endif\n\tuuid_gen(&sb->s_uuid);\n\n\tinode = shmem_get_inode(sb, NULL, S_IFDIR | sbinfo->mode, 0, VM_NORESERVE);\n\tif (!inode)\n\t\tgoto failed;\n\tinode->i_uid = sbinfo->uid;\n\tinode->i_gid = sbinfo->gid;\n\tsb->s_root = d_make_root(inode);\n\tif (!sb->s_root)\n\t\tgoto failed;\n\treturn 0;\n\nfailed:\n\tshmem_put_super(sb);\n\treturn err;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_put_super",
          "args": [
            "sb"
          ],
          "line": 3506
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_put_super",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3425-3433",
          "snippet": "static void shmem_put_super(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tpercpu_counter_destroy(&sbinfo->used_blocks);\n\tmpol_put(sbinfo->mpol);\n\tkfree(sbinfo);\n\tsb->s_fs_info = NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_put_super(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tpercpu_counter_destroy(&sbinfo->used_blocks);\n\tmpol_put(sbinfo->mpol);\n\tkfree(sbinfo);\n\tsb->s_fs_info = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_make_root",
          "args": [
            "inode"
          ],
          "line": 3500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_get_inode",
          "args": [
            "sb",
            "NULL",
            "S_IFDIR | sbinfo->mode",
            "0",
            "VM_NORESERVE"
          ],
          "line": 3495
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2134-2193",
          "snippet": "static struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_file_operations\t\t\tramfs_file_operations",
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n#define BOGO_DIRENT_SIZE 20\n\nstatic struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "uuid_gen",
          "args": [
            "&sb->s_uuid"
          ],
          "line": 3493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&sbinfo->shrinklist"
          ],
          "line": 3479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 3478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_init",
          "args": [
            "&sbinfo->used_blocks",
            "0",
            "GFP_KERNEL"
          ],
          "line": 3475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 3474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_parse_options",
          "args": [
            "data",
            "sbinfo",
            "false"
          ],
          "line": 3461
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_parse_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3237-3350",
          "snippet": "static int shmem_parse_options(char *options, struct shmem_sb_info *sbinfo,\n\t\t\t       bool remount)\n{\n\tchar *this_char, *value, *rest;\n\tstruct mempolicy *mpol = NULL;\n\tuid_t uid;\n\tgid_t gid;\n\n\twhile (options != NULL) {\n\t\tthis_char = options;\n\t\tfor (;;) {\n\t\t\t/*\n\t\t\t * NUL-terminate this option: unfortunately,\n\t\t\t * mount options form a comma-separated list,\n\t\t\t * but mpol's nodelist may also contain commas.\n\t\t\t */\n\t\t\toptions = strchr(options, ',');\n\t\t\tif (options == NULL)\n\t\t\t\tbreak;\n\t\t\toptions++;\n\t\t\tif (!isdigit(*options)) {\n\t\t\t\toptions[-1] = '\\0';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!*this_char)\n\t\t\tcontinue;\n\t\tif ((value = strchr(this_char,'=')) != NULL) {\n\t\t\t*value++ = 0;\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: No value for mount option '%s'\\n\",\n\t\t\t       this_char);\n\t\t\tgoto error;\n\t\t}\n\n\t\tif (!strcmp(this_char,\"size\")) {\n\t\t\tunsigned long long size;\n\t\t\tsize = memparse(value,&rest);\n\t\t\tif (*rest == '%') {\n\t\t\t\tsize <<= PAGE_SHIFT;\n\t\t\t\tsize *= totalram_pages;\n\t\t\t\tdo_div(size, 100);\n\t\t\t\trest++;\n\t\t\t}\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->max_blocks =\n\t\t\t\tDIV_ROUND_UP(size, PAGE_SIZE);\n\t\t} else if (!strcmp(this_char,\"nr_blocks\")) {\n\t\t\tsbinfo->max_blocks = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"nr_inodes\")) {\n\t\t\tsbinfo->max_inodes = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"mode\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tsbinfo->mode = simple_strtoul(value, &rest, 8) & 07777;\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"uid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tuid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->uid = make_kuid(current_user_ns(), uid);\n\t\t\tif (!uid_valid(sbinfo->uid))\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"gid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tgid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->gid = make_kgid(current_user_ns(), gid);\n\t\t\tif (!gid_valid(sbinfo->gid))\n\t\t\t\tgoto bad_val;\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\t\t} else if (!strcmp(this_char, \"huge\")) {\n\t\t\tint huge;\n\t\t\thuge = shmem_parse_huge(value);\n\t\t\tif (huge < 0)\n\t\t\t\tgoto bad_val;\n\t\t\tif (!has_transparent_hugepage() &&\n\t\t\t\t\thuge != SHMEM_HUGE_NEVER)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->huge = huge;\n#endif\n#ifdef CONFIG_NUMA\n\t\t} else if (!strcmp(this_char,\"mpol\")) {\n\t\t\tmpol_put(mpol);\n\t\t\tmpol = NULL;\n\t\t\tif (mpol_parse_str(value, &mpol))\n\t\t\t\tgoto bad_val;\n#endif\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: Bad mount option %s\\n\", this_char);\n\t\t\tgoto error;\n\t\t}\n\t}\n\tsbinfo->mpol = mpol;\n\treturn 0;\n\nbad_val:\n\tpr_err(\"tmpfs: Bad value '%s' for mount option '%s'\\n\",\n\t       value, this_char);\nerror:\n\tmpol_put(mpol);\n\treturn 1;\n\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define SHMEM_HUGE_NEVER\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_NEVER\t0\n\nstatic int shmem_parse_options(char *options, struct shmem_sb_info *sbinfo,\n\t\t\t       bool remount)\n{\n\tchar *this_char, *value, *rest;\n\tstruct mempolicy *mpol = NULL;\n\tuid_t uid;\n\tgid_t gid;\n\n\twhile (options != NULL) {\n\t\tthis_char = options;\n\t\tfor (;;) {\n\t\t\t/*\n\t\t\t * NUL-terminate this option: unfortunately,\n\t\t\t * mount options form a comma-separated list,\n\t\t\t * but mpol's nodelist may also contain commas.\n\t\t\t */\n\t\t\toptions = strchr(options, ',');\n\t\t\tif (options == NULL)\n\t\t\t\tbreak;\n\t\t\toptions++;\n\t\t\tif (!isdigit(*options)) {\n\t\t\t\toptions[-1] = '\\0';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!*this_char)\n\t\t\tcontinue;\n\t\tif ((value = strchr(this_char,'=')) != NULL) {\n\t\t\t*value++ = 0;\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: No value for mount option '%s'\\n\",\n\t\t\t       this_char);\n\t\t\tgoto error;\n\t\t}\n\n\t\tif (!strcmp(this_char,\"size\")) {\n\t\t\tunsigned long long size;\n\t\t\tsize = memparse(value,&rest);\n\t\t\tif (*rest == '%') {\n\t\t\t\tsize <<= PAGE_SHIFT;\n\t\t\t\tsize *= totalram_pages;\n\t\t\t\tdo_div(size, 100);\n\t\t\t\trest++;\n\t\t\t}\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->max_blocks =\n\t\t\t\tDIV_ROUND_UP(size, PAGE_SIZE);\n\t\t} else if (!strcmp(this_char,\"nr_blocks\")) {\n\t\t\tsbinfo->max_blocks = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"nr_inodes\")) {\n\t\t\tsbinfo->max_inodes = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"mode\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tsbinfo->mode = simple_strtoul(value, &rest, 8) & 07777;\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"uid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tuid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->uid = make_kuid(current_user_ns(), uid);\n\t\t\tif (!uid_valid(sbinfo->uid))\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"gid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tgid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->gid = make_kgid(current_user_ns(), gid);\n\t\t\tif (!gid_valid(sbinfo->gid))\n\t\t\t\tgoto bad_val;\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\t\t} else if (!strcmp(this_char, \"huge\")) {\n\t\t\tint huge;\n\t\t\thuge = shmem_parse_huge(value);\n\t\t\tif (huge < 0)\n\t\t\t\tgoto bad_val;\n\t\t\tif (!has_transparent_hugepage() &&\n\t\t\t\t\thuge != SHMEM_HUGE_NEVER)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->huge = huge;\n#endif\n#ifdef CONFIG_NUMA\n\t\t} else if (!strcmp(this_char,\"mpol\")) {\n\t\t\tmpol_put(mpol);\n\t\t\tmpol = NULL;\n\t\t\tif (mpol_parse_str(value, &mpol))\n\t\t\t\tgoto bad_val;\n#endif\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: Bad mount option %s\\n\", this_char);\n\t\t\tgoto error;\n\t\t}\n\t}\n\tsbinfo->mpol = mpol;\n\treturn 0;\n\nbad_val:\n\tpr_err(\"tmpfs: Bad value '%s' for mount option '%s'\\n\",\n\t       value, this_char);\nerror:\n\tmpol_put(mpol);\n\treturn 1;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_default_max_inodes",
          "args": [],
          "line": 3460
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_default_max_inodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "115-118",
          "snippet": "static unsigned long shmem_default_max_inodes(void)\n{\n\treturn min(totalram_pages - totalhigh_pages, totalram_pages / 2);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_default_max_inodes(void)\n{\n\treturn min(totalram_pages - totalhigh_pages, totalram_pages / 2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_default_max_blocks",
          "args": [],
          "line": 3459
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_default_max_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "110-113",
          "snippet": "static unsigned long shmem_default_max_blocks(void)\n{\n\treturn totalram_pages / 2;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_default_max_blocks(void)\n{\n\treturn totalram_pages / 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_fsgid",
          "args": [],
          "line": 3449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_fsuid",
          "args": [],
          "line": 3448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "max((int)sizeof(struct shmem_sb_info),\n\t\t\t\tL1_CACHE_BYTES)",
            "GFP_KERNEL"
          ],
          "line": 3442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "(int)sizeof(struct shmem_sb_info)",
            "L1_CACHE_BYTES"
          ],
          "line": 3442
        },
        "resolved": true,
        "details": {
          "function_name": "wb_max_pause",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "1418-1435",
          "snippet": "static unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_PAUSE\t\tmax(HZ/5, 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define MAX_PAUSE\t\tmax(HZ/5, 1)\n\nstatic unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_fill_super(struct super_block *sb, void *data, int silent)\n{\n\tstruct inode *inode;\n\tstruct shmem_sb_info *sbinfo;\n\tint err = -ENOMEM;\n\n\t/* Round up to L1_CACHE_BYTES to resist false sharing */\n\tsbinfo = kzalloc(max((int)sizeof(struct shmem_sb_info),\n\t\t\t\tL1_CACHE_BYTES), GFP_KERNEL);\n\tif (!sbinfo)\n\t\treturn -ENOMEM;\n\n\tsbinfo->mode = 0777 | S_ISVTX;\n\tsbinfo->uid = current_fsuid();\n\tsbinfo->gid = current_fsgid();\n\tsb->s_fs_info = sbinfo;\n\n#ifdef CONFIG_TMPFS\n\t/*\n\t * Per default we only allow half of the physical ram per\n\t * tmpfs instance, limiting inodes to one per page of lowmem;\n\t * but the internal instance is left unlimited.\n\t */\n\tif (!(sb->s_flags & SB_KERNMOUNT)) {\n\t\tsbinfo->max_blocks = shmem_default_max_blocks();\n\t\tsbinfo->max_inodes = shmem_default_max_inodes();\n\t\tif (shmem_parse_options(data, sbinfo, false)) {\n\t\t\terr = -EINVAL;\n\t\t\tgoto failed;\n\t\t}\n\t} else {\n\t\tsb->s_flags |= SB_NOUSER;\n\t}\n\tsb->s_export_op = &shmem_export_ops;\n\tsb->s_flags |= SB_NOSEC;\n#else\n\tsb->s_flags |= SB_NOUSER;\n#endif\n\n\tspin_lock_init(&sbinfo->stat_lock);\n\tif (percpu_counter_init(&sbinfo->used_blocks, 0, GFP_KERNEL))\n\t\tgoto failed;\n\tsbinfo->free_inodes = sbinfo->max_inodes;\n\tspin_lock_init(&sbinfo->shrinklist_lock);\n\tINIT_LIST_HEAD(&sbinfo->shrinklist);\n\n\tsb->s_maxbytes = MAX_LFS_FILESIZE;\n\tsb->s_blocksize = PAGE_SIZE;\n\tsb->s_blocksize_bits = PAGE_SHIFT;\n\tsb->s_magic = TMPFS_MAGIC;\n\tsb->s_op = &shmem_ops;\n\tsb->s_time_gran = 1;\n#ifdef CONFIG_TMPFS_XATTR\n\tsb->s_xattr = shmem_xattr_handlers;\n#endif\n#ifdef CONFIG_TMPFS_POSIX_ACL\n\tsb->s_flags |= SB_POSIXACL;\n#endif\n\tuuid_gen(&sb->s_uuid);\n\n\tinode = shmem_get_inode(sb, NULL, S_IFDIR | sbinfo->mode, 0, VM_NORESERVE);\n\tif (!inode)\n\t\tgoto failed;\n\tinode->i_uid = sbinfo->uid;\n\tinode->i_gid = sbinfo->gid;\n\tsb->s_root = d_make_root(inode);\n\tif (!sb->s_root)\n\t\tgoto failed;\n\treturn 0;\n\nfailed:\n\tshmem_put_super(sb);\n\treturn err;\n}"
  },
  {
    "function_name": "shmem_put_super",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3425-3433",
    "snippet": "static void shmem_put_super(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tpercpu_counter_destroy(&sbinfo->used_blocks);\n\tmpol_put(sbinfo->mpol);\n\tkfree(sbinfo);\n\tsb->s_fs_info = NULL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "sbinfo"
          ],
          "line": 3431
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mpol_put",
          "args": [
            "sbinfo->mpol"
          ],
          "line": 3430
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_put_task_policy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2345-2354",
          "snippet": "void mpol_put_task_policy(struct task_struct *task)\n{\n\tstruct mempolicy *pol;\n\n\ttask_lock(task);\n\tpol = task->mempolicy;\n\ttask->mempolicy = NULL;\n\ttask_unlock(task);\n\tmpol_put(pol);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nvoid mpol_put_task_policy(struct task_struct *task)\n{\n\tstruct mempolicy *pol;\n\n\ttask_lock(task);\n\tpol = task->mempolicy;\n\ttask->mempolicy = NULL;\n\ttask_unlock(task);\n\tmpol_put(pol);\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_counter_destroy",
          "args": [
            "&sbinfo->used_blocks"
          ],
          "line": 3429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "sb"
          ],
          "line": 3427
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_put_super(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tpercpu_counter_destroy(&sbinfo->used_blocks);\n\tmpol_put(sbinfo->mpol);\n\tkfree(sbinfo);\n\tsb->s_fs_info = NULL;\n}"
  },
  {
    "function_name": "shmem_show_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3397-3421",
    "snippet": "static int shmem_show_options(struct seq_file *seq, struct dentry *root)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(root->d_sb);\n\n\tif (sbinfo->max_blocks != shmem_default_max_blocks())\n\t\tseq_printf(seq, \",size=%luk\",\n\t\t\tsbinfo->max_blocks << (PAGE_SHIFT - 10));\n\tif (sbinfo->max_inodes != shmem_default_max_inodes())\n\t\tseq_printf(seq, \",nr_inodes=%lu\", sbinfo->max_inodes);\n\tif (sbinfo->mode != (0777 | S_ISVTX))\n\t\tseq_printf(seq, \",mode=%03ho\", sbinfo->mode);\n\tif (!uid_eq(sbinfo->uid, GLOBAL_ROOT_UID))\n\t\tseq_printf(seq, \",uid=%u\",\n\t\t\t\tfrom_kuid_munged(&init_user_ns, sbinfo->uid));\n\tif (!gid_eq(sbinfo->gid, GLOBAL_ROOT_GID))\n\t\tseq_printf(seq, \",gid=%u\",\n\t\t\t\tfrom_kgid_munged(&init_user_ns, sbinfo->gid));\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\t/* Rightly or wrongly, show huge mount option unmasked by shmem_huge */\n\tif (sbinfo->huge)\n\t\tseq_printf(seq, \",huge=%s\", shmem_format_huge(sbinfo->huge));\n#endif\n\tshmem_show_mpol(seq, sbinfo->mpol);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_huge SHMEM_HUGE_DENY"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_show_mpol",
          "args": [
            "seq",
            "sbinfo->mpol"
          ],
          "line": 3419
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_show_mpol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1376-1378",
          "snippet": "static inline void shmem_show_mpol(struct seq_file *seq, struct mempolicy *mpol)\n{\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_show_mpol(struct seq_file *seq, struct mempolicy *mpol)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\",huge=%s\"",
            "shmem_format_huge(sbinfo->huge)"
          ],
          "line": 3417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_format_huge",
          "args": [
            "sbinfo->huge"
          ],
          "line": 3417
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_format_huge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "410-429",
          "snippet": "static const char *shmem_format_huge(int huge)\n{\n\tswitch (huge) {\n\tcase SHMEM_HUGE_NEVER:\n\t\treturn \"never\";\n\tcase SHMEM_HUGE_ALWAYS:\n\t\treturn \"always\";\n\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\treturn \"within_size\";\n\tcase SHMEM_HUGE_ADVISE:\n\t\treturn \"advise\";\n\tcase SHMEM_HUGE_DENY:\n\t\treturn \"deny\";\n\tcase SHMEM_HUGE_FORCE:\n\t\treturn \"force\";\n\tdefault:\n\t\tVM_BUG_ON(1);\n\t\treturn \"bad_val\";\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define SHMEM_HUGE_FORCE\t(-2)",
            "#define SHMEM_HUGE_DENY\t\t(-1)",
            "#define SHMEM_HUGE_ADVISE\t3",
            "#define SHMEM_HUGE_WITHIN_SIZE\t2",
            "#define SHMEM_HUGE_ALWAYS\t1",
            "#define SHMEM_HUGE_NEVER\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_ALWAYS\t1\n#define SHMEM_HUGE_NEVER\t0\n\nstatic const char *shmem_format_huge(int huge)\n{\n\tswitch (huge) {\n\tcase SHMEM_HUGE_NEVER:\n\t\treturn \"never\";\n\tcase SHMEM_HUGE_ALWAYS:\n\t\treturn \"always\";\n\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\treturn \"within_size\";\n\tcase SHMEM_HUGE_ADVISE:\n\t\treturn \"advise\";\n\tcase SHMEM_HUGE_DENY:\n\t\treturn \"deny\";\n\tcase SHMEM_HUGE_FORCE:\n\t\treturn \"force\";\n\tdefault:\n\t\tVM_BUG_ON(1);\n\t\treturn \"bad_val\";\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\",gid=%u\"",
            "from_kgid_munged(&init_user_ns, sbinfo->gid)"
          ],
          "line": 3412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kgid_munged",
          "args": [
            "&init_user_ns",
            "sbinfo->gid"
          ],
          "line": 3413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_eq",
          "args": [
            "sbinfo->gid",
            "GLOBAL_ROOT_GID"
          ],
          "line": 3411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\",uid=%u\"",
            "from_kuid_munged(&init_user_ns, sbinfo->uid)"
          ],
          "line": 3409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "from_kuid_munged",
          "args": [
            "&init_user_ns",
            "sbinfo->uid"
          ],
          "line": 3410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_eq",
          "args": [
            "sbinfo->uid",
            "GLOBAL_ROOT_UID"
          ],
          "line": 3408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\",mode=%03ho\"",
            "sbinfo->mode"
          ],
          "line": 3407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\",nr_inodes=%lu\"",
            "sbinfo->max_inodes"
          ],
          "line": 3405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_default_max_inodes",
          "args": [],
          "line": 3404
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_default_max_inodes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "115-118",
          "snippet": "static unsigned long shmem_default_max_inodes(void)\n{\n\treturn min(totalram_pages - totalhigh_pages, totalram_pages / 2);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_default_max_inodes(void)\n{\n\treturn min(totalram_pages - totalhigh_pages, totalram_pages / 2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\",size=%luk\"",
            "sbinfo->max_blocks << (PAGE_SHIFT - 10)"
          ],
          "line": 3402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_default_max_blocks",
          "args": [],
          "line": 3401
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_default_max_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "110-113",
          "snippet": "static unsigned long shmem_default_max_blocks(void)\n{\n\treturn totalram_pages / 2;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_default_max_blocks(void)\n{\n\treturn totalram_pages / 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "root->d_sb"
          ],
          "line": 3399
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n\nstatic int shmem_show_options(struct seq_file *seq, struct dentry *root)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(root->d_sb);\n\n\tif (sbinfo->max_blocks != shmem_default_max_blocks())\n\t\tseq_printf(seq, \",size=%luk\",\n\t\t\tsbinfo->max_blocks << (PAGE_SHIFT - 10));\n\tif (sbinfo->max_inodes != shmem_default_max_inodes())\n\t\tseq_printf(seq, \",nr_inodes=%lu\", sbinfo->max_inodes);\n\tif (sbinfo->mode != (0777 | S_ISVTX))\n\t\tseq_printf(seq, \",mode=%03ho\", sbinfo->mode);\n\tif (!uid_eq(sbinfo->uid, GLOBAL_ROOT_UID))\n\t\tseq_printf(seq, \",uid=%u\",\n\t\t\t\tfrom_kuid_munged(&init_user_ns, sbinfo->uid));\n\tif (!gid_eq(sbinfo->gid, GLOBAL_ROOT_GID))\n\t\tseq_printf(seq, \",gid=%u\",\n\t\t\t\tfrom_kgid_munged(&init_user_ns, sbinfo->gid));\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\t/* Rightly or wrongly, show huge mount option unmasked by shmem_huge */\n\tif (sbinfo->huge)\n\t\tseq_printf(seq, \",huge=%s\", shmem_format_huge(sbinfo->huge));\n#endif\n\tshmem_show_mpol(seq, sbinfo->mpol);\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_remount_fs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3352-3395",
    "snippet": "static int shmem_remount_fs(struct super_block *sb, int *flags, char *data)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tstruct shmem_sb_info config = *sbinfo;\n\tunsigned long inodes;\n\tint error = -EINVAL;\n\n\tconfig.mpol = NULL;\n\tif (shmem_parse_options(data, &config, true))\n\t\treturn error;\n\n\tspin_lock(&sbinfo->stat_lock);\n\tinodes = sbinfo->max_inodes - sbinfo->free_inodes;\n\tif (percpu_counter_compare(&sbinfo->used_blocks, config.max_blocks) > 0)\n\t\tgoto out;\n\tif (config.max_inodes < inodes)\n\t\tgoto out;\n\t/*\n\t * Those tests disallow limited->unlimited while any are in use;\n\t * but we must separately disallow unlimited->limited, because\n\t * in that case we have no record of how much is already in use.\n\t */\n\tif (config.max_blocks && !sbinfo->max_blocks)\n\t\tgoto out;\n\tif (config.max_inodes && !sbinfo->max_inodes)\n\t\tgoto out;\n\n\terror = 0;\n\tsbinfo->huge = config.huge;\n\tsbinfo->max_blocks  = config.max_blocks;\n\tsbinfo->max_inodes  = config.max_inodes;\n\tsbinfo->free_inodes = config.max_inodes - inodes;\n\n\t/*\n\t * Preserve previous mempolicy unless mpol remount option was specified.\n\t */\n\tif (config.mpol) {\n\t\tmpol_put(sbinfo->mpol);\n\t\tsbinfo->mpol = config.mpol;\t/* transfers initial ref */\n\t}\nout:\n\tspin_unlock(&sbinfo->stat_lock);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 3393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mpol_put",
          "args": [
            "sbinfo->mpol"
          ],
          "line": 3389
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_put_task_policy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2345-2354",
          "snippet": "void mpol_put_task_policy(struct task_struct *task)\n{\n\tstruct mempolicy *pol;\n\n\ttask_lock(task);\n\tpol = task->mempolicy;\n\ttask->mempolicy = NULL;\n\ttask_unlock(task);\n\tmpol_put(pol);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nvoid mpol_put_task_policy(struct task_struct *task)\n{\n\tstruct mempolicy *pol;\n\n\ttask_lock(task);\n\tpol = task->mempolicy;\n\ttask->mempolicy = NULL;\n\ttask_unlock(task);\n\tmpol_put(pol);\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_counter_compare",
          "args": [
            "&sbinfo->used_blocks",
            "config.max_blocks"
          ],
          "line": 3365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 3363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_parse_options",
          "args": [
            "data",
            "&config",
            "true"
          ],
          "line": 3360
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_parse_options",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3237-3350",
          "snippet": "static int shmem_parse_options(char *options, struct shmem_sb_info *sbinfo,\n\t\t\t       bool remount)\n{\n\tchar *this_char, *value, *rest;\n\tstruct mempolicy *mpol = NULL;\n\tuid_t uid;\n\tgid_t gid;\n\n\twhile (options != NULL) {\n\t\tthis_char = options;\n\t\tfor (;;) {\n\t\t\t/*\n\t\t\t * NUL-terminate this option: unfortunately,\n\t\t\t * mount options form a comma-separated list,\n\t\t\t * but mpol's nodelist may also contain commas.\n\t\t\t */\n\t\t\toptions = strchr(options, ',');\n\t\t\tif (options == NULL)\n\t\t\t\tbreak;\n\t\t\toptions++;\n\t\t\tif (!isdigit(*options)) {\n\t\t\t\toptions[-1] = '\\0';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!*this_char)\n\t\t\tcontinue;\n\t\tif ((value = strchr(this_char,'=')) != NULL) {\n\t\t\t*value++ = 0;\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: No value for mount option '%s'\\n\",\n\t\t\t       this_char);\n\t\t\tgoto error;\n\t\t}\n\n\t\tif (!strcmp(this_char,\"size\")) {\n\t\t\tunsigned long long size;\n\t\t\tsize = memparse(value,&rest);\n\t\t\tif (*rest == '%') {\n\t\t\t\tsize <<= PAGE_SHIFT;\n\t\t\t\tsize *= totalram_pages;\n\t\t\t\tdo_div(size, 100);\n\t\t\t\trest++;\n\t\t\t}\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->max_blocks =\n\t\t\t\tDIV_ROUND_UP(size, PAGE_SIZE);\n\t\t} else if (!strcmp(this_char,\"nr_blocks\")) {\n\t\t\tsbinfo->max_blocks = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"nr_inodes\")) {\n\t\t\tsbinfo->max_inodes = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"mode\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tsbinfo->mode = simple_strtoul(value, &rest, 8) & 07777;\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"uid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tuid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->uid = make_kuid(current_user_ns(), uid);\n\t\t\tif (!uid_valid(sbinfo->uid))\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"gid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tgid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->gid = make_kgid(current_user_ns(), gid);\n\t\t\tif (!gid_valid(sbinfo->gid))\n\t\t\t\tgoto bad_val;\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\t\t} else if (!strcmp(this_char, \"huge\")) {\n\t\t\tint huge;\n\t\t\thuge = shmem_parse_huge(value);\n\t\t\tif (huge < 0)\n\t\t\t\tgoto bad_val;\n\t\t\tif (!has_transparent_hugepage() &&\n\t\t\t\t\thuge != SHMEM_HUGE_NEVER)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->huge = huge;\n#endif\n#ifdef CONFIG_NUMA\n\t\t} else if (!strcmp(this_char,\"mpol\")) {\n\t\t\tmpol_put(mpol);\n\t\t\tmpol = NULL;\n\t\t\tif (mpol_parse_str(value, &mpol))\n\t\t\t\tgoto bad_val;\n#endif\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: Bad mount option %s\\n\", this_char);\n\t\t\tgoto error;\n\t\t}\n\t}\n\tsbinfo->mpol = mpol;\n\treturn 0;\n\nbad_val:\n\tpr_err(\"tmpfs: Bad value '%s' for mount option '%s'\\n\",\n\t       value, this_char);\nerror:\n\tmpol_put(mpol);\n\treturn 1;\n\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define SHMEM_HUGE_NEVER\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_NEVER\t0\n\nstatic int shmem_parse_options(char *options, struct shmem_sb_info *sbinfo,\n\t\t\t       bool remount)\n{\n\tchar *this_char, *value, *rest;\n\tstruct mempolicy *mpol = NULL;\n\tuid_t uid;\n\tgid_t gid;\n\n\twhile (options != NULL) {\n\t\tthis_char = options;\n\t\tfor (;;) {\n\t\t\t/*\n\t\t\t * NUL-terminate this option: unfortunately,\n\t\t\t * mount options form a comma-separated list,\n\t\t\t * but mpol's nodelist may also contain commas.\n\t\t\t */\n\t\t\toptions = strchr(options, ',');\n\t\t\tif (options == NULL)\n\t\t\t\tbreak;\n\t\t\toptions++;\n\t\t\tif (!isdigit(*options)) {\n\t\t\t\toptions[-1] = '\\0';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!*this_char)\n\t\t\tcontinue;\n\t\tif ((value = strchr(this_char,'=')) != NULL) {\n\t\t\t*value++ = 0;\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: No value for mount option '%s'\\n\",\n\t\t\t       this_char);\n\t\t\tgoto error;\n\t\t}\n\n\t\tif (!strcmp(this_char,\"size\")) {\n\t\t\tunsigned long long size;\n\t\t\tsize = memparse(value,&rest);\n\t\t\tif (*rest == '%') {\n\t\t\t\tsize <<= PAGE_SHIFT;\n\t\t\t\tsize *= totalram_pages;\n\t\t\t\tdo_div(size, 100);\n\t\t\t\trest++;\n\t\t\t}\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->max_blocks =\n\t\t\t\tDIV_ROUND_UP(size, PAGE_SIZE);\n\t\t} else if (!strcmp(this_char,\"nr_blocks\")) {\n\t\t\tsbinfo->max_blocks = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"nr_inodes\")) {\n\t\t\tsbinfo->max_inodes = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"mode\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tsbinfo->mode = simple_strtoul(value, &rest, 8) & 07777;\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"uid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tuid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->uid = make_kuid(current_user_ns(), uid);\n\t\t\tif (!uid_valid(sbinfo->uid))\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"gid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tgid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->gid = make_kgid(current_user_ns(), gid);\n\t\t\tif (!gid_valid(sbinfo->gid))\n\t\t\t\tgoto bad_val;\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\t\t} else if (!strcmp(this_char, \"huge\")) {\n\t\t\tint huge;\n\t\t\thuge = shmem_parse_huge(value);\n\t\t\tif (huge < 0)\n\t\t\t\tgoto bad_val;\n\t\t\tif (!has_transparent_hugepage() &&\n\t\t\t\t\thuge != SHMEM_HUGE_NEVER)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->huge = huge;\n#endif\n#ifdef CONFIG_NUMA\n\t\t} else if (!strcmp(this_char,\"mpol\")) {\n\t\t\tmpol_put(mpol);\n\t\t\tmpol = NULL;\n\t\t\tif (mpol_parse_str(value, &mpol))\n\t\t\t\tgoto bad_val;\n#endif\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: Bad mount option %s\\n\", this_char);\n\t\t\tgoto error;\n\t\t}\n\t}\n\tsbinfo->mpol = mpol;\n\treturn 0;\n\nbad_val:\n\tpr_err(\"tmpfs: Bad value '%s' for mount option '%s'\\n\",\n\t       value, this_char);\nerror:\n\tmpol_put(mpol);\n\treturn 1;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "sb"
          ],
          "line": 3354
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_remount_fs(struct super_block *sb, int *flags, char *data)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tstruct shmem_sb_info config = *sbinfo;\n\tunsigned long inodes;\n\tint error = -EINVAL;\n\n\tconfig.mpol = NULL;\n\tif (shmem_parse_options(data, &config, true))\n\t\treturn error;\n\n\tspin_lock(&sbinfo->stat_lock);\n\tinodes = sbinfo->max_inodes - sbinfo->free_inodes;\n\tif (percpu_counter_compare(&sbinfo->used_blocks, config.max_blocks) > 0)\n\t\tgoto out;\n\tif (config.max_inodes < inodes)\n\t\tgoto out;\n\t/*\n\t * Those tests disallow limited->unlimited while any are in use;\n\t * but we must separately disallow unlimited->limited, because\n\t * in that case we have no record of how much is already in use.\n\t */\n\tif (config.max_blocks && !sbinfo->max_blocks)\n\t\tgoto out;\n\tif (config.max_inodes && !sbinfo->max_inodes)\n\t\tgoto out;\n\n\terror = 0;\n\tsbinfo->huge = config.huge;\n\tsbinfo->max_blocks  = config.max_blocks;\n\tsbinfo->max_inodes  = config.max_inodes;\n\tsbinfo->free_inodes = config.max_inodes - inodes;\n\n\t/*\n\t * Preserve previous mempolicy unless mpol remount option was specified.\n\t */\n\tif (config.mpol) {\n\t\tmpol_put(sbinfo->mpol);\n\t\tsbinfo->mpol = config.mpol;\t/* transfers initial ref */\n\t}\nout:\n\tspin_unlock(&sbinfo->stat_lock);\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_parse_options",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3237-3350",
    "snippet": "static int shmem_parse_options(char *options, struct shmem_sb_info *sbinfo,\n\t\t\t       bool remount)\n{\n\tchar *this_char, *value, *rest;\n\tstruct mempolicy *mpol = NULL;\n\tuid_t uid;\n\tgid_t gid;\n\n\twhile (options != NULL) {\n\t\tthis_char = options;\n\t\tfor (;;) {\n\t\t\t/*\n\t\t\t * NUL-terminate this option: unfortunately,\n\t\t\t * mount options form a comma-separated list,\n\t\t\t * but mpol's nodelist may also contain commas.\n\t\t\t */\n\t\t\toptions = strchr(options, ',');\n\t\t\tif (options == NULL)\n\t\t\t\tbreak;\n\t\t\toptions++;\n\t\t\tif (!isdigit(*options)) {\n\t\t\t\toptions[-1] = '\\0';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!*this_char)\n\t\t\tcontinue;\n\t\tif ((value = strchr(this_char,'=')) != NULL) {\n\t\t\t*value++ = 0;\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: No value for mount option '%s'\\n\",\n\t\t\t       this_char);\n\t\t\tgoto error;\n\t\t}\n\n\t\tif (!strcmp(this_char,\"size\")) {\n\t\t\tunsigned long long size;\n\t\t\tsize = memparse(value,&rest);\n\t\t\tif (*rest == '%') {\n\t\t\t\tsize <<= PAGE_SHIFT;\n\t\t\t\tsize *= totalram_pages;\n\t\t\t\tdo_div(size, 100);\n\t\t\t\trest++;\n\t\t\t}\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->max_blocks =\n\t\t\t\tDIV_ROUND_UP(size, PAGE_SIZE);\n\t\t} else if (!strcmp(this_char,\"nr_blocks\")) {\n\t\t\tsbinfo->max_blocks = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"nr_inodes\")) {\n\t\t\tsbinfo->max_inodes = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"mode\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tsbinfo->mode = simple_strtoul(value, &rest, 8) & 07777;\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"uid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tuid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->uid = make_kuid(current_user_ns(), uid);\n\t\t\tif (!uid_valid(sbinfo->uid))\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"gid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tgid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->gid = make_kgid(current_user_ns(), gid);\n\t\t\tif (!gid_valid(sbinfo->gid))\n\t\t\t\tgoto bad_val;\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\t\t} else if (!strcmp(this_char, \"huge\")) {\n\t\t\tint huge;\n\t\t\thuge = shmem_parse_huge(value);\n\t\t\tif (huge < 0)\n\t\t\t\tgoto bad_val;\n\t\t\tif (!has_transparent_hugepage() &&\n\t\t\t\t\thuge != SHMEM_HUGE_NEVER)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->huge = huge;\n#endif\n#ifdef CONFIG_NUMA\n\t\t} else if (!strcmp(this_char,\"mpol\")) {\n\t\t\tmpol_put(mpol);\n\t\t\tmpol = NULL;\n\t\t\tif (mpol_parse_str(value, &mpol))\n\t\t\t\tgoto bad_val;\n#endif\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: Bad mount option %s\\n\", this_char);\n\t\t\tgoto error;\n\t\t}\n\t}\n\tsbinfo->mpol = mpol;\n\treturn 0;\n\nbad_val:\n\tpr_err(\"tmpfs: Bad value '%s' for mount option '%s'\\n\",\n\t       value, this_char);\nerror:\n\tmpol_put(mpol);\n\treturn 1;\n\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define SHMEM_HUGE_NEVER\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mpol_put",
          "args": [
            "mpol"
          ],
          "line": 3347
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_put_task_policy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2345-2354",
          "snippet": "void mpol_put_task_policy(struct task_struct *task)\n{\n\tstruct mempolicy *pol;\n\n\ttask_lock(task);\n\tpol = task->mempolicy;\n\ttask->mempolicy = NULL;\n\ttask_unlock(task);\n\tmpol_put(pol);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nvoid mpol_put_task_policy(struct task_struct *task)\n{\n\tstruct mempolicy *pol;\n\n\ttask_lock(task);\n\tpol = task->mempolicy;\n\ttask->mempolicy = NULL;\n\ttask_unlock(task);\n\tmpol_put(pol);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"tmpfs: Bad value '%s' for mount option '%s'\\n\"",
            "value",
            "this_char"
          ],
          "line": 3344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"tmpfs: Bad mount option %s\\n\"",
            "this_char"
          ],
          "line": 3336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mpol_parse_str",
          "args": [
            "value",
            "&mpol"
          ],
          "line": 3332
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_parse_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2684-2799",
          "snippet": "int mpol_parse_str(char *str, struct mempolicy **mpol)\n{\n\tstruct mempolicy *new = NULL;\n\tunsigned short mode_flags;\n\tnodemask_t nodes;\n\tchar *nodelist = strchr(str, ':');\n\tchar *flags = strchr(str, '=');\n\tint err = 1, mode;\n\n\tif (nodelist) {\n\t\t/* NUL-terminate mode or flags string */\n\t\t*nodelist++ = '\\0';\n\t\tif (nodelist_parse(nodelist, nodes))\n\t\t\tgoto out;\n\t\tif (!nodes_subset(nodes, node_states[N_MEMORY]))\n\t\t\tgoto out;\n\t} else\n\t\tnodes_clear(nodes);\n\n\tif (flags)\n\t\t*flags++ = '\\0';\t/* terminate mode string */\n\n\tmode = match_string(policy_modes, MPOL_MAX, str);\n\tif (mode < 0)\n\t\tgoto out;\n\n\tswitch (mode) {\n\tcase MPOL_PREFERRED:\n\t\t/*\n\t\t * Insist on a nodelist of one node only\n\t\t */\n\t\tif (nodelist) {\n\t\t\tchar *rest = nodelist;\n\t\t\twhile (isdigit(*rest))\n\t\t\t\trest++;\n\t\t\tif (*rest)\n\t\t\t\tgoto out;\n\t\t}\n\t\tbreak;\n\tcase MPOL_INTERLEAVE:\n\t\t/*\n\t\t * Default to online nodes with memory if no nodelist\n\t\t */\n\t\tif (!nodelist)\n\t\t\tnodes = node_states[N_MEMORY];\n\t\tbreak;\n\tcase MPOL_LOCAL:\n\t\t/*\n\t\t * Don't allow a nodelist;  mpol_new() checks flags\n\t\t */\n\t\tif (nodelist)\n\t\t\tgoto out;\n\t\tmode = MPOL_PREFERRED;\n\t\tbreak;\n\tcase MPOL_DEFAULT:\n\t\t/*\n\t\t * Insist on a empty nodelist\n\t\t */\n\t\tif (!nodelist)\n\t\t\terr = 0;\n\t\tgoto out;\n\tcase MPOL_BIND:\n\t\t/*\n\t\t * Insist on a nodelist\n\t\t */\n\t\tif (!nodelist)\n\t\t\tgoto out;\n\t}\n\n\tmode_flags = 0;\n\tif (flags) {\n\t\t/*\n\t\t * Currently, we only support two mutually exclusive\n\t\t * mode flags.\n\t\t */\n\t\tif (!strcmp(flags, \"static\"))\n\t\t\tmode_flags |= MPOL_F_STATIC_NODES;\n\t\telse if (!strcmp(flags, \"relative\"))\n\t\t\tmode_flags |= MPOL_F_RELATIVE_NODES;\n\t\telse\n\t\t\tgoto out;\n\t}\n\n\tnew = mpol_new(mode, mode_flags, &nodes);\n\tif (IS_ERR(new))\n\t\tgoto out;\n\n\t/*\n\t * Save nodes for mpol_to_str() to show the tmpfs mount options\n\t * for /proc/mounts, /proc/pid/mounts and /proc/pid/mountinfo.\n\t */\n\tif (mode != MPOL_PREFERRED)\n\t\tnew->v.nodes = nodes;\n\telse if (nodelist)\n\t\tnew->v.preferred_node = first_node(nodes);\n\telse\n\t\tnew->flags |= MPOL_F_LOCAL;\n\n\t/*\n\t * Save nodes for contextualization: this will be used to \"clone\"\n\t * the mempolicy in a specific context [cpuset] at a later time.\n\t */\n\tnew->w.user_nodemask = nodes;\n\n\terr = 0;\n\nout:\n\t/* Restore string for error message */\n\tif (nodelist)\n\t\t*--nodelist = ':';\n\tif (flags)\n\t\t*--flags = '=';\n\tif (!err)\n\t\t*mpol = new;\n\treturn err;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void migrate_page_add(struct page *page, struct list_head *pagelist,\n\t\t\t\tunsigned long flags);",
            "static const char * const policy_modes[] =\n{\n\t[MPOL_DEFAULT]    = \"default\",\n\t[MPOL_PREFERRED]  = \"prefer\",\n\t[MPOL_BIND]       = \"bind\",\n\t[MPOL_INTERLEAVE] = \"interleave\",\n\t[MPOL_LOCAL]      = \"local\",\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nstatic void migrate_page_add(struct page *page, struct list_head *pagelist,\n\t\t\t\tunsigned long flags);\nstatic const char * const policy_modes[] =\n{\n\t[MPOL_DEFAULT]    = \"default\",\n\t[MPOL_PREFERRED]  = \"prefer\",\n\t[MPOL_BIND]       = \"bind\",\n\t[MPOL_INTERLEAVE] = \"interleave\",\n\t[MPOL_LOCAL]      = \"local\",\n};\n\nint mpol_parse_str(char *str, struct mempolicy **mpol)\n{\n\tstruct mempolicy *new = NULL;\n\tunsigned short mode_flags;\n\tnodemask_t nodes;\n\tchar *nodelist = strchr(str, ':');\n\tchar *flags = strchr(str, '=');\n\tint err = 1, mode;\n\n\tif (nodelist) {\n\t\t/* NUL-terminate mode or flags string */\n\t\t*nodelist++ = '\\0';\n\t\tif (nodelist_parse(nodelist, nodes))\n\t\t\tgoto out;\n\t\tif (!nodes_subset(nodes, node_states[N_MEMORY]))\n\t\t\tgoto out;\n\t} else\n\t\tnodes_clear(nodes);\n\n\tif (flags)\n\t\t*flags++ = '\\0';\t/* terminate mode string */\n\n\tmode = match_string(policy_modes, MPOL_MAX, str);\n\tif (mode < 0)\n\t\tgoto out;\n\n\tswitch (mode) {\n\tcase MPOL_PREFERRED:\n\t\t/*\n\t\t * Insist on a nodelist of one node only\n\t\t */\n\t\tif (nodelist) {\n\t\t\tchar *rest = nodelist;\n\t\t\twhile (isdigit(*rest))\n\t\t\t\trest++;\n\t\t\tif (*rest)\n\t\t\t\tgoto out;\n\t\t}\n\t\tbreak;\n\tcase MPOL_INTERLEAVE:\n\t\t/*\n\t\t * Default to online nodes with memory if no nodelist\n\t\t */\n\t\tif (!nodelist)\n\t\t\tnodes = node_states[N_MEMORY];\n\t\tbreak;\n\tcase MPOL_LOCAL:\n\t\t/*\n\t\t * Don't allow a nodelist;  mpol_new() checks flags\n\t\t */\n\t\tif (nodelist)\n\t\t\tgoto out;\n\t\tmode = MPOL_PREFERRED;\n\t\tbreak;\n\tcase MPOL_DEFAULT:\n\t\t/*\n\t\t * Insist on a empty nodelist\n\t\t */\n\t\tif (!nodelist)\n\t\t\terr = 0;\n\t\tgoto out;\n\tcase MPOL_BIND:\n\t\t/*\n\t\t * Insist on a nodelist\n\t\t */\n\t\tif (!nodelist)\n\t\t\tgoto out;\n\t}\n\n\tmode_flags = 0;\n\tif (flags) {\n\t\t/*\n\t\t * Currently, we only support two mutually exclusive\n\t\t * mode flags.\n\t\t */\n\t\tif (!strcmp(flags, \"static\"))\n\t\t\tmode_flags |= MPOL_F_STATIC_NODES;\n\t\telse if (!strcmp(flags, \"relative\"))\n\t\t\tmode_flags |= MPOL_F_RELATIVE_NODES;\n\t\telse\n\t\t\tgoto out;\n\t}\n\n\tnew = mpol_new(mode, mode_flags, &nodes);\n\tif (IS_ERR(new))\n\t\tgoto out;\n\n\t/*\n\t * Save nodes for mpol_to_str() to show the tmpfs mount options\n\t * for /proc/mounts, /proc/pid/mounts and /proc/pid/mountinfo.\n\t */\n\tif (mode != MPOL_PREFERRED)\n\t\tnew->v.nodes = nodes;\n\telse if (nodelist)\n\t\tnew->v.preferred_node = first_node(nodes);\n\telse\n\t\tnew->flags |= MPOL_F_LOCAL;\n\n\t/*\n\t * Save nodes for contextualization: this will be used to \"clone\"\n\t * the mempolicy in a specific context [cpuset] at a later time.\n\t */\n\tnew->w.user_nodemask = nodes;\n\n\terr = 0;\n\nout:\n\t/* Restore string for error message */\n\tif (nodelist)\n\t\t*--nodelist = ':';\n\tif (flags)\n\t\t*--flags = '=';\n\tif (!err)\n\t\t*mpol = new;\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "this_char",
            "\"mpol\""
          ],
          "line": 3329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "has_transparent_hugepage",
          "args": [],
          "line": 3323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_parse_huge",
          "args": [
            "value"
          ],
          "line": 3320
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_parse_huge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "393-408",
          "snippet": "static int shmem_parse_huge(const char *str)\n{\n\tif (!strcmp(str, \"never\"))\n\t\treturn SHMEM_HUGE_NEVER;\n\tif (!strcmp(str, \"always\"))\n\t\treturn SHMEM_HUGE_ALWAYS;\n\tif (!strcmp(str, \"within_size\"))\n\t\treturn SHMEM_HUGE_WITHIN_SIZE;\n\tif (!strcmp(str, \"advise\"))\n\t\treturn SHMEM_HUGE_ADVISE;\n\tif (!strcmp(str, \"deny\"))\n\t\treturn SHMEM_HUGE_DENY;\n\tif (!strcmp(str, \"force\"))\n\t\treturn SHMEM_HUGE_FORCE;\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define SHMEM_HUGE_FORCE\t(-2)",
            "#define SHMEM_HUGE_DENY\t\t(-1)",
            "#define SHMEM_HUGE_ADVISE\t3",
            "#define SHMEM_HUGE_WITHIN_SIZE\t2",
            "#define SHMEM_HUGE_ALWAYS\t1",
            "#define SHMEM_HUGE_NEVER\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_ALWAYS\t1\n#define SHMEM_HUGE_NEVER\t0\n\nstatic int shmem_parse_huge(const char *str)\n{\n\tif (!strcmp(str, \"never\"))\n\t\treturn SHMEM_HUGE_NEVER;\n\tif (!strcmp(str, \"always\"))\n\t\treturn SHMEM_HUGE_ALWAYS;\n\tif (!strcmp(str, \"within_size\"))\n\t\treturn SHMEM_HUGE_WITHIN_SIZE;\n\tif (!strcmp(str, \"advise\"))\n\t\treturn SHMEM_HUGE_ADVISE;\n\tif (!strcmp(str, \"deny\"))\n\t\treturn SHMEM_HUGE_DENY;\n\tif (!strcmp(str, \"force\"))\n\t\treturn SHMEM_HUGE_FORCE;\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "this_char",
            "\"huge\""
          ],
          "line": 3318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "sbinfo->gid"
          ],
          "line": 3315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "current_user_ns()",
            "gid"
          ],
          "line": 3314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 3314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "value",
            "&rest",
            "0"
          ],
          "line": 3311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "this_char",
            "\"gid\""
          ],
          "line": 3308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "sbinfo->uid"
          ],
          "line": 3306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "current_user_ns()",
            "uid"
          ],
          "line": 3305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_user_ns",
          "args": [],
          "line": 3305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "value",
            "&rest",
            "0"
          ],
          "line": 3302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "this_char",
            "\"uid\""
          ],
          "line": 3299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "value",
            "&rest",
            "8"
          ],
          "line": 3296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "this_char",
            "\"mode\""
          ],
          "line": 3293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memparse",
          "args": [
            "value",
            "&rest"
          ],
          "line": 3290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "this_char",
            "\"nr_inodes\""
          ],
          "line": 3289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memparse",
          "args": [
            "value",
            "&rest"
          ],
          "line": 3286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "this_char",
            "\"nr_blocks\""
          ],
          "line": 3285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "size",
            "PAGE_SIZE"
          ],
          "line": 3284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "size",
            "100"
          ],
          "line": 3278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memparse",
          "args": [
            "value",
            "&rest"
          ],
          "line": 3274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "this_char",
            "\"size\""
          ],
          "line": 3272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"tmpfs: No value for mount option '%s'\\n\"",
            "this_char"
          ],
          "line": 3267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "this_char",
            "'='"
          ],
          "line": 3264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*options"
          ],
          "line": 3257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "options",
            "','"
          ],
          "line": 3253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_NEVER\t0\n\nstatic int shmem_parse_options(char *options, struct shmem_sb_info *sbinfo,\n\t\t\t       bool remount)\n{\n\tchar *this_char, *value, *rest;\n\tstruct mempolicy *mpol = NULL;\n\tuid_t uid;\n\tgid_t gid;\n\n\twhile (options != NULL) {\n\t\tthis_char = options;\n\t\tfor (;;) {\n\t\t\t/*\n\t\t\t * NUL-terminate this option: unfortunately,\n\t\t\t * mount options form a comma-separated list,\n\t\t\t * but mpol's nodelist may also contain commas.\n\t\t\t */\n\t\t\toptions = strchr(options, ',');\n\t\t\tif (options == NULL)\n\t\t\t\tbreak;\n\t\t\toptions++;\n\t\t\tif (!isdigit(*options)) {\n\t\t\t\toptions[-1] = '\\0';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!*this_char)\n\t\t\tcontinue;\n\t\tif ((value = strchr(this_char,'=')) != NULL) {\n\t\t\t*value++ = 0;\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: No value for mount option '%s'\\n\",\n\t\t\t       this_char);\n\t\t\tgoto error;\n\t\t}\n\n\t\tif (!strcmp(this_char,\"size\")) {\n\t\t\tunsigned long long size;\n\t\t\tsize = memparse(value,&rest);\n\t\t\tif (*rest == '%') {\n\t\t\t\tsize <<= PAGE_SHIFT;\n\t\t\t\tsize *= totalram_pages;\n\t\t\t\tdo_div(size, 100);\n\t\t\t\trest++;\n\t\t\t}\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->max_blocks =\n\t\t\t\tDIV_ROUND_UP(size, PAGE_SIZE);\n\t\t} else if (!strcmp(this_char,\"nr_blocks\")) {\n\t\t\tsbinfo->max_blocks = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"nr_inodes\")) {\n\t\t\tsbinfo->max_inodes = memparse(value, &rest);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"mode\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tsbinfo->mode = simple_strtoul(value, &rest, 8) & 07777;\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"uid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tuid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->uid = make_kuid(current_user_ns(), uid);\n\t\t\tif (!uid_valid(sbinfo->uid))\n\t\t\t\tgoto bad_val;\n\t\t} else if (!strcmp(this_char,\"gid\")) {\n\t\t\tif (remount)\n\t\t\t\tcontinue;\n\t\t\tgid = simple_strtoul(value, &rest, 0);\n\t\t\tif (*rest)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->gid = make_kgid(current_user_ns(), gid);\n\t\t\tif (!gid_valid(sbinfo->gid))\n\t\t\t\tgoto bad_val;\n#ifdef CONFIG_TRANSPARENT_HUGE_PAGECACHE\n\t\t} else if (!strcmp(this_char, \"huge\")) {\n\t\t\tint huge;\n\t\t\thuge = shmem_parse_huge(value);\n\t\t\tif (huge < 0)\n\t\t\t\tgoto bad_val;\n\t\t\tif (!has_transparent_hugepage() &&\n\t\t\t\t\thuge != SHMEM_HUGE_NEVER)\n\t\t\t\tgoto bad_val;\n\t\t\tsbinfo->huge = huge;\n#endif\n#ifdef CONFIG_NUMA\n\t\t} else if (!strcmp(this_char,\"mpol\")) {\n\t\t\tmpol_put(mpol);\n\t\t\tmpol = NULL;\n\t\t\tif (mpol_parse_str(value, &mpol))\n\t\t\t\tgoto bad_val;\n#endif\n\t\t} else {\n\t\t\tpr_err(\"tmpfs: Bad mount option %s\\n\", this_char);\n\t\t\tgoto error;\n\t\t}\n\t}\n\tsbinfo->mpol = mpol;\n\treturn 0;\n\nbad_val:\n\tpr_err(\"tmpfs: Bad value '%s' for mount option '%s'\\n\",\n\t       value, this_char);\nerror:\n\tmpol_put(mpol);\n\treturn 1;\n\n}"
  },
  {
    "function_name": "shmem_encode_fh",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3201-3229",
    "snippet": "static int shmem_encode_fh(struct inode *inode, __u32 *fh, int *len,\n\t\t\t\tstruct inode *parent)\n{\n\tif (*len < 3) {\n\t\t*len = 3;\n\t\treturn FILEID_INVALID;\n\t}\n\n\tif (inode_unhashed(inode)) {\n\t\t/* Unfortunately insert_inode_hash is not idempotent,\n\t\t * so as we hash inodes here rather than at creation\n\t\t * time, we need a lock to ensure we only try\n\t\t * to do it once\n\t\t */\n\t\tstatic DEFINE_SPINLOCK(lock);\n\t\tspin_lock(&lock);\n\t\tif (inode_unhashed(inode))\n\t\t\t__insert_inode_hash(inode,\n\t\t\t\t\t    inode->i_ino + inode->i_generation);\n\t\tspin_unlock(&lock);\n\t}\n\n\tfh[0] = inode->i_generation;\n\tfh[1] = inode->i_ino;\n\tfh[2] = ((__u64)inode->i_ino) >> 32;\n\n\t*len = 3;\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&lock"
          ],
          "line": 3220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__insert_inode_hash",
          "args": [
            "inode",
            "inode->i_ino + inode->i_generation"
          ],
          "line": 3218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_unhashed",
          "args": [
            "inode"
          ],
          "line": 3217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&lock"
          ],
          "line": 3216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_unhashed",
          "args": [
            "inode"
          ],
          "line": 3209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_encode_fh(struct inode *inode, __u32 *fh, int *len,\n\t\t\t\tstruct inode *parent)\n{\n\tif (*len < 3) {\n\t\t*len = 3;\n\t\treturn FILEID_INVALID;\n\t}\n\n\tif (inode_unhashed(inode)) {\n\t\t/* Unfortunately insert_inode_hash is not idempotent,\n\t\t * so as we hash inodes here rather than at creation\n\t\t * time, we need a lock to ensure we only try\n\t\t * to do it once\n\t\t */\n\t\tstatic DEFINE_SPINLOCK(lock);\n\t\tspin_lock(&lock);\n\t\tif (inode_unhashed(inode))\n\t\t\t__insert_inode_hash(inode,\n\t\t\t\t\t    inode->i_ino + inode->i_generation);\n\t\tspin_unlock(&lock);\n\t}\n\n\tfh[0] = inode->i_generation;\n\tfh[1] = inode->i_ino;\n\tfh[2] = ((__u64)inode->i_ino) >> 32;\n\n\t*len = 3;\n\treturn 1;\n}"
  },
  {
    "function_name": "shmem_fh_to_dentry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3178-3199",
    "snippet": "static struct dentry *shmem_fh_to_dentry(struct super_block *sb,\n\t\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tstruct inode *inode;\n\tstruct dentry *dentry = NULL;\n\tu64 inum;\n\n\tif (fh_len < 3)\n\t\treturn NULL;\n\n\tinum = fid->raw[2];\n\tinum = (inum << 32) | fid->raw[1];\n\n\tinode = ilookup5(sb, (unsigned long)(inum + fid->raw[0]),\n\t\t\tshmem_match, fid->raw);\n\tif (inode) {\n\t\tdentry = shmem_find_alias(inode);\n\t\tiput(inode);\n\t}\n\n\treturn dentry;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 3195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_find_alias",
          "args": [
            "inode"
          ],
          "line": 3194
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_find_alias",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3170-3175",
          "snippet": "static struct dentry *shmem_find_alias(struct inode *inode)\n{\n\tstruct dentry *alias = d_find_alias(inode);\n\n\treturn alias ?: d_find_any_alias(inode);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct dentry *shmem_find_alias(struct inode *inode)\n{\n\tstruct dentry *alias = d_find_alias(inode);\n\n\treturn alias ?: d_find_any_alias(inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ilookup5",
          "args": [
            "sb",
            "(unsigned long)(inum + fid->raw[0])",
            "shmem_match",
            "fid->raw"
          ],
          "line": 3191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct dentry *shmem_fh_to_dentry(struct super_block *sb,\n\t\tstruct fid *fid, int fh_len, int fh_type)\n{\n\tstruct inode *inode;\n\tstruct dentry *dentry = NULL;\n\tu64 inum;\n\n\tif (fh_len < 3)\n\t\treturn NULL;\n\n\tinum = fid->raw[2];\n\tinum = (inum << 32) | fid->raw[1];\n\n\tinode = ilookup5(sb, (unsigned long)(inum + fid->raw[0]),\n\t\t\tshmem_match, fid->raw);\n\tif (inode) {\n\t\tdentry = shmem_find_alias(inode);\n\t\tiput(inode);\n\t}\n\n\treturn dentry;\n}"
  },
  {
    "function_name": "shmem_find_alias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3170-3175",
    "snippet": "static struct dentry *shmem_find_alias(struct inode *inode)\n{\n\tstruct dentry *alias = d_find_alias(inode);\n\n\treturn alias ?: d_find_any_alias(inode);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d_find_any_alias",
          "args": [
            "inode"
          ],
          "line": 3174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_find_alias",
          "args": [
            "inode"
          ],
          "line": 3172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct dentry *shmem_find_alias(struct inode *inode)\n{\n\tstruct dentry *alias = d_find_alias(inode);\n\n\treturn alias ?: d_find_any_alias(inode);\n}"
  },
  {
    "function_name": "shmem_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3161-3167",
    "snippet": "static int shmem_match(struct inode *ino, void *vfh)\n{\n\t__u32 *fh = vfh;\n\t__u64 inum = fh[2];\n\tinum = (inum << 32) | fh[1];\n\treturn ino->i_ino == inum && fh[0] == ino->i_generation;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_match(struct inode *ino, void *vfh)\n{\n\t__u32 *fh = vfh;\n\t__u64 inum = fh[2];\n\tinum = (inum << 32) | fh[1];\n\treturn ino->i_ino == inum && fh[0] == ino->i_generation;\n}"
  },
  {
    "function_name": "shmem_get_parent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3156-3159",
    "snippet": "static struct dentry *shmem_get_parent(struct dentry *child)\n{\n\treturn ERR_PTR(-ESTALE);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ESTALE"
          ],
          "line": 3158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct dentry *shmem_get_parent(struct dentry *child)\n{\n\treturn ERR_PTR(-ESTALE);\n}"
  },
  {
    "function_name": "shmem_listxattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3135-3139",
    "snippet": "static ssize_t shmem_listxattr(struct dentry *dentry, char *buffer, size_t size)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(d_inode(dentry));\n\treturn simple_xattr_list(d_inode(dentry), &info->xattrs, buffer, size);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_xattr_list",
          "args": [
            "d_inode(dentry)",
            "&info->xattrs",
            "buffer",
            "size"
          ],
          "line": 3138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "dentry"
          ],
          "line": 3138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "d_inode(dentry)"
          ],
          "line": 3137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "dentry"
          ],
          "line": 3137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic ssize_t shmem_listxattr(struct dentry *dentry, char *buffer, size_t size)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(d_inode(dentry));\n\treturn simple_xattr_list(d_inode(dentry), &info->xattrs, buffer, size);\n}"
  },
  {
    "function_name": "shmem_xattr_handler_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3102-3111",
    "snippet": "static int shmem_xattr_handler_set(const struct xattr_handler *handler,\n\t\t\t\t   struct dentry *unused, struct inode *inode,\n\t\t\t\t   const char *name, const void *value,\n\t\t\t\t   size_t size, int flags)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\n\tname = xattr_full_name(handler, name);\n\treturn simple_xattr_set(&info->xattrs, name, value, size, flags);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_xattr_set",
          "args": [
            "&info->xattrs",
            "name",
            "value",
            "size",
            "flags"
          ],
          "line": 3110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xattr_full_name",
          "args": [
            "handler",
            "name"
          ],
          "line": 3109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 3107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_xattr_handler_set(const struct xattr_handler *handler,\n\t\t\t\t   struct dentry *unused, struct inode *inode,\n\t\t\t\t   const char *name, const void *value,\n\t\t\t\t   size_t size, int flags)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\n\tname = xattr_full_name(handler, name);\n\treturn simple_xattr_set(&info->xattrs, name, value, size, flags);\n}"
  },
  {
    "function_name": "shmem_xattr_handler_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3092-3100",
    "snippet": "static int shmem_xattr_handler_get(const struct xattr_handler *handler,\n\t\t\t\t   struct dentry *unused, struct inode *inode,\n\t\t\t\t   const char *name, void *buffer, size_t size)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\n\tname = xattr_full_name(handler, name);\n\treturn simple_xattr_get(&info->xattrs, name, buffer, size);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_xattr_get",
          "args": [
            "&info->xattrs",
            "name",
            "buffer",
            "size"
          ],
          "line": 3099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xattr_full_name",
          "args": [
            "handler",
            "name"
          ],
          "line": 3098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 3096
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_xattr_handler_get(const struct xattr_handler *handler,\n\t\t\t\t   struct dentry *unused, struct inode *inode,\n\t\t\t\t   const char *name, void *buffer, size_t size)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\n\tname = xattr_full_name(handler, name);\n\treturn simple_xattr_get(&info->xattrs, name, buffer, size);\n}"
  },
  {
    "function_name": "shmem_initxattrs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3059-3090",
    "snippet": "static int shmem_initxattrs(struct inode *inode,\n\t\t\t    const struct xattr *xattr_array,\n\t\t\t    void *fs_info)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tconst struct xattr *xattr;\n\tstruct simple_xattr *new_xattr;\n\tsize_t len;\n\n\tfor (xattr = xattr_array; xattr->name != NULL; xattr++) {\n\t\tnew_xattr = simple_xattr_alloc(xattr->value, xattr->value_len);\n\t\tif (!new_xattr)\n\t\t\treturn -ENOMEM;\n\n\t\tlen = strlen(xattr->name) + 1;\n\t\tnew_xattr->name = kmalloc(XATTR_SECURITY_PREFIX_LEN + len,\n\t\t\t\t\t  GFP_KERNEL);\n\t\tif (!new_xattr->name) {\n\t\t\tkfree(new_xattr);\n\t\t\treturn -ENOMEM;\n\t\t}\n\n\t\tmemcpy(new_xattr->name, XATTR_SECURITY_PREFIX,\n\t\t       XATTR_SECURITY_PREFIX_LEN);\n\t\tmemcpy(new_xattr->name + XATTR_SECURITY_PREFIX_LEN,\n\t\t       xattr->name, len);\n\n\t\tsimple_xattr_list_add(&info->xattrs, new_xattr);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_initxattrs NULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_xattr_list_add",
          "args": [
            "&info->xattrs",
            "new_xattr"
          ],
          "line": 3086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "new_xattr->name + XATTR_SECURITY_PREFIX_LEN",
            "xattr->name",
            "len"
          ],
          "line": 3083
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "new_xattr"
          ],
          "line": 3077
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "XATTR_SECURITY_PREFIX_LEN + len",
            "GFP_KERNEL"
          ],
          "line": 3074
        },
        "resolved": true,
        "details": {
          "function_name": "__kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3729-3732",
          "snippet": "void *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nvoid *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "xattr->name"
          ],
          "line": 3073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_xattr_alloc",
          "args": [
            "xattr->value",
            "xattr->value_len"
          ],
          "line": 3069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 3063
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_initxattrs NULL\n\nstatic int shmem_initxattrs(struct inode *inode,\n\t\t\t    const struct xattr *xattr_array,\n\t\t\t    void *fs_info)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tconst struct xattr *xattr;\n\tstruct simple_xattr *new_xattr;\n\tsize_t len;\n\n\tfor (xattr = xattr_array; xattr->name != NULL; xattr++) {\n\t\tnew_xattr = simple_xattr_alloc(xattr->value, xattr->value_len);\n\t\tif (!new_xattr)\n\t\t\treturn -ENOMEM;\n\n\t\tlen = strlen(xattr->name) + 1;\n\t\tnew_xattr->name = kmalloc(XATTR_SECURITY_PREFIX_LEN + len,\n\t\t\t\t\t  GFP_KERNEL);\n\t\tif (!new_xattr->name) {\n\t\t\tkfree(new_xattr);\n\t\t\treturn -ENOMEM;\n\t\t}\n\n\t\tmemcpy(new_xattr->name, XATTR_SECURITY_PREFIX,\n\t\t       XATTR_SECURITY_PREFIX_LEN);\n\t\tmemcpy(new_xattr->name + XATTR_SECURITY_PREFIX_LEN,\n\t\t       xattr->name, len);\n\n\t\tsimple_xattr_list_add(&info->xattrs, new_xattr);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_get_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3024-3046",
    "snippet": "static const char *shmem_get_link(struct dentry *dentry,\n\t\t\t\t  struct inode *inode,\n\t\t\t\t  struct delayed_call *done)\n{\n\tstruct page *page = NULL;\n\tint error;\n\tif (!dentry) {\n\t\tpage = find_get_page(inode->i_mapping, 0);\n\t\tif (!page)\n\t\t\treturn ERR_PTR(-ECHILD);\n\t\tif (!PageUptodate(page)) {\n\t\t\tput_page(page);\n\t\t\treturn ERR_PTR(-ECHILD);\n\t\t}\n\t} else {\n\t\terror = shmem_getpage(inode, 0, &page, SGP_READ);\n\t\tif (error)\n\t\t\treturn ERR_PTR(error);\n\t\tunlock_page(page);\n\t}\n\tset_delayed_call(done, shmem_put_link, page);\n\treturn page_address(page);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 3045
        },
        "resolved": true,
        "details": {
          "function_name": "page_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/highmem.c",
          "lines": "409-434",
          "snippet": "void *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/tlbflush.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/mempool.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/tlbflush.h>\n#include <linux/kgdb.h>\n#include <linux/highmem.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/mempool.h>\n#include <linux/pagemap.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_delayed_call",
          "args": [
            "done",
            "shmem_put_link",
            "page"
          ],
          "line": 3044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 3042
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "error"
          ],
          "line": 3041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_getpage",
          "args": [
            "inode",
            "0",
            "&page",
            "SGP_READ"
          ],
          "line": 3039
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "129-134",
          "snippet": "int shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ECHILD"
          ],
          "line": 3036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 3035
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 3034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "-ECHILD"
          ],
          "line": 3033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_get_page",
          "args": [
            "inode->i_mapping",
            "0"
          ],
          "line": 3031
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic const char *shmem_get_link(struct dentry *dentry,\n\t\t\t\t  struct inode *inode,\n\t\t\t\t  struct delayed_call *done)\n{\n\tstruct page *page = NULL;\n\tint error;\n\tif (!dentry) {\n\t\tpage = find_get_page(inode->i_mapping, 0);\n\t\tif (!page)\n\t\t\treturn ERR_PTR(-ECHILD);\n\t\tif (!PageUptodate(page)) {\n\t\t\tput_page(page);\n\t\t\treturn ERR_PTR(-ECHILD);\n\t\t}\n\t} else {\n\t\terror = shmem_getpage(inode, 0, &page, SGP_READ);\n\t\tif (error)\n\t\t\treturn ERR_PTR(error);\n\t\tunlock_page(page);\n\t}\n\tset_delayed_call(done, shmem_put_link, page);\n\treturn page_address(page);\n}"
  },
  {
    "function_name": "shmem_put_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "3018-3022",
    "snippet": "static void shmem_put_link(void *arg)\n{\n\tmark_page_accessed(arg);\n\tput_page(arg);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "arg"
          ],
          "line": 3021
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_page_accessed",
          "args": [
            "arg"
          ],
          "line": 3020
        },
        "resolved": true,
        "details": {
          "function_name": "mark_page_accessed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "376-400",
          "snippet": "void mark_page_accessed(struct page *page)\n{\n\tpage = compound_head(page);\n\tif (!PageActive(page) && !PageUnevictable(page) &&\n\t\t\tPageReferenced(page)) {\n\n\t\t/*\n\t\t * If the page is on the LRU, queue it for activation via\n\t\t * activate_page_pvecs. Otherwise, assume the page is on a\n\t\t * pagevec, mark it active and it'll be moved to the active\n\t\t * LRU on the next drain.\n\t\t */\n\t\tif (PageLRU(page))\n\t\t\tactivate_page(page);\n\t\telse\n\t\t\t__lru_cache_activate_page(page);\n\t\tClearPageReferenced(page);\n\t\tif (page_is_file_cache(page))\n\t\t\tworkingset_activation(page);\n\t} else if (!PageReferenced(page)) {\n\t\tSetPageReferenced(page);\n\t}\n\tif (page_is_idle(page))\n\t\tclear_page_idle(page);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid mark_page_accessed(struct page *page)\n{\n\tpage = compound_head(page);\n\tif (!PageActive(page) && !PageUnevictable(page) &&\n\t\t\tPageReferenced(page)) {\n\n\t\t/*\n\t\t * If the page is on the LRU, queue it for activation via\n\t\t * activate_page_pvecs. Otherwise, assume the page is on a\n\t\t * pagevec, mark it active and it'll be moved to the active\n\t\t * LRU on the next drain.\n\t\t */\n\t\tif (PageLRU(page))\n\t\t\tactivate_page(page);\n\t\telse\n\t\t\t__lru_cache_activate_page(page);\n\t\tClearPageReferenced(page);\n\t\tif (page_is_file_cache(page))\n\t\t\tworkingset_activation(page);\n\t} else if (!PageReferenced(page)) {\n\t\tSetPageReferenced(page);\n\t}\n\tif (page_is_idle(page))\n\t\tclear_page_idle(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_put_link(void *arg)\n{\n\tmark_page_accessed(arg);\n\tput_page(arg);\n}"
  },
  {
    "function_name": "shmem_symlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2962-3016",
    "snippet": "static int shmem_symlink(struct inode *dir, struct dentry *dentry, const char *symname)\n{\n\tint error;\n\tint len;\n\tstruct inode *inode;\n\tstruct page *page;\n\n\tlen = strlen(symname) + 1;\n\tif (len > PAGE_SIZE)\n\t\treturn -ENAMETOOLONG;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, S_IFLNK | 0777, 0,\n\t\t\t\tVM_NORESERVE);\n\tif (!inode)\n\t\treturn -ENOSPC;\n\n\terror = security_inode_init_security(inode, dir, &dentry->d_name,\n\t\t\t\t\t     shmem_initxattrs, NULL);\n\tif (error) {\n\t\tif (error != -EOPNOTSUPP) {\n\t\t\tiput(inode);\n\t\t\treturn error;\n\t\t}\n\t\terror = 0;\n\t}\n\n\tinode->i_size = len-1;\n\tif (len <= SHORT_SYMLINK_LEN) {\n\t\tinode->i_link = kmemdup(symname, len, GFP_KERNEL);\n\t\tif (!inode->i_link) {\n\t\t\tiput(inode);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tinode->i_op = &shmem_short_symlink_operations;\n\t} else {\n\t\tinode_nohighmem(inode);\n\t\terror = shmem_getpage(inode, 0, &page, SGP_WRITE);\n\t\tif (error) {\n\t\t\tiput(inode);\n\t\t\treturn error;\n\t\t}\n\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\tinode->i_op = &shmem_symlink_inode_operations;\n\t\tmemcpy(page_address(page), symname, len);\n\t\tSetPageUptodate(page);\n\t\tset_page_dirty(page);\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tdir->i_size += BOGO_DIRENT_SIZE;\n\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_initxattrs NULL",
      "#define SHORT_SYMLINK_LEN 128",
      "#define BOGO_DIRENT_SIZE 20"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dget",
          "args": [
            "dentry"
          ],
          "line": 3014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_instantiate",
          "args": [
            "dentry",
            "inode"
          ],
          "line": 3013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "dir"
          ],
          "line": 3012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 3009
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 3008
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "page"
          ],
          "line": 3007
        },
        "resolved": true,
        "details": {
          "function_name": "set_page_dirty_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "2573-2581",
          "snippet": "int set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetPageUptodate",
          "args": [
            "page"
          ],
          "line": 3006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "page_address(page)",
            "symname",
            "len"
          ],
          "line": 3005
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 3005
        },
        "resolved": true,
        "details": {
          "function_name": "page_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/highmem.c",
          "lines": "409-434",
          "snippet": "void *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/tlbflush.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/mempool.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/tlbflush.h>\n#include <linux/kgdb.h>\n#include <linux/highmem.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/mempool.h>\n#include <linux/pagemap.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 3000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_getpage",
          "args": [
            "inode",
            "0",
            "&page",
            "SGP_WRITE"
          ],
          "line": 2998
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "129-134",
          "snippet": "int shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_nohighmem",
          "args": [
            "inode"
          ],
          "line": 2997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 2992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmemdup",
          "args": [
            "symname",
            "len",
            "GFP_KERNEL"
          ],
          "line": 2990
        },
        "resolved": true,
        "details": {
          "function_name": "kmemdup_nul",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "124-137",
          "snippet": "char *kmemdup_nul(const char *s, size_t len, gfp_t gfp)\n{\n\tchar *buf;\n\n\tif (!s)\n\t\treturn NULL;\n\n\tbuf = kmalloc_track_caller(len + 1, gfp);\n\tif (buf) {\n\t\tmemcpy(buf, s, len);\n\t\tbuf[len] = '\\0';\n\t}\n\treturn buf;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nchar *kmemdup_nul(const char *s, size_t len, gfp_t gfp)\n{\n\tchar *buf;\n\n\tif (!s)\n\t\treturn NULL;\n\n\tbuf = kmalloc_track_caller(len + 1, gfp);\n\tif (buf) {\n\t\tmemcpy(buf, s, len);\n\t\tbuf[len] = '\\0';\n\t}\n\treturn buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 2982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_inode_init_security",
          "args": [
            "inode",
            "dir",
            "&dentry->d_name",
            "shmem_initxattrs",
            "NULL"
          ],
          "line": 2978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_get_inode",
          "args": [
            "dir->i_sb",
            "dir",
            "S_IFLNK | 0777",
            "0",
            "VM_NORESERVE"
          ],
          "line": 2973
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2134-2193",
          "snippet": "static struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_file_operations\t\t\tramfs_file_operations",
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n#define BOGO_DIRENT_SIZE 20\n\nstatic struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "symname"
          ],
          "line": 2969
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_initxattrs NULL\n#define SHORT_SYMLINK_LEN 128\n#define BOGO_DIRENT_SIZE 20\n\nstatic int shmem_symlink(struct inode *dir, struct dentry *dentry, const char *symname)\n{\n\tint error;\n\tint len;\n\tstruct inode *inode;\n\tstruct page *page;\n\n\tlen = strlen(symname) + 1;\n\tif (len > PAGE_SIZE)\n\t\treturn -ENAMETOOLONG;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, S_IFLNK | 0777, 0,\n\t\t\t\tVM_NORESERVE);\n\tif (!inode)\n\t\treturn -ENOSPC;\n\n\terror = security_inode_init_security(inode, dir, &dentry->d_name,\n\t\t\t\t\t     shmem_initxattrs, NULL);\n\tif (error) {\n\t\tif (error != -EOPNOTSUPP) {\n\t\t\tiput(inode);\n\t\t\treturn error;\n\t\t}\n\t\terror = 0;\n\t}\n\n\tinode->i_size = len-1;\n\tif (len <= SHORT_SYMLINK_LEN) {\n\t\tinode->i_link = kmemdup(symname, len, GFP_KERNEL);\n\t\tif (!inode->i_link) {\n\t\t\tiput(inode);\n\t\t\treturn -ENOMEM;\n\t\t}\n\t\tinode->i_op = &shmem_short_symlink_operations;\n\t} else {\n\t\tinode_nohighmem(inode);\n\t\terror = shmem_getpage(inode, 0, &page, SGP_WRITE);\n\t\tif (error) {\n\t\t\tiput(inode);\n\t\t\treturn error;\n\t\t}\n\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\tinode->i_op = &shmem_symlink_inode_operations;\n\t\tmemcpy(page_address(page), symname, len);\n\t\tSetPageUptodate(page);\n\t\tset_page_dirty(page);\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tdir->i_size += BOGO_DIRENT_SIZE;\n\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\td_instantiate(dentry, inode);\n\tdget(dentry);\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_rename2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2921-2960",
    "snippet": "static int shmem_rename2(struct inode *old_dir, struct dentry *old_dentry, struct inode *new_dir, struct dentry *new_dentry, unsigned int flags)\n{\n\tstruct inode *inode = d_inode(old_dentry);\n\tint they_are_dirs = S_ISDIR(inode->i_mode);\n\n\tif (flags & ~(RENAME_NOREPLACE | RENAME_EXCHANGE | RENAME_WHITEOUT))\n\t\treturn -EINVAL;\n\n\tif (flags & RENAME_EXCHANGE)\n\t\treturn shmem_exchange(old_dir, old_dentry, new_dir, new_dentry);\n\n\tif (!simple_empty(new_dentry))\n\t\treturn -ENOTEMPTY;\n\n\tif (flags & RENAME_WHITEOUT) {\n\t\tint error;\n\n\t\terror = shmem_whiteout(old_dir, old_dentry);\n\t\tif (error)\n\t\t\treturn error;\n\t}\n\n\tif (d_really_is_positive(new_dentry)) {\n\t\t(void) shmem_unlink(new_dir, new_dentry);\n\t\tif (they_are_dirs) {\n\t\t\tdrop_nlink(d_inode(new_dentry));\n\t\t\tdrop_nlink(old_dir);\n\t\t}\n\t} else if (they_are_dirs) {\n\t\tdrop_nlink(old_dir);\n\t\tinc_nlink(new_dir);\n\t}\n\n\told_dir->i_size -= BOGO_DIRENT_SIZE;\n\tnew_dir->i_size += BOGO_DIRENT_SIZE;\n\told_dir->i_ctime = old_dir->i_mtime =\n\tnew_dir->i_ctime = new_dir->i_mtime =\n\tinode->i_ctime = current_time(old_dir);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define BOGO_DIRENT_SIZE 20"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "old_dir"
          ],
          "line": 2958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inc_nlink",
          "args": [
            "new_dir"
          ],
          "line": 2951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "drop_nlink",
          "args": [
            "old_dir"
          ],
          "line": 2950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "drop_nlink",
          "args": [
            "old_dir"
          ],
          "line": 2947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "drop_nlink",
          "args": [
            "d_inode(new_dentry)"
          ],
          "line": 2946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "new_dentry"
          ],
          "line": 2946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_unlink",
          "args": [
            "new_dir",
            "new_dentry"
          ],
          "line": 2944
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2843-2855",
          "snippet": "static int shmem_unlink(struct inode *dir, struct dentry *dentry)\n{\n\tstruct inode *inode = d_inode(dentry);\n\n\tif (inode->i_nlink > 1 && !S_ISDIR(inode->i_mode))\n\t\tshmem_free_inode(inode->i_sb);\n\n\tdir->i_size -= BOGO_DIRENT_SIZE;\n\tinode->i_ctime = dir->i_ctime = dir->i_mtime = current_time(inode);\n\tdrop_nlink(inode);\n\tdput(dentry);\t/* Undo the count from \"create\" - this does all the work */\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BOGO_DIRENT_SIZE 20\n\nstatic int shmem_unlink(struct inode *dir, struct dentry *dentry)\n{\n\tstruct inode *inode = d_inode(dentry);\n\n\tif (inode->i_nlink > 1 && !S_ISDIR(inode->i_mode))\n\t\tshmem_free_inode(inode->i_sb);\n\n\tdir->i_size -= BOGO_DIRENT_SIZE;\n\tinode->i_ctime = dir->i_ctime = dir->i_mtime = current_time(inode);\n\tdrop_nlink(inode);\n\tdput(dentry);\t/* Undo the count from \"create\" - this does all the work */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_really_is_positive",
          "args": [
            "new_dentry"
          ],
          "line": 2943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_whiteout",
          "args": [
            "old_dir",
            "old_dentry"
          ],
          "line": 2938
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_whiteout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2889-2913",
          "snippet": "static int shmem_whiteout(struct inode *old_dir, struct dentry *old_dentry)\n{\n\tstruct dentry *whiteout;\n\tint error;\n\n\twhiteout = d_alloc(old_dentry->d_parent, &old_dentry->d_name);\n\tif (!whiteout)\n\t\treturn -ENOMEM;\n\n\terror = shmem_mknod(old_dir, whiteout,\n\t\t\t    S_IFCHR | WHITEOUT_MODE, WHITEOUT_DEV);\n\tdput(whiteout);\n\tif (error)\n\t\treturn error;\n\n\t/*\n\t * Cheat and hash the whiteout while the old dentry is still in\n\t * place, instead of playing games with FS_RENAME_DOES_D_MOVE.\n\t *\n\t * d_lookup() will consistently find one of them at this point,\n\t * not sure which one, but that isn't even important.\n\t */\n\td_rehash(whiteout);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_whiteout(struct inode *old_dir, struct dentry *old_dentry)\n{\n\tstruct dentry *whiteout;\n\tint error;\n\n\twhiteout = d_alloc(old_dentry->d_parent, &old_dentry->d_name);\n\tif (!whiteout)\n\t\treturn -ENOMEM;\n\n\terror = shmem_mknod(old_dir, whiteout,\n\t\t\t    S_IFCHR | WHITEOUT_MODE, WHITEOUT_DEV);\n\tdput(whiteout);\n\tif (error)\n\t\treturn error;\n\n\t/*\n\t * Cheat and hash the whiteout while the old dentry is still in\n\t * place, instead of playing games with FS_RENAME_DOES_D_MOVE.\n\t *\n\t * d_lookup() will consistently find one of them at this point,\n\t * not sure which one, but that isn't even important.\n\t */\n\td_rehash(whiteout);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_empty",
          "args": [
            "new_dentry"
          ],
          "line": 2932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_exchange",
          "args": [
            "old_dir",
            "old_dentry",
            "new_dir",
            "new_dentry"
          ],
          "line": 2930
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_exchange",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2867-2887",
          "snippet": "static int shmem_exchange(struct inode *old_dir, struct dentry *old_dentry, struct inode *new_dir, struct dentry *new_dentry)\n{\n\tbool old_is_dir = d_is_dir(old_dentry);\n\tbool new_is_dir = d_is_dir(new_dentry);\n\n\tif (old_dir != new_dir && old_is_dir != new_is_dir) {\n\t\tif (old_is_dir) {\n\t\t\tdrop_nlink(old_dir);\n\t\t\tinc_nlink(new_dir);\n\t\t} else {\n\t\t\tdrop_nlink(new_dir);\n\t\t\tinc_nlink(old_dir);\n\t\t}\n\t}\n\told_dir->i_ctime = old_dir->i_mtime =\n\tnew_dir->i_ctime = new_dir->i_mtime =\n\td_inode(old_dentry)->i_ctime =\n\td_inode(new_dentry)->i_ctime = current_time(old_dir);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_exchange(struct inode *old_dir, struct dentry *old_dentry, struct inode *new_dir, struct dentry *new_dentry)\n{\n\tbool old_is_dir = d_is_dir(old_dentry);\n\tbool new_is_dir = d_is_dir(new_dentry);\n\n\tif (old_dir != new_dir && old_is_dir != new_is_dir) {\n\t\tif (old_is_dir) {\n\t\t\tdrop_nlink(old_dir);\n\t\t\tinc_nlink(new_dir);\n\t\t} else {\n\t\t\tdrop_nlink(new_dir);\n\t\t\tinc_nlink(old_dir);\n\t\t}\n\t}\n\told_dir->i_ctime = old_dir->i_mtime =\n\tnew_dir->i_ctime = new_dir->i_mtime =\n\td_inode(old_dentry)->i_ctime =\n\td_inode(new_dentry)->i_ctime = current_time(old_dir);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 2924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "old_dentry"
          ],
          "line": 2923
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BOGO_DIRENT_SIZE 20\n\nstatic int shmem_rename2(struct inode *old_dir, struct dentry *old_dentry, struct inode *new_dir, struct dentry *new_dentry, unsigned int flags)\n{\n\tstruct inode *inode = d_inode(old_dentry);\n\tint they_are_dirs = S_ISDIR(inode->i_mode);\n\n\tif (flags & ~(RENAME_NOREPLACE | RENAME_EXCHANGE | RENAME_WHITEOUT))\n\t\treturn -EINVAL;\n\n\tif (flags & RENAME_EXCHANGE)\n\t\treturn shmem_exchange(old_dir, old_dentry, new_dir, new_dentry);\n\n\tif (!simple_empty(new_dentry))\n\t\treturn -ENOTEMPTY;\n\n\tif (flags & RENAME_WHITEOUT) {\n\t\tint error;\n\n\t\terror = shmem_whiteout(old_dir, old_dentry);\n\t\tif (error)\n\t\t\treturn error;\n\t}\n\n\tif (d_really_is_positive(new_dentry)) {\n\t\t(void) shmem_unlink(new_dir, new_dentry);\n\t\tif (they_are_dirs) {\n\t\t\tdrop_nlink(d_inode(new_dentry));\n\t\t\tdrop_nlink(old_dir);\n\t\t}\n\t} else if (they_are_dirs) {\n\t\tdrop_nlink(old_dir);\n\t\tinc_nlink(new_dir);\n\t}\n\n\told_dir->i_size -= BOGO_DIRENT_SIZE;\n\tnew_dir->i_size += BOGO_DIRENT_SIZE;\n\told_dir->i_ctime = old_dir->i_mtime =\n\tnew_dir->i_ctime = new_dir->i_mtime =\n\tinode->i_ctime = current_time(old_dir);\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_whiteout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2889-2913",
    "snippet": "static int shmem_whiteout(struct inode *old_dir, struct dentry *old_dentry)\n{\n\tstruct dentry *whiteout;\n\tint error;\n\n\twhiteout = d_alloc(old_dentry->d_parent, &old_dentry->d_name);\n\tif (!whiteout)\n\t\treturn -ENOMEM;\n\n\terror = shmem_mknod(old_dir, whiteout,\n\t\t\t    S_IFCHR | WHITEOUT_MODE, WHITEOUT_DEV);\n\tdput(whiteout);\n\tif (error)\n\t\treturn error;\n\n\t/*\n\t * Cheat and hash the whiteout while the old dentry is still in\n\t * place, instead of playing games with FS_RENAME_DOES_D_MOVE.\n\t *\n\t * d_lookup() will consistently find one of them at this point,\n\t * not sure which one, but that isn't even important.\n\t */\n\td_rehash(whiteout);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d_rehash",
          "args": [
            "whiteout"
          ],
          "line": 2911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "whiteout"
          ],
          "line": 2900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_mknod",
          "args": [
            "old_dir",
            "whiteout",
            "S_IFCHR | WHITEOUT_MODE",
            "WHITEOUT_DEV"
          ],
          "line": 2898
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_mknod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2747-2774",
          "snippet": "static int\nshmem_mknod(struct inode *dir, struct dentry *dentry, umode_t mode, dev_t dev)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, dev, VM_NORESERVE);\n\tif (inode) {\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     &dentry->d_name,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\n\t\terror = 0;\n\t\tdir->i_size += BOGO_DIRENT_SIZE;\n\t\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\t\td_instantiate(dentry, inode);\n\t\tdget(dentry); /* Extra count - pin the dentry in core */\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_initxattrs NULL",
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_initxattrs NULL\n#define BOGO_DIRENT_SIZE 20\n\nstatic int\nshmem_mknod(struct inode *dir, struct dentry *dentry, umode_t mode, dev_t dev)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, dev, VM_NORESERVE);\n\tif (inode) {\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     &dentry->d_name,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\n\t\terror = 0;\n\t\tdir->i_size += BOGO_DIRENT_SIZE;\n\t\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\t\td_instantiate(dentry, inode);\n\t\tdget(dentry); /* Extra count - pin the dentry in core */\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_alloc",
          "args": [
            "old_dentry->d_parent",
            "&old_dentry->d_name"
          ],
          "line": 2894
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_whiteout(struct inode *old_dir, struct dentry *old_dentry)\n{\n\tstruct dentry *whiteout;\n\tint error;\n\n\twhiteout = d_alloc(old_dentry->d_parent, &old_dentry->d_name);\n\tif (!whiteout)\n\t\treturn -ENOMEM;\n\n\terror = shmem_mknod(old_dir, whiteout,\n\t\t\t    S_IFCHR | WHITEOUT_MODE, WHITEOUT_DEV);\n\tdput(whiteout);\n\tif (error)\n\t\treturn error;\n\n\t/*\n\t * Cheat and hash the whiteout while the old dentry is still in\n\t * place, instead of playing games with FS_RENAME_DOES_D_MOVE.\n\t *\n\t * d_lookup() will consistently find one of them at this point,\n\t * not sure which one, but that isn't even important.\n\t */\n\td_rehash(whiteout);\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_exchange",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2867-2887",
    "snippet": "static int shmem_exchange(struct inode *old_dir, struct dentry *old_dentry, struct inode *new_dir, struct dentry *new_dentry)\n{\n\tbool old_is_dir = d_is_dir(old_dentry);\n\tbool new_is_dir = d_is_dir(new_dentry);\n\n\tif (old_dir != new_dir && old_is_dir != new_is_dir) {\n\t\tif (old_is_dir) {\n\t\t\tdrop_nlink(old_dir);\n\t\t\tinc_nlink(new_dir);\n\t\t} else {\n\t\t\tdrop_nlink(new_dir);\n\t\t\tinc_nlink(old_dir);\n\t\t}\n\t}\n\told_dir->i_ctime = old_dir->i_mtime =\n\tnew_dir->i_ctime = new_dir->i_mtime =\n\td_inode(old_dentry)->i_ctime =\n\td_inode(new_dentry)->i_ctime = current_time(old_dir);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "old_dir"
          ],
          "line": 2884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "new_dentry"
          ],
          "line": 2884
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "old_dentry"
          ],
          "line": 2883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inc_nlink",
          "args": [
            "old_dir"
          ],
          "line": 2878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "drop_nlink",
          "args": [
            "new_dir"
          ],
          "line": 2877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inc_nlink",
          "args": [
            "new_dir"
          ],
          "line": 2875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "drop_nlink",
          "args": [
            "old_dir"
          ],
          "line": 2874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_is_dir",
          "args": [
            "new_dentry"
          ],
          "line": 2870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_is_dir",
          "args": [
            "old_dentry"
          ],
          "line": 2869
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_exchange(struct inode *old_dir, struct dentry *old_dentry, struct inode *new_dir, struct dentry *new_dentry)\n{\n\tbool old_is_dir = d_is_dir(old_dentry);\n\tbool new_is_dir = d_is_dir(new_dentry);\n\n\tif (old_dir != new_dir && old_is_dir != new_is_dir) {\n\t\tif (old_is_dir) {\n\t\t\tdrop_nlink(old_dir);\n\t\t\tinc_nlink(new_dir);\n\t\t} else {\n\t\t\tdrop_nlink(new_dir);\n\t\t\tinc_nlink(old_dir);\n\t\t}\n\t}\n\told_dir->i_ctime = old_dir->i_mtime =\n\tnew_dir->i_ctime = new_dir->i_mtime =\n\td_inode(old_dentry)->i_ctime =\n\td_inode(new_dentry)->i_ctime = current_time(old_dir);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_rmdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2857-2865",
    "snippet": "static int shmem_rmdir(struct inode *dir, struct dentry *dentry)\n{\n\tif (!simple_empty(dentry))\n\t\treturn -ENOTEMPTY;\n\n\tdrop_nlink(d_inode(dentry));\n\tdrop_nlink(dir);\n\treturn shmem_unlink(dir, dentry);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_unlink",
          "args": [
            "dir",
            "dentry"
          ],
          "line": 2864
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unlink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2843-2855",
          "snippet": "static int shmem_unlink(struct inode *dir, struct dentry *dentry)\n{\n\tstruct inode *inode = d_inode(dentry);\n\n\tif (inode->i_nlink > 1 && !S_ISDIR(inode->i_mode))\n\t\tshmem_free_inode(inode->i_sb);\n\n\tdir->i_size -= BOGO_DIRENT_SIZE;\n\tinode->i_ctime = dir->i_ctime = dir->i_mtime = current_time(inode);\n\tdrop_nlink(inode);\n\tdput(dentry);\t/* Undo the count from \"create\" - this does all the work */\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BOGO_DIRENT_SIZE 20\n\nstatic int shmem_unlink(struct inode *dir, struct dentry *dentry)\n{\n\tstruct inode *inode = d_inode(dentry);\n\n\tif (inode->i_nlink > 1 && !S_ISDIR(inode->i_mode))\n\t\tshmem_free_inode(inode->i_sb);\n\n\tdir->i_size -= BOGO_DIRENT_SIZE;\n\tinode->i_ctime = dir->i_ctime = dir->i_mtime = current_time(inode);\n\tdrop_nlink(inode);\n\tdput(dentry);\t/* Undo the count from \"create\" - this does all the work */\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "drop_nlink",
          "args": [
            "dir"
          ],
          "line": 2863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "drop_nlink",
          "args": [
            "d_inode(dentry)"
          ],
          "line": 2862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "dentry"
          ],
          "line": 2862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_empty",
          "args": [
            "dentry"
          ],
          "line": 2859
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_rmdir(struct inode *dir, struct dentry *dentry)\n{\n\tif (!simple_empty(dentry))\n\t\treturn -ENOTEMPTY;\n\n\tdrop_nlink(d_inode(dentry));\n\tdrop_nlink(dir);\n\treturn shmem_unlink(dir, dentry);\n}"
  },
  {
    "function_name": "shmem_unlink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2843-2855",
    "snippet": "static int shmem_unlink(struct inode *dir, struct dentry *dentry)\n{\n\tstruct inode *inode = d_inode(dentry);\n\n\tif (inode->i_nlink > 1 && !S_ISDIR(inode->i_mode))\n\t\tshmem_free_inode(inode->i_sb);\n\n\tdir->i_size -= BOGO_DIRENT_SIZE;\n\tinode->i_ctime = dir->i_ctime = dir->i_mtime = current_time(inode);\n\tdrop_nlink(inode);\n\tdput(dentry);\t/* Undo the count from \"create\" - this does all the work */\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define BOGO_DIRENT_SIZE 20"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dput",
          "args": [
            "dentry"
          ],
          "line": 2853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "drop_nlink",
          "args": [
            "inode"
          ],
          "line": 2852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "inode"
          ],
          "line": 2851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_free_inode",
          "args": [
            "inode->i_sb"
          ],
          "line": 2848
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_free_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "257-265",
          "snippet": "static void shmem_free_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tsbinfo->free_inodes++;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_free_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tsbinfo->free_inodes++;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "inode->i_mode"
          ],
          "line": 2847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "dentry"
          ],
          "line": 2845
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BOGO_DIRENT_SIZE 20\n\nstatic int shmem_unlink(struct inode *dir, struct dentry *dentry)\n{\n\tstruct inode *inode = d_inode(dentry);\n\n\tif (inode->i_nlink > 1 && !S_ISDIR(inode->i_mode))\n\t\tshmem_free_inode(inode->i_sb);\n\n\tdir->i_size -= BOGO_DIRENT_SIZE;\n\tinode->i_ctime = dir->i_ctime = dir->i_mtime = current_time(inode);\n\tdrop_nlink(inode);\n\tdput(dentry);\t/* Undo the count from \"create\" - this does all the work */\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2819-2841",
    "snippet": "static int shmem_link(struct dentry *old_dentry, struct inode *dir, struct dentry *dentry)\n{\n\tstruct inode *inode = d_inode(old_dentry);\n\tint ret;\n\n\t/*\n\t * No ordinary (disk based) filesystem counts links as inodes;\n\t * but each new link needs a new dentry, pinning lowmem, and\n\t * tmpfs dentries cannot be pruned until they are unlinked.\n\t */\n\tret = shmem_reserve_inode(inode->i_sb);\n\tif (ret)\n\t\tgoto out;\n\n\tdir->i_size += BOGO_DIRENT_SIZE;\n\tinode->i_ctime = dir->i_ctime = dir->i_mtime = current_time(inode);\n\tinc_nlink(inode);\n\tihold(inode);\t/* New dentry reference */\n\tdget(dentry);\t\t/* Extra pinning count for the created dentry */\n\td_instantiate(dentry, inode);\nout:\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define BOGO_DIRENT_SIZE 20"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d_instantiate",
          "args": [
            "dentry",
            "inode"
          ],
          "line": 2838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dget",
          "args": [
            "dentry"
          ],
          "line": 2837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ihold",
          "args": [
            "inode"
          ],
          "line": 2836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inc_nlink",
          "args": [
            "inode"
          ],
          "line": 2835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "inode"
          ],
          "line": 2834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_reserve_inode",
          "args": [
            "inode->i_sb"
          ],
          "line": 2829
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_reserve_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "242-255",
          "snippet": "static int shmem_reserve_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tif (!sbinfo->free_inodes) {\n\t\t\tspin_unlock(&sbinfo->stat_lock);\n\t\t\treturn -ENOSPC;\n\t\t}\n\t\tsbinfo->free_inodes--;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_reserve_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tif (!sbinfo->free_inodes) {\n\t\t\tspin_unlock(&sbinfo->stat_lock);\n\t\t\treturn -ENOSPC;\n\t\t}\n\t\tsbinfo->free_inodes--;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "old_dentry"
          ],
          "line": 2821
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BOGO_DIRENT_SIZE 20\n\nstatic int shmem_link(struct dentry *old_dentry, struct inode *dir, struct dentry *dentry)\n{\n\tstruct inode *inode = d_inode(old_dentry);\n\tint ret;\n\n\t/*\n\t * No ordinary (disk based) filesystem counts links as inodes;\n\t * but each new link needs a new dentry, pinning lowmem, and\n\t * tmpfs dentries cannot be pruned until they are unlinked.\n\t */\n\tret = shmem_reserve_inode(inode->i_sb);\n\tif (ret)\n\t\tgoto out;\n\n\tdir->i_size += BOGO_DIRENT_SIZE;\n\tinode->i_ctime = dir->i_ctime = dir->i_mtime = current_time(inode);\n\tinc_nlink(inode);\n\tihold(inode);\t/* New dentry reference */\n\tdget(dentry);\t\t/* Extra pinning count for the created dentry */\n\td_instantiate(dentry, inode);\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "shmem_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2810-2814",
    "snippet": "static int shmem_create(struct inode *dir, struct dentry *dentry, umode_t mode,\n\t\tbool excl)\n{\n\treturn shmem_mknod(dir, dentry, mode | S_IFREG, 0);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_mknod",
          "args": [
            "dir",
            "dentry",
            "mode | S_IFREG",
            "0"
          ],
          "line": 2813
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_mknod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2747-2774",
          "snippet": "static int\nshmem_mknod(struct inode *dir, struct dentry *dentry, umode_t mode, dev_t dev)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, dev, VM_NORESERVE);\n\tif (inode) {\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     &dentry->d_name,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\n\t\terror = 0;\n\t\tdir->i_size += BOGO_DIRENT_SIZE;\n\t\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\t\td_instantiate(dentry, inode);\n\t\tdget(dentry); /* Extra count - pin the dentry in core */\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_initxattrs NULL",
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_initxattrs NULL\n#define BOGO_DIRENT_SIZE 20\n\nstatic int\nshmem_mknod(struct inode *dir, struct dentry *dentry, umode_t mode, dev_t dev)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, dev, VM_NORESERVE);\n\tif (inode) {\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     &dentry->d_name,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\n\t\terror = 0;\n\t\tdir->i_size += BOGO_DIRENT_SIZE;\n\t\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\t\td_instantiate(dentry, inode);\n\t\tdget(dentry); /* Extra count - pin the dentry in core */\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_create(struct inode *dir, struct dentry *dentry, umode_t mode,\n\t\tbool excl)\n{\n\treturn shmem_mknod(dir, dentry, mode | S_IFREG, 0);\n}"
  },
  {
    "function_name": "shmem_mkdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2800-2808",
    "snippet": "static int shmem_mkdir(struct inode *dir, struct dentry *dentry, umode_t mode)\n{\n\tint error;\n\n\tif ((error = shmem_mknod(dir, dentry, mode | S_IFDIR, 0)))\n\t\treturn error;\n\tinc_nlink(dir);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inc_nlink",
          "args": [
            "dir"
          ],
          "line": 2806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_mknod",
          "args": [
            "dir",
            "dentry",
            "mode | S_IFDIR",
            "0"
          ],
          "line": 2804
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_mknod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2747-2774",
          "snippet": "static int\nshmem_mknod(struct inode *dir, struct dentry *dentry, umode_t mode, dev_t dev)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, dev, VM_NORESERVE);\n\tif (inode) {\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     &dentry->d_name,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\n\t\terror = 0;\n\t\tdir->i_size += BOGO_DIRENT_SIZE;\n\t\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\t\td_instantiate(dentry, inode);\n\t\tdget(dentry); /* Extra count - pin the dentry in core */\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_initxattrs NULL",
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_initxattrs NULL\n#define BOGO_DIRENT_SIZE 20\n\nstatic int\nshmem_mknod(struct inode *dir, struct dentry *dentry, umode_t mode, dev_t dev)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, dev, VM_NORESERVE);\n\tif (inode) {\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     &dentry->d_name,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\n\t\terror = 0;\n\t\tdir->i_size += BOGO_DIRENT_SIZE;\n\t\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\t\td_instantiate(dentry, inode);\n\t\tdget(dentry); /* Extra count - pin the dentry in core */\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_mkdir(struct inode *dir, struct dentry *dentry, umode_t mode)\n{\n\tint error;\n\n\tif ((error = shmem_mknod(dir, dentry, mode | S_IFDIR, 0)))\n\t\treturn error;\n\tinc_nlink(dir);\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_tmpfile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2776-2798",
    "snippet": "static int\nshmem_tmpfile(struct inode *dir, struct dentry *dentry, umode_t mode)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, 0, VM_NORESERVE);\n\tif (inode) {\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     NULL,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\td_tmpfile(dentry, inode);\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_initxattrs NULL"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 2796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_tmpfile",
          "args": [
            "dentry",
            "inode"
          ],
          "line": 2792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_acl_create",
          "args": [
            "dir",
            "inode"
          ],
          "line": 2789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_inode_init_security",
          "args": [
            "inode",
            "dir",
            "NULL",
            "shmem_initxattrs",
            "NULL"
          ],
          "line": 2784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_get_inode",
          "args": [
            "dir->i_sb",
            "dir",
            "mode",
            "0",
            "VM_NORESERVE"
          ],
          "line": 2782
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2134-2193",
          "snippet": "static struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_file_operations\t\t\tramfs_file_operations",
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n#define BOGO_DIRENT_SIZE 20\n\nstatic struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_initxattrs NULL\n\nstatic int\nshmem_tmpfile(struct inode *dir, struct dentry *dentry, umode_t mode)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, 0, VM_NORESERVE);\n\tif (inode) {\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     NULL,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\td_tmpfile(dentry, inode);\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_mknod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2747-2774",
    "snippet": "static int\nshmem_mknod(struct inode *dir, struct dentry *dentry, umode_t mode, dev_t dev)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, dev, VM_NORESERVE);\n\tif (inode) {\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     &dentry->d_name,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\n\t\terror = 0;\n\t\tdir->i_size += BOGO_DIRENT_SIZE;\n\t\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\t\td_instantiate(dentry, inode);\n\t\tdget(dentry); /* Extra count - pin the dentry in core */\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_initxattrs NULL",
      "#define BOGO_DIRENT_SIZE 20"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 2772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dget",
          "args": [
            "dentry"
          ],
          "line": 2768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_instantiate",
          "args": [
            "dentry",
            "inode"
          ],
          "line": 2767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "dir"
          ],
          "line": 2766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_inode_init_security",
          "args": [
            "inode",
            "dir",
            "&dentry->d_name",
            "shmem_initxattrs",
            "NULL"
          ],
          "line": 2758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_acl_create",
          "args": [
            "dir",
            "inode"
          ],
          "line": 2755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_get_inode",
          "args": [
            "dir->i_sb",
            "dir",
            "mode",
            "dev",
            "VM_NORESERVE"
          ],
          "line": 2753
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_get_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2134-2193",
          "snippet": "static struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_file_operations\t\t\tramfs_file_operations",
            "#define BOGO_DIRENT_SIZE 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n#define BOGO_DIRENT_SIZE 20\n\nstatic struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_initxattrs NULL\n#define BOGO_DIRENT_SIZE 20\n\nstatic int\nshmem_mknod(struct inode *dir, struct dentry *dentry, umode_t mode, dev_t dev)\n{\n\tstruct inode *inode;\n\tint error = -ENOSPC;\n\n\tinode = shmem_get_inode(dir->i_sb, dir, mode, dev, VM_NORESERVE);\n\tif (inode) {\n\t\terror = simple_acl_create(dir, inode);\n\t\tif (error)\n\t\t\tgoto out_iput;\n\t\terror = security_inode_init_security(inode, dir,\n\t\t\t\t\t\t     &dentry->d_name,\n\t\t\t\t\t\t     shmem_initxattrs, NULL);\n\t\tif (error && error != -EOPNOTSUPP)\n\t\t\tgoto out_iput;\n\n\t\terror = 0;\n\t\tdir->i_size += BOGO_DIRENT_SIZE;\n\t\tdir->i_ctime = dir->i_mtime = current_time(dir);\n\t\td_instantiate(dentry, inode);\n\t\tdget(dentry); /* Extra count - pin the dentry in core */\n\t}\n\treturn error;\nout_iput:\n\tiput(inode);\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_statfs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2723-2742",
    "snippet": "static int shmem_statfs(struct dentry *dentry, struct kstatfs *buf)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(dentry->d_sb);\n\n\tbuf->f_type = TMPFS_MAGIC;\n\tbuf->f_bsize = PAGE_SIZE;\n\tbuf->f_namelen = NAME_MAX;\n\tif (sbinfo->max_blocks) {\n\t\tbuf->f_blocks = sbinfo->max_blocks;\n\t\tbuf->f_bavail =\n\t\tbuf->f_bfree  = sbinfo->max_blocks -\n\t\t\t\tpercpu_counter_sum(&sbinfo->used_blocks);\n\t}\n\tif (sbinfo->max_inodes) {\n\t\tbuf->f_files = sbinfo->max_inodes;\n\t\tbuf->f_ffree = sbinfo->free_inodes;\n\t}\n\t/* else leave those fields 0 like simple_statfs */\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "percpu_counter_sum",
          "args": [
            "&sbinfo->used_blocks"
          ],
          "line": 2734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "dentry->d_sb"
          ],
          "line": 2725
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_statfs(struct dentry *dentry, struct kstatfs *buf)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(dentry->d_sb);\n\n\tbuf->f_type = TMPFS_MAGIC;\n\tbuf->f_bsize = PAGE_SIZE;\n\tbuf->f_namelen = NAME_MAX;\n\tif (sbinfo->max_blocks) {\n\t\tbuf->f_blocks = sbinfo->max_blocks;\n\t\tbuf->f_bavail =\n\t\tbuf->f_bfree  = sbinfo->max_blocks -\n\t\t\t\tpercpu_counter_sum(&sbinfo->used_blocks);\n\t}\n\tif (sbinfo->max_inodes) {\n\t\tbuf->f_files = sbinfo->max_inodes;\n\t\tbuf->f_ffree = sbinfo->free_inodes;\n\t}\n\t/* else leave those fields 0 like simple_statfs */\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_fallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2591-2721",
    "snippet": "static long shmem_fallocate(struct file *file, int mode, loff_t offset,\n\t\t\t\t\t\t\t loff_t len)\n{\n\tstruct inode *inode = file_inode(file);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_falloc shmem_falloc;\n\tpgoff_t start, index, end;\n\tint error;\n\n\tif (mode & ~(FALLOC_FL_KEEP_SIZE | FALLOC_FL_PUNCH_HOLE))\n\t\treturn -EOPNOTSUPP;\n\n\tinode_lock(inode);\n\n\tif (mode & FALLOC_FL_PUNCH_HOLE) {\n\t\tstruct address_space *mapping = file->f_mapping;\n\t\tloff_t unmap_start = round_up(offset, PAGE_SIZE);\n\t\tloff_t unmap_end = round_down(offset + len, PAGE_SIZE) - 1;\n\t\tDECLARE_WAIT_QUEUE_HEAD_ONSTACK(shmem_falloc_waitq);\n\n\t\t/* protected by i_mutex */\n\t\tif (info->seals & F_SEAL_WRITE) {\n\t\t\terror = -EPERM;\n\t\t\tgoto out;\n\t\t}\n\n\t\tshmem_falloc.waitq = &shmem_falloc_waitq;\n\t\tshmem_falloc.start = unmap_start >> PAGE_SHIFT;\n\t\tshmem_falloc.next = (unmap_end + 1) >> PAGE_SHIFT;\n\t\tspin_lock(&inode->i_lock);\n\t\tinode->i_private = &shmem_falloc;\n\t\tspin_unlock(&inode->i_lock);\n\n\t\tif ((u64)unmap_end > (u64)unmap_start)\n\t\t\tunmap_mapping_range(mapping, unmap_start,\n\t\t\t\t\t    1 + unmap_end - unmap_start, 0);\n\t\tshmem_truncate_range(inode, offset, offset + len - 1);\n\t\t/* No need to unmap again: hole-punching leaves COWed pages */\n\n\t\tspin_lock(&inode->i_lock);\n\t\tinode->i_private = NULL;\n\t\twake_up_all(&shmem_falloc_waitq);\n\t\tWARN_ON_ONCE(!list_empty(&shmem_falloc_waitq.head));\n\t\tspin_unlock(&inode->i_lock);\n\t\terror = 0;\n\t\tgoto out;\n\t}\n\n\t/* We need to check rlimit even when FALLOC_FL_KEEP_SIZE */\n\terror = inode_newsize_ok(inode, offset + len);\n\tif (error)\n\t\tgoto out;\n\n\tif ((info->seals & F_SEAL_GROW) && offset + len > inode->i_size) {\n\t\terror = -EPERM;\n\t\tgoto out;\n\t}\n\n\tstart = offset >> PAGE_SHIFT;\n\tend = (offset + len + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\t/* Try to avoid a swapstorm if len is impossible to satisfy */\n\tif (sbinfo->max_blocks && end - start > sbinfo->max_blocks) {\n\t\terror = -ENOSPC;\n\t\tgoto out;\n\t}\n\n\tshmem_falloc.waitq = NULL;\n\tshmem_falloc.start = start;\n\tshmem_falloc.next  = start;\n\tshmem_falloc.nr_falloced = 0;\n\tshmem_falloc.nr_unswapped = 0;\n\tspin_lock(&inode->i_lock);\n\tinode->i_private = &shmem_falloc;\n\tspin_unlock(&inode->i_lock);\n\n\tfor (index = start; index < end; index++) {\n\t\tstruct page *page;\n\n\t\t/*\n\t\t * Good, the fallocate(2) manpage permits EINTR: we may have\n\t\t * been interrupted because we are using up too much memory.\n\t\t */\n\t\tif (signal_pending(current))\n\t\t\terror = -EINTR;\n\t\telse if (shmem_falloc.nr_unswapped > shmem_falloc.nr_falloced)\n\t\t\terror = -ENOMEM;\n\t\telse\n\t\t\terror = shmem_getpage(inode, index, &page, SGP_FALLOC);\n\t\tif (error) {\n\t\t\t/* Remove the !PageUptodate pages we added */\n\t\t\tif (index > start) {\n\t\t\t\tshmem_undo_range(inode,\n\t\t\t\t    (loff_t)start << PAGE_SHIFT,\n\t\t\t\t    ((loff_t)index << PAGE_SHIFT) - 1, true);\n\t\t\t}\n\t\t\tgoto undone;\n\t\t}\n\n\t\t/*\n\t\t * Inform shmem_writepage() how far we have reached.\n\t\t * No need for lock or barrier: we have the page lock.\n\t\t */\n\t\tshmem_falloc.next++;\n\t\tif (!PageUptodate(page))\n\t\t\tshmem_falloc.nr_falloced++;\n\n\t\t/*\n\t\t * If !PageUptodate, leave it that way so that freeable pages\n\t\t * can be recognized if we need to rollback on error later.\n\t\t * But set_page_dirty so that memory pressure will swap rather\n\t\t * than free the pages we are allocating (and SGP_CACHE pages\n\t\t * might still be clean: we now need to mark those dirty too).\n\t\t */\n\t\tset_page_dirty(page);\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tcond_resched();\n\t}\n\n\tif (!(mode & FALLOC_FL_KEEP_SIZE) && offset + len > inode->i_size)\n\t\ti_size_write(inode, offset + len);\n\tinode->i_ctime = current_time(inode);\nundone:\n\tspin_lock(&inode->i_lock);\n\tinode->i_private = NULL;\n\tspin_unlock(&inode->i_lock);\nout:\n\tinode_unlock(inode);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode_unlock",
          "args": [
            "inode"
          ],
          "line": 2719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 2717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 2715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "inode"
          ],
          "line": 2713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "offset + len"
          ],
          "line": 2712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 2708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 2707
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 2706
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "page"
          ],
          "line": 2705
        },
        "resolved": true,
        "details": {
          "function_name": "set_page_dirty_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "2573-2581",
          "snippet": "int set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 2695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_undo_range",
          "args": [
            "inode",
            "(loff_t)start << PAGE_SHIFT",
            "((loff_t)index << PAGE_SHIFT) - 1",
            "true"
          ],
          "line": 2683
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_undo_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "769-962",
          "snippet": "static void shmem_undo_range(struct inode *inode, loff_t lstart, loff_t lend,\n\t\t\t\t\t\t\t\t bool unfalloc)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tpgoff_t start = (lstart + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tpgoff_t end = (lend + 1) >> PAGE_SHIFT;\n\tunsigned int partial_start = lstart & (PAGE_SIZE - 1);\n\tunsigned int partial_end = (lend + 1) & (PAGE_SIZE - 1);\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tlong nr_swaps_freed = 0;\n\tpgoff_t index;\n\tint i;\n\n\tif (lend == -1)\n\t\tend = -1;\t/* unsigned, so actually very big */\n\n\tpagevec_init(&pvec);\n\tindex = start;\n\twhile (index < end) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr)\n\t\t\tbreak;\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnr_swaps_freed += !shmem_free_swap(mapping,\n\t\t\t\t\t\t\t\tindex, page);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tVM_BUG_ON_PAGE(page_to_pgoff(page) != index, page);\n\n\t\t\tif (!trylock_page(page))\n\t\t\t\tcontinue;\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t\tindex++;\n\t}\n\n\tif (partial_start) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, start - 1, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tunsigned int top = PAGE_SIZE;\n\t\t\tif (start > end) {\n\t\t\t\ttop = partial_end;\n\t\t\t\tpartial_end = 0;\n\t\t\t}\n\t\t\tzero_user_segment(page, partial_start, top);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (partial_end) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, end, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tzero_user_segment(page, 0, partial_end);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (start >= end)\n\t\treturn;\n\n\tindex = start;\n\twhile (index < end) {\n\t\tcond_resched();\n\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\t/* If all gone or hole-punch or unfalloc, we're done */\n\t\t\tif (index == start || end != -1)\n\t\t\t\tbreak;\n\t\t\t/* But if truncating, restart to make sure all gone */\n\t\t\tindex = start;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (shmem_free_swap(mapping, index, page)) {\n\t\t\t\t\t/* Swap was replaced by page: retry */\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tnr_swaps_freed++;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlock_page(page);\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\t/*\n\t\t\t\t * Partial thp truncate due 'start' in middle\n\t\t\t\t * of THP: don't need to look on these pages\n\t\t\t\t * again on !pvec.nr restart.\n\t\t\t\t */\n\t\t\t\tif (index != round_down(end, HPAGE_PMD_NR))\n\t\t\t\t\tstart++;\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t} else {\n\t\t\t\t\t/* Page was replaced by swap: retry */\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tindex++;\n\t}\n\n\tspin_lock_irq(&info->lock);\n\tinfo->swapped -= nr_swaps_freed;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irq(&info->lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_undo_range(struct inode *inode, loff_t lstart, loff_t lend,\n\t\t\t\t\t\t\t\t bool unfalloc)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tpgoff_t start = (lstart + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tpgoff_t end = (lend + 1) >> PAGE_SHIFT;\n\tunsigned int partial_start = lstart & (PAGE_SIZE - 1);\n\tunsigned int partial_end = (lend + 1) & (PAGE_SIZE - 1);\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tlong nr_swaps_freed = 0;\n\tpgoff_t index;\n\tint i;\n\n\tif (lend == -1)\n\t\tend = -1;\t/* unsigned, so actually very big */\n\n\tpagevec_init(&pvec);\n\tindex = start;\n\twhile (index < end) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr)\n\t\t\tbreak;\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnr_swaps_freed += !shmem_free_swap(mapping,\n\t\t\t\t\t\t\t\tindex, page);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tVM_BUG_ON_PAGE(page_to_pgoff(page) != index, page);\n\n\t\t\tif (!trylock_page(page))\n\t\t\t\tcontinue;\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t\tindex++;\n\t}\n\n\tif (partial_start) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, start - 1, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tunsigned int top = PAGE_SIZE;\n\t\t\tif (start > end) {\n\t\t\t\ttop = partial_end;\n\t\t\t\tpartial_end = 0;\n\t\t\t}\n\t\t\tzero_user_segment(page, partial_start, top);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (partial_end) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, end, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tzero_user_segment(page, 0, partial_end);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (start >= end)\n\t\treturn;\n\n\tindex = start;\n\twhile (index < end) {\n\t\tcond_resched();\n\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\t/* If all gone or hole-punch or unfalloc, we're done */\n\t\t\tif (index == start || end != -1)\n\t\t\t\tbreak;\n\t\t\t/* But if truncating, restart to make sure all gone */\n\t\t\tindex = start;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (shmem_free_swap(mapping, index, page)) {\n\t\t\t\t\t/* Swap was replaced by page: retry */\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tnr_swaps_freed++;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlock_page(page);\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\t/*\n\t\t\t\t * Partial thp truncate due 'start' in middle\n\t\t\t\t * of THP: don't need to look on these pages\n\t\t\t\t * again on !pvec.nr restart.\n\t\t\t\t */\n\t\t\t\tif (index != round_down(end, HPAGE_PMD_NR))\n\t\t\t\t\tstart++;\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t} else {\n\t\t\t\t\t/* Page was replaced by swap: retry */\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tindex++;\n\t}\n\n\tspin_lock_irq(&info->lock);\n\tinfo->swapped -= nr_swaps_freed;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irq(&info->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_getpage",
          "args": [
            "inode",
            "index",
            "&page",
            "SGP_FALLOC"
          ],
          "line": 2679
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "129-134",
          "snippet": "int shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "signal_pending",
          "args": [
            "current"
          ],
          "line": 2674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 2665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 2663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_newsize_ok",
          "args": [
            "inode",
            "offset + len"
          ],
          "line": 2641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 2635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!list_empty(&shmem_falloc_waitq.head)"
          ],
          "line": 2634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&shmem_falloc_waitq.head"
          ],
          "line": 2634
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wake_up_all",
          "args": [
            "&shmem_falloc_waitq"
          ],
          "line": 2633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 2631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_truncate_range",
          "args": [
            "inode",
            "offset",
            "offset + len - 1"
          ],
          "line": 2628
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_truncate_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3840-3843",
          "snippet": "void shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\ttruncate_inode_pages_range(inode->i_mapping, lstart, lend);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nvoid shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\ttruncate_inode_pages_range(inode->i_mapping, lstart, lend);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unmap_mapping_range",
          "args": [
            "mapping",
            "unmap_start",
            "1 + unmap_end - unmap_start",
            "0"
          ],
          "line": 2626
        },
        "resolved": true,
        "details": {
          "function_name": "unmap_mapping_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory.c",
          "lines": "2630-2645",
          "snippet": "void unmap_mapping_range(struct address_space *mapping,\n\t\tloff_t const holebegin, loff_t const holelen, int even_cows)\n{\n\tpgoff_t hba = holebegin >> PAGE_SHIFT;\n\tpgoff_t hlen = (holelen + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\n\t/* Check for overflow. */\n\tif (sizeof(holelen) > sizeof(hlen)) {\n\t\tlong long holeend =\n\t\t\t(holebegin + holelen + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\t\tif (holeend & ~(long long)ULONG_MAX)\n\t\t\thlen = ULONG_MAX - hba + 1;\n\t}\n\n\tunmap_mapping_pages(mapping, hba, hlen, even_cows);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/io.h>",
            "#include <linux/oom.h>",
            "#include <linux/dax.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/dma-debug.h>",
            "#include <linux/string.h>",
            "#include <linux/migrate.h>",
            "#include <linux/gfp.h>",
            "#include <linux/elf.h>",
            "#include <linux/swapops.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pfn_t.h>",
            "#include <linux/init.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/export.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/memremap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel_stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <asm/mmu_context.h>\n#include <asm/io.h>\n#include <linux/oom.h>\n#include <linux/dax.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/debugfs.h>\n#include <linux/dma-debug.h>\n#include <linux/string.h>\n#include <linux/migrate.h>\n#include <linux/gfp.h>\n#include <linux/elf.h>\n#include <linux/swapops.h>\n#include <linux/mmu_notifier.h>\n#include <linux/memcontrol.h>\n#include <linux/writeback.h>\n#include <linux/pfn_t.h>\n#include <linux/init.h>\n#include <linux/delayacct.h>\n#include <linux/export.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/memremap.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/kernel_stat.h>\n\nvoid unmap_mapping_range(struct address_space *mapping,\n\t\tloff_t const holebegin, loff_t const holelen, int even_cows)\n{\n\tpgoff_t hba = holebegin >> PAGE_SHIFT;\n\tpgoff_t hlen = (holelen + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\n\t/* Check for overflow. */\n\tif (sizeof(holelen) > sizeof(hlen)) {\n\t\tlong long holeend =\n\t\t\t(holebegin + holelen + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\t\tif (holeend & ~(long long)ULONG_MAX)\n\t\t\thlen = ULONG_MAX - hba + 1;\n\t}\n\n\tunmap_mapping_pages(mapping, hba, hlen, even_cows);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 2623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 2621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECLARE_WAIT_QUEUE_HEAD_ONSTACK",
          "args": [
            "shmem_falloc_waitq"
          ],
          "line": 2610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "offset + len",
            "PAGE_SIZE"
          ],
          "line": 2609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "offset",
            "PAGE_SIZE"
          ],
          "line": 2608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_lock",
          "args": [
            "inode"
          ],
          "line": 2604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 2596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 2595
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "file"
          ],
          "line": 2594
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic long shmem_fallocate(struct file *file, int mode, loff_t offset,\n\t\t\t\t\t\t\t loff_t len)\n{\n\tstruct inode *inode = file_inode(file);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_falloc shmem_falloc;\n\tpgoff_t start, index, end;\n\tint error;\n\n\tif (mode & ~(FALLOC_FL_KEEP_SIZE | FALLOC_FL_PUNCH_HOLE))\n\t\treturn -EOPNOTSUPP;\n\n\tinode_lock(inode);\n\n\tif (mode & FALLOC_FL_PUNCH_HOLE) {\n\t\tstruct address_space *mapping = file->f_mapping;\n\t\tloff_t unmap_start = round_up(offset, PAGE_SIZE);\n\t\tloff_t unmap_end = round_down(offset + len, PAGE_SIZE) - 1;\n\t\tDECLARE_WAIT_QUEUE_HEAD_ONSTACK(shmem_falloc_waitq);\n\n\t\t/* protected by i_mutex */\n\t\tif (info->seals & F_SEAL_WRITE) {\n\t\t\terror = -EPERM;\n\t\t\tgoto out;\n\t\t}\n\n\t\tshmem_falloc.waitq = &shmem_falloc_waitq;\n\t\tshmem_falloc.start = unmap_start >> PAGE_SHIFT;\n\t\tshmem_falloc.next = (unmap_end + 1) >> PAGE_SHIFT;\n\t\tspin_lock(&inode->i_lock);\n\t\tinode->i_private = &shmem_falloc;\n\t\tspin_unlock(&inode->i_lock);\n\n\t\tif ((u64)unmap_end > (u64)unmap_start)\n\t\t\tunmap_mapping_range(mapping, unmap_start,\n\t\t\t\t\t    1 + unmap_end - unmap_start, 0);\n\t\tshmem_truncate_range(inode, offset, offset + len - 1);\n\t\t/* No need to unmap again: hole-punching leaves COWed pages */\n\n\t\tspin_lock(&inode->i_lock);\n\t\tinode->i_private = NULL;\n\t\twake_up_all(&shmem_falloc_waitq);\n\t\tWARN_ON_ONCE(!list_empty(&shmem_falloc_waitq.head));\n\t\tspin_unlock(&inode->i_lock);\n\t\terror = 0;\n\t\tgoto out;\n\t}\n\n\t/* We need to check rlimit even when FALLOC_FL_KEEP_SIZE */\n\terror = inode_newsize_ok(inode, offset + len);\n\tif (error)\n\t\tgoto out;\n\n\tif ((info->seals & F_SEAL_GROW) && offset + len > inode->i_size) {\n\t\terror = -EPERM;\n\t\tgoto out;\n\t}\n\n\tstart = offset >> PAGE_SHIFT;\n\tend = (offset + len + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\t/* Try to avoid a swapstorm if len is impossible to satisfy */\n\tif (sbinfo->max_blocks && end - start > sbinfo->max_blocks) {\n\t\terror = -ENOSPC;\n\t\tgoto out;\n\t}\n\n\tshmem_falloc.waitq = NULL;\n\tshmem_falloc.start = start;\n\tshmem_falloc.next  = start;\n\tshmem_falloc.nr_falloced = 0;\n\tshmem_falloc.nr_unswapped = 0;\n\tspin_lock(&inode->i_lock);\n\tinode->i_private = &shmem_falloc;\n\tspin_unlock(&inode->i_lock);\n\n\tfor (index = start; index < end; index++) {\n\t\tstruct page *page;\n\n\t\t/*\n\t\t * Good, the fallocate(2) manpage permits EINTR: we may have\n\t\t * been interrupted because we are using up too much memory.\n\t\t */\n\t\tif (signal_pending(current))\n\t\t\terror = -EINTR;\n\t\telse if (shmem_falloc.nr_unswapped > shmem_falloc.nr_falloced)\n\t\t\terror = -ENOMEM;\n\t\telse\n\t\t\terror = shmem_getpage(inode, index, &page, SGP_FALLOC);\n\t\tif (error) {\n\t\t\t/* Remove the !PageUptodate pages we added */\n\t\t\tif (index > start) {\n\t\t\t\tshmem_undo_range(inode,\n\t\t\t\t    (loff_t)start << PAGE_SHIFT,\n\t\t\t\t    ((loff_t)index << PAGE_SHIFT) - 1, true);\n\t\t\t}\n\t\t\tgoto undone;\n\t\t}\n\n\t\t/*\n\t\t * Inform shmem_writepage() how far we have reached.\n\t\t * No need for lock or barrier: we have the page lock.\n\t\t */\n\t\tshmem_falloc.next++;\n\t\tif (!PageUptodate(page))\n\t\t\tshmem_falloc.nr_falloced++;\n\n\t\t/*\n\t\t * If !PageUptodate, leave it that way so that freeable pages\n\t\t * can be recognized if we need to rollback on error later.\n\t\t * But set_page_dirty so that memory pressure will swap rather\n\t\t * than free the pages we are allocating (and SGP_CACHE pages\n\t\t * might still be clean: we now need to mark those dirty too).\n\t\t */\n\t\tset_page_dirty(page);\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tcond_resched();\n\t}\n\n\tif (!(mode & FALLOC_FL_KEEP_SIZE) && offset + len > inode->i_size)\n\t\ti_size_write(inode, offset + len);\n\tinode->i_ctime = current_time(inode);\nundone:\n\tspin_lock(&inode->i_lock);\n\tinode->i_private = NULL;\n\tspin_unlock(&inode->i_lock);\nout:\n\tinode_unlock(inode);\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_file_llseek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2555-2589",
    "snippet": "static loff_t shmem_file_llseek(struct file *file, loff_t offset, int whence)\n{\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tpgoff_t start, end;\n\tloff_t new_offset;\n\n\tif (whence != SEEK_DATA && whence != SEEK_HOLE)\n\t\treturn generic_file_llseek_size(file, offset, whence,\n\t\t\t\t\tMAX_LFS_FILESIZE, i_size_read(inode));\n\tinode_lock(inode);\n\t/* We're holding i_mutex so we can access i_size directly */\n\n\tif (offset < 0 || offset >= inode->i_size)\n\t\toffset = -ENXIO;\n\telse {\n\t\tstart = offset >> PAGE_SHIFT;\n\t\tend = (inode->i_size + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\t\tnew_offset = shmem_seek_hole_data(mapping, start, end, whence);\n\t\tnew_offset <<= PAGE_SHIFT;\n\t\tif (new_offset > offset) {\n\t\t\tif (new_offset < inode->i_size)\n\t\t\t\toffset = new_offset;\n\t\t\telse if (whence == SEEK_DATA)\n\t\t\t\toffset = -ENXIO;\n\t\t\telse\n\t\t\t\toffset = inode->i_size;\n\t\t}\n\t}\n\n\tif (offset >= 0)\n\t\toffset = vfs_setpos(file, offset, MAX_LFS_FILESIZE);\n\tinode_unlock(inode);\n\treturn offset;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode_unlock",
          "args": [
            "inode"
          ],
          "line": 2587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfs_setpos",
          "args": [
            "file",
            "offset",
            "MAX_LFS_FILESIZE"
          ],
          "line": 2586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_seek_hole_data",
          "args": [
            "mapping",
            "start",
            "end",
            "whence"
          ],
          "line": 2573
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_seek_hole_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2508-2553",
          "snippet": "static pgoff_t shmem_seek_hole_data(struct address_space *mapping,\n\t\t\t\t    pgoff_t index, pgoff_t end, int whence)\n{\n\tstruct page *page;\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tbool done = false;\n\tint i;\n\n\tpagevec_init(&pvec);\n\tpvec.nr = 1;\t\t/* start small: we may be there already */\n\twhile (!done) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\t\tpvec.nr, pvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\tif (whence == SEEK_DATA)\n\t\t\t\tindex = end;\n\t\t\tbreak;\n\t\t}\n\t\tfor (i = 0; i < pvec.nr; i++, index++) {\n\t\t\tif (index < indices[i]) {\n\t\t\t\tif (whence == SEEK_HOLE) {\n\t\t\t\t\tdone = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tindex = indices[i];\n\t\t\t}\n\t\t\tpage = pvec.pages[i];\n\t\t\tif (page && !xa_is_value(page)) {\n\t\t\t\tif (!PageUptodate(page))\n\t\t\t\t\tpage = NULL;\n\t\t\t}\n\t\t\tif (index >= end ||\n\t\t\t    (page && whence == SEEK_DATA) ||\n\t\t\t    (!page && whence == SEEK_HOLE)) {\n\t\t\t\tdone = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tpvec.nr = PAGEVEC_SIZE;\n\t\tcond_resched();\n\t}\n\treturn index;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic pgoff_t shmem_seek_hole_data(struct address_space *mapping,\n\t\t\t\t    pgoff_t index, pgoff_t end, int whence)\n{\n\tstruct page *page;\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tbool done = false;\n\tint i;\n\n\tpagevec_init(&pvec);\n\tpvec.nr = 1;\t\t/* start small: we may be there already */\n\twhile (!done) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\t\tpvec.nr, pvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\tif (whence == SEEK_DATA)\n\t\t\t\tindex = end;\n\t\t\tbreak;\n\t\t}\n\t\tfor (i = 0; i < pvec.nr; i++, index++) {\n\t\t\tif (index < indices[i]) {\n\t\t\t\tif (whence == SEEK_HOLE) {\n\t\t\t\t\tdone = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tindex = indices[i];\n\t\t\t}\n\t\t\tpage = pvec.pages[i];\n\t\t\tif (page && !xa_is_value(page)) {\n\t\t\t\tif (!PageUptodate(page))\n\t\t\t\t\tpage = NULL;\n\t\t\t}\n\t\t\tif (index >= end ||\n\t\t\t    (page && whence == SEEK_DATA) ||\n\t\t\t    (!page && whence == SEEK_HOLE)) {\n\t\t\t\tdone = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tpvec.nr = PAGEVEC_SIZE;\n\t\tcond_resched();\n\t}\n\treturn index;\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_lock",
          "args": [
            "inode"
          ],
          "line": 2565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generic_file_llseek_size",
          "args": [
            "file",
            "offset",
            "whence",
            "MAX_LFS_FILESIZE",
            "i_size_read(inode)"
          ],
          "line": 2563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 2564
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic loff_t shmem_file_llseek(struct file *file, loff_t offset, int whence)\n{\n\tstruct address_space *mapping = file->f_mapping;\n\tstruct inode *inode = mapping->host;\n\tpgoff_t start, end;\n\tloff_t new_offset;\n\n\tif (whence != SEEK_DATA && whence != SEEK_HOLE)\n\t\treturn generic_file_llseek_size(file, offset, whence,\n\t\t\t\t\tMAX_LFS_FILESIZE, i_size_read(inode));\n\tinode_lock(inode);\n\t/* We're holding i_mutex so we can access i_size directly */\n\n\tif (offset < 0 || offset >= inode->i_size)\n\t\toffset = -ENXIO;\n\telse {\n\t\tstart = offset >> PAGE_SHIFT;\n\t\tend = (inode->i_size + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\t\tnew_offset = shmem_seek_hole_data(mapping, start, end, whence);\n\t\tnew_offset <<= PAGE_SHIFT;\n\t\tif (new_offset > offset) {\n\t\t\tif (new_offset < inode->i_size)\n\t\t\t\toffset = new_offset;\n\t\t\telse if (whence == SEEK_DATA)\n\t\t\t\toffset = -ENXIO;\n\t\t\telse\n\t\t\t\toffset = inode->i_size;\n\t\t}\n\t}\n\n\tif (offset >= 0)\n\t\toffset = vfs_setpos(file, offset, MAX_LFS_FILESIZE);\n\tinode_unlock(inode);\n\treturn offset;\n}"
  },
  {
    "function_name": "shmem_seek_hole_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2508-2553",
    "snippet": "static pgoff_t shmem_seek_hole_data(struct address_space *mapping,\n\t\t\t\t    pgoff_t index, pgoff_t end, int whence)\n{\n\tstruct page *page;\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tbool done = false;\n\tint i;\n\n\tpagevec_init(&pvec);\n\tpvec.nr = 1;\t\t/* start small: we may be there already */\n\twhile (!done) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\t\tpvec.nr, pvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\tif (whence == SEEK_DATA)\n\t\t\t\tindex = end;\n\t\t\tbreak;\n\t\t}\n\t\tfor (i = 0; i < pvec.nr; i++, index++) {\n\t\t\tif (index < indices[i]) {\n\t\t\t\tif (whence == SEEK_HOLE) {\n\t\t\t\t\tdone = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tindex = indices[i];\n\t\t\t}\n\t\t\tpage = pvec.pages[i];\n\t\t\tif (page && !xa_is_value(page)) {\n\t\t\t\tif (!PageUptodate(page))\n\t\t\t\t\tpage = NULL;\n\t\t\t}\n\t\t\tif (index >= end ||\n\t\t\t    (page && whence == SEEK_DATA) ||\n\t\t\t    (!page && whence == SEEK_HOLE)) {\n\t\t\t\tdone = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tpvec.nr = PAGEVEC_SIZE;\n\t\tcond_resched();\n\t}\n\treturn index;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 2550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_release",
          "args": [
            "&pvec"
          ],
          "line": 2548
        },
        "resolved": true,
        "details": {
          "function_name": "__pagevec_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "805-813",
          "snippet": "void __pagevec_release(struct pagevec *pvec)\n{\n\tif (!pvec->percpu_pvec_drained) {\n\t\tlru_add_drain();\n\t\tpvec->percpu_pvec_drained = true;\n\t}\n\trelease_pages(pvec->pages, pagevec_count(pvec));\n\tpagevec_reinit(pvec);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid __pagevec_release(struct pagevec *pvec)\n{\n\tif (!pvec->percpu_pvec_drained) {\n\t\tlru_add_drain();\n\t\tpvec->percpu_pvec_drained = true;\n\t}\n\trelease_pages(pvec->pages, pagevec_count(pvec));\n\tpagevec_reinit(pvec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pagevec_remove_exceptionals",
          "args": [
            "&pvec"
          ],
          "line": 2547
        },
        "resolved": true,
        "details": {
          "function_name": "pagevec_remove_exceptionals",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "961-971",
          "snippet": "void pagevec_remove_exceptionals(struct pagevec *pvec)\n{\n\tint i, j;\n\n\tfor (i = 0, j = 0; i < pagevec_count(pvec); i++) {\n\t\tstruct page *page = pvec->pages[i];\n\t\tif (!xa_is_value(page))\n\t\t\tpvec->pages[j++] = page;\n\t}\n\tpvec->nr = j;\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid pagevec_remove_exceptionals(struct pagevec *pvec)\n{\n\tint i, j;\n\n\tfor (i = 0, j = 0; i < pagevec_count(pvec); i++) {\n\t\tstruct page *page = pvec->pages[i];\n\t\tif (!xa_is_value(page))\n\t\t\tpvec->pages[j++] = page;\n\t}\n\tpvec->nr = j;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 2537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_is_value",
          "args": [
            "page"
          ],
          "line": 2536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_get_entries",
          "args": [
            "mapping",
            "index",
            "pvec.nr",
            "pvec.pages",
            "indices"
          ],
          "line": 2520
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/filemap.c",
          "lines": "1601-1650",
          "snippet": "unsigned find_get_entries(struct address_space *mapping,\n\t\t\t  pgoff_t start, unsigned int nr_entries,\n\t\t\t  struct page **entries, pgoff_t *indices)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned int ret = 0;\n\n\tif (!nr_entries)\n\t\treturn 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, ULONG_MAX) {\n\t\tstruct page *head;\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\t/*\n\t\t * A shadow entry of a recently evicted page, a swap\n\t\t * entry from shmem/tmpfs or a DAX entry.  Return it\n\t\t * without attempting to raise page count.\n\t\t */\n\t\tif (xa_is_value(page))\n\t\t\tgoto export;\n\n\t\thead = compound_head(page);\n\t\tif (!page_cache_get_speculative(head))\n\t\t\tgoto retry;\n\n\t\t/* The page was split under us? */\n\t\tif (compound_head(page) != head)\n\t\t\tgoto put_page;\n\n\t\t/* Has the page moved? */\n\t\tif (unlikely(page != xas_reload(&xas)))\n\t\t\tgoto put_page;\n\nexport:\n\t\tindices[ret] = xas.xa_index;\n\t\tentries[ret] = page;\n\t\tif (++ret == nr_entries)\n\t\t\tbreak;\n\t\tcontinue;\nput_page:\n\t\tput_page(head);\nretry:\n\t\txas_reset(&xas);\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}",
          "includes": [
            "#include <asm/mman.h>",
            "#include <linux/buffer_head.h> /* for try_to_free_buffers */",
            "#include <trace/events/filemap.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/rmap.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/security.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/hash.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/capability.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/fs.h>",
            "#include <linux/dax.h>",
            "#include <linux/compiler.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/mman.h>\n#include <linux/buffer_head.h> /* for try_to_free_buffers */\n#include <trace/events/filemap.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/delayacct.h>\n#include <linux/rmap.h>\n#include <linux/shmem_fs.h>\n#include <linux/cleancache.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/cpuset.h>\n#include <linux/security.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/hash.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/capability.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/dax.h>\n#include <linux/compiler.h>\n#include <linux/export.h>\n\nunsigned find_get_entries(struct address_space *mapping,\n\t\t\t  pgoff_t start, unsigned int nr_entries,\n\t\t\t  struct page **entries, pgoff_t *indices)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned int ret = 0;\n\n\tif (!nr_entries)\n\t\treturn 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, ULONG_MAX) {\n\t\tstruct page *head;\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\t/*\n\t\t * A shadow entry of a recently evicted page, a swap\n\t\t * entry from shmem/tmpfs or a DAX entry.  Return it\n\t\t * without attempting to raise page count.\n\t\t */\n\t\tif (xa_is_value(page))\n\t\t\tgoto export;\n\n\t\thead = compound_head(page);\n\t\tif (!page_cache_get_speculative(head))\n\t\t\tgoto retry;\n\n\t\t/* The page was split under us? */\n\t\tif (compound_head(page) != head)\n\t\t\tgoto put_page;\n\n\t\t/* Has the page moved? */\n\t\tif (unlikely(page != xas_reload(&xas)))\n\t\t\tgoto put_page;\n\nexport:\n\t\tindices[ret] = xas.xa_index;\n\t\tentries[ret] = page;\n\t\tif (++ret == nr_entries)\n\t\t\tbreak;\n\t\tcontinue;\nput_page:\n\t\tput_page(head);\nretry:\n\t\txas_reset(&xas);\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pagevec_init",
          "args": [
            "&pvec"
          ],
          "line": 2517
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic pgoff_t shmem_seek_hole_data(struct address_space *mapping,\n\t\t\t\t    pgoff_t index, pgoff_t end, int whence)\n{\n\tstruct page *page;\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tbool done = false;\n\tint i;\n\n\tpagevec_init(&pvec);\n\tpvec.nr = 1;\t\t/* start small: we may be there already */\n\twhile (!done) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\t\tpvec.nr, pvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\tif (whence == SEEK_DATA)\n\t\t\t\tindex = end;\n\t\t\tbreak;\n\t\t}\n\t\tfor (i = 0; i < pvec.nr; i++, index++) {\n\t\t\tif (index < indices[i]) {\n\t\t\t\tif (whence == SEEK_HOLE) {\n\t\t\t\t\tdone = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tindex = indices[i];\n\t\t\t}\n\t\t\tpage = pvec.pages[i];\n\t\t\tif (page && !xa_is_value(page)) {\n\t\t\t\tif (!PageUptodate(page))\n\t\t\t\t\tpage = NULL;\n\t\t\t}\n\t\t\tif (index >= end ||\n\t\t\t    (page && whence == SEEK_DATA) ||\n\t\t\t    (!page && whence == SEEK_HOLE)) {\n\t\t\t\tdone = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tpvec.nr = PAGEVEC_SIZE;\n\t\tcond_resched();\n\t}\n\treturn index;\n}"
  },
  {
    "function_name": "shmem_file_read_iter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2395-2503",
    "snippet": "static ssize_t shmem_file_read_iter(struct kiocb *iocb, struct iov_iter *to)\n{\n\tstruct file *file = iocb->ki_filp;\n\tstruct inode *inode = file_inode(file);\n\tstruct address_space *mapping = inode->i_mapping;\n\tpgoff_t index;\n\tunsigned long offset;\n\tenum sgp_type sgp = SGP_READ;\n\tint error = 0;\n\tssize_t retval = 0;\n\tloff_t *ppos = &iocb->ki_pos;\n\n\t/*\n\t * Might this read be for a stacking filesystem?  Then when reading\n\t * holes of a sparse file, we actually need to allocate those pages,\n\t * and even mark them dirty, so it cannot exceed the max_blocks limit.\n\t */\n\tif (!iter_is_iovec(to))\n\t\tsgp = SGP_CACHE;\n\n\tindex = *ppos >> PAGE_SHIFT;\n\toffset = *ppos & ~PAGE_MASK;\n\n\tfor (;;) {\n\t\tstruct page *page = NULL;\n\t\tpgoff_t end_index;\n\t\tunsigned long nr, ret;\n\t\tloff_t i_size = i_size_read(inode);\n\n\t\tend_index = i_size >> PAGE_SHIFT;\n\t\tif (index > end_index)\n\t\t\tbreak;\n\t\tif (index == end_index) {\n\t\t\tnr = i_size & ~PAGE_MASK;\n\t\t\tif (nr <= offset)\n\t\t\t\tbreak;\n\t\t}\n\n\t\terror = shmem_getpage(inode, index, &page, sgp);\n\t\tif (error) {\n\t\t\tif (error == -EINVAL)\n\t\t\t\terror = 0;\n\t\t\tbreak;\n\t\t}\n\t\tif (page) {\n\t\t\tif (sgp == SGP_CACHE)\n\t\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t}\n\n\t\t/*\n\t\t * We must evaluate after, since reads (unlike writes)\n\t\t * are called without i_mutex protection against truncate\n\t\t */\n\t\tnr = PAGE_SIZE;\n\t\ti_size = i_size_read(inode);\n\t\tend_index = i_size >> PAGE_SHIFT;\n\t\tif (index == end_index) {\n\t\t\tnr = i_size & ~PAGE_MASK;\n\t\t\tif (nr <= offset) {\n\t\t\t\tif (page)\n\t\t\t\t\tput_page(page);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tnr -= offset;\n\n\t\tif (page) {\n\t\t\t/*\n\t\t\t * If users can be writing to this page using arbitrary\n\t\t\t * virtual addresses, take care about potential aliasing\n\t\t\t * before reading the page on the kernel side.\n\t\t\t */\n\t\t\tif (mapping_writably_mapped(mapping))\n\t\t\t\tflush_dcache_page(page);\n\t\t\t/*\n\t\t\t * Mark the page accessed if we read the beginning.\n\t\t\t */\n\t\t\tif (!offset)\n\t\t\t\tmark_page_accessed(page);\n\t\t} else {\n\t\t\tpage = ZERO_PAGE(0);\n\t\t\tget_page(page);\n\t\t}\n\n\t\t/*\n\t\t * Ok, we have the page, and it's up-to-date, so\n\t\t * now we can copy it to user space...\n\t\t */\n\t\tret = copy_page_to_iter(page, offset, nr, to);\n\t\tretval += ret;\n\t\toffset += ret;\n\t\tindex += offset >> PAGE_SHIFT;\n\t\toffset &= ~PAGE_MASK;\n\n\t\tput_page(page);\n\t\tif (!iov_iter_count(to))\n\t\t\tbreak;\n\t\tif (ret < nr) {\n\t\t\terror = -EFAULT;\n\t\t\tbreak;\n\t\t}\n\t\tcond_resched();\n\t}\n\n\t*ppos = ((loff_t) index << PAGE_SHIFT) + offset;\n\tfile_accessed(file);\n\treturn retval ? retval : error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_accessed",
          "args": [
            "file"
          ],
          "line": 2501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 2497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_count",
          "args": [
            "to"
          ],
          "line": 2491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 2490
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_page_to_iter",
          "args": [
            "page",
            "offset",
            "nr",
            "to"
          ],
          "line": 2484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_page",
          "args": [
            "page"
          ],
          "line": 2477
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_get_page_chunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "247-250",
          "snippet": "static struct pcpu_chunk *pcpu_get_page_chunk(struct page *page)\n{\n\treturn (struct pcpu_chunk *)page->index;\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic struct pcpu_chunk *pcpu_get_page_chunk(struct page *page)\n{\n\treturn (struct pcpu_chunk *)page->index;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ZERO_PAGE",
          "args": [
            "0"
          ],
          "line": 2476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mark_page_accessed",
          "args": [
            "page"
          ],
          "line": 2474
        },
        "resolved": true,
        "details": {
          "function_name": "mark_page_accessed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "376-400",
          "snippet": "void mark_page_accessed(struct page *page)\n{\n\tpage = compound_head(page);\n\tif (!PageActive(page) && !PageUnevictable(page) &&\n\t\t\tPageReferenced(page)) {\n\n\t\t/*\n\t\t * If the page is on the LRU, queue it for activation via\n\t\t * activate_page_pvecs. Otherwise, assume the page is on a\n\t\t * pagevec, mark it active and it'll be moved to the active\n\t\t * LRU on the next drain.\n\t\t */\n\t\tif (PageLRU(page))\n\t\t\tactivate_page(page);\n\t\telse\n\t\t\t__lru_cache_activate_page(page);\n\t\tClearPageReferenced(page);\n\t\tif (page_is_file_cache(page))\n\t\t\tworkingset_activation(page);\n\t} else if (!PageReferenced(page)) {\n\t\tSetPageReferenced(page);\n\t}\n\tif (page_is_idle(page))\n\t\tclear_page_idle(page);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid mark_page_accessed(struct page *page)\n{\n\tpage = compound_head(page);\n\tif (!PageActive(page) && !PageUnevictable(page) &&\n\t\t\tPageReferenced(page)) {\n\n\t\t/*\n\t\t * If the page is on the LRU, queue it for activation via\n\t\t * activate_page_pvecs. Otherwise, assume the page is on a\n\t\t * pagevec, mark it active and it'll be moved to the active\n\t\t * LRU on the next drain.\n\t\t */\n\t\tif (PageLRU(page))\n\t\t\tactivate_page(page);\n\t\telse\n\t\t\t__lru_cache_activate_page(page);\n\t\tClearPageReferenced(page);\n\t\tif (page_is_file_cache(page))\n\t\t\tworkingset_activation(page);\n\t} else if (!PageReferenced(page)) {\n\t\tSetPageReferenced(page);\n\t}\n\tif (page_is_idle(page))\n\t\tclear_page_idle(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "flush_dcache_page",
          "args": [
            "page"
          ],
          "line": 2469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapping_writably_mapped",
          "args": [
            "mapping"
          ],
          "line": 2468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 2450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 2442
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "page"
          ],
          "line": 2441
        },
        "resolved": true,
        "details": {
          "function_name": "set_page_dirty_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "2573-2581",
          "snippet": "int set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_getpage",
          "args": [
            "inode",
            "index",
            "&page",
            "sgp"
          ],
          "line": 2433
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "129-134",
          "snippet": "int shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 2422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter_is_iovec",
          "args": [
            "to"
          ],
          "line": 2412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "file"
          ],
          "line": 2398
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic ssize_t shmem_file_read_iter(struct kiocb *iocb, struct iov_iter *to)\n{\n\tstruct file *file = iocb->ki_filp;\n\tstruct inode *inode = file_inode(file);\n\tstruct address_space *mapping = inode->i_mapping;\n\tpgoff_t index;\n\tunsigned long offset;\n\tenum sgp_type sgp = SGP_READ;\n\tint error = 0;\n\tssize_t retval = 0;\n\tloff_t *ppos = &iocb->ki_pos;\n\n\t/*\n\t * Might this read be for a stacking filesystem?  Then when reading\n\t * holes of a sparse file, we actually need to allocate those pages,\n\t * and even mark them dirty, so it cannot exceed the max_blocks limit.\n\t */\n\tif (!iter_is_iovec(to))\n\t\tsgp = SGP_CACHE;\n\n\tindex = *ppos >> PAGE_SHIFT;\n\toffset = *ppos & ~PAGE_MASK;\n\n\tfor (;;) {\n\t\tstruct page *page = NULL;\n\t\tpgoff_t end_index;\n\t\tunsigned long nr, ret;\n\t\tloff_t i_size = i_size_read(inode);\n\n\t\tend_index = i_size >> PAGE_SHIFT;\n\t\tif (index > end_index)\n\t\t\tbreak;\n\t\tif (index == end_index) {\n\t\t\tnr = i_size & ~PAGE_MASK;\n\t\t\tif (nr <= offset)\n\t\t\t\tbreak;\n\t\t}\n\n\t\terror = shmem_getpage(inode, index, &page, sgp);\n\t\tif (error) {\n\t\t\tif (error == -EINVAL)\n\t\t\t\terror = 0;\n\t\t\tbreak;\n\t\t}\n\t\tif (page) {\n\t\t\tif (sgp == SGP_CACHE)\n\t\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t}\n\n\t\t/*\n\t\t * We must evaluate after, since reads (unlike writes)\n\t\t * are called without i_mutex protection against truncate\n\t\t */\n\t\tnr = PAGE_SIZE;\n\t\ti_size = i_size_read(inode);\n\t\tend_index = i_size >> PAGE_SHIFT;\n\t\tif (index == end_index) {\n\t\t\tnr = i_size & ~PAGE_MASK;\n\t\t\tif (nr <= offset) {\n\t\t\t\tif (page)\n\t\t\t\t\tput_page(page);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tnr -= offset;\n\n\t\tif (page) {\n\t\t\t/*\n\t\t\t * If users can be writing to this page using arbitrary\n\t\t\t * virtual addresses, take care about potential aliasing\n\t\t\t * before reading the page on the kernel side.\n\t\t\t */\n\t\t\tif (mapping_writably_mapped(mapping))\n\t\t\t\tflush_dcache_page(page);\n\t\t\t/*\n\t\t\t * Mark the page accessed if we read the beginning.\n\t\t\t */\n\t\t\tif (!offset)\n\t\t\t\tmark_page_accessed(page);\n\t\t} else {\n\t\t\tpage = ZERO_PAGE(0);\n\t\t\tget_page(page);\n\t\t}\n\n\t\t/*\n\t\t * Ok, we have the page, and it's up-to-date, so\n\t\t * now we can copy it to user space...\n\t\t */\n\t\tret = copy_page_to_iter(page, offset, nr, to);\n\t\tretval += ret;\n\t\toffset += ret;\n\t\tindex += offset >> PAGE_SHIFT;\n\t\toffset &= ~PAGE_MASK;\n\n\t\tput_page(page);\n\t\tif (!iov_iter_count(to))\n\t\t\tbreak;\n\t\tif (ret < nr) {\n\t\t\terror = -EFAULT;\n\t\t\tbreak;\n\t\t}\n\t\tcond_resched();\n\t}\n\n\t*ppos = ((loff_t) index << PAGE_SHIFT) + offset;\n\tfile_accessed(file);\n\treturn retval ? retval : error;\n}"
  },
  {
    "function_name": "shmem_write_end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2359-2393",
    "snippet": "static int\nshmem_write_end(struct file *file, struct address_space *mapping,\n\t\t\tloff_t pos, unsigned len, unsigned copied,\n\t\t\tstruct page *page, void *fsdata)\n{\n\tstruct inode *inode = mapping->host;\n\n\tif (pos + copied > inode->i_size)\n\t\ti_size_write(inode, pos + copied);\n\n\tif (!PageUptodate(page)) {\n\t\tstruct page *head = compound_head(page);\n\t\tif (PageTransCompound(page)) {\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < HPAGE_PMD_NR; i++) {\n\t\t\t\tif (head + i == page)\n\t\t\t\t\tcontinue;\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t}\n\t\tif (copied < PAGE_SIZE) {\n\t\t\tunsigned from = pos & (PAGE_SIZE - 1);\n\t\t\tzero_user_segments(page, 0, from,\n\t\t\t\t\tfrom + copied, PAGE_SIZE);\n\t\t}\n\t\tSetPageUptodate(head);\n\t}\n\tset_page_dirty(page);\n\tunlock_page(page);\n\tput_page(page);\n\n\treturn copied;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 2390
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 2389
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "page"
          ],
          "line": 2388
        },
        "resolved": true,
        "details": {
          "function_name": "set_page_dirty_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "2573-2581",
          "snippet": "int set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetPageUptodate",
          "args": [
            "head"
          ],
          "line": 2386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zero_user_segments",
          "args": [
            "page",
            "0",
            "from",
            "from + copied",
            "PAGE_SIZE"
          ],
          "line": 2383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_dcache_page",
          "args": [
            "head + i"
          ],
          "line": 2378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "head + i"
          ],
          "line": 2377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransCompound",
          "args": [
            "page"
          ],
          "line": 2371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compound_head",
          "args": [
            "page"
          ],
          "line": 2370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 2369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "pos + copied"
          ],
          "line": 2367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int\nshmem_write_end(struct file *file, struct address_space *mapping,\n\t\t\tloff_t pos, unsigned len, unsigned copied,\n\t\t\tstruct page *page, void *fsdata)\n{\n\tstruct inode *inode = mapping->host;\n\n\tif (pos + copied > inode->i_size)\n\t\ti_size_write(inode, pos + copied);\n\n\tif (!PageUptodate(page)) {\n\t\tstruct page *head = compound_head(page);\n\t\tif (PageTransCompound(page)) {\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < HPAGE_PMD_NR; i++) {\n\t\t\t\tif (head + i == page)\n\t\t\t\t\tcontinue;\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t}\n\t\tif (copied < PAGE_SIZE) {\n\t\t\tunsigned from = pos & (PAGE_SIZE - 1);\n\t\t\tzero_user_segments(page, 0, from,\n\t\t\t\t\tfrom + copied, PAGE_SIZE);\n\t\t}\n\t\tSetPageUptodate(head);\n\t}\n\tset_page_dirty(page);\n\tunlock_page(page);\n\tput_page(page);\n\n\treturn copied;\n}"
  },
  {
    "function_name": "shmem_write_begin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2339-2357",
    "snippet": "static int\nshmem_write_begin(struct file *file, struct address_space *mapping,\n\t\t\tloff_t pos, unsigned len, unsigned flags,\n\t\t\tstruct page **pagep, void **fsdata)\n{\n\tstruct inode *inode = mapping->host;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tpgoff_t index = pos >> PAGE_SHIFT;\n\n\t/* i_mutex is held by caller */\n\tif (unlikely(info->seals & (F_SEAL_WRITE | F_SEAL_GROW))) {\n\t\tif (info->seals & F_SEAL_WRITE)\n\t\t\treturn -EPERM;\n\t\tif ((info->seals & F_SEAL_GROW) && pos + len > inode->i_size)\n\t\t\treturn -EPERM;\n\t}\n\n\treturn shmem_getpage(inode, index, pagep, SGP_WRITE);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_getpage",
          "args": [
            "inode",
            "index",
            "pagep",
            "SGP_WRITE"
          ],
          "line": 2356
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "129-134",
          "snippet": "int shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "info->seals & (F_SEAL_WRITE | F_SEAL_GROW)"
          ],
          "line": 2349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 2345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int\nshmem_write_begin(struct file *file, struct address_space *mapping,\n\t\t\tloff_t pos, unsigned len, unsigned flags,\n\t\t\tstruct page **pagep, void **fsdata)\n{\n\tstruct inode *inode = mapping->host;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tpgoff_t index = pos >> PAGE_SHIFT;\n\n\t/* i_mutex is held by caller */\n\tif (unlikely(info->seals & (F_SEAL_WRITE | F_SEAL_GROW))) {\n\t\tif (info->seals & F_SEAL_WRITE)\n\t\t\treturn -EPERM;\n\t\tif ((info->seals & F_SEAL_GROW) && pos + len > inode->i_size)\n\t\t\treturn -EPERM;\n\t}\n\n\treturn shmem_getpage(inode, index, pagep, SGP_WRITE);\n}"
  },
  {
    "function_name": "shmem_mfill_zeropage_pte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2318-2327",
    "snippet": "int shmem_mfill_zeropage_pte(struct mm_struct *dst_mm,\n\t\t\t     pmd_t *dst_pmd,\n\t\t\t     struct vm_area_struct *dst_vma,\n\t\t\t     unsigned long dst_addr)\n{\n\tstruct page *page = NULL;\n\n\treturn shmem_mfill_atomic_pte(dst_mm, dst_pmd, dst_vma,\n\t\t\t\t      dst_addr, 0, true, &page);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_mfill_atomic_pte",
          "args": [
            "dst_mm",
            "dst_pmd",
            "dst_vma",
            "dst_addr",
            "0",
            "true",
            "&page"
          ],
          "line": 2325
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_mfill_atomic_pte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2200-2305",
          "snippet": "static int shmem_mfill_atomic_pte(struct mm_struct *dst_mm,\n\t\t\t\t  pmd_t *dst_pmd,\n\t\t\t\t  struct vm_area_struct *dst_vma,\n\t\t\t\t  unsigned long dst_addr,\n\t\t\t\t  unsigned long src_addr,\n\t\t\t\t  bool zeropage,\n\t\t\t\t  struct page **pagep)\n{\n\tstruct inode *inode = file_inode(dst_vma->vm_file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct address_space *mapping = inode->i_mapping;\n\tgfp_t gfp = mapping_gfp_mask(mapping);\n\tpgoff_t pgoff = linear_page_index(dst_vma, dst_addr);\n\tstruct mem_cgroup *memcg;\n\tspinlock_t *ptl;\n\tvoid *page_kaddr;\n\tstruct page *page;\n\tpte_t _dst_pte, *dst_pte;\n\tint ret;\n\n\tret = -ENOMEM;\n\tif (!shmem_inode_acct_block(inode, 1))\n\t\tgoto out;\n\n\tif (!*pagep) {\n\t\tpage = shmem_alloc_page(gfp, info, pgoff);\n\t\tif (!page)\n\t\t\tgoto out_unacct_blocks;\n\n\t\tif (!zeropage) {\t/* mcopy_atomic */\n\t\t\tpage_kaddr = kmap_atomic(page);\n\t\t\tret = copy_from_user(page_kaddr,\n\t\t\t\t\t     (const void __user *)src_addr,\n\t\t\t\t\t     PAGE_SIZE);\n\t\t\tkunmap_atomic(page_kaddr);\n\n\t\t\t/* fallback to copy_from_user outside mmap_sem */\n\t\t\tif (unlikely(ret)) {\n\t\t\t\t*pagep = page;\n\t\t\t\tshmem_inode_unacct_blocks(inode, 1);\n\t\t\t\t/* don't free the page */\n\t\t\t\treturn -ENOENT;\n\t\t\t}\n\t\t} else {\t\t/* mfill_zeropage_atomic */\n\t\t\tclear_highpage(page);\n\t\t}\n\t} else {\n\t\tpage = *pagep;\n\t\t*pagep = NULL;\n\t}\n\n\tVM_BUG_ON(PageLocked(page) || PageSwapBacked(page));\n\t__SetPageLocked(page);\n\t__SetPageSwapBacked(page);\n\t__SetPageUptodate(page);\n\n\tret = mem_cgroup_try_charge_delay(page, dst_mm, gfp, &memcg, false);\n\tif (ret)\n\t\tgoto out_release;\n\n\tret = shmem_add_to_page_cache(page, mapping, pgoff, NULL,\n\t\t\t\t\t\tgfp & GFP_RECLAIM_MASK);\n\tif (ret)\n\t\tgoto out_release_uncharge;\n\n\tmem_cgroup_commit_charge(page, memcg, false, false);\n\n\t_dst_pte = mk_pte(page, dst_vma->vm_page_prot);\n\tif (dst_vma->vm_flags & VM_WRITE)\n\t\t_dst_pte = pte_mkwrite(pte_mkdirty(_dst_pte));\n\n\tret = -EEXIST;\n\tdst_pte = pte_offset_map_lock(dst_mm, dst_pmd, dst_addr, &ptl);\n\tif (!pte_none(*dst_pte))\n\t\tgoto out_release_uncharge_unlock;\n\n\tlru_cache_add_anon(page);\n\n\tspin_lock(&info->lock);\n\tinfo->alloced++;\n\tinode->i_blocks += BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock(&info->lock);\n\n\tinc_mm_counter(dst_mm, mm_counter_file(page));\n\tpage_add_file_rmap(page, false);\n\tset_pte_at(dst_mm, dst_addr, dst_pte, _dst_pte);\n\n\t/* No need to invalidate - it was non-present before */\n\tupdate_mmu_cache(dst_vma, dst_addr, dst_pte);\n\tunlock_page(page);\n\tpte_unmap_unlock(dst_pte, ptl);\n\tret = 0;\nout:\n\treturn ret;\nout_release_uncharge_unlock:\n\tpte_unmap_unlock(dst_pte, ptl);\nout_release_uncharge:\n\tmem_cgroup_cancel_charge(page, memcg, false);\nout_release:\n\tunlock_page(page);\n\tput_page(page);\nout_unacct_blocks:\n\tshmem_inode_unacct_blocks(inode, 1);\n\tgoto out;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic int shmem_mfill_atomic_pte(struct mm_struct *dst_mm,\n\t\t\t\t  pmd_t *dst_pmd,\n\t\t\t\t  struct vm_area_struct *dst_vma,\n\t\t\t\t  unsigned long dst_addr,\n\t\t\t\t  unsigned long src_addr,\n\t\t\t\t  bool zeropage,\n\t\t\t\t  struct page **pagep)\n{\n\tstruct inode *inode = file_inode(dst_vma->vm_file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct address_space *mapping = inode->i_mapping;\n\tgfp_t gfp = mapping_gfp_mask(mapping);\n\tpgoff_t pgoff = linear_page_index(dst_vma, dst_addr);\n\tstruct mem_cgroup *memcg;\n\tspinlock_t *ptl;\n\tvoid *page_kaddr;\n\tstruct page *page;\n\tpte_t _dst_pte, *dst_pte;\n\tint ret;\n\n\tret = -ENOMEM;\n\tif (!shmem_inode_acct_block(inode, 1))\n\t\tgoto out;\n\n\tif (!*pagep) {\n\t\tpage = shmem_alloc_page(gfp, info, pgoff);\n\t\tif (!page)\n\t\t\tgoto out_unacct_blocks;\n\n\t\tif (!zeropage) {\t/* mcopy_atomic */\n\t\t\tpage_kaddr = kmap_atomic(page);\n\t\t\tret = copy_from_user(page_kaddr,\n\t\t\t\t\t     (const void __user *)src_addr,\n\t\t\t\t\t     PAGE_SIZE);\n\t\t\tkunmap_atomic(page_kaddr);\n\n\t\t\t/* fallback to copy_from_user outside mmap_sem */\n\t\t\tif (unlikely(ret)) {\n\t\t\t\t*pagep = page;\n\t\t\t\tshmem_inode_unacct_blocks(inode, 1);\n\t\t\t\t/* don't free the page */\n\t\t\t\treturn -ENOENT;\n\t\t\t}\n\t\t} else {\t\t/* mfill_zeropage_atomic */\n\t\t\tclear_highpage(page);\n\t\t}\n\t} else {\n\t\tpage = *pagep;\n\t\t*pagep = NULL;\n\t}\n\n\tVM_BUG_ON(PageLocked(page) || PageSwapBacked(page));\n\t__SetPageLocked(page);\n\t__SetPageSwapBacked(page);\n\t__SetPageUptodate(page);\n\n\tret = mem_cgroup_try_charge_delay(page, dst_mm, gfp, &memcg, false);\n\tif (ret)\n\t\tgoto out_release;\n\n\tret = shmem_add_to_page_cache(page, mapping, pgoff, NULL,\n\t\t\t\t\t\tgfp & GFP_RECLAIM_MASK);\n\tif (ret)\n\t\tgoto out_release_uncharge;\n\n\tmem_cgroup_commit_charge(page, memcg, false, false);\n\n\t_dst_pte = mk_pte(page, dst_vma->vm_page_prot);\n\tif (dst_vma->vm_flags & VM_WRITE)\n\t\t_dst_pte = pte_mkwrite(pte_mkdirty(_dst_pte));\n\n\tret = -EEXIST;\n\tdst_pte = pte_offset_map_lock(dst_mm, dst_pmd, dst_addr, &ptl);\n\tif (!pte_none(*dst_pte))\n\t\tgoto out_release_uncharge_unlock;\n\n\tlru_cache_add_anon(page);\n\n\tspin_lock(&info->lock);\n\tinfo->alloced++;\n\tinode->i_blocks += BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock(&info->lock);\n\n\tinc_mm_counter(dst_mm, mm_counter_file(page));\n\tpage_add_file_rmap(page, false);\n\tset_pte_at(dst_mm, dst_addr, dst_pte, _dst_pte);\n\n\t/* No need to invalidate - it was non-present before */\n\tupdate_mmu_cache(dst_vma, dst_addr, dst_pte);\n\tunlock_page(page);\n\tpte_unmap_unlock(dst_pte, ptl);\n\tret = 0;\nout:\n\treturn ret;\nout_release_uncharge_unlock:\n\tpte_unmap_unlock(dst_pte, ptl);\nout_release_uncharge:\n\tmem_cgroup_cancel_charge(page, memcg, false);\nout_release:\n\tunlock_page(page);\n\tput_page(page);\nout_unacct_blocks:\n\tshmem_inode_unacct_blocks(inode, 1);\n\tgoto out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_mfill_zeropage_pte(struct mm_struct *dst_mm,\n\t\t\t     pmd_t *dst_pmd,\n\t\t\t     struct vm_area_struct *dst_vma,\n\t\t\t     unsigned long dst_addr)\n{\n\tstruct page *page = NULL;\n\n\treturn shmem_mfill_atomic_pte(dst_mm, dst_pmd, dst_vma,\n\t\t\t\t      dst_addr, 0, true, &page);\n}"
  },
  {
    "function_name": "shmem_mcopy_atomic_pte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2307-2316",
    "snippet": "int shmem_mcopy_atomic_pte(struct mm_struct *dst_mm,\n\t\t\t   pmd_t *dst_pmd,\n\t\t\t   struct vm_area_struct *dst_vma,\n\t\t\t   unsigned long dst_addr,\n\t\t\t   unsigned long src_addr,\n\t\t\t   struct page **pagep)\n{\n\treturn shmem_mfill_atomic_pte(dst_mm, dst_pmd, dst_vma,\n\t\t\t\t      dst_addr, src_addr, false, pagep);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_mfill_atomic_pte",
          "args": [
            "dst_mm",
            "dst_pmd",
            "dst_vma",
            "dst_addr",
            "src_addr",
            "false",
            "pagep"
          ],
          "line": 2314
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_mfill_atomic_pte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "2200-2305",
          "snippet": "static int shmem_mfill_atomic_pte(struct mm_struct *dst_mm,\n\t\t\t\t  pmd_t *dst_pmd,\n\t\t\t\t  struct vm_area_struct *dst_vma,\n\t\t\t\t  unsigned long dst_addr,\n\t\t\t\t  unsigned long src_addr,\n\t\t\t\t  bool zeropage,\n\t\t\t\t  struct page **pagep)\n{\n\tstruct inode *inode = file_inode(dst_vma->vm_file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct address_space *mapping = inode->i_mapping;\n\tgfp_t gfp = mapping_gfp_mask(mapping);\n\tpgoff_t pgoff = linear_page_index(dst_vma, dst_addr);\n\tstruct mem_cgroup *memcg;\n\tspinlock_t *ptl;\n\tvoid *page_kaddr;\n\tstruct page *page;\n\tpte_t _dst_pte, *dst_pte;\n\tint ret;\n\n\tret = -ENOMEM;\n\tif (!shmem_inode_acct_block(inode, 1))\n\t\tgoto out;\n\n\tif (!*pagep) {\n\t\tpage = shmem_alloc_page(gfp, info, pgoff);\n\t\tif (!page)\n\t\t\tgoto out_unacct_blocks;\n\n\t\tif (!zeropage) {\t/* mcopy_atomic */\n\t\t\tpage_kaddr = kmap_atomic(page);\n\t\t\tret = copy_from_user(page_kaddr,\n\t\t\t\t\t     (const void __user *)src_addr,\n\t\t\t\t\t     PAGE_SIZE);\n\t\t\tkunmap_atomic(page_kaddr);\n\n\t\t\t/* fallback to copy_from_user outside mmap_sem */\n\t\t\tif (unlikely(ret)) {\n\t\t\t\t*pagep = page;\n\t\t\t\tshmem_inode_unacct_blocks(inode, 1);\n\t\t\t\t/* don't free the page */\n\t\t\t\treturn -ENOENT;\n\t\t\t}\n\t\t} else {\t\t/* mfill_zeropage_atomic */\n\t\t\tclear_highpage(page);\n\t\t}\n\t} else {\n\t\tpage = *pagep;\n\t\t*pagep = NULL;\n\t}\n\n\tVM_BUG_ON(PageLocked(page) || PageSwapBacked(page));\n\t__SetPageLocked(page);\n\t__SetPageSwapBacked(page);\n\t__SetPageUptodate(page);\n\n\tret = mem_cgroup_try_charge_delay(page, dst_mm, gfp, &memcg, false);\n\tif (ret)\n\t\tgoto out_release;\n\n\tret = shmem_add_to_page_cache(page, mapping, pgoff, NULL,\n\t\t\t\t\t\tgfp & GFP_RECLAIM_MASK);\n\tif (ret)\n\t\tgoto out_release_uncharge;\n\n\tmem_cgroup_commit_charge(page, memcg, false, false);\n\n\t_dst_pte = mk_pte(page, dst_vma->vm_page_prot);\n\tif (dst_vma->vm_flags & VM_WRITE)\n\t\t_dst_pte = pte_mkwrite(pte_mkdirty(_dst_pte));\n\n\tret = -EEXIST;\n\tdst_pte = pte_offset_map_lock(dst_mm, dst_pmd, dst_addr, &ptl);\n\tif (!pte_none(*dst_pte))\n\t\tgoto out_release_uncharge_unlock;\n\n\tlru_cache_add_anon(page);\n\n\tspin_lock(&info->lock);\n\tinfo->alloced++;\n\tinode->i_blocks += BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock(&info->lock);\n\n\tinc_mm_counter(dst_mm, mm_counter_file(page));\n\tpage_add_file_rmap(page, false);\n\tset_pte_at(dst_mm, dst_addr, dst_pte, _dst_pte);\n\n\t/* No need to invalidate - it was non-present before */\n\tupdate_mmu_cache(dst_vma, dst_addr, dst_pte);\n\tunlock_page(page);\n\tpte_unmap_unlock(dst_pte, ptl);\n\tret = 0;\nout:\n\treturn ret;\nout_release_uncharge_unlock:\n\tpte_unmap_unlock(dst_pte, ptl);\nout_release_uncharge:\n\tmem_cgroup_cancel_charge(page, memcg, false);\nout_release:\n\tunlock_page(page);\n\tput_page(page);\nout_unacct_blocks:\n\tshmem_inode_unacct_blocks(inode, 1);\n\tgoto out;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic int shmem_mfill_atomic_pte(struct mm_struct *dst_mm,\n\t\t\t\t  pmd_t *dst_pmd,\n\t\t\t\t  struct vm_area_struct *dst_vma,\n\t\t\t\t  unsigned long dst_addr,\n\t\t\t\t  unsigned long src_addr,\n\t\t\t\t  bool zeropage,\n\t\t\t\t  struct page **pagep)\n{\n\tstruct inode *inode = file_inode(dst_vma->vm_file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct address_space *mapping = inode->i_mapping;\n\tgfp_t gfp = mapping_gfp_mask(mapping);\n\tpgoff_t pgoff = linear_page_index(dst_vma, dst_addr);\n\tstruct mem_cgroup *memcg;\n\tspinlock_t *ptl;\n\tvoid *page_kaddr;\n\tstruct page *page;\n\tpte_t _dst_pte, *dst_pte;\n\tint ret;\n\n\tret = -ENOMEM;\n\tif (!shmem_inode_acct_block(inode, 1))\n\t\tgoto out;\n\n\tif (!*pagep) {\n\t\tpage = shmem_alloc_page(gfp, info, pgoff);\n\t\tif (!page)\n\t\t\tgoto out_unacct_blocks;\n\n\t\tif (!zeropage) {\t/* mcopy_atomic */\n\t\t\tpage_kaddr = kmap_atomic(page);\n\t\t\tret = copy_from_user(page_kaddr,\n\t\t\t\t\t     (const void __user *)src_addr,\n\t\t\t\t\t     PAGE_SIZE);\n\t\t\tkunmap_atomic(page_kaddr);\n\n\t\t\t/* fallback to copy_from_user outside mmap_sem */\n\t\t\tif (unlikely(ret)) {\n\t\t\t\t*pagep = page;\n\t\t\t\tshmem_inode_unacct_blocks(inode, 1);\n\t\t\t\t/* don't free the page */\n\t\t\t\treturn -ENOENT;\n\t\t\t}\n\t\t} else {\t\t/* mfill_zeropage_atomic */\n\t\t\tclear_highpage(page);\n\t\t}\n\t} else {\n\t\tpage = *pagep;\n\t\t*pagep = NULL;\n\t}\n\n\tVM_BUG_ON(PageLocked(page) || PageSwapBacked(page));\n\t__SetPageLocked(page);\n\t__SetPageSwapBacked(page);\n\t__SetPageUptodate(page);\n\n\tret = mem_cgroup_try_charge_delay(page, dst_mm, gfp, &memcg, false);\n\tif (ret)\n\t\tgoto out_release;\n\n\tret = shmem_add_to_page_cache(page, mapping, pgoff, NULL,\n\t\t\t\t\t\tgfp & GFP_RECLAIM_MASK);\n\tif (ret)\n\t\tgoto out_release_uncharge;\n\n\tmem_cgroup_commit_charge(page, memcg, false, false);\n\n\t_dst_pte = mk_pte(page, dst_vma->vm_page_prot);\n\tif (dst_vma->vm_flags & VM_WRITE)\n\t\t_dst_pte = pte_mkwrite(pte_mkdirty(_dst_pte));\n\n\tret = -EEXIST;\n\tdst_pte = pte_offset_map_lock(dst_mm, dst_pmd, dst_addr, &ptl);\n\tif (!pte_none(*dst_pte))\n\t\tgoto out_release_uncharge_unlock;\n\n\tlru_cache_add_anon(page);\n\n\tspin_lock(&info->lock);\n\tinfo->alloced++;\n\tinode->i_blocks += BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock(&info->lock);\n\n\tinc_mm_counter(dst_mm, mm_counter_file(page));\n\tpage_add_file_rmap(page, false);\n\tset_pte_at(dst_mm, dst_addr, dst_pte, _dst_pte);\n\n\t/* No need to invalidate - it was non-present before */\n\tupdate_mmu_cache(dst_vma, dst_addr, dst_pte);\n\tunlock_page(page);\n\tpte_unmap_unlock(dst_pte, ptl);\n\tret = 0;\nout:\n\treturn ret;\nout_release_uncharge_unlock:\n\tpte_unmap_unlock(dst_pte, ptl);\nout_release_uncharge:\n\tmem_cgroup_cancel_charge(page, memcg, false);\nout_release:\n\tunlock_page(page);\n\tput_page(page);\nout_unacct_blocks:\n\tshmem_inode_unacct_blocks(inode, 1);\n\tgoto out;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_mcopy_atomic_pte(struct mm_struct *dst_mm,\n\t\t\t   pmd_t *dst_pmd,\n\t\t\t   struct vm_area_struct *dst_vma,\n\t\t\t   unsigned long dst_addr,\n\t\t\t   unsigned long src_addr,\n\t\t\t   struct page **pagep)\n{\n\treturn shmem_mfill_atomic_pte(dst_mm, dst_pmd, dst_vma,\n\t\t\t\t      dst_addr, src_addr, false, pagep);\n}"
  },
  {
    "function_name": "shmem_mfill_atomic_pte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2200-2305",
    "snippet": "static int shmem_mfill_atomic_pte(struct mm_struct *dst_mm,\n\t\t\t\t  pmd_t *dst_pmd,\n\t\t\t\t  struct vm_area_struct *dst_vma,\n\t\t\t\t  unsigned long dst_addr,\n\t\t\t\t  unsigned long src_addr,\n\t\t\t\t  bool zeropage,\n\t\t\t\t  struct page **pagep)\n{\n\tstruct inode *inode = file_inode(dst_vma->vm_file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct address_space *mapping = inode->i_mapping;\n\tgfp_t gfp = mapping_gfp_mask(mapping);\n\tpgoff_t pgoff = linear_page_index(dst_vma, dst_addr);\n\tstruct mem_cgroup *memcg;\n\tspinlock_t *ptl;\n\tvoid *page_kaddr;\n\tstruct page *page;\n\tpte_t _dst_pte, *dst_pte;\n\tint ret;\n\n\tret = -ENOMEM;\n\tif (!shmem_inode_acct_block(inode, 1))\n\t\tgoto out;\n\n\tif (!*pagep) {\n\t\tpage = shmem_alloc_page(gfp, info, pgoff);\n\t\tif (!page)\n\t\t\tgoto out_unacct_blocks;\n\n\t\tif (!zeropage) {\t/* mcopy_atomic */\n\t\t\tpage_kaddr = kmap_atomic(page);\n\t\t\tret = copy_from_user(page_kaddr,\n\t\t\t\t\t     (const void __user *)src_addr,\n\t\t\t\t\t     PAGE_SIZE);\n\t\t\tkunmap_atomic(page_kaddr);\n\n\t\t\t/* fallback to copy_from_user outside mmap_sem */\n\t\t\tif (unlikely(ret)) {\n\t\t\t\t*pagep = page;\n\t\t\t\tshmem_inode_unacct_blocks(inode, 1);\n\t\t\t\t/* don't free the page */\n\t\t\t\treturn -ENOENT;\n\t\t\t}\n\t\t} else {\t\t/* mfill_zeropage_atomic */\n\t\t\tclear_highpage(page);\n\t\t}\n\t} else {\n\t\tpage = *pagep;\n\t\t*pagep = NULL;\n\t}\n\n\tVM_BUG_ON(PageLocked(page) || PageSwapBacked(page));\n\t__SetPageLocked(page);\n\t__SetPageSwapBacked(page);\n\t__SetPageUptodate(page);\n\n\tret = mem_cgroup_try_charge_delay(page, dst_mm, gfp, &memcg, false);\n\tif (ret)\n\t\tgoto out_release;\n\n\tret = shmem_add_to_page_cache(page, mapping, pgoff, NULL,\n\t\t\t\t\t\tgfp & GFP_RECLAIM_MASK);\n\tif (ret)\n\t\tgoto out_release_uncharge;\n\n\tmem_cgroup_commit_charge(page, memcg, false, false);\n\n\t_dst_pte = mk_pte(page, dst_vma->vm_page_prot);\n\tif (dst_vma->vm_flags & VM_WRITE)\n\t\t_dst_pte = pte_mkwrite(pte_mkdirty(_dst_pte));\n\n\tret = -EEXIST;\n\tdst_pte = pte_offset_map_lock(dst_mm, dst_pmd, dst_addr, &ptl);\n\tif (!pte_none(*dst_pte))\n\t\tgoto out_release_uncharge_unlock;\n\n\tlru_cache_add_anon(page);\n\n\tspin_lock(&info->lock);\n\tinfo->alloced++;\n\tinode->i_blocks += BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock(&info->lock);\n\n\tinc_mm_counter(dst_mm, mm_counter_file(page));\n\tpage_add_file_rmap(page, false);\n\tset_pte_at(dst_mm, dst_addr, dst_pte, _dst_pte);\n\n\t/* No need to invalidate - it was non-present before */\n\tupdate_mmu_cache(dst_vma, dst_addr, dst_pte);\n\tunlock_page(page);\n\tpte_unmap_unlock(dst_pte, ptl);\n\tret = 0;\nout:\n\treturn ret;\nout_release_uncharge_unlock:\n\tpte_unmap_unlock(dst_pte, ptl);\nout_release_uncharge:\n\tmem_cgroup_cancel_charge(page, memcg, false);\nout_release:\n\tunlock_page(page);\n\tput_page(page);\nout_unacct_blocks:\n\tshmem_inode_unacct_blocks(inode, 1);\n\tgoto out;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_inode_unacct_blocks",
          "args": [
            "inode",
            "1"
          ],
          "line": 2303
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_inode_unacct_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "215-223",
          "snippet": "static inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 2301
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 2300
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mem_cgroup_cancel_charge",
          "args": [
            "page",
            "memcg",
            "false"
          ],
          "line": 2298
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_cancel_charge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5972-5988",
          "snippet": "void mem_cgroup_cancel_charge(struct page *page, struct mem_cgroup *memcg,\n\t\tbool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcancel_charge(memcg, nr_pages);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nvoid mem_cgroup_cancel_charge(struct page *page, struct mem_cgroup *memcg,\n\t\tbool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcancel_charge(memcg, nr_pages);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pte_unmap_unlock",
          "args": [
            "dst_pte",
            "ptl"
          ],
          "line": 2296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_unmap_unlock",
          "args": [
            "dst_pte",
            "ptl"
          ],
          "line": 2291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "update_mmu_cache",
          "args": [
            "dst_vma",
            "dst_addr",
            "dst_pte"
          ],
          "line": 2289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_pte_at",
          "args": [
            "dst_mm",
            "dst_addr",
            "dst_pte",
            "_dst_pte"
          ],
          "line": 2286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_add_file_rmap",
          "args": [
            "page",
            "false"
          ],
          "line": 2285
        },
        "resolved": true,
        "details": {
          "function_name": "page_add_file_rmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/rmap.c",
          "lines": "1179-1208",
          "snippet": "void page_add_file_rmap(struct page *page, bool compound)\n{\n\tint i, nr = 1;\n\n\tVM_BUG_ON_PAGE(compound && !PageTransHuge(page), page);\n\tlock_page_memcg(page);\n\tif (compound && PageTransHuge(page)) {\n\t\tfor (i = 0, nr = 0; i < HPAGE_PMD_NR; i++) {\n\t\t\tif (atomic_inc_and_test(&page[i]._mapcount))\n\t\t\t\tnr++;\n\t\t}\n\t\tif (!atomic_inc_and_test(compound_mapcount_ptr(page)))\n\t\t\tgoto out;\n\t\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\t\t__inc_node_page_state(page, NR_SHMEM_PMDMAPPED);\n\t} else {\n\t\tif (PageTransCompound(page) && page_mapping(page)) {\n\t\t\tVM_WARN_ON_ONCE(!PageLocked(page));\n\n\t\t\tSetPageDoubleMap(compound_head(page));\n\t\t\tif (PageMlocked(page))\n\t\t\t\tclear_page_mlock(compound_head(page));\n\t\t}\n\t\tif (!atomic_inc_and_test(&page->_mapcount))\n\t\t\tgoto out;\n\t}\n\t__mod_lruvec_page_state(page, NR_FILE_MAPPED, nr);\nout:\n\tunlock_page_memcg(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/tlb.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/memremap.h>",
            "#include <linux/page_idle.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/tlb.h>\n#include <asm/tlbflush.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/memremap.h>\n#include <linux/page_idle.h>\n#include <linux/backing-dev.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mmu_notifier.h>\n#include <linux/memcontrol.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/pagemap.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nvoid page_add_file_rmap(struct page *page, bool compound)\n{\n\tint i, nr = 1;\n\n\tVM_BUG_ON_PAGE(compound && !PageTransHuge(page), page);\n\tlock_page_memcg(page);\n\tif (compound && PageTransHuge(page)) {\n\t\tfor (i = 0, nr = 0; i < HPAGE_PMD_NR; i++) {\n\t\t\tif (atomic_inc_and_test(&page[i]._mapcount))\n\t\t\t\tnr++;\n\t\t}\n\t\tif (!atomic_inc_and_test(compound_mapcount_ptr(page)))\n\t\t\tgoto out;\n\t\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\t\t__inc_node_page_state(page, NR_SHMEM_PMDMAPPED);\n\t} else {\n\t\tif (PageTransCompound(page) && page_mapping(page)) {\n\t\t\tVM_WARN_ON_ONCE(!PageLocked(page));\n\n\t\t\tSetPageDoubleMap(compound_head(page));\n\t\t\tif (PageMlocked(page))\n\t\t\t\tclear_page_mlock(compound_head(page));\n\t\t}\n\t\tif (!atomic_inc_and_test(&page->_mapcount))\n\t\t\tgoto out;\n\t}\n\t__mod_lruvec_page_state(page, NR_FILE_MAPPED, nr);\nout:\n\tunlock_page_memcg(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "inc_mm_counter",
          "args": [
            "dst_mm",
            "mm_counter_file(page)"
          ],
          "line": 2284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mm_counter_file",
          "args": [
            "page"
          ],
          "line": 2284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&info->lock"
          ],
          "line": 2282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_recalc_inode",
          "args": [
            "inode"
          ],
          "line": 2281
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_recalc_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "279-290",
          "snippet": "static void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&info->lock"
          ],
          "line": 2278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lru_cache_add_anon",
          "args": [
            "page"
          ],
          "line": 2276
        },
        "resolved": true,
        "details": {
          "function_name": "lru_cache_add_anon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "417-422",
          "snippet": "void lru_cache_add_anon(struct page *page)\n{\n\tif (PageActive(page))\n\t\tClearPageActive(page);\n\t__lru_cache_add(page);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid lru_cache_add_anon(struct page *page)\n{\n\tif (PageActive(page))\n\t\tClearPageActive(page);\n\t__lru_cache_add(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pte_none",
          "args": [
            "*dst_pte"
          ],
          "line": 2273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_offset_map_lock",
          "args": [
            "dst_mm",
            "dst_pmd",
            "dst_addr",
            "&ptl"
          ],
          "line": 2272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_mkwrite",
          "args": [
            "pte_mkdirty(_dst_pte)"
          ],
          "line": 2269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_mkdirty",
          "args": [
            "_dst_pte"
          ],
          "line": 2269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mk_pte",
          "args": [
            "page",
            "dst_vma->vm_page_prot"
          ],
          "line": 2267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cgroup_commit_charge",
          "args": [
            "page",
            "memcg",
            "false",
            "false"
          ],
          "line": 2265
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_commit_charge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5928-5962",
          "snippet": "void mem_cgroup_commit_charge(struct page *page, struct mem_cgroup *memcg,\n\t\t\t      bool lrucare, bool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tVM_BUG_ON_PAGE(!page->mapping, page);\n\tVM_BUG_ON_PAGE(PageLRU(page) && !lrucare, page);\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcommit_charge(page, memcg, lrucare);\n\n\tlocal_irq_disable();\n\tmem_cgroup_charge_statistics(memcg, page, compound, nr_pages);\n\tmemcg_check_events(memcg, page);\n\tlocal_irq_enable();\n\n\tif (do_memsw_account() && PageSwapCache(page)) {\n\t\tswp_entry_t entry = { .val = page_private(page) };\n\t\t/*\n\t\t * The swap entry might not get freed for a long time,\n\t\t * let's not wait for it.  The page already received a\n\t\t * memory+swap charge, drop the swap entry duplicate.\n\t\t */\n\t\tmem_cgroup_uncharge_swap(entry, nr_pages);\n\t}\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nvoid mem_cgroup_commit_charge(struct page *page, struct mem_cgroup *memcg,\n\t\t\t      bool lrucare, bool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tVM_BUG_ON_PAGE(!page->mapping, page);\n\tVM_BUG_ON_PAGE(PageLRU(page) && !lrucare, page);\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcommit_charge(page, memcg, lrucare);\n\n\tlocal_irq_disable();\n\tmem_cgroup_charge_statistics(memcg, page, compound, nr_pages);\n\tmemcg_check_events(memcg, page);\n\tlocal_irq_enable();\n\n\tif (do_memsw_account() && PageSwapCache(page)) {\n\t\tswp_entry_t entry = { .val = page_private(page) };\n\t\t/*\n\t\t * The swap entry might not get freed for a long time,\n\t\t * let's not wait for it.  The page already received a\n\t\t * memory+swap charge, drop the swap entry duplicate.\n\t\t */\n\t\tmem_cgroup_uncharge_swap(entry, nr_pages);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_add_to_page_cache",
          "args": [
            "page",
            "mapping",
            "pgoff",
            "NULL",
            "gfp & GFP_RECLAIM_MASK"
          ],
          "line": 2260
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_add_to_page_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "578-629",
          "snippet": "static int shmem_add_to_page_cache(struct page *page,\n\t\t\t\t   struct address_space *mapping,\n\t\t\t\t   pgoff_t index, void *expected, gfp_t gfp)\n{\n\tXA_STATE_ORDER(xas, &mapping->i_pages, index, compound_order(page));\n\tunsigned long i = 0;\n\tunsigned long nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(PageTail(page), page);\n\tVM_BUG_ON_PAGE(index != round_down(index, nr), page);\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\tVM_BUG_ON(expected && PageTransHuge(page));\n\n\tpage_ref_add(page, nr);\n\tpage->mapping = mapping;\n\tpage->index = index;\n\n\tdo {\n\t\tvoid *entry;\n\t\txas_lock_irq(&xas);\n\t\tentry = xas_find_conflict(&xas);\n\t\tif (entry != expected)\n\t\t\txas_set_err(&xas, -EEXIST);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\nnext:\n\t\txas_store(&xas, page + i);\n\t\tif (++i < nr) {\n\t\t\txas_next(&xas);\n\t\t\tgoto next;\n\t\t}\n\t\tif (PageTransHuge(page)) {\n\t\t\tcount_vm_event(THP_FILE_ALLOC);\n\t\t\t__inc_node_page_state(page, NR_SHMEM_THPS);\n\t\t}\n\t\tmapping->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\t__mod_node_page_state(page_pgdat(page), NR_SHMEM, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (xas_error(&xas)) {\n\t\tpage->mapping = NULL;\n\t\tpage_ref_sub(page, nr);\n\t\treturn xas_error(&xas);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_add_to_page_cache(struct page *page,\n\t\t\t\t   struct address_space *mapping,\n\t\t\t\t   pgoff_t index, void *expected, gfp_t gfp)\n{\n\tXA_STATE_ORDER(xas, &mapping->i_pages, index, compound_order(page));\n\tunsigned long i = 0;\n\tunsigned long nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(PageTail(page), page);\n\tVM_BUG_ON_PAGE(index != round_down(index, nr), page);\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\tVM_BUG_ON(expected && PageTransHuge(page));\n\n\tpage_ref_add(page, nr);\n\tpage->mapping = mapping;\n\tpage->index = index;\n\n\tdo {\n\t\tvoid *entry;\n\t\txas_lock_irq(&xas);\n\t\tentry = xas_find_conflict(&xas);\n\t\tif (entry != expected)\n\t\t\txas_set_err(&xas, -EEXIST);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\nnext:\n\t\txas_store(&xas, page + i);\n\t\tif (++i < nr) {\n\t\t\txas_next(&xas);\n\t\t\tgoto next;\n\t\t}\n\t\tif (PageTransHuge(page)) {\n\t\t\tcount_vm_event(THP_FILE_ALLOC);\n\t\t\t__inc_node_page_state(page, NR_SHMEM_THPS);\n\t\t}\n\t\tmapping->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\t__mod_node_page_state(page_pgdat(page), NR_SHMEM, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (xas_error(&xas)) {\n\t\tpage->mapping = NULL;\n\t\tpage_ref_sub(page, nr);\n\t\treturn xas_error(&xas);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mem_cgroup_try_charge_delay",
          "args": [
            "page",
            "dst_mm",
            "gfp",
            "&memcg",
            "false"
          ],
          "line": 2256
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_try_charge_delay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5898-5909",
          "snippet": "int mem_cgroup_try_charge_delay(struct page *page, struct mm_struct *mm,\n\t\t\t  gfp_t gfp_mask, struct mem_cgroup **memcgp,\n\t\t\t  bool compound)\n{\n\tstruct mem_cgroup *memcg;\n\tint ret;\n\n\tret = mem_cgroup_try_charge(page, mm, gfp_mask, memcgp, compound);\n\tmemcg = *memcgp;\n\tmem_cgroup_throttle_swaprate(memcg, page_to_nid(page), gfp_mask);\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nint mem_cgroup_try_charge_delay(struct page *page, struct mm_struct *mm,\n\t\t\t  gfp_t gfp_mask, struct mem_cgroup **memcgp,\n\t\t\t  bool compound)\n{\n\tstruct mem_cgroup *memcg;\n\tint ret;\n\n\tret = mem_cgroup_try_charge(page, mm, gfp_mask, memcgp, compound);\n\tmemcg = *memcgp;\n\tmem_cgroup_throttle_swaprate(memcg, page_to_nid(page), gfp_mask);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__SetPageUptodate",
          "args": [
            "page"
          ],
          "line": 2254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__SetPageSwapBacked",
          "args": [
            "page"
          ],
          "line": 2253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__SetPageLocked",
          "args": [
            "page"
          ],
          "line": 2252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "PageLocked(page) || PageSwapBacked(page)"
          ],
          "line": 2251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageSwapBacked",
          "args": [
            "page"
          ],
          "line": 2251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageLocked",
          "args": [
            "page"
          ],
          "line": 2251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "page"
          ],
          "line": 2244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ret"
          ],
          "line": 2237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "page_kaddr"
          ],
          "line": 2234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_user",
          "args": [
            "page_kaddr",
            "(const void __user *)src_addr",
            "PAGE_SIZE"
          ],
          "line": 2231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 2230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_alloc_page",
          "args": [
            "gfp",
            "info",
            "pgoff"
          ],
          "line": 2225
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_alloc_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1445-1456",
          "snippet": "static struct page *shmem_alloc_page(gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tpage = alloc_page_vma(gfp, &pvma, 0);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_alloc_page(gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tpage = alloc_page_vma(gfp, &pvma, 0);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_inode_acct_block",
          "args": [
            "inode",
            "1"
          ],
          "line": 2221
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_inode_acct_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "193-213",
          "snippet": "static inline bool shmem_inode_acct_block(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (shmem_acct_block(info->flags, pages))\n\t\treturn false;\n\n\tif (sbinfo->max_blocks) {\n\t\tif (percpu_counter_compare(&sbinfo->used_blocks,\n\t\t\t\t\t   sbinfo->max_blocks - pages) > 0)\n\t\t\tgoto unacct;\n\t\tpercpu_counter_add(&sbinfo->used_blocks, pages);\n\t}\n\n\treturn true;\n\nunacct:\n\tshmem_unacct_blocks(info->flags, pages);\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline bool shmem_inode_acct_block(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (shmem_acct_block(info->flags, pages))\n\t\treturn false;\n\n\tif (sbinfo->max_blocks) {\n\t\tif (percpu_counter_compare(&sbinfo->used_blocks,\n\t\t\t\t\t   sbinfo->max_blocks - pages) > 0)\n\t\t\tgoto unacct;\n\t\tpercpu_counter_add(&sbinfo->used_blocks, pages);\n\t}\n\n\treturn true;\n\nunacct:\n\tshmem_unacct_blocks(info->flags, pages);\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "linear_page_index",
          "args": [
            "dst_vma",
            "dst_addr"
          ],
          "line": 2212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapping_gfp_mask",
          "args": [
            "mapping"
          ],
          "line": 2211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 2209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "dst_vma->vm_file"
          ],
          "line": 2208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic int shmem_mfill_atomic_pte(struct mm_struct *dst_mm,\n\t\t\t\t  pmd_t *dst_pmd,\n\t\t\t\t  struct vm_area_struct *dst_vma,\n\t\t\t\t  unsigned long dst_addr,\n\t\t\t\t  unsigned long src_addr,\n\t\t\t\t  bool zeropage,\n\t\t\t\t  struct page **pagep)\n{\n\tstruct inode *inode = file_inode(dst_vma->vm_file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct address_space *mapping = inode->i_mapping;\n\tgfp_t gfp = mapping_gfp_mask(mapping);\n\tpgoff_t pgoff = linear_page_index(dst_vma, dst_addr);\n\tstruct mem_cgroup *memcg;\n\tspinlock_t *ptl;\n\tvoid *page_kaddr;\n\tstruct page *page;\n\tpte_t _dst_pte, *dst_pte;\n\tint ret;\n\n\tret = -ENOMEM;\n\tif (!shmem_inode_acct_block(inode, 1))\n\t\tgoto out;\n\n\tif (!*pagep) {\n\t\tpage = shmem_alloc_page(gfp, info, pgoff);\n\t\tif (!page)\n\t\t\tgoto out_unacct_blocks;\n\n\t\tif (!zeropage) {\t/* mcopy_atomic */\n\t\t\tpage_kaddr = kmap_atomic(page);\n\t\t\tret = copy_from_user(page_kaddr,\n\t\t\t\t\t     (const void __user *)src_addr,\n\t\t\t\t\t     PAGE_SIZE);\n\t\t\tkunmap_atomic(page_kaddr);\n\n\t\t\t/* fallback to copy_from_user outside mmap_sem */\n\t\t\tif (unlikely(ret)) {\n\t\t\t\t*pagep = page;\n\t\t\t\tshmem_inode_unacct_blocks(inode, 1);\n\t\t\t\t/* don't free the page */\n\t\t\t\treturn -ENOENT;\n\t\t\t}\n\t\t} else {\t\t/* mfill_zeropage_atomic */\n\t\t\tclear_highpage(page);\n\t\t}\n\t} else {\n\t\tpage = *pagep;\n\t\t*pagep = NULL;\n\t}\n\n\tVM_BUG_ON(PageLocked(page) || PageSwapBacked(page));\n\t__SetPageLocked(page);\n\t__SetPageSwapBacked(page);\n\t__SetPageUptodate(page);\n\n\tret = mem_cgroup_try_charge_delay(page, dst_mm, gfp, &memcg, false);\n\tif (ret)\n\t\tgoto out_release;\n\n\tret = shmem_add_to_page_cache(page, mapping, pgoff, NULL,\n\t\t\t\t\t\tgfp & GFP_RECLAIM_MASK);\n\tif (ret)\n\t\tgoto out_release_uncharge;\n\n\tmem_cgroup_commit_charge(page, memcg, false, false);\n\n\t_dst_pte = mk_pte(page, dst_vma->vm_page_prot);\n\tif (dst_vma->vm_flags & VM_WRITE)\n\t\t_dst_pte = pte_mkwrite(pte_mkdirty(_dst_pte));\n\n\tret = -EEXIST;\n\tdst_pte = pte_offset_map_lock(dst_mm, dst_pmd, dst_addr, &ptl);\n\tif (!pte_none(*dst_pte))\n\t\tgoto out_release_uncharge_unlock;\n\n\tlru_cache_add_anon(page);\n\n\tspin_lock(&info->lock);\n\tinfo->alloced++;\n\tinode->i_blocks += BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock(&info->lock);\n\n\tinc_mm_counter(dst_mm, mm_counter_file(page));\n\tpage_add_file_rmap(page, false);\n\tset_pte_at(dst_mm, dst_addr, dst_pte, _dst_pte);\n\n\t/* No need to invalidate - it was non-present before */\n\tupdate_mmu_cache(dst_vma, dst_addr, dst_pte);\n\tunlock_page(page);\n\tpte_unmap_unlock(dst_pte, ptl);\n\tret = 0;\nout:\n\treturn ret;\nout_release_uncharge_unlock:\n\tpte_unmap_unlock(dst_pte, ptl);\nout_release_uncharge:\n\tmem_cgroup_cancel_charge(page, memcg, false);\nout_release:\n\tunlock_page(page);\n\tput_page(page);\nout_unacct_blocks:\n\tshmem_inode_unacct_blocks(inode, 1);\n\tgoto out;\n}"
  },
  {
    "function_name": "shmem_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2195-2198",
    "snippet": "bool shmem_mapping(struct address_space *mapping)\n{\n\treturn mapping->a_ops == &shmem_aops;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nbool shmem_mapping(struct address_space *mapping)\n{\n\treturn mapping->a_ops == &shmem_aops;\n}"
  },
  {
    "function_name": "shmem_get_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2134-2193",
    "snippet": "static struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_file_operations\t\t\tramfs_file_operations",
      "#define BOGO_DIRENT_SIZE 20"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_free_inode",
          "args": [
            "sb"
          ],
          "line": 2191
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_free_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "257-265",
          "snippet": "static void shmem_free_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tsbinfo->free_inodes++;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_free_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tsbinfo->free_inodes++;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_annotate_inode_mutex_key",
          "args": [
            "inode"
          ],
          "line": 2189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mpol_shared_policy_init",
          "args": [
            "&info->policy",
            "NULL"
          ],
          "line": 2185
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_shared_policy_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2468-2505",
          "snippet": "void mpol_shared_policy_init(struct shared_policy *sp, struct mempolicy *mpol)\n{\n\tint ret;\n\n\tsp->root = RB_ROOT;\t\t/* empty tree == default mempolicy */\n\trwlock_init(&sp->lock);\n\n\tif (mpol) {\n\t\tstruct vm_area_struct pvma;\n\t\tstruct mempolicy *new;\n\t\tNODEMASK_SCRATCH(scratch);\n\n\t\tif (!scratch)\n\t\t\tgoto put_mpol;\n\t\t/* contextualize the tmpfs mount point mempolicy */\n\t\tnew = mpol_new(mpol->mode, mpol->flags, &mpol->w.user_nodemask);\n\t\tif (IS_ERR(new))\n\t\t\tgoto free_scratch; /* no valid nodemask intersection */\n\n\t\ttask_lock(current);\n\t\tret = mpol_set_nodemask(new, &mpol->w.user_nodemask, scratch);\n\t\ttask_unlock(current);\n\t\tif (ret)\n\t\t\tgoto put_new;\n\n\t\t/* Create pseudo-vma that contains just the policy */\n\t\tvma_init(&pvma, NULL);\n\t\tpvma.vm_end = TASK_SIZE;\t/* policy covers entire file */\n\t\tmpol_set_shared_policy(sp, &pvma, new); /* adds ref */\n\nput_new:\n\t\tmpol_put(new);\t\t\t/* drop initial ref */\nfree_scratch:\n\t\tNODEMASK_SCRATCH_FREE(scratch);\nput_mpol:\n\t\tmpol_put(mpol);\t/* drop our incoming ref on sb mpol */\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void migrate_page_add(struct page *page, struct list_head *pagelist,\n\t\t\t\tunsigned long flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nstatic void migrate_page_add(struct page *page, struct list_head *pagelist,\n\t\t\t\tunsigned long flags);\n\nvoid mpol_shared_policy_init(struct shared_policy *sp, struct mempolicy *mpol)\n{\n\tint ret;\n\n\tsp->root = RB_ROOT;\t\t/* empty tree == default mempolicy */\n\trwlock_init(&sp->lock);\n\n\tif (mpol) {\n\t\tstruct vm_area_struct pvma;\n\t\tstruct mempolicy *new;\n\t\tNODEMASK_SCRATCH(scratch);\n\n\t\tif (!scratch)\n\t\t\tgoto put_mpol;\n\t\t/* contextualize the tmpfs mount point mempolicy */\n\t\tnew = mpol_new(mpol->mode, mpol->flags, &mpol->w.user_nodemask);\n\t\tif (IS_ERR(new))\n\t\t\tgoto free_scratch; /* no valid nodemask intersection */\n\n\t\ttask_lock(current);\n\t\tret = mpol_set_nodemask(new, &mpol->w.user_nodemask, scratch);\n\t\ttask_unlock(current);\n\t\tif (ret)\n\t\t\tgoto put_new;\n\n\t\t/* Create pseudo-vma that contains just the policy */\n\t\tvma_init(&pvma, NULL);\n\t\tpvma.vm_end = TASK_SIZE;\t/* policy covers entire file */\n\t\tmpol_set_shared_policy(sp, &pvma, new); /* adds ref */\n\nput_new:\n\t\tmpol_put(new);\t\t\t/* drop initial ref */\nfree_scratch:\n\t\tNODEMASK_SCRATCH_FREE(scratch);\nput_mpol:\n\t\tmpol_put(mpol);\t/* drop our incoming ref on sb mpol */\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "inc_nlink",
          "args": [
            "inode"
          ],
          "line": 2174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_get_sbmpol",
          "args": [
            "sbinfo"
          ],
          "line": 2171
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_get_sbmpol",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1379-1382",
          "snippet": "static inline struct mempolicy *shmem_get_sbmpol(struct shmem_sb_info *sbinfo)\n{\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct mempolicy *shmem_get_sbmpol(struct shmem_sb_info *sbinfo)\n{\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_special_inode",
          "args": [
            "inode",
            "mode",
            "dev"
          ],
          "line": 2164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_no_acl",
          "args": [
            "inode"
          ],
          "line": 2159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_xattrs_init",
          "args": [
            "&info->xattrs"
          ],
          "line": 2158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&info->swaplist"
          ],
          "line": 2157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&info->shrinklist"
          ],
          "line": 2156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&info->lock"
          ],
          "line": 2153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "(char *)inode - (char *)info"
          ],
          "line": 2152
        },
        "resolved": true,
        "details": {
          "function_name": "memset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "283-288",
          "snippet": "void *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 2151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prandom_u32",
          "args": [],
          "line": 2150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "inode"
          ],
          "line": 2149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inode_init_owner",
          "args": [
            "inode",
            "dir",
            "mode"
          ],
          "line": 2147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_next_ino",
          "args": [],
          "line": 2146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_inode",
          "args": [
            "sb"
          ],
          "line": 2144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_reserve_inode",
          "args": [
            "sb"
          ],
          "line": 2141
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_reserve_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "242-255",
          "snippet": "static int shmem_reserve_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tif (!sbinfo->free_inodes) {\n\t\t\tspin_unlock(&sbinfo->stat_lock);\n\t\t\treturn -ENOSPC;\n\t\t}\n\t\tsbinfo->free_inodes--;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_reserve_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tif (!sbinfo->free_inodes) {\n\t\t\tspin_unlock(&sbinfo->stat_lock);\n\t\t\treturn -ENOSPC;\n\t\t}\n\t\tsbinfo->free_inodes--;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "sb"
          ],
          "line": 2139
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n#define BOGO_DIRENT_SIZE 20\n\nstatic struct inode *shmem_get_inode(struct super_block *sb, const struct inode *dir,\n\t\t\t\t     umode_t mode, dev_t dev, unsigned long flags)\n{\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (shmem_reserve_inode(sb))\n\t\treturn NULL;\n\n\tinode = new_inode(sb);\n\tif (inode) {\n\t\tinode->i_ino = get_next_ino();\n\t\tinode_init_owner(inode, dir, mode);\n\t\tinode->i_blocks = 0;\n\t\tinode->i_atime = inode->i_mtime = inode->i_ctime = current_time(inode);\n\t\tinode->i_generation = prandom_u32();\n\t\tinfo = SHMEM_I(inode);\n\t\tmemset(info, 0, (char *)inode - (char *)info);\n\t\tspin_lock_init(&info->lock);\n\t\tinfo->seals = F_SEAL_SEAL;\n\t\tinfo->flags = flags & VM_NORESERVE;\n\t\tINIT_LIST_HEAD(&info->shrinklist);\n\t\tINIT_LIST_HEAD(&info->swaplist);\n\t\tsimple_xattrs_init(&info->xattrs);\n\t\tcache_no_acl(inode);\n\n\t\tswitch (mode & S_IFMT) {\n\t\tdefault:\n\t\t\tinode->i_op = &shmem_special_inode_operations;\n\t\t\tinit_special_inode(inode, mode, dev);\n\t\t\tbreak;\n\t\tcase S_IFREG:\n\t\t\tinode->i_mapping->a_ops = &shmem_aops;\n\t\t\tinode->i_op = &shmem_inode_operations;\n\t\t\tinode->i_fop = &shmem_file_operations;\n\t\t\tmpol_shared_policy_init(&info->policy,\n\t\t\t\t\t\t shmem_get_sbmpol(sbinfo));\n\t\t\tbreak;\n\t\tcase S_IFDIR:\n\t\t\tinc_nlink(inode);\n\t\t\t/* Some things misbehave if size == 0 on a directory */\n\t\t\tinode->i_size = 2 * BOGO_DIRENT_SIZE;\n\t\t\tinode->i_op = &shmem_dir_inode_operations;\n\t\t\tinode->i_fop = &simple_dir_operations;\n\t\t\tbreak;\n\t\tcase S_IFLNK:\n\t\t\t/*\n\t\t\t * Must not load anything in the rbtree,\n\t\t\t * mpol_free_shared_policy will not be called.\n\t\t\t */\n\t\t\tmpol_shared_policy_init(&info->policy, NULL);\n\t\t\tbreak;\n\t\t}\n\n\t\tlockdep_annotate_inode_mutex_key(inode);\n\t} else\n\t\tshmem_free_inode(sb);\n\treturn inode;\n}"
  },
  {
    "function_name": "shmem_mmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2122-2132",
    "snippet": "static int shmem_mmap(struct file *file, struct vm_area_struct *vma)\n{\n\tfile_accessed(file);\n\tvma->vm_ops = &shmem_vm_ops;\n\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE) &&\n\t\t\t((vma->vm_start + ~HPAGE_PMD_MASK) & HPAGE_PMD_MASK) <\n\t\t\t(vma->vm_end & HPAGE_PMD_MASK)) {\n\t\tkhugepaged_enter(vma, vma->vm_flags);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_vm_ops\t\t\t\tgeneric_file_vm_ops"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "khugepaged_enter",
          "args": [
            "vma",
            "vma->vm_flags"
          ],
          "line": 2129
        },
        "resolved": true,
        "details": {
          "function_name": "khugepaged_enter_vma_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/khugepaged.c",
          "lines": "453-470",
          "snippet": "int khugepaged_enter_vma_merge(struct vm_area_struct *vma,\n\t\t\t       unsigned long vm_flags)\n{\n\tunsigned long hstart, hend;\n\n\t/*\n\t * khugepaged does not yet work on non-shmem files or special\n\t * mappings. And file-private shmem THP is not supported.\n\t */\n\tif (!hugepage_vma_check(vma, vm_flags))\n\t\treturn 0;\n\n\thstart = (vma->vm_start + ~HPAGE_PMD_MASK) & HPAGE_PMD_MASK;\n\thend = vma->vm_end & HPAGE_PMD_MASK;\n\tif (hstart < hend)\n\t\treturn khugepaged_enter(vma, vm_flags);\n\treturn 0;\n}",
          "includes": [
            "#include <trace/events/huge_memory.h>",
            "#include \"internal.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/tlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page_idle.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/mman.h>",
            "#include <linux/freezer.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/swap.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/huge_memory.h>\n#include \"internal.h\"\n#include <asm/pgalloc.h>\n#include <asm/tlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/swapops.h>\n#include <linux/page_idle.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/hashtable.h>\n#include <linux/mman.h>\n#include <linux/freezer.h>\n#include <linux/khugepaged.h>\n#include <linux/kthread.h>\n#include <linux/mm_inline.h>\n#include <linux/swap.h>\n#include <linux/rmap.h>\n#include <linux/mmu_notifier.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nint khugepaged_enter_vma_merge(struct vm_area_struct *vma,\n\t\t\t       unsigned long vm_flags)\n{\n\tunsigned long hstart, hend;\n\n\t/*\n\t * khugepaged does not yet work on non-shmem files or special\n\t * mappings. And file-private shmem THP is not supported.\n\t */\n\tif (!hugepage_vma_check(vma, vm_flags))\n\t\treturn 0;\n\n\thstart = (vma->vm_start + ~HPAGE_PMD_MASK) & HPAGE_PMD_MASK;\n\thend = vma->vm_end & HPAGE_PMD_MASK;\n\tif (hstart < hend)\n\t\treturn khugepaged_enter(vma, vm_flags);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_TRANSPARENT_HUGE_PAGECACHE"
          ],
          "line": 2126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_accessed",
          "args": [
            "file"
          ],
          "line": 2124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_vm_ops\t\t\t\tgeneric_file_vm_ops\n\nstatic int shmem_mmap(struct file *file, struct vm_area_struct *vma)\n{\n\tfile_accessed(file);\n\tvma->vm_ops = &shmem_vm_ops;\n\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE) &&\n\t\t\t((vma->vm_start + ~HPAGE_PMD_MASK) & HPAGE_PMD_MASK) <\n\t\t\t(vma->vm_end & HPAGE_PMD_MASK)) {\n\t\tkhugepaged_enter(vma, vma->vm_flags);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2097-2120",
    "snippet": "int shmem_lock(struct file *file, int lock, struct user_struct *user)\n{\n\tstruct inode *inode = file_inode(file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tint retval = -ENOMEM;\n\n\tspin_lock_irq(&info->lock);\n\tif (lock && !(info->flags & VM_LOCKED)) {\n\t\tif (!user_shm_lock(inode->i_size, user))\n\t\t\tgoto out_nomem;\n\t\tinfo->flags |= VM_LOCKED;\n\t\tmapping_set_unevictable(file->f_mapping);\n\t}\n\tif (!lock && (info->flags & VM_LOCKED) && user) {\n\t\tuser_shm_unlock(inode->i_size, user);\n\t\tinfo->flags &= ~VM_LOCKED;\n\t\tmapping_clear_unevictable(file->f_mapping);\n\t}\n\tretval = 0;\n\nout_nomem:\n\tspin_unlock_irq(&info->lock);\n\treturn retval;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 2118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapping_clear_unevictable",
          "args": [
            "file->f_mapping"
          ],
          "line": 2113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_shm_unlock",
          "args": [
            "inode->i_size",
            "user"
          ],
          "line": 2111
        },
        "resolved": true,
        "details": {
          "function_name": "user_shm_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mlock.c",
          "lines": "862-868",
          "snippet": "void user_shm_unlock(size_t size, struct user_struct *user)\n{\n\tspin_lock(&shmlock_user_lock);\n\tuser->locked_shm -= (size + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tspin_unlock(&shmlock_user_lock);\n\tfree_uid(user);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/mm_inline.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/rmap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/mm.h>",
            "#include <linux/mman.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(shmlock_user_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/mm_inline.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/mmzone.h>\n#include <linux/rmap.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/syscalls.h>\n#include <linux/mempolicy.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/sched/user.h>\n#include <linux/mm.h>\n#include <linux/mman.h>\n#include <linux/capability.h>\n\nstatic DEFINE_SPINLOCK(shmlock_user_lock);\n\nvoid user_shm_unlock(size_t size, struct user_struct *user)\n{\n\tspin_lock(&shmlock_user_lock);\n\tuser->locked_shm -= (size + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tspin_unlock(&shmlock_user_lock);\n\tfree_uid(user);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapping_set_unevictable",
          "args": [
            "file->f_mapping"
          ],
          "line": 2108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_shm_lock",
          "args": [
            "inode->i_size",
            "user"
          ],
          "line": 2105
        },
        "resolved": true,
        "details": {
          "function_name": "user_shm_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mlock.c",
          "lines": "840-860",
          "snippet": "int user_shm_lock(size_t size, struct user_struct *user)\n{\n\tunsigned long lock_limit, locked;\n\tint allowed = 0;\n\n\tlocked = (size + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tlock_limit = rlimit(RLIMIT_MEMLOCK);\n\tif (lock_limit == RLIM_INFINITY)\n\t\tallowed = 1;\n\tlock_limit >>= PAGE_SHIFT;\n\tspin_lock(&shmlock_user_lock);\n\tif (!allowed &&\n\t    locked + user->locked_shm > lock_limit && !capable(CAP_IPC_LOCK))\n\t\tgoto out;\n\tget_uid(user);\n\tuser->locked_shm += locked;\n\tallowed = 1;\nout:\n\tspin_unlock(&shmlock_user_lock);\n\treturn allowed;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/mm_inline.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/rmap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/mm.h>",
            "#include <linux/mman.h>",
            "#include <linux/capability.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(shmlock_user_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/mm_inline.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/mmzone.h>\n#include <linux/rmap.h>\n#include <linux/export.h>\n#include <linux/sched.h>\n#include <linux/syscalls.h>\n#include <linux/mempolicy.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/sched/user.h>\n#include <linux/mm.h>\n#include <linux/mman.h>\n#include <linux/capability.h>\n\nstatic DEFINE_SPINLOCK(shmlock_user_lock);\n\nint user_shm_lock(size_t size, struct user_struct *user)\n{\n\tunsigned long lock_limit, locked;\n\tint allowed = 0;\n\n\tlocked = (size + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tlock_limit = rlimit(RLIMIT_MEMLOCK);\n\tif (lock_limit == RLIM_INFINITY)\n\t\tallowed = 1;\n\tlock_limit >>= PAGE_SHIFT;\n\tspin_lock(&shmlock_user_lock);\n\tif (!allowed &&\n\t    locked + user->locked_shm > lock_limit && !capable(CAP_IPC_LOCK))\n\t\tgoto out;\n\tget_uid(user);\n\tuser->locked_shm += locked;\n\tallowed = 1;\nout:\n\tspin_unlock(&shmlock_user_lock);\n\treturn allowed;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 2103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 2100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "file"
          ],
          "line": 2099
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_lock(struct file *file, int lock, struct user_struct *user)\n{\n\tstruct inode *inode = file_inode(file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tint retval = -ENOMEM;\n\n\tspin_lock_irq(&info->lock);\n\tif (lock && !(info->flags & VM_LOCKED)) {\n\t\tif (!user_shm_lock(inode->i_size, user))\n\t\t\tgoto out_nomem;\n\t\tinfo->flags |= VM_LOCKED;\n\t\tmapping_set_unevictable(file->f_mapping);\n\t}\n\tif (!lock && (info->flags & VM_LOCKED) && user) {\n\t\tuser_shm_unlock(inode->i_size, user);\n\t\tinfo->flags &= ~VM_LOCKED;\n\t\tmapping_clear_unevictable(file->f_mapping);\n\t}\n\tretval = 0;\n\nout_nomem:\n\tspin_unlock_irq(&info->lock);\n\treturn retval;\n}"
  },
  {
    "function_name": "shmem_get_policy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2086-2094",
    "snippet": "static struct mempolicy *shmem_get_policy(struct vm_area_struct *vma,\n\t\t\t\t\t  unsigned long addr)\n{\n\tstruct inode *inode = file_inode(vma->vm_file);\n\tpgoff_t index;\n\n\tindex = ((addr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;\n\treturn mpol_shared_policy_lookup(&SHMEM_I(inode)->policy, index);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mpol_shared_policy_lookup",
          "args": [
            "&SHMEM_I(inode)->policy",
            "index"
          ],
          "line": 2093
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_shared_policy_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2232-2248",
          "snippet": "struct mempolicy *\nmpol_shared_policy_lookup(struct shared_policy *sp, unsigned long idx)\n{\n\tstruct mempolicy *pol = NULL;\n\tstruct sp_node *sn;\n\n\tif (!sp->root.rb_node)\n\t\treturn NULL;\n\tread_lock(&sp->lock);\n\tsn = sp_lookup(sp, idx, idx+1);\n\tif (sn) {\n\t\tmpol_get(sn->policy);\n\t\tpol = sn->policy;\n\t}\n\tread_unlock(&sp->lock);\n\treturn pol;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nstruct mempolicy *\nmpol_shared_policy_lookup(struct shared_policy *sp, unsigned long idx)\n{\n\tstruct mempolicy *pol = NULL;\n\tstruct sp_node *sn;\n\n\tif (!sp->root.rb_node)\n\t\treturn NULL;\n\tread_lock(&sp->lock);\n\tsn = sp_lookup(sp, idx, idx+1);\n\tif (sn) {\n\t\tmpol_get(sn->policy);\n\t\tpol = sn->policy;\n\t}\n\tread_unlock(&sp->lock);\n\treturn pol;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 2093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "vma->vm_file"
          ],
          "line": 2089
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct mempolicy *shmem_get_policy(struct vm_area_struct *vma,\n\t\t\t\t\t  unsigned long addr)\n{\n\tstruct inode *inode = file_inode(vma->vm_file);\n\tpgoff_t index;\n\n\tindex = ((addr - vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;\n\treturn mpol_shared_policy_lookup(&SHMEM_I(inode)->policy, index);\n}"
  },
  {
    "function_name": "shmem_set_policy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "2080-2084",
    "snippet": "static int shmem_set_policy(struct vm_area_struct *vma, struct mempolicy *mpol)\n{\n\tstruct inode *inode = file_inode(vma->vm_file);\n\treturn mpol_set_shared_policy(&SHMEM_I(inode)->policy, vma, mpol);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mpol_set_shared_policy",
          "args": [
            "&SHMEM_I(inode)->policy",
            "vma",
            "mpol"
          ],
          "line": 2083
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_set_shared_policy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2507-2529",
          "snippet": "int mpol_set_shared_policy(struct shared_policy *info,\n\t\t\tstruct vm_area_struct *vma, struct mempolicy *npol)\n{\n\tint err;\n\tstruct sp_node *new = NULL;\n\tunsigned long sz = vma_pages(vma);\n\n\tpr_debug(\"set_shared_policy %lx sz %lu %d %d %lx\\n\",\n\t\t vma->vm_pgoff,\n\t\t sz, npol ? npol->mode : -1,\n\t\t npol ? npol->flags : -1,\n\t\t npol ? nodes_addr(npol->v.nodes)[0] : NUMA_NO_NODE);\n\n\tif (npol) {\n\t\tnew = sp_alloc(vma->vm_pgoff, vma->vm_pgoff + sz, npol);\n\t\tif (!new)\n\t\t\treturn -ENOMEM;\n\t}\n\terr = shared_policy_replace(info, vma->vm_pgoff, vma->vm_pgoff+sz, new);\n\tif (err && new)\n\t\tsp_free(new);\n\treturn err;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void migrate_page_add(struct page *page, struct list_head *pagelist,\n\t\t\t\tunsigned long flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nstatic void migrate_page_add(struct page *page, struct list_head *pagelist,\n\t\t\t\tunsigned long flags);\n\nint mpol_set_shared_policy(struct shared_policy *info,\n\t\t\tstruct vm_area_struct *vma, struct mempolicy *npol)\n{\n\tint err;\n\tstruct sp_node *new = NULL;\n\tunsigned long sz = vma_pages(vma);\n\n\tpr_debug(\"set_shared_policy %lx sz %lu %d %d %lx\\n\",\n\t\t vma->vm_pgoff,\n\t\t sz, npol ? npol->mode : -1,\n\t\t npol ? npol->flags : -1,\n\t\t npol ? nodes_addr(npol->v.nodes)[0] : NUMA_NO_NODE);\n\n\tif (npol) {\n\t\tnew = sp_alloc(vma->vm_pgoff, vma->vm_pgoff + sz, npol);\n\t\tif (!new)\n\t\t\treturn -ENOMEM;\n\t}\n\terr = shared_policy_replace(info, vma->vm_pgoff, vma->vm_pgoff+sz, new);\n\tif (err && new)\n\t\tsp_free(new);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 2083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "vma->vm_file"
          ],
          "line": 2082
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_set_policy(struct vm_area_struct *vma, struct mempolicy *mpol)\n{\n\tstruct inode *inode = file_inode(vma->vm_file);\n\treturn mpol_set_shared_policy(&SHMEM_I(inode)->policy, vma, mpol);\n}"
  },
  {
    "function_name": "shmem_get_unmapped_area",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1991-2077",
    "snippet": "unsigned long shmem_get_unmapped_area(struct file *file,\n\t\t\t\t      unsigned long uaddr, unsigned long len,\n\t\t\t\t      unsigned long pgoff, unsigned long flags)\n{\n\tunsigned long (*get_area)(struct file *,\n\t\tunsigned long, unsigned long, unsigned long, unsigned long);\n\tunsigned long addr;\n\tunsigned long offset;\n\tunsigned long inflated_len;\n\tunsigned long inflated_addr;\n\tunsigned long inflated_offset;\n\n\tif (len > TASK_SIZE)\n\t\treturn -ENOMEM;\n\n\tget_area = current->mm->get_unmapped_area;\n\taddr = get_area(file, uaddr, len, pgoff, flags);\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\treturn addr;\n\tif (IS_ERR_VALUE(addr))\n\t\treturn addr;\n\tif (addr & ~PAGE_MASK)\n\t\treturn addr;\n\tif (addr > TASK_SIZE - len)\n\t\treturn addr;\n\n\tif (shmem_huge == SHMEM_HUGE_DENY)\n\t\treturn addr;\n\tif (len < HPAGE_PMD_SIZE)\n\t\treturn addr;\n\tif (flags & MAP_FIXED)\n\t\treturn addr;\n\t/*\n\t * Our priority is to support MAP_SHARED mapped hugely;\n\t * and support MAP_PRIVATE mapped hugely too, until it is COWed.\n\t * But if caller specified an address hint, respect that as before.\n\t */\n\tif (uaddr)\n\t\treturn addr;\n\n\tif (shmem_huge != SHMEM_HUGE_FORCE) {\n\t\tstruct super_block *sb;\n\n\t\tif (file) {\n\t\t\tVM_BUG_ON(file->f_op != &shmem_file_operations);\n\t\t\tsb = file_inode(file)->i_sb;\n\t\t} else {\n\t\t\t/*\n\t\t\t * Called directly from mm/mmap.c, or drivers/char/mem.c\n\t\t\t * for \"/dev/zero\", to create a shared anonymous object.\n\t\t\t */\n\t\t\tif (IS_ERR(shm_mnt))\n\t\t\t\treturn addr;\n\t\t\tsb = shm_mnt->mnt_sb;\n\t\t}\n\t\tif (SHMEM_SB(sb)->huge == SHMEM_HUGE_NEVER)\n\t\t\treturn addr;\n\t}\n\n\toffset = (pgoff << PAGE_SHIFT) & (HPAGE_PMD_SIZE-1);\n\tif (offset && offset + len < 2 * HPAGE_PMD_SIZE)\n\t\treturn addr;\n\tif ((addr & (HPAGE_PMD_SIZE-1)) == offset)\n\t\treturn addr;\n\n\tinflated_len = len + HPAGE_PMD_SIZE - PAGE_SIZE;\n\tif (inflated_len > TASK_SIZE)\n\t\treturn addr;\n\tif (inflated_len < len)\n\t\treturn addr;\n\n\tinflated_addr = get_area(NULL, 0, inflated_len, 0, flags);\n\tif (IS_ERR_VALUE(inflated_addr))\n\t\treturn addr;\n\tif (inflated_addr & ~PAGE_MASK)\n\t\treturn addr;\n\n\tinflated_offset = inflated_addr & (HPAGE_PMD_SIZE-1);\n\tinflated_addr += offset - inflated_offset;\n\tif (inflated_offset > offset)\n\t\tinflated_addr += HPAGE_PMD_SIZE;\n\n\tif (inflated_addr > TASK_SIZE - len)\n\t\treturn addr;\n\treturn inflated_addr;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_file_operations\t\t\tramfs_file_operations",
      "#define shmem_huge SHMEM_HUGE_DENY",
      "#define SHMEM_HUGE_FORCE\t(-2)",
      "#define SHMEM_HUGE_DENY\t\t(-1)",
      "#define SHMEM_HUGE_NEVER\t0"
    ],
    "globals_used": [
      "static struct vfsmount *shm_mnt;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ERR_VALUE",
          "args": [
            "inflated_addr"
          ],
          "line": 2064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_area",
          "args": [
            "NULL",
            "0",
            "inflated_len",
            "0",
            "flags"
          ],
          "line": 2063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "sb"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "shm_mnt"
          ],
          "line": 2043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "file"
          ],
          "line": 2037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "file->f_op != &shmem_file_operations"
          ],
          "line": 2036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR_VALUE",
          "args": [
            "addr"
          ],
          "line": 2011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_TRANSPARENT_HUGE_PAGECACHE"
          ],
          "line": 2009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_area",
          "args": [
            "file",
            "uaddr",
            "len",
            "pgoff",
            "flags"
          ],
          "line": 2007
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_file_operations\t\t\tramfs_file_operations\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_NEVER\t0\n\nstatic struct vfsmount *shm_mnt;\n\nunsigned long shmem_get_unmapped_area(struct file *file,\n\t\t\t\t      unsigned long uaddr, unsigned long len,\n\t\t\t\t      unsigned long pgoff, unsigned long flags)\n{\n\tunsigned long (*get_area)(struct file *,\n\t\tunsigned long, unsigned long, unsigned long, unsigned long);\n\tunsigned long addr;\n\tunsigned long offset;\n\tunsigned long inflated_len;\n\tunsigned long inflated_addr;\n\tunsigned long inflated_offset;\n\n\tif (len > TASK_SIZE)\n\t\treturn -ENOMEM;\n\n\tget_area = current->mm->get_unmapped_area;\n\taddr = get_area(file, uaddr, len, pgoff, flags);\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\treturn addr;\n\tif (IS_ERR_VALUE(addr))\n\t\treturn addr;\n\tif (addr & ~PAGE_MASK)\n\t\treturn addr;\n\tif (addr > TASK_SIZE - len)\n\t\treturn addr;\n\n\tif (shmem_huge == SHMEM_HUGE_DENY)\n\t\treturn addr;\n\tif (len < HPAGE_PMD_SIZE)\n\t\treturn addr;\n\tif (flags & MAP_FIXED)\n\t\treturn addr;\n\t/*\n\t * Our priority is to support MAP_SHARED mapped hugely;\n\t * and support MAP_PRIVATE mapped hugely too, until it is COWed.\n\t * But if caller specified an address hint, respect that as before.\n\t */\n\tif (uaddr)\n\t\treturn addr;\n\n\tif (shmem_huge != SHMEM_HUGE_FORCE) {\n\t\tstruct super_block *sb;\n\n\t\tif (file) {\n\t\t\tVM_BUG_ON(file->f_op != &shmem_file_operations);\n\t\t\tsb = file_inode(file)->i_sb;\n\t\t} else {\n\t\t\t/*\n\t\t\t * Called directly from mm/mmap.c, or drivers/char/mem.c\n\t\t\t * for \"/dev/zero\", to create a shared anonymous object.\n\t\t\t */\n\t\t\tif (IS_ERR(shm_mnt))\n\t\t\t\treturn addr;\n\t\t\tsb = shm_mnt->mnt_sb;\n\t\t}\n\t\tif (SHMEM_SB(sb)->huge == SHMEM_HUGE_NEVER)\n\t\t\treturn addr;\n\t}\n\n\toffset = (pgoff << PAGE_SHIFT) & (HPAGE_PMD_SIZE-1);\n\tif (offset && offset + len < 2 * HPAGE_PMD_SIZE)\n\t\treturn addr;\n\tif ((addr & (HPAGE_PMD_SIZE-1)) == offset)\n\t\treturn addr;\n\n\tinflated_len = len + HPAGE_PMD_SIZE - PAGE_SIZE;\n\tif (inflated_len > TASK_SIZE)\n\t\treturn addr;\n\tif (inflated_len < len)\n\t\treturn addr;\n\n\tinflated_addr = get_area(NULL, 0, inflated_len, 0, flags);\n\tif (IS_ERR_VALUE(inflated_addr))\n\t\treturn addr;\n\tif (inflated_addr & ~PAGE_MASK)\n\t\treturn addr;\n\n\tinflated_offset = inflated_addr & (HPAGE_PMD_SIZE-1);\n\tinflated_addr += offset - inflated_offset;\n\tif (inflated_offset > offset)\n\t\tinflated_addr += HPAGE_PMD_SIZE;\n\n\tif (inflated_addr > TASK_SIZE - len)\n\t\treturn addr;\n\treturn inflated_addr;\n}"
  },
  {
    "function_name": "shmem_fault",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1909-1989",
    "snippet": "static vm_fault_t shmem_fault(struct vm_fault *vmf)\n{\n\tstruct vm_area_struct *vma = vmf->vma;\n\tstruct inode *inode = file_inode(vma->vm_file);\n\tgfp_t gfp = mapping_gfp_mask(inode->i_mapping);\n\tenum sgp_type sgp;\n\tint err;\n\tvm_fault_t ret = VM_FAULT_LOCKED;\n\n\t/*\n\t * Trinity finds that probing a hole which tmpfs is punching can\n\t * prevent the hole-punch from ever completing: which in turn\n\t * locks writers out with its hold on i_mutex.  So refrain from\n\t * faulting pages into the hole while it's being punched.  Although\n\t * shmem_undo_range() does remove the additions, it may be unable to\n\t * keep up, as each new page needs its own unmap_mapping_range() call,\n\t * and the i_mmap tree grows ever slower to scan if new vmas are added.\n\t *\n\t * It does not matter if we sometimes reach this check just before the\n\t * hole-punch begins, so that one fault then races with the punch:\n\t * we just need to make racing faults a rare case.\n\t *\n\t * The implementation below would be much simpler if we just used a\n\t * standard mutex or completion: but we cannot take i_mutex in fault,\n\t * and bloating every shmem inode for this unlikely case would be sad.\n\t */\n\tif (unlikely(inode->i_private)) {\n\t\tstruct shmem_falloc *shmem_falloc;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tshmem_falloc = inode->i_private;\n\t\tif (shmem_falloc &&\n\t\t    shmem_falloc->waitq &&\n\t\t    vmf->pgoff >= shmem_falloc->start &&\n\t\t    vmf->pgoff < shmem_falloc->next) {\n\t\t\twait_queue_head_t *shmem_falloc_waitq;\n\t\t\tDEFINE_WAIT_FUNC(shmem_fault_wait, synchronous_wake_function);\n\n\t\t\tret = VM_FAULT_NOPAGE;\n\t\t\tif ((vmf->flags & FAULT_FLAG_ALLOW_RETRY) &&\n\t\t\t   !(vmf->flags & FAULT_FLAG_RETRY_NOWAIT)) {\n\t\t\t\t/* It's polite to up mmap_sem if we can */\n\t\t\t\tup_read(&vma->vm_mm->mmap_sem);\n\t\t\t\tret = VM_FAULT_RETRY;\n\t\t\t}\n\n\t\t\tshmem_falloc_waitq = shmem_falloc->waitq;\n\t\t\tprepare_to_wait(shmem_falloc_waitq, &shmem_fault_wait,\n\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tschedule();\n\n\t\t\t/*\n\t\t\t * shmem_falloc_waitq points into the shmem_fallocate()\n\t\t\t * stack of the hole-punching task: shmem_falloc_waitq\n\t\t\t * is usually invalid by the time we reach here, but\n\t\t\t * finish_wait() does not dereference it in that case;\n\t\t\t * though i_lock needed lest racing with wake_up_all().\n\t\t\t */\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tfinish_wait(shmem_falloc_waitq, &shmem_fault_wait);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\treturn ret;\n\t\t}\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tsgp = SGP_CACHE;\n\n\tif ((vma->vm_flags & VM_NOHUGEPAGE) ||\n\t    test_bit(MMF_DISABLE_THP, &vma->vm_mm->flags))\n\t\tsgp = SGP_NOHUGE;\n\telse if (vma->vm_flags & VM_HUGEPAGE)\n\t\tsgp = SGP_HUGE;\n\n\terr = shmem_getpage_gfp(inode, vmf->pgoff, &vmf->page, sgp,\n\t\t\t\t  gfp, vma, vmf, &ret);\n\tif (err)\n\t\treturn vmf_error(err);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vmf_error",
          "args": [
            "err"
          ],
          "line": 1987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_getpage_gfp",
          "args": [
            "inode",
            "vmf->pgoff",
            "&vmf->page",
            "sgp",
            "gfp",
            "vma",
            "vmf",
            "&ret"
          ],
          "line": 1984
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage_gfp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1584-1895",
          "snippet": "static int shmem_getpage_gfp(struct inode *inode, pgoff_t index,\n\tstruct page **pagep, enum sgp_type sgp, gfp_t gfp,\n\tstruct vm_area_struct *vma, struct vm_fault *vmf,\n\t\t\tvm_fault_t *fault_type)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo;\n\tstruct mm_struct *charge_mm;\n\tstruct mem_cgroup *memcg;\n\tstruct page *page;\n\tswp_entry_t swap;\n\tenum sgp_type sgp_huge = sgp;\n\tpgoff_t hindex = index;\n\tint error;\n\tint once = 0;\n\tint alloced = 0;\n\n\tif (index > (MAX_LFS_FILESIZE >> PAGE_SHIFT))\n\t\treturn -EFBIG;\n\tif (sgp == SGP_NOHUGE || sgp == SGP_HUGE)\n\t\tsgp = SGP_CACHE;\nrepeat:\n\tswap.val = 0;\n\tpage = find_lock_entry(mapping, index);\n\tif (xa_is_value(page)) {\n\t\tswap = radix_to_swp_entry(page);\n\t\tpage = NULL;\n\t}\n\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\n\tif (page && sgp == SGP_WRITE)\n\t\tmark_page_accessed(page);\n\n\t/* fallocated page? */\n\tif (page && !PageUptodate(page)) {\n\t\tif (sgp != SGP_READ)\n\t\t\tgoto clear;\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tpage = NULL;\n\t}\n\tif (page || (sgp == SGP_READ && !swap.val)) {\n\t\t*pagep = page;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Fast cache lookup did not find it:\n\t * bring it back from swap or allocate.\n\t */\n\tsbinfo = SHMEM_SB(inode->i_sb);\n\tcharge_mm = vma ? vma->vm_mm : current->mm;\n\n\tif (swap.val) {\n\t\t/* Look it up and read it in.. */\n\t\tpage = lookup_swap_cache(swap, NULL, 0);\n\t\tif (!page) {\n\t\t\t/* Or update major stats only when swapin succeeds?? */\n\t\t\tif (fault_type) {\n\t\t\t\t*fault_type |= VM_FAULT_MAJOR;\n\t\t\t\tcount_vm_event(PGMAJFAULT);\n\t\t\t\tcount_memcg_event_mm(charge_mm, PGMAJFAULT);\n\t\t\t}\n\t\t\t/* Here we actually start the io */\n\t\t\tpage = shmem_swapin(swap, gfp, info, index);\n\t\t\tif (!page) {\n\t\t\t\terror = -ENOMEM;\n\t\t\t\tgoto failed;\n\t\t\t}\n\t\t}\n\n\t\t/* We have to do this with page locked to prevent races */\n\t\tlock_page(page);\n\t\tif (!PageSwapCache(page) || page_private(page) != swap.val ||\n\t\t    !shmem_confirm_swap(mapping, index, swap)) {\n\t\t\terror = -EEXIST;\t/* try again */\n\t\t\tgoto unlock;\n\t\t}\n\t\tif (!PageUptodate(page)) {\n\t\t\terror = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t\twait_on_page_writeback(page);\n\n\t\tif (shmem_should_replace_page(page, gfp)) {\n\t\t\terror = shmem_replace_page(&page, gfp, info, index);\n\t\t\tif (error)\n\t\t\t\tgoto failed;\n\t\t}\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tfalse);\n\t\tif (!error) {\n\t\t\terror = shmem_add_to_page_cache(page, mapping, index,\n\t\t\t\t\t\tswp_to_radix_entry(swap), gfp);\n\t\t\t/*\n\t\t\t * We already confirmed swap under page lock, and make\n\t\t\t * no memory allocation here, so usually no possibility\n\t\t\t * of error; but free_swap_and_cache() only trylocks a\n\t\t\t * page, so it is just possible that the entry has been\n\t\t\t * truncated or holepunched since swap was confirmed.\n\t\t\t * shmem_undo_range() will have done some of the\n\t\t\t * unaccounting, now delete_from_swap_cache() will do\n\t\t\t * the rest.\n\t\t\t * Reset swap.val? No, leave it so \"failed\" goes back to\n\t\t\t * \"repeat\": reading a hole and writing should succeed.\n\t\t\t */\n\t\t\tif (error) {\n\t\t\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t\t\t\tdelete_from_swap_cache(page);\n\t\t\t}\n\t\t}\n\t\tif (error)\n\t\t\tgoto failed;\n\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->swapped--;\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\tmark_page_accessed(page);\n\n\t\tdelete_from_swap_cache(page);\n\t\tset_page_dirty(page);\n\t\tswap_free(swap);\n\n\t} else {\n\t\tif (vma && userfaultfd_missing(vma)) {\n\t\t\t*fault_type = handle_userfault(vmf, VM_UFFD_MISSING);\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* shmem_symlink() */\n\t\tif (mapping->a_ops != &shmem_aops)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_DENY || sgp_huge == SGP_NOHUGE)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\t\tgoto alloc_huge;\n\t\tswitch (sbinfo->huge) {\n\t\t\tloff_t i_size;\n\t\t\tpgoff_t off;\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\tgoto alloc_nohuge;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(index, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* fallthrough */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\tif (sgp_huge == SGP_HUGE)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\tgoto alloc_nohuge;\n\t\t}\n\nalloc_huge:\n\t\tpage = shmem_alloc_and_acct_page(gfp, inode, index, true);\n\t\tif (IS_ERR(page)) {\nalloc_nohuge:\t\tpage = shmem_alloc_and_acct_page(gfp, inode,\n\t\t\t\t\tindex, false);\n\t\t}\n\t\tif (IS_ERR(page)) {\n\t\t\tint retry = 5;\n\t\t\terror = PTR_ERR(page);\n\t\t\tpage = NULL;\n\t\t\tif (error != -ENOSPC)\n\t\t\t\tgoto failed;\n\t\t\t/*\n\t\t\t * Try to reclaim some spece by splitting a huge page\n\t\t\t * beyond i_size on the filesystem.\n\t\t\t */\n\t\t\twhile (retry--) {\n\t\t\t\tint ret;\n\t\t\t\tret = shmem_unused_huge_shrink(sbinfo, NULL, 1);\n\t\t\t\tif (ret == SHRINK_STOP)\n\t\t\t\t\tbreak;\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto alloc_nohuge;\n\t\t\t}\n\t\t\tgoto failed;\n\t\t}\n\n\t\tif (PageTransHuge(page))\n\t\t\thindex = round_down(index, HPAGE_PMD_NR);\n\t\telse\n\t\t\thindex = index;\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\t__SetPageReferenced(page);\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tPageTransHuge(page));\n\t\tif (error)\n\t\t\tgoto unacct;\n\t\terror = shmem_add_to_page_cache(page, mapping, hindex,\n\t\t\t\t\t\tNULL, gfp & GFP_RECLAIM_MASK);\n\t\tif (error) {\n\t\t\tmem_cgroup_cancel_charge(page, memcg,\n\t\t\t\t\tPageTransHuge(page));\n\t\t\tgoto unacct;\n\t\t}\n\t\tmem_cgroup_commit_charge(page, memcg, false,\n\t\t\t\tPageTransHuge(page));\n\t\tlru_cache_add_anon(page);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->alloced += 1 << compound_order(page);\n\t\tinode->i_blocks += BLOCKS_PER_PAGE << compound_order(page);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\talloced = true;\n\n\t\tif (PageTransHuge(page) &&\n\t\t\t\tDIV_ROUND_UP(i_size_read(inode), PAGE_SIZE) <\n\t\t\t\thindex + HPAGE_PMD_NR - 1) {\n\t\t\t/*\n\t\t\t * Part of the huge page is beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t/*\n\t\t\t * _careful to defend against unlocked access to\n\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t */\n\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\n\t\t/*\n\t\t * Let SGP_FALLOC use the SGP_WRITE optimization on a new page.\n\t\t */\n\t\tif (sgp == SGP_FALLOC)\n\t\t\tsgp = SGP_WRITE;\nclear:\n\t\t/*\n\t\t * Let SGP_WRITE caller clear ends if write does not fill page;\n\t\t * but SGP_FALLOC on a page fallocated earlier must initialize\n\t\t * it now, lest undo on failure cancel our earlier guarantee.\n\t\t */\n\t\tif (sgp != SGP_WRITE && !PageUptodate(page)) {\n\t\t\tstruct page *head = compound_head(page);\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < (1 << compound_order(head)); i++) {\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t\tSetPageUptodate(head);\n\t\t}\n\t}\n\n\t/* Perhaps the file has been truncated since we checked */\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\tif (alloced) {\n\t\t\tClearPageDirty(page);\n\t\t\tdelete_from_page_cache(page);\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tshmem_recalc_inode(inode);\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t}\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\t*pagep = page + index - hindex;\n\treturn 0;\n\n\t/*\n\t * Error recovery.\n\t */\nunacct:\n\tshmem_inode_unacct_blocks(inode, 1 << compound_order(page));\n\n\tif (PageTransHuge(page)) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tgoto alloc_nohuge;\n\t}\nfailed:\n\tif (swap.val && !shmem_confirm_swap(mapping, index, swap))\n\t\terror = -EEXIST;\nunlock:\n\tif (page) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tif (error == -ENOSPC && !once++) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\tgoto repeat;\n\t}\n\tif (error == -EEXIST)\n\t\tgoto repeat;\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_huge SHMEM_HUGE_DENY",
            "#define SHMEM_HUGE_FORCE\t(-2)",
            "#define SHMEM_HUGE_DENY\t\t(-1)",
            "#define SHMEM_HUGE_ADVISE\t3",
            "#define SHMEM_HUGE_WITHIN_SIZE\t2",
            "#define SHMEM_HUGE_NEVER\t0",
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_NEVER\t0\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic int shmem_getpage_gfp(struct inode *inode, pgoff_t index,\n\tstruct page **pagep, enum sgp_type sgp, gfp_t gfp,\n\tstruct vm_area_struct *vma, struct vm_fault *vmf,\n\t\t\tvm_fault_t *fault_type)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo;\n\tstruct mm_struct *charge_mm;\n\tstruct mem_cgroup *memcg;\n\tstruct page *page;\n\tswp_entry_t swap;\n\tenum sgp_type sgp_huge = sgp;\n\tpgoff_t hindex = index;\n\tint error;\n\tint once = 0;\n\tint alloced = 0;\n\n\tif (index > (MAX_LFS_FILESIZE >> PAGE_SHIFT))\n\t\treturn -EFBIG;\n\tif (sgp == SGP_NOHUGE || sgp == SGP_HUGE)\n\t\tsgp = SGP_CACHE;\nrepeat:\n\tswap.val = 0;\n\tpage = find_lock_entry(mapping, index);\n\tif (xa_is_value(page)) {\n\t\tswap = radix_to_swp_entry(page);\n\t\tpage = NULL;\n\t}\n\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\n\tif (page && sgp == SGP_WRITE)\n\t\tmark_page_accessed(page);\n\n\t/* fallocated page? */\n\tif (page && !PageUptodate(page)) {\n\t\tif (sgp != SGP_READ)\n\t\t\tgoto clear;\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tpage = NULL;\n\t}\n\tif (page || (sgp == SGP_READ && !swap.val)) {\n\t\t*pagep = page;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Fast cache lookup did not find it:\n\t * bring it back from swap or allocate.\n\t */\n\tsbinfo = SHMEM_SB(inode->i_sb);\n\tcharge_mm = vma ? vma->vm_mm : current->mm;\n\n\tif (swap.val) {\n\t\t/* Look it up and read it in.. */\n\t\tpage = lookup_swap_cache(swap, NULL, 0);\n\t\tif (!page) {\n\t\t\t/* Or update major stats only when swapin succeeds?? */\n\t\t\tif (fault_type) {\n\t\t\t\t*fault_type |= VM_FAULT_MAJOR;\n\t\t\t\tcount_vm_event(PGMAJFAULT);\n\t\t\t\tcount_memcg_event_mm(charge_mm, PGMAJFAULT);\n\t\t\t}\n\t\t\t/* Here we actually start the io */\n\t\t\tpage = shmem_swapin(swap, gfp, info, index);\n\t\t\tif (!page) {\n\t\t\t\terror = -ENOMEM;\n\t\t\t\tgoto failed;\n\t\t\t}\n\t\t}\n\n\t\t/* We have to do this with page locked to prevent races */\n\t\tlock_page(page);\n\t\tif (!PageSwapCache(page) || page_private(page) != swap.val ||\n\t\t    !shmem_confirm_swap(mapping, index, swap)) {\n\t\t\terror = -EEXIST;\t/* try again */\n\t\t\tgoto unlock;\n\t\t}\n\t\tif (!PageUptodate(page)) {\n\t\t\terror = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t\twait_on_page_writeback(page);\n\n\t\tif (shmem_should_replace_page(page, gfp)) {\n\t\t\terror = shmem_replace_page(&page, gfp, info, index);\n\t\t\tif (error)\n\t\t\t\tgoto failed;\n\t\t}\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tfalse);\n\t\tif (!error) {\n\t\t\terror = shmem_add_to_page_cache(page, mapping, index,\n\t\t\t\t\t\tswp_to_radix_entry(swap), gfp);\n\t\t\t/*\n\t\t\t * We already confirmed swap under page lock, and make\n\t\t\t * no memory allocation here, so usually no possibility\n\t\t\t * of error; but free_swap_and_cache() only trylocks a\n\t\t\t * page, so it is just possible that the entry has been\n\t\t\t * truncated or holepunched since swap was confirmed.\n\t\t\t * shmem_undo_range() will have done some of the\n\t\t\t * unaccounting, now delete_from_swap_cache() will do\n\t\t\t * the rest.\n\t\t\t * Reset swap.val? No, leave it so \"failed\" goes back to\n\t\t\t * \"repeat\": reading a hole and writing should succeed.\n\t\t\t */\n\t\t\tif (error) {\n\t\t\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t\t\t\tdelete_from_swap_cache(page);\n\t\t\t}\n\t\t}\n\t\tif (error)\n\t\t\tgoto failed;\n\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->swapped--;\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\tmark_page_accessed(page);\n\n\t\tdelete_from_swap_cache(page);\n\t\tset_page_dirty(page);\n\t\tswap_free(swap);\n\n\t} else {\n\t\tif (vma && userfaultfd_missing(vma)) {\n\t\t\t*fault_type = handle_userfault(vmf, VM_UFFD_MISSING);\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* shmem_symlink() */\n\t\tif (mapping->a_ops != &shmem_aops)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_DENY || sgp_huge == SGP_NOHUGE)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\t\tgoto alloc_huge;\n\t\tswitch (sbinfo->huge) {\n\t\t\tloff_t i_size;\n\t\t\tpgoff_t off;\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\tgoto alloc_nohuge;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(index, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* fallthrough */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\tif (sgp_huge == SGP_HUGE)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\tgoto alloc_nohuge;\n\t\t}\n\nalloc_huge:\n\t\tpage = shmem_alloc_and_acct_page(gfp, inode, index, true);\n\t\tif (IS_ERR(page)) {\nalloc_nohuge:\t\tpage = shmem_alloc_and_acct_page(gfp, inode,\n\t\t\t\t\tindex, false);\n\t\t}\n\t\tif (IS_ERR(page)) {\n\t\t\tint retry = 5;\n\t\t\terror = PTR_ERR(page);\n\t\t\tpage = NULL;\n\t\t\tif (error != -ENOSPC)\n\t\t\t\tgoto failed;\n\t\t\t/*\n\t\t\t * Try to reclaim some spece by splitting a huge page\n\t\t\t * beyond i_size on the filesystem.\n\t\t\t */\n\t\t\twhile (retry--) {\n\t\t\t\tint ret;\n\t\t\t\tret = shmem_unused_huge_shrink(sbinfo, NULL, 1);\n\t\t\t\tif (ret == SHRINK_STOP)\n\t\t\t\t\tbreak;\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto alloc_nohuge;\n\t\t\t}\n\t\t\tgoto failed;\n\t\t}\n\n\t\tif (PageTransHuge(page))\n\t\t\thindex = round_down(index, HPAGE_PMD_NR);\n\t\telse\n\t\t\thindex = index;\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\t__SetPageReferenced(page);\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tPageTransHuge(page));\n\t\tif (error)\n\t\t\tgoto unacct;\n\t\terror = shmem_add_to_page_cache(page, mapping, hindex,\n\t\t\t\t\t\tNULL, gfp & GFP_RECLAIM_MASK);\n\t\tif (error) {\n\t\t\tmem_cgroup_cancel_charge(page, memcg,\n\t\t\t\t\tPageTransHuge(page));\n\t\t\tgoto unacct;\n\t\t}\n\t\tmem_cgroup_commit_charge(page, memcg, false,\n\t\t\t\tPageTransHuge(page));\n\t\tlru_cache_add_anon(page);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->alloced += 1 << compound_order(page);\n\t\tinode->i_blocks += BLOCKS_PER_PAGE << compound_order(page);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\talloced = true;\n\n\t\tif (PageTransHuge(page) &&\n\t\t\t\tDIV_ROUND_UP(i_size_read(inode), PAGE_SIZE) <\n\t\t\t\thindex + HPAGE_PMD_NR - 1) {\n\t\t\t/*\n\t\t\t * Part of the huge page is beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t/*\n\t\t\t * _careful to defend against unlocked access to\n\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t */\n\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\n\t\t/*\n\t\t * Let SGP_FALLOC use the SGP_WRITE optimization on a new page.\n\t\t */\n\t\tif (sgp == SGP_FALLOC)\n\t\t\tsgp = SGP_WRITE;\nclear:\n\t\t/*\n\t\t * Let SGP_WRITE caller clear ends if write does not fill page;\n\t\t * but SGP_FALLOC on a page fallocated earlier must initialize\n\t\t * it now, lest undo on failure cancel our earlier guarantee.\n\t\t */\n\t\tif (sgp != SGP_WRITE && !PageUptodate(page)) {\n\t\t\tstruct page *head = compound_head(page);\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < (1 << compound_order(head)); i++) {\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t\tSetPageUptodate(head);\n\t\t}\n\t}\n\n\t/* Perhaps the file has been truncated since we checked */\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\tif (alloced) {\n\t\t\tClearPageDirty(page);\n\t\t\tdelete_from_page_cache(page);\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tshmem_recalc_inode(inode);\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t}\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\t*pagep = page + index - hindex;\n\treturn 0;\n\n\t/*\n\t * Error recovery.\n\t */\nunacct:\n\tshmem_inode_unacct_blocks(inode, 1 << compound_order(page));\n\n\tif (PageTransHuge(page)) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tgoto alloc_nohuge;\n\t}\nfailed:\n\tif (swap.val && !shmem_confirm_swap(mapping, index, swap))\n\t\terror = -EEXIST;\nunlock:\n\tif (page) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tif (error == -ENOSPC && !once++) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\tgoto repeat;\n\t}\n\tif (error == -EEXIST)\n\t\tgoto repeat;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "MMF_DISABLE_THP",
            "&vma->vm_mm->flags"
          ],
          "line": 1979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "finish_wait",
          "args": [
            "shmem_falloc_waitq",
            "&shmem_fault_wait"
          ],
          "line": 1969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedule",
          "args": [],
          "line": 1959
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_schedule_balance_work",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "191-195",
          "snippet": "static void pcpu_schedule_balance_work(void)\n{\n\tif (pcpu_async_enabled)\n\t\tschedule_work(&pcpu_balance_work);\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool pcpu_async_enabled"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic bool pcpu_async_enabled;\n\nstatic void pcpu_schedule_balance_work(void)\n{\n\tif (pcpu_async_enabled)\n\t\tschedule_work(&pcpu_balance_work);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_to_wait",
          "args": [
            "shmem_falloc_waitq",
            "&shmem_fault_wait",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 1956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up_read",
          "args": [
            "&vma->vm_mm->mmap_sem"
          ],
          "line": 1951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEFINE_WAIT_FUNC",
          "args": [
            "shmem_fault_wait",
            "synchronous_wake_function"
          ],
          "line": 1945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "inode->i_private"
          ],
          "line": 1935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapping_gfp_mask",
          "args": [
            "inode->i_mapping"
          ],
          "line": 1913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "vma->vm_file"
          ],
          "line": 1912
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic vm_fault_t shmem_fault(struct vm_fault *vmf)\n{\n\tstruct vm_area_struct *vma = vmf->vma;\n\tstruct inode *inode = file_inode(vma->vm_file);\n\tgfp_t gfp = mapping_gfp_mask(inode->i_mapping);\n\tenum sgp_type sgp;\n\tint err;\n\tvm_fault_t ret = VM_FAULT_LOCKED;\n\n\t/*\n\t * Trinity finds that probing a hole which tmpfs is punching can\n\t * prevent the hole-punch from ever completing: which in turn\n\t * locks writers out with its hold on i_mutex.  So refrain from\n\t * faulting pages into the hole while it's being punched.  Although\n\t * shmem_undo_range() does remove the additions, it may be unable to\n\t * keep up, as each new page needs its own unmap_mapping_range() call,\n\t * and the i_mmap tree grows ever slower to scan if new vmas are added.\n\t *\n\t * It does not matter if we sometimes reach this check just before the\n\t * hole-punch begins, so that one fault then races with the punch:\n\t * we just need to make racing faults a rare case.\n\t *\n\t * The implementation below would be much simpler if we just used a\n\t * standard mutex or completion: but we cannot take i_mutex in fault,\n\t * and bloating every shmem inode for this unlikely case would be sad.\n\t */\n\tif (unlikely(inode->i_private)) {\n\t\tstruct shmem_falloc *shmem_falloc;\n\n\t\tspin_lock(&inode->i_lock);\n\t\tshmem_falloc = inode->i_private;\n\t\tif (shmem_falloc &&\n\t\t    shmem_falloc->waitq &&\n\t\t    vmf->pgoff >= shmem_falloc->start &&\n\t\t    vmf->pgoff < shmem_falloc->next) {\n\t\t\twait_queue_head_t *shmem_falloc_waitq;\n\t\t\tDEFINE_WAIT_FUNC(shmem_fault_wait, synchronous_wake_function);\n\n\t\t\tret = VM_FAULT_NOPAGE;\n\t\t\tif ((vmf->flags & FAULT_FLAG_ALLOW_RETRY) &&\n\t\t\t   !(vmf->flags & FAULT_FLAG_RETRY_NOWAIT)) {\n\t\t\t\t/* It's polite to up mmap_sem if we can */\n\t\t\t\tup_read(&vma->vm_mm->mmap_sem);\n\t\t\t\tret = VM_FAULT_RETRY;\n\t\t\t}\n\n\t\t\tshmem_falloc_waitq = shmem_falloc->waitq;\n\t\t\tprepare_to_wait(shmem_falloc_waitq, &shmem_fault_wait,\n\t\t\t\t\tTASK_UNINTERRUPTIBLE);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tschedule();\n\n\t\t\t/*\n\t\t\t * shmem_falloc_waitq points into the shmem_fallocate()\n\t\t\t * stack of the hole-punching task: shmem_falloc_waitq\n\t\t\t * is usually invalid by the time we reach here, but\n\t\t\t * finish_wait() does not dereference it in that case;\n\t\t\t * though i_lock needed lest racing with wake_up_all().\n\t\t\t */\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tfinish_wait(shmem_falloc_waitq, &shmem_fault_wait);\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\treturn ret;\n\t\t}\n\t\tspin_unlock(&inode->i_lock);\n\t}\n\n\tsgp = SGP_CACHE;\n\n\tif ((vma->vm_flags & VM_NOHUGEPAGE) ||\n\t    test_bit(MMF_DISABLE_THP, &vma->vm_mm->flags))\n\t\tsgp = SGP_NOHUGE;\n\telse if (vma->vm_flags & VM_HUGEPAGE)\n\t\tsgp = SGP_HUGE;\n\n\terr = shmem_getpage_gfp(inode, vmf->pgoff, &vmf->page, sgp,\n\t\t\t\t  gfp, vma, vmf, &ret);\n\tif (err)\n\t\treturn vmf_error(err);\n\treturn ret;\n}"
  },
  {
    "function_name": "synchronous_wake_function",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1902-1907",
    "snippet": "static int synchronous_wake_function(wait_queue_entry_t *wait, unsigned mode, int sync, void *key)\n{\n\tint ret = default_wake_function(wait, mode, sync, key);\n\tlist_del_init(&wait->entry);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&wait->entry"
          ],
          "line": 1905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "default_wake_function",
          "args": [
            "wait",
            "mode",
            "sync",
            "key"
          ],
          "line": 1904
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int synchronous_wake_function(wait_queue_entry_t *wait, unsigned mode, int sync, void *key)\n{\n\tint ret = default_wake_function(wait, mode, sync, key);\n\tlist_del_init(&wait->entry);\n\treturn ret;\n}"
  },
  {
    "function_name": "shmem_getpage_gfp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1584-1895",
    "snippet": "static int shmem_getpage_gfp(struct inode *inode, pgoff_t index,\n\tstruct page **pagep, enum sgp_type sgp, gfp_t gfp,\n\tstruct vm_area_struct *vma, struct vm_fault *vmf,\n\t\t\tvm_fault_t *fault_type)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo;\n\tstruct mm_struct *charge_mm;\n\tstruct mem_cgroup *memcg;\n\tstruct page *page;\n\tswp_entry_t swap;\n\tenum sgp_type sgp_huge = sgp;\n\tpgoff_t hindex = index;\n\tint error;\n\tint once = 0;\n\tint alloced = 0;\n\n\tif (index > (MAX_LFS_FILESIZE >> PAGE_SHIFT))\n\t\treturn -EFBIG;\n\tif (sgp == SGP_NOHUGE || sgp == SGP_HUGE)\n\t\tsgp = SGP_CACHE;\nrepeat:\n\tswap.val = 0;\n\tpage = find_lock_entry(mapping, index);\n\tif (xa_is_value(page)) {\n\t\tswap = radix_to_swp_entry(page);\n\t\tpage = NULL;\n\t}\n\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\n\tif (page && sgp == SGP_WRITE)\n\t\tmark_page_accessed(page);\n\n\t/* fallocated page? */\n\tif (page && !PageUptodate(page)) {\n\t\tif (sgp != SGP_READ)\n\t\t\tgoto clear;\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tpage = NULL;\n\t}\n\tif (page || (sgp == SGP_READ && !swap.val)) {\n\t\t*pagep = page;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Fast cache lookup did not find it:\n\t * bring it back from swap or allocate.\n\t */\n\tsbinfo = SHMEM_SB(inode->i_sb);\n\tcharge_mm = vma ? vma->vm_mm : current->mm;\n\n\tif (swap.val) {\n\t\t/* Look it up and read it in.. */\n\t\tpage = lookup_swap_cache(swap, NULL, 0);\n\t\tif (!page) {\n\t\t\t/* Or update major stats only when swapin succeeds?? */\n\t\t\tif (fault_type) {\n\t\t\t\t*fault_type |= VM_FAULT_MAJOR;\n\t\t\t\tcount_vm_event(PGMAJFAULT);\n\t\t\t\tcount_memcg_event_mm(charge_mm, PGMAJFAULT);\n\t\t\t}\n\t\t\t/* Here we actually start the io */\n\t\t\tpage = shmem_swapin(swap, gfp, info, index);\n\t\t\tif (!page) {\n\t\t\t\terror = -ENOMEM;\n\t\t\t\tgoto failed;\n\t\t\t}\n\t\t}\n\n\t\t/* We have to do this with page locked to prevent races */\n\t\tlock_page(page);\n\t\tif (!PageSwapCache(page) || page_private(page) != swap.val ||\n\t\t    !shmem_confirm_swap(mapping, index, swap)) {\n\t\t\terror = -EEXIST;\t/* try again */\n\t\t\tgoto unlock;\n\t\t}\n\t\tif (!PageUptodate(page)) {\n\t\t\terror = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t\twait_on_page_writeback(page);\n\n\t\tif (shmem_should_replace_page(page, gfp)) {\n\t\t\terror = shmem_replace_page(&page, gfp, info, index);\n\t\t\tif (error)\n\t\t\t\tgoto failed;\n\t\t}\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tfalse);\n\t\tif (!error) {\n\t\t\terror = shmem_add_to_page_cache(page, mapping, index,\n\t\t\t\t\t\tswp_to_radix_entry(swap), gfp);\n\t\t\t/*\n\t\t\t * We already confirmed swap under page lock, and make\n\t\t\t * no memory allocation here, so usually no possibility\n\t\t\t * of error; but free_swap_and_cache() only trylocks a\n\t\t\t * page, so it is just possible that the entry has been\n\t\t\t * truncated or holepunched since swap was confirmed.\n\t\t\t * shmem_undo_range() will have done some of the\n\t\t\t * unaccounting, now delete_from_swap_cache() will do\n\t\t\t * the rest.\n\t\t\t * Reset swap.val? No, leave it so \"failed\" goes back to\n\t\t\t * \"repeat\": reading a hole and writing should succeed.\n\t\t\t */\n\t\t\tif (error) {\n\t\t\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t\t\t\tdelete_from_swap_cache(page);\n\t\t\t}\n\t\t}\n\t\tif (error)\n\t\t\tgoto failed;\n\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->swapped--;\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\tmark_page_accessed(page);\n\n\t\tdelete_from_swap_cache(page);\n\t\tset_page_dirty(page);\n\t\tswap_free(swap);\n\n\t} else {\n\t\tif (vma && userfaultfd_missing(vma)) {\n\t\t\t*fault_type = handle_userfault(vmf, VM_UFFD_MISSING);\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* shmem_symlink() */\n\t\tif (mapping->a_ops != &shmem_aops)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_DENY || sgp_huge == SGP_NOHUGE)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\t\tgoto alloc_huge;\n\t\tswitch (sbinfo->huge) {\n\t\t\tloff_t i_size;\n\t\t\tpgoff_t off;\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\tgoto alloc_nohuge;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(index, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* fallthrough */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\tif (sgp_huge == SGP_HUGE)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\tgoto alloc_nohuge;\n\t\t}\n\nalloc_huge:\n\t\tpage = shmem_alloc_and_acct_page(gfp, inode, index, true);\n\t\tif (IS_ERR(page)) {\nalloc_nohuge:\t\tpage = shmem_alloc_and_acct_page(gfp, inode,\n\t\t\t\t\tindex, false);\n\t\t}\n\t\tif (IS_ERR(page)) {\n\t\t\tint retry = 5;\n\t\t\terror = PTR_ERR(page);\n\t\t\tpage = NULL;\n\t\t\tif (error != -ENOSPC)\n\t\t\t\tgoto failed;\n\t\t\t/*\n\t\t\t * Try to reclaim some spece by splitting a huge page\n\t\t\t * beyond i_size on the filesystem.\n\t\t\t */\n\t\t\twhile (retry--) {\n\t\t\t\tint ret;\n\t\t\t\tret = shmem_unused_huge_shrink(sbinfo, NULL, 1);\n\t\t\t\tif (ret == SHRINK_STOP)\n\t\t\t\t\tbreak;\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto alloc_nohuge;\n\t\t\t}\n\t\t\tgoto failed;\n\t\t}\n\n\t\tif (PageTransHuge(page))\n\t\t\thindex = round_down(index, HPAGE_PMD_NR);\n\t\telse\n\t\t\thindex = index;\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\t__SetPageReferenced(page);\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tPageTransHuge(page));\n\t\tif (error)\n\t\t\tgoto unacct;\n\t\terror = shmem_add_to_page_cache(page, mapping, hindex,\n\t\t\t\t\t\tNULL, gfp & GFP_RECLAIM_MASK);\n\t\tif (error) {\n\t\t\tmem_cgroup_cancel_charge(page, memcg,\n\t\t\t\t\tPageTransHuge(page));\n\t\t\tgoto unacct;\n\t\t}\n\t\tmem_cgroup_commit_charge(page, memcg, false,\n\t\t\t\tPageTransHuge(page));\n\t\tlru_cache_add_anon(page);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->alloced += 1 << compound_order(page);\n\t\tinode->i_blocks += BLOCKS_PER_PAGE << compound_order(page);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\talloced = true;\n\n\t\tif (PageTransHuge(page) &&\n\t\t\t\tDIV_ROUND_UP(i_size_read(inode), PAGE_SIZE) <\n\t\t\t\thindex + HPAGE_PMD_NR - 1) {\n\t\t\t/*\n\t\t\t * Part of the huge page is beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t/*\n\t\t\t * _careful to defend against unlocked access to\n\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t */\n\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\n\t\t/*\n\t\t * Let SGP_FALLOC use the SGP_WRITE optimization on a new page.\n\t\t */\n\t\tif (sgp == SGP_FALLOC)\n\t\t\tsgp = SGP_WRITE;\nclear:\n\t\t/*\n\t\t * Let SGP_WRITE caller clear ends if write does not fill page;\n\t\t * but SGP_FALLOC on a page fallocated earlier must initialize\n\t\t * it now, lest undo on failure cancel our earlier guarantee.\n\t\t */\n\t\tif (sgp != SGP_WRITE && !PageUptodate(page)) {\n\t\t\tstruct page *head = compound_head(page);\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < (1 << compound_order(head)); i++) {\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t\tSetPageUptodate(head);\n\t\t}\n\t}\n\n\t/* Perhaps the file has been truncated since we checked */\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\tif (alloced) {\n\t\t\tClearPageDirty(page);\n\t\t\tdelete_from_page_cache(page);\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tshmem_recalc_inode(inode);\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t}\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\t*pagep = page + index - hindex;\n\treturn 0;\n\n\t/*\n\t * Error recovery.\n\t */\nunacct:\n\tshmem_inode_unacct_blocks(inode, 1 << compound_order(page));\n\n\tif (PageTransHuge(page)) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tgoto alloc_nohuge;\n\t}\nfailed:\n\tif (swap.val && !shmem_confirm_swap(mapping, index, swap))\n\t\terror = -EEXIST;\nunlock:\n\tif (page) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tif (error == -ENOSPC && !once++) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\tgoto repeat;\n\t}\n\tif (error == -EEXIST)\n\t\tgoto repeat;\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_huge SHMEM_HUGE_DENY",
      "#define SHMEM_HUGE_FORCE\t(-2)",
      "#define SHMEM_HUGE_DENY\t\t(-1)",
      "#define SHMEM_HUGE_ADVISE\t3",
      "#define SHMEM_HUGE_WITHIN_SIZE\t2",
      "#define SHMEM_HUGE_NEVER\t0",
      "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_recalc_inode",
          "args": [
            "inode"
          ],
          "line": 1888
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_recalc_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "279-290",
          "snippet": "static void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 1884
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 1883
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_confirm_swap",
          "args": [
            "mapping",
            "index",
            "swap"
          ],
          "line": 1879
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_confirm_swap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "349-353",
          "snippet": "static bool shmem_confirm_swap(struct address_space *mapping,\n\t\t\t       pgoff_t index, swp_entry_t swap)\n{\n\treturn xa_load(&mapping->i_pages, index) == swp_to_radix_entry(swap);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic bool shmem_confirm_swap(struct address_space *mapping,\n\t\t\t       pgoff_t index, swp_entry_t swap)\n{\n\treturn xa_load(&mapping->i_pages, index) == swp_to_radix_entry(swap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 1873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_inode_unacct_blocks",
          "args": [
            "inode",
            "1 << compound_order(page)"
          ],
          "line": 1871
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_inode_unacct_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "215-223",
          "snippet": "static inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}"
        }
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "page"
          ],
          "line": 1871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "delete_from_page_cache",
          "args": [
            "page"
          ],
          "line": 1856
        },
        "resolved": true,
        "details": {
          "function_name": "delete_from_page_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/filemap.c",
          "lines": "262-273",
          "snippet": "void delete_from_page_cache(struct page *page)\n{\n\tstruct address_space *mapping = page_mapping(page);\n\tunsigned long flags;\n\n\tBUG_ON(!PageLocked(page));\n\txa_lock_irqsave(&mapping->i_pages, flags);\n\t__delete_from_page_cache(page, NULL);\n\txa_unlock_irqrestore(&mapping->i_pages, flags);\n\n\tpage_cache_free_page(mapping, page);\n}",
          "includes": [
            "#include <asm/mman.h>",
            "#include <linux/buffer_head.h> /* for try_to_free_buffers */",
            "#include <trace/events/filemap.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/rmap.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/security.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/hash.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/capability.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/fs.h>",
            "#include <linux/dax.h>",
            "#include <linux/compiler.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/mman.h>\n#include <linux/buffer_head.h> /* for try_to_free_buffers */\n#include <trace/events/filemap.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/delayacct.h>\n#include <linux/rmap.h>\n#include <linux/shmem_fs.h>\n#include <linux/cleancache.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/cpuset.h>\n#include <linux/security.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/hash.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/capability.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/dax.h>\n#include <linux/compiler.h>\n#include <linux/export.h>\n\nvoid delete_from_page_cache(struct page *page)\n{\n\tstruct address_space *mapping = page_mapping(page);\n\tunsigned long flags;\n\n\tBUG_ON(!PageLocked(page));\n\txa_lock_irqsave(&mapping->i_pages, flags);\n\t__delete_from_page_cache(page, NULL);\n\txa_unlock_irqrestore(&mapping->i_pages, flags);\n\n\tpage_cache_free_page(mapping, page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ClearPageDirty",
          "args": [
            "page"
          ],
          "line": 1855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetPageUptodate",
          "args": [
            "head"
          ],
          "line": 1847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_dcache_page",
          "args": [
            "head + i"
          ],
          "line": 1845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "head + i"
          ],
          "line": 1844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "head"
          ],
          "line": 1843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compound_head",
          "args": [
            "page"
          ],
          "line": 1840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 1839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 1825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&info->shrinklist",
            "&sbinfo->shrinklist"
          ],
          "line": 1821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty_careful",
          "args": [
            "&info->shrinklist"
          ],
          "line": 1820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 1815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "i_size_read(inode)",
            "PAGE_SIZE"
          ],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 1808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "page"
          ],
          "line": 1803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "page"
          ],
          "line": 1802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lru_cache_add_anon",
          "args": [
            "page"
          ],
          "line": 1799
        },
        "resolved": true,
        "details": {
          "function_name": "lru_cache_add_anon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "417-422",
          "snippet": "void lru_cache_add_anon(struct page *page)\n{\n\tif (PageActive(page))\n\t\tClearPageActive(page);\n\t__lru_cache_add(page);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid lru_cache_add_anon(struct page *page)\n{\n\tif (PageActive(page))\n\t\tClearPageActive(page);\n\t__lru_cache_add(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mem_cgroup_commit_charge",
          "args": [
            "page",
            "memcg",
            "false",
            "PageTransHuge(page)"
          ],
          "line": 1797
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_commit_charge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5928-5962",
          "snippet": "void mem_cgroup_commit_charge(struct page *page, struct mem_cgroup *memcg,\n\t\t\t      bool lrucare, bool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tVM_BUG_ON_PAGE(!page->mapping, page);\n\tVM_BUG_ON_PAGE(PageLRU(page) && !lrucare, page);\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcommit_charge(page, memcg, lrucare);\n\n\tlocal_irq_disable();\n\tmem_cgroup_charge_statistics(memcg, page, compound, nr_pages);\n\tmemcg_check_events(memcg, page);\n\tlocal_irq_enable();\n\n\tif (do_memsw_account() && PageSwapCache(page)) {\n\t\tswp_entry_t entry = { .val = page_private(page) };\n\t\t/*\n\t\t * The swap entry might not get freed for a long time,\n\t\t * let's not wait for it.  The page already received a\n\t\t * memory+swap charge, drop the swap entry duplicate.\n\t\t */\n\t\tmem_cgroup_uncharge_swap(entry, nr_pages);\n\t}\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nvoid mem_cgroup_commit_charge(struct page *page, struct mem_cgroup *memcg,\n\t\t\t      bool lrucare, bool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tVM_BUG_ON_PAGE(!page->mapping, page);\n\tVM_BUG_ON_PAGE(PageLRU(page) && !lrucare, page);\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcommit_charge(page, memcg, lrucare);\n\n\tlocal_irq_disable();\n\tmem_cgroup_charge_statistics(memcg, page, compound, nr_pages);\n\tmemcg_check_events(memcg, page);\n\tlocal_irq_enable();\n\n\tif (do_memsw_account() && PageSwapCache(page)) {\n\t\tswp_entry_t entry = { .val = page_private(page) };\n\t\t/*\n\t\t * The swap entry might not get freed for a long time,\n\t\t * let's not wait for it.  The page already received a\n\t\t * memory+swap charge, drop the swap entry duplicate.\n\t\t */\n\t\tmem_cgroup_uncharge_swap(entry, nr_pages);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 1798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cgroup_cancel_charge",
          "args": [
            "page",
            "memcg",
            "PageTransHuge(page)"
          ],
          "line": 1793
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_cancel_charge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5972-5988",
          "snippet": "void mem_cgroup_cancel_charge(struct page *page, struct mem_cgroup *memcg,\n\t\tbool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcancel_charge(memcg, nr_pages);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nvoid mem_cgroup_cancel_charge(struct page *page, struct mem_cgroup *memcg,\n\t\tbool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcancel_charge(memcg, nr_pages);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 1794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_add_to_page_cache",
          "args": [
            "page",
            "mapping",
            "hindex",
            "NULL",
            "gfp & GFP_RECLAIM_MASK"
          ],
          "line": 1790
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_add_to_page_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "578-629",
          "snippet": "static int shmem_add_to_page_cache(struct page *page,\n\t\t\t\t   struct address_space *mapping,\n\t\t\t\t   pgoff_t index, void *expected, gfp_t gfp)\n{\n\tXA_STATE_ORDER(xas, &mapping->i_pages, index, compound_order(page));\n\tunsigned long i = 0;\n\tunsigned long nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(PageTail(page), page);\n\tVM_BUG_ON_PAGE(index != round_down(index, nr), page);\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\tVM_BUG_ON(expected && PageTransHuge(page));\n\n\tpage_ref_add(page, nr);\n\tpage->mapping = mapping;\n\tpage->index = index;\n\n\tdo {\n\t\tvoid *entry;\n\t\txas_lock_irq(&xas);\n\t\tentry = xas_find_conflict(&xas);\n\t\tif (entry != expected)\n\t\t\txas_set_err(&xas, -EEXIST);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\nnext:\n\t\txas_store(&xas, page + i);\n\t\tif (++i < nr) {\n\t\t\txas_next(&xas);\n\t\t\tgoto next;\n\t\t}\n\t\tif (PageTransHuge(page)) {\n\t\t\tcount_vm_event(THP_FILE_ALLOC);\n\t\t\t__inc_node_page_state(page, NR_SHMEM_THPS);\n\t\t}\n\t\tmapping->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\t__mod_node_page_state(page_pgdat(page), NR_SHMEM, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (xas_error(&xas)) {\n\t\tpage->mapping = NULL;\n\t\tpage_ref_sub(page, nr);\n\t\treturn xas_error(&xas);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_add_to_page_cache(struct page *page,\n\t\t\t\t   struct address_space *mapping,\n\t\t\t\t   pgoff_t index, void *expected, gfp_t gfp)\n{\n\tXA_STATE_ORDER(xas, &mapping->i_pages, index, compound_order(page));\n\tunsigned long i = 0;\n\tunsigned long nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(PageTail(page), page);\n\tVM_BUG_ON_PAGE(index != round_down(index, nr), page);\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\tVM_BUG_ON(expected && PageTransHuge(page));\n\n\tpage_ref_add(page, nr);\n\tpage->mapping = mapping;\n\tpage->index = index;\n\n\tdo {\n\t\tvoid *entry;\n\t\txas_lock_irq(&xas);\n\t\tentry = xas_find_conflict(&xas);\n\t\tif (entry != expected)\n\t\t\txas_set_err(&xas, -EEXIST);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\nnext:\n\t\txas_store(&xas, page + i);\n\t\tif (++i < nr) {\n\t\t\txas_next(&xas);\n\t\t\tgoto next;\n\t\t}\n\t\tif (PageTransHuge(page)) {\n\t\t\tcount_vm_event(THP_FILE_ALLOC);\n\t\t\t__inc_node_page_state(page, NR_SHMEM_THPS);\n\t\t}\n\t\tmapping->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\t__mod_node_page_state(page_pgdat(page), NR_SHMEM, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (xas_error(&xas)) {\n\t\tpage->mapping = NULL;\n\t\tpage_ref_sub(page, nr);\n\t\treturn xas_error(&xas);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mem_cgroup_try_charge_delay",
          "args": [
            "page",
            "charge_mm",
            "gfp",
            "&memcg",
            "PageTransHuge(page)"
          ],
          "line": 1786
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_try_charge_delay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5898-5909",
          "snippet": "int mem_cgroup_try_charge_delay(struct page *page, struct mm_struct *mm,\n\t\t\t  gfp_t gfp_mask, struct mem_cgroup **memcgp,\n\t\t\t  bool compound)\n{\n\tstruct mem_cgroup *memcg;\n\tint ret;\n\n\tret = mem_cgroup_try_charge(page, mm, gfp_mask, memcgp, compound);\n\tmemcg = *memcgp;\n\tmem_cgroup_throttle_swaprate(memcg, page_to_nid(page), gfp_mask);\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nint mem_cgroup_try_charge_delay(struct page *page, struct mm_struct *mm,\n\t\t\t  gfp_t gfp_mask, struct mem_cgroup **memcgp,\n\t\t\t  bool compound)\n{\n\tstruct mem_cgroup *memcg;\n\tint ret;\n\n\tret = mem_cgroup_try_charge(page, mm, gfp_mask, memcgp, compound);\n\tmemcg = *memcgp;\n\tmem_cgroup_throttle_swaprate(memcg, page_to_nid(page), gfp_mask);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 1787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__SetPageReferenced",
          "args": [
            "page"
          ],
          "line": 1784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "index",
            "HPAGE_PMD_NR"
          ],
          "line": 1779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 1778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_unused_huge_shrink",
          "args": [
            "sbinfo",
            "NULL",
            "1"
          ],
          "line": 1769
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unused_huge_shrink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "559-563",
          "snippet": "static unsigned long shmem_unused_huge_shrink(struct shmem_sb_info *sbinfo,\n\t\tstruct shrink_control *sc, unsigned long nr_to_split)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_unused_huge_shrink(struct shmem_sb_info *sbinfo,\n\t\tstruct shrink_control *sc, unsigned long nr_to_split)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "page"
          ],
          "line": 1759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "page"
          ],
          "line": 1757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_alloc_and_acct_page",
          "args": [
            "gfp",
            "inode",
            "index",
            "false"
          ],
          "line": 1754
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_alloc_and_acct_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1458-1488",
          "snippet": "static struct page *shmem_alloc_and_acct_page(gfp_t gfp,\n\t\tstruct inode *inode,\n\t\tpgoff_t index, bool huge)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct page *page;\n\tint nr;\n\tint err = -ENOSPC;\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\thuge = false;\n\tnr = huge ? HPAGE_PMD_NR : 1;\n\n\tif (!shmem_inode_acct_block(inode, nr))\n\t\tgoto failed;\n\n\tif (huge)\n\t\tpage = shmem_alloc_hugepage(gfp, info, index);\n\telse\n\t\tpage = shmem_alloc_page(gfp, info, index);\n\tif (page) {\n\t\t__SetPageLocked(page);\n\t\t__SetPageSwapBacked(page);\n\t\treturn page;\n\t}\n\n\terr = -ENOMEM;\n\tshmem_inode_unacct_blocks(inode, nr);\nfailed:\n\treturn ERR_PTR(err);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_alloc_and_acct_page(gfp_t gfp,\n\t\tstruct inode *inode,\n\t\tpgoff_t index, bool huge)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct page *page;\n\tint nr;\n\tint err = -ENOSPC;\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\thuge = false;\n\tnr = huge ? HPAGE_PMD_NR : 1;\n\n\tif (!shmem_inode_acct_block(inode, nr))\n\t\tgoto failed;\n\n\tif (huge)\n\t\tpage = shmem_alloc_hugepage(gfp, info, index);\n\telse\n\t\tpage = shmem_alloc_page(gfp, info, index);\n\tif (page) {\n\t\t__SetPageLocked(page);\n\t\t__SetPageSwapBacked(page);\n\t\treturn page;\n\t}\n\n\terr = -ENOMEM;\n\tshmem_inode_unacct_blocks(inode, nr);\nfailed:\n\treturn ERR_PTR(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "page"
          ],
          "line": 1753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "i_size_read(inode)",
            "PAGE_SIZE"
          ],
          "line": 1739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "index",
            "HPAGE_PMD_NR"
          ],
          "line": 1738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "handle_userfault",
          "args": [
            "vmf",
            "VM_UFFD_MISSING"
          ],
          "line": 1721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "userfaultfd_missing",
          "args": [
            "vma"
          ],
          "line": 1720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swap_free",
          "args": [
            "swap"
          ],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "swap_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "1213-1220",
          "snippet": "void swap_free(swp_entry_t entry)\n{\n\tstruct swap_info_struct *p;\n\n\tp = _swap_info_get(entry);\n\tif (p)\n\t\t__swap_entry_free(p, entry, 1);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_swap_count_continuations(struct swap_info_struct *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic void free_swap_count_continuations(struct swap_info_struct *);\n\nvoid swap_free(swp_entry_t entry)\n{\n\tstruct swap_info_struct *p;\n\n\tp = _swap_info_get(entry);\n\tif (p)\n\t\t__swap_entry_free(p, entry, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "page"
          ],
          "line": 1716
        },
        "resolved": true,
        "details": {
          "function_name": "set_page_dirty_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "2573-2581",
          "snippet": "int set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "delete_from_swap_cache",
          "args": [
            "page"
          ],
          "line": 1715
        },
        "resolved": true,
        "details": {
          "function_name": "delete_from_swap_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap_state.c",
          "lines": "243-254",
          "snippet": "void delete_from_swap_cache(struct page *page)\n{\n\tswp_entry_t entry = { .val = page_private(page) };\n\tstruct address_space *address_space = swap_address_space(entry);\n\n\txa_lock_irq(&address_space->i_pages);\n\t__delete_from_swap_cache(page, entry);\n\txa_unlock_irq(&address_space->i_pages);\n\n\tput_swap_page(page, entry);\n\tpage_ref_sub(page, hpage_nr_pages(page));\n}",
          "includes": [
            "#include <asm/pgtable.h>",
            "#include <linux/huge_mm.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/migrate.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/pgtable.h>\n#include <linux/huge_mm.h>\n#include <linux/swap_slots.h>\n#include <linux/vmalloc.h>\n#include <linux/migrate.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/backing-dev.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/gfp.h>\n#include <linux/mm.h>\n\nvoid delete_from_swap_cache(struct page *page)\n{\n\tswp_entry_t entry = { .val = page_private(page) };\n\tstruct address_space *address_space = swap_address_space(entry);\n\n\txa_lock_irq(&address_space->i_pages);\n\t__delete_from_swap_cache(page, entry);\n\txa_unlock_irq(&address_space->i_pages);\n\n\tput_swap_page(page, entry);\n\tpage_ref_sub(page, hpage_nr_pages(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mark_page_accessed",
          "args": [
            "page"
          ],
          "line": 1713
        },
        "resolved": true,
        "details": {
          "function_name": "mark_page_accessed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "376-400",
          "snippet": "void mark_page_accessed(struct page *page)\n{\n\tpage = compound_head(page);\n\tif (!PageActive(page) && !PageUnevictable(page) &&\n\t\t\tPageReferenced(page)) {\n\n\t\t/*\n\t\t * If the page is on the LRU, queue it for activation via\n\t\t * activate_page_pvecs. Otherwise, assume the page is on a\n\t\t * pagevec, mark it active and it'll be moved to the active\n\t\t * LRU on the next drain.\n\t\t */\n\t\tif (PageLRU(page))\n\t\t\tactivate_page(page);\n\t\telse\n\t\t\t__lru_cache_activate_page(page);\n\t\tClearPageReferenced(page);\n\t\tif (page_is_file_cache(page))\n\t\t\tworkingset_activation(page);\n\t} else if (!PageReferenced(page)) {\n\t\tSetPageReferenced(page);\n\t}\n\tif (page_is_idle(page))\n\t\tclear_page_idle(page);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid mark_page_accessed(struct page *page)\n{\n\tpage = compound_head(page);\n\tif (!PageActive(page) && !PageUnevictable(page) &&\n\t\t\tPageReferenced(page)) {\n\n\t\t/*\n\t\t * If the page is on the LRU, queue it for activation via\n\t\t * activate_page_pvecs. Otherwise, assume the page is on a\n\t\t * pagevec, mark it active and it'll be moved to the active\n\t\t * LRU on the next drain.\n\t\t */\n\t\tif (PageLRU(page))\n\t\t\tactivate_page(page);\n\t\telse\n\t\t\t__lru_cache_activate_page(page);\n\t\tClearPageReferenced(page);\n\t\tif (page_is_file_cache(page))\n\t\t\tworkingset_activation(page);\n\t} else if (!PageReferenced(page)) {\n\t\tSetPageReferenced(page);\n\t}\n\tif (page_is_idle(page))\n\t\tclear_page_idle(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swp_to_radix_entry",
          "args": [
            "swap"
          ],
          "line": 1684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_replace_page",
          "args": [
            "&page",
            "gfp",
            "info",
            "index"
          ],
          "line": 1675
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_replace_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1507-1572",
          "snippet": "static int shmem_replace_page(struct page **pagep, gfp_t gfp,\n\t\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct page *oldpage, *newpage;\n\tstruct address_space *swap_mapping;\n\tswp_entry_t entry;\n\tpgoff_t swap_index;\n\tint error;\n\n\toldpage = *pagep;\n\tentry.val = page_private(oldpage);\n\tswap_index = swp_offset(entry);\n\tswap_mapping = page_mapping(oldpage);\n\n\t/*\n\t * We have arrived here because our zones are constrained, so don't\n\t * limit chance of success by further cpuset and node constraints.\n\t */\n\tgfp &= ~GFP_CONSTRAINT_MASK;\n\tnewpage = shmem_alloc_page(gfp, info, index);\n\tif (!newpage)\n\t\treturn -ENOMEM;\n\n\tget_page(newpage);\n\tcopy_highpage(newpage, oldpage);\n\tflush_dcache_page(newpage);\n\n\t__SetPageLocked(newpage);\n\t__SetPageSwapBacked(newpage);\n\tSetPageUptodate(newpage);\n\tset_page_private(newpage, entry.val);\n\tSetPageSwapCache(newpage);\n\n\t/*\n\t * Our caller will very soon move newpage out of swapcache, but it's\n\t * a nice clean interface for us to replace oldpage by newpage there.\n\t */\n\txa_lock_irq(&swap_mapping->i_pages);\n\terror = shmem_replace_entry(swap_mapping, swap_index, oldpage, newpage);\n\tif (!error) {\n\t\t__inc_node_page_state(newpage, NR_FILE_PAGES);\n\t\t__dec_node_page_state(oldpage, NR_FILE_PAGES);\n\t}\n\txa_unlock_irq(&swap_mapping->i_pages);\n\n\tif (unlikely(error)) {\n\t\t/*\n\t\t * Is this possible?  I think not, now that our callers check\n\t\t * both PageSwapCache and page_private after getting page lock;\n\t\t * but be defensive.  Reverse old to newpage for clear and free.\n\t\t */\n\t\toldpage = newpage;\n\t} else {\n\t\tmem_cgroup_migrate(oldpage, newpage);\n\t\tlru_cache_add_anon(newpage);\n\t\t*pagep = newpage;\n\t}\n\n\tClearPageSwapCache(oldpage);\n\tset_page_private(oldpage, 0);\n\n\tunlock_page(oldpage);\n\tput_page(oldpage);\n\tput_page(oldpage);\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_replace_page(struct page **pagep, gfp_t gfp,\n\t\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct page *oldpage, *newpage;\n\tstruct address_space *swap_mapping;\n\tswp_entry_t entry;\n\tpgoff_t swap_index;\n\tint error;\n\n\toldpage = *pagep;\n\tentry.val = page_private(oldpage);\n\tswap_index = swp_offset(entry);\n\tswap_mapping = page_mapping(oldpage);\n\n\t/*\n\t * We have arrived here because our zones are constrained, so don't\n\t * limit chance of success by further cpuset and node constraints.\n\t */\n\tgfp &= ~GFP_CONSTRAINT_MASK;\n\tnewpage = shmem_alloc_page(gfp, info, index);\n\tif (!newpage)\n\t\treturn -ENOMEM;\n\n\tget_page(newpage);\n\tcopy_highpage(newpage, oldpage);\n\tflush_dcache_page(newpage);\n\n\t__SetPageLocked(newpage);\n\t__SetPageSwapBacked(newpage);\n\tSetPageUptodate(newpage);\n\tset_page_private(newpage, entry.val);\n\tSetPageSwapCache(newpage);\n\n\t/*\n\t * Our caller will very soon move newpage out of swapcache, but it's\n\t * a nice clean interface for us to replace oldpage by newpage there.\n\t */\n\txa_lock_irq(&swap_mapping->i_pages);\n\terror = shmem_replace_entry(swap_mapping, swap_index, oldpage, newpage);\n\tif (!error) {\n\t\t__inc_node_page_state(newpage, NR_FILE_PAGES);\n\t\t__dec_node_page_state(oldpage, NR_FILE_PAGES);\n\t}\n\txa_unlock_irq(&swap_mapping->i_pages);\n\n\tif (unlikely(error)) {\n\t\t/*\n\t\t * Is this possible?  I think not, now that our callers check\n\t\t * both PageSwapCache and page_private after getting page lock;\n\t\t * but be defensive.  Reverse old to newpage for clear and free.\n\t\t */\n\t\toldpage = newpage;\n\t} else {\n\t\tmem_cgroup_migrate(oldpage, newpage);\n\t\tlru_cache_add_anon(newpage);\n\t\t*pagep = newpage;\n\t}\n\n\tClearPageSwapCache(oldpage);\n\tset_page_private(oldpage, 0);\n\n\tunlock_page(oldpage);\n\tput_page(oldpage);\n\tput_page(oldpage);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_should_replace_page",
          "args": [
            "page",
            "gfp"
          ],
          "line": 1674
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_should_replace_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1502-1505",
          "snippet": "static bool shmem_should_replace_page(struct page *page, gfp_t gfp)\n{\n\treturn page_zonenum(page) > gfp_zone(gfp);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic bool shmem_should_replace_page(struct page *page, gfp_t gfp)\n{\n\treturn page_zonenum(page) > gfp_zone(gfp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_on_page_writeback",
          "args": [
            "page"
          ],
          "line": 1672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 1668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_private",
          "args": [
            "page"
          ],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageSwapCache",
          "args": [
            "page"
          ],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_swapin",
          "args": [
            "swap",
            "gfp",
            "info",
            "index"
          ],
          "line": 1654
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_swapin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1404-1418",
          "snippet": "static struct page *shmem_swapin(swp_entry_t swap, gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\tstruct vm_fault vmf;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tvmf.vma = &pvma;\n\tvmf.address = 0;\n\tpage = swap_cluster_readahead(swap, gfp, &vmf);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_swapin(swp_entry_t swap, gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\tstruct vm_fault vmf;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tvmf.vma = &pvma;\n\tvmf.address = 0;\n\tpage = swap_cluster_readahead(swap, gfp, &vmf);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_memcg_event_mm",
          "args": [
            "charge_mm",
            "PGMAJFAULT"
          ],
          "line": 1651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "count_vm_event",
          "args": [
            "PGMAJFAULT"
          ],
          "line": 1650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lookup_swap_cache",
          "args": [
            "swap",
            "NULL",
            "0"
          ],
          "line": 1645
        },
        "resolved": true,
        "details": {
          "function_name": "lookup_swap_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap_state.c",
          "lines": "309-351",
          "snippet": "struct page *lookup_swap_cache(swp_entry_t entry, struct vm_area_struct *vma,\n\t\t\t       unsigned long addr)\n{\n\tstruct page *page;\n\n\tpage = find_get_page(swap_address_space(entry), swp_offset(entry));\n\n\tINC_CACHE_INFO(find_total);\n\tif (page) {\n\t\tbool vma_ra = swap_use_vma_readahead();\n\t\tbool readahead;\n\n\t\tINC_CACHE_INFO(find_success);\n\t\t/*\n\t\t * At the moment, we don't support PG_readahead for anon THP\n\t\t * so let's bail out rather than confusing the readahead stat.\n\t\t */\n\t\tif (unlikely(PageTransCompound(page)))\n\t\t\treturn page;\n\n\t\treadahead = TestClearPageReadahead(page);\n\t\tif (vma && vma_ra) {\n\t\t\tunsigned long ra_val;\n\t\t\tint win, hits;\n\n\t\t\tra_val = GET_SWAP_RA_VAL(vma);\n\t\t\twin = SWAP_RA_WIN(ra_val);\n\t\t\thits = SWAP_RA_HITS(ra_val);\n\t\t\tif (readahead)\n\t\t\t\thits = min_t(int, hits + 1, SWAP_RA_HITS_MAX);\n\t\t\tatomic_long_set(&vma->swap_readahead_info,\n\t\t\t\t\tSWAP_RA_VAL(addr, win, hits));\n\t\t}\n\n\t\tif (readahead) {\n\t\t\tcount_vm_event(SWAP_RA_HIT);\n\t\t\tif (!vma || !vma_ra)\n\t\t\t\tatomic_inc(&swapin_readahead_hits);\n\t\t}\n\t}\n\n\treturn page;\n}",
          "includes": [
            "#include <asm/pgtable.h>",
            "#include <linux/huge_mm.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/migrate.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [
            "#define SWAP_RA_HITS_MAX\tSWAP_RA_HITS_MASK"
          ],
          "globals_used": [
            "static atomic_t swapin_readahead_hits = ATOMIC_INIT(4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <asm/pgtable.h>\n#include <linux/huge_mm.h>\n#include <linux/swap_slots.h>\n#include <linux/vmalloc.h>\n#include <linux/migrate.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/backing-dev.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/gfp.h>\n#include <linux/mm.h>\n\n#define SWAP_RA_HITS_MAX\tSWAP_RA_HITS_MASK\n\nstatic atomic_t swapin_readahead_hits = ATOMIC_INIT(4);\n\nstruct page *lookup_swap_cache(swp_entry_t entry, struct vm_area_struct *vma,\n\t\t\t       unsigned long addr)\n{\n\tstruct page *page;\n\n\tpage = find_get_page(swap_address_space(entry), swp_offset(entry));\n\n\tINC_CACHE_INFO(find_total);\n\tif (page) {\n\t\tbool vma_ra = swap_use_vma_readahead();\n\t\tbool readahead;\n\n\t\tINC_CACHE_INFO(find_success);\n\t\t/*\n\t\t * At the moment, we don't support PG_readahead for anon THP\n\t\t * so let's bail out rather than confusing the readahead stat.\n\t\t */\n\t\tif (unlikely(PageTransCompound(page)))\n\t\t\treturn page;\n\n\t\treadahead = TestClearPageReadahead(page);\n\t\tif (vma && vma_ra) {\n\t\t\tunsigned long ra_val;\n\t\t\tint win, hits;\n\n\t\t\tra_val = GET_SWAP_RA_VAL(vma);\n\t\t\twin = SWAP_RA_WIN(ra_val);\n\t\t\thits = SWAP_RA_HITS(ra_val);\n\t\t\tif (readahead)\n\t\t\t\thits = min_t(int, hits + 1, SWAP_RA_HITS_MAX);\n\t\t\tatomic_long_set(&vma->swap_readahead_info,\n\t\t\t\t\tSWAP_RA_VAL(addr, win, hits));\n\t\t}\n\n\t\tif (readahead) {\n\t\t\tcount_vm_event(SWAP_RA_HIT);\n\t\t\tif (!vma || !vma_ra)\n\t\t\t\tatomic_inc(&swapin_readahead_hits);\n\t\t}\n\t}\n\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 1640
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 1624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_read",
          "args": [
            "inode"
          ],
          "line": 1615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_to_swp_entry",
          "args": [
            "page"
          ],
          "line": 1610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_is_value",
          "args": [
            "page"
          ],
          "line": 1609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_lock_entry",
          "args": [
            "mapping",
            "index"
          ],
          "line": 1608
        },
        "resolved": true,
        "details": {
          "function_name": "find_lock_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/filemap.c",
          "lines": "1467-1484",
          "snippet": "struct page *find_lock_entry(struct address_space *mapping, pgoff_t offset)\n{\n\tstruct page *page;\n\nrepeat:\n\tpage = find_get_entry(mapping, offset);\n\tif (page && !xa_is_value(page)) {\n\t\tlock_page(page);\n\t\t/* Has the page been truncated? */\n\t\tif (unlikely(page_mapping(page) != mapping)) {\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t\tgoto repeat;\n\t\t}\n\t\tVM_BUG_ON_PAGE(page_to_pgoff(page) != offset, page);\n\t}\n\treturn page;\n}",
          "includes": [
            "#include <asm/mman.h>",
            "#include <linux/buffer_head.h> /* for try_to_free_buffers */",
            "#include <trace/events/filemap.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/rmap.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/security.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/hash.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/capability.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/fs.h>",
            "#include <linux/dax.h>",
            "#include <linux/compiler.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/mman.h>\n#include <linux/buffer_head.h> /* for try_to_free_buffers */\n#include <trace/events/filemap.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/delayacct.h>\n#include <linux/rmap.h>\n#include <linux/shmem_fs.h>\n#include <linux/cleancache.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/cpuset.h>\n#include <linux/security.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/hash.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/capability.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/dax.h>\n#include <linux/compiler.h>\n#include <linux/export.h>\n\nstruct page *find_lock_entry(struct address_space *mapping, pgoff_t offset)\n{\n\tstruct page *page;\n\nrepeat:\n\tpage = find_get_entry(mapping, offset);\n\tif (page && !xa_is_value(page)) {\n\t\tlock_page(page);\n\t\t/* Has the page been truncated? */\n\t\tif (unlikely(page_mapping(page) != mapping)) {\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t\tgoto repeat;\n\t\t}\n\t\tVM_BUG_ON_PAGE(page_to_pgoff(page) != offset, page);\n\t}\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 1590
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_NEVER\t0\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic int shmem_getpage_gfp(struct inode *inode, pgoff_t index,\n\tstruct page **pagep, enum sgp_type sgp, gfp_t gfp,\n\tstruct vm_area_struct *vma, struct vm_fault *vmf,\n\t\t\tvm_fault_t *fault_type)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo;\n\tstruct mm_struct *charge_mm;\n\tstruct mem_cgroup *memcg;\n\tstruct page *page;\n\tswp_entry_t swap;\n\tenum sgp_type sgp_huge = sgp;\n\tpgoff_t hindex = index;\n\tint error;\n\tint once = 0;\n\tint alloced = 0;\n\n\tif (index > (MAX_LFS_FILESIZE >> PAGE_SHIFT))\n\t\treturn -EFBIG;\n\tif (sgp == SGP_NOHUGE || sgp == SGP_HUGE)\n\t\tsgp = SGP_CACHE;\nrepeat:\n\tswap.val = 0;\n\tpage = find_lock_entry(mapping, index);\n\tif (xa_is_value(page)) {\n\t\tswap = radix_to_swp_entry(page);\n\t\tpage = NULL;\n\t}\n\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\n\tif (page && sgp == SGP_WRITE)\n\t\tmark_page_accessed(page);\n\n\t/* fallocated page? */\n\tif (page && !PageUptodate(page)) {\n\t\tif (sgp != SGP_READ)\n\t\t\tgoto clear;\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tpage = NULL;\n\t}\n\tif (page || (sgp == SGP_READ && !swap.val)) {\n\t\t*pagep = page;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Fast cache lookup did not find it:\n\t * bring it back from swap or allocate.\n\t */\n\tsbinfo = SHMEM_SB(inode->i_sb);\n\tcharge_mm = vma ? vma->vm_mm : current->mm;\n\n\tif (swap.val) {\n\t\t/* Look it up and read it in.. */\n\t\tpage = lookup_swap_cache(swap, NULL, 0);\n\t\tif (!page) {\n\t\t\t/* Or update major stats only when swapin succeeds?? */\n\t\t\tif (fault_type) {\n\t\t\t\t*fault_type |= VM_FAULT_MAJOR;\n\t\t\t\tcount_vm_event(PGMAJFAULT);\n\t\t\t\tcount_memcg_event_mm(charge_mm, PGMAJFAULT);\n\t\t\t}\n\t\t\t/* Here we actually start the io */\n\t\t\tpage = shmem_swapin(swap, gfp, info, index);\n\t\t\tif (!page) {\n\t\t\t\terror = -ENOMEM;\n\t\t\t\tgoto failed;\n\t\t\t}\n\t\t}\n\n\t\t/* We have to do this with page locked to prevent races */\n\t\tlock_page(page);\n\t\tif (!PageSwapCache(page) || page_private(page) != swap.val ||\n\t\t    !shmem_confirm_swap(mapping, index, swap)) {\n\t\t\terror = -EEXIST;\t/* try again */\n\t\t\tgoto unlock;\n\t\t}\n\t\tif (!PageUptodate(page)) {\n\t\t\terror = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t\twait_on_page_writeback(page);\n\n\t\tif (shmem_should_replace_page(page, gfp)) {\n\t\t\terror = shmem_replace_page(&page, gfp, info, index);\n\t\t\tif (error)\n\t\t\t\tgoto failed;\n\t\t}\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tfalse);\n\t\tif (!error) {\n\t\t\terror = shmem_add_to_page_cache(page, mapping, index,\n\t\t\t\t\t\tswp_to_radix_entry(swap), gfp);\n\t\t\t/*\n\t\t\t * We already confirmed swap under page lock, and make\n\t\t\t * no memory allocation here, so usually no possibility\n\t\t\t * of error; but free_swap_and_cache() only trylocks a\n\t\t\t * page, so it is just possible that the entry has been\n\t\t\t * truncated or holepunched since swap was confirmed.\n\t\t\t * shmem_undo_range() will have done some of the\n\t\t\t * unaccounting, now delete_from_swap_cache() will do\n\t\t\t * the rest.\n\t\t\t * Reset swap.val? No, leave it so \"failed\" goes back to\n\t\t\t * \"repeat\": reading a hole and writing should succeed.\n\t\t\t */\n\t\t\tif (error) {\n\t\t\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t\t\t\tdelete_from_swap_cache(page);\n\t\t\t}\n\t\t}\n\t\tif (error)\n\t\t\tgoto failed;\n\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->swapped--;\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\tmark_page_accessed(page);\n\n\t\tdelete_from_swap_cache(page);\n\t\tset_page_dirty(page);\n\t\tswap_free(swap);\n\n\t} else {\n\t\tif (vma && userfaultfd_missing(vma)) {\n\t\t\t*fault_type = handle_userfault(vmf, VM_UFFD_MISSING);\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* shmem_symlink() */\n\t\tif (mapping->a_ops != &shmem_aops)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_DENY || sgp_huge == SGP_NOHUGE)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\t\tgoto alloc_huge;\n\t\tswitch (sbinfo->huge) {\n\t\t\tloff_t i_size;\n\t\t\tpgoff_t off;\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\tgoto alloc_nohuge;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(index, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* fallthrough */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\tif (sgp_huge == SGP_HUGE)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\tgoto alloc_nohuge;\n\t\t}\n\nalloc_huge:\n\t\tpage = shmem_alloc_and_acct_page(gfp, inode, index, true);\n\t\tif (IS_ERR(page)) {\nalloc_nohuge:\t\tpage = shmem_alloc_and_acct_page(gfp, inode,\n\t\t\t\t\tindex, false);\n\t\t}\n\t\tif (IS_ERR(page)) {\n\t\t\tint retry = 5;\n\t\t\terror = PTR_ERR(page);\n\t\t\tpage = NULL;\n\t\t\tif (error != -ENOSPC)\n\t\t\t\tgoto failed;\n\t\t\t/*\n\t\t\t * Try to reclaim some spece by splitting a huge page\n\t\t\t * beyond i_size on the filesystem.\n\t\t\t */\n\t\t\twhile (retry--) {\n\t\t\t\tint ret;\n\t\t\t\tret = shmem_unused_huge_shrink(sbinfo, NULL, 1);\n\t\t\t\tif (ret == SHRINK_STOP)\n\t\t\t\t\tbreak;\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto alloc_nohuge;\n\t\t\t}\n\t\t\tgoto failed;\n\t\t}\n\n\t\tif (PageTransHuge(page))\n\t\t\thindex = round_down(index, HPAGE_PMD_NR);\n\t\telse\n\t\t\thindex = index;\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\t__SetPageReferenced(page);\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tPageTransHuge(page));\n\t\tif (error)\n\t\t\tgoto unacct;\n\t\terror = shmem_add_to_page_cache(page, mapping, hindex,\n\t\t\t\t\t\tNULL, gfp & GFP_RECLAIM_MASK);\n\t\tif (error) {\n\t\t\tmem_cgroup_cancel_charge(page, memcg,\n\t\t\t\t\tPageTransHuge(page));\n\t\t\tgoto unacct;\n\t\t}\n\t\tmem_cgroup_commit_charge(page, memcg, false,\n\t\t\t\tPageTransHuge(page));\n\t\tlru_cache_add_anon(page);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->alloced += 1 << compound_order(page);\n\t\tinode->i_blocks += BLOCKS_PER_PAGE << compound_order(page);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\talloced = true;\n\n\t\tif (PageTransHuge(page) &&\n\t\t\t\tDIV_ROUND_UP(i_size_read(inode), PAGE_SIZE) <\n\t\t\t\thindex + HPAGE_PMD_NR - 1) {\n\t\t\t/*\n\t\t\t * Part of the huge page is beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t/*\n\t\t\t * _careful to defend against unlocked access to\n\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t */\n\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\n\t\t/*\n\t\t * Let SGP_FALLOC use the SGP_WRITE optimization on a new page.\n\t\t */\n\t\tif (sgp == SGP_FALLOC)\n\t\t\tsgp = SGP_WRITE;\nclear:\n\t\t/*\n\t\t * Let SGP_WRITE caller clear ends if write does not fill page;\n\t\t * but SGP_FALLOC on a page fallocated earlier must initialize\n\t\t * it now, lest undo on failure cancel our earlier guarantee.\n\t\t */\n\t\tif (sgp != SGP_WRITE && !PageUptodate(page)) {\n\t\t\tstruct page *head = compound_head(page);\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < (1 << compound_order(head)); i++) {\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t\tSetPageUptodate(head);\n\t\t}\n\t}\n\n\t/* Perhaps the file has been truncated since we checked */\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\tif (alloced) {\n\t\t\tClearPageDirty(page);\n\t\t\tdelete_from_page_cache(page);\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tshmem_recalc_inode(inode);\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t}\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\t*pagep = page + index - hindex;\n\treturn 0;\n\n\t/*\n\t * Error recovery.\n\t */\nunacct:\n\tshmem_inode_unacct_blocks(inode, 1 << compound_order(page));\n\n\tif (PageTransHuge(page)) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tgoto alloc_nohuge;\n\t}\nfailed:\n\tif (swap.val && !shmem_confirm_swap(mapping, index, swap))\n\t\terror = -EEXIST;\nunlock:\n\tif (page) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tif (error == -ENOSPC && !once++) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\tgoto repeat;\n\t}\n\tif (error == -EEXIST)\n\t\tgoto repeat;\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_replace_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1507-1572",
    "snippet": "static int shmem_replace_page(struct page **pagep, gfp_t gfp,\n\t\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct page *oldpage, *newpage;\n\tstruct address_space *swap_mapping;\n\tswp_entry_t entry;\n\tpgoff_t swap_index;\n\tint error;\n\n\toldpage = *pagep;\n\tentry.val = page_private(oldpage);\n\tswap_index = swp_offset(entry);\n\tswap_mapping = page_mapping(oldpage);\n\n\t/*\n\t * We have arrived here because our zones are constrained, so don't\n\t * limit chance of success by further cpuset and node constraints.\n\t */\n\tgfp &= ~GFP_CONSTRAINT_MASK;\n\tnewpage = shmem_alloc_page(gfp, info, index);\n\tif (!newpage)\n\t\treturn -ENOMEM;\n\n\tget_page(newpage);\n\tcopy_highpage(newpage, oldpage);\n\tflush_dcache_page(newpage);\n\n\t__SetPageLocked(newpage);\n\t__SetPageSwapBacked(newpage);\n\tSetPageUptodate(newpage);\n\tset_page_private(newpage, entry.val);\n\tSetPageSwapCache(newpage);\n\n\t/*\n\t * Our caller will very soon move newpage out of swapcache, but it's\n\t * a nice clean interface for us to replace oldpage by newpage there.\n\t */\n\txa_lock_irq(&swap_mapping->i_pages);\n\terror = shmem_replace_entry(swap_mapping, swap_index, oldpage, newpage);\n\tif (!error) {\n\t\t__inc_node_page_state(newpage, NR_FILE_PAGES);\n\t\t__dec_node_page_state(oldpage, NR_FILE_PAGES);\n\t}\n\txa_unlock_irq(&swap_mapping->i_pages);\n\n\tif (unlikely(error)) {\n\t\t/*\n\t\t * Is this possible?  I think not, now that our callers check\n\t\t * both PageSwapCache and page_private after getting page lock;\n\t\t * but be defensive.  Reverse old to newpage for clear and free.\n\t\t */\n\t\toldpage = newpage;\n\t} else {\n\t\tmem_cgroup_migrate(oldpage, newpage);\n\t\tlru_cache_add_anon(newpage);\n\t\t*pagep = newpage;\n\t}\n\n\tClearPageSwapCache(oldpage);\n\tset_page_private(oldpage, 0);\n\n\tunlock_page(oldpage);\n\tput_page(oldpage);\n\tput_page(oldpage);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "oldpage"
          ],
          "line": 1570
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "oldpage"
          ],
          "line": 1568
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_page_private",
          "args": [
            "oldpage",
            "0"
          ],
          "line": 1566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ClearPageSwapCache",
          "args": [
            "oldpage"
          ],
          "line": 1565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lru_cache_add_anon",
          "args": [
            "newpage"
          ],
          "line": 1561
        },
        "resolved": true,
        "details": {
          "function_name": "lru_cache_add_anon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "417-422",
          "snippet": "void lru_cache_add_anon(struct page *page)\n{\n\tif (PageActive(page))\n\t\tClearPageActive(page);\n\t__lru_cache_add(page);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid lru_cache_add_anon(struct page *page)\n{\n\tif (PageActive(page))\n\t\tClearPageActive(page);\n\t__lru_cache_add(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mem_cgroup_migrate",
          "args": [
            "oldpage",
            "newpage"
          ],
          "line": 1560
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_migrate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "6155-6195",
          "snippet": "void mem_cgroup_migrate(struct page *oldpage, struct page *newpage)\n{\n\tstruct mem_cgroup *memcg;\n\tunsigned int nr_pages;\n\tbool compound;\n\tunsigned long flags;\n\n\tVM_BUG_ON_PAGE(!PageLocked(oldpage), oldpage);\n\tVM_BUG_ON_PAGE(!PageLocked(newpage), newpage);\n\tVM_BUG_ON_PAGE(PageAnon(oldpage) != PageAnon(newpage), newpage);\n\tVM_BUG_ON_PAGE(PageTransHuge(oldpage) != PageTransHuge(newpage),\n\t\t       newpage);\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\n\t/* Page cache replacement: new page already charged? */\n\tif (newpage->mem_cgroup)\n\t\treturn;\n\n\t/* Swapcache readahead pages can get replaced before being charged */\n\tmemcg = oldpage->mem_cgroup;\n\tif (!memcg)\n\t\treturn;\n\n\t/* Force-charge the new page. The old one will be freed soon */\n\tcompound = PageTransHuge(newpage);\n\tnr_pages = compound ? hpage_nr_pages(newpage) : 1;\n\n\tpage_counter_charge(&memcg->memory, nr_pages);\n\tif (do_memsw_account())\n\t\tpage_counter_charge(&memcg->memsw, nr_pages);\n\tcss_get_many(&memcg->css, nr_pages);\n\n\tcommit_charge(newpage, memcg, false);\n\n\tlocal_irq_save(flags);\n\tmem_cgroup_charge_statistics(memcg, newpage, compound, nr_pages);\n\tmemcg_check_events(memcg, newpage);\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nvoid mem_cgroup_migrate(struct page *oldpage, struct page *newpage)\n{\n\tstruct mem_cgroup *memcg;\n\tunsigned int nr_pages;\n\tbool compound;\n\tunsigned long flags;\n\n\tVM_BUG_ON_PAGE(!PageLocked(oldpage), oldpage);\n\tVM_BUG_ON_PAGE(!PageLocked(newpage), newpage);\n\tVM_BUG_ON_PAGE(PageAnon(oldpage) != PageAnon(newpage), newpage);\n\tVM_BUG_ON_PAGE(PageTransHuge(oldpage) != PageTransHuge(newpage),\n\t\t       newpage);\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\n\t/* Page cache replacement: new page already charged? */\n\tif (newpage->mem_cgroup)\n\t\treturn;\n\n\t/* Swapcache readahead pages can get replaced before being charged */\n\tmemcg = oldpage->mem_cgroup;\n\tif (!memcg)\n\t\treturn;\n\n\t/* Force-charge the new page. The old one will be freed soon */\n\tcompound = PageTransHuge(newpage);\n\tnr_pages = compound ? hpage_nr_pages(newpage) : 1;\n\n\tpage_counter_charge(&memcg->memory, nr_pages);\n\tif (do_memsw_account())\n\t\tpage_counter_charge(&memcg->memsw, nr_pages);\n\tcss_get_many(&memcg->css, nr_pages);\n\n\tcommit_charge(newpage, memcg, false);\n\n\tlocal_irq_save(flags);\n\tmem_cgroup_charge_statistics(memcg, newpage, compound, nr_pages);\n\tmemcg_check_events(memcg, newpage);\n\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "error"
          ],
          "line": 1552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_unlock_irq",
          "args": [
            "&swap_mapping->i_pages"
          ],
          "line": 1550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__dec_node_page_state",
          "args": [
            "oldpage",
            "NR_FILE_PAGES"
          ],
          "line": 1548
        },
        "resolved": true,
        "details": {
          "function_name": "__dec_node_page_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmstat.c",
          "lines": "460-463",
          "snippet": "void __dec_node_page_state(struct page *page, enum node_stat_item item)\n{\n\t__dec_node_state(page_pgdat(page), item);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/writeback.h>",
            "#include <linux/math64.h>",
            "#include <linux/sched.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/err.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/page_ext.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/writeback.h>\n#include <linux/math64.h>\n#include <linux/sched.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/vmstat.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nvoid __dec_node_page_state(struct page *page, enum node_stat_item item)\n{\n\t__dec_node_state(page_pgdat(page), item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__inc_node_page_state",
          "args": [
            "newpage",
            "NR_FILE_PAGES"
          ],
          "line": 1547
        },
        "resolved": true,
        "details": {
          "function_name": "__inc_node_page_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmstat.c",
          "lines": "416-419",
          "snippet": "void __inc_node_page_state(struct page *page, enum node_stat_item item)\n{\n\t__inc_node_state(page_pgdat(page), item);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/writeback.h>",
            "#include <linux/math64.h>",
            "#include <linux/sched.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/err.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/page_ext.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/writeback.h>\n#include <linux/math64.h>\n#include <linux/sched.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/vmstat.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nvoid __inc_node_page_state(struct page *page, enum node_stat_item item)\n{\n\t__inc_node_state(page_pgdat(page), item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_replace_entry",
          "args": [
            "swap_mapping",
            "swap_index",
            "oldpage",
            "newpage"
          ],
          "line": 1545
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_replace_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "327-340",
          "snippet": "static int shmem_replace_entry(struct address_space *mapping,\n\t\t\tpgoff_t index, void *expected, void *replacement)\n{\n\tXA_STATE(xas, &mapping->i_pages, index);\n\tvoid *item;\n\n\tVM_BUG_ON(!expected);\n\tVM_BUG_ON(!replacement);\n\titem = xas_load(&xas);\n\tif (item != expected)\n\t\treturn -ENOENT;\n\txas_store(&xas, replacement);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_replace_entry(struct address_space *mapping,\n\t\t\tpgoff_t index, void *expected, void *replacement)\n{\n\tXA_STATE(xas, &mapping->i_pages, index);\n\tvoid *item;\n\n\tVM_BUG_ON(!expected);\n\tVM_BUG_ON(!replacement);\n\titem = xas_load(&xas);\n\tif (item != expected)\n\t\treturn -ENOENT;\n\txas_store(&xas, replacement);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_lock_irq",
          "args": [
            "&swap_mapping->i_pages"
          ],
          "line": 1544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetPageSwapCache",
          "args": [
            "newpage"
          ],
          "line": 1538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_page_private",
          "args": [
            "newpage",
            "entry.val"
          ],
          "line": 1537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetPageUptodate",
          "args": [
            "newpage"
          ],
          "line": 1536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__SetPageSwapBacked",
          "args": [
            "newpage"
          ],
          "line": 1535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__SetPageLocked",
          "args": [
            "newpage"
          ],
          "line": 1534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_dcache_page",
          "args": [
            "newpage"
          ],
          "line": 1532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_highpage",
          "args": [
            "newpage",
            "oldpage"
          ],
          "line": 1531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_page",
          "args": [
            "newpage"
          ],
          "line": 1530
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_get_page_chunk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "247-250",
          "snippet": "static struct pcpu_chunk *pcpu_get_page_chunk(struct page *page)\n{\n\treturn (struct pcpu_chunk *)page->index;\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic struct pcpu_chunk *pcpu_get_page_chunk(struct page *page)\n{\n\treturn (struct pcpu_chunk *)page->index;\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_alloc_page",
          "args": [
            "gfp",
            "info",
            "index"
          ],
          "line": 1526
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_alloc_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1445-1456",
          "snippet": "static struct page *shmem_alloc_page(gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tpage = alloc_page_vma(gfp, &pvma, 0);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_alloc_page(gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tpage = alloc_page_vma(gfp, &pvma, 0);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_mapping",
          "args": [
            "oldpage"
          ],
          "line": 1519
        },
        "resolved": true,
        "details": {
          "function_name": "page_mapping_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "528-533",
          "snippet": "struct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nstruct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "swp_offset",
          "args": [
            "entry"
          ],
          "line": 1518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_private",
          "args": [
            "oldpage"
          ],
          "line": 1517
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_replace_page(struct page **pagep, gfp_t gfp,\n\t\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct page *oldpage, *newpage;\n\tstruct address_space *swap_mapping;\n\tswp_entry_t entry;\n\tpgoff_t swap_index;\n\tint error;\n\n\toldpage = *pagep;\n\tentry.val = page_private(oldpage);\n\tswap_index = swp_offset(entry);\n\tswap_mapping = page_mapping(oldpage);\n\n\t/*\n\t * We have arrived here because our zones are constrained, so don't\n\t * limit chance of success by further cpuset and node constraints.\n\t */\n\tgfp &= ~GFP_CONSTRAINT_MASK;\n\tnewpage = shmem_alloc_page(gfp, info, index);\n\tif (!newpage)\n\t\treturn -ENOMEM;\n\n\tget_page(newpage);\n\tcopy_highpage(newpage, oldpage);\n\tflush_dcache_page(newpage);\n\n\t__SetPageLocked(newpage);\n\t__SetPageSwapBacked(newpage);\n\tSetPageUptodate(newpage);\n\tset_page_private(newpage, entry.val);\n\tSetPageSwapCache(newpage);\n\n\t/*\n\t * Our caller will very soon move newpage out of swapcache, but it's\n\t * a nice clean interface for us to replace oldpage by newpage there.\n\t */\n\txa_lock_irq(&swap_mapping->i_pages);\n\terror = shmem_replace_entry(swap_mapping, swap_index, oldpage, newpage);\n\tif (!error) {\n\t\t__inc_node_page_state(newpage, NR_FILE_PAGES);\n\t\t__dec_node_page_state(oldpage, NR_FILE_PAGES);\n\t}\n\txa_unlock_irq(&swap_mapping->i_pages);\n\n\tif (unlikely(error)) {\n\t\t/*\n\t\t * Is this possible?  I think not, now that our callers check\n\t\t * both PageSwapCache and page_private after getting page lock;\n\t\t * but be defensive.  Reverse old to newpage for clear and free.\n\t\t */\n\t\toldpage = newpage;\n\t} else {\n\t\tmem_cgroup_migrate(oldpage, newpage);\n\t\tlru_cache_add_anon(newpage);\n\t\t*pagep = newpage;\n\t}\n\n\tClearPageSwapCache(oldpage);\n\tset_page_private(oldpage, 0);\n\n\tunlock_page(oldpage);\n\tput_page(oldpage);\n\tput_page(oldpage);\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_should_replace_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1502-1505",
    "snippet": "static bool shmem_should_replace_page(struct page *page, gfp_t gfp)\n{\n\treturn page_zonenum(page) > gfp_zone(gfp);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gfp_zone",
          "args": [
            "gfp"
          ],
          "line": 1504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_zonenum",
          "args": [
            "page"
          ],
          "line": 1504
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic bool shmem_should_replace_page(struct page *page, gfp_t gfp)\n{\n\treturn page_zonenum(page) > gfp_zone(gfp);\n}"
  },
  {
    "function_name": "shmem_alloc_and_acct_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1458-1488",
    "snippet": "static struct page *shmem_alloc_and_acct_page(gfp_t gfp,\n\t\tstruct inode *inode,\n\t\tpgoff_t index, bool huge)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct page *page;\n\tint nr;\n\tint err = -ENOSPC;\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\thuge = false;\n\tnr = huge ? HPAGE_PMD_NR : 1;\n\n\tif (!shmem_inode_acct_block(inode, nr))\n\t\tgoto failed;\n\n\tif (huge)\n\t\tpage = shmem_alloc_hugepage(gfp, info, index);\n\telse\n\t\tpage = shmem_alloc_page(gfp, info, index);\n\tif (page) {\n\t\t__SetPageLocked(page);\n\t\t__SetPageSwapBacked(page);\n\t\treturn page;\n\t}\n\n\terr = -ENOMEM;\n\tshmem_inode_unacct_blocks(inode, nr);\nfailed:\n\treturn ERR_PTR(err);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ERR_PTR",
          "args": [
            "err"
          ],
          "line": 1487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_inode_unacct_blocks",
          "args": [
            "inode",
            "nr"
          ],
          "line": 1485
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_inode_unacct_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "215-223",
          "snippet": "static inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__SetPageSwapBacked",
          "args": [
            "page"
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__SetPageLocked",
          "args": [
            "page"
          ],
          "line": 1479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_alloc_page",
          "args": [
            "gfp",
            "info",
            "index"
          ],
          "line": 1477
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_alloc_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1445-1456",
          "snippet": "static struct page *shmem_alloc_page(gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tpage = alloc_page_vma(gfp, &pvma, 0);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_alloc_page(gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tpage = alloc_page_vma(gfp, &pvma, 0);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_alloc_hugepage",
          "args": [
            "gfp",
            "info",
            "index"
          ],
          "line": 1475
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_alloc_hugepage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1420-1443",
          "snippet": "static struct page *shmem_alloc_hugepage(gfp_t gfp,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct address_space *mapping = info->vfs_inode.i_mapping;\n\tpgoff_t hindex;\n\tstruct page *page;\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\treturn NULL;\n\n\thindex = round_down(index, HPAGE_PMD_NR);\n\tif (xa_find(&mapping->i_pages, &hindex, hindex + HPAGE_PMD_NR - 1,\n\t\t\t\t\t\t\t\tXA_PRESENT))\n\t\treturn NULL;\n\n\tshmem_pseudo_vma_init(&pvma, info, hindex);\n\tpage = alloc_pages_vma(gfp | __GFP_COMP | __GFP_NORETRY | __GFP_NOWARN,\n\t\t\tHPAGE_PMD_ORDER, &pvma, 0, numa_node_id());\n\tshmem_pseudo_vma_destroy(&pvma);\n\tif (page)\n\t\tprep_transhuge_page(page);\n\treturn page;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_alloc_hugepage(gfp_t gfp,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct address_space *mapping = info->vfs_inode.i_mapping;\n\tpgoff_t hindex;\n\tstruct page *page;\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\treturn NULL;\n\n\thindex = round_down(index, HPAGE_PMD_NR);\n\tif (xa_find(&mapping->i_pages, &hindex, hindex + HPAGE_PMD_NR - 1,\n\t\t\t\t\t\t\t\tXA_PRESENT))\n\t\treturn NULL;\n\n\tshmem_pseudo_vma_init(&pvma, info, hindex);\n\tpage = alloc_pages_vma(gfp | __GFP_COMP | __GFP_NORETRY | __GFP_NOWARN,\n\t\t\tHPAGE_PMD_ORDER, &pvma, 0, numa_node_id());\n\tshmem_pseudo_vma_destroy(&pvma);\n\tif (page)\n\t\tprep_transhuge_page(page);\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_inode_acct_block",
          "args": [
            "inode",
            "nr"
          ],
          "line": 1471
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_inode_acct_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "193-213",
          "snippet": "static inline bool shmem_inode_acct_block(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (shmem_acct_block(info->flags, pages))\n\t\treturn false;\n\n\tif (sbinfo->max_blocks) {\n\t\tif (percpu_counter_compare(&sbinfo->used_blocks,\n\t\t\t\t\t   sbinfo->max_blocks - pages) > 0)\n\t\t\tgoto unacct;\n\t\tpercpu_counter_add(&sbinfo->used_blocks, pages);\n\t}\n\n\treturn true;\n\nunacct:\n\tshmem_unacct_blocks(info->flags, pages);\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline bool shmem_inode_acct_block(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (shmem_acct_block(info->flags, pages))\n\t\treturn false;\n\n\tif (sbinfo->max_blocks) {\n\t\tif (percpu_counter_compare(&sbinfo->used_blocks,\n\t\t\t\t\t   sbinfo->max_blocks - pages) > 0)\n\t\t\tgoto unacct;\n\t\tpercpu_counter_add(&sbinfo->used_blocks, pages);\n\t}\n\n\treturn true;\n\nunacct:\n\tshmem_unacct_blocks(info->flags, pages);\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_TRANSPARENT_HUGE_PAGECACHE"
          ],
          "line": 1467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 1462
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_alloc_and_acct_page(gfp_t gfp,\n\t\tstruct inode *inode,\n\t\tpgoff_t index, bool huge)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct page *page;\n\tint nr;\n\tint err = -ENOSPC;\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\thuge = false;\n\tnr = huge ? HPAGE_PMD_NR : 1;\n\n\tif (!shmem_inode_acct_block(inode, nr))\n\t\tgoto failed;\n\n\tif (huge)\n\t\tpage = shmem_alloc_hugepage(gfp, info, index);\n\telse\n\t\tpage = shmem_alloc_page(gfp, info, index);\n\tif (page) {\n\t\t__SetPageLocked(page);\n\t\t__SetPageSwapBacked(page);\n\t\treturn page;\n\t}\n\n\terr = -ENOMEM;\n\tshmem_inode_unacct_blocks(inode, nr);\nfailed:\n\treturn ERR_PTR(err);\n}"
  },
  {
    "function_name": "shmem_alloc_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1445-1456",
    "snippet": "static struct page *shmem_alloc_page(gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tpage = alloc_page_vma(gfp, &pvma, 0);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_pseudo_vma_destroy",
          "args": [
            "&pvma"
          ],
          "line": 1453
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_pseudo_vma_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1398-1402",
          "snippet": "static void shmem_pseudo_vma_destroy(struct vm_area_struct *vma)\n{\n\t/* Drop reference taken by mpol_shared_policy_lookup() */\n\tmpol_cond_put(vma->vm_policy);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define vm_policy vm_private_data"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define vm_policy vm_private_data\n\nstatic void shmem_pseudo_vma_destroy(struct vm_area_struct *vma)\n{\n\t/* Drop reference taken by mpol_shared_policy_lookup() */\n\tmpol_cond_put(vma->vm_policy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_page_vma",
          "args": [
            "gfp",
            "&pvma",
            "0"
          ],
          "line": 1452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_pseudo_vma_init",
          "args": [
            "&pvma",
            "info",
            "index"
          ],
          "line": 1451
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_pseudo_vma_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1388-1396",
          "snippet": "static void shmem_pseudo_vma_init(struct vm_area_struct *vma,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\t/* Create a pseudo vma that just contains the policy */\n\tvma_init(vma, NULL);\n\t/* Bias interleave by inode number to distribute better across nodes */\n\tvma->vm_pgoff = index + info->vfs_inode.i_ino;\n\tvma->vm_policy = mpol_shared_policy_lookup(&info->policy, index);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define vm_policy vm_private_data"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define vm_policy vm_private_data\n\nstatic void shmem_pseudo_vma_init(struct vm_area_struct *vma,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\t/* Create a pseudo vma that just contains the policy */\n\tvma_init(vma, NULL);\n\t/* Bias interleave by inode number to distribute better across nodes */\n\tvma->vm_pgoff = index + info->vfs_inode.i_ino;\n\tvma->vm_policy = mpol_shared_policy_lookup(&info->policy, index);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_alloc_page(gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tpage = alloc_page_vma(gfp, &pvma, 0);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}"
  },
  {
    "function_name": "shmem_alloc_hugepage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1420-1443",
    "snippet": "static struct page *shmem_alloc_hugepage(gfp_t gfp,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct address_space *mapping = info->vfs_inode.i_mapping;\n\tpgoff_t hindex;\n\tstruct page *page;\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\treturn NULL;\n\n\thindex = round_down(index, HPAGE_PMD_NR);\n\tif (xa_find(&mapping->i_pages, &hindex, hindex + HPAGE_PMD_NR - 1,\n\t\t\t\t\t\t\t\tXA_PRESENT))\n\t\treturn NULL;\n\n\tshmem_pseudo_vma_init(&pvma, info, hindex);\n\tpage = alloc_pages_vma(gfp | __GFP_COMP | __GFP_NORETRY | __GFP_NOWARN,\n\t\t\tHPAGE_PMD_ORDER, &pvma, 0, numa_node_id());\n\tshmem_pseudo_vma_destroy(&pvma);\n\tif (page)\n\t\tprep_transhuge_page(page);\n\treturn page;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prep_transhuge_page",
          "args": [
            "page"
          ],
          "line": 1441
        },
        "resolved": true,
        "details": {
          "function_name": "prep_transhuge_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/huge_memory.c",
          "lines": "490-499",
          "snippet": "void prep_transhuge_page(struct page *page)\n{\n\t/*\n\t * we use page->mapping and page->indexlru in second tail page\n\t * as list_head: assuming THP order >= 2\n\t */\n\n\tINIT_LIST_HEAD(page_deferred_list(page));\n\tset_compound_page_dtor(page, TRANSHUGE_PAGE_DTOR);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/tlb.h>",
            "#include <linux/oom.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/page_idle.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/migrate.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mman.h>",
            "#include <linux/pfn_t.h>",
            "#include <linux/freezer.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/dax.h>",
            "#include <linux/swapops.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/swap.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgalloc.h>\n#include <asm/tlb.h>\n#include <linux/oom.h>\n#include <linux/shmem_fs.h>\n#include <linux/page_idle.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/hashtable.h>\n#include <linux/migrate.h>\n#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/memremap.h>\n#include <linux/mman.h>\n#include <linux/pfn_t.h>\n#include <linux/freezer.h>\n#include <linux/khugepaged.h>\n#include <linux/dax.h>\n#include <linux/swapops.h>\n#include <linux/mm_inline.h>\n#include <linux/shrinker.h>\n#include <linux/swap.h>\n#include <linux/rmap.h>\n#include <linux/mmu_notifier.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid prep_transhuge_page(struct page *page)\n{\n\t/*\n\t * we use page->mapping and page->indexlru in second tail page\n\t * as list_head: assuming THP order >= 2\n\t */\n\n\tINIT_LIST_HEAD(page_deferred_list(page));\n\tset_compound_page_dtor(page, TRANSHUGE_PAGE_DTOR);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_pseudo_vma_destroy",
          "args": [
            "&pvma"
          ],
          "line": 1439
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_pseudo_vma_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1398-1402",
          "snippet": "static void shmem_pseudo_vma_destroy(struct vm_area_struct *vma)\n{\n\t/* Drop reference taken by mpol_shared_policy_lookup() */\n\tmpol_cond_put(vma->vm_policy);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define vm_policy vm_private_data"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define vm_policy vm_private_data\n\nstatic void shmem_pseudo_vma_destroy(struct vm_area_struct *vma)\n{\n\t/* Drop reference taken by mpol_shared_policy_lookup() */\n\tmpol_cond_put(vma->vm_policy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_pages_vma",
          "args": [
            "gfp | __GFP_COMP | __GFP_NORETRY | __GFP_NOWARN",
            "HPAGE_PMD_ORDER",
            "&pvma",
            "0",
            "numa_node_id()"
          ],
          "line": 1437
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_pages_vma",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2022-2048",
          "snippet": "struct page *\nalloc_pages_vma(gfp_t gfp, int order, struct vm_area_struct *vma,\n\t\tunsigned long addr, int node)\n{\n\tstruct mempolicy *pol;\n\tstruct page *page;\n\tint preferred_nid;\n\tnodemask_t *nmask;\n\n\tpol = get_vma_policy(vma, addr);\n\n\tif (pol->mode == MPOL_INTERLEAVE) {\n\t\tunsigned nid;\n\n\t\tnid = interleave_nid(pol, vma, addr, PAGE_SHIFT + order);\n\t\tmpol_cond_put(pol);\n\t\tpage = alloc_page_interleave(gfp, order, nid);\n\t\tgoto out;\n\t}\n\n\tnmask = policy_nodemask(gfp, pol);\n\tpreferred_nid = policy_node(gfp, pol, node);\n\tpage = __alloc_pages_nodemask(gfp, order, preferred_nid, nmask);\n\tmpol_cond_put(pol);\nout:\n\treturn page;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nstruct page *\nalloc_pages_vma(gfp_t gfp, int order, struct vm_area_struct *vma,\n\t\tunsigned long addr, int node)\n{\n\tstruct mempolicy *pol;\n\tstruct page *page;\n\tint preferred_nid;\n\tnodemask_t *nmask;\n\n\tpol = get_vma_policy(vma, addr);\n\n\tif (pol->mode == MPOL_INTERLEAVE) {\n\t\tunsigned nid;\n\n\t\tnid = interleave_nid(pol, vma, addr, PAGE_SHIFT + order);\n\t\tmpol_cond_put(pol);\n\t\tpage = alloc_page_interleave(gfp, order, nid);\n\t\tgoto out;\n\t}\n\n\tnmask = policy_nodemask(gfp, pol);\n\tpreferred_nid = policy_node(gfp, pol, node);\n\tpage = __alloc_pages_nodemask(gfp, order, preferred_nid, nmask);\n\tmpol_cond_put(pol);\nout:\n\treturn page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "numa_node_id",
          "args": [],
          "line": 1438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_pseudo_vma_init",
          "args": [
            "&pvma",
            "info",
            "hindex"
          ],
          "line": 1436
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_pseudo_vma_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1388-1396",
          "snippet": "static void shmem_pseudo_vma_init(struct vm_area_struct *vma,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\t/* Create a pseudo vma that just contains the policy */\n\tvma_init(vma, NULL);\n\t/* Bias interleave by inode number to distribute better across nodes */\n\tvma->vm_pgoff = index + info->vfs_inode.i_ino;\n\tvma->vm_policy = mpol_shared_policy_lookup(&info->policy, index);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define vm_policy vm_private_data"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define vm_policy vm_private_data\n\nstatic void shmem_pseudo_vma_init(struct vm_area_struct *vma,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\t/* Create a pseudo vma that just contains the policy */\n\tvma_init(vma, NULL);\n\t/* Bias interleave by inode number to distribute better across nodes */\n\tvma->vm_pgoff = index + info->vfs_inode.i_ino;\n\tvma->vm_policy = mpol_shared_policy_lookup(&info->policy, index);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_find",
          "args": [
            "&mapping->i_pages",
            "&hindex",
            "hindex + HPAGE_PMD_NR - 1",
            "XA_PRESENT"
          ],
          "line": 1432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "index",
            "HPAGE_PMD_NR"
          ],
          "line": 1431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_TRANSPARENT_HUGE_PAGECACHE"
          ],
          "line": 1428
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_alloc_hugepage(gfp_t gfp,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct address_space *mapping = info->vfs_inode.i_mapping;\n\tpgoff_t hindex;\n\tstruct page *page;\n\n\tif (!IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE))\n\t\treturn NULL;\n\n\thindex = round_down(index, HPAGE_PMD_NR);\n\tif (xa_find(&mapping->i_pages, &hindex, hindex + HPAGE_PMD_NR - 1,\n\t\t\t\t\t\t\t\tXA_PRESENT))\n\t\treturn NULL;\n\n\tshmem_pseudo_vma_init(&pvma, info, hindex);\n\tpage = alloc_pages_vma(gfp | __GFP_COMP | __GFP_NORETRY | __GFP_NOWARN,\n\t\t\tHPAGE_PMD_ORDER, &pvma, 0, numa_node_id());\n\tshmem_pseudo_vma_destroy(&pvma);\n\tif (page)\n\t\tprep_transhuge_page(page);\n\treturn page;\n}"
  },
  {
    "function_name": "shmem_swapin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1404-1418",
    "snippet": "static struct page *shmem_swapin(swp_entry_t swap, gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\tstruct vm_fault vmf;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tvmf.vma = &pvma;\n\tvmf.address = 0;\n\tpage = swap_cluster_readahead(swap, gfp, &vmf);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_pseudo_vma_destroy",
          "args": [
            "&pvma"
          ],
          "line": 1415
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_pseudo_vma_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1398-1402",
          "snippet": "static void shmem_pseudo_vma_destroy(struct vm_area_struct *vma)\n{\n\t/* Drop reference taken by mpol_shared_policy_lookup() */\n\tmpol_cond_put(vma->vm_policy);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define vm_policy vm_private_data"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define vm_policy vm_private_data\n\nstatic void shmem_pseudo_vma_destroy(struct vm_area_struct *vma)\n{\n\t/* Drop reference taken by mpol_shared_policy_lookup() */\n\tmpol_cond_put(vma->vm_policy);\n}"
        }
      },
      {
        "call_info": {
          "callee": "swap_cluster_readahead",
          "args": [
            "swap",
            "gfp",
            "&vmf"
          ],
          "line": 1414
        },
        "resolved": true,
        "details": {
          "function_name": "swap_cluster_readahead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap_state.c",
          "lines": "528-577",
          "snippet": "struct page *swap_cluster_readahead(swp_entry_t entry, gfp_t gfp_mask,\n\t\t\t\tstruct vm_fault *vmf)\n{\n\tstruct page *page;\n\tunsigned long entry_offset = swp_offset(entry);\n\tunsigned long offset = entry_offset;\n\tunsigned long start_offset, end_offset;\n\tunsigned long mask;\n\tstruct swap_info_struct *si = swp_swap_info(entry);\n\tstruct blk_plug plug;\n\tbool do_poll = true, page_allocated;\n\tstruct vm_area_struct *vma = vmf->vma;\n\tunsigned long addr = vmf->address;\n\n\tmask = swapin_nr_pages(offset) - 1;\n\tif (!mask)\n\t\tgoto skip;\n\n\tdo_poll = false;\n\t/* Read a page_cluster sized and aligned cluster around offset. */\n\tstart_offset = offset & ~mask;\n\tend_offset = offset | mask;\n\tif (!start_offset)\t/* First page is swap header. */\n\t\tstart_offset++;\n\tif (end_offset >= si->max)\n\t\tend_offset = si->max - 1;\n\n\tblk_start_plug(&plug);\n\tfor (offset = start_offset; offset <= end_offset ; offset++) {\n\t\t/* Ok, do the async read-ahead now */\n\t\tpage = __read_swap_cache_async(\n\t\t\tswp_entry(swp_type(entry), offset),\n\t\t\tgfp_mask, vma, addr, &page_allocated);\n\t\tif (!page)\n\t\t\tcontinue;\n\t\tif (page_allocated) {\n\t\t\tswap_readpage(page, false);\n\t\t\tif (offset != entry_offset) {\n\t\t\t\tSetPageReadahead(page);\n\t\t\t\tcount_vm_event(SWAP_RA);\n\t\t\t}\n\t\t}\n\t\tput_page(page);\n\t}\n\tblk_finish_plug(&plug);\n\n\tlru_add_drain();\t/* Push any new pages onto the LRU now */\nskip:\n\treturn read_swap_cache_async(entry, gfp_mask, vma, addr, do_poll);\n}",
          "includes": [
            "#include <asm/pgtable.h>",
            "#include <linux/huge_mm.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/migrate.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/pgtable.h>\n#include <linux/huge_mm.h>\n#include <linux/swap_slots.h>\n#include <linux/vmalloc.h>\n#include <linux/migrate.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/backing-dev.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/gfp.h>\n#include <linux/mm.h>\n\nstruct page *swap_cluster_readahead(swp_entry_t entry, gfp_t gfp_mask,\n\t\t\t\tstruct vm_fault *vmf)\n{\n\tstruct page *page;\n\tunsigned long entry_offset = swp_offset(entry);\n\tunsigned long offset = entry_offset;\n\tunsigned long start_offset, end_offset;\n\tunsigned long mask;\n\tstruct swap_info_struct *si = swp_swap_info(entry);\n\tstruct blk_plug plug;\n\tbool do_poll = true, page_allocated;\n\tstruct vm_area_struct *vma = vmf->vma;\n\tunsigned long addr = vmf->address;\n\n\tmask = swapin_nr_pages(offset) - 1;\n\tif (!mask)\n\t\tgoto skip;\n\n\tdo_poll = false;\n\t/* Read a page_cluster sized and aligned cluster around offset. */\n\tstart_offset = offset & ~mask;\n\tend_offset = offset | mask;\n\tif (!start_offset)\t/* First page is swap header. */\n\t\tstart_offset++;\n\tif (end_offset >= si->max)\n\t\tend_offset = si->max - 1;\n\n\tblk_start_plug(&plug);\n\tfor (offset = start_offset; offset <= end_offset ; offset++) {\n\t\t/* Ok, do the async read-ahead now */\n\t\tpage = __read_swap_cache_async(\n\t\t\tswp_entry(swp_type(entry), offset),\n\t\t\tgfp_mask, vma, addr, &page_allocated);\n\t\tif (!page)\n\t\t\tcontinue;\n\t\tif (page_allocated) {\n\t\t\tswap_readpage(page, false);\n\t\t\tif (offset != entry_offset) {\n\t\t\t\tSetPageReadahead(page);\n\t\t\t\tcount_vm_event(SWAP_RA);\n\t\t\t}\n\t\t}\n\t\tput_page(page);\n\t}\n\tblk_finish_plug(&plug);\n\n\tlru_add_drain();\t/* Push any new pages onto the LRU now */\nskip:\n\treturn read_swap_cache_async(entry, gfp_mask, vma, addr, do_poll);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_pseudo_vma_init",
          "args": [
            "&pvma",
            "info",
            "index"
          ],
          "line": 1411
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_pseudo_vma_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1388-1396",
          "snippet": "static void shmem_pseudo_vma_init(struct vm_area_struct *vma,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\t/* Create a pseudo vma that just contains the policy */\n\tvma_init(vma, NULL);\n\t/* Bias interleave by inode number to distribute better across nodes */\n\tvma->vm_pgoff = index + info->vfs_inode.i_ino;\n\tvma->vm_policy = mpol_shared_policy_lookup(&info->policy, index);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define vm_policy vm_private_data"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define vm_policy vm_private_data\n\nstatic void shmem_pseudo_vma_init(struct vm_area_struct *vma,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\t/* Create a pseudo vma that just contains the policy */\n\tvma_init(vma, NULL);\n\t/* Bias interleave by inode number to distribute better across nodes */\n\tvma->vm_pgoff = index + info->vfs_inode.i_ino;\n\tvma->vm_policy = mpol_shared_policy_lookup(&info->policy, index);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct page *shmem_swapin(swp_entry_t swap, gfp_t gfp,\n\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct vm_area_struct pvma;\n\tstruct page *page;\n\tstruct vm_fault vmf;\n\n\tshmem_pseudo_vma_init(&pvma, info, index);\n\tvmf.vma = &pvma;\n\tvmf.address = 0;\n\tpage = swap_cluster_readahead(swap, gfp, &vmf);\n\tshmem_pseudo_vma_destroy(&pvma);\n\n\treturn page;\n}"
  },
  {
    "function_name": "shmem_pseudo_vma_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1398-1402",
    "snippet": "static void shmem_pseudo_vma_destroy(struct vm_area_struct *vma)\n{\n\t/* Drop reference taken by mpol_shared_policy_lookup() */\n\tmpol_cond_put(vma->vm_policy);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define vm_policy vm_private_data"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mpol_cond_put",
          "args": [
            "vma->vm_policy"
          ],
          "line": 1401
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define vm_policy vm_private_data\n\nstatic void shmem_pseudo_vma_destroy(struct vm_area_struct *vma)\n{\n\t/* Drop reference taken by mpol_shared_policy_lookup() */\n\tmpol_cond_put(vma->vm_policy);\n}"
  },
  {
    "function_name": "shmem_pseudo_vma_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1388-1396",
    "snippet": "static void shmem_pseudo_vma_init(struct vm_area_struct *vma,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\t/* Create a pseudo vma that just contains the policy */\n\tvma_init(vma, NULL);\n\t/* Bias interleave by inode number to distribute better across nodes */\n\tvma->vm_pgoff = index + info->vfs_inode.i_ino;\n\tvma->vm_policy = mpol_shared_policy_lookup(&info->policy, index);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define vm_policy vm_private_data"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mpol_shared_policy_lookup",
          "args": [
            "&info->policy",
            "index"
          ],
          "line": 1395
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_shared_policy_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2232-2248",
          "snippet": "struct mempolicy *\nmpol_shared_policy_lookup(struct shared_policy *sp, unsigned long idx)\n{\n\tstruct mempolicy *pol = NULL;\n\tstruct sp_node *sn;\n\n\tif (!sp->root.rb_node)\n\t\treturn NULL;\n\tread_lock(&sp->lock);\n\tsn = sp_lookup(sp, idx, idx+1);\n\tif (sn) {\n\t\tmpol_get(sn->policy);\n\t\tpol = sn->policy;\n\t}\n\tread_unlock(&sp->lock);\n\treturn pol;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nstruct mempolicy *\nmpol_shared_policy_lookup(struct shared_policy *sp, unsigned long idx)\n{\n\tstruct mempolicy *pol = NULL;\n\tstruct sp_node *sn;\n\n\tif (!sp->root.rb_node)\n\t\treturn NULL;\n\tread_lock(&sp->lock);\n\tsn = sp_lookup(sp, idx, idx+1);\n\tif (sn) {\n\t\tmpol_get(sn->policy);\n\t\tpol = sn->policy;\n\t}\n\tread_unlock(&sp->lock);\n\treturn pol;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vma_init",
          "args": [
            "vma",
            "NULL"
          ],
          "line": 1392
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define vm_policy vm_private_data\n\nstatic void shmem_pseudo_vma_init(struct vm_area_struct *vma,\n\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\t/* Create a pseudo vma that just contains the policy */\n\tvma_init(vma, NULL);\n\t/* Bias interleave by inode number to distribute better across nodes */\n\tvma->vm_pgoff = index + info->vfs_inode.i_ino;\n\tvma->vm_policy = mpol_shared_policy_lookup(&info->policy, index);\n}"
  },
  {
    "function_name": "shmem_get_sbmpol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1379-1382",
    "snippet": "static inline struct mempolicy *shmem_get_sbmpol(struct shmem_sb_info *sbinfo)\n{\n\treturn NULL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct mempolicy *shmem_get_sbmpol(struct shmem_sb_info *sbinfo)\n{\n\treturn NULL;\n}"
  },
  {
    "function_name": "shmem_show_mpol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1376-1378",
    "snippet": "static inline void shmem_show_mpol(struct seq_file *seq, struct mempolicy *mpol)\n{\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_show_mpol(struct seq_file *seq, struct mempolicy *mpol)\n{\n}"
  },
  {
    "function_name": "shmem_get_sbmpol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1364-1374",
    "snippet": "static struct mempolicy *shmem_get_sbmpol(struct shmem_sb_info *sbinfo)\n{\n\tstruct mempolicy *mpol = NULL;\n\tif (sbinfo->mpol) {\n\t\tspin_lock(&sbinfo->stat_lock);\t/* prevent replace/use races */\n\t\tmpol = sbinfo->mpol;\n\t\tmpol_get(mpol);\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n\treturn mpol;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 1371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mpol_get",
          "args": [
            "mpol"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 1368
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic struct mempolicy *shmem_get_sbmpol(struct shmem_sb_info *sbinfo)\n{\n\tstruct mempolicy *mpol = NULL;\n\tif (sbinfo->mpol) {\n\t\tspin_lock(&sbinfo->stat_lock);\t/* prevent replace/use races */\n\t\tmpol = sbinfo->mpol;\n\t\tmpol_get(mpol);\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n\treturn mpol;\n}"
  },
  {
    "function_name": "shmem_show_mpol",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1352-1362",
    "snippet": "static void shmem_show_mpol(struct seq_file *seq, struct mempolicy *mpol)\n{\n\tchar buffer[64];\n\n\tif (!mpol || mpol->mode == MPOL_DEFAULT)\n\t\treturn;\t\t/* show nothing */\n\n\tmpol_to_str(buffer, sizeof(buffer), mpol);\n\n\tseq_printf(seq, \",mpol=%s\", buffer);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "seq",
            "\",mpol=%s\"",
            "buffer"
          ],
          "line": 1361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mpol_to_str",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "mpol"
          ],
          "line": 1359
        },
        "resolved": true,
        "details": {
          "function_name": "mpol_to_str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mempolicy.c",
          "lines": "2812-2860",
          "snippet": "void mpol_to_str(char *buffer, int maxlen, struct mempolicy *pol)\n{\n\tchar *p = buffer;\n\tnodemask_t nodes = NODE_MASK_NONE;\n\tunsigned short mode = MPOL_DEFAULT;\n\tunsigned short flags = 0;\n\n\tif (pol && pol != &default_policy && !(pol->flags & MPOL_F_MORON)) {\n\t\tmode = pol->mode;\n\t\tflags = pol->flags;\n\t}\n\n\tswitch (mode) {\n\tcase MPOL_DEFAULT:\n\t\tbreak;\n\tcase MPOL_PREFERRED:\n\t\tif (flags & MPOL_F_LOCAL)\n\t\t\tmode = MPOL_LOCAL;\n\t\telse\n\t\t\tnode_set(pol->v.preferred_node, nodes);\n\t\tbreak;\n\tcase MPOL_BIND:\n\tcase MPOL_INTERLEAVE:\n\t\tnodes = pol->v.nodes;\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tsnprintf(p, maxlen, \"unknown\");\n\t\treturn;\n\t}\n\n\tp += snprintf(p, maxlen, \"%s\", policy_modes[mode]);\n\n\tif (flags & MPOL_MODE_FLAGS) {\n\t\tp += snprintf(p, buffer + maxlen - p, \"=\");\n\n\t\t/*\n\t\t * Currently, the only defined flags are mutually exclusive\n\t\t */\n\t\tif (flags & MPOL_F_STATIC_NODES)\n\t\t\tp += snprintf(p, buffer + maxlen - p, \"static\");\n\t\telse if (flags & MPOL_F_RELATIVE_NODES)\n\t\t\tp += snprintf(p, buffer + maxlen - p, \"relative\");\n\t}\n\n\tif (!nodes_empty(nodes))\n\t\tp += scnprintf(p, buffer + maxlen - p, \":%*pbl\",\n\t\t\t       nodemask_pr_args(&nodes));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/swapops.h>",
            "#include <linux/printk.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/ctype.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/migrate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/swap.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/compat.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/export.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/mm.h>",
            "#include <linux/mempolicy.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct mempolicy default_policy = {\n\t.refcnt = ATOMIC_INIT(1), /* never free it */\n\t.mode = MPOL_PREFERRED,\n\t.flags = MPOL_F_LOCAL,\n};",
            "static void migrate_page_add(struct page *page, struct list_head *pagelist,\n\t\t\t\tunsigned long flags);",
            "static const char * const policy_modes[] =\n{\n\t[MPOL_DEFAULT]    = \"default\",\n\t[MPOL_PREFERRED]  = \"prefer\",\n\t[MPOL_BIND]       = \"bind\",\n\t[MPOL_INTERLEAVE] = \"interleave\",\n\t[MPOL_LOCAL]      = \"local\",\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <asm/tlbflush.h>\n#include <linux/swapops.h>\n#include <linux/printk.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mm_inline.h>\n#include <linux/ctype.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/migrate.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/swap.h>\n#include <linux/ptrace.h>\n#include <linux/compat.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/nsproxy.h>\n#include <linux/export.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/cpuset.h>\n#include <linux/nodemask.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/mm.h>\n#include <linux/mempolicy.h>\n\nstatic struct mempolicy default_policy = {\n\t.refcnt = ATOMIC_INIT(1), /* never free it */\n\t.mode = MPOL_PREFERRED,\n\t.flags = MPOL_F_LOCAL,\n};\nstatic void migrate_page_add(struct page *page, struct list_head *pagelist,\n\t\t\t\tunsigned long flags);\nstatic const char * const policy_modes[] =\n{\n\t[MPOL_DEFAULT]    = \"default\",\n\t[MPOL_PREFERRED]  = \"prefer\",\n\t[MPOL_BIND]       = \"bind\",\n\t[MPOL_INTERLEAVE] = \"interleave\",\n\t[MPOL_LOCAL]      = \"local\",\n};\n\nvoid mpol_to_str(char *buffer, int maxlen, struct mempolicy *pol)\n{\n\tchar *p = buffer;\n\tnodemask_t nodes = NODE_MASK_NONE;\n\tunsigned short mode = MPOL_DEFAULT;\n\tunsigned short flags = 0;\n\n\tif (pol && pol != &default_policy && !(pol->flags & MPOL_F_MORON)) {\n\t\tmode = pol->mode;\n\t\tflags = pol->flags;\n\t}\n\n\tswitch (mode) {\n\tcase MPOL_DEFAULT:\n\t\tbreak;\n\tcase MPOL_PREFERRED:\n\t\tif (flags & MPOL_F_LOCAL)\n\t\t\tmode = MPOL_LOCAL;\n\t\telse\n\t\t\tnode_set(pol->v.preferred_node, nodes);\n\t\tbreak;\n\tcase MPOL_BIND:\n\tcase MPOL_INTERLEAVE:\n\t\tnodes = pol->v.nodes;\n\t\tbreak;\n\tdefault:\n\t\tWARN_ON_ONCE(1);\n\t\tsnprintf(p, maxlen, \"unknown\");\n\t\treturn;\n\t}\n\n\tp += snprintf(p, maxlen, \"%s\", policy_modes[mode]);\n\n\tif (flags & MPOL_MODE_FLAGS) {\n\t\tp += snprintf(p, buffer + maxlen - p, \"=\");\n\n\t\t/*\n\t\t * Currently, the only defined flags are mutually exclusive\n\t\t */\n\t\tif (flags & MPOL_F_STATIC_NODES)\n\t\t\tp += snprintf(p, buffer + maxlen - p, \"static\");\n\t\telse if (flags & MPOL_F_RELATIVE_NODES)\n\t\t\tp += snprintf(p, buffer + maxlen - p, \"relative\");\n\t}\n\n\tif (!nodes_empty(nodes))\n\t\tp += scnprintf(p, buffer + maxlen - p, \":%*pbl\",\n\t\t\t       nodemask_pr_args(&nodes));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_show_mpol(struct seq_file *seq, struct mempolicy *mpol)\n{\n\tchar buffer[64];\n\n\tif (!mpol || mpol->mode == MPOL_DEFAULT)\n\t\treturn;\t\t/* show nothing */\n\n\tmpol_to_str(buffer, sizeof(buffer), mpol);\n\n\tseq_printf(seq, \",mpol=%s\", buffer);\n}"
  },
  {
    "function_name": "shmem_writepage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1247-1349",
    "snippet": "static int shmem_writepage(struct page *page, struct writeback_control *wbc)\n{\n\tstruct shmem_inode_info *info;\n\tstruct address_space *mapping;\n\tstruct inode *inode;\n\tswp_entry_t swap;\n\tpgoff_t index;\n\n\tVM_BUG_ON_PAGE(PageCompound(page), page);\n\tBUG_ON(!PageLocked(page));\n\tmapping = page->mapping;\n\tindex = page->index;\n\tinode = mapping->host;\n\tinfo = SHMEM_I(inode);\n\tif (info->flags & VM_LOCKED)\n\t\tgoto redirty;\n\tif (!total_swap_pages)\n\t\tgoto redirty;\n\n\t/*\n\t * Our capabilities prevent regular writeback or sync from ever calling\n\t * shmem_writepage; but a stacking filesystem might use ->writepage of\n\t * its underlying filesystem, in which case tmpfs should write out to\n\t * swap only in response to memory pressure, and not for the writeback\n\t * threads or sync.\n\t */\n\tif (!wbc->for_reclaim) {\n\t\tWARN_ON_ONCE(1);\t/* Still happens? Tell us about it! */\n\t\tgoto redirty;\n\t}\n\n\t/*\n\t * This is somewhat ridiculous, but without plumbing a SWAP_MAP_FALLOC\n\t * value into swapfile.c, the only way we can correctly account for a\n\t * fallocated page arriving here is now to initialize it and write it.\n\t *\n\t * That's okay for a page already fallocated earlier, but if we have\n\t * not yet completed the fallocation, then (a) we want to keep track\n\t * of this page in case we have to undo it, and (b) it may not be a\n\t * good idea to continue anyway, once we're pushing into swap.  So\n\t * reactivate the page, and let shmem_fallocate() quit when too many.\n\t */\n\tif (!PageUptodate(page)) {\n\t\tif (inode->i_private) {\n\t\t\tstruct shmem_falloc *shmem_falloc;\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tshmem_falloc = inode->i_private;\n\t\t\tif (shmem_falloc &&\n\t\t\t    !shmem_falloc->waitq &&\n\t\t\t    index >= shmem_falloc->start &&\n\t\t\t    index < shmem_falloc->next)\n\t\t\t\tshmem_falloc->nr_unswapped++;\n\t\t\telse\n\t\t\t\tshmem_falloc = NULL;\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tif (shmem_falloc)\n\t\t\t\tgoto redirty;\n\t\t}\n\t\tclear_highpage(page);\n\t\tflush_dcache_page(page);\n\t\tSetPageUptodate(page);\n\t}\n\n\tswap = get_swap_page(page);\n\tif (!swap.val)\n\t\tgoto redirty;\n\n\t/*\n\t * Add inode to shmem_unuse()'s list of swapped-out inodes,\n\t * if it's not already there.  Do it now before the page is\n\t * moved to swap cache, when its pagelock no longer protects\n\t * the inode from eviction.  But don't unlock the mutex until\n\t * we've incremented swapped, because shmem_unuse_inode() will\n\t * prune a !swapped inode from the swaplist under this mutex.\n\t */\n\tmutex_lock(&shmem_swaplist_mutex);\n\tif (list_empty(&info->swaplist))\n\t\tlist_add_tail(&info->swaplist, &shmem_swaplist);\n\n\tif (add_to_swap_cache(page, swap, GFP_ATOMIC) == 0) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tinfo->swapped++;\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tswap_shmem_alloc(swap);\n\t\tshmem_delete_from_page_cache(page, swp_to_radix_entry(swap));\n\n\t\tmutex_unlock(&shmem_swaplist_mutex);\n\t\tBUG_ON(page_mapped(page));\n\t\tswap_writepage(page, wbc);\n\t\treturn 0;\n\t}\n\n\tmutex_unlock(&shmem_swaplist_mutex);\n\tput_swap_page(page, swap);\nredirty:\n\tset_page_dirty(page);\n\tif (wbc->for_reclaim)\n\t\treturn AOP_WRITEPAGE_ACTIVATE;\t/* Return with page locked */\n\tunlock_page(page);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 1347
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "page"
          ],
          "line": 1344
        },
        "resolved": true,
        "details": {
          "function_name": "set_page_dirty_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "2573-2581",
          "snippet": "int set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_swap_page",
          "args": [
            "page",
            "swap"
          ],
          "line": 1342
        },
        "resolved": true,
        "details": {
          "function_name": "put_swap_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "1225-1270",
          "snippet": "void put_swap_page(struct page *page, swp_entry_t entry)\n{\n\tunsigned long offset = swp_offset(entry);\n\tunsigned long idx = offset / SWAPFILE_CLUSTER;\n\tstruct swap_cluster_info *ci;\n\tstruct swap_info_struct *si;\n\tunsigned char *map;\n\tunsigned int i, free_entries = 0;\n\tunsigned char val;\n\tint size = swap_entry_size(hpage_nr_pages(page));\n\n\tsi = _swap_info_get(entry);\n\tif (!si)\n\t\treturn;\n\n\tci = lock_cluster_or_swap_info(si, offset);\n\tif (size == SWAPFILE_CLUSTER) {\n\t\tVM_BUG_ON(!cluster_is_huge(ci));\n\t\tmap = si->swap_map + offset;\n\t\tfor (i = 0; i < SWAPFILE_CLUSTER; i++) {\n\t\t\tval = map[i];\n\t\t\tVM_BUG_ON(!(val & SWAP_HAS_CACHE));\n\t\t\tif (val == SWAP_HAS_CACHE)\n\t\t\t\tfree_entries++;\n\t\t}\n\t\tcluster_clear_huge(ci);\n\t\tif (free_entries == SWAPFILE_CLUSTER) {\n\t\t\tunlock_cluster_or_swap_info(si, ci);\n\t\t\tspin_lock(&si->lock);\n\t\t\tmem_cgroup_uncharge_swap(entry, SWAPFILE_CLUSTER);\n\t\t\tswap_free_cluster(si, idx);\n\t\t\tspin_unlock(&si->lock);\n\t\t\treturn;\n\t\t}\n\t}\n\tfor (i = 0; i < size; i++, entry.val++) {\n\t\tif (!__swap_entry_free_locked(si, offset + i, SWAP_HAS_CACHE)) {\n\t\t\tunlock_cluster_or_swap_info(si, ci);\n\t\t\tfree_swap_slot(entry);\n\t\t\tif (i == size - 1)\n\t\t\t\treturn;\n\t\t\tlock_cluster_or_swap_info(si, offset);\n\t\t}\n\t}\n\tunlock_cluster_or_swap_info(si, ci);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [
            "#define SWAPFILE_CLUSTER\t256",
            "#define SWAPFILE_CLUSTER\tHPAGE_PMD_NR"
          ],
          "globals_used": [
            "static void free_swap_count_continuations(struct swap_info_struct *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\n#define SWAPFILE_CLUSTER\t256\n#define SWAPFILE_CLUSTER\tHPAGE_PMD_NR\n\nstatic void free_swap_count_continuations(struct swap_info_struct *);\n\nvoid put_swap_page(struct page *page, swp_entry_t entry)\n{\n\tunsigned long offset = swp_offset(entry);\n\tunsigned long idx = offset / SWAPFILE_CLUSTER;\n\tstruct swap_cluster_info *ci;\n\tstruct swap_info_struct *si;\n\tunsigned char *map;\n\tunsigned int i, free_entries = 0;\n\tunsigned char val;\n\tint size = swap_entry_size(hpage_nr_pages(page));\n\n\tsi = _swap_info_get(entry);\n\tif (!si)\n\t\treturn;\n\n\tci = lock_cluster_or_swap_info(si, offset);\n\tif (size == SWAPFILE_CLUSTER) {\n\t\tVM_BUG_ON(!cluster_is_huge(ci));\n\t\tmap = si->swap_map + offset;\n\t\tfor (i = 0; i < SWAPFILE_CLUSTER; i++) {\n\t\t\tval = map[i];\n\t\t\tVM_BUG_ON(!(val & SWAP_HAS_CACHE));\n\t\t\tif (val == SWAP_HAS_CACHE)\n\t\t\t\tfree_entries++;\n\t\t}\n\t\tcluster_clear_huge(ci);\n\t\tif (free_entries == SWAPFILE_CLUSTER) {\n\t\t\tunlock_cluster_or_swap_info(si, ci);\n\t\t\tspin_lock(&si->lock);\n\t\t\tmem_cgroup_uncharge_swap(entry, SWAPFILE_CLUSTER);\n\t\t\tswap_free_cluster(si, idx);\n\t\t\tspin_unlock(&si->lock);\n\t\t\treturn;\n\t\t}\n\t}\n\tfor (i = 0; i < size; i++, entry.val++) {\n\t\tif (!__swap_entry_free_locked(si, offset + i, SWAP_HAS_CACHE)) {\n\t\t\tunlock_cluster_or_swap_info(si, ci);\n\t\t\tfree_swap_slot(entry);\n\t\t\tif (i == size - 1)\n\t\t\t\treturn;\n\t\t\tlock_cluster_or_swap_info(si, offset);\n\t\t}\n\t}\n\tunlock_cluster_or_swap_info(si, ci);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swap_writepage",
          "args": [
            "page",
            "wbc"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "swap_writepage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_io.c",
          "lines": "245-262",
          "snippet": "int swap_writepage(struct page *page, struct writeback_control *wbc)\n{\n\tint ret = 0;\n\n\tif (try_to_free_swap(page)) {\n\t\tunlock_page(page);\n\t\tgoto out;\n\t}\n\tif (frontswap_store(page) == 0) {\n\t\tset_page_writeback(page);\n\t\tunlock_page(page);\n\t\tend_page_writeback(page);\n\t\tgoto out;\n\t}\n\tret = __swap_writepage(page, wbc, end_swap_bio_write);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include <asm/pgtable.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/uio.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/swapops.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/pgtable.h>\n#include <linux/sched/task.h>\n#include <linux/uio.h>\n#include <linux/blkdev.h>\n#include <linux/frontswap.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n#include <linux/swapops.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/pagemap.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/mm.h>\n\nint swap_writepage(struct page *page, struct writeback_control *wbc)\n{\n\tint ret = 0;\n\n\tif (try_to_free_swap(page)) {\n\t\tunlock_page(page);\n\t\tgoto out;\n\t}\n\tif (frontswap_store(page) == 0) {\n\t\tset_page_writeback(page);\n\t\tunlock_page(page);\n\t\tend_page_writeback(page);\n\t\tgoto out;\n\t}\n\tret = __swap_writepage(page, wbc, end_swap_bio_write);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "page_mapped(page)"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_mapped",
          "args": [
            "page"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "page_mapped",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "470-486",
          "snippet": "bool page_mapped(struct page *page)\n{\n\tint i;\n\n\tif (likely(!PageCompound(page)))\n\t\treturn atomic_read(&page->_mapcount) >= 0;\n\tpage = compound_head(page);\n\tif (atomic_read(compound_mapcount_ptr(page)) >= 0)\n\t\treturn true;\n\tif (PageHuge(page))\n\t\treturn false;\n\tfor (i = 0; i < hpage_nr_pages(page); i++) {\n\t\tif (atomic_read(&page[i]._mapcount) >= 0)\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nbool page_mapped(struct page *page)\n{\n\tint i;\n\n\tif (likely(!PageCompound(page)))\n\t\treturn atomic_read(&page->_mapcount) >= 0;\n\tpage = compound_head(page);\n\tif (atomic_read(compound_mapcount_ptr(page)) >= 0)\n\t\treturn true;\n\tif (PageHuge(page))\n\t\treturn false;\n\tfor (i = 0; i < hpage_nr_pages(page); i++) {\n\t\tif (atomic_read(&page[i]._mapcount) >= 0)\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_delete_from_page_cache",
          "args": [
            "page",
            "swp_to_radix_entry(swap)"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_delete_from_page_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "634-650",
          "snippet": "static void shmem_delete_from_page_cache(struct page *page, void *radswap)\n{\n\tstruct address_space *mapping = page->mapping;\n\tint error;\n\n\tVM_BUG_ON_PAGE(PageCompound(page), page);\n\n\txa_lock_irq(&mapping->i_pages);\n\terror = shmem_replace_entry(mapping, page->index, page, radswap);\n\tpage->mapping = NULL;\n\tmapping->nrpages--;\n\t__dec_node_page_state(page, NR_FILE_PAGES);\n\t__dec_node_page_state(page, NR_SHMEM);\n\txa_unlock_irq(&mapping->i_pages);\n\tput_page(page);\n\tBUG_ON(error);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_delete_from_page_cache(struct page *page, void *radswap)\n{\n\tstruct address_space *mapping = page->mapping;\n\tint error;\n\n\tVM_BUG_ON_PAGE(PageCompound(page), page);\n\n\txa_lock_irq(&mapping->i_pages);\n\terror = shmem_replace_entry(mapping, page->index, page, radswap);\n\tpage->mapping = NULL;\n\tmapping->nrpages--;\n\t__dec_node_page_state(page, NR_FILE_PAGES);\n\t__dec_node_page_state(page, NR_SHMEM);\n\txa_unlock_irq(&mapping->i_pages);\n\tput_page(page);\n\tBUG_ON(error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "swp_to_radix_entry",
          "args": [
            "swap"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swap_shmem_alloc",
          "args": [
            "swap"
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "swap_shmem_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "3431-3434",
          "snippet": "void swap_shmem_alloc(swp_entry_t entry)\n{\n\t__swap_duplicate(entry, SWAP_MAP_SHMEM);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nvoid swap_shmem_alloc(swp_entry_t entry)\n{\n\t__swap_duplicate(entry, SWAP_MAP_SHMEM);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_recalc_inode",
          "args": [
            "inode"
          ],
          "line": 1328
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_recalc_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "279-290",
          "snippet": "static void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_to_swap_cache",
          "args": [
            "page",
            "swap",
            "GFP_ATOMIC"
          ],
          "line": 1326
        },
        "resolved": true,
        "details": {
          "function_name": "add_to_swap_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap_state.c",
          "lines": "113-151",
          "snippet": "int add_to_swap_cache(struct page *page, swp_entry_t entry, gfp_t gfp)\n{\n\tstruct address_space *address_space = swap_address_space(entry);\n\tpgoff_t idx = swp_offset(entry);\n\tXA_STATE_ORDER(xas, &address_space->i_pages, idx, compound_order(page));\n\tunsigned long i, nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(PageSwapCache(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\n\tpage_ref_add(page, nr);\n\tSetPageSwapCache(page);\n\n\tdo {\n\t\txas_lock_irq(&xas);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\n\t\tfor (i = 0; i < nr; i++) {\n\t\t\tVM_BUG_ON_PAGE(xas.xa_index != idx + i, page);\n\t\t\tset_page_private(page + i, entry.val + i);\n\t\t\txas_store(&xas, page + i);\n\t\t\txas_next(&xas);\n\t\t}\n\t\taddress_space->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\tADD_CACHE_INFO(add_total, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (!xas_error(&xas))\n\t\treturn 0;\n\n\tClearPageSwapCache(page);\n\tpage_ref_sub(page, nr);\n\treturn xas_error(&xas);\n}",
          "includes": [
            "#include <asm/pgtable.h>",
            "#include <linux/huge_mm.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/migrate.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/pgtable.h>\n#include <linux/huge_mm.h>\n#include <linux/swap_slots.h>\n#include <linux/vmalloc.h>\n#include <linux/migrate.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/backing-dev.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/gfp.h>\n#include <linux/mm.h>\n\nint add_to_swap_cache(struct page *page, swp_entry_t entry, gfp_t gfp)\n{\n\tstruct address_space *address_space = swap_address_space(entry);\n\tpgoff_t idx = swp_offset(entry);\n\tXA_STATE_ORDER(xas, &address_space->i_pages, idx, compound_order(page));\n\tunsigned long i, nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(PageSwapCache(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\n\tpage_ref_add(page, nr);\n\tSetPageSwapCache(page);\n\n\tdo {\n\t\txas_lock_irq(&xas);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\n\t\tfor (i = 0; i < nr; i++) {\n\t\t\tVM_BUG_ON_PAGE(xas.xa_index != idx + i, page);\n\t\t\tset_page_private(page + i, entry.val + i);\n\t\t\txas_store(&xas, page + i);\n\t\t\txas_next(&xas);\n\t\t}\n\t\taddress_space->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\tADD_CACHE_INFO(add_total, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (!xas_error(&xas))\n\t\treturn 0;\n\n\tClearPageSwapCache(page);\n\tpage_ref_sub(page, nr);\n\treturn xas_error(&xas);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&info->swaplist",
            "&shmem_swaplist"
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&info->swaplist"
          ],
          "line": 1323
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_swap_page",
          "args": [
            "page"
          ],
          "line": 1310
        },
        "resolved": true,
        "details": {
          "function_name": "get_swap_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap_slots.c",
          "lines": "310-360",
          "snippet": "swp_entry_t get_swap_page(struct page *page)\n{\n\tswp_entry_t entry, *pentry;\n\tstruct swap_slots_cache *cache;\n\n\tentry.val = 0;\n\n\tif (PageTransHuge(page)) {\n\t\tif (IS_ENABLED(CONFIG_THP_SWAP))\n\t\t\tget_swap_pages(1, &entry, HPAGE_PMD_NR);\n\t\tgoto out;\n\t}\n\n\t/*\n\t * Preemption is allowed here, because we may sleep\n\t * in refill_swap_slots_cache().  But it is safe, because\n\t * accesses to the per-CPU data structure are protected by the\n\t * mutex cache->alloc_lock.\n\t *\n\t * The alloc path here does not touch cache->slots_ret\n\t * so cache->free_lock is not taken.\n\t */\n\tcache = raw_cpu_ptr(&swp_slots);\n\n\tif (likely(check_cache_active() && cache->slots)) {\n\t\tmutex_lock(&cache->alloc_lock);\n\t\tif (cache->slots) {\nrepeat:\n\t\t\tif (cache->nr) {\n\t\t\t\tpentry = &cache->slots[cache->cur++];\n\t\t\t\tentry = *pentry;\n\t\t\t\tpentry->val = 0;\n\t\t\t\tcache->nr--;\n\t\t\t} else {\n\t\t\t\tif (refill_swap_slots_cache(cache))\n\t\t\t\t\tgoto repeat;\n\t\t\t}\n\t\t}\n\t\tmutex_unlock(&cache->alloc_lock);\n\t\tif (entry.val)\n\t\t\tgoto out;\n\t}\n\n\tget_swap_pages(1, &entry, 1);\nout:\n\tif (mem_cgroup_try_charge_swap(page, entry)) {\n\t\tput_swap_page(page, entry);\n\t\tentry.val = 0;\n\t}\n\treturn entry;\n}",
          "includes": [
            "#include <linux/mm.h>",
            "#include <linux/mutex.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_slots.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct swap_slots_cache, swp_slots);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/mm.h>\n#include <linux/mutex.h>\n#include <linux/vmalloc.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/swap_slots.h>\n\nstatic DEFINE_PER_CPU(struct swap_slots_cache, swp_slots);\n\nswp_entry_t get_swap_page(struct page *page)\n{\n\tswp_entry_t entry, *pentry;\n\tstruct swap_slots_cache *cache;\n\n\tentry.val = 0;\n\n\tif (PageTransHuge(page)) {\n\t\tif (IS_ENABLED(CONFIG_THP_SWAP))\n\t\t\tget_swap_pages(1, &entry, HPAGE_PMD_NR);\n\t\tgoto out;\n\t}\n\n\t/*\n\t * Preemption is allowed here, because we may sleep\n\t * in refill_swap_slots_cache().  But it is safe, because\n\t * accesses to the per-CPU data structure are protected by the\n\t * mutex cache->alloc_lock.\n\t *\n\t * The alloc path here does not touch cache->slots_ret\n\t * so cache->free_lock is not taken.\n\t */\n\tcache = raw_cpu_ptr(&swp_slots);\n\n\tif (likely(check_cache_active() && cache->slots)) {\n\t\tmutex_lock(&cache->alloc_lock);\n\t\tif (cache->slots) {\nrepeat:\n\t\t\tif (cache->nr) {\n\t\t\t\tpentry = &cache->slots[cache->cur++];\n\t\t\t\tentry = *pentry;\n\t\t\t\tpentry->val = 0;\n\t\t\t\tcache->nr--;\n\t\t\t} else {\n\t\t\t\tif (refill_swap_slots_cache(cache))\n\t\t\t\t\tgoto repeat;\n\t\t\t}\n\t\t}\n\t\tmutex_unlock(&cache->alloc_lock);\n\t\tif (entry.val)\n\t\t\tgoto out;\n\t}\n\n\tget_swap_pages(1, &entry, 1);\nout:\n\tif (mem_cgroup_try_charge_swap(page, entry)) {\n\t\tput_swap_page(page, entry);\n\t\tentry.val = 0;\n\t}\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetPageUptodate",
          "args": [
            "page"
          ],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_dcache_page",
          "args": [
            "page"
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "page"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&inode->i_lock"
          ],
          "line": 1292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 1289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 1260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!PageLocked(page)"
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageLocked",
          "args": [
            "page"
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "PageCompound(page)",
            "page"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageCompound",
          "args": [
            "page"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_writepage(struct page *page, struct writeback_control *wbc)\n{\n\tstruct shmem_inode_info *info;\n\tstruct address_space *mapping;\n\tstruct inode *inode;\n\tswp_entry_t swap;\n\tpgoff_t index;\n\n\tVM_BUG_ON_PAGE(PageCompound(page), page);\n\tBUG_ON(!PageLocked(page));\n\tmapping = page->mapping;\n\tindex = page->index;\n\tinode = mapping->host;\n\tinfo = SHMEM_I(inode);\n\tif (info->flags & VM_LOCKED)\n\t\tgoto redirty;\n\tif (!total_swap_pages)\n\t\tgoto redirty;\n\n\t/*\n\t * Our capabilities prevent regular writeback or sync from ever calling\n\t * shmem_writepage; but a stacking filesystem might use ->writepage of\n\t * its underlying filesystem, in which case tmpfs should write out to\n\t * swap only in response to memory pressure, and not for the writeback\n\t * threads or sync.\n\t */\n\tif (!wbc->for_reclaim) {\n\t\tWARN_ON_ONCE(1);\t/* Still happens? Tell us about it! */\n\t\tgoto redirty;\n\t}\n\n\t/*\n\t * This is somewhat ridiculous, but without plumbing a SWAP_MAP_FALLOC\n\t * value into swapfile.c, the only way we can correctly account for a\n\t * fallocated page arriving here is now to initialize it and write it.\n\t *\n\t * That's okay for a page already fallocated earlier, but if we have\n\t * not yet completed the fallocation, then (a) we want to keep track\n\t * of this page in case we have to undo it, and (b) it may not be a\n\t * good idea to continue anyway, once we're pushing into swap.  So\n\t * reactivate the page, and let shmem_fallocate() quit when too many.\n\t */\n\tif (!PageUptodate(page)) {\n\t\tif (inode->i_private) {\n\t\t\tstruct shmem_falloc *shmem_falloc;\n\t\t\tspin_lock(&inode->i_lock);\n\t\t\tshmem_falloc = inode->i_private;\n\t\t\tif (shmem_falloc &&\n\t\t\t    !shmem_falloc->waitq &&\n\t\t\t    index >= shmem_falloc->start &&\n\t\t\t    index < shmem_falloc->next)\n\t\t\t\tshmem_falloc->nr_unswapped++;\n\t\t\telse\n\t\t\t\tshmem_falloc = NULL;\n\t\t\tspin_unlock(&inode->i_lock);\n\t\t\tif (shmem_falloc)\n\t\t\t\tgoto redirty;\n\t\t}\n\t\tclear_highpage(page);\n\t\tflush_dcache_page(page);\n\t\tSetPageUptodate(page);\n\t}\n\n\tswap = get_swap_page(page);\n\tif (!swap.val)\n\t\tgoto redirty;\n\n\t/*\n\t * Add inode to shmem_unuse()'s list of swapped-out inodes,\n\t * if it's not already there.  Do it now before the page is\n\t * moved to swap cache, when its pagelock no longer protects\n\t * the inode from eviction.  But don't unlock the mutex until\n\t * we've incremented swapped, because shmem_unuse_inode() will\n\t * prune a !swapped inode from the swaplist under this mutex.\n\t */\n\tmutex_lock(&shmem_swaplist_mutex);\n\tif (list_empty(&info->swaplist))\n\t\tlist_add_tail(&info->swaplist, &shmem_swaplist);\n\n\tif (add_to_swap_cache(page, swap, GFP_ATOMIC) == 0) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tinfo->swapped++;\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tswap_shmem_alloc(swap);\n\t\tshmem_delete_from_page_cache(page, swp_to_radix_entry(swap));\n\n\t\tmutex_unlock(&shmem_swaplist_mutex);\n\t\tBUG_ON(page_mapped(page));\n\t\tswap_writepage(page, wbc);\n\t\treturn 0;\n\t}\n\n\tmutex_unlock(&shmem_swaplist_mutex);\n\tput_swap_page(page, swap);\nredirty:\n\tset_page_dirty(page);\n\tif (wbc->for_reclaim)\n\t\treturn AOP_WRITEPAGE_ACTIVATE;\t/* Return with page locked */\n\tunlock_page(page);\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_unuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1192-1242",
    "snippet": "int shmem_unuse(swp_entry_t swap, struct page *page)\n{\n\tstruct list_head *this, *next;\n\tstruct shmem_inode_info *info;\n\tstruct mem_cgroup *memcg;\n\tint error = 0;\n\n\t/*\n\t * There's a faint possibility that swap page was replaced before\n\t * caller locked it: caller will come back later with the right page.\n\t */\n\tif (unlikely(!PageSwapCache(page) || page_private(page) != swap.val))\n\t\tgoto out;\n\n\t/*\n\t * Charge page using GFP_KERNEL while we can wait, before taking\n\t * the shmem_swaplist_mutex which might hold up shmem_writepage().\n\t * Charged back to the user (not to caller) when swap account is used.\n\t */\n\terror = mem_cgroup_try_charge_delay(page, current->mm, GFP_KERNEL,\n\t\t\t\t\t    &memcg, false);\n\tif (error)\n\t\tgoto out;\n\t/* No memory allocation: swap entry occupies the slot for the page */\n\terror = -EAGAIN;\n\n\tmutex_lock(&shmem_swaplist_mutex);\n\tlist_for_each_safe(this, next, &shmem_swaplist) {\n\t\tinfo = list_entry(this, struct shmem_inode_info, swaplist);\n\t\tif (info->swapped)\n\t\t\terror = shmem_unuse_inode(info, swap, &page);\n\t\telse\n\t\t\tlist_del_init(&info->swaplist);\n\t\tcond_resched();\n\t\tif (error != -EAGAIN)\n\t\t\tbreak;\n\t\t/* found nothing in this: move on to search the next */\n\t}\n\tmutex_unlock(&shmem_swaplist_mutex);\n\n\tif (error) {\n\t\tif (error != -ENOMEM)\n\t\t\terror = 0;\n\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t} else\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\nout:\n\tunlock_page(page);\n\tput_page(page);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 1239
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mem_cgroup_commit_charge",
          "args": [
            "page",
            "memcg",
            "true",
            "false"
          ],
          "line": 1237
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_commit_charge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5928-5962",
          "snippet": "void mem_cgroup_commit_charge(struct page *page, struct mem_cgroup *memcg,\n\t\t\t      bool lrucare, bool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tVM_BUG_ON_PAGE(!page->mapping, page);\n\tVM_BUG_ON_PAGE(PageLRU(page) && !lrucare, page);\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcommit_charge(page, memcg, lrucare);\n\n\tlocal_irq_disable();\n\tmem_cgroup_charge_statistics(memcg, page, compound, nr_pages);\n\tmemcg_check_events(memcg, page);\n\tlocal_irq_enable();\n\n\tif (do_memsw_account() && PageSwapCache(page)) {\n\t\tswp_entry_t entry = { .val = page_private(page) };\n\t\t/*\n\t\t * The swap entry might not get freed for a long time,\n\t\t * let's not wait for it.  The page already received a\n\t\t * memory+swap charge, drop the swap entry duplicate.\n\t\t */\n\t\tmem_cgroup_uncharge_swap(entry, nr_pages);\n\t}\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nvoid mem_cgroup_commit_charge(struct page *page, struct mem_cgroup *memcg,\n\t\t\t      bool lrucare, bool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tVM_BUG_ON_PAGE(!page->mapping, page);\n\tVM_BUG_ON_PAGE(PageLRU(page) && !lrucare, page);\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcommit_charge(page, memcg, lrucare);\n\n\tlocal_irq_disable();\n\tmem_cgroup_charge_statistics(memcg, page, compound, nr_pages);\n\tmemcg_check_events(memcg, page);\n\tlocal_irq_enable();\n\n\tif (do_memsw_account() && PageSwapCache(page)) {\n\t\tswp_entry_t entry = { .val = page_private(page) };\n\t\t/*\n\t\t * The swap entry might not get freed for a long time,\n\t\t * let's not wait for it.  The page already received a\n\t\t * memory+swap charge, drop the swap entry duplicate.\n\t\t */\n\t\tmem_cgroup_uncharge_swap(entry, nr_pages);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "mem_cgroup_cancel_charge",
          "args": [
            "page",
            "memcg",
            "false"
          ],
          "line": 1235
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_cancel_charge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5972-5988",
          "snippet": "void mem_cgroup_cancel_charge(struct page *page, struct mem_cgroup *memcg,\n\t\tbool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcancel_charge(memcg, nr_pages);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nvoid mem_cgroup_cancel_charge(struct page *page, struct mem_cgroup *memcg,\n\t\tbool compound)\n{\n\tunsigned int nr_pages = compound ? hpage_nr_pages(page) : 1;\n\n\tif (mem_cgroup_disabled())\n\t\treturn;\n\t/*\n\t * Swap faults will attempt to charge the same page multiple\n\t * times.  But reuse_swap_page() might have removed the page\n\t * from swapcache already, so we can't check PageSwapCache().\n\t */\n\tif (!memcg)\n\t\treturn;\n\n\tcancel_charge(memcg, nr_pages);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&info->swaplist"
          ],
          "line": 1224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_unuse_inode",
          "args": [
            "info",
            "swap",
            "&page"
          ],
          "line": 1222
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unuse_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1114-1187",
          "snippet": "static int shmem_unuse_inode(struct shmem_inode_info *info,\n\t\t\t     swp_entry_t swap, struct page **pagep)\n{\n\tstruct address_space *mapping = info->vfs_inode.i_mapping;\n\tvoid *radswap;\n\tpgoff_t index;\n\tgfp_t gfp;\n\tint error = 0;\n\n\tradswap = swp_to_radix_entry(swap);\n\tindex = find_swap_entry(&mapping->i_pages, radswap);\n\tif (index == -1)\n\t\treturn -EAGAIN;\t/* tell shmem_unuse we found nothing */\n\n\t/*\n\t * Move _head_ to start search for next from here.\n\t * But be careful: shmem_evict_inode checks list_empty without taking\n\t * mutex, and there's an instant in list_move_tail when info->swaplist\n\t * would appear empty, if it were the only one on shmem_swaplist.\n\t */\n\tif (shmem_swaplist.next != &info->swaplist)\n\t\tlist_move_tail(&shmem_swaplist, &info->swaplist);\n\n\tgfp = mapping_gfp_mask(mapping);\n\tif (shmem_should_replace_page(*pagep, gfp)) {\n\t\tmutex_unlock(&shmem_swaplist_mutex);\n\t\terror = shmem_replace_page(pagep, gfp, info, index);\n\t\tmutex_lock(&shmem_swaplist_mutex);\n\t\t/*\n\t\t * We needed to drop mutex to make that restrictive page\n\t\t * allocation, but the inode might have been freed while we\n\t\t * dropped it: although a racing shmem_evict_inode() cannot\n\t\t * complete without emptying the page cache, our page lock\n\t\t * on this swapcache page is not enough to prevent that -\n\t\t * free_swap_and_cache() of our swap entry will only\n\t\t * trylock_page(), removing swap from page cache whatever.\n\t\t *\n\t\t * We must not proceed to shmem_add_to_page_cache() if the\n\t\t * inode has been freed, but of course we cannot rely on\n\t\t * inode or mapping or info to check that.  However, we can\n\t\t * safely check if our swap entry is still in use (and here\n\t\t * it can't have got reused for another page): if it's still\n\t\t * in use, then the inode cannot have been freed yet, and we\n\t\t * can safely proceed (if it's no longer in use, that tells\n\t\t * nothing about the inode, but we don't need to unuse swap).\n\t\t */\n\t\tif (!page_swapcount(*pagep))\n\t\t\terror = -ENOENT;\n\t}\n\n\t/*\n\t * We rely on shmem_swaplist_mutex, not only to protect the swaplist,\n\t * but also to hold up shmem_evict_inode(): so inode cannot be freed\n\t * beneath us (pagelock doesn't help until the page is in pagecache).\n\t */\n\tif (!error)\n\t\terror = shmem_add_to_page_cache(*pagep, mapping, index,\n\t\t\t\t\t\tradswap, gfp);\n\tif (error != -ENOMEM) {\n\t\t/*\n\t\t * Truncation and eviction use free_swap_and_cache(), which\n\t\t * only does trylock page: if we raced, best clean up here.\n\t\t */\n\t\tdelete_from_swap_cache(*pagep);\n\t\tset_page_dirty(*pagep);\n\t\tif (!error) {\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tinfo->swapped--;\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t\tswap_free(swap);\n\t\t}\n\t}\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_unuse_inode(struct shmem_inode_info *info,\n\t\t\t     swp_entry_t swap, struct page **pagep)\n{\n\tstruct address_space *mapping = info->vfs_inode.i_mapping;\n\tvoid *radswap;\n\tpgoff_t index;\n\tgfp_t gfp;\n\tint error = 0;\n\n\tradswap = swp_to_radix_entry(swap);\n\tindex = find_swap_entry(&mapping->i_pages, radswap);\n\tif (index == -1)\n\t\treturn -EAGAIN;\t/* tell shmem_unuse we found nothing */\n\n\t/*\n\t * Move _head_ to start search for next from here.\n\t * But be careful: shmem_evict_inode checks list_empty without taking\n\t * mutex, and there's an instant in list_move_tail when info->swaplist\n\t * would appear empty, if it were the only one on shmem_swaplist.\n\t */\n\tif (shmem_swaplist.next != &info->swaplist)\n\t\tlist_move_tail(&shmem_swaplist, &info->swaplist);\n\n\tgfp = mapping_gfp_mask(mapping);\n\tif (shmem_should_replace_page(*pagep, gfp)) {\n\t\tmutex_unlock(&shmem_swaplist_mutex);\n\t\terror = shmem_replace_page(pagep, gfp, info, index);\n\t\tmutex_lock(&shmem_swaplist_mutex);\n\t\t/*\n\t\t * We needed to drop mutex to make that restrictive page\n\t\t * allocation, but the inode might have been freed while we\n\t\t * dropped it: although a racing shmem_evict_inode() cannot\n\t\t * complete without emptying the page cache, our page lock\n\t\t * on this swapcache page is not enough to prevent that -\n\t\t * free_swap_and_cache() of our swap entry will only\n\t\t * trylock_page(), removing swap from page cache whatever.\n\t\t *\n\t\t * We must not proceed to shmem_add_to_page_cache() if the\n\t\t * inode has been freed, but of course we cannot rely on\n\t\t * inode or mapping or info to check that.  However, we can\n\t\t * safely check if our swap entry is still in use (and here\n\t\t * it can't have got reused for another page): if it's still\n\t\t * in use, then the inode cannot have been freed yet, and we\n\t\t * can safely proceed (if it's no longer in use, that tells\n\t\t * nothing about the inode, but we don't need to unuse swap).\n\t\t */\n\t\tif (!page_swapcount(*pagep))\n\t\t\terror = -ENOENT;\n\t}\n\n\t/*\n\t * We rely on shmem_swaplist_mutex, not only to protect the swaplist,\n\t * but also to hold up shmem_evict_inode(): so inode cannot be freed\n\t * beneath us (pagelock doesn't help until the page is in pagecache).\n\t */\n\tif (!error)\n\t\terror = shmem_add_to_page_cache(*pagep, mapping, index,\n\t\t\t\t\t\tradswap, gfp);\n\tif (error != -ENOMEM) {\n\t\t/*\n\t\t * Truncation and eviction use free_swap_and_cache(), which\n\t\t * only does trylock page: if we raced, best clean up here.\n\t\t */\n\t\tdelete_from_swap_cache(*pagep);\n\t\tset_page_dirty(*pagep);\n\t\tif (!error) {\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tinfo->swapped--;\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t\tswap_free(swap);\n\t\t}\n\t}\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "this",
            "structshmem_inode_info",
            "swaplist"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_safe",
          "args": [
            "this",
            "next",
            "&shmem_swaplist"
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cgroup_try_charge_delay",
          "args": [
            "page",
            "current->mm",
            "GFP_KERNEL",
            "&memcg",
            "false"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "mem_cgroup_try_charge_delay",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "5898-5909",
          "snippet": "int mem_cgroup_try_charge_delay(struct page *page, struct mm_struct *mm,\n\t\t\t  gfp_t gfp_mask, struct mem_cgroup **memcgp,\n\t\t\t  bool compound)\n{\n\tstruct mem_cgroup *memcg;\n\tint ret;\n\n\tret = mem_cgroup_try_charge(page, mm, gfp_mask, memcgp, compound);\n\tmemcg = *memcgp;\n\tmem_cgroup_throttle_swaprate(memcg, page_to_nid(page), gfp_mask);\n\treturn ret;\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void mem_cgroup_threshold(struct mem_cgroup *memcg);",
            "static void mem_cgroup_oom_notify(struct mem_cgroup *memcg);",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic void mem_cgroup_threshold(struct mem_cgroup *memcg);\nstatic void mem_cgroup_oom_notify(struct mem_cgroup *memcg);\nstatic __always_inline struct;\n\nint mem_cgroup_try_charge_delay(struct page *page, struct mm_struct *mm,\n\t\t\t  gfp_t gfp_mask, struct mem_cgroup **memcgp,\n\t\t\t  bool compound)\n{\n\tstruct mem_cgroup *memcg;\n\tint ret;\n\n\tret = mem_cgroup_try_charge(page, mm, gfp_mask, memcgp, compound);\n\tmemcg = *memcgp;\n\tmem_cgroup_throttle_swaprate(memcg, page_to_nid(page), gfp_mask);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!PageSwapCache(page) || page_private(page) != swap.val"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_private",
          "args": [
            "page"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageSwapCache",
          "args": [
            "page"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_unuse(swp_entry_t swap, struct page *page)\n{\n\tstruct list_head *this, *next;\n\tstruct shmem_inode_info *info;\n\tstruct mem_cgroup *memcg;\n\tint error = 0;\n\n\t/*\n\t * There's a faint possibility that swap page was replaced before\n\t * caller locked it: caller will come back later with the right page.\n\t */\n\tif (unlikely(!PageSwapCache(page) || page_private(page) != swap.val))\n\t\tgoto out;\n\n\t/*\n\t * Charge page using GFP_KERNEL while we can wait, before taking\n\t * the shmem_swaplist_mutex which might hold up shmem_writepage().\n\t * Charged back to the user (not to caller) when swap account is used.\n\t */\n\terror = mem_cgroup_try_charge_delay(page, current->mm, GFP_KERNEL,\n\t\t\t\t\t    &memcg, false);\n\tif (error)\n\t\tgoto out;\n\t/* No memory allocation: swap entry occupies the slot for the page */\n\terror = -EAGAIN;\n\n\tmutex_lock(&shmem_swaplist_mutex);\n\tlist_for_each_safe(this, next, &shmem_swaplist) {\n\t\tinfo = list_entry(this, struct shmem_inode_info, swaplist);\n\t\tif (info->swapped)\n\t\t\terror = shmem_unuse_inode(info, swap, &page);\n\t\telse\n\t\t\tlist_del_init(&info->swaplist);\n\t\tcond_resched();\n\t\tif (error != -EAGAIN)\n\t\t\tbreak;\n\t\t/* found nothing in this: move on to search the next */\n\t}\n\tmutex_unlock(&shmem_swaplist_mutex);\n\n\tif (error) {\n\t\tif (error != -ENOMEM)\n\t\t\terror = 0;\n\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t} else\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\nout:\n\tunlock_page(page);\n\tput_page(page);\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_unuse_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1114-1187",
    "snippet": "static int shmem_unuse_inode(struct shmem_inode_info *info,\n\t\t\t     swp_entry_t swap, struct page **pagep)\n{\n\tstruct address_space *mapping = info->vfs_inode.i_mapping;\n\tvoid *radswap;\n\tpgoff_t index;\n\tgfp_t gfp;\n\tint error = 0;\n\n\tradswap = swp_to_radix_entry(swap);\n\tindex = find_swap_entry(&mapping->i_pages, radswap);\n\tif (index == -1)\n\t\treturn -EAGAIN;\t/* tell shmem_unuse we found nothing */\n\n\t/*\n\t * Move _head_ to start search for next from here.\n\t * But be careful: shmem_evict_inode checks list_empty without taking\n\t * mutex, and there's an instant in list_move_tail when info->swaplist\n\t * would appear empty, if it were the only one on shmem_swaplist.\n\t */\n\tif (shmem_swaplist.next != &info->swaplist)\n\t\tlist_move_tail(&shmem_swaplist, &info->swaplist);\n\n\tgfp = mapping_gfp_mask(mapping);\n\tif (shmem_should_replace_page(*pagep, gfp)) {\n\t\tmutex_unlock(&shmem_swaplist_mutex);\n\t\terror = shmem_replace_page(pagep, gfp, info, index);\n\t\tmutex_lock(&shmem_swaplist_mutex);\n\t\t/*\n\t\t * We needed to drop mutex to make that restrictive page\n\t\t * allocation, but the inode might have been freed while we\n\t\t * dropped it: although a racing shmem_evict_inode() cannot\n\t\t * complete without emptying the page cache, our page lock\n\t\t * on this swapcache page is not enough to prevent that -\n\t\t * free_swap_and_cache() of our swap entry will only\n\t\t * trylock_page(), removing swap from page cache whatever.\n\t\t *\n\t\t * We must not proceed to shmem_add_to_page_cache() if the\n\t\t * inode has been freed, but of course we cannot rely on\n\t\t * inode or mapping or info to check that.  However, we can\n\t\t * safely check if our swap entry is still in use (and here\n\t\t * it can't have got reused for another page): if it's still\n\t\t * in use, then the inode cannot have been freed yet, and we\n\t\t * can safely proceed (if it's no longer in use, that tells\n\t\t * nothing about the inode, but we don't need to unuse swap).\n\t\t */\n\t\tif (!page_swapcount(*pagep))\n\t\t\terror = -ENOENT;\n\t}\n\n\t/*\n\t * We rely on shmem_swaplist_mutex, not only to protect the swaplist,\n\t * but also to hold up shmem_evict_inode(): so inode cannot be freed\n\t * beneath us (pagelock doesn't help until the page is in pagecache).\n\t */\n\tif (!error)\n\t\terror = shmem_add_to_page_cache(*pagep, mapping, index,\n\t\t\t\t\t\tradswap, gfp);\n\tif (error != -ENOMEM) {\n\t\t/*\n\t\t * Truncation and eviction use free_swap_and_cache(), which\n\t\t * only does trylock page: if we raced, best clean up here.\n\t\t */\n\t\tdelete_from_swap_cache(*pagep);\n\t\tset_page_dirty(*pagep);\n\t\tif (!error) {\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tinfo->swapped--;\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t\tswap_free(swap);\n\t\t}\n\t}\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "swap_free",
          "args": [
            "swap"
          ],
          "line": 1183
        },
        "resolved": true,
        "details": {
          "function_name": "swap_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "1213-1220",
          "snippet": "void swap_free(swp_entry_t entry)\n{\n\tstruct swap_info_struct *p;\n\n\tp = _swap_info_get(entry);\n\tif (p)\n\t\t__swap_entry_free(p, entry, 1);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_swap_count_continuations(struct swap_info_struct *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic void free_swap_count_continuations(struct swap_info_struct *);\n\nvoid swap_free(swp_entry_t entry)\n{\n\tstruct swap_info_struct *p;\n\n\tp = _swap_info_get(entry);\n\tif (p)\n\t\t__swap_entry_free(p, entry, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 1180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "*pagep"
          ],
          "line": 1178
        },
        "resolved": true,
        "details": {
          "function_name": "set_page_dirty_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "2573-2581",
          "snippet": "int set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "delete_from_swap_cache",
          "args": [
            "*pagep"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "delete_from_swap_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap_state.c",
          "lines": "243-254",
          "snippet": "void delete_from_swap_cache(struct page *page)\n{\n\tswp_entry_t entry = { .val = page_private(page) };\n\tstruct address_space *address_space = swap_address_space(entry);\n\n\txa_lock_irq(&address_space->i_pages);\n\t__delete_from_swap_cache(page, entry);\n\txa_unlock_irq(&address_space->i_pages);\n\n\tput_swap_page(page, entry);\n\tpage_ref_sub(page, hpage_nr_pages(page));\n}",
          "includes": [
            "#include <asm/pgtable.h>",
            "#include <linux/huge_mm.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/migrate.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/pgtable.h>\n#include <linux/huge_mm.h>\n#include <linux/swap_slots.h>\n#include <linux/vmalloc.h>\n#include <linux/migrate.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/backing-dev.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/gfp.h>\n#include <linux/mm.h>\n\nvoid delete_from_swap_cache(struct page *page)\n{\n\tswp_entry_t entry = { .val = page_private(page) };\n\tstruct address_space *address_space = swap_address_space(entry);\n\n\txa_lock_irq(&address_space->i_pages);\n\t__delete_from_swap_cache(page, entry);\n\txa_unlock_irq(&address_space->i_pages);\n\n\tput_swap_page(page, entry);\n\tpage_ref_sub(page, hpage_nr_pages(page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_add_to_page_cache",
          "args": [
            "*pagep",
            "mapping",
            "index",
            "radswap",
            "gfp"
          ],
          "line": 1170
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_add_to_page_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "578-629",
          "snippet": "static int shmem_add_to_page_cache(struct page *page,\n\t\t\t\t   struct address_space *mapping,\n\t\t\t\t   pgoff_t index, void *expected, gfp_t gfp)\n{\n\tXA_STATE_ORDER(xas, &mapping->i_pages, index, compound_order(page));\n\tunsigned long i = 0;\n\tunsigned long nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(PageTail(page), page);\n\tVM_BUG_ON_PAGE(index != round_down(index, nr), page);\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\tVM_BUG_ON(expected && PageTransHuge(page));\n\n\tpage_ref_add(page, nr);\n\tpage->mapping = mapping;\n\tpage->index = index;\n\n\tdo {\n\t\tvoid *entry;\n\t\txas_lock_irq(&xas);\n\t\tentry = xas_find_conflict(&xas);\n\t\tif (entry != expected)\n\t\t\txas_set_err(&xas, -EEXIST);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\nnext:\n\t\txas_store(&xas, page + i);\n\t\tif (++i < nr) {\n\t\t\txas_next(&xas);\n\t\t\tgoto next;\n\t\t}\n\t\tif (PageTransHuge(page)) {\n\t\t\tcount_vm_event(THP_FILE_ALLOC);\n\t\t\t__inc_node_page_state(page, NR_SHMEM_THPS);\n\t\t}\n\t\tmapping->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\t__mod_node_page_state(page_pgdat(page), NR_SHMEM, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (xas_error(&xas)) {\n\t\tpage->mapping = NULL;\n\t\tpage_ref_sub(page, nr);\n\t\treturn xas_error(&xas);\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_add_to_page_cache(struct page *page,\n\t\t\t\t   struct address_space *mapping,\n\t\t\t\t   pgoff_t index, void *expected, gfp_t gfp)\n{\n\tXA_STATE_ORDER(xas, &mapping->i_pages, index, compound_order(page));\n\tunsigned long i = 0;\n\tunsigned long nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(PageTail(page), page);\n\tVM_BUG_ON_PAGE(index != round_down(index, nr), page);\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\tVM_BUG_ON(expected && PageTransHuge(page));\n\n\tpage_ref_add(page, nr);\n\tpage->mapping = mapping;\n\tpage->index = index;\n\n\tdo {\n\t\tvoid *entry;\n\t\txas_lock_irq(&xas);\n\t\tentry = xas_find_conflict(&xas);\n\t\tif (entry != expected)\n\t\t\txas_set_err(&xas, -EEXIST);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\nnext:\n\t\txas_store(&xas, page + i);\n\t\tif (++i < nr) {\n\t\t\txas_next(&xas);\n\t\t\tgoto next;\n\t\t}\n\t\tif (PageTransHuge(page)) {\n\t\t\tcount_vm_event(THP_FILE_ALLOC);\n\t\t\t__inc_node_page_state(page, NR_SHMEM_THPS);\n\t\t}\n\t\tmapping->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\t__mod_node_page_state(page_pgdat(page), NR_SHMEM, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (xas_error(&xas)) {\n\t\tpage->mapping = NULL;\n\t\tpage_ref_sub(page, nr);\n\t\treturn xas_error(&xas);\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_swapcount",
          "args": [
            "*pagep"
          ],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "page_swapcount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "1329-1346",
          "snippet": "int page_swapcount(struct page *page)\n{\n\tint count = 0;\n\tstruct swap_info_struct *p;\n\tstruct swap_cluster_info *ci;\n\tswp_entry_t entry;\n\tunsigned long offset;\n\n\tentry.val = page_private(page);\n\tp = _swap_info_get(entry);\n\tif (p) {\n\t\toffset = swp_offset(entry);\n\t\tci = lock_cluster_or_swap_info(p, offset);\n\t\tcount = swap_count(p->swap_map[offset]);\n\t\tunlock_cluster_or_swap_info(p, ci);\n\t}\n\treturn count;\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void free_swap_count_continuations(struct swap_info_struct *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic void free_swap_count_continuations(struct swap_info_struct *);\n\nint page_swapcount(struct page *page)\n{\n\tint count = 0;\n\tstruct swap_info_struct *p;\n\tstruct swap_cluster_info *ci;\n\tswp_entry_t entry;\n\tunsigned long offset;\n\n\tentry.val = page_private(page);\n\tp = _swap_info_get(entry);\n\tif (p) {\n\t\toffset = swp_offset(entry);\n\t\tci = lock_cluster_or_swap_info(p, offset);\n\t\tcount = swap_count(p->swap_map[offset]);\n\t\tunlock_cluster_or_swap_info(p, ci);\n\t}\n\treturn count;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_replace_page",
          "args": [
            "pagep",
            "gfp",
            "info",
            "index"
          ],
          "line": 1140
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_replace_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1507-1572",
          "snippet": "static int shmem_replace_page(struct page **pagep, gfp_t gfp,\n\t\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct page *oldpage, *newpage;\n\tstruct address_space *swap_mapping;\n\tswp_entry_t entry;\n\tpgoff_t swap_index;\n\tint error;\n\n\toldpage = *pagep;\n\tentry.val = page_private(oldpage);\n\tswap_index = swp_offset(entry);\n\tswap_mapping = page_mapping(oldpage);\n\n\t/*\n\t * We have arrived here because our zones are constrained, so don't\n\t * limit chance of success by further cpuset and node constraints.\n\t */\n\tgfp &= ~GFP_CONSTRAINT_MASK;\n\tnewpage = shmem_alloc_page(gfp, info, index);\n\tif (!newpage)\n\t\treturn -ENOMEM;\n\n\tget_page(newpage);\n\tcopy_highpage(newpage, oldpage);\n\tflush_dcache_page(newpage);\n\n\t__SetPageLocked(newpage);\n\t__SetPageSwapBacked(newpage);\n\tSetPageUptodate(newpage);\n\tset_page_private(newpage, entry.val);\n\tSetPageSwapCache(newpage);\n\n\t/*\n\t * Our caller will very soon move newpage out of swapcache, but it's\n\t * a nice clean interface for us to replace oldpage by newpage there.\n\t */\n\txa_lock_irq(&swap_mapping->i_pages);\n\terror = shmem_replace_entry(swap_mapping, swap_index, oldpage, newpage);\n\tif (!error) {\n\t\t__inc_node_page_state(newpage, NR_FILE_PAGES);\n\t\t__dec_node_page_state(oldpage, NR_FILE_PAGES);\n\t}\n\txa_unlock_irq(&swap_mapping->i_pages);\n\n\tif (unlikely(error)) {\n\t\t/*\n\t\t * Is this possible?  I think not, now that our callers check\n\t\t * both PageSwapCache and page_private after getting page lock;\n\t\t * but be defensive.  Reverse old to newpage for clear and free.\n\t\t */\n\t\toldpage = newpage;\n\t} else {\n\t\tmem_cgroup_migrate(oldpage, newpage);\n\t\tlru_cache_add_anon(newpage);\n\t\t*pagep = newpage;\n\t}\n\n\tClearPageSwapCache(oldpage);\n\tset_page_private(oldpage, 0);\n\n\tunlock_page(oldpage);\n\tput_page(oldpage);\n\tput_page(oldpage);\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_replace_page(struct page **pagep, gfp_t gfp,\n\t\t\t\tstruct shmem_inode_info *info, pgoff_t index)\n{\n\tstruct page *oldpage, *newpage;\n\tstruct address_space *swap_mapping;\n\tswp_entry_t entry;\n\tpgoff_t swap_index;\n\tint error;\n\n\toldpage = *pagep;\n\tentry.val = page_private(oldpage);\n\tswap_index = swp_offset(entry);\n\tswap_mapping = page_mapping(oldpage);\n\n\t/*\n\t * We have arrived here because our zones are constrained, so don't\n\t * limit chance of success by further cpuset and node constraints.\n\t */\n\tgfp &= ~GFP_CONSTRAINT_MASK;\n\tnewpage = shmem_alloc_page(gfp, info, index);\n\tif (!newpage)\n\t\treturn -ENOMEM;\n\n\tget_page(newpage);\n\tcopy_highpage(newpage, oldpage);\n\tflush_dcache_page(newpage);\n\n\t__SetPageLocked(newpage);\n\t__SetPageSwapBacked(newpage);\n\tSetPageUptodate(newpage);\n\tset_page_private(newpage, entry.val);\n\tSetPageSwapCache(newpage);\n\n\t/*\n\t * Our caller will very soon move newpage out of swapcache, but it's\n\t * a nice clean interface for us to replace oldpage by newpage there.\n\t */\n\txa_lock_irq(&swap_mapping->i_pages);\n\terror = shmem_replace_entry(swap_mapping, swap_index, oldpage, newpage);\n\tif (!error) {\n\t\t__inc_node_page_state(newpage, NR_FILE_PAGES);\n\t\t__dec_node_page_state(oldpage, NR_FILE_PAGES);\n\t}\n\txa_unlock_irq(&swap_mapping->i_pages);\n\n\tif (unlikely(error)) {\n\t\t/*\n\t\t * Is this possible?  I think not, now that our callers check\n\t\t * both PageSwapCache and page_private after getting page lock;\n\t\t * but be defensive.  Reverse old to newpage for clear and free.\n\t\t */\n\t\toldpage = newpage;\n\t} else {\n\t\tmem_cgroup_migrate(oldpage, newpage);\n\t\tlru_cache_add_anon(newpage);\n\t\t*pagep = newpage;\n\t}\n\n\tClearPageSwapCache(oldpage);\n\tset_page_private(oldpage, 0);\n\n\tunlock_page(oldpage);\n\tput_page(oldpage);\n\tput_page(oldpage);\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_should_replace_page",
          "args": [
            "*pagep",
            "gfp"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_should_replace_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1502-1505",
          "snippet": "static bool shmem_should_replace_page(struct page *page, gfp_t gfp)\n{\n\treturn page_zonenum(page) > gfp_zone(gfp);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic bool shmem_should_replace_page(struct page *page, gfp_t gfp)\n{\n\treturn page_zonenum(page) > gfp_zone(gfp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapping_gfp_mask",
          "args": [
            "mapping"
          ],
          "line": 1137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_move_tail",
          "args": [
            "&shmem_swaplist",
            "&info->swaplist"
          ],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_swap_entry",
          "args": [
            "&mapping->i_pages",
            "radswap"
          ],
          "line": 1124
        },
        "resolved": true,
        "details": {
          "function_name": "find_swap_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1088-1109",
          "snippet": "static unsigned long find_swap_entry(struct xarray *xa, void *item)\n{\n\tXA_STATE(xas, xa, 0);\n\tunsigned int checked = 0;\n\tvoid *entry;\n\n\trcu_read_lock();\n\txas_for_each(&xas, entry, ULONG_MAX) {\n\t\tif (xas_retry(&xas, entry))\n\t\t\tcontinue;\n\t\tif (entry == item)\n\t\t\tbreak;\n\t\tchecked++;\n\t\tif ((checked % XA_CHECK_SCHED) != 0)\n\t\t\tcontinue;\n\t\txas_pause(&xas);\n\t\tcond_resched_rcu();\n\t}\n\trcu_read_unlock();\n\n\treturn entry ? xas.xa_index : -1;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long find_swap_entry(struct xarray *xa, void *item)\n{\n\tXA_STATE(xas, xa, 0);\n\tunsigned int checked = 0;\n\tvoid *entry;\n\n\trcu_read_lock();\n\txas_for_each(&xas, entry, ULONG_MAX) {\n\t\tif (xas_retry(&xas, entry))\n\t\t\tcontinue;\n\t\tif (entry == item)\n\t\t\tbreak;\n\t\tchecked++;\n\t\tif ((checked % XA_CHECK_SCHED) != 0)\n\t\t\tcontinue;\n\t\txas_pause(&xas);\n\t\tcond_resched_rcu();\n\t}\n\trcu_read_unlock();\n\n\treturn entry ? xas.xa_index : -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "swp_to_radix_entry",
          "args": [
            "swap"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_unuse_inode(struct shmem_inode_info *info,\n\t\t\t     swp_entry_t swap, struct page **pagep)\n{\n\tstruct address_space *mapping = info->vfs_inode.i_mapping;\n\tvoid *radswap;\n\tpgoff_t index;\n\tgfp_t gfp;\n\tint error = 0;\n\n\tradswap = swp_to_radix_entry(swap);\n\tindex = find_swap_entry(&mapping->i_pages, radswap);\n\tif (index == -1)\n\t\treturn -EAGAIN;\t/* tell shmem_unuse we found nothing */\n\n\t/*\n\t * Move _head_ to start search for next from here.\n\t * But be careful: shmem_evict_inode checks list_empty without taking\n\t * mutex, and there's an instant in list_move_tail when info->swaplist\n\t * would appear empty, if it were the only one on shmem_swaplist.\n\t */\n\tif (shmem_swaplist.next != &info->swaplist)\n\t\tlist_move_tail(&shmem_swaplist, &info->swaplist);\n\n\tgfp = mapping_gfp_mask(mapping);\n\tif (shmem_should_replace_page(*pagep, gfp)) {\n\t\tmutex_unlock(&shmem_swaplist_mutex);\n\t\terror = shmem_replace_page(pagep, gfp, info, index);\n\t\tmutex_lock(&shmem_swaplist_mutex);\n\t\t/*\n\t\t * We needed to drop mutex to make that restrictive page\n\t\t * allocation, but the inode might have been freed while we\n\t\t * dropped it: although a racing shmem_evict_inode() cannot\n\t\t * complete without emptying the page cache, our page lock\n\t\t * on this swapcache page is not enough to prevent that -\n\t\t * free_swap_and_cache() of our swap entry will only\n\t\t * trylock_page(), removing swap from page cache whatever.\n\t\t *\n\t\t * We must not proceed to shmem_add_to_page_cache() if the\n\t\t * inode has been freed, but of course we cannot rely on\n\t\t * inode or mapping or info to check that.  However, we can\n\t\t * safely check if our swap entry is still in use (and here\n\t\t * it can't have got reused for another page): if it's still\n\t\t * in use, then the inode cannot have been freed yet, and we\n\t\t * can safely proceed (if it's no longer in use, that tells\n\t\t * nothing about the inode, but we don't need to unuse swap).\n\t\t */\n\t\tif (!page_swapcount(*pagep))\n\t\t\terror = -ENOENT;\n\t}\n\n\t/*\n\t * We rely on shmem_swaplist_mutex, not only to protect the swaplist,\n\t * but also to hold up shmem_evict_inode(): so inode cannot be freed\n\t * beneath us (pagelock doesn't help until the page is in pagecache).\n\t */\n\tif (!error)\n\t\terror = shmem_add_to_page_cache(*pagep, mapping, index,\n\t\t\t\t\t\tradswap, gfp);\n\tif (error != -ENOMEM) {\n\t\t/*\n\t\t * Truncation and eviction use free_swap_and_cache(), which\n\t\t * only does trylock page: if we raced, best clean up here.\n\t\t */\n\t\tdelete_from_swap_cache(*pagep);\n\t\tset_page_dirty(*pagep);\n\t\tif (!error) {\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tinfo->swapped--;\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t\tswap_free(swap);\n\t\t}\n\t}\n\treturn error;\n}"
  },
  {
    "function_name": "find_swap_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1088-1109",
    "snippet": "static unsigned long find_swap_entry(struct xarray *xa, void *item)\n{\n\tXA_STATE(xas, xa, 0);\n\tunsigned int checked = 0;\n\tvoid *entry;\n\n\trcu_read_lock();\n\txas_for_each(&xas, entry, ULONG_MAX) {\n\t\tif (xas_retry(&xas, entry))\n\t\t\tcontinue;\n\t\tif (entry == item)\n\t\t\tbreak;\n\t\tchecked++;\n\t\tif ((checked % XA_CHECK_SCHED) != 0)\n\t\t\tcontinue;\n\t\txas_pause(&xas);\n\t\tcond_resched_rcu();\n\t}\n\trcu_read_unlock();\n\n\treturn entry ? xas.xa_index : -1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched_rcu",
          "args": [],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_pause",
          "args": [
            "&xas"
          ],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_retry",
          "args": [
            "&xas",
            "entry"
          ],
          "line": 1096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_for_each",
          "args": [
            "&xas",
            "entry",
            "ULONG_MAX"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 1094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XA_STATE",
          "args": [
            "xas",
            "xa",
            "0"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long find_swap_entry(struct xarray *xa, void *item)\n{\n\tXA_STATE(xas, xa, 0);\n\tunsigned int checked = 0;\n\tvoid *entry;\n\n\trcu_read_lock();\n\txas_for_each(&xas, entry, ULONG_MAX) {\n\t\tif (xas_retry(&xas, entry))\n\t\t\tcontinue;\n\t\tif (entry == item)\n\t\t\tbreak;\n\t\tchecked++;\n\t\tif ((checked % XA_CHECK_SCHED) != 0)\n\t\t\tcontinue;\n\t\txas_pause(&xas);\n\t\tcond_resched_rcu();\n\t}\n\trcu_read_unlock();\n\n\treturn entry ? xas.xa_index : -1;\n}"
  },
  {
    "function_name": "shmem_evict_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "1058-1086",
    "snippet": "static void shmem_evict_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (inode->i_mapping->a_ops == &shmem_aops) {\n\t\tshmem_unacct_size(info->flags, inode->i_size);\n\t\tinode->i_size = 0;\n\t\tshmem_truncate_range(inode, 0, (loff_t)-1);\n\t\tif (!list_empty(&info->shrinklist)) {\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\tif (!list_empty(&info->shrinklist)) {\n\t\t\t\tlist_del_init(&info->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len--;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\t\tif (!list_empty(&info->swaplist)) {\n\t\t\tmutex_lock(&shmem_swaplist_mutex);\n\t\t\tlist_del_init(&info->swaplist);\n\t\t\tmutex_unlock(&shmem_swaplist_mutex);\n\t\t}\n\t}\n\n\tsimple_xattrs_free(&info->xattrs);\n\tWARN_ON(inode->i_blocks);\n\tshmem_free_inode(inode->i_sb);\n\tclear_inode(inode);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_inode",
          "args": [
            "inode"
          ],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_free_inode",
          "args": [
            "inode->i_sb"
          ],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_free_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "257-265",
          "snippet": "static void shmem_free_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tsbinfo->free_inodes++;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_free_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tsbinfo->free_inodes++;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "inode->i_blocks"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_xattrs_free",
          "args": [
            "&info->xattrs"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&info->swaplist"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&shmem_swaplist_mutex"
          ],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&info->swaplist"
          ],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&info->shrinklist"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_truncate_range",
          "args": [
            "inode",
            "0",
            "(loff_t)-1"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_truncate_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3840-3843",
          "snippet": "void shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\ttruncate_inode_pages_range(inode->i_mapping, lstart, lend);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nvoid shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\ttruncate_inode_pages_range(inode->i_mapping, lstart, lend);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_unacct_size",
          "args": [
            "info->flags",
            "inode->i_size"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unacct_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "153-157",
          "snippet": "static inline void shmem_unacct_size(unsigned long flags, loff_t size)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\tvm_unacct_memory(VM_ACCT(size));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_unacct_size(unsigned long flags, loff_t size)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\tvm_unacct_memory(VM_ACCT(size));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_evict_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (inode->i_mapping->a_ops == &shmem_aops) {\n\t\tshmem_unacct_size(info->flags, inode->i_size);\n\t\tinode->i_size = 0;\n\t\tshmem_truncate_range(inode, 0, (loff_t)-1);\n\t\tif (!list_empty(&info->shrinklist)) {\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\tif (!list_empty(&info->shrinklist)) {\n\t\t\t\tlist_del_init(&info->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len--;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\t\tif (!list_empty(&info->swaplist)) {\n\t\t\tmutex_lock(&shmem_swaplist_mutex);\n\t\t\tlist_del_init(&info->swaplist);\n\t\t\tmutex_unlock(&shmem_swaplist_mutex);\n\t\t}\n\t}\n\n\tsimple_xattrs_free(&info->xattrs);\n\tWARN_ON(inode->i_blocks);\n\tshmem_free_inode(inode->i_sb);\n\tclear_inode(inode);\n}"
  },
  {
    "function_name": "shmem_setattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "991-1056",
    "snippet": "static int shmem_setattr(struct dentry *dentry, struct iattr *attr)\n{\n\tstruct inode *inode = d_inode(dentry);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\tint error;\n\n\terror = setattr_prepare(dentry, attr);\n\tif (error)\n\t\treturn error;\n\n\tif (S_ISREG(inode->i_mode) && (attr->ia_valid & ATTR_SIZE)) {\n\t\tloff_t oldsize = inode->i_size;\n\t\tloff_t newsize = attr->ia_size;\n\n\t\t/* protected by i_mutex */\n\t\tif ((newsize < oldsize && (info->seals & F_SEAL_SHRINK)) ||\n\t\t    (newsize > oldsize && (info->seals & F_SEAL_GROW)))\n\t\t\treturn -EPERM;\n\n\t\tif (newsize != oldsize) {\n\t\t\terror = shmem_reacct_size(SHMEM_I(inode)->flags,\n\t\t\t\t\toldsize, newsize);\n\t\t\tif (error)\n\t\t\t\treturn error;\n\t\t\ti_size_write(inode, newsize);\n\t\t\tinode->i_ctime = inode->i_mtime = current_time(inode);\n\t\t}\n\t\tif (newsize <= oldsize) {\n\t\t\tloff_t holebegin = round_up(newsize, PAGE_SIZE);\n\t\t\tif (oldsize > holebegin)\n\t\t\t\tunmap_mapping_range(inode->i_mapping,\n\t\t\t\t\t\t\tholebegin, 0, 1);\n\t\t\tif (info->alloced)\n\t\t\t\tshmem_truncate_range(inode,\n\t\t\t\t\t\t\tnewsize, (loff_t)-1);\n\t\t\t/* unmap again to remove racily COWed private pages */\n\t\t\tif (oldsize > holebegin)\n\t\t\t\tunmap_mapping_range(inode->i_mapping,\n\t\t\t\t\t\t\tholebegin, 0, 1);\n\n\t\t\t/*\n\t\t\t * Part of the huge page can be beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE)) {\n\t\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t\t/*\n\t\t\t\t * _careful to defend against unlocked access to\n\t\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t\t */\n\t\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t\t}\n\t\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetattr_copy(inode, attr);\n\tif (attr->ia_valid & ATTR_MODE)\n\t\terror = posix_acl_chmod(inode, inode->i_mode);\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "posix_acl_chmod",
          "args": [
            "inode",
            "inode->i_mode"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setattr_copy",
          "args": [
            "inode",
            "attr"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&info->shrinklist",
            "&sbinfo->shrinklist"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty_careful",
          "args": [
            "&info->shrinklist"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_TRANSPARENT_HUGE_PAGECACHE"
          ],
          "line": 1036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unmap_mapping_range",
          "args": [
            "inode->i_mapping",
            "holebegin",
            "0",
            "1"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "unmap_mapping_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory.c",
          "lines": "2630-2645",
          "snippet": "void unmap_mapping_range(struct address_space *mapping,\n\t\tloff_t const holebegin, loff_t const holelen, int even_cows)\n{\n\tpgoff_t hba = holebegin >> PAGE_SHIFT;\n\tpgoff_t hlen = (holelen + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\n\t/* Check for overflow. */\n\tif (sizeof(holelen) > sizeof(hlen)) {\n\t\tlong long holeend =\n\t\t\t(holebegin + holelen + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\t\tif (holeend & ~(long long)ULONG_MAX)\n\t\t\thlen = ULONG_MAX - hba + 1;\n\t}\n\n\tunmap_mapping_pages(mapping, hba, hlen, even_cows);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/io.h>",
            "#include <linux/oom.h>",
            "#include <linux/dax.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/dma-debug.h>",
            "#include <linux/string.h>",
            "#include <linux/migrate.h>",
            "#include <linux/gfp.h>",
            "#include <linux/elf.h>",
            "#include <linux/swapops.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pfn_t.h>",
            "#include <linux/init.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/export.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/memremap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel_stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <asm/mmu_context.h>\n#include <asm/io.h>\n#include <linux/oom.h>\n#include <linux/dax.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/debugfs.h>\n#include <linux/dma-debug.h>\n#include <linux/string.h>\n#include <linux/migrate.h>\n#include <linux/gfp.h>\n#include <linux/elf.h>\n#include <linux/swapops.h>\n#include <linux/mmu_notifier.h>\n#include <linux/memcontrol.h>\n#include <linux/writeback.h>\n#include <linux/pfn_t.h>\n#include <linux/init.h>\n#include <linux/delayacct.h>\n#include <linux/export.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/memremap.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/kernel_stat.h>\n\nvoid unmap_mapping_range(struct address_space *mapping,\n\t\tloff_t const holebegin, loff_t const holelen, int even_cows)\n{\n\tpgoff_t hba = holebegin >> PAGE_SHIFT;\n\tpgoff_t hlen = (holelen + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\n\t/* Check for overflow. */\n\tif (sizeof(holelen) > sizeof(hlen)) {\n\t\tlong long holeend =\n\t\t\t(holebegin + holelen + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\t\tif (holeend & ~(long long)ULONG_MAX)\n\t\t\thlen = ULONG_MAX - hba + 1;\n\t}\n\n\tunmap_mapping_pages(mapping, hba, hlen, even_cows);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_truncate_range",
          "args": [
            "inode",
            "newsize",
            "(loff_t)-1"
          ],
          "line": 1025
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_truncate_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "3840-3843",
          "snippet": "void shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\ttruncate_inode_pages_range(inode->i_mapping, lstart, lend);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nvoid shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\ttruncate_inode_pages_range(inode->i_mapping, lstart, lend);\n}"
        }
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "newsize",
            "PAGE_SIZE"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "inode"
          ],
          "line": 1017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_size_write",
          "args": [
            "inode",
            "newsize"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_reacct_size",
          "args": [
            "SHMEM_I(inode)->flags",
            "oldsize",
            "newsize"
          ],
          "line": 1012
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_reacct_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "159-170",
          "snippet": "static inline int shmem_reacct_size(unsigned long flags,\n\t\tloff_t oldsize, loff_t newsize)\n{\n\tif (!(flags & VM_NORESERVE)) {\n\t\tif (VM_ACCT(newsize) > VM_ACCT(oldsize))\n\t\t\treturn security_vm_enough_memory_mm(current->mm,\n\t\t\t\t\tVM_ACCT(newsize) - VM_ACCT(oldsize));\n\t\telse if (VM_ACCT(newsize) < VM_ACCT(oldsize))\n\t\t\tvm_unacct_memory(VM_ACCT(oldsize) - VM_ACCT(newsize));\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline int shmem_reacct_size(unsigned long flags,\n\t\tloff_t oldsize, loff_t newsize)\n{\n\tif (!(flags & VM_NORESERVE)) {\n\t\tif (VM_ACCT(newsize) > VM_ACCT(oldsize))\n\t\t\treturn security_vm_enough_memory_mm(current->mm,\n\t\t\t\t\tVM_ACCT(newsize) - VM_ACCT(oldsize));\n\t\telse if (VM_ACCT(newsize) < VM_ACCT(oldsize))\n\t\t\tvm_unacct_memory(VM_ACCT(oldsize) - VM_ACCT(newsize));\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "inode->i_mode"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setattr_prepare",
          "args": [
            "dentry",
            "attr"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "dentry"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_setattr(struct dentry *dentry, struct iattr *attr)\n{\n\tstruct inode *inode = d_inode(dentry);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\tint error;\n\n\terror = setattr_prepare(dentry, attr);\n\tif (error)\n\t\treturn error;\n\n\tif (S_ISREG(inode->i_mode) && (attr->ia_valid & ATTR_SIZE)) {\n\t\tloff_t oldsize = inode->i_size;\n\t\tloff_t newsize = attr->ia_size;\n\n\t\t/* protected by i_mutex */\n\t\tif ((newsize < oldsize && (info->seals & F_SEAL_SHRINK)) ||\n\t\t    (newsize > oldsize && (info->seals & F_SEAL_GROW)))\n\t\t\treturn -EPERM;\n\n\t\tif (newsize != oldsize) {\n\t\t\terror = shmem_reacct_size(SHMEM_I(inode)->flags,\n\t\t\t\t\toldsize, newsize);\n\t\t\tif (error)\n\t\t\t\treturn error;\n\t\t\ti_size_write(inode, newsize);\n\t\t\tinode->i_ctime = inode->i_mtime = current_time(inode);\n\t\t}\n\t\tif (newsize <= oldsize) {\n\t\t\tloff_t holebegin = round_up(newsize, PAGE_SIZE);\n\t\t\tif (oldsize > holebegin)\n\t\t\t\tunmap_mapping_range(inode->i_mapping,\n\t\t\t\t\t\t\tholebegin, 0, 1);\n\t\t\tif (info->alloced)\n\t\t\t\tshmem_truncate_range(inode,\n\t\t\t\t\t\t\tnewsize, (loff_t)-1);\n\t\t\t/* unmap again to remove racily COWed private pages */\n\t\t\tif (oldsize > holebegin)\n\t\t\t\tunmap_mapping_range(inode->i_mapping,\n\t\t\t\t\t\t\tholebegin, 0, 1);\n\n\t\t\t/*\n\t\t\t * Part of the huge page can be beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE)) {\n\t\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t\t/*\n\t\t\t\t * _careful to defend against unlocked access to\n\t\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t\t */\n\t\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t\t}\n\t\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetattr_copy(inode, attr);\n\tif (attr->ia_valid & ATTR_MODE)\n\t\terror = posix_acl_chmod(inode, inode->i_mode);\n\treturn error;\n}"
  },
  {
    "function_name": "shmem_getattr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "971-989",
    "snippet": "static int shmem_getattr(const struct path *path, struct kstat *stat,\n\t\t\t u32 request_mask, unsigned int query_flags)\n{\n\tstruct inode *inode = path->dentry->d_inode;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sb_info = SHMEM_SB(inode->i_sb);\n\n\tif (info->alloced - info->swapped != inode->i_mapping->nrpages) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t}\n\tgeneric_fillattr(inode, stat);\n\n\tif (is_huge_enabled(sb_info))\n\t\tstat->blksize = HPAGE_PMD_SIZE;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_huge_enabled",
          "args": [
            "sb_info"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "is_huge_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "566-573",
          "snippet": "static inline bool is_huge_enabled(struct shmem_sb_info *sbinfo)\n{\n\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE) &&\n\t    (shmem_huge == SHMEM_HUGE_FORCE || sbinfo->huge) &&\n\t    shmem_huge != SHMEM_HUGE_DENY)\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_huge SHMEM_HUGE_DENY",
            "#define SHMEM_HUGE_FORCE\t(-2)",
            "#define SHMEM_HUGE_DENY\t\t(-1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n\nstatic inline bool is_huge_enabled(struct shmem_sb_info *sbinfo)\n{\n\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE) &&\n\t    (shmem_huge == SHMEM_HUGE_FORCE || sbinfo->huge) &&\n\t    shmem_huge != SHMEM_HUGE_DENY)\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "generic_fillattr",
          "args": [
            "inode",
            "stat"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_recalc_inode",
          "args": [
            "inode"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_recalc_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "279-290",
          "snippet": "static void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 976
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 975
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_getattr(const struct path *path, struct kstat *stat,\n\t\t\t u32 request_mask, unsigned int query_flags)\n{\n\tstruct inode *inode = path->dentry->d_inode;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sb_info = SHMEM_SB(inode->i_sb);\n\n\tif (info->alloced - info->swapped != inode->i_mapping->nrpages) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t}\n\tgeneric_fillattr(inode, stat);\n\n\tif (is_huge_enabled(sb_info))\n\t\tstat->blksize = HPAGE_PMD_SIZE;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_truncate_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "964-968",
    "snippet": "void shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\tshmem_undo_range(inode, lstart, lend, false);\n\tinode->i_ctime = inode->i_mtime = current_time(inode);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_time",
          "args": [
            "inode"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_undo_range",
          "args": [
            "inode",
            "lstart",
            "lend",
            "false"
          ],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_undo_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "769-962",
          "snippet": "static void shmem_undo_range(struct inode *inode, loff_t lstart, loff_t lend,\n\t\t\t\t\t\t\t\t bool unfalloc)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tpgoff_t start = (lstart + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tpgoff_t end = (lend + 1) >> PAGE_SHIFT;\n\tunsigned int partial_start = lstart & (PAGE_SIZE - 1);\n\tunsigned int partial_end = (lend + 1) & (PAGE_SIZE - 1);\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tlong nr_swaps_freed = 0;\n\tpgoff_t index;\n\tint i;\n\n\tif (lend == -1)\n\t\tend = -1;\t/* unsigned, so actually very big */\n\n\tpagevec_init(&pvec);\n\tindex = start;\n\twhile (index < end) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr)\n\t\t\tbreak;\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnr_swaps_freed += !shmem_free_swap(mapping,\n\t\t\t\t\t\t\t\tindex, page);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tVM_BUG_ON_PAGE(page_to_pgoff(page) != index, page);\n\n\t\t\tif (!trylock_page(page))\n\t\t\t\tcontinue;\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t\tindex++;\n\t}\n\n\tif (partial_start) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, start - 1, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tunsigned int top = PAGE_SIZE;\n\t\t\tif (start > end) {\n\t\t\t\ttop = partial_end;\n\t\t\t\tpartial_end = 0;\n\t\t\t}\n\t\t\tzero_user_segment(page, partial_start, top);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (partial_end) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, end, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tzero_user_segment(page, 0, partial_end);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (start >= end)\n\t\treturn;\n\n\tindex = start;\n\twhile (index < end) {\n\t\tcond_resched();\n\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\t/* If all gone or hole-punch or unfalloc, we're done */\n\t\t\tif (index == start || end != -1)\n\t\t\t\tbreak;\n\t\t\t/* But if truncating, restart to make sure all gone */\n\t\t\tindex = start;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (shmem_free_swap(mapping, index, page)) {\n\t\t\t\t\t/* Swap was replaced by page: retry */\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tnr_swaps_freed++;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlock_page(page);\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\t/*\n\t\t\t\t * Partial thp truncate due 'start' in middle\n\t\t\t\t * of THP: don't need to look on these pages\n\t\t\t\t * again on !pvec.nr restart.\n\t\t\t\t */\n\t\t\t\tif (index != round_down(end, HPAGE_PMD_NR))\n\t\t\t\t\tstart++;\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t} else {\n\t\t\t\t\t/* Page was replaced by swap: retry */\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tindex++;\n\t}\n\n\tspin_lock_irq(&info->lock);\n\tinfo->swapped -= nr_swaps_freed;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irq(&info->lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_undo_range(struct inode *inode, loff_t lstart, loff_t lend,\n\t\t\t\t\t\t\t\t bool unfalloc)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tpgoff_t start = (lstart + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tpgoff_t end = (lend + 1) >> PAGE_SHIFT;\n\tunsigned int partial_start = lstart & (PAGE_SIZE - 1);\n\tunsigned int partial_end = (lend + 1) & (PAGE_SIZE - 1);\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tlong nr_swaps_freed = 0;\n\tpgoff_t index;\n\tint i;\n\n\tif (lend == -1)\n\t\tend = -1;\t/* unsigned, so actually very big */\n\n\tpagevec_init(&pvec);\n\tindex = start;\n\twhile (index < end) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr)\n\t\t\tbreak;\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnr_swaps_freed += !shmem_free_swap(mapping,\n\t\t\t\t\t\t\t\tindex, page);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tVM_BUG_ON_PAGE(page_to_pgoff(page) != index, page);\n\n\t\t\tif (!trylock_page(page))\n\t\t\t\tcontinue;\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t\tindex++;\n\t}\n\n\tif (partial_start) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, start - 1, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tunsigned int top = PAGE_SIZE;\n\t\t\tif (start > end) {\n\t\t\t\ttop = partial_end;\n\t\t\t\tpartial_end = 0;\n\t\t\t}\n\t\t\tzero_user_segment(page, partial_start, top);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (partial_end) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, end, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tzero_user_segment(page, 0, partial_end);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (start >= end)\n\t\treturn;\n\n\tindex = start;\n\twhile (index < end) {\n\t\tcond_resched();\n\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\t/* If all gone or hole-punch or unfalloc, we're done */\n\t\t\tif (index == start || end != -1)\n\t\t\t\tbreak;\n\t\t\t/* But if truncating, restart to make sure all gone */\n\t\t\tindex = start;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (shmem_free_swap(mapping, index, page)) {\n\t\t\t\t\t/* Swap was replaced by page: retry */\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tnr_swaps_freed++;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlock_page(page);\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\t/*\n\t\t\t\t * Partial thp truncate due 'start' in middle\n\t\t\t\t * of THP: don't need to look on these pages\n\t\t\t\t * again on !pvec.nr restart.\n\t\t\t\t */\n\t\t\t\tif (index != round_down(end, HPAGE_PMD_NR))\n\t\t\t\t\tstart++;\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t} else {\n\t\t\t\t\t/* Page was replaced by swap: retry */\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tindex++;\n\t}\n\n\tspin_lock_irq(&info->lock);\n\tinfo->swapped -= nr_swaps_freed;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irq(&info->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nvoid shmem_truncate_range(struct inode *inode, loff_t lstart, loff_t lend)\n{\n\tshmem_undo_range(inode, lstart, lend, false);\n\tinode->i_ctime = inode->i_mtime = current_time(inode);\n}"
  },
  {
    "function_name": "shmem_undo_range",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "769-962",
    "snippet": "static void shmem_undo_range(struct inode *inode, loff_t lstart, loff_t lend,\n\t\t\t\t\t\t\t\t bool unfalloc)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tpgoff_t start = (lstart + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tpgoff_t end = (lend + 1) >> PAGE_SHIFT;\n\tunsigned int partial_start = lstart & (PAGE_SIZE - 1);\n\tunsigned int partial_end = (lend + 1) & (PAGE_SIZE - 1);\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tlong nr_swaps_freed = 0;\n\tpgoff_t index;\n\tint i;\n\n\tif (lend == -1)\n\t\tend = -1;\t/* unsigned, so actually very big */\n\n\tpagevec_init(&pvec);\n\tindex = start;\n\twhile (index < end) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr)\n\t\t\tbreak;\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnr_swaps_freed += !shmem_free_swap(mapping,\n\t\t\t\t\t\t\t\tindex, page);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tVM_BUG_ON_PAGE(page_to_pgoff(page) != index, page);\n\n\t\t\tif (!trylock_page(page))\n\t\t\t\tcontinue;\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t\tindex++;\n\t}\n\n\tif (partial_start) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, start - 1, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tunsigned int top = PAGE_SIZE;\n\t\t\tif (start > end) {\n\t\t\t\ttop = partial_end;\n\t\t\t\tpartial_end = 0;\n\t\t\t}\n\t\t\tzero_user_segment(page, partial_start, top);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (partial_end) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, end, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tzero_user_segment(page, 0, partial_end);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (start >= end)\n\t\treturn;\n\n\tindex = start;\n\twhile (index < end) {\n\t\tcond_resched();\n\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\t/* If all gone or hole-punch or unfalloc, we're done */\n\t\t\tif (index == start || end != -1)\n\t\t\t\tbreak;\n\t\t\t/* But if truncating, restart to make sure all gone */\n\t\t\tindex = start;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (shmem_free_swap(mapping, index, page)) {\n\t\t\t\t\t/* Swap was replaced by page: retry */\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tnr_swaps_freed++;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlock_page(page);\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\t/*\n\t\t\t\t * Partial thp truncate due 'start' in middle\n\t\t\t\t * of THP: don't need to look on these pages\n\t\t\t\t * again on !pvec.nr restart.\n\t\t\t\t */\n\t\t\t\tif (index != round_down(end, HPAGE_PMD_NR))\n\t\t\t\t\tstart++;\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t} else {\n\t\t\t\t\t/* Page was replaced by swap: retry */\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tindex++;\n\t}\n\n\tspin_lock_irq(&info->lock);\n\tinfo->swapped -= nr_swaps_freed;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irq(&info->lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_recalc_inode",
          "args": [
            "inode"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_recalc_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "279-290",
          "snippet": "static void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&info->lock"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_release",
          "args": [
            "&pvec"
          ],
          "line": 954
        },
        "resolved": true,
        "details": {
          "function_name": "__pagevec_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "805-813",
          "snippet": "void __pagevec_release(struct pagevec *pvec)\n{\n\tif (!pvec->percpu_pvec_drained) {\n\t\tlru_add_drain();\n\t\tpvec->percpu_pvec_drained = true;\n\t}\n\trelease_pages(pvec->pages, pagevec_count(pvec));\n\tpagevec_reinit(pvec);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid __pagevec_release(struct pagevec *pvec)\n{\n\tif (!pvec->percpu_pvec_drained) {\n\t\tlru_add_drain();\n\t\tpvec->percpu_pvec_drained = true;\n\t}\n\trelease_pages(pvec->pages, pagevec_count(pvec));\n\tpagevec_reinit(pvec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pagevec_remove_exceptionals",
          "args": [
            "&pvec"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "pagevec_remove_exceptionals",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "961-971",
          "snippet": "void pagevec_remove_exceptionals(struct pagevec *pvec)\n{\n\tint i, j;\n\n\tfor (i = 0, j = 0; i < pagevec_count(pvec); i++) {\n\t\tstruct page *page = pvec->pages[i];\n\t\tif (!xa_is_value(page))\n\t\t\tpvec->pages[j++] = page;\n\t}\n\tpvec->nr = j;\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid pagevec_remove_exceptionals(struct pagevec *pvec)\n{\n\tint i, j;\n\n\tfor (i = 0, j = 0; i < pagevec_count(pvec); i++) {\n\t\tstruct page *page = pvec->pages[i];\n\t\tif (!xa_is_value(page))\n\t\t\tpvec->pages[j++] = page;\n\t}\n\tpvec->nr = j;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "truncate_inode_page",
          "args": [
            "mapping",
            "page"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "truncate_inode_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/truncate.c",
          "lines": "473-476",
          "snippet": "void truncate_inode_pages(struct address_space *mapping, loff_t lstart)\n{\n\ttruncate_inode_pages_range(mapping, lstart, (loff_t)-1);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/rmap.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/buffer_head.h>\t/* grr. try_to_release_page,\n\t\t\t\t   do_invalidatepage */",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/highmem.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/export.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/dax.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/rmap.h>\n#include <linux/cleancache.h>\n#include <linux/shmem_fs.h>\n#include <linux/buffer_head.h>\t/* grr. try_to_release_page,\n\t\t\t\t   do_invalidatepage */\n#include <linux/task_io_accounting_ops.h>\n#include <linux/pagevec.h>\n#include <linux/highmem.h>\n#include <linux/pagemap.h>\n#include <linux/export.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/dax.h>\n#include <linux/backing-dev.h>\n#include <linux/kernel.h>\n\nvoid truncate_inode_pages(struct address_space *mapping, loff_t lstart)\n{\n\ttruncate_inode_pages_range(mapping, lstart, (loff_t)-1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "PageWriteback(page)",
            "page"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageWriteback",
          "args": [
            "page"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_mapping",
          "args": [
            "page"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "page_mapping_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "528-533",
          "snippet": "struct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nstruct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "PageTail(page)",
            "page"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTail",
          "args": [
            "page"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "page"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "end",
            "HPAGE_PMD_NR"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "end",
            "HPAGE_PMD_NR"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "page"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransTail",
          "args": [
            "page"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_free_swap",
          "args": [
            "mapping",
            "index",
            "page"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_free_swap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "655-667",
          "snippet": "static int shmem_free_swap(struct address_space *mapping,\n\t\t\t   pgoff_t index, void *radswap)\n{\n\tvoid *old;\n\n\txa_lock_irq(&mapping->i_pages);\n\told = __xa_cmpxchg(&mapping->i_pages, index, radswap, NULL, 0);\n\txa_unlock_irq(&mapping->i_pages);\n\tif (old != radswap)\n\t\treturn -ENOENT;\n\tfree_swap_and_cache(radix_to_swp_entry(radswap));\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_free_swap(struct address_space *mapping,\n\t\t\t   pgoff_t index, void *radswap)\n{\n\tvoid *old;\n\n\txa_lock_irq(&mapping->i_pages);\n\told = __xa_cmpxchg(&mapping->i_pages, index, radswap, NULL, 0);\n\txa_unlock_irq(&mapping->i_pages);\n\tif (old != radswap)\n\t\treturn -ENOENT;\n\tfree_swap_and_cache(radix_to_swp_entry(radswap));\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_is_value",
          "args": [
            "page"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_count",
          "args": [
            "&pvec"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_get_entries",
          "args": [
            "mapping",
            "index",
            "min(end - index, (pgoff_t)PAGEVEC_SIZE)",
            "pvec.pages",
            "indices"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/filemap.c",
          "lines": "1601-1650",
          "snippet": "unsigned find_get_entries(struct address_space *mapping,\n\t\t\t  pgoff_t start, unsigned int nr_entries,\n\t\t\t  struct page **entries, pgoff_t *indices)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned int ret = 0;\n\n\tif (!nr_entries)\n\t\treturn 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, ULONG_MAX) {\n\t\tstruct page *head;\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\t/*\n\t\t * A shadow entry of a recently evicted page, a swap\n\t\t * entry from shmem/tmpfs or a DAX entry.  Return it\n\t\t * without attempting to raise page count.\n\t\t */\n\t\tif (xa_is_value(page))\n\t\t\tgoto export;\n\n\t\thead = compound_head(page);\n\t\tif (!page_cache_get_speculative(head))\n\t\t\tgoto retry;\n\n\t\t/* The page was split under us? */\n\t\tif (compound_head(page) != head)\n\t\t\tgoto put_page;\n\n\t\t/* Has the page moved? */\n\t\tif (unlikely(page != xas_reload(&xas)))\n\t\t\tgoto put_page;\n\nexport:\n\t\tindices[ret] = xas.xa_index;\n\t\tentries[ret] = page;\n\t\tif (++ret == nr_entries)\n\t\t\tbreak;\n\t\tcontinue;\nput_page:\n\t\tput_page(head);\nretry:\n\t\txas_reset(&xas);\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}",
          "includes": [
            "#include <asm/mman.h>",
            "#include <linux/buffer_head.h> /* for try_to_free_buffers */",
            "#include <trace/events/filemap.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/rmap.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/security.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/hash.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/capability.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/fs.h>",
            "#include <linux/dax.h>",
            "#include <linux/compiler.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/mman.h>\n#include <linux/buffer_head.h> /* for try_to_free_buffers */\n#include <trace/events/filemap.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/delayacct.h>\n#include <linux/rmap.h>\n#include <linux/shmem_fs.h>\n#include <linux/cleancache.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/cpuset.h>\n#include <linux/security.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/hash.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/capability.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/dax.h>\n#include <linux/compiler.h>\n#include <linux/export.h>\n\nunsigned find_get_entries(struct address_space *mapping,\n\t\t\t  pgoff_t start, unsigned int nr_entries,\n\t\t\t  struct page **entries, pgoff_t *indices)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned int ret = 0;\n\n\tif (!nr_entries)\n\t\treturn 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, ULONG_MAX) {\n\t\tstruct page *head;\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\t/*\n\t\t * A shadow entry of a recently evicted page, a swap\n\t\t * entry from shmem/tmpfs or a DAX entry.  Return it\n\t\t * without attempting to raise page count.\n\t\t */\n\t\tif (xa_is_value(page))\n\t\t\tgoto export;\n\n\t\thead = compound_head(page);\n\t\tif (!page_cache_get_speculative(head))\n\t\t\tgoto retry;\n\n\t\t/* The page was split under us? */\n\t\tif (compound_head(page) != head)\n\t\t\tgoto put_page;\n\n\t\t/* Has the page moved? */\n\t\tif (unlikely(page != xas_reload(&xas)))\n\t\t\tgoto put_page;\n\nexport:\n\t\tindices[ret] = xas.xa_index;\n\t\tentries[ret] = page;\n\t\tif (++ret == nr_entries)\n\t\t\tbreak;\n\t\tcontinue;\nput_page:\n\t\tput_page(head);\nretry:\n\t\txas_reset(&xas);\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "end - index",
            "(pgoff_t)PAGEVEC_SIZE"
          ],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "si_meminfo_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "4761-4790",
          "snippet": "void si_meminfo_node(struct sysinfo *val, int nid)\n{\n\tint zone_type;\t\t/* needs to be signed */\n\tunsigned long managed_pages = 0;\n\tunsigned long managed_highpages = 0;\n\tunsigned long free_highpages = 0;\n\tpg_data_t *pgdat = NODE_DATA(nid);\n\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++)\n\t\tmanaged_pages += pgdat->node_zones[zone_type].managed_pages;\n\tval->totalram = managed_pages;\n\tval->sharedram = node_page_state(pgdat, NR_SHMEM);\n\tval->freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);\n#ifdef CONFIG_HIGHMEM\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++) {\n\t\tstruct zone *zone = &pgdat->node_zones[zone_type];\n\n\t\tif (is_highmem(zone)) {\n\t\t\tmanaged_highpages += zone->managed_pages;\n\t\t\tfree_highpages += zone_page_state(zone, NR_FREE_PAGES);\n\t\t}\n\t}\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#else\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#endif\n\tval->mem_unit = PAGE_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nvoid si_meminfo_node(struct sysinfo *val, int nid)\n{\n\tint zone_type;\t\t/* needs to be signed */\n\tunsigned long managed_pages = 0;\n\tunsigned long managed_highpages = 0;\n\tunsigned long free_highpages = 0;\n\tpg_data_t *pgdat = NODE_DATA(nid);\n\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++)\n\t\tmanaged_pages += pgdat->node_zones[zone_type].managed_pages;\n\tval->totalram = managed_pages;\n\tval->sharedram = node_page_state(pgdat, NR_SHMEM);\n\tval->freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);\n#ifdef CONFIG_HIGHMEM\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++) {\n\t\tstruct zone *zone = &pgdat->node_zones[zone_type];\n\n\t\tif (is_highmem(zone)) {\n\t\t\tmanaged_highpages += zone->managed_pages;\n\t\t\tfree_highpages += zone_page_state(zone, NR_FREE_PAGES);\n\t\t}\n\t}\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#else\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#endif\n\tval->mem_unit = PAGE_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_page_dirty",
          "args": [
            "page"
          ],
          "line": 869
        },
        "resolved": true,
        "details": {
          "function_name": "set_page_dirty_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "2573-2581",
          "snippet": "int set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint set_page_dirty_lock(struct page *page)\n{\n\tint ret;\n\n\tlock_page(page);\n\tret = set_page_dirty(page);\n\tunlock_page(page);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zero_user_segment",
          "args": [
            "page",
            "0",
            "partial_end"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_getpage",
          "args": [
            "inode",
            "end",
            "&page",
            "SGP_READ"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "129-134",
          "snippet": "int shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zero_user_segment",
          "args": [
            "page",
            "partial_start",
            "top"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "PageWriteback(page)",
            "page"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageWriteback",
          "args": [
            "page"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "PageTail(page)",
            "page"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTail",
          "args": [
            "page"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageUptodate",
          "args": [
            "page"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "page"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "end",
            "HPAGE_PMD_NR"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear_highpage",
          "args": [
            "page"
          ],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransTail",
          "args": [
            "page"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trylock_page",
          "args": [
            "page"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "page_to_pgoff(page) != index",
            "page"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_to_pgoff",
          "args": [
            "page"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_is_value",
          "args": [
            "page"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_count",
          "args": [
            "&pvec"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_init",
          "args": [
            "&pvec"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_undo_range(struct inode *inode, loff_t lstart, loff_t lend,\n\t\t\t\t\t\t\t\t bool unfalloc)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tpgoff_t start = (lstart + PAGE_SIZE - 1) >> PAGE_SHIFT;\n\tpgoff_t end = (lend + 1) >> PAGE_SHIFT;\n\tunsigned int partial_start = lstart & (PAGE_SIZE - 1);\n\tunsigned int partial_end = (lend + 1) & (PAGE_SIZE - 1);\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tlong nr_swaps_freed = 0;\n\tpgoff_t index;\n\tint i;\n\n\tif (lend == -1)\n\t\tend = -1;\t/* unsigned, so actually very big */\n\n\tpagevec_init(&pvec);\n\tindex = start;\n\twhile (index < end) {\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr)\n\t\t\tbreak;\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnr_swaps_freed += !shmem_free_swap(mapping,\n\t\t\t\t\t\t\t\tindex, page);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tVM_BUG_ON_PAGE(page_to_pgoff(page) != index, page);\n\n\t\t\tif (!trylock_page(page))\n\t\t\t\tcontinue;\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t\tindex++;\n\t}\n\n\tif (partial_start) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, start - 1, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tunsigned int top = PAGE_SIZE;\n\t\t\tif (start > end) {\n\t\t\t\ttop = partial_end;\n\t\t\t\tpartial_end = 0;\n\t\t\t}\n\t\t\tzero_user_segment(page, partial_start, top);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (partial_end) {\n\t\tstruct page *page = NULL;\n\t\tshmem_getpage(inode, end, &page, SGP_READ);\n\t\tif (page) {\n\t\t\tzero_user_segment(page, 0, partial_end);\n\t\t\tset_page_dirty(page);\n\t\t\tunlock_page(page);\n\t\t\tput_page(page);\n\t\t}\n\t}\n\tif (start >= end)\n\t\treturn;\n\n\tindex = start;\n\twhile (index < end) {\n\t\tcond_resched();\n\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\tmin(end - index, (pgoff_t)PAGEVEC_SIZE),\n\t\t\t\tpvec.pages, indices);\n\t\tif (!pvec.nr) {\n\t\t\t/* If all gone or hole-punch or unfalloc, we're done */\n\t\t\tif (index == start || end != -1)\n\t\t\t\tbreak;\n\t\t\t/* But if truncating, restart to make sure all gone */\n\t\t\tindex = start;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (i = 0; i < pagevec_count(&pvec); i++) {\n\t\t\tstruct page *page = pvec.pages[i];\n\n\t\t\tindex = indices[i];\n\t\t\tif (index >= end)\n\t\t\t\tbreak;\n\n\t\t\tif (xa_is_value(page)) {\n\t\t\t\tif (unfalloc)\n\t\t\t\t\tcontinue;\n\t\t\t\tif (shmem_free_swap(mapping, index, page)) {\n\t\t\t\t\t/* Swap was replaced by page: retry */\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tnr_swaps_freed++;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlock_page(page);\n\n\t\t\tif (PageTransTail(page)) {\n\t\t\t\t/* Middle of THP: zero out the page */\n\t\t\t\tclear_highpage(page);\n\t\t\t\tunlock_page(page);\n\t\t\t\t/*\n\t\t\t\t * Partial thp truncate due 'start' in middle\n\t\t\t\t * of THP: don't need to look on these pages\n\t\t\t\t * again on !pvec.nr restart.\n\t\t\t\t */\n\t\t\t\tif (index != round_down(end, HPAGE_PMD_NR))\n\t\t\t\t\tstart++;\n\t\t\t\tcontinue;\n\t\t\t} else if (PageTransHuge(page)) {\n\t\t\t\tif (index == round_down(end, HPAGE_PMD_NR)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * Range ends in the middle of THP:\n\t\t\t\t\t * zero out the page\n\t\t\t\t\t */\n\t\t\t\t\tclear_highpage(page);\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tindex += HPAGE_PMD_NR - 1;\n\t\t\t\ti += HPAGE_PMD_NR - 1;\n\t\t\t}\n\n\t\t\tif (!unfalloc || !PageUptodate(page)) {\n\t\t\t\tVM_BUG_ON_PAGE(PageTail(page), page);\n\t\t\t\tif (page_mapping(page) == mapping) {\n\t\t\t\t\tVM_BUG_ON_PAGE(PageWriteback(page), page);\n\t\t\t\t\ttruncate_inode_page(mapping, page);\n\t\t\t\t} else {\n\t\t\t\t\t/* Page was replaced by swap: retry */\n\t\t\t\t\tunlock_page(page);\n\t\t\t\t\tindex--;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tunlock_page(page);\n\t\t}\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tpagevec_release(&pvec);\n\t\tindex++;\n\t}\n\n\tspin_lock_irq(&info->lock);\n\tinfo->swapped -= nr_swaps_freed;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irq(&info->lock);\n}"
  },
  {
    "function_name": "shmem_unlock_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "738-763",
    "snippet": "void shmem_unlock_mapping(struct address_space *mapping)\n{\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tpgoff_t index = 0;\n\n\tpagevec_init(&pvec);\n\t/*\n\t * Minor point, but we might as well stop if someone else SHM_LOCKs it.\n\t */\n\twhile (!mapping_unevictable(mapping)) {\n\t\t/*\n\t\t * Avoid pagevec_lookup(): find_get_pages() returns 0 as if it\n\t\t * has finished, if it hits a row of PAGEVEC_SIZE swap entries.\n\t\t */\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\t\t   PAGEVEC_SIZE, pvec.pages, indices);\n\t\tif (!pvec.nr)\n\t\t\tbreak;\n\t\tindex = indices[pvec.nr - 1] + 1;\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tcheck_move_unevictable_pages(pvec.pages, pvec.nr);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_release",
          "args": [
            "&pvec"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "__pagevec_release",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "805-813",
          "snippet": "void __pagevec_release(struct pagevec *pvec)\n{\n\tif (!pvec->percpu_pvec_drained) {\n\t\tlru_add_drain();\n\t\tpvec->percpu_pvec_drained = true;\n\t}\n\trelease_pages(pvec->pages, pagevec_count(pvec));\n\tpagevec_reinit(pvec);\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid __pagevec_release(struct pagevec *pvec)\n{\n\tif (!pvec->percpu_pvec_drained) {\n\t\tlru_add_drain();\n\t\tpvec->percpu_pvec_drained = true;\n\t}\n\trelease_pages(pvec->pages, pagevec_count(pvec));\n\tpagevec_reinit(pvec);\n}"
        }
      },
      {
        "call_info": {
          "callee": "check_move_unevictable_pages",
          "args": [
            "pvec.pages",
            "pvec.nr"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "check_move_unevictable_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmscan.c",
          "lines": "4195-4235",
          "snippet": "void check_move_unevictable_pages(struct page **pages, int nr_pages)\n{\n\tstruct lruvec *lruvec;\n\tstruct pglist_data *pgdat = NULL;\n\tint pgscanned = 0;\n\tint pgrescued = 0;\n\tint i;\n\n\tfor (i = 0; i < nr_pages; i++) {\n\t\tstruct page *page = pages[i];\n\t\tstruct pglist_data *pagepgdat = page_pgdat(page);\n\n\t\tpgscanned++;\n\t\tif (pagepgdat != pgdat) {\n\t\t\tif (pgdat)\n\t\t\t\tspin_unlock_irq(&pgdat->lru_lock);\n\t\t\tpgdat = pagepgdat;\n\t\t\tspin_lock_irq(&pgdat->lru_lock);\n\t\t}\n\t\tlruvec = mem_cgroup_page_lruvec(page, pgdat);\n\n\t\tif (!PageLRU(page) || !PageUnevictable(page))\n\t\t\tcontinue;\n\n\t\tif (page_evictable(page)) {\n\t\t\tenum lru_list lru = page_lru_base_type(page);\n\n\t\t\tVM_BUG_ON_PAGE(PageActive(page), page);\n\t\t\tClearPageUnevictable(page);\n\t\t\tdel_page_from_lru_list(page, lruvec, LRU_UNEVICTABLE);\n\t\t\tadd_page_to_lru_list(page, lruvec, lru);\n\t\t\tpgrescued++;\n\t\t}\n\t}\n\n\tif (pgdat) {\n\t\t__count_vm_events(UNEVICTABLE_PGRESCUED, pgrescued);\n\t\t__count_vm_events(UNEVICTABLE_PGSCANNED, pgscanned);\n\t\tspin_unlock_irq(&pgdat->lru_lock);\n\t}\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include \"internal.h\"",
            "#include <linux/balloon_compaction.h>",
            "#include <linux/swapops.h>",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/psi.h>",
            "#include <linux/dax.h>",
            "#include <linux/printk.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/oom.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/delay.h>",
            "#include <linux/rwsem.h>",
            "#include <linux/notifier.h>",
            "#include <linux/compaction.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/topology.h>",
            "#include <linux/rmap.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/buffer_head.h>\t/* for try_to_release_page(),\n\t\t\t\t\tbuffer_heads_over_limit */",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/file.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/highmem.h>",
            "#include <linux/init.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/gfp.h>",
            "#include <linux/module.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include \"internal.h\"\n#include <linux/balloon_compaction.h>\n#include <linux/swapops.h>\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <linux/psi.h>\n#include <linux/dax.h>\n#include <linux/printk.h>\n#include <linux/prefetch.h>\n#include <linux/oom.h>\n#include <linux/sysctl.h>\n#include <linux/delayacct.h>\n#include <linux/memcontrol.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/delay.h>\n#include <linux/rwsem.h>\n#include <linux/notifier.h>\n#include <linux/compaction.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/topology.h>\n#include <linux/rmap.h>\n#include <linux/backing-dev.h>\n#include <linux/mm_inline.h>\n#include <linux/buffer_head.h>\t/* for try_to_release_page(),\n\t\t\t\t\tbuffer_heads_over_limit */\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/file.h>\n#include <linux/vmstat.h>\n#include <linux/vmpressure.h>\n#include <linux/highmem.h>\n#include <linux/init.h>\n#include <linux/pagemap.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/gfp.h>\n#include <linux/module.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nvoid check_move_unevictable_pages(struct page **pages, int nr_pages)\n{\n\tstruct lruvec *lruvec;\n\tstruct pglist_data *pgdat = NULL;\n\tint pgscanned = 0;\n\tint pgrescued = 0;\n\tint i;\n\n\tfor (i = 0; i < nr_pages; i++) {\n\t\tstruct page *page = pages[i];\n\t\tstruct pglist_data *pagepgdat = page_pgdat(page);\n\n\t\tpgscanned++;\n\t\tif (pagepgdat != pgdat) {\n\t\t\tif (pgdat)\n\t\t\t\tspin_unlock_irq(&pgdat->lru_lock);\n\t\t\tpgdat = pagepgdat;\n\t\t\tspin_lock_irq(&pgdat->lru_lock);\n\t\t}\n\t\tlruvec = mem_cgroup_page_lruvec(page, pgdat);\n\n\t\tif (!PageLRU(page) || !PageUnevictable(page))\n\t\t\tcontinue;\n\n\t\tif (page_evictable(page)) {\n\t\t\tenum lru_list lru = page_lru_base_type(page);\n\n\t\t\tVM_BUG_ON_PAGE(PageActive(page), page);\n\t\t\tClearPageUnevictable(page);\n\t\t\tdel_page_from_lru_list(page, lruvec, LRU_UNEVICTABLE);\n\t\t\tadd_page_to_lru_list(page, lruvec, lru);\n\t\t\tpgrescued++;\n\t\t}\n\t}\n\n\tif (pgdat) {\n\t\t__count_vm_events(UNEVICTABLE_PGRESCUED, pgrescued);\n\t\t__count_vm_events(UNEVICTABLE_PGSCANNED, pgscanned);\n\t\tspin_unlock_irq(&pgdat->lru_lock);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pagevec_remove_exceptionals",
          "args": [
            "&pvec"
          ],
          "line": 758
        },
        "resolved": true,
        "details": {
          "function_name": "pagevec_remove_exceptionals",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap.c",
          "lines": "961-971",
          "snippet": "void pagevec_remove_exceptionals(struct pagevec *pvec)\n{\n\tint i, j;\n\n\tfor (i = 0, j = 0; i < pagevec_count(pvec); i++) {\n\t\tstruct page *page = pvec->pages[i];\n\t\tif (!xa_is_value(page))\n\t\t\tpvec->pages[j++] = page;\n\t}\n\tpvec->nr = j;\n}",
          "includes": [
            "#include <trace/events/pagemap.h>",
            "#include \"internal.h\"",
            "#include <linux/page_idle.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/uio.h>",
            "#include <linux/gfp.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/memremap.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/export.h>",
            "#include <linux/init.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/pagemap.h>\n#include \"internal.h\"\n#include <linux/page_idle.h>\n#include <linux/hugetlb.h>\n#include <linux/uio.h>\n#include <linux/gfp.h>\n#include <linux/memcontrol.h>\n#include <linux/backing-dev.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/memremap.h>\n#include <linux/percpu_counter.h>\n#include <linux/mm_inline.h>\n#include <linux/export.h>\n#include <linux/init.h>\n#include <linux/pagevec.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid pagevec_remove_exceptionals(struct pagevec *pvec)\n{\n\tint i, j;\n\n\tfor (i = 0, j = 0; i < pagevec_count(pvec); i++) {\n\t\tstruct page *page = pvec->pages[i];\n\t\tif (!xa_is_value(page))\n\t\t\tpvec->pages[j++] = page;\n\t}\n\tpvec->nr = j;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_get_entries",
          "args": [
            "mapping",
            "index",
            "PAGEVEC_SIZE",
            "pvec.pages",
            "indices"
          ],
          "line": 753
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_entries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/filemap.c",
          "lines": "1601-1650",
          "snippet": "unsigned find_get_entries(struct address_space *mapping,\n\t\t\t  pgoff_t start, unsigned int nr_entries,\n\t\t\t  struct page **entries, pgoff_t *indices)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned int ret = 0;\n\n\tif (!nr_entries)\n\t\treturn 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, ULONG_MAX) {\n\t\tstruct page *head;\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\t/*\n\t\t * A shadow entry of a recently evicted page, a swap\n\t\t * entry from shmem/tmpfs or a DAX entry.  Return it\n\t\t * without attempting to raise page count.\n\t\t */\n\t\tif (xa_is_value(page))\n\t\t\tgoto export;\n\n\t\thead = compound_head(page);\n\t\tif (!page_cache_get_speculative(head))\n\t\t\tgoto retry;\n\n\t\t/* The page was split under us? */\n\t\tif (compound_head(page) != head)\n\t\t\tgoto put_page;\n\n\t\t/* Has the page moved? */\n\t\tif (unlikely(page != xas_reload(&xas)))\n\t\t\tgoto put_page;\n\nexport:\n\t\tindices[ret] = xas.xa_index;\n\t\tentries[ret] = page;\n\t\tif (++ret == nr_entries)\n\t\t\tbreak;\n\t\tcontinue;\nput_page:\n\t\tput_page(head);\nretry:\n\t\txas_reset(&xas);\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}",
          "includes": [
            "#include <asm/mman.h>",
            "#include <linux/buffer_head.h> /* for try_to_free_buffers */",
            "#include <trace/events/filemap.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/rmap.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/security.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/hash.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/capability.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/fs.h>",
            "#include <linux/dax.h>",
            "#include <linux/compiler.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/mman.h>\n#include <linux/buffer_head.h> /* for try_to_free_buffers */\n#include <trace/events/filemap.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/delayacct.h>\n#include <linux/rmap.h>\n#include <linux/shmem_fs.h>\n#include <linux/cleancache.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/cpuset.h>\n#include <linux/security.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/hash.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/capability.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/dax.h>\n#include <linux/compiler.h>\n#include <linux/export.h>\n\nunsigned find_get_entries(struct address_space *mapping,\n\t\t\t  pgoff_t start, unsigned int nr_entries,\n\t\t\t  struct page **entries, pgoff_t *indices)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned int ret = 0;\n\n\tif (!nr_entries)\n\t\treturn 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, ULONG_MAX) {\n\t\tstruct page *head;\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\t/*\n\t\t * A shadow entry of a recently evicted page, a swap\n\t\t * entry from shmem/tmpfs or a DAX entry.  Return it\n\t\t * without attempting to raise page count.\n\t\t */\n\t\tif (xa_is_value(page))\n\t\t\tgoto export;\n\n\t\thead = compound_head(page);\n\t\tif (!page_cache_get_speculative(head))\n\t\t\tgoto retry;\n\n\t\t/* The page was split under us? */\n\t\tif (compound_head(page) != head)\n\t\t\tgoto put_page;\n\n\t\t/* Has the page moved? */\n\t\tif (unlikely(page != xas_reload(&xas)))\n\t\t\tgoto put_page;\n\nexport:\n\t\tindices[ret] = xas.xa_index;\n\t\tentries[ret] = page;\n\t\tif (++ret == nr_entries)\n\t\t\tbreak;\n\t\tcontinue;\nput_page:\n\t\tput_page(head);\nretry:\n\t\txas_reset(&xas);\n\t}\n\trcu_read_unlock();\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapping_unevictable",
          "args": [
            "mapping"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagevec_init",
          "args": [
            "&pvec"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nvoid shmem_unlock_mapping(struct address_space *mapping)\n{\n\tstruct pagevec pvec;\n\tpgoff_t indices[PAGEVEC_SIZE];\n\tpgoff_t index = 0;\n\n\tpagevec_init(&pvec);\n\t/*\n\t * Minor point, but we might as well stop if someone else SHM_LOCKs it.\n\t */\n\twhile (!mapping_unevictable(mapping)) {\n\t\t/*\n\t\t * Avoid pagevec_lookup(): find_get_pages() returns 0 as if it\n\t\t * has finished, if it hits a row of PAGEVEC_SIZE swap entries.\n\t\t */\n\t\tpvec.nr = find_get_entries(mapping, index,\n\t\t\t\t\t   PAGEVEC_SIZE, pvec.pages, indices);\n\t\tif (!pvec.nr)\n\t\t\tbreak;\n\t\tindex = indices[pvec.nr - 1] + 1;\n\t\tpagevec_remove_exceptionals(&pvec);\n\t\tcheck_move_unevictable_pages(pvec.pages, pvec.nr);\n\t\tpagevec_release(&pvec);\n\t\tcond_resched();\n\t}\n}"
  },
  {
    "function_name": "shmem_swap_usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "708-733",
    "snippet": "unsigned long shmem_swap_usage(struct vm_area_struct *vma)\n{\n\tstruct inode *inode = file_inode(vma->vm_file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct address_space *mapping = inode->i_mapping;\n\tunsigned long swapped;\n\n\t/* Be careful as we don't hold info->lock */\n\tswapped = READ_ONCE(info->swapped);\n\n\t/*\n\t * The easier cases are when the shmem object has nothing in swap, or\n\t * the vma maps it whole. Then we can simply use the stats that we\n\t * already track.\n\t */\n\tif (!swapped)\n\t\treturn 0;\n\n\tif (!vma->vm_pgoff && vma->vm_end - vma->vm_start >= inode->i_size)\n\t\treturn swapped << PAGE_SHIFT;\n\n\t/* Here comes the more involved part */\n\treturn shmem_partial_swap_usage(mapping,\n\t\t\tlinear_page_index(vma, vma->vm_start),\n\t\t\tlinear_page_index(vma, vma->vm_end));\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_partial_swap_usage",
          "args": [
            "mapping",
            "linear_page_index(vma, vma->vm_start)",
            "linear_page_index(vma, vma->vm_end)"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_partial_swap_usage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "676-699",
          "snippet": "unsigned long shmem_partial_swap_usage(struct address_space *mapping,\n\t\t\t\t\t\tpgoff_t start, pgoff_t end)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned long swapped = 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, end - 1) {\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\tif (xa_is_value(page))\n\t\t\tswapped++;\n\n\t\tif (need_resched()) {\n\t\t\txas_pause(&xas);\n\t\t\tcond_resched_rcu();\n\t\t}\n\t}\n\n\trcu_read_unlock();\n\n\treturn swapped << PAGE_SHIFT;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nunsigned long shmem_partial_swap_usage(struct address_space *mapping,\n\t\t\t\t\t\tpgoff_t start, pgoff_t end)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned long swapped = 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, end - 1) {\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\tif (xa_is_value(page))\n\t\t\tswapped++;\n\n\t\tif (need_resched()) {\n\t\t\txas_pause(&xas);\n\t\t\tcond_resched_rcu();\n\t\t}\n\t}\n\n\trcu_read_unlock();\n\n\treturn swapped << PAGE_SHIFT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "linear_page_index",
          "args": [
            "vma",
            "vma->vm_end"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "linear_page_index",
          "args": [
            "vma",
            "vma->vm_start"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "info->swapped"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_inode",
          "args": [
            "vma->vm_file"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nunsigned long shmem_swap_usage(struct vm_area_struct *vma)\n{\n\tstruct inode *inode = file_inode(vma->vm_file);\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct address_space *mapping = inode->i_mapping;\n\tunsigned long swapped;\n\n\t/* Be careful as we don't hold info->lock */\n\tswapped = READ_ONCE(info->swapped);\n\n\t/*\n\t * The easier cases are when the shmem object has nothing in swap, or\n\t * the vma maps it whole. Then we can simply use the stats that we\n\t * already track.\n\t */\n\tif (!swapped)\n\t\treturn 0;\n\n\tif (!vma->vm_pgoff && vma->vm_end - vma->vm_start >= inode->i_size)\n\t\treturn swapped << PAGE_SHIFT;\n\n\t/* Here comes the more involved part */\n\treturn shmem_partial_swap_usage(mapping,\n\t\t\tlinear_page_index(vma, vma->vm_start),\n\t\t\tlinear_page_index(vma, vma->vm_end));\n}"
  },
  {
    "function_name": "shmem_partial_swap_usage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "676-699",
    "snippet": "unsigned long shmem_partial_swap_usage(struct address_space *mapping,\n\t\t\t\t\t\tpgoff_t start, pgoff_t end)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned long swapped = 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, end - 1) {\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\tif (xa_is_value(page))\n\t\t\tswapped++;\n\n\t\tif (need_resched()) {\n\t\t\txas_pause(&xas);\n\t\t\tcond_resched_rcu();\n\t\t}\n\t}\n\n\trcu_read_unlock();\n\n\treturn swapped << PAGE_SHIFT;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched_rcu",
          "args": [],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_pause",
          "args": [
            "&xas"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "need_resched",
          "args": [],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_is_value",
          "args": [
            "page"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_retry",
          "args": [
            "&xas",
            "page"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_for_each",
          "args": [
            "&xas",
            "page",
            "end - 1"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XA_STATE",
          "args": [
            "xas",
            "&mapping->i_pages",
            "start"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nunsigned long shmem_partial_swap_usage(struct address_space *mapping,\n\t\t\t\t\t\tpgoff_t start, pgoff_t end)\n{\n\tXA_STATE(xas, &mapping->i_pages, start);\n\tstruct page *page;\n\tunsigned long swapped = 0;\n\n\trcu_read_lock();\n\txas_for_each(&xas, page, end - 1) {\n\t\tif (xas_retry(&xas, page))\n\t\t\tcontinue;\n\t\tif (xa_is_value(page))\n\t\t\tswapped++;\n\n\t\tif (need_resched()) {\n\t\t\txas_pause(&xas);\n\t\t\tcond_resched_rcu();\n\t\t}\n\t}\n\n\trcu_read_unlock();\n\n\treturn swapped << PAGE_SHIFT;\n}"
  },
  {
    "function_name": "shmem_free_swap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "655-667",
    "snippet": "static int shmem_free_swap(struct address_space *mapping,\n\t\t\t   pgoff_t index, void *radswap)\n{\n\tvoid *old;\n\n\txa_lock_irq(&mapping->i_pages);\n\told = __xa_cmpxchg(&mapping->i_pages, index, radswap, NULL, 0);\n\txa_unlock_irq(&mapping->i_pages);\n\tif (old != radswap)\n\t\treturn -ENOENT;\n\tfree_swap_and_cache(radix_to_swp_entry(radswap));\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_swap_and_cache",
          "args": [
            "radix_to_swp_entry(radswap)"
          ],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "free_swap_and_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "1623-1640",
          "snippet": "int free_swap_and_cache(swp_entry_t entry)\n{\n\tstruct swap_info_struct *p;\n\tunsigned char count;\n\n\tif (non_swap_entry(entry))\n\t\treturn 1;\n\n\tp = _swap_info_get(entry);\n\tif (p) {\n\t\tcount = __swap_entry_free(p, entry, 1);\n\t\tif (count == SWAP_HAS_CACHE &&\n\t\t    !swap_page_trans_huge_swapped(p, entry))\n\t\t\t__try_to_reclaim_swap(p, swp_offset(entry),\n\t\t\t\t\t      TTRS_UNMAPPED | TTRS_FULL);\n\t}\n\treturn p != NULL;\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [
            "#define TTRS_FULL\t\t0x4",
            "#define TTRS_UNMAPPED\t\t0x2"
          ],
          "globals_used": [
            "static void free_swap_count_continuations(struct swap_info_struct *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\n#define TTRS_FULL\t\t0x4\n#define TTRS_UNMAPPED\t\t0x2\n\nstatic void free_swap_count_continuations(struct swap_info_struct *);\n\nint free_swap_and_cache(swp_entry_t entry)\n{\n\tstruct swap_info_struct *p;\n\tunsigned char count;\n\n\tif (non_swap_entry(entry))\n\t\treturn 1;\n\n\tp = _swap_info_get(entry);\n\tif (p) {\n\t\tcount = __swap_entry_free(p, entry, 1);\n\t\tif (count == SWAP_HAS_CACHE &&\n\t\t    !swap_page_trans_huge_swapped(p, entry))\n\t\t\t__try_to_reclaim_swap(p, swp_offset(entry),\n\t\t\t\t\t      TTRS_UNMAPPED | TTRS_FULL);\n\t}\n\treturn p != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "radix_to_swp_entry",
          "args": [
            "radswap"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_unlock_irq",
          "args": [
            "&mapping->i_pages"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__xa_cmpxchg",
          "args": [
            "&mapping->i_pages",
            "index",
            "radswap",
            "NULL",
            "0"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_lock_irq",
          "args": [
            "&mapping->i_pages"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_free_swap(struct address_space *mapping,\n\t\t\t   pgoff_t index, void *radswap)\n{\n\tvoid *old;\n\n\txa_lock_irq(&mapping->i_pages);\n\told = __xa_cmpxchg(&mapping->i_pages, index, radswap, NULL, 0);\n\txa_unlock_irq(&mapping->i_pages);\n\tif (old != radswap)\n\t\treturn -ENOENT;\n\tfree_swap_and_cache(radix_to_swp_entry(radswap));\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_delete_from_page_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "634-650",
    "snippet": "static void shmem_delete_from_page_cache(struct page *page, void *radswap)\n{\n\tstruct address_space *mapping = page->mapping;\n\tint error;\n\n\tVM_BUG_ON_PAGE(PageCompound(page), page);\n\n\txa_lock_irq(&mapping->i_pages);\n\terror = shmem_replace_entry(mapping, page->index, page, radswap);\n\tpage->mapping = NULL;\n\tmapping->nrpages--;\n\t__dec_node_page_state(page, NR_FILE_PAGES);\n\t__dec_node_page_state(page, NR_SHMEM);\n\txa_unlock_irq(&mapping->i_pages);\n\tput_page(page);\n\tBUG_ON(error);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "error"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 648
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_unlock_irq",
          "args": [
            "&mapping->i_pages"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__dec_node_page_state",
          "args": [
            "page",
            "NR_SHMEM"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "__dec_node_page_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmstat.c",
          "lines": "460-463",
          "snippet": "void __dec_node_page_state(struct page *page, enum node_stat_item item)\n{\n\t__dec_node_state(page_pgdat(page), item);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/writeback.h>",
            "#include <linux/math64.h>",
            "#include <linux/sched.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/err.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/page_ext.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/writeback.h>\n#include <linux/math64.h>\n#include <linux/sched.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/vmstat.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nvoid __dec_node_page_state(struct page *page, enum node_stat_item item)\n{\n\t__dec_node_state(page_pgdat(page), item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "shmem_replace_entry",
          "args": [
            "mapping",
            "page->index",
            "page",
            "radswap"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_replace_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "327-340",
          "snippet": "static int shmem_replace_entry(struct address_space *mapping,\n\t\t\tpgoff_t index, void *expected, void *replacement)\n{\n\tXA_STATE(xas, &mapping->i_pages, index);\n\tvoid *item;\n\n\tVM_BUG_ON(!expected);\n\tVM_BUG_ON(!replacement);\n\titem = xas_load(&xas);\n\tif (item != expected)\n\t\treturn -ENOENT;\n\txas_store(&xas, replacement);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_replace_entry(struct address_space *mapping,\n\t\t\tpgoff_t index, void *expected, void *replacement)\n{\n\tXA_STATE(xas, &mapping->i_pages, index);\n\tvoid *item;\n\n\tVM_BUG_ON(!expected);\n\tVM_BUG_ON(!replacement);\n\titem = xas_load(&xas);\n\tif (item != expected)\n\t\treturn -ENOENT;\n\txas_store(&xas, replacement);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_lock_irq",
          "args": [
            "&mapping->i_pages"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "PageCompound(page)",
            "page"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageCompound",
          "args": [
            "page"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_delete_from_page_cache(struct page *page, void *radswap)\n{\n\tstruct address_space *mapping = page->mapping;\n\tint error;\n\n\tVM_BUG_ON_PAGE(PageCompound(page), page);\n\n\txa_lock_irq(&mapping->i_pages);\n\terror = shmem_replace_entry(mapping, page->index, page, radswap);\n\tpage->mapping = NULL;\n\tmapping->nrpages--;\n\t__dec_node_page_state(page, NR_FILE_PAGES);\n\t__dec_node_page_state(page, NR_SHMEM);\n\txa_unlock_irq(&mapping->i_pages);\n\tput_page(page);\n\tBUG_ON(error);\n}"
  },
  {
    "function_name": "shmem_add_to_page_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "578-629",
    "snippet": "static int shmem_add_to_page_cache(struct page *page,\n\t\t\t\t   struct address_space *mapping,\n\t\t\t\t   pgoff_t index, void *expected, gfp_t gfp)\n{\n\tXA_STATE_ORDER(xas, &mapping->i_pages, index, compound_order(page));\n\tunsigned long i = 0;\n\tunsigned long nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(PageTail(page), page);\n\tVM_BUG_ON_PAGE(index != round_down(index, nr), page);\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\tVM_BUG_ON(expected && PageTransHuge(page));\n\n\tpage_ref_add(page, nr);\n\tpage->mapping = mapping;\n\tpage->index = index;\n\n\tdo {\n\t\tvoid *entry;\n\t\txas_lock_irq(&xas);\n\t\tentry = xas_find_conflict(&xas);\n\t\tif (entry != expected)\n\t\t\txas_set_err(&xas, -EEXIST);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\nnext:\n\t\txas_store(&xas, page + i);\n\t\tif (++i < nr) {\n\t\t\txas_next(&xas);\n\t\t\tgoto next;\n\t\t}\n\t\tif (PageTransHuge(page)) {\n\t\t\tcount_vm_event(THP_FILE_ALLOC);\n\t\t\t__inc_node_page_state(page, NR_SHMEM_THPS);\n\t\t}\n\t\tmapping->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\t__mod_node_page_state(page_pgdat(page), NR_SHMEM, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (xas_error(&xas)) {\n\t\tpage->mapping = NULL;\n\t\tpage_ref_sub(page, nr);\n\t\treturn xas_error(&xas);\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xas_error",
          "args": [
            "&xas"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_ref_sub",
          "args": [
            "page",
            "nr"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_error",
          "args": [
            "&xas"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_nomem",
          "args": [
            "&xas",
            "gfp"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_unlock_irq",
          "args": [
            "&xas"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__mod_node_page_state",
          "args": [
            "page_pgdat(page)",
            "NR_SHMEM",
            "nr"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "__mod_node_page_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmstat.c",
          "lines": "335-352",
          "snippet": "void __mod_node_page_state(struct pglist_data *pgdat, enum node_stat_item item,\n\t\t\t\tlong delta)\n{\n\tstruct per_cpu_nodestat __percpu *pcp = pgdat->per_cpu_nodestats;\n\ts8 __percpu *p = pcp->vm_node_stat_diff + item;\n\tlong x;\n\tlong t;\n\n\tx = delta + __this_cpu_read(*p);\n\n\tt = __this_cpu_read(pcp->stat_threshold);\n\n\tif (unlikely(x > t || x < -t)) {\n\t\tnode_page_state_add(x, pgdat, item);\n\t\tx = 0;\n\t}\n\t__this_cpu_write(*p, x);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/writeback.h>",
            "#include <linux/math64.h>",
            "#include <linux/sched.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/err.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/page_ext.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/writeback.h>\n#include <linux/math64.h>\n#include <linux/sched.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/vmstat.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nvoid __mod_node_page_state(struct pglist_data *pgdat, enum node_stat_item item,\n\t\t\t\tlong delta)\n{\n\tstruct per_cpu_nodestat __percpu *pcp = pgdat->per_cpu_nodestats;\n\ts8 __percpu *p = pcp->vm_node_stat_diff + item;\n\tlong x;\n\tlong t;\n\n\tx = delta + __this_cpu_read(*p);\n\n\tt = __this_cpu_read(pcp->stat_threshold);\n\n\tif (unlikely(x > t || x < -t)) {\n\t\tnode_page_state_add(x, pgdat, item);\n\t\tx = 0;\n\t}\n\t__this_cpu_write(*p, x);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_pgdat",
          "args": [
            "page"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_pgdat",
          "args": [
            "page"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__inc_node_page_state",
          "args": [
            "page",
            "NR_SHMEM_THPS"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "__inc_node_page_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmstat.c",
          "lines": "416-419",
          "snippet": "void __inc_node_page_state(struct page *page, enum node_stat_item item)\n{\n\t__inc_node_state(page_pgdat(page), item);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/writeback.h>",
            "#include <linux/math64.h>",
            "#include <linux/sched.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/err.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/page_ext.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/writeback.h>\n#include <linux/math64.h>\n#include <linux/sched.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/vmstat.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nvoid __inc_node_page_state(struct page *page, enum node_stat_item item)\n{\n\t__inc_node_state(page_pgdat(page), item);\n}"
        }
      },
      {
        "call_info": {
          "callee": "count_vm_event",
          "args": [
            "THP_FILE_ALLOC"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_next",
          "args": [
            "&xas"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_store",
          "args": [
            "&xas",
            "page + i"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_error",
          "args": [
            "&xas"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_create_range",
          "args": [
            "&xas"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_set_err",
          "args": [
            "&xas",
            "-EEXIST"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_find_conflict",
          "args": [
            "&xas"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_lock_irq",
          "args": [
            "&xas"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_ref_add",
          "args": [
            "page",
            "nr"
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "expected && PageTransHuge(page)"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!PageSwapBacked(page)",
            "page"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageSwapBacked",
          "args": [
            "page"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!PageLocked(page)",
            "page"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageLocked",
          "args": [
            "page"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "index != round_down(index, nr)",
            "page"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "index",
            "nr"
          ],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "PageTail(page)",
            "page"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTail",
          "args": [
            "page"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "page"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XA_STATE_ORDER",
          "args": [
            "xas",
            "&mapping->i_pages",
            "index",
            "compound_order(page)"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "page"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_add_to_page_cache(struct page *page,\n\t\t\t\t   struct address_space *mapping,\n\t\t\t\t   pgoff_t index, void *expected, gfp_t gfp)\n{\n\tXA_STATE_ORDER(xas, &mapping->i_pages, index, compound_order(page));\n\tunsigned long i = 0;\n\tunsigned long nr = 1UL << compound_order(page);\n\n\tVM_BUG_ON_PAGE(PageTail(page), page);\n\tVM_BUG_ON_PAGE(index != round_down(index, nr), page);\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageSwapBacked(page), page);\n\tVM_BUG_ON(expected && PageTransHuge(page));\n\n\tpage_ref_add(page, nr);\n\tpage->mapping = mapping;\n\tpage->index = index;\n\n\tdo {\n\t\tvoid *entry;\n\t\txas_lock_irq(&xas);\n\t\tentry = xas_find_conflict(&xas);\n\t\tif (entry != expected)\n\t\t\txas_set_err(&xas, -EEXIST);\n\t\txas_create_range(&xas);\n\t\tif (xas_error(&xas))\n\t\t\tgoto unlock;\nnext:\n\t\txas_store(&xas, page + i);\n\t\tif (++i < nr) {\n\t\t\txas_next(&xas);\n\t\t\tgoto next;\n\t\t}\n\t\tif (PageTransHuge(page)) {\n\t\t\tcount_vm_event(THP_FILE_ALLOC);\n\t\t\t__inc_node_page_state(page, NR_SHMEM_THPS);\n\t\t}\n\t\tmapping->nrpages += nr;\n\t\t__mod_node_page_state(page_pgdat(page), NR_FILE_PAGES, nr);\n\t\t__mod_node_page_state(page_pgdat(page), NR_SHMEM, nr);\nunlock:\n\t\txas_unlock_irq(&xas);\n\t} while (xas_nomem(&xas, gfp));\n\n\tif (xas_error(&xas)) {\n\t\tpage->mapping = NULL;\n\t\tpage_ref_sub(page, nr);\n\t\treturn xas_error(&xas);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "is_huge_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "566-573",
    "snippet": "static inline bool is_huge_enabled(struct shmem_sb_info *sbinfo)\n{\n\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE) &&\n\t    (shmem_huge == SHMEM_HUGE_FORCE || sbinfo->huge) &&\n\t    shmem_huge != SHMEM_HUGE_DENY)\n\t\treturn true;\n\treturn false;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_huge SHMEM_HUGE_DENY",
      "#define SHMEM_HUGE_FORCE\t(-2)",
      "#define SHMEM_HUGE_DENY\t\t(-1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_TRANSPARENT_HUGE_PAGECACHE"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n\nstatic inline bool is_huge_enabled(struct shmem_sb_info *sbinfo)\n{\n\tif (IS_ENABLED(CONFIG_TRANSPARENT_HUGE_PAGECACHE) &&\n\t    (shmem_huge == SHMEM_HUGE_FORCE || sbinfo->huge) &&\n\t    shmem_huge != SHMEM_HUGE_DENY)\n\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "shmem_unused_huge_shrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "559-563",
    "snippet": "static unsigned long shmem_unused_huge_shrink(struct shmem_sb_info *sbinfo,\n\t\tstruct shrink_control *sc, unsigned long nr_to_split)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_unused_huge_shrink(struct shmem_sb_info *sbinfo,\n\t\tstruct shrink_control *sc, unsigned long nr_to_split)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_unused_huge_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "549-554",
    "snippet": "static long shmem_unused_huge_count(struct super_block *sb,\n\t\tstruct shrink_control *sc)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\treturn READ_ONCE(sbinfo->shrinklist_len);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "sbinfo->shrinklist_len"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "sb"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic long shmem_unused_huge_count(struct super_block *sb,\n\t\tstruct shrink_control *sc)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\treturn READ_ONCE(sbinfo->shrinklist_len);\n}"
  },
  {
    "function_name": "shmem_unused_huge_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "538-547",
    "snippet": "static long shmem_unused_huge_scan(struct super_block *sb,\n\t\tstruct shrink_control *sc)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (!READ_ONCE(sbinfo->shrinklist_len))\n\t\treturn SHRINK_STOP;\n\n\treturn shmem_unused_huge_shrink(sbinfo, sc, 0);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_unused_huge_shrink",
          "args": [
            "sbinfo",
            "sc",
            "0"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unused_huge_shrink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "559-563",
          "snippet": "static unsigned long shmem_unused_huge_shrink(struct shmem_sb_info *sbinfo,\n\t\tstruct shrink_control *sc, unsigned long nr_to_split)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_unused_huge_shrink(struct shmem_sb_info *sbinfo,\n\t\tstruct shrink_control *sc, unsigned long nr_to_split)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "sbinfo->shrinklist_len"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "sb"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic long shmem_unused_huge_scan(struct super_block *sb,\n\t\tstruct shrink_control *sc)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\n\tif (!READ_ONCE(sbinfo->shrinklist_len))\n\t\treturn SHRINK_STOP;\n\n\treturn shmem_unused_huge_shrink(sbinfo, sc, 0);\n}"
  },
  {
    "function_name": "shmem_unused_huge_shrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "432-536",
    "snippet": "static unsigned long shmem_unused_huge_shrink(struct shmem_sb_info *sbinfo,\n\t\tstruct shrink_control *sc, unsigned long nr_to_split)\n{\n\tLIST_HEAD(list), *pos, *next;\n\tLIST_HEAD(to_remove);\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct page *page;\n\tunsigned long batch = sc ? sc->nr_to_scan : 128;\n\tint removed = 0, split = 0;\n\n\tif (list_empty(&sbinfo->shrinklist))\n\t\treturn SHRINK_STOP;\n\n\tspin_lock(&sbinfo->shrinklist_lock);\n\tlist_for_each_safe(pos, next, &sbinfo->shrinklist) {\n\t\tinfo = list_entry(pos, struct shmem_inode_info, shrinklist);\n\n\t\t/* pin the inode */\n\t\tinode = igrab(&info->vfs_inode);\n\n\t\t/* inode is about to be evicted */\n\t\tif (!inode) {\n\t\t\tlist_del_init(&info->shrinklist);\n\t\t\tremoved++;\n\t\t\tgoto next;\n\t\t}\n\n\t\t/* Check if there's anything to gain */\n\t\tif (round_up(inode->i_size, PAGE_SIZE) ==\n\t\t\t\tround_up(inode->i_size, HPAGE_PMD_SIZE)) {\n\t\t\tlist_move(&info->shrinklist, &to_remove);\n\t\t\tremoved++;\n\t\t\tgoto next;\n\t\t}\n\n\t\tlist_move(&info->shrinklist, &list);\nnext:\n\t\tif (!--batch)\n\t\t\tbreak;\n\t}\n\tspin_unlock(&sbinfo->shrinklist_lock);\n\n\tlist_for_each_safe(pos, next, &to_remove) {\n\t\tinfo = list_entry(pos, struct shmem_inode_info, shrinklist);\n\t\tinode = &info->vfs_inode;\n\t\tlist_del_init(&info->shrinklist);\n\t\tiput(inode);\n\t}\n\n\tlist_for_each_safe(pos, next, &list) {\n\t\tint ret;\n\n\t\tinfo = list_entry(pos, struct shmem_inode_info, shrinklist);\n\t\tinode = &info->vfs_inode;\n\n\t\tif (nr_to_split && split >= nr_to_split)\n\t\t\tgoto leave;\n\n\t\tpage = find_get_page(inode->i_mapping,\n\t\t\t\t(inode->i_size & HPAGE_PMD_MASK) >> PAGE_SHIFT);\n\t\tif (!page)\n\t\t\tgoto drop;\n\n\t\t/* No huge page at the end of the file: nothing to split */\n\t\tif (!PageTransHuge(page)) {\n\t\t\tput_page(page);\n\t\t\tgoto drop;\n\t\t}\n\n\t\t/*\n\t\t * Leave the inode on the list if we failed to lock\n\t\t * the page at this time.\n\t\t *\n\t\t * Waiting for the lock may lead to deadlock in the\n\t\t * reclaim path.\n\t\t */\n\t\tif (!trylock_page(page)) {\n\t\t\tput_page(page);\n\t\t\tgoto leave;\n\t\t}\n\n\t\tret = split_huge_page(page);\n\t\tunlock_page(page);\n\t\tput_page(page);\n\n\t\t/* If split failed leave the inode on the list */\n\t\tif (ret)\n\t\t\tgoto leave;\n\n\t\tsplit++;\ndrop:\n\t\tlist_del_init(&info->shrinklist);\n\t\tremoved++;\nleave:\n\t\tiput(inode);\n\t}\n\n\tspin_lock(&sbinfo->shrinklist_lock);\n\tlist_splice_tail(&list, &sbinfo->shrinklist);\n\tsbinfo->shrinklist_len -= removed;\n\tspin_unlock(&sbinfo->shrinklist_lock);\n\n\treturn split;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_splice_tail",
          "args": [
            "&list",
            "&sbinfo->shrinklist"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&info->shrinklist"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "split_huge_page",
          "args": [
            "page"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "deferred_split_huge_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/huge_memory.c",
          "lines": "2760-2774",
          "snippet": "void deferred_split_huge_page(struct page *page)\n{\n\tstruct pglist_data *pgdata = NODE_DATA(page_to_nid(page));\n\tunsigned long flags;\n\n\tVM_BUG_ON_PAGE(!PageTransHuge(page), page);\n\n\tspin_lock_irqsave(&pgdata->split_queue_lock, flags);\n\tif (list_empty(page_deferred_list(page))) {\n\t\tcount_vm_event(THP_DEFERRED_SPLIT_PAGE);\n\t\tlist_add_tail(page_deferred_list(page), &pgdata->split_queue);\n\t\tpgdata->split_queue_len++;\n\t}\n\tspin_unlock_irqrestore(&pgdata->split_queue_lock, flags);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/tlb.h>",
            "#include <linux/oom.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/page_idle.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/migrate.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mman.h>",
            "#include <linux/pfn_t.h>",
            "#include <linux/freezer.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/dax.h>",
            "#include <linux/swapops.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/swap.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgalloc.h>\n#include <asm/tlb.h>\n#include <linux/oom.h>\n#include <linux/shmem_fs.h>\n#include <linux/page_idle.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/hashtable.h>\n#include <linux/migrate.h>\n#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/memremap.h>\n#include <linux/mman.h>\n#include <linux/pfn_t.h>\n#include <linux/freezer.h>\n#include <linux/khugepaged.h>\n#include <linux/dax.h>\n#include <linux/swapops.h>\n#include <linux/mm_inline.h>\n#include <linux/shrinker.h>\n#include <linux/swap.h>\n#include <linux/rmap.h>\n#include <linux/mmu_notifier.h>\n#include <linux/hugetlb.h>\n#include <linux/highmem.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nvoid deferred_split_huge_page(struct page *page)\n{\n\tstruct pglist_data *pgdata = NODE_DATA(page_to_nid(page));\n\tunsigned long flags;\n\n\tVM_BUG_ON_PAGE(!PageTransHuge(page), page);\n\n\tspin_lock_irqsave(&pgdata->split_queue_lock, flags);\n\tif (list_empty(page_deferred_list(page))) {\n\t\tcount_vm_event(THP_DEFERRED_SPLIT_PAGE);\n\t\tlist_add_tail(page_deferred_list(page), &pgdata->split_queue);\n\t\tpgdata->split_queue_len++;\n\t}\n\tspin_unlock_irqrestore(&pgdata->split_queue_lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trylock_page",
          "args": [
            "page"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_get_page",
          "args": [
            "inode->i_mapping",
            "(inode->i_size & HPAGE_PMD_MASK) >> PAGE_SHIFT"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "pos",
            "structshmem_inode_info",
            "shrinklist"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_safe",
          "args": [
            "pos",
            "next",
            "&list"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "inode"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&info->shrinklist"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "pos",
            "structshmem_inode_info",
            "shrinklist"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_safe",
          "args": [
            "pos",
            "next",
            "&to_remove"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_move",
          "args": [
            "&info->shrinklist",
            "&list"
          ],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "qlist_move_all",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/quarantine.c",
          "lines": "72-88",
          "snippet": "static void qlist_move_all(struct qlist_head *from, struct qlist_head *to)\n{\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tif (qlist_empty(to)) {\n\t\t*to = *from;\n\t\tqlist_init(from);\n\t\treturn;\n\t}\n\n\tto->tail->next = from->head;\n\tto->tail = from->tail;\n\tto->bytes += from->bytes;\n\n\tqlist_init(from);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include \"../slab.h\"",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/srcu.h>",
            "#include <linux/slab.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/printk.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/hash.h>",
            "#include <linux/gfp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include \"../slab.h\"\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/srcu.h>\n#include <linux/slab.h>\n#include <linux/shrinker.h>\n#include <linux/printk.h>\n#include <linux/percpu.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/hash.h>\n#include <linux/gfp.h>\n\nstatic void qlist_move_all(struct qlist_head *from, struct qlist_head *to)\n{\n\tif (unlikely(qlist_empty(from)))\n\t\treturn;\n\n\tif (qlist_empty(to)) {\n\t\t*to = *from;\n\t\tqlist_init(from);\n\t\treturn;\n\t}\n\n\tto->tail->next = from->head;\n\tto->tail = from->tail;\n\tto->bytes += from->bytes;\n\n\tqlist_init(from);\n}"
        }
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "inode->i_size",
            "HPAGE_PMD_SIZE"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "inode->i_size",
            "PAGE_SIZE"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&info->shrinklist"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "igrab",
          "args": [
            "&info->vfs_inode"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_entry",
          "args": [
            "pos",
            "structshmem_inode_info",
            "shrinklist"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_safe",
          "args": [
            "pos",
            "next",
            "&sbinfo->shrinklist"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->shrinklist_lock"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&sbinfo->shrinklist"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "to_remove"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "list"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_unused_huge_shrink(struct shmem_sb_info *sbinfo,\n\t\tstruct shrink_control *sc, unsigned long nr_to_split)\n{\n\tLIST_HEAD(list), *pos, *next;\n\tLIST_HEAD(to_remove);\n\tstruct inode *inode;\n\tstruct shmem_inode_info *info;\n\tstruct page *page;\n\tunsigned long batch = sc ? sc->nr_to_scan : 128;\n\tint removed = 0, split = 0;\n\n\tif (list_empty(&sbinfo->shrinklist))\n\t\treturn SHRINK_STOP;\n\n\tspin_lock(&sbinfo->shrinklist_lock);\n\tlist_for_each_safe(pos, next, &sbinfo->shrinklist) {\n\t\tinfo = list_entry(pos, struct shmem_inode_info, shrinklist);\n\n\t\t/* pin the inode */\n\t\tinode = igrab(&info->vfs_inode);\n\n\t\t/* inode is about to be evicted */\n\t\tif (!inode) {\n\t\t\tlist_del_init(&info->shrinklist);\n\t\t\tremoved++;\n\t\t\tgoto next;\n\t\t}\n\n\t\t/* Check if there's anything to gain */\n\t\tif (round_up(inode->i_size, PAGE_SIZE) ==\n\t\t\t\tround_up(inode->i_size, HPAGE_PMD_SIZE)) {\n\t\t\tlist_move(&info->shrinklist, &to_remove);\n\t\t\tremoved++;\n\t\t\tgoto next;\n\t\t}\n\n\t\tlist_move(&info->shrinklist, &list);\nnext:\n\t\tif (!--batch)\n\t\t\tbreak;\n\t}\n\tspin_unlock(&sbinfo->shrinklist_lock);\n\n\tlist_for_each_safe(pos, next, &to_remove) {\n\t\tinfo = list_entry(pos, struct shmem_inode_info, shrinklist);\n\t\tinode = &info->vfs_inode;\n\t\tlist_del_init(&info->shrinklist);\n\t\tiput(inode);\n\t}\n\n\tlist_for_each_safe(pos, next, &list) {\n\t\tint ret;\n\n\t\tinfo = list_entry(pos, struct shmem_inode_info, shrinklist);\n\t\tinode = &info->vfs_inode;\n\n\t\tif (nr_to_split && split >= nr_to_split)\n\t\t\tgoto leave;\n\n\t\tpage = find_get_page(inode->i_mapping,\n\t\t\t\t(inode->i_size & HPAGE_PMD_MASK) >> PAGE_SHIFT);\n\t\tif (!page)\n\t\t\tgoto drop;\n\n\t\t/* No huge page at the end of the file: nothing to split */\n\t\tif (!PageTransHuge(page)) {\n\t\t\tput_page(page);\n\t\t\tgoto drop;\n\t\t}\n\n\t\t/*\n\t\t * Leave the inode on the list if we failed to lock\n\t\t * the page at this time.\n\t\t *\n\t\t * Waiting for the lock may lead to deadlock in the\n\t\t * reclaim path.\n\t\t */\n\t\tif (!trylock_page(page)) {\n\t\t\tput_page(page);\n\t\t\tgoto leave;\n\t\t}\n\n\t\tret = split_huge_page(page);\n\t\tunlock_page(page);\n\t\tput_page(page);\n\n\t\t/* If split failed leave the inode on the list */\n\t\tif (ret)\n\t\t\tgoto leave;\n\n\t\tsplit++;\ndrop:\n\t\tlist_del_init(&info->shrinklist);\n\t\tremoved++;\nleave:\n\t\tiput(inode);\n\t}\n\n\tspin_lock(&sbinfo->shrinklist_lock);\n\tlist_splice_tail(&list, &sbinfo->shrinklist);\n\tsbinfo->shrinklist_len -= removed;\n\tspin_unlock(&sbinfo->shrinklist_lock);\n\n\treturn split;\n}"
  },
  {
    "function_name": "shmem_format_huge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "410-429",
    "snippet": "static const char *shmem_format_huge(int huge)\n{\n\tswitch (huge) {\n\tcase SHMEM_HUGE_NEVER:\n\t\treturn \"never\";\n\tcase SHMEM_HUGE_ALWAYS:\n\t\treturn \"always\";\n\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\treturn \"within_size\";\n\tcase SHMEM_HUGE_ADVISE:\n\t\treturn \"advise\";\n\tcase SHMEM_HUGE_DENY:\n\t\treturn \"deny\";\n\tcase SHMEM_HUGE_FORCE:\n\t\treturn \"force\";\n\tdefault:\n\t\tVM_BUG_ON(1);\n\t\treturn \"bad_val\";\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define SHMEM_HUGE_FORCE\t(-2)",
      "#define SHMEM_HUGE_DENY\t\t(-1)",
      "#define SHMEM_HUGE_ADVISE\t3",
      "#define SHMEM_HUGE_WITHIN_SIZE\t2",
      "#define SHMEM_HUGE_ALWAYS\t1",
      "#define SHMEM_HUGE_NEVER\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "1"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_ALWAYS\t1\n#define SHMEM_HUGE_NEVER\t0\n\nstatic const char *shmem_format_huge(int huge)\n{\n\tswitch (huge) {\n\tcase SHMEM_HUGE_NEVER:\n\t\treturn \"never\";\n\tcase SHMEM_HUGE_ALWAYS:\n\t\treturn \"always\";\n\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\treturn \"within_size\";\n\tcase SHMEM_HUGE_ADVISE:\n\t\treturn \"advise\";\n\tcase SHMEM_HUGE_DENY:\n\t\treturn \"deny\";\n\tcase SHMEM_HUGE_FORCE:\n\t\treturn \"force\";\n\tdefault:\n\t\tVM_BUG_ON(1);\n\t\treturn \"bad_val\";\n\t}\n}"
  },
  {
    "function_name": "shmem_parse_huge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "393-408",
    "snippet": "static int shmem_parse_huge(const char *str)\n{\n\tif (!strcmp(str, \"never\"))\n\t\treturn SHMEM_HUGE_NEVER;\n\tif (!strcmp(str, \"always\"))\n\t\treturn SHMEM_HUGE_ALWAYS;\n\tif (!strcmp(str, \"within_size\"))\n\t\treturn SHMEM_HUGE_WITHIN_SIZE;\n\tif (!strcmp(str, \"advise\"))\n\t\treturn SHMEM_HUGE_ADVISE;\n\tif (!strcmp(str, \"deny\"))\n\t\treturn SHMEM_HUGE_DENY;\n\tif (!strcmp(str, \"force\"))\n\t\treturn SHMEM_HUGE_FORCE;\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define SHMEM_HUGE_FORCE\t(-2)",
      "#define SHMEM_HUGE_DENY\t\t(-1)",
      "#define SHMEM_HUGE_ADVISE\t3",
      "#define SHMEM_HUGE_WITHIN_SIZE\t2",
      "#define SHMEM_HUGE_ALWAYS\t1",
      "#define SHMEM_HUGE_NEVER\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"force\""
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"deny\""
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"advise\""
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"within_size\""
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"always\""
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"never\""
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_ALWAYS\t1\n#define SHMEM_HUGE_NEVER\t0\n\nstatic int shmem_parse_huge(const char *str)\n{\n\tif (!strcmp(str, \"never\"))\n\t\treturn SHMEM_HUGE_NEVER;\n\tif (!strcmp(str, \"always\"))\n\t\treturn SHMEM_HUGE_ALWAYS;\n\tif (!strcmp(str, \"within_size\"))\n\t\treturn SHMEM_HUGE_WITHIN_SIZE;\n\tif (!strcmp(str, \"advise\"))\n\t\treturn SHMEM_HUGE_ADVISE;\n\tif (!strcmp(str, \"deny\"))\n\t\treturn SHMEM_HUGE_DENY;\n\tif (!strcmp(str, \"force\"))\n\t\treturn SHMEM_HUGE_FORCE;\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "shmem_confirm_swap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "349-353",
    "snippet": "static bool shmem_confirm_swap(struct address_space *mapping,\n\t\t\t       pgoff_t index, swp_entry_t swap)\n{\n\treturn xa_load(&mapping->i_pages, index) == swp_to_radix_entry(swap);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "swp_to_radix_entry",
          "args": [
            "swap"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_load",
          "args": [
            "&mapping->i_pages",
            "index"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic bool shmem_confirm_swap(struct address_space *mapping,\n\t\t\t       pgoff_t index, swp_entry_t swap)\n{\n\treturn xa_load(&mapping->i_pages, index) == swp_to_radix_entry(swap);\n}"
  },
  {
    "function_name": "shmem_replace_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "327-340",
    "snippet": "static int shmem_replace_entry(struct address_space *mapping,\n\t\t\tpgoff_t index, void *expected, void *replacement)\n{\n\tXA_STATE(xas, &mapping->i_pages, index);\n\tvoid *item;\n\n\tVM_BUG_ON(!expected);\n\tVM_BUG_ON(!replacement);\n\titem = xas_load(&xas);\n\tif (item != expected)\n\t\treturn -ENOENT;\n\txas_store(&xas, replacement);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xas_store",
          "args": [
            "&xas",
            "replacement"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xas_load",
          "args": [
            "&xas"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "!replacement"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "!expected"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XA_STATE",
          "args": [
            "xas",
            "&mapping->i_pages",
            "index"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_replace_entry(struct address_space *mapping,\n\t\t\tpgoff_t index, void *expected, void *replacement)\n{\n\tXA_STATE(xas, &mapping->i_pages, index);\n\tvoid *item;\n\n\tVM_BUG_ON(!expected);\n\tVM_BUG_ON(!replacement);\n\titem = xas_load(&xas);\n\tif (item != expected)\n\t\treturn -ENOENT;\n\txas_store(&xas, replacement);\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_uncharge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "310-322",
    "snippet": "void shmem_uncharge(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&info->lock, flags);\n\tinfo->alloced -= pages;\n\tinode->i_blocks -= pages * BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irqrestore(&info->lock, flags);\n\n\tshmem_inode_unacct_blocks(inode, pages);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_inode_unacct_blocks",
          "args": [
            "inode",
            "pages"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_inode_unacct_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "215-223",
          "snippet": "static inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&info->lock",
            "flags"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_recalc_inode",
          "args": [
            "inode"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_recalc_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "279-290",
          "snippet": "static void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&info->lock",
            "flags"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nvoid shmem_uncharge(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tunsigned long flags;\n\n\tspin_lock_irqsave(&info->lock, flags);\n\tinfo->alloced -= pages;\n\tinode->i_blocks -= pages * BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irqrestore(&info->lock, flags);\n\n\tshmem_inode_unacct_blocks(inode, pages);\n}"
  },
  {
    "function_name": "shmem_charge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "292-308",
    "snippet": "bool shmem_charge(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tunsigned long flags;\n\n\tif (!shmem_inode_acct_block(inode, pages))\n\t\treturn false;\n\n\tspin_lock_irqsave(&info->lock, flags);\n\tinfo->alloced += pages;\n\tinode->i_blocks += pages * BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irqrestore(&info->lock, flags);\n\tinode->i_mapping->nrpages += pages;\n\n\treturn true;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&info->lock",
            "flags"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_recalc_inode",
          "args": [
            "inode"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_recalc_inode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "279-290",
          "snippet": "static void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&info->lock",
            "flags"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_inode_acct_block",
          "args": [
            "inode",
            "pages"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_inode_acct_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "193-213",
          "snippet": "static inline bool shmem_inode_acct_block(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (shmem_acct_block(info->flags, pages))\n\t\treturn false;\n\n\tif (sbinfo->max_blocks) {\n\t\tif (percpu_counter_compare(&sbinfo->used_blocks,\n\t\t\t\t\t   sbinfo->max_blocks - pages) > 0)\n\t\t\tgoto unacct;\n\t\tpercpu_counter_add(&sbinfo->used_blocks, pages);\n\t}\n\n\treturn true;\n\nunacct:\n\tshmem_unacct_blocks(info->flags, pages);\n\treturn false;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline bool shmem_inode_acct_block(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (shmem_acct_block(info->flags, pages))\n\t\treturn false;\n\n\tif (sbinfo->max_blocks) {\n\t\tif (percpu_counter_compare(&sbinfo->used_blocks,\n\t\t\t\t\t   sbinfo->max_blocks - pages) > 0)\n\t\t\tgoto unacct;\n\t\tpercpu_counter_add(&sbinfo->used_blocks, pages);\n\t}\n\n\treturn true;\n\nunacct:\n\tshmem_unacct_blocks(info->flags, pages);\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nbool shmem_charge(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tunsigned long flags;\n\n\tif (!shmem_inode_acct_block(inode, pages))\n\t\treturn false;\n\n\tspin_lock_irqsave(&info->lock, flags);\n\tinfo->alloced += pages;\n\tinode->i_blocks += pages * BLOCKS_PER_PAGE;\n\tshmem_recalc_inode(inode);\n\tspin_unlock_irqrestore(&info->lock, flags);\n\tinode->i_mapping->nrpages += pages;\n\n\treturn true;\n}"
  },
  {
    "function_name": "shmem_recalc_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "279-290",
    "snippet": "static void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_inode_unacct_blocks",
          "args": [
            "inode",
            "freed"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_inode_unacct_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "215-223",
          "snippet": "static inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic void shmem_recalc_inode(struct inode *inode)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tlong freed;\n\n\tfreed = info->alloced - info->swapped - inode->i_mapping->nrpages;\n\tif (freed > 0) {\n\t\tinfo->alloced -= freed;\n\t\tinode->i_blocks -= freed * BLOCKS_PER_PAGE;\n\t\tshmem_inode_unacct_blocks(inode, freed);\n\t}\n}"
  },
  {
    "function_name": "shmem_free_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "257-265",
    "snippet": "static void shmem_free_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tsbinfo->free_inodes++;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "sb"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic void shmem_free_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tsbinfo->free_inodes++;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n}"
  },
  {
    "function_name": "shmem_reserve_inode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "242-255",
    "snippet": "static int shmem_reserve_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tif (!sbinfo->free_inodes) {\n\t\t\tspin_unlock(&sbinfo->stat_lock);\n\t\t\treturn -ENOSPC;\n\t\t}\n\t\tsbinfo->free_inodes--;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&sbinfo->stat_lock"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "sb"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic int shmem_reserve_inode(struct super_block *sb)\n{\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(sb);\n\tif (sbinfo->max_inodes) {\n\t\tspin_lock(&sbinfo->stat_lock);\n\t\tif (!sbinfo->free_inodes) {\n\t\t\tspin_unlock(&sbinfo->stat_lock);\n\t\t\treturn -ENOSPC;\n\t\t}\n\t\tsbinfo->free_inodes--;\n\t\tspin_unlock(&sbinfo->stat_lock);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "vma_is_shmem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "234-237",
    "snippet": "bool vma_is_shmem(struct vm_area_struct *vma)\n{\n\treturn vma->vm_ops == &shmem_vm_ops;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [
      "#define shmem_vm_ops\t\t\t\tgeneric_file_vm_ops"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_vm_ops\t\t\t\tgeneric_file_vm_ops\n\nbool vma_is_shmem(struct vm_area_struct *vma)\n{\n\treturn vma->vm_ops == &shmem_vm_ops;\n}"
  },
  {
    "function_name": "shmem_inode_unacct_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "215-223",
    "snippet": "static inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_unacct_blocks",
          "args": [
            "info->flags",
            "pages"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unacct_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "187-191",
          "snippet": "static inline void shmem_unacct_blocks(unsigned long flags, long pages)\n{\n\tif (flags & VM_NORESERVE)\n\t\tvm_unacct_memory(pages * VM_ACCT(PAGE_SIZE));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_unacct_blocks(unsigned long flags, long pages)\n{\n\tif (flags & VM_NORESERVE)\n\t\tvm_unacct_memory(pages * VM_ACCT(PAGE_SIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_counter_sub",
          "args": [
            "&sbinfo->used_blocks",
            "pages"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_inode_unacct_blocks(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (sbinfo->max_blocks)\n\t\tpercpu_counter_sub(&sbinfo->used_blocks, pages);\n\tshmem_unacct_blocks(info->flags, pages);\n}"
  },
  {
    "function_name": "shmem_inode_acct_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "193-213",
    "snippet": "static inline bool shmem_inode_acct_block(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (shmem_acct_block(info->flags, pages))\n\t\treturn false;\n\n\tif (sbinfo->max_blocks) {\n\t\tif (percpu_counter_compare(&sbinfo->used_blocks,\n\t\t\t\t\t   sbinfo->max_blocks - pages) > 0)\n\t\t\tgoto unacct;\n\t\tpercpu_counter_add(&sbinfo->used_blocks, pages);\n\t}\n\n\treturn true;\n\nunacct:\n\tshmem_unacct_blocks(info->flags, pages);\n\treturn false;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_unacct_blocks",
          "args": [
            "info->flags",
            "pages"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_unacct_blocks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "187-191",
          "snippet": "static inline void shmem_unacct_blocks(unsigned long flags, long pages)\n{\n\tif (flags & VM_NORESERVE)\n\t\tvm_unacct_memory(pages * VM_ACCT(PAGE_SIZE));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_unacct_blocks(unsigned long flags, long pages)\n{\n\tif (flags & VM_NORESERVE)\n\t\tvm_unacct_memory(pages * VM_ACCT(PAGE_SIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_counter_add",
          "args": [
            "&sbinfo->used_blocks",
            "pages"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_compare",
          "args": [
            "&sbinfo->used_blocks",
            "sbinfo->max_blocks - pages"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shmem_acct_block",
          "args": [
            "info->flags",
            "pages"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_acct_block",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "178-185",
          "snippet": "static inline int shmem_acct_block(unsigned long flags, long pages)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\treturn 0;\n\n\treturn security_vm_enough_memory_mm(current->mm,\n\t\t\tpages * VM_ACCT(PAGE_SIZE));\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline int shmem_acct_block(unsigned long flags, long pages)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\treturn 0;\n\n\treturn security_vm_enough_memory_mm(current->mm,\n\t\t\tpages * VM_ACCT(PAGE_SIZE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_SB",
          "args": [
            "inode->i_sb"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "SHMEM_SB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "136-139",
          "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHMEM_I",
          "args": [
            "inode"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline bool shmem_inode_acct_block(struct inode *inode, long pages)\n{\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo = SHMEM_SB(inode->i_sb);\n\n\tif (shmem_acct_block(info->flags, pages))\n\t\treturn false;\n\n\tif (sbinfo->max_blocks) {\n\t\tif (percpu_counter_compare(&sbinfo->used_blocks,\n\t\t\t\t\t   sbinfo->max_blocks - pages) > 0)\n\t\t\tgoto unacct;\n\t\tpercpu_counter_add(&sbinfo->used_blocks, pages);\n\t}\n\n\treturn true;\n\nunacct:\n\tshmem_unacct_blocks(info->flags, pages);\n\treturn false;\n}"
  },
  {
    "function_name": "shmem_unacct_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "187-191",
    "snippet": "static inline void shmem_unacct_blocks(unsigned long flags, long pages)\n{\n\tif (flags & VM_NORESERVE)\n\t\tvm_unacct_memory(pages * VM_ACCT(PAGE_SIZE));\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vm_unacct_memory",
          "args": [
            "pages * VM_ACCT(PAGE_SIZE)"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "PAGE_SIZE"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_unacct_blocks(unsigned long flags, long pages)\n{\n\tif (flags & VM_NORESERVE)\n\t\tvm_unacct_memory(pages * VM_ACCT(PAGE_SIZE));\n}"
  },
  {
    "function_name": "shmem_acct_block",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "178-185",
    "snippet": "static inline int shmem_acct_block(unsigned long flags, long pages)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\treturn 0;\n\n\treturn security_vm_enough_memory_mm(current->mm,\n\t\t\tpages * VM_ACCT(PAGE_SIZE));\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "security_vm_enough_memory_mm",
          "args": [
            "current->mm",
            "pages * VM_ACCT(PAGE_SIZE)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "PAGE_SIZE"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline int shmem_acct_block(unsigned long flags, long pages)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\treturn 0;\n\n\treturn security_vm_enough_memory_mm(current->mm,\n\t\t\tpages * VM_ACCT(PAGE_SIZE));\n}"
  },
  {
    "function_name": "shmem_reacct_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "159-170",
    "snippet": "static inline int shmem_reacct_size(unsigned long flags,\n\t\tloff_t oldsize, loff_t newsize)\n{\n\tif (!(flags & VM_NORESERVE)) {\n\t\tif (VM_ACCT(newsize) > VM_ACCT(oldsize))\n\t\t\treturn security_vm_enough_memory_mm(current->mm,\n\t\t\t\t\tVM_ACCT(newsize) - VM_ACCT(oldsize));\n\t\telse if (VM_ACCT(newsize) < VM_ACCT(oldsize))\n\t\t\tvm_unacct_memory(VM_ACCT(oldsize) - VM_ACCT(newsize));\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vm_unacct_memory",
          "args": [
            "VM_ACCT(oldsize) - VM_ACCT(newsize)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "newsize"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "oldsize"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "oldsize"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "newsize"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "security_vm_enough_memory_mm",
          "args": [
            "current->mm",
            "VM_ACCT(newsize) - VM_ACCT(oldsize)"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "oldsize"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "newsize"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "oldsize"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "newsize"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline int shmem_reacct_size(unsigned long flags,\n\t\tloff_t oldsize, loff_t newsize)\n{\n\tif (!(flags & VM_NORESERVE)) {\n\t\tif (VM_ACCT(newsize) > VM_ACCT(oldsize))\n\t\t\treturn security_vm_enough_memory_mm(current->mm,\n\t\t\t\t\tVM_ACCT(newsize) - VM_ACCT(oldsize));\n\t\telse if (VM_ACCT(newsize) < VM_ACCT(oldsize))\n\t\t\tvm_unacct_memory(VM_ACCT(oldsize) - VM_ACCT(newsize));\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "shmem_unacct_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "153-157",
    "snippet": "static inline void shmem_unacct_size(unsigned long flags, loff_t size)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\tvm_unacct_memory(VM_ACCT(size));\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vm_unacct_memory",
          "args": [
            "VM_ACCT(size)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "size"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline void shmem_unacct_size(unsigned long flags, loff_t size)\n{\n\tif (!(flags & VM_NORESERVE))\n\t\tvm_unacct_memory(VM_ACCT(size));\n}"
  },
  {
    "function_name": "shmem_acct_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "147-151",
    "snippet": "static inline int shmem_acct_size(unsigned long flags, loff_t size)\n{\n\treturn (flags & VM_NORESERVE) ?\n\t\t0 : security_vm_enough_memory_mm(current->mm, VM_ACCT(size));\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "security_vm_enough_memory_mm",
          "args": [
            "current->mm",
            "VM_ACCT(size)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_ACCT",
          "args": [
            "size"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline int shmem_acct_size(unsigned long flags, loff_t size)\n{\n\treturn (flags & VM_NORESERVE) ?\n\t\t0 : security_vm_enough_memory_mm(current->mm, VM_ACCT(size));\n}"
  },
  {
    "function_name": "SHMEM_SB",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "136-139",
    "snippet": "static inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic inline struct shmem_sb_info *SHMEM_SB(struct super_block *sb)\n{\n\treturn sb->s_fs_info;\n}"
  },
  {
    "function_name": "shmem_getpage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "129-134",
    "snippet": "int shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "shmem_getpage_gfp",
          "args": [
            "inode",
            "index",
            "pagep",
            "sgp",
            "mapping_gfp_mask(inode->i_mapping)",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "shmem_getpage_gfp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
          "lines": "1584-1895",
          "snippet": "static int shmem_getpage_gfp(struct inode *inode, pgoff_t index,\n\tstruct page **pagep, enum sgp_type sgp, gfp_t gfp,\n\tstruct vm_area_struct *vma, struct vm_fault *vmf,\n\t\t\tvm_fault_t *fault_type)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo;\n\tstruct mm_struct *charge_mm;\n\tstruct mem_cgroup *memcg;\n\tstruct page *page;\n\tswp_entry_t swap;\n\tenum sgp_type sgp_huge = sgp;\n\tpgoff_t hindex = index;\n\tint error;\n\tint once = 0;\n\tint alloced = 0;\n\n\tif (index > (MAX_LFS_FILESIZE >> PAGE_SHIFT))\n\t\treturn -EFBIG;\n\tif (sgp == SGP_NOHUGE || sgp == SGP_HUGE)\n\t\tsgp = SGP_CACHE;\nrepeat:\n\tswap.val = 0;\n\tpage = find_lock_entry(mapping, index);\n\tif (xa_is_value(page)) {\n\t\tswap = radix_to_swp_entry(page);\n\t\tpage = NULL;\n\t}\n\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\n\tif (page && sgp == SGP_WRITE)\n\t\tmark_page_accessed(page);\n\n\t/* fallocated page? */\n\tif (page && !PageUptodate(page)) {\n\t\tif (sgp != SGP_READ)\n\t\t\tgoto clear;\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tpage = NULL;\n\t}\n\tif (page || (sgp == SGP_READ && !swap.val)) {\n\t\t*pagep = page;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Fast cache lookup did not find it:\n\t * bring it back from swap or allocate.\n\t */\n\tsbinfo = SHMEM_SB(inode->i_sb);\n\tcharge_mm = vma ? vma->vm_mm : current->mm;\n\n\tif (swap.val) {\n\t\t/* Look it up and read it in.. */\n\t\tpage = lookup_swap_cache(swap, NULL, 0);\n\t\tif (!page) {\n\t\t\t/* Or update major stats only when swapin succeeds?? */\n\t\t\tif (fault_type) {\n\t\t\t\t*fault_type |= VM_FAULT_MAJOR;\n\t\t\t\tcount_vm_event(PGMAJFAULT);\n\t\t\t\tcount_memcg_event_mm(charge_mm, PGMAJFAULT);\n\t\t\t}\n\t\t\t/* Here we actually start the io */\n\t\t\tpage = shmem_swapin(swap, gfp, info, index);\n\t\t\tif (!page) {\n\t\t\t\terror = -ENOMEM;\n\t\t\t\tgoto failed;\n\t\t\t}\n\t\t}\n\n\t\t/* We have to do this with page locked to prevent races */\n\t\tlock_page(page);\n\t\tif (!PageSwapCache(page) || page_private(page) != swap.val ||\n\t\t    !shmem_confirm_swap(mapping, index, swap)) {\n\t\t\terror = -EEXIST;\t/* try again */\n\t\t\tgoto unlock;\n\t\t}\n\t\tif (!PageUptodate(page)) {\n\t\t\terror = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t\twait_on_page_writeback(page);\n\n\t\tif (shmem_should_replace_page(page, gfp)) {\n\t\t\terror = shmem_replace_page(&page, gfp, info, index);\n\t\t\tif (error)\n\t\t\t\tgoto failed;\n\t\t}\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tfalse);\n\t\tif (!error) {\n\t\t\terror = shmem_add_to_page_cache(page, mapping, index,\n\t\t\t\t\t\tswp_to_radix_entry(swap), gfp);\n\t\t\t/*\n\t\t\t * We already confirmed swap under page lock, and make\n\t\t\t * no memory allocation here, so usually no possibility\n\t\t\t * of error; but free_swap_and_cache() only trylocks a\n\t\t\t * page, so it is just possible that the entry has been\n\t\t\t * truncated or holepunched since swap was confirmed.\n\t\t\t * shmem_undo_range() will have done some of the\n\t\t\t * unaccounting, now delete_from_swap_cache() will do\n\t\t\t * the rest.\n\t\t\t * Reset swap.val? No, leave it so \"failed\" goes back to\n\t\t\t * \"repeat\": reading a hole and writing should succeed.\n\t\t\t */\n\t\t\tif (error) {\n\t\t\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t\t\t\tdelete_from_swap_cache(page);\n\t\t\t}\n\t\t}\n\t\tif (error)\n\t\t\tgoto failed;\n\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->swapped--;\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\tmark_page_accessed(page);\n\n\t\tdelete_from_swap_cache(page);\n\t\tset_page_dirty(page);\n\t\tswap_free(swap);\n\n\t} else {\n\t\tif (vma && userfaultfd_missing(vma)) {\n\t\t\t*fault_type = handle_userfault(vmf, VM_UFFD_MISSING);\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* shmem_symlink() */\n\t\tif (mapping->a_ops != &shmem_aops)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_DENY || sgp_huge == SGP_NOHUGE)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\t\tgoto alloc_huge;\n\t\tswitch (sbinfo->huge) {\n\t\t\tloff_t i_size;\n\t\t\tpgoff_t off;\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\tgoto alloc_nohuge;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(index, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* fallthrough */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\tif (sgp_huge == SGP_HUGE)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\tgoto alloc_nohuge;\n\t\t}\n\nalloc_huge:\n\t\tpage = shmem_alloc_and_acct_page(gfp, inode, index, true);\n\t\tif (IS_ERR(page)) {\nalloc_nohuge:\t\tpage = shmem_alloc_and_acct_page(gfp, inode,\n\t\t\t\t\tindex, false);\n\t\t}\n\t\tif (IS_ERR(page)) {\n\t\t\tint retry = 5;\n\t\t\terror = PTR_ERR(page);\n\t\t\tpage = NULL;\n\t\t\tif (error != -ENOSPC)\n\t\t\t\tgoto failed;\n\t\t\t/*\n\t\t\t * Try to reclaim some spece by splitting a huge page\n\t\t\t * beyond i_size on the filesystem.\n\t\t\t */\n\t\t\twhile (retry--) {\n\t\t\t\tint ret;\n\t\t\t\tret = shmem_unused_huge_shrink(sbinfo, NULL, 1);\n\t\t\t\tif (ret == SHRINK_STOP)\n\t\t\t\t\tbreak;\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto alloc_nohuge;\n\t\t\t}\n\t\t\tgoto failed;\n\t\t}\n\n\t\tif (PageTransHuge(page))\n\t\t\thindex = round_down(index, HPAGE_PMD_NR);\n\t\telse\n\t\t\thindex = index;\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\t__SetPageReferenced(page);\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tPageTransHuge(page));\n\t\tif (error)\n\t\t\tgoto unacct;\n\t\terror = shmem_add_to_page_cache(page, mapping, hindex,\n\t\t\t\t\t\tNULL, gfp & GFP_RECLAIM_MASK);\n\t\tif (error) {\n\t\t\tmem_cgroup_cancel_charge(page, memcg,\n\t\t\t\t\tPageTransHuge(page));\n\t\t\tgoto unacct;\n\t\t}\n\t\tmem_cgroup_commit_charge(page, memcg, false,\n\t\t\t\tPageTransHuge(page));\n\t\tlru_cache_add_anon(page);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->alloced += 1 << compound_order(page);\n\t\tinode->i_blocks += BLOCKS_PER_PAGE << compound_order(page);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\talloced = true;\n\n\t\tif (PageTransHuge(page) &&\n\t\t\t\tDIV_ROUND_UP(i_size_read(inode), PAGE_SIZE) <\n\t\t\t\thindex + HPAGE_PMD_NR - 1) {\n\t\t\t/*\n\t\t\t * Part of the huge page is beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t/*\n\t\t\t * _careful to defend against unlocked access to\n\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t */\n\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\n\t\t/*\n\t\t * Let SGP_FALLOC use the SGP_WRITE optimization on a new page.\n\t\t */\n\t\tif (sgp == SGP_FALLOC)\n\t\t\tsgp = SGP_WRITE;\nclear:\n\t\t/*\n\t\t * Let SGP_WRITE caller clear ends if write does not fill page;\n\t\t * but SGP_FALLOC on a page fallocated earlier must initialize\n\t\t * it now, lest undo on failure cancel our earlier guarantee.\n\t\t */\n\t\tif (sgp != SGP_WRITE && !PageUptodate(page)) {\n\t\t\tstruct page *head = compound_head(page);\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < (1 << compound_order(head)); i++) {\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t\tSetPageUptodate(head);\n\t\t}\n\t}\n\n\t/* Perhaps the file has been truncated since we checked */\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\tif (alloced) {\n\t\t\tClearPageDirty(page);\n\t\t\tdelete_from_page_cache(page);\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tshmem_recalc_inode(inode);\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t}\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\t*pagep = page + index - hindex;\n\treturn 0;\n\n\t/*\n\t * Error recovery.\n\t */\nunacct:\n\tshmem_inode_unacct_blocks(inode, 1 << compound_order(page));\n\n\tif (PageTransHuge(page)) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tgoto alloc_nohuge;\n\t}\nfailed:\n\tif (swap.val && !shmem_confirm_swap(mapping, index, swap))\n\t\terror = -EEXIST;\nunlock:\n\tif (page) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tif (error == -ENOSPC && !once++) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\tgoto repeat;\n\t}\n\tif (error == -EEXIST)\n\t\tgoto repeat;\n\treturn error;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/uuid.h>",
            "#include <linux/rmap.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <uapi/linux/memfd.h>",
            "#include <linux/fcntl.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/magic.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/highmem.h>",
            "#include <linux/migrate.h>",
            "#include <linux/ctype.h>",
            "#include <linux/namei.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/swapops.h>",
            "#include <linux/security.h>",
            "#include <linux/splice.h>",
            "#include <linux/falloc.h>",
            "#include <linux/percpu_counter.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/mman.h>",
            "#include <linux/posix_acl_xattr.h>",
            "#include <linux/posix_acl.h>",
            "#include <linux/exportfs.h>",
            "#include <linux/xattr.h>",
            "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
            "#include <linux/hugetlb.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/uio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/random.h>",
            "#include <linux/mm.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/ramfs.h>",
            "#include <linux/mount.h>",
            "#include <linux/vfs.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [
            "#define shmem_huge SHMEM_HUGE_DENY",
            "#define SHMEM_HUGE_FORCE\t(-2)",
            "#define SHMEM_HUGE_DENY\t\t(-1)",
            "#define SHMEM_HUGE_ADVISE\t3",
            "#define SHMEM_HUGE_WITHIN_SIZE\t2",
            "#define SHMEM_HUGE_NEVER\t0",
            "#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\n#define shmem_huge SHMEM_HUGE_DENY\n#define SHMEM_HUGE_FORCE\t(-2)\n#define SHMEM_HUGE_DENY\t\t(-1)\n#define SHMEM_HUGE_ADVISE\t3\n#define SHMEM_HUGE_WITHIN_SIZE\t2\n#define SHMEM_HUGE_NEVER\t0\n#define BLOCKS_PER_PAGE  (PAGE_SIZE/512)\n\nstatic int shmem_getpage_gfp(struct inode *inode, pgoff_t index,\n\tstruct page **pagep, enum sgp_type sgp, gfp_t gfp,\n\tstruct vm_area_struct *vma, struct vm_fault *vmf,\n\t\t\tvm_fault_t *fault_type)\n{\n\tstruct address_space *mapping = inode->i_mapping;\n\tstruct shmem_inode_info *info = SHMEM_I(inode);\n\tstruct shmem_sb_info *sbinfo;\n\tstruct mm_struct *charge_mm;\n\tstruct mem_cgroup *memcg;\n\tstruct page *page;\n\tswp_entry_t swap;\n\tenum sgp_type sgp_huge = sgp;\n\tpgoff_t hindex = index;\n\tint error;\n\tint once = 0;\n\tint alloced = 0;\n\n\tif (index > (MAX_LFS_FILESIZE >> PAGE_SHIFT))\n\t\treturn -EFBIG;\n\tif (sgp == SGP_NOHUGE || sgp == SGP_HUGE)\n\t\tsgp = SGP_CACHE;\nrepeat:\n\tswap.val = 0;\n\tpage = find_lock_entry(mapping, index);\n\tif (xa_is_value(page)) {\n\t\tswap = radix_to_swp_entry(page);\n\t\tpage = NULL;\n\t}\n\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\n\tif (page && sgp == SGP_WRITE)\n\t\tmark_page_accessed(page);\n\n\t/* fallocated page? */\n\tif (page && !PageUptodate(page)) {\n\t\tif (sgp != SGP_READ)\n\t\t\tgoto clear;\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tpage = NULL;\n\t}\n\tif (page || (sgp == SGP_READ && !swap.val)) {\n\t\t*pagep = page;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Fast cache lookup did not find it:\n\t * bring it back from swap or allocate.\n\t */\n\tsbinfo = SHMEM_SB(inode->i_sb);\n\tcharge_mm = vma ? vma->vm_mm : current->mm;\n\n\tif (swap.val) {\n\t\t/* Look it up and read it in.. */\n\t\tpage = lookup_swap_cache(swap, NULL, 0);\n\t\tif (!page) {\n\t\t\t/* Or update major stats only when swapin succeeds?? */\n\t\t\tif (fault_type) {\n\t\t\t\t*fault_type |= VM_FAULT_MAJOR;\n\t\t\t\tcount_vm_event(PGMAJFAULT);\n\t\t\t\tcount_memcg_event_mm(charge_mm, PGMAJFAULT);\n\t\t\t}\n\t\t\t/* Here we actually start the io */\n\t\t\tpage = shmem_swapin(swap, gfp, info, index);\n\t\t\tif (!page) {\n\t\t\t\terror = -ENOMEM;\n\t\t\t\tgoto failed;\n\t\t\t}\n\t\t}\n\n\t\t/* We have to do this with page locked to prevent races */\n\t\tlock_page(page);\n\t\tif (!PageSwapCache(page) || page_private(page) != swap.val ||\n\t\t    !shmem_confirm_swap(mapping, index, swap)) {\n\t\t\terror = -EEXIST;\t/* try again */\n\t\t\tgoto unlock;\n\t\t}\n\t\tif (!PageUptodate(page)) {\n\t\t\terror = -EIO;\n\t\t\tgoto failed;\n\t\t}\n\t\twait_on_page_writeback(page);\n\n\t\tif (shmem_should_replace_page(page, gfp)) {\n\t\t\terror = shmem_replace_page(&page, gfp, info, index);\n\t\t\tif (error)\n\t\t\t\tgoto failed;\n\t\t}\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tfalse);\n\t\tif (!error) {\n\t\t\terror = shmem_add_to_page_cache(page, mapping, index,\n\t\t\t\t\t\tswp_to_radix_entry(swap), gfp);\n\t\t\t/*\n\t\t\t * We already confirmed swap under page lock, and make\n\t\t\t * no memory allocation here, so usually no possibility\n\t\t\t * of error; but free_swap_and_cache() only trylocks a\n\t\t\t * page, so it is just possible that the entry has been\n\t\t\t * truncated or holepunched since swap was confirmed.\n\t\t\t * shmem_undo_range() will have done some of the\n\t\t\t * unaccounting, now delete_from_swap_cache() will do\n\t\t\t * the rest.\n\t\t\t * Reset swap.val? No, leave it so \"failed\" goes back to\n\t\t\t * \"repeat\": reading a hole and writing should succeed.\n\t\t\t */\n\t\t\tif (error) {\n\t\t\t\tmem_cgroup_cancel_charge(page, memcg, false);\n\t\t\t\tdelete_from_swap_cache(page);\n\t\t\t}\n\t\t}\n\t\tif (error)\n\t\t\tgoto failed;\n\n\t\tmem_cgroup_commit_charge(page, memcg, true, false);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->swapped--;\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\tmark_page_accessed(page);\n\n\t\tdelete_from_swap_cache(page);\n\t\tset_page_dirty(page);\n\t\tswap_free(swap);\n\n\t} else {\n\t\tif (vma && userfaultfd_missing(vma)) {\n\t\t\t*fault_type = handle_userfault(vmf, VM_UFFD_MISSING);\n\t\t\treturn 0;\n\t\t}\n\n\t\t/* shmem_symlink() */\n\t\tif (mapping->a_ops != &shmem_aops)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_DENY || sgp_huge == SGP_NOHUGE)\n\t\t\tgoto alloc_nohuge;\n\t\tif (shmem_huge == SHMEM_HUGE_FORCE)\n\t\t\tgoto alloc_huge;\n\t\tswitch (sbinfo->huge) {\n\t\t\tloff_t i_size;\n\t\t\tpgoff_t off;\n\t\tcase SHMEM_HUGE_NEVER:\n\t\t\tgoto alloc_nohuge;\n\t\tcase SHMEM_HUGE_WITHIN_SIZE:\n\t\t\toff = round_up(index, HPAGE_PMD_NR);\n\t\t\ti_size = round_up(i_size_read(inode), PAGE_SIZE);\n\t\t\tif (i_size >= HPAGE_PMD_SIZE &&\n\t\t\t\t\ti_size >> PAGE_SHIFT >= off)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* fallthrough */\n\t\tcase SHMEM_HUGE_ADVISE:\n\t\t\tif (sgp_huge == SGP_HUGE)\n\t\t\t\tgoto alloc_huge;\n\t\t\t/* TODO: implement fadvise() hints */\n\t\t\tgoto alloc_nohuge;\n\t\t}\n\nalloc_huge:\n\t\tpage = shmem_alloc_and_acct_page(gfp, inode, index, true);\n\t\tif (IS_ERR(page)) {\nalloc_nohuge:\t\tpage = shmem_alloc_and_acct_page(gfp, inode,\n\t\t\t\t\tindex, false);\n\t\t}\n\t\tif (IS_ERR(page)) {\n\t\t\tint retry = 5;\n\t\t\terror = PTR_ERR(page);\n\t\t\tpage = NULL;\n\t\t\tif (error != -ENOSPC)\n\t\t\t\tgoto failed;\n\t\t\t/*\n\t\t\t * Try to reclaim some spece by splitting a huge page\n\t\t\t * beyond i_size on the filesystem.\n\t\t\t */\n\t\t\twhile (retry--) {\n\t\t\t\tint ret;\n\t\t\t\tret = shmem_unused_huge_shrink(sbinfo, NULL, 1);\n\t\t\t\tif (ret == SHRINK_STOP)\n\t\t\t\t\tbreak;\n\t\t\t\tif (ret)\n\t\t\t\t\tgoto alloc_nohuge;\n\t\t\t}\n\t\t\tgoto failed;\n\t\t}\n\n\t\tif (PageTransHuge(page))\n\t\t\thindex = round_down(index, HPAGE_PMD_NR);\n\t\telse\n\t\t\thindex = index;\n\n\t\tif (sgp == SGP_WRITE)\n\t\t\t__SetPageReferenced(page);\n\n\t\terror = mem_cgroup_try_charge_delay(page, charge_mm, gfp, &memcg,\n\t\t\t\tPageTransHuge(page));\n\t\tif (error)\n\t\t\tgoto unacct;\n\t\terror = shmem_add_to_page_cache(page, mapping, hindex,\n\t\t\t\t\t\tNULL, gfp & GFP_RECLAIM_MASK);\n\t\tif (error) {\n\t\t\tmem_cgroup_cancel_charge(page, memcg,\n\t\t\t\t\tPageTransHuge(page));\n\t\t\tgoto unacct;\n\t\t}\n\t\tmem_cgroup_commit_charge(page, memcg, false,\n\t\t\t\tPageTransHuge(page));\n\t\tlru_cache_add_anon(page);\n\n\t\tspin_lock_irq(&info->lock);\n\t\tinfo->alloced += 1 << compound_order(page);\n\t\tinode->i_blocks += BLOCKS_PER_PAGE << compound_order(page);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\talloced = true;\n\n\t\tif (PageTransHuge(page) &&\n\t\t\t\tDIV_ROUND_UP(i_size_read(inode), PAGE_SIZE) <\n\t\t\t\thindex + HPAGE_PMD_NR - 1) {\n\t\t\t/*\n\t\t\t * Part of the huge page is beyond i_size: subject\n\t\t\t * to shrink under memory pressure.\n\t\t\t */\n\t\t\tspin_lock(&sbinfo->shrinklist_lock);\n\t\t\t/*\n\t\t\t * _careful to defend against unlocked access to\n\t\t\t * ->shrink_list in shmem_unused_huge_shrink()\n\t\t\t */\n\t\t\tif (list_empty_careful(&info->shrinklist)) {\n\t\t\t\tlist_add_tail(&info->shrinklist,\n\t\t\t\t\t\t&sbinfo->shrinklist);\n\t\t\t\tsbinfo->shrinklist_len++;\n\t\t\t}\n\t\t\tspin_unlock(&sbinfo->shrinklist_lock);\n\t\t}\n\n\t\t/*\n\t\t * Let SGP_FALLOC use the SGP_WRITE optimization on a new page.\n\t\t */\n\t\tif (sgp == SGP_FALLOC)\n\t\t\tsgp = SGP_WRITE;\nclear:\n\t\t/*\n\t\t * Let SGP_WRITE caller clear ends if write does not fill page;\n\t\t * but SGP_FALLOC on a page fallocated earlier must initialize\n\t\t * it now, lest undo on failure cancel our earlier guarantee.\n\t\t */\n\t\tif (sgp != SGP_WRITE && !PageUptodate(page)) {\n\t\t\tstruct page *head = compound_head(page);\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < (1 << compound_order(head)); i++) {\n\t\t\t\tclear_highpage(head + i);\n\t\t\t\tflush_dcache_page(head + i);\n\t\t\t}\n\t\t\tSetPageUptodate(head);\n\t\t}\n\t}\n\n\t/* Perhaps the file has been truncated since we checked */\n\tif (sgp <= SGP_CACHE &&\n\t    ((loff_t)index << PAGE_SHIFT) >= i_size_read(inode)) {\n\t\tif (alloced) {\n\t\t\tClearPageDirty(page);\n\t\t\tdelete_from_page_cache(page);\n\t\t\tspin_lock_irq(&info->lock);\n\t\t\tshmem_recalc_inode(inode);\n\t\t\tspin_unlock_irq(&info->lock);\n\t\t}\n\t\terror = -EINVAL;\n\t\tgoto unlock;\n\t}\n\t*pagep = page + index - hindex;\n\treturn 0;\n\n\t/*\n\t * Error recovery.\n\t */\nunacct:\n\tshmem_inode_unacct_blocks(inode, 1 << compound_order(page));\n\n\tif (PageTransHuge(page)) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t\tgoto alloc_nohuge;\n\t}\nfailed:\n\tif (swap.val && !shmem_confirm_swap(mapping, index, swap))\n\t\terror = -EEXIST;\nunlock:\n\tif (page) {\n\t\tunlock_page(page);\n\t\tput_page(page);\n\t}\n\tif (error == -ENOSPC && !once++) {\n\t\tspin_lock_irq(&info->lock);\n\t\tshmem_recalc_inode(inode);\n\t\tspin_unlock_irq(&info->lock);\n\t\tgoto repeat;\n\t}\n\tif (error == -EEXIST)\n\t\tgoto repeat;\n\treturn error;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapping_gfp_mask",
          "args": [
            "inode->i_mapping"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nint shmem_getpage(struct inode *inode, pgoff_t index,\n\t\tstruct page **pagep, enum sgp_type sgp)\n{\n\treturn shmem_getpage_gfp(inode, index, pagep, sgp,\n\t\tmapping_gfp_mask(inode->i_mapping), NULL, NULL, NULL);\n}"
  },
  {
    "function_name": "shmem_default_max_inodes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "115-118",
    "snippet": "static unsigned long shmem_default_max_inodes(void)\n{\n\treturn min(totalram_pages - totalhigh_pages, totalram_pages / 2);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "min",
          "args": [
            "totalram_pages - totalhigh_pages",
            "totalram_pages / 2"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "si_meminfo_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "4761-4790",
          "snippet": "void si_meminfo_node(struct sysinfo *val, int nid)\n{\n\tint zone_type;\t\t/* needs to be signed */\n\tunsigned long managed_pages = 0;\n\tunsigned long managed_highpages = 0;\n\tunsigned long free_highpages = 0;\n\tpg_data_t *pgdat = NODE_DATA(nid);\n\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++)\n\t\tmanaged_pages += pgdat->node_zones[zone_type].managed_pages;\n\tval->totalram = managed_pages;\n\tval->sharedram = node_page_state(pgdat, NR_SHMEM);\n\tval->freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);\n#ifdef CONFIG_HIGHMEM\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++) {\n\t\tstruct zone *zone = &pgdat->node_zones[zone_type];\n\n\t\tif (is_highmem(zone)) {\n\t\t\tmanaged_highpages += zone->managed_pages;\n\t\t\tfree_highpages += zone_page_state(zone, NR_FREE_PAGES);\n\t\t}\n\t}\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#else\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#endif\n\tval->mem_unit = PAGE_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nvoid si_meminfo_node(struct sysinfo *val, int nid)\n{\n\tint zone_type;\t\t/* needs to be signed */\n\tunsigned long managed_pages = 0;\n\tunsigned long managed_highpages = 0;\n\tunsigned long free_highpages = 0;\n\tpg_data_t *pgdat = NODE_DATA(nid);\n\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++)\n\t\tmanaged_pages += pgdat->node_zones[zone_type].managed_pages;\n\tval->totalram = managed_pages;\n\tval->sharedram = node_page_state(pgdat, NR_SHMEM);\n\tval->freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);\n#ifdef CONFIG_HIGHMEM\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++) {\n\t\tstruct zone *zone = &pgdat->node_zones[zone_type];\n\n\t\tif (is_highmem(zone)) {\n\t\t\tmanaged_highpages += zone->managed_pages;\n\t\t\tfree_highpages += zone_page_state(zone, NR_FREE_PAGES);\n\t\t}\n\t}\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#else\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#endif\n\tval->mem_unit = PAGE_SIZE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_default_max_inodes(void)\n{\n\treturn min(totalram_pages - totalhigh_pages, totalram_pages / 2);\n}"
  },
  {
    "function_name": "shmem_default_max_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/shmem.c",
    "lines": "110-113",
    "snippet": "static unsigned long shmem_default_max_blocks(void)\n{\n\treturn totalram_pages / 2;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include <asm/pgtable.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/uuid.h>",
      "#include <linux/rmap.h>",
      "#include <linux/userfaultfd_k.h>",
      "#include <uapi/linux/memfd.h>",
      "#include <linux/fcntl.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/magic.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/highmem.h>",
      "#include <linux/migrate.h>",
      "#include <linux/ctype.h>",
      "#include <linux/namei.h>",
      "#include <linux/mempolicy.h>",
      "#include <linux/swapops.h>",
      "#include <linux/security.h>",
      "#include <linux/splice.h>",
      "#include <linux/falloc.h>",
      "#include <linux/percpu_counter.h>",
      "#include <linux/pagevec.h>",
      "#include <linux/blkdev.h>",
      "#include <linux/writeback.h>",
      "#include <linux/shmem_fs.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/mman.h>",
      "#include <linux/posix_acl_xattr.h>",
      "#include <linux/posix_acl.h>",
      "#include <linux/exportfs.h>",
      "#include <linux/xattr.h>",
      "#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */",
      "#include <linux/hugetlb.h>",
      "#include <linux/khugepaged.h>",
      "#include <linux/uio.h>",
      "#include <linux/swap.h>",
      "#include <linux/export.h>",
      "#include <linux/sched/signal.h>",
      "#include <linux/random.h>",
      "#include <linux/mm.h>",
      "#include <linux/file.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/ramfs.h>",
      "#include <linux/mount.h>",
      "#include <linux/vfs.h>",
      "#include <linux/init.h>",
      "#include <linux/fs.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <linux/uaccess.h>\n#include <linux/uuid.h>\n#include <linux/rmap.h>\n#include <linux/userfaultfd_k.h>\n#include <uapi/linux/memfd.h>\n#include <linux/fcntl.h>\n#include <linux/syscalls.h>\n#include <linux/magic.h>\n#include <linux/seq_file.h>\n#include <linux/highmem.h>\n#include <linux/migrate.h>\n#include <linux/ctype.h>\n#include <linux/namei.h>\n#include <linux/mempolicy.h>\n#include <linux/swapops.h>\n#include <linux/security.h>\n#include <linux/splice.h>\n#include <linux/falloc.h>\n#include <linux/percpu_counter.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/writeback.h>\n#include <linux/shmem_fs.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/mman.h>\n#include <linux/posix_acl_xattr.h>\n#include <linux/posix_acl.h>\n#include <linux/exportfs.h>\n#include <linux/xattr.h>\n#include <asm/tlbflush.h> /* for arch/microblaze update_mmu_cache() */\n#include <linux/hugetlb.h>\n#include <linux/khugepaged.h>\n#include <linux/uio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/sched/signal.h>\n#include <linux/random.h>\n#include <linux/mm.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/ramfs.h>\n#include <linux/mount.h>\n#include <linux/vfs.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n\nstatic unsigned long shmem_default_max_blocks(void)\n{\n\treturn totalram_pages / 2;\n}"
  }
]