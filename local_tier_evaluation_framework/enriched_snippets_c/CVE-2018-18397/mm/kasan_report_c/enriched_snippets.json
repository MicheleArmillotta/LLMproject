[
  {
    "function_name": "__asan_report_store_n_noabort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "447-450",
    "snippet": "void __asan_report_store_n_noabort(unsigned long addr, size_t size)\n{\n\tkasan_report(addr, size, true, _RET_IP_);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_report",
          "args": [
            "addr",
            "size",
            "true",
            "_RET_IP_"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_report",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "396-413",
          "snippet": "void kasan_report(unsigned long addr, size_t size,\n\t\tbool is_write, unsigned long ip)\n{\n\tstruct kasan_access_info info;\n\n\tif (likely(!kasan_report_enabled()))\n\t\treturn;\n\n\tdisable_trace_on_warning();\n\n\tinfo.access_addr = (void *)addr;\n\tinfo.first_bad_addr = (void *)addr;\n\tinfo.access_size = size;\n\tinfo.is_write = is_write;\n\tinfo.ip = ip;\n\n\tkasan_report_error(&info);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid kasan_report(unsigned long addr, size_t size,\n\t\tbool is_write, unsigned long ip)\n{\n\tstruct kasan_access_info info;\n\n\tif (likely(!kasan_report_enabled()))\n\t\treturn;\n\n\tdisable_trace_on_warning();\n\n\tinfo.access_addr = (void *)addr;\n\tinfo.first_bad_addr = (void *)addr;\n\tinfo.access_size = size;\n\tinfo.is_write = is_write;\n\tinfo.ip = ip;\n\n\tkasan_report_error(&info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid __asan_report_store_n_noabort(unsigned long addr, size_t size)\n{\n\tkasan_report(addr, size, true, _RET_IP_);\n}"
  },
  {
    "function_name": "__asan_report_load_n_noabort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "441-444",
    "snippet": "void __asan_report_load_n_noabort(unsigned long addr, size_t size)\n{\n\tkasan_report(addr, size, false, _RET_IP_);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_report",
          "args": [
            "addr",
            "size",
            "false",
            "_RET_IP_"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_report",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "396-413",
          "snippet": "void kasan_report(unsigned long addr, size_t size,\n\t\tbool is_write, unsigned long ip)\n{\n\tstruct kasan_access_info info;\n\n\tif (likely(!kasan_report_enabled()))\n\t\treturn;\n\n\tdisable_trace_on_warning();\n\n\tinfo.access_addr = (void *)addr;\n\tinfo.first_bad_addr = (void *)addr;\n\tinfo.access_size = size;\n\tinfo.is_write = is_write;\n\tinfo.ip = ip;\n\n\tkasan_report_error(&info);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid kasan_report(unsigned long addr, size_t size,\n\t\tbool is_write, unsigned long ip)\n{\n\tstruct kasan_access_info info;\n\n\tif (likely(!kasan_report_enabled()))\n\t\treturn;\n\n\tdisable_trace_on_warning();\n\n\tinfo.access_addr = (void *)addr;\n\tinfo.first_bad_addr = (void *)addr;\n\tinfo.access_size = size;\n\tinfo.is_write = is_write;\n\tinfo.ip = ip;\n\n\tkasan_report_error(&info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid __asan_report_load_n_noabort(unsigned long addr, size_t size)\n{\n\tkasan_report(addr, size, false, _RET_IP_);\n}"
  },
  {
    "function_name": "kasan_report",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "396-413",
    "snippet": "void kasan_report(unsigned long addr, size_t size,\n\t\tbool is_write, unsigned long ip)\n{\n\tstruct kasan_access_info info;\n\n\tif (likely(!kasan_report_enabled()))\n\t\treturn;\n\n\tdisable_trace_on_warning();\n\n\tinfo.access_addr = (void *)addr;\n\tinfo.first_bad_addr = (void *)addr;\n\tinfo.access_size = size;\n\tinfo.is_write = is_write;\n\tinfo.ip = ip;\n\n\tkasan_report_error(&info);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_report_error",
          "args": [
            "&info"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_report_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "342-360",
          "snippet": "static void kasan_report_error(struct kasan_access_info *info)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\n\tprint_error_description(info);\n\tpr_err(\"\\n\");\n\n\tif (!addr_has_shadow(info)) {\n\t\tdump_stack();\n\t} else {\n\t\tprint_address_description((void *)info->access_addr);\n\t\tpr_err(\"\\n\");\n\t\tprint_shadow_for_address(info->first_bad_addr);\n\t}\n\n\tkasan_end_report(&flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void kasan_report_error(struct kasan_access_info *info)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\n\tprint_error_description(info);\n\tpr_err(\"\\n\");\n\n\tif (!addr_has_shadow(info)) {\n\t\tdump_stack();\n\t} else {\n\t\tprint_address_description((void *)info->access_addr);\n\t\tpr_err(\"\\n\");\n\t\tprint_shadow_for_address(info->first_bad_addr);\n\t}\n\n\tkasan_end_report(&flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "disable_trace_on_warning",
          "args": [],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!kasan_report_enabled()"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_report_enabled",
          "args": [],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_report_enabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "387-394",
          "snippet": "static inline bool kasan_report_enabled(void)\n{\n\tif (current->kasan_depth)\n\t\treturn false;\n\tif (test_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags))\n\t\treturn true;\n\treturn !test_and_set_bit(KASAN_BIT_REPORTED, &kasan_flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [
            "#define KASAN_BIT_MULTI_SHOT\t1",
            "#define KASAN_BIT_REPORTED\t0"
          ],
          "globals_used": [
            "static unsigned long kasan_flags;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define KASAN_BIT_MULTI_SHOT\t1\n#define KASAN_BIT_REPORTED\t0\n\nstatic unsigned long kasan_flags;\n\nstatic inline bool kasan_report_enabled(void)\n{\n\tif (current->kasan_depth)\n\t\treturn false;\n\tif (test_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags))\n\t\treturn true;\n\treturn !test_and_set_bit(KASAN_BIT_REPORTED, &kasan_flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid kasan_report(unsigned long addr, size_t size,\n\t\tbool is_write, unsigned long ip)\n{\n\tstruct kasan_access_info info;\n\n\tif (likely(!kasan_report_enabled()))\n\t\treturn;\n\n\tdisable_trace_on_warning();\n\n\tinfo.access_addr = (void *)addr;\n\tinfo.first_bad_addr = (void *)addr;\n\tinfo.access_size = size;\n\tinfo.is_write = is_write;\n\tinfo.ip = ip;\n\n\tkasan_report_error(&info);\n}"
  },
  {
    "function_name": "kasan_report_enabled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "387-394",
    "snippet": "static inline bool kasan_report_enabled(void)\n{\n\tif (current->kasan_depth)\n\t\treturn false;\n\tif (test_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags))\n\t\treturn true;\n\treturn !test_and_set_bit(KASAN_BIT_REPORTED, &kasan_flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [
      "#define KASAN_BIT_MULTI_SHOT\t1",
      "#define KASAN_BIT_REPORTED\t0"
    ],
    "globals_used": [
      "static unsigned long kasan_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "KASAN_BIT_REPORTED",
            "&kasan_flags"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "KASAN_BIT_MULTI_SHOT",
            "&kasan_flags"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define KASAN_BIT_MULTI_SHOT\t1\n#define KASAN_BIT_REPORTED\t0\n\nstatic unsigned long kasan_flags;\n\nstatic inline bool kasan_report_enabled(void)\n{\n\tif (current->kasan_depth)\n\t\treturn false;\n\tif (test_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags))\n\t\treturn true;\n\treturn !test_and_set_bit(KASAN_BIT_REPORTED, &kasan_flags);\n}"
  },
  {
    "function_name": "kasan_set_multi_shot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "380-384",
    "snippet": "static int __init kasan_set_multi_shot(char *str)\n{\n\tset_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags);\n\treturn 1;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [
      "#define KASAN_BIT_MULTI_SHOT\t1"
    ],
    "globals_used": [
      "static unsigned long kasan_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "KASAN_BIT_MULTI_SHOT",
            "&kasan_flags"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define KASAN_BIT_MULTI_SHOT\t1\n\nstatic unsigned long kasan_flags;\n\nstatic int __init kasan_set_multi_shot(char *str)\n{\n\tset_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags);\n\treturn 1;\n}"
  },
  {
    "function_name": "kasan_restore_multi_shot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "373-377",
    "snippet": "void kasan_restore_multi_shot(bool enabled)\n{\n\tif (!enabled)\n\t\tclear_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [
      "#define KASAN_BIT_MULTI_SHOT\t1"
    ],
    "globals_used": [
      "static unsigned long kasan_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear_bit",
          "args": [
            "KASAN_BIT_MULTI_SHOT",
            "&kasan_flags"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "clear_bit_unlock_is_negative_byte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/filemap.c",
          "lines": "1171-1176",
          "snippet": "static inline bool clear_bit_unlock_is_negative_byte(long nr, volatile void *mem)\n{\n\tclear_bit_unlock(nr, mem);\n\t/* smp_mb__after_atomic(); */\n\treturn test_bit(PG_waiters, mem);\n}",
          "includes": [
            "#include <asm/mman.h>",
            "#include <linux/buffer_head.h> /* for try_to_free_buffers */",
            "#include <trace/events/filemap.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/rmap.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/cleancache.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/security.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/writeback.h>",
            "#include <linux/hash.h>",
            "#include <linux/uio.h>",
            "#include <linux/file.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/capability.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/fs.h>",
            "#include <linux/dax.h>",
            "#include <linux/compiler.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/mman.h>\n#include <linux/buffer_head.h> /* for try_to_free_buffers */\n#include <trace/events/filemap.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/delayacct.h>\n#include <linux/rmap.h>\n#include <linux/shmem_fs.h>\n#include <linux/cleancache.h>\n#include <linux/memcontrol.h>\n#include <linux/hugetlb.h>\n#include <linux/cpuset.h>\n#include <linux/security.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/backing-dev.h>\n#include <linux/writeback.h>\n#include <linux/hash.h>\n#include <linux/uio.h>\n#include <linux/file.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/capability.h>\n#include <linux/uaccess.h>\n#include <linux/sched/signal.h>\n#include <linux/fs.h>\n#include <linux/dax.h>\n#include <linux/compiler.h>\n#include <linux/export.h>\n\nstatic inline bool clear_bit_unlock_is_negative_byte(long nr, volatile void *mem)\n{\n\tclear_bit_unlock(nr, mem);\n\t/* smp_mb__after_atomic(); */\n\treturn test_bit(PG_waiters, mem);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define KASAN_BIT_MULTI_SHOT\t1\n\nstatic unsigned long kasan_flags;\n\nvoid kasan_restore_multi_shot(bool enabled)\n{\n\tif (!enabled)\n\t\tclear_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags);\n}"
  },
  {
    "function_name": "kasan_save_enable_multi_shot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "367-370",
    "snippet": "bool kasan_save_enable_multi_shot(void)\n{\n\treturn test_and_set_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [
      "#define KASAN_BIT_MULTI_SHOT\t1"
    ],
    "globals_used": [
      "static unsigned long kasan_flags;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "KASAN_BIT_MULTI_SHOT",
            "&kasan_flags"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define KASAN_BIT_MULTI_SHOT\t1\n\nstatic unsigned long kasan_flags;\n\nbool kasan_save_enable_multi_shot(void)\n{\n\treturn test_and_set_bit(KASAN_BIT_MULTI_SHOT, &kasan_flags);\n}"
  },
  {
    "function_name": "kasan_report_error",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "342-360",
    "snippet": "static void kasan_report_error(struct kasan_access_info *info)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\n\tprint_error_description(info);\n\tpr_err(\"\\n\");\n\n\tif (!addr_has_shadow(info)) {\n\t\tdump_stack();\n\t} else {\n\t\tprint_address_description((void *)info->access_addr);\n\t\tpr_err(\"\\n\");\n\t\tprint_shadow_for_address(info->first_bad_addr);\n\t}\n\n\tkasan_end_report(&flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_end_report",
          "args": [
            "&flags"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_end_report",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "174-182",
          "snippet": "static void kasan_end_report(unsigned long *flags)\n{\n\tpr_err(\"==================================================================\\n\");\n\tadd_taint(TAINT_BAD_PAGE, LOCKDEP_NOW_UNRELIABLE);\n\tspin_unlock_irqrestore(&report_lock, *flags);\n\tif (panic_on_warn)\n\t\tpanic(\"panic_on_warn set ...\\n\");\n\tkasan_enable_current();\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(report_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic DEFINE_SPINLOCK(report_lock);\n\nstatic void kasan_end_report(unsigned long *flags)\n{\n\tpr_err(\"==================================================================\\n\");\n\tadd_taint(TAINT_BAD_PAGE, LOCKDEP_NOW_UNRELIABLE);\n\tspin_unlock_irqrestore(&report_lock, *flags);\n\tif (panic_on_warn)\n\t\tpanic(\"panic_on_warn set ...\\n\");\n\tkasan_enable_current();\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_shadow_for_address",
          "args": [
            "info->first_bad_addr"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "print_shadow_for_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "291-327",
          "snippet": "static void print_shadow_for_address(const void *addr)\n{\n\tint i;\n\tconst void *shadow = kasan_mem_to_shadow(addr);\n\tconst void *shadow_row;\n\n\tshadow_row = (void *)round_down((unsigned long)shadow,\n\t\t\t\t\tSHADOW_BYTES_PER_ROW)\n\t\t- SHADOW_ROWS_AROUND_ADDR * SHADOW_BYTES_PER_ROW;\n\n\tpr_err(\"Memory state around the buggy address:\\n\");\n\n\tfor (i = -SHADOW_ROWS_AROUND_ADDR; i <= SHADOW_ROWS_AROUND_ADDR; i++) {\n\t\tconst void *kaddr = kasan_shadow_to_mem(shadow_row);\n\t\tchar buffer[4 + (BITS_PER_LONG/8)*2];\n\t\tchar shadow_buf[SHADOW_BYTES_PER_ROW];\n\n\t\tsnprintf(buffer, sizeof(buffer),\n\t\t\t(i == 0) ? \">%px: \" : \" %px: \", kaddr);\n\t\t/*\n\t\t * We should not pass a shadow pointer to generic\n\t\t * function, because generic functions may try to\n\t\t * access kasan mapping for the passed address.\n\t\t */\n\t\tmemcpy(shadow_buf, shadow_row, SHADOW_BYTES_PER_ROW);\n\t\tprint_hex_dump(KERN_ERR, buffer,\n\t\t\tDUMP_PREFIX_NONE, SHADOW_BYTES_PER_ROW, 1,\n\t\t\tshadow_buf, SHADOW_BYTES_PER_ROW, 0);\n\n\t\tif (row_is_guilty(shadow_row, shadow))\n\t\t\tpr_err(\"%*c\\n\",\n\t\t\t\tshadow_pointer_offset(shadow_row, shadow),\n\t\t\t\t'^');\n\n\t\tshadow_row += SHADOW_BYTES_PER_ROW;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [
            "#define SHADOW_ROWS_AROUND_ADDR 2",
            "#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define SHADOW_ROWS_AROUND_ADDR 2\n#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)\n\nstatic void print_shadow_for_address(const void *addr)\n{\n\tint i;\n\tconst void *shadow = kasan_mem_to_shadow(addr);\n\tconst void *shadow_row;\n\n\tshadow_row = (void *)round_down((unsigned long)shadow,\n\t\t\t\t\tSHADOW_BYTES_PER_ROW)\n\t\t- SHADOW_ROWS_AROUND_ADDR * SHADOW_BYTES_PER_ROW;\n\n\tpr_err(\"Memory state around the buggy address:\\n\");\n\n\tfor (i = -SHADOW_ROWS_AROUND_ADDR; i <= SHADOW_ROWS_AROUND_ADDR; i++) {\n\t\tconst void *kaddr = kasan_shadow_to_mem(shadow_row);\n\t\tchar buffer[4 + (BITS_PER_LONG/8)*2];\n\t\tchar shadow_buf[SHADOW_BYTES_PER_ROW];\n\n\t\tsnprintf(buffer, sizeof(buffer),\n\t\t\t(i == 0) ? \">%px: \" : \" %px: \", kaddr);\n\t\t/*\n\t\t * We should not pass a shadow pointer to generic\n\t\t * function, because generic functions may try to\n\t\t * access kasan mapping for the passed address.\n\t\t */\n\t\tmemcpy(shadow_buf, shadow_row, SHADOW_BYTES_PER_ROW);\n\t\tprint_hex_dump(KERN_ERR, buffer,\n\t\t\tDUMP_PREFIX_NONE, SHADOW_BYTES_PER_ROW, 1,\n\t\t\tshadow_buf, SHADOW_BYTES_PER_ROW, 0);\n\n\t\tif (row_is_guilty(shadow_row, shadow))\n\t\t\tpr_err(\"%*c\\n\",\n\t\t\t\tshadow_pointer_offset(shadow_row, shadow),\n\t\t\t\t'^');\n\n\t\tshadow_row += SHADOW_BYTES_PER_ROW;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"\\n\""
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_address_description",
          "args": [
            "(void *)info->access_addr"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "print_address_description",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "252-275",
          "snippet": "static void print_address_description(void *addr)\n{\n\tstruct page *page = addr_to_page(addr);\n\n\tdump_stack();\n\tpr_err(\"\\n\");\n\n\tif (page && PageSlab(page)) {\n\t\tstruct kmem_cache *cache = page->slab_cache;\n\t\tvoid *object = nearest_obj(cache, page,\taddr);\n\n\t\tdescribe_object(cache, object, addr);\n\t}\n\n\tif (kernel_or_module_addr(addr) && !init_task_stack_addr(addr)) {\n\t\tpr_err(\"The buggy address belongs to the variable:\\n\");\n\t\tpr_err(\" %pS\\n\", addr);\n\t}\n\n\tif (page) {\n\t\tpr_err(\"The buggy address belongs to the page:\\n\");\n\t\tdump_page(page, \"kasan: bad access detected\");\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void print_address_description(void *addr)\n{\n\tstruct page *page = addr_to_page(addr);\n\n\tdump_stack();\n\tpr_err(\"\\n\");\n\n\tif (page && PageSlab(page)) {\n\t\tstruct kmem_cache *cache = page->slab_cache;\n\t\tvoid *object = nearest_obj(cache, page,\taddr);\n\n\t\tdescribe_object(cache, object, addr);\n\t}\n\n\tif (kernel_or_module_addr(addr) && !init_task_stack_addr(addr)) {\n\t\tpr_err(\"The buggy address belongs to the variable:\\n\");\n\t\tpr_err(\" %pS\\n\", addr);\n\t}\n\n\tif (page) {\n\t\tpr_err(\"The buggy address belongs to the page:\\n\");\n\t\tdump_page(page, \"kasan: bad access detected\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dump_stack",
          "args": [],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addr_has_shadow",
          "args": [
            "info"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "addr_has_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "54-58",
          "snippet": "static bool addr_has_shadow(struct kasan_access_info *info)\n{\n\treturn (info->access_addr >=\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START));\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic bool addr_has_shadow(struct kasan_access_info *info)\n{\n\treturn (info->access_addr >=\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"\\n\""
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_error_description",
          "args": [
            "info"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "print_error_description",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "135-144",
          "snippet": "static void print_error_description(struct kasan_access_info *info)\n{\n\tconst char *bug_type = get_bug_type(info);\n\n\tpr_err(\"BUG: KASAN: %s in %pS\\n\",\n\t\tbug_type, (void *)info->ip);\n\tpr_err(\"%s of size %zu at addr %px by task %s/%d\\n\",\n\t\tinfo->is_write ? \"Write\" : \"Read\", info->access_size,\n\t\tinfo->access_addr, current->comm, task_pid_nr(current));\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void print_error_description(struct kasan_access_info *info)\n{\n\tconst char *bug_type = get_bug_type(info);\n\n\tpr_err(\"BUG: KASAN: %s in %pS\\n\",\n\t\tbug_type, (void *)info->ip);\n\tpr_err(\"%s of size %zu at addr %px by task %s/%d\\n\",\n\t\tinfo->is_write ? \"Write\" : \"Read\", info->access_size,\n\t\tinfo->access_addr, current->comm, task_pid_nr(current));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_start_report",
          "args": [
            "&flags"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_start_report",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "164-172",
          "snippet": "static void kasan_start_report(unsigned long *flags)\n{\n\t/*\n\t * Make sure we don't end up in loop.\n\t */\n\tkasan_disable_current();\n\tspin_lock_irqsave(&report_lock, *flags);\n\tpr_err(\"==================================================================\\n\");\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(report_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic DEFINE_SPINLOCK(report_lock);\n\nstatic void kasan_start_report(unsigned long *flags)\n{\n\t/*\n\t * Make sure we don't end up in loop.\n\t */\n\tkasan_disable_current();\n\tspin_lock_irqsave(&report_lock, *flags);\n\tpr_err(\"==================================================================\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void kasan_report_error(struct kasan_access_info *info)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\n\tprint_error_description(info);\n\tpr_err(\"\\n\");\n\n\tif (!addr_has_shadow(info)) {\n\t\tdump_stack();\n\t} else {\n\t\tprint_address_description((void *)info->access_addr);\n\t\tpr_err(\"\\n\");\n\t\tprint_shadow_for_address(info->first_bad_addr);\n\t}\n\n\tkasan_end_report(&flags);\n}"
  },
  {
    "function_name": "kasan_report_invalid_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "329-340",
    "snippet": "void kasan_report_invalid_free(void *object, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\tpr_err(\"BUG: KASAN: double-free or invalid-free in %pS\\n\", (void *)ip);\n\tpr_err(\"\\n\");\n\tprint_address_description(object);\n\tpr_err(\"\\n\");\n\tprint_shadow_for_address(object);\n\tkasan_end_report(&flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_end_report",
          "args": [
            "&flags"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_end_report",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "174-182",
          "snippet": "static void kasan_end_report(unsigned long *flags)\n{\n\tpr_err(\"==================================================================\\n\");\n\tadd_taint(TAINT_BAD_PAGE, LOCKDEP_NOW_UNRELIABLE);\n\tspin_unlock_irqrestore(&report_lock, *flags);\n\tif (panic_on_warn)\n\t\tpanic(\"panic_on_warn set ...\\n\");\n\tkasan_enable_current();\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(report_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic DEFINE_SPINLOCK(report_lock);\n\nstatic void kasan_end_report(unsigned long *flags)\n{\n\tpr_err(\"==================================================================\\n\");\n\tadd_taint(TAINT_BAD_PAGE, LOCKDEP_NOW_UNRELIABLE);\n\tspin_unlock_irqrestore(&report_lock, *flags);\n\tif (panic_on_warn)\n\t\tpanic(\"panic_on_warn set ...\\n\");\n\tkasan_enable_current();\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_shadow_for_address",
          "args": [
            "object"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "print_shadow_for_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "291-327",
          "snippet": "static void print_shadow_for_address(const void *addr)\n{\n\tint i;\n\tconst void *shadow = kasan_mem_to_shadow(addr);\n\tconst void *shadow_row;\n\n\tshadow_row = (void *)round_down((unsigned long)shadow,\n\t\t\t\t\tSHADOW_BYTES_PER_ROW)\n\t\t- SHADOW_ROWS_AROUND_ADDR * SHADOW_BYTES_PER_ROW;\n\n\tpr_err(\"Memory state around the buggy address:\\n\");\n\n\tfor (i = -SHADOW_ROWS_AROUND_ADDR; i <= SHADOW_ROWS_AROUND_ADDR; i++) {\n\t\tconst void *kaddr = kasan_shadow_to_mem(shadow_row);\n\t\tchar buffer[4 + (BITS_PER_LONG/8)*2];\n\t\tchar shadow_buf[SHADOW_BYTES_PER_ROW];\n\n\t\tsnprintf(buffer, sizeof(buffer),\n\t\t\t(i == 0) ? \">%px: \" : \" %px: \", kaddr);\n\t\t/*\n\t\t * We should not pass a shadow pointer to generic\n\t\t * function, because generic functions may try to\n\t\t * access kasan mapping for the passed address.\n\t\t */\n\t\tmemcpy(shadow_buf, shadow_row, SHADOW_BYTES_PER_ROW);\n\t\tprint_hex_dump(KERN_ERR, buffer,\n\t\t\tDUMP_PREFIX_NONE, SHADOW_BYTES_PER_ROW, 1,\n\t\t\tshadow_buf, SHADOW_BYTES_PER_ROW, 0);\n\n\t\tif (row_is_guilty(shadow_row, shadow))\n\t\t\tpr_err(\"%*c\\n\",\n\t\t\t\tshadow_pointer_offset(shadow_row, shadow),\n\t\t\t\t'^');\n\n\t\tshadow_row += SHADOW_BYTES_PER_ROW;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [
            "#define SHADOW_ROWS_AROUND_ADDR 2",
            "#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define SHADOW_ROWS_AROUND_ADDR 2\n#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)\n\nstatic void print_shadow_for_address(const void *addr)\n{\n\tint i;\n\tconst void *shadow = kasan_mem_to_shadow(addr);\n\tconst void *shadow_row;\n\n\tshadow_row = (void *)round_down((unsigned long)shadow,\n\t\t\t\t\tSHADOW_BYTES_PER_ROW)\n\t\t- SHADOW_ROWS_AROUND_ADDR * SHADOW_BYTES_PER_ROW;\n\n\tpr_err(\"Memory state around the buggy address:\\n\");\n\n\tfor (i = -SHADOW_ROWS_AROUND_ADDR; i <= SHADOW_ROWS_AROUND_ADDR; i++) {\n\t\tconst void *kaddr = kasan_shadow_to_mem(shadow_row);\n\t\tchar buffer[4 + (BITS_PER_LONG/8)*2];\n\t\tchar shadow_buf[SHADOW_BYTES_PER_ROW];\n\n\t\tsnprintf(buffer, sizeof(buffer),\n\t\t\t(i == 0) ? \">%px: \" : \" %px: \", kaddr);\n\t\t/*\n\t\t * We should not pass a shadow pointer to generic\n\t\t * function, because generic functions may try to\n\t\t * access kasan mapping for the passed address.\n\t\t */\n\t\tmemcpy(shadow_buf, shadow_row, SHADOW_BYTES_PER_ROW);\n\t\tprint_hex_dump(KERN_ERR, buffer,\n\t\t\tDUMP_PREFIX_NONE, SHADOW_BYTES_PER_ROW, 1,\n\t\t\tshadow_buf, SHADOW_BYTES_PER_ROW, 0);\n\n\t\tif (row_is_guilty(shadow_row, shadow))\n\t\t\tpr_err(\"%*c\\n\",\n\t\t\t\tshadow_pointer_offset(shadow_row, shadow),\n\t\t\t\t'^');\n\n\t\tshadow_row += SHADOW_BYTES_PER_ROW;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"\\n\""
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_address_description",
          "args": [
            "object"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "print_address_description",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "252-275",
          "snippet": "static void print_address_description(void *addr)\n{\n\tstruct page *page = addr_to_page(addr);\n\n\tdump_stack();\n\tpr_err(\"\\n\");\n\n\tif (page && PageSlab(page)) {\n\t\tstruct kmem_cache *cache = page->slab_cache;\n\t\tvoid *object = nearest_obj(cache, page,\taddr);\n\n\t\tdescribe_object(cache, object, addr);\n\t}\n\n\tif (kernel_or_module_addr(addr) && !init_task_stack_addr(addr)) {\n\t\tpr_err(\"The buggy address belongs to the variable:\\n\");\n\t\tpr_err(\" %pS\\n\", addr);\n\t}\n\n\tif (page) {\n\t\tpr_err(\"The buggy address belongs to the page:\\n\");\n\t\tdump_page(page, \"kasan: bad access detected\");\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void print_address_description(void *addr)\n{\n\tstruct page *page = addr_to_page(addr);\n\n\tdump_stack();\n\tpr_err(\"\\n\");\n\n\tif (page && PageSlab(page)) {\n\t\tstruct kmem_cache *cache = page->slab_cache;\n\t\tvoid *object = nearest_obj(cache, page,\taddr);\n\n\t\tdescribe_object(cache, object, addr);\n\t}\n\n\tif (kernel_or_module_addr(addr) && !init_task_stack_addr(addr)) {\n\t\tpr_err(\"The buggy address belongs to the variable:\\n\");\n\t\tpr_err(\" %pS\\n\", addr);\n\t}\n\n\tif (page) {\n\t\tpr_err(\"The buggy address belongs to the page:\\n\");\n\t\tdump_page(page, \"kasan: bad access detected\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"\\n\""
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"BUG: KASAN: double-free or invalid-free in %pS\\n\"",
            "(void *)ip"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_start_report",
          "args": [
            "&flags"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_start_report",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "164-172",
          "snippet": "static void kasan_start_report(unsigned long *flags)\n{\n\t/*\n\t * Make sure we don't end up in loop.\n\t */\n\tkasan_disable_current();\n\tspin_lock_irqsave(&report_lock, *flags);\n\tpr_err(\"==================================================================\\n\");\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(report_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic DEFINE_SPINLOCK(report_lock);\n\nstatic void kasan_start_report(unsigned long *flags)\n{\n\t/*\n\t * Make sure we don't end up in loop.\n\t */\n\tkasan_disable_current();\n\tspin_lock_irqsave(&report_lock, *flags);\n\tpr_err(\"==================================================================\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid kasan_report_invalid_free(void *object, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\tpr_err(\"BUG: KASAN: double-free or invalid-free in %pS\\n\", (void *)ip);\n\tpr_err(\"\\n\");\n\tprint_address_description(object);\n\tpr_err(\"\\n\");\n\tprint_shadow_for_address(object);\n\tkasan_end_report(&flags);\n}"
  },
  {
    "function_name": "print_shadow_for_address",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "291-327",
    "snippet": "static void print_shadow_for_address(const void *addr)\n{\n\tint i;\n\tconst void *shadow = kasan_mem_to_shadow(addr);\n\tconst void *shadow_row;\n\n\tshadow_row = (void *)round_down((unsigned long)shadow,\n\t\t\t\t\tSHADOW_BYTES_PER_ROW)\n\t\t- SHADOW_ROWS_AROUND_ADDR * SHADOW_BYTES_PER_ROW;\n\n\tpr_err(\"Memory state around the buggy address:\\n\");\n\n\tfor (i = -SHADOW_ROWS_AROUND_ADDR; i <= SHADOW_ROWS_AROUND_ADDR; i++) {\n\t\tconst void *kaddr = kasan_shadow_to_mem(shadow_row);\n\t\tchar buffer[4 + (BITS_PER_LONG/8)*2];\n\t\tchar shadow_buf[SHADOW_BYTES_PER_ROW];\n\n\t\tsnprintf(buffer, sizeof(buffer),\n\t\t\t(i == 0) ? \">%px: \" : \" %px: \", kaddr);\n\t\t/*\n\t\t * We should not pass a shadow pointer to generic\n\t\t * function, because generic functions may try to\n\t\t * access kasan mapping for the passed address.\n\t\t */\n\t\tmemcpy(shadow_buf, shadow_row, SHADOW_BYTES_PER_ROW);\n\t\tprint_hex_dump(KERN_ERR, buffer,\n\t\t\tDUMP_PREFIX_NONE, SHADOW_BYTES_PER_ROW, 1,\n\t\t\tshadow_buf, SHADOW_BYTES_PER_ROW, 0);\n\n\t\tif (row_is_guilty(shadow_row, shadow))\n\t\t\tpr_err(\"%*c\\n\",\n\t\t\t\tshadow_pointer_offset(shadow_row, shadow),\n\t\t\t\t'^');\n\n\t\tshadow_row += SHADOW_BYTES_PER_ROW;\n\t}\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [
      "#define SHADOW_ROWS_AROUND_ADDR 2",
      "#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%*c\\n\"",
            "shadow_pointer_offset(shadow_row, shadow)",
            "'^'"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shadow_pointer_offset",
          "args": [
            "shadow_row",
            "shadow"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "shadow_pointer_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "282-289",
          "snippet": "static int shadow_pointer_offset(const void *row, const void *shadow)\n{\n\t/* The length of \">ff00ff00ff00ff00: \" is\n\t *    3 + (BITS_PER_LONG/8)*2 chars.\n\t */\n\treturn 3 + (BITS_PER_LONG/8)*2 + (shadow - row)*2 +\n\t\t(shadow - row) / SHADOW_BYTES_PER_BLOCK + 1;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [
            "#define SHADOW_BYTES_PER_BLOCK 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define SHADOW_BYTES_PER_BLOCK 1\n\nstatic int shadow_pointer_offset(const void *row, const void *shadow)\n{\n\t/* The length of \">ff00ff00ff00ff00: \" is\n\t *    3 + (BITS_PER_LONG/8)*2 chars.\n\t */\n\treturn 3 + (BITS_PER_LONG/8)*2 + (shadow - row)*2 +\n\t\t(shadow - row) / SHADOW_BYTES_PER_BLOCK + 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "row_is_guilty",
          "args": [
            "shadow_row",
            "shadow"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "row_is_guilty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "277-280",
          "snippet": "static bool row_is_guilty(const void *row, const void *guilty)\n{\n\treturn (row <= guilty) && (guilty < row + SHADOW_BYTES_PER_ROW);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [
            "#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)\n\nstatic bool row_is_guilty(const void *row, const void *guilty)\n{\n\treturn (row <= guilty) && (guilty < row + SHADOW_BYTES_PER_ROW);\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_hex_dump",
          "args": [
            "KERN_ERR",
            "buffer",
            "DUMP_PREFIX_NONE",
            "SHADOW_BYTES_PER_ROW",
            "1",
            "shadow_buf",
            "SHADOW_BYTES_PER_ROW",
            "0"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "shadow_buf",
            "shadow_row",
            "SHADOW_BYTES_PER_ROW"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "(i == 0) ? \">%px: \" : \" %px: \"",
            "kaddr"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_shadow_to_mem",
          "args": [
            "shadow_row"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_shadow_to_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.h",
          "lines": "102-106",
          "snippet": "static inline const void *kasan_shadow_to_mem(const void *shadow_addr)\n{\n\treturn (void *)(((unsigned long)shadow_addr - KASAN_SHADOW_OFFSET)\n\t\t<< KASAN_SHADOW_SCALE_SHIFT);\n}",
          "includes": [
            "#include <linux/stackdepot.h>",
            "#include <linux/kasan.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/stackdepot.h>\n#include <linux/kasan.h>\n\nstatic inline const void *kasan_shadow_to_mem(const void *shadow_addr)\n{\n\treturn (void *)(((unsigned long)shadow_addr - KASAN_SHADOW_OFFSET)\n\t\t<< KASAN_SHADOW_SCALE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"Memory state around the buggy address:\\n\""
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "(unsigned long)shadow",
            "SHADOW_BYTES_PER_ROW"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "addr"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define SHADOW_ROWS_AROUND_ADDR 2\n#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)\n\nstatic void print_shadow_for_address(const void *addr)\n{\n\tint i;\n\tconst void *shadow = kasan_mem_to_shadow(addr);\n\tconst void *shadow_row;\n\n\tshadow_row = (void *)round_down((unsigned long)shadow,\n\t\t\t\t\tSHADOW_BYTES_PER_ROW)\n\t\t- SHADOW_ROWS_AROUND_ADDR * SHADOW_BYTES_PER_ROW;\n\n\tpr_err(\"Memory state around the buggy address:\\n\");\n\n\tfor (i = -SHADOW_ROWS_AROUND_ADDR; i <= SHADOW_ROWS_AROUND_ADDR; i++) {\n\t\tconst void *kaddr = kasan_shadow_to_mem(shadow_row);\n\t\tchar buffer[4 + (BITS_PER_LONG/8)*2];\n\t\tchar shadow_buf[SHADOW_BYTES_PER_ROW];\n\n\t\tsnprintf(buffer, sizeof(buffer),\n\t\t\t(i == 0) ? \">%px: \" : \" %px: \", kaddr);\n\t\t/*\n\t\t * We should not pass a shadow pointer to generic\n\t\t * function, because generic functions may try to\n\t\t * access kasan mapping for the passed address.\n\t\t */\n\t\tmemcpy(shadow_buf, shadow_row, SHADOW_BYTES_PER_ROW);\n\t\tprint_hex_dump(KERN_ERR, buffer,\n\t\t\tDUMP_PREFIX_NONE, SHADOW_BYTES_PER_ROW, 1,\n\t\t\tshadow_buf, SHADOW_BYTES_PER_ROW, 0);\n\n\t\tif (row_is_guilty(shadow_row, shadow))\n\t\t\tpr_err(\"%*c\\n\",\n\t\t\t\tshadow_pointer_offset(shadow_row, shadow),\n\t\t\t\t'^');\n\n\t\tshadow_row += SHADOW_BYTES_PER_ROW;\n\t}\n}"
  },
  {
    "function_name": "shadow_pointer_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "282-289",
    "snippet": "static int shadow_pointer_offset(const void *row, const void *shadow)\n{\n\t/* The length of \">ff00ff00ff00ff00: \" is\n\t *    3 + (BITS_PER_LONG/8)*2 chars.\n\t */\n\treturn 3 + (BITS_PER_LONG/8)*2 + (shadow - row)*2 +\n\t\t(shadow - row) / SHADOW_BYTES_PER_BLOCK + 1;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [
      "#define SHADOW_BYTES_PER_BLOCK 1"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define SHADOW_BYTES_PER_BLOCK 1\n\nstatic int shadow_pointer_offset(const void *row, const void *shadow)\n{\n\t/* The length of \">ff00ff00ff00ff00: \" is\n\t *    3 + (BITS_PER_LONG/8)*2 chars.\n\t */\n\treturn 3 + (BITS_PER_LONG/8)*2 + (shadow - row)*2 +\n\t\t(shadow - row) / SHADOW_BYTES_PER_BLOCK + 1;\n}"
  },
  {
    "function_name": "row_is_guilty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "277-280",
    "snippet": "static bool row_is_guilty(const void *row, const void *guilty)\n{\n\treturn (row <= guilty) && (guilty < row + SHADOW_BYTES_PER_ROW);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [
      "#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\n#define SHADOW_BYTES_PER_ROW (SHADOW_BLOCKS_PER_ROW * SHADOW_BYTES_PER_BLOCK)\n\nstatic bool row_is_guilty(const void *row, const void *guilty)\n{\n\treturn (row <= guilty) && (guilty < row + SHADOW_BYTES_PER_ROW);\n}"
  },
  {
    "function_name": "print_address_description",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "252-275",
    "snippet": "static void print_address_description(void *addr)\n{\n\tstruct page *page = addr_to_page(addr);\n\n\tdump_stack();\n\tpr_err(\"\\n\");\n\n\tif (page && PageSlab(page)) {\n\t\tstruct kmem_cache *cache = page->slab_cache;\n\t\tvoid *object = nearest_obj(cache, page,\taddr);\n\n\t\tdescribe_object(cache, object, addr);\n\t}\n\n\tif (kernel_or_module_addr(addr) && !init_task_stack_addr(addr)) {\n\t\tpr_err(\"The buggy address belongs to the variable:\\n\");\n\t\tpr_err(\" %pS\\n\", addr);\n\t}\n\n\tif (page) {\n\t\tpr_err(\"The buggy address belongs to the page:\\n\");\n\t\tdump_page(page, \"kasan: bad access detected\");\n\t}\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dump_page",
          "args": [
            "page",
            "\"kasan: bad access detected\""
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "dump_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/debug.c",
          "lines": "91-95",
          "snippet": "void dump_page(struct page *page, const char *reason)\n{\n\t__dump_page(page, reason);\n\tdump_page_owner(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/ctype.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/migrate.h>",
            "#include <trace/events/mmflags.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/ctype.h>\n#include <linux/page_owner.h>\n#include <linux/migrate.h>\n#include <trace/events/mmflags.h>\n#include <linux/memcontrol.h>\n#include <linux/trace_events.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid dump_page(struct page *page, const char *reason)\n{\n\t__dump_page(page, reason);\n\tdump_page_owner(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"The buggy address belongs to the page:\\n\""
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\" %pS\\n\"",
            "addr"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"The buggy address belongs to the variable:\\n\""
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_task_stack_addr",
          "args": [
            "addr"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "init_task_stack_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "155-160",
          "snippet": "static inline bool init_task_stack_addr(const void *addr)\n{\n\treturn addr >= (void *)&init_thread_union.stack &&\n\t\t(addr <= (void *)&init_thread_union.stack +\n\t\t\tsizeof(init_thread_union.stack));\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic inline bool init_task_stack_addr(const void *addr)\n{\n\treturn addr >= (void *)&init_thread_union.stack &&\n\t\t(addr <= (void *)&init_thread_union.stack +\n\t\t\tsizeof(init_thread_union.stack));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kernel_or_module_addr",
          "args": [
            "addr"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "kernel_or_module_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "146-153",
          "snippet": "static inline bool kernel_or_module_addr(const void *addr)\n{\n\tif (addr >= (void *)_stext && addr < (void *)_end)\n\t\treturn true;\n\tif (is_module_address((unsigned long)addr))\n\t\treturn true;\n\treturn false;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic inline bool kernel_or_module_addr(const void *addr)\n{\n\tif (addr >= (void *)_stext && addr < (void *)_end)\n\t\treturn true;\n\tif (is_module_address((unsigned long)addr))\n\t\treturn true;\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "describe_object",
          "args": [
            "cache",
            "object",
            "addr"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "describe_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "237-250",
          "snippet": "static void describe_object(struct kmem_cache *cache, void *object,\n\t\t\t\tconst void *addr)\n{\n\tstruct kasan_alloc_meta *alloc_info = get_alloc_info(cache, object);\n\n\tif (cache->flags & SLAB_KASAN) {\n\t\tprint_track(&alloc_info->alloc_track, \"Allocated\");\n\t\tpr_err(\"\\n\");\n\t\tprint_track(&alloc_info->free_track, \"Freed\");\n\t\tpr_err(\"\\n\");\n\t}\n\n\tdescribe_object_addr(cache, object, addr);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void describe_object(struct kmem_cache *cache, void *object,\n\t\t\t\tconst void *addr)\n{\n\tstruct kasan_alloc_meta *alloc_info = get_alloc_info(cache, object);\n\n\tif (cache->flags & SLAB_KASAN) {\n\t\tprint_track(&alloc_info->alloc_track, \"Allocated\");\n\t\tpr_err(\"\\n\");\n\t\tprint_track(&alloc_info->free_track, \"Freed\");\n\t\tpr_err(\"\\n\");\n\t}\n\n\tdescribe_object_addr(cache, object, addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nearest_obj",
          "args": [
            "cache",
            "page",
            "addr"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageSlab",
          "args": [
            "page"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"\\n\""
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dump_stack",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addr_to_page",
          "args": [
            "addr"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "addr_to_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "197-203",
          "snippet": "static struct page *addr_to_page(const void *addr)\n{\n\tif ((addr >= (void *)PAGE_OFFSET) &&\n\t\t\t(addr < high_memory))\n\t\treturn virt_to_head_page(addr);\n\treturn NULL;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic struct page *addr_to_page(const void *addr)\n{\n\tif ((addr >= (void *)PAGE_OFFSET) &&\n\t\t\t(addr < high_memory))\n\t\treturn virt_to_head_page(addr);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void print_address_description(void *addr)\n{\n\tstruct page *page = addr_to_page(addr);\n\n\tdump_stack();\n\tpr_err(\"\\n\");\n\n\tif (page && PageSlab(page)) {\n\t\tstruct kmem_cache *cache = page->slab_cache;\n\t\tvoid *object = nearest_obj(cache, page,\taddr);\n\n\t\tdescribe_object(cache, object, addr);\n\t}\n\n\tif (kernel_or_module_addr(addr) && !init_task_stack_addr(addr)) {\n\t\tpr_err(\"The buggy address belongs to the variable:\\n\");\n\t\tpr_err(\" %pS\\n\", addr);\n\t}\n\n\tif (page) {\n\t\tpr_err(\"The buggy address belongs to the page:\\n\");\n\t\tdump_page(page, \"kasan: bad access detected\");\n\t}\n}"
  },
  {
    "function_name": "describe_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "237-250",
    "snippet": "static void describe_object(struct kmem_cache *cache, void *object,\n\t\t\t\tconst void *addr)\n{\n\tstruct kasan_alloc_meta *alloc_info = get_alloc_info(cache, object);\n\n\tif (cache->flags & SLAB_KASAN) {\n\t\tprint_track(&alloc_info->alloc_track, \"Allocated\");\n\t\tpr_err(\"\\n\");\n\t\tprint_track(&alloc_info->free_track, \"Freed\");\n\t\tpr_err(\"\\n\");\n\t}\n\n\tdescribe_object_addr(cache, object, addr);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "describe_object_addr",
          "args": [
            "cache",
            "object",
            "addr"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "describe_object_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "205-235",
          "snippet": "static void describe_object_addr(struct kmem_cache *cache, void *object,\n\t\t\t\tconst void *addr)\n{\n\tunsigned long access_addr = (unsigned long)addr;\n\tunsigned long object_addr = (unsigned long)object;\n\tconst char *rel_type;\n\tint rel_bytes;\n\n\tpr_err(\"The buggy address belongs to the object at %px\\n\"\n\t       \" which belongs to the cache %s of size %d\\n\",\n\t\tobject, cache->name, cache->object_size);\n\n\tif (!addr)\n\t\treturn;\n\n\tif (access_addr < object_addr) {\n\t\trel_type = \"to the left\";\n\t\trel_bytes = object_addr - access_addr;\n\t} else if (access_addr >= object_addr + cache->object_size) {\n\t\trel_type = \"to the right\";\n\t\trel_bytes = access_addr - (object_addr + cache->object_size);\n\t} else {\n\t\trel_type = \"inside\";\n\t\trel_bytes = access_addr - object_addr;\n\t}\n\n\tpr_err(\"The buggy address is located %d bytes %s of\\n\"\n\t       \" %d-byte region [%px, %px)\\n\",\n\t\trel_bytes, rel_type, cache->object_size, (void *)object_addr,\n\t\t(void *)(object_addr + cache->object_size));\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void describe_object_addr(struct kmem_cache *cache, void *object,\n\t\t\t\tconst void *addr)\n{\n\tunsigned long access_addr = (unsigned long)addr;\n\tunsigned long object_addr = (unsigned long)object;\n\tconst char *rel_type;\n\tint rel_bytes;\n\n\tpr_err(\"The buggy address belongs to the object at %px\\n\"\n\t       \" which belongs to the cache %s of size %d\\n\",\n\t\tobject, cache->name, cache->object_size);\n\n\tif (!addr)\n\t\treturn;\n\n\tif (access_addr < object_addr) {\n\t\trel_type = \"to the left\";\n\t\trel_bytes = object_addr - access_addr;\n\t} else if (access_addr >= object_addr + cache->object_size) {\n\t\trel_type = \"to the right\";\n\t\trel_bytes = access_addr - (object_addr + cache->object_size);\n\t} else {\n\t\trel_type = \"inside\";\n\t\trel_bytes = access_addr - object_addr;\n\t}\n\n\tpr_err(\"The buggy address is located %d bytes %s of\\n\"\n\t       \" %d-byte region [%px, %px)\\n\",\n\t\trel_bytes, rel_type, cache->object_size, (void *)object_addr,\n\t\t(void *)(object_addr + cache->object_size));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"\\n\""
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_track",
          "args": [
            "&alloc_info->free_track",
            "\"Freed\""
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "print_track",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "184-195",
          "snippet": "static void print_track(struct kasan_track *track, const char *prefix)\n{\n\tpr_err(\"%s by task %u:\\n\", prefix, track->pid);\n\tif (track->stack) {\n\t\tstruct stack_trace trace;\n\n\t\tdepot_fetch_stack(track->stack, &trace);\n\t\tprint_stack_trace(&trace, 0);\n\t} else {\n\t\tpr_err(\"(stack is not available)\\n\");\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void print_track(struct kasan_track *track, const char *prefix)\n{\n\tpr_err(\"%s by task %u:\\n\", prefix, track->pid);\n\tif (track->stack) {\n\t\tstruct stack_trace trace;\n\n\t\tdepot_fetch_stack(track->stack, &trace);\n\t\tprint_stack_trace(&trace, 0);\n\t} else {\n\t\tpr_err(\"(stack is not available)\\n\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"\\n\""
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_alloc_info",
          "args": [
            "cache",
            "object"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "get_alloc_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "463-468",
          "snippet": "struct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstruct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void describe_object(struct kmem_cache *cache, void *object,\n\t\t\t\tconst void *addr)\n{\n\tstruct kasan_alloc_meta *alloc_info = get_alloc_info(cache, object);\n\n\tif (cache->flags & SLAB_KASAN) {\n\t\tprint_track(&alloc_info->alloc_track, \"Allocated\");\n\t\tpr_err(\"\\n\");\n\t\tprint_track(&alloc_info->free_track, \"Freed\");\n\t\tpr_err(\"\\n\");\n\t}\n\n\tdescribe_object_addr(cache, object, addr);\n}"
  },
  {
    "function_name": "describe_object_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "205-235",
    "snippet": "static void describe_object_addr(struct kmem_cache *cache, void *object,\n\t\t\t\tconst void *addr)\n{\n\tunsigned long access_addr = (unsigned long)addr;\n\tunsigned long object_addr = (unsigned long)object;\n\tconst char *rel_type;\n\tint rel_bytes;\n\n\tpr_err(\"The buggy address belongs to the object at %px\\n\"\n\t       \" which belongs to the cache %s of size %d\\n\",\n\t\tobject, cache->name, cache->object_size);\n\n\tif (!addr)\n\t\treturn;\n\n\tif (access_addr < object_addr) {\n\t\trel_type = \"to the left\";\n\t\trel_bytes = object_addr - access_addr;\n\t} else if (access_addr >= object_addr + cache->object_size) {\n\t\trel_type = \"to the right\";\n\t\trel_bytes = access_addr - (object_addr + cache->object_size);\n\t} else {\n\t\trel_type = \"inside\";\n\t\trel_bytes = access_addr - object_addr;\n\t}\n\n\tpr_err(\"The buggy address is located %d bytes %s of\\n\"\n\t       \" %d-byte region [%px, %px)\\n\",\n\t\trel_bytes, rel_type, cache->object_size, (void *)object_addr,\n\t\t(void *)(object_addr + cache->object_size));\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"The buggy address is located %d bytes %s of\\n\"\n\t       \" %d-byte region [%px, %px)\\n\"",
            "rel_bytes",
            "rel_type",
            "cache->object_size",
            "(void *)object_addr",
            "(void *)(object_addr + cache->object_size)"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"The buggy address belongs to the object at %px\\n\"\n\t       \" which belongs to the cache %s of size %d\\n\"",
            "object",
            "cache->name",
            "cache->object_size"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void describe_object_addr(struct kmem_cache *cache, void *object,\n\t\t\t\tconst void *addr)\n{\n\tunsigned long access_addr = (unsigned long)addr;\n\tunsigned long object_addr = (unsigned long)object;\n\tconst char *rel_type;\n\tint rel_bytes;\n\n\tpr_err(\"The buggy address belongs to the object at %px\\n\"\n\t       \" which belongs to the cache %s of size %d\\n\",\n\t\tobject, cache->name, cache->object_size);\n\n\tif (!addr)\n\t\treturn;\n\n\tif (access_addr < object_addr) {\n\t\trel_type = \"to the left\";\n\t\trel_bytes = object_addr - access_addr;\n\t} else if (access_addr >= object_addr + cache->object_size) {\n\t\trel_type = \"to the right\";\n\t\trel_bytes = access_addr - (object_addr + cache->object_size);\n\t} else {\n\t\trel_type = \"inside\";\n\t\trel_bytes = access_addr - object_addr;\n\t}\n\n\tpr_err(\"The buggy address is located %d bytes %s of\\n\"\n\t       \" %d-byte region [%px, %px)\\n\",\n\t\trel_bytes, rel_type, cache->object_size, (void *)object_addr,\n\t\t(void *)(object_addr + cache->object_size));\n}"
  },
  {
    "function_name": "addr_to_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "197-203",
    "snippet": "static struct page *addr_to_page(const void *addr)\n{\n\tif ((addr >= (void *)PAGE_OFFSET) &&\n\t\t\t(addr < high_memory))\n\t\treturn virt_to_head_page(addr);\n\treturn NULL;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_head_page",
          "args": [
            "addr"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic struct page *addr_to_page(const void *addr)\n{\n\tif ((addr >= (void *)PAGE_OFFSET) &&\n\t\t\t(addr < high_memory))\n\t\treturn virt_to_head_page(addr);\n\treturn NULL;\n}"
  },
  {
    "function_name": "print_track",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "184-195",
    "snippet": "static void print_track(struct kasan_track *track, const char *prefix)\n{\n\tpr_err(\"%s by task %u:\\n\", prefix, track->pid);\n\tif (track->stack) {\n\t\tstruct stack_trace trace;\n\n\t\tdepot_fetch_stack(track->stack, &trace);\n\t\tprint_stack_trace(&trace, 0);\n\t} else {\n\t\tpr_err(\"(stack is not available)\\n\");\n\t}\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"(stack is not available)\\n\""
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_stack_trace",
          "args": [
            "&trace",
            "0"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "depot_fetch_stack",
          "args": [
            "track->stack",
            "&trace"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s by task %u:\\n\"",
            "prefix",
            "track->pid"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void print_track(struct kasan_track *track, const char *prefix)\n{\n\tpr_err(\"%s by task %u:\\n\", prefix, track->pid);\n\tif (track->stack) {\n\t\tstruct stack_trace trace;\n\n\t\tdepot_fetch_stack(track->stack, &trace);\n\t\tprint_stack_trace(&trace, 0);\n\t} else {\n\t\tpr_err(\"(stack is not available)\\n\");\n\t}\n}"
  },
  {
    "function_name": "kasan_end_report",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "174-182",
    "snippet": "static void kasan_end_report(unsigned long *flags)\n{\n\tpr_err(\"==================================================================\\n\");\n\tadd_taint(TAINT_BAD_PAGE, LOCKDEP_NOW_UNRELIABLE);\n\tspin_unlock_irqrestore(&report_lock, *flags);\n\tif (panic_on_warn)\n\t\tpanic(\"panic_on_warn set ...\\n\");\n\tkasan_enable_current();\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(report_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_enable_current",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_enable_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "43-46",
          "snippet": "void kasan_enable_current(void)\n{\n\tcurrent->kasan_depth++;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_enable_current(void)\n{\n\tcurrent->kasan_depth++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "panic",
          "args": [
            "\"panic_on_warn set ...\\n\""
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&report_lock",
            "*flags"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_taint",
          "args": [
            "TAINT_BAD_PAGE",
            "LOCKDEP_NOW_UNRELIABLE"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"==================================================================\\n\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic DEFINE_SPINLOCK(report_lock);\n\nstatic void kasan_end_report(unsigned long *flags)\n{\n\tpr_err(\"==================================================================\\n\");\n\tadd_taint(TAINT_BAD_PAGE, LOCKDEP_NOW_UNRELIABLE);\n\tspin_unlock_irqrestore(&report_lock, *flags);\n\tif (panic_on_warn)\n\t\tpanic(\"panic_on_warn set ...\\n\");\n\tkasan_enable_current();\n}"
  },
  {
    "function_name": "kasan_start_report",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "164-172",
    "snippet": "static void kasan_start_report(unsigned long *flags)\n{\n\t/*\n\t * Make sure we don't end up in loop.\n\t */\n\tkasan_disable_current();\n\tspin_lock_irqsave(&report_lock, *flags);\n\tpr_err(\"==================================================================\\n\");\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(report_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"==================================================================\\n\""
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&report_lock",
            "*flags"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_disable_current",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_disable_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "48-51",
          "snippet": "void kasan_disable_current(void)\n{\n\tcurrent->kasan_depth--;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_disable_current(void)\n{\n\tcurrent->kasan_depth--;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic DEFINE_SPINLOCK(report_lock);\n\nstatic void kasan_start_report(unsigned long *flags)\n{\n\t/*\n\t * Make sure we don't end up in loop.\n\t */\n\tkasan_disable_current();\n\tspin_lock_irqsave(&report_lock, *flags);\n\tpr_err(\"==================================================================\\n\");\n}"
  },
  {
    "function_name": "init_task_stack_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "155-160",
    "snippet": "static inline bool init_task_stack_addr(const void *addr)\n{\n\treturn addr >= (void *)&init_thread_union.stack &&\n\t\t(addr <= (void *)&init_thread_union.stack +\n\t\t\tsizeof(init_thread_union.stack));\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic inline bool init_task_stack_addr(const void *addr)\n{\n\treturn addr >= (void *)&init_thread_union.stack &&\n\t\t(addr <= (void *)&init_thread_union.stack +\n\t\t\tsizeof(init_thread_union.stack));\n}"
  },
  {
    "function_name": "kernel_or_module_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "146-153",
    "snippet": "static inline bool kernel_or_module_addr(const void *addr)\n{\n\tif (addr >= (void *)_stext && addr < (void *)_end)\n\t\treturn true;\n\tif (is_module_address((unsigned long)addr))\n\t\treturn true;\n\treturn false;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_module_address",
          "args": [
            "(unsigned long)addr"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic inline bool kernel_or_module_addr(const void *addr)\n{\n\tif (addr >= (void *)_stext && addr < (void *)_end)\n\t\treturn true;\n\tif (is_module_address((unsigned long)addr))\n\t\treturn true;\n\treturn false;\n}"
  },
  {
    "function_name": "print_error_description",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "135-144",
    "snippet": "static void print_error_description(struct kasan_access_info *info)\n{\n\tconst char *bug_type = get_bug_type(info);\n\n\tpr_err(\"BUG: KASAN: %s in %pS\\n\",\n\t\tbug_type, (void *)info->ip);\n\tpr_err(\"%s of size %zu at addr %px by task %s/%d\\n\",\n\t\tinfo->is_write ? \"Write\" : \"Read\", info->access_size,\n\t\tinfo->access_addr, current->comm, task_pid_nr(current));\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s of size %zu at addr %px by task %s/%d\\n\"",
            "info->is_write ? \"Write\" : \"Read\"",
            "info->access_size",
            "info->access_addr",
            "current->comm",
            "task_pid_nr(current)"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "current"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"BUG: KASAN: %s in %pS\\n\"",
            "bug_type",
            "(void *)info->ip"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_bug_type",
          "args": [
            "info"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "get_bug_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "128-133",
          "snippet": "static const char *get_bug_type(struct kasan_access_info *info)\n{\n\tif (addr_has_shadow(info))\n\t\treturn get_shadow_bug_type(info);\n\treturn get_wild_bug_type(info);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic const char *get_bug_type(struct kasan_access_info *info)\n{\n\tif (addr_has_shadow(info))\n\t\treturn get_shadow_bug_type(info);\n\treturn get_wild_bug_type(info);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic void print_error_description(struct kasan_access_info *info)\n{\n\tconst char *bug_type = get_bug_type(info);\n\n\tpr_err(\"BUG: KASAN: %s in %pS\\n\",\n\t\tbug_type, (void *)info->ip);\n\tpr_err(\"%s of size %zu at addr %px by task %s/%d\\n\",\n\t\tinfo->is_write ? \"Write\" : \"Read\", info->access_size,\n\t\tinfo->access_addr, current->comm, task_pid_nr(current));\n}"
  },
  {
    "function_name": "get_bug_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "128-133",
    "snippet": "static const char *get_bug_type(struct kasan_access_info *info)\n{\n\tif (addr_has_shadow(info))\n\t\treturn get_shadow_bug_type(info);\n\treturn get_wild_bug_type(info);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_wild_bug_type",
          "args": [
            "info"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "get_wild_bug_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "114-126",
          "snippet": "static const char *get_wild_bug_type(struct kasan_access_info *info)\n{\n\tconst char *bug_type = \"unknown-crash\";\n\n\tif ((unsigned long)info->access_addr < PAGE_SIZE)\n\t\tbug_type = \"null-ptr-deref\";\n\telse if ((unsigned long)info->access_addr < TASK_SIZE)\n\t\tbug_type = \"user-memory-access\";\n\telse\n\t\tbug_type = \"wild-memory-access\";\n\n\treturn bug_type;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic const char *get_wild_bug_type(struct kasan_access_info *info)\n{\n\tconst char *bug_type = \"unknown-crash\";\n\n\tif ((unsigned long)info->access_addr < PAGE_SIZE)\n\t\tbug_type = \"null-ptr-deref\";\n\telse if ((unsigned long)info->access_addr < TASK_SIZE)\n\t\tbug_type = \"user-memory-access\";\n\telse\n\t\tbug_type = \"wild-memory-access\";\n\n\treturn bug_type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_shadow_bug_type",
          "args": [
            "info"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "get_shadow_bug_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "60-112",
          "snippet": "static const char *get_shadow_bug_type(struct kasan_access_info *info)\n{\n\tconst char *bug_type = \"unknown-crash\";\n\tu8 *shadow_addr;\n\n\tinfo->first_bad_addr = find_first_bad_addr(info->access_addr,\n\t\t\t\t\t\tinfo->access_size);\n\n\tshadow_addr = (u8 *)kasan_mem_to_shadow(info->first_bad_addr);\n\n\t/*\n\t * If shadow byte value is in [0, KASAN_SHADOW_SCALE_SIZE) we can look\n\t * at the next shadow byte to determine the type of the bad access.\n\t */\n\tif (*shadow_addr > 0 && *shadow_addr <= KASAN_SHADOW_SCALE_SIZE - 1)\n\t\tshadow_addr++;\n\n\tswitch (*shadow_addr) {\n\tcase 0 ... KASAN_SHADOW_SCALE_SIZE - 1:\n\t\t/*\n\t\t * In theory it's still possible to see these shadow values\n\t\t * due to a data race in the kernel code.\n\t\t */\n\t\tbug_type = \"out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_PAGE_REDZONE:\n\tcase KASAN_KMALLOC_REDZONE:\n\t\tbug_type = \"slab-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_GLOBAL_REDZONE:\n\t\tbug_type = \"global-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_STACK_LEFT:\n\tcase KASAN_STACK_MID:\n\tcase KASAN_STACK_RIGHT:\n\tcase KASAN_STACK_PARTIAL:\n\t\tbug_type = \"stack-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_FREE_PAGE:\n\tcase KASAN_KMALLOC_FREE:\n\t\tbug_type = \"use-after-free\";\n\t\tbreak;\n\tcase KASAN_USE_AFTER_SCOPE:\n\t\tbug_type = \"use-after-scope\";\n\t\tbreak;\n\tcase KASAN_ALLOCA_LEFT:\n\tcase KASAN_ALLOCA_RIGHT:\n\t\tbug_type = \"alloca-out-of-bounds\";\n\t\tbreak;\n\t}\n\n\treturn bug_type;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic const char *get_shadow_bug_type(struct kasan_access_info *info)\n{\n\tconst char *bug_type = \"unknown-crash\";\n\tu8 *shadow_addr;\n\n\tinfo->first_bad_addr = find_first_bad_addr(info->access_addr,\n\t\t\t\t\t\tinfo->access_size);\n\n\tshadow_addr = (u8 *)kasan_mem_to_shadow(info->first_bad_addr);\n\n\t/*\n\t * If shadow byte value is in [0, KASAN_SHADOW_SCALE_SIZE) we can look\n\t * at the next shadow byte to determine the type of the bad access.\n\t */\n\tif (*shadow_addr > 0 && *shadow_addr <= KASAN_SHADOW_SCALE_SIZE - 1)\n\t\tshadow_addr++;\n\n\tswitch (*shadow_addr) {\n\tcase 0 ... KASAN_SHADOW_SCALE_SIZE - 1:\n\t\t/*\n\t\t * In theory it's still possible to see these shadow values\n\t\t * due to a data race in the kernel code.\n\t\t */\n\t\tbug_type = \"out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_PAGE_REDZONE:\n\tcase KASAN_KMALLOC_REDZONE:\n\t\tbug_type = \"slab-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_GLOBAL_REDZONE:\n\t\tbug_type = \"global-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_STACK_LEFT:\n\tcase KASAN_STACK_MID:\n\tcase KASAN_STACK_RIGHT:\n\tcase KASAN_STACK_PARTIAL:\n\t\tbug_type = \"stack-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_FREE_PAGE:\n\tcase KASAN_KMALLOC_FREE:\n\t\tbug_type = \"use-after-free\";\n\t\tbreak;\n\tcase KASAN_USE_AFTER_SCOPE:\n\t\tbug_type = \"use-after-scope\";\n\t\tbreak;\n\tcase KASAN_ALLOCA_LEFT:\n\tcase KASAN_ALLOCA_RIGHT:\n\t\tbug_type = \"alloca-out-of-bounds\";\n\t\tbreak;\n\t}\n\n\treturn bug_type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "addr_has_shadow",
          "args": [
            "info"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "addr_has_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "54-58",
          "snippet": "static bool addr_has_shadow(struct kasan_access_info *info)\n{\n\treturn (info->access_addr >=\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START));\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic bool addr_has_shadow(struct kasan_access_info *info)\n{\n\treturn (info->access_addr >=\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic const char *get_bug_type(struct kasan_access_info *info)\n{\n\tif (addr_has_shadow(info))\n\t\treturn get_shadow_bug_type(info);\n\treturn get_wild_bug_type(info);\n}"
  },
  {
    "function_name": "get_wild_bug_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "114-126",
    "snippet": "static const char *get_wild_bug_type(struct kasan_access_info *info)\n{\n\tconst char *bug_type = \"unknown-crash\";\n\n\tif ((unsigned long)info->access_addr < PAGE_SIZE)\n\t\tbug_type = \"null-ptr-deref\";\n\telse if ((unsigned long)info->access_addr < TASK_SIZE)\n\t\tbug_type = \"user-memory-access\";\n\telse\n\t\tbug_type = \"wild-memory-access\";\n\n\treturn bug_type;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic const char *get_wild_bug_type(struct kasan_access_info *info)\n{\n\tconst char *bug_type = \"unknown-crash\";\n\n\tif ((unsigned long)info->access_addr < PAGE_SIZE)\n\t\tbug_type = \"null-ptr-deref\";\n\telse if ((unsigned long)info->access_addr < TASK_SIZE)\n\t\tbug_type = \"user-memory-access\";\n\telse\n\t\tbug_type = \"wild-memory-access\";\n\n\treturn bug_type;\n}"
  },
  {
    "function_name": "get_shadow_bug_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "60-112",
    "snippet": "static const char *get_shadow_bug_type(struct kasan_access_info *info)\n{\n\tconst char *bug_type = \"unknown-crash\";\n\tu8 *shadow_addr;\n\n\tinfo->first_bad_addr = find_first_bad_addr(info->access_addr,\n\t\t\t\t\t\tinfo->access_size);\n\n\tshadow_addr = (u8 *)kasan_mem_to_shadow(info->first_bad_addr);\n\n\t/*\n\t * If shadow byte value is in [0, KASAN_SHADOW_SCALE_SIZE) we can look\n\t * at the next shadow byte to determine the type of the bad access.\n\t */\n\tif (*shadow_addr > 0 && *shadow_addr <= KASAN_SHADOW_SCALE_SIZE - 1)\n\t\tshadow_addr++;\n\n\tswitch (*shadow_addr) {\n\tcase 0 ... KASAN_SHADOW_SCALE_SIZE - 1:\n\t\t/*\n\t\t * In theory it's still possible to see these shadow values\n\t\t * due to a data race in the kernel code.\n\t\t */\n\t\tbug_type = \"out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_PAGE_REDZONE:\n\tcase KASAN_KMALLOC_REDZONE:\n\t\tbug_type = \"slab-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_GLOBAL_REDZONE:\n\t\tbug_type = \"global-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_STACK_LEFT:\n\tcase KASAN_STACK_MID:\n\tcase KASAN_STACK_RIGHT:\n\tcase KASAN_STACK_PARTIAL:\n\t\tbug_type = \"stack-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_FREE_PAGE:\n\tcase KASAN_KMALLOC_FREE:\n\t\tbug_type = \"use-after-free\";\n\t\tbreak;\n\tcase KASAN_USE_AFTER_SCOPE:\n\t\tbug_type = \"use-after-scope\";\n\t\tbreak;\n\tcase KASAN_ALLOCA_LEFT:\n\tcase KASAN_ALLOCA_RIGHT:\n\t\tbug_type = \"alloca-out-of-bounds\";\n\t\tbreak;\n\t}\n\n\treturn bug_type;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "info->first_bad_addr"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_first_bad_addr",
          "args": [
            "info->access_addr",
            "info->access_size"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "find_first_bad_addr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "42-52",
          "snippet": "static const void *find_first_bad_addr(const void *addr, size_t size)\n{\n\tu8 shadow_val = *(u8 *)kasan_mem_to_shadow(addr);\n\tconst void *first_bad_addr = addr;\n\n\twhile (!shadow_val && first_bad_addr < addr + size) {\n\t\tfirst_bad_addr += KASAN_SHADOW_SCALE_SIZE;\n\t\tshadow_val = *(u8 *)kasan_mem_to_shadow(first_bad_addr);\n\t}\n\treturn first_bad_addr;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic const void *find_first_bad_addr(const void *addr, size_t size)\n{\n\tu8 shadow_val = *(u8 *)kasan_mem_to_shadow(addr);\n\tconst void *first_bad_addr = addr;\n\n\twhile (!shadow_val && first_bad_addr < addr + size) {\n\t\tfirst_bad_addr += KASAN_SHADOW_SCALE_SIZE;\n\t\tshadow_val = *(u8 *)kasan_mem_to_shadow(first_bad_addr);\n\t}\n\treturn first_bad_addr;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic const char *get_shadow_bug_type(struct kasan_access_info *info)\n{\n\tconst char *bug_type = \"unknown-crash\";\n\tu8 *shadow_addr;\n\n\tinfo->first_bad_addr = find_first_bad_addr(info->access_addr,\n\t\t\t\t\t\tinfo->access_size);\n\n\tshadow_addr = (u8 *)kasan_mem_to_shadow(info->first_bad_addr);\n\n\t/*\n\t * If shadow byte value is in [0, KASAN_SHADOW_SCALE_SIZE) we can look\n\t * at the next shadow byte to determine the type of the bad access.\n\t */\n\tif (*shadow_addr > 0 && *shadow_addr <= KASAN_SHADOW_SCALE_SIZE - 1)\n\t\tshadow_addr++;\n\n\tswitch (*shadow_addr) {\n\tcase 0 ... KASAN_SHADOW_SCALE_SIZE - 1:\n\t\t/*\n\t\t * In theory it's still possible to see these shadow values\n\t\t * due to a data race in the kernel code.\n\t\t */\n\t\tbug_type = \"out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_PAGE_REDZONE:\n\tcase KASAN_KMALLOC_REDZONE:\n\t\tbug_type = \"slab-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_GLOBAL_REDZONE:\n\t\tbug_type = \"global-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_STACK_LEFT:\n\tcase KASAN_STACK_MID:\n\tcase KASAN_STACK_RIGHT:\n\tcase KASAN_STACK_PARTIAL:\n\t\tbug_type = \"stack-out-of-bounds\";\n\t\tbreak;\n\tcase KASAN_FREE_PAGE:\n\tcase KASAN_KMALLOC_FREE:\n\t\tbug_type = \"use-after-free\";\n\t\tbreak;\n\tcase KASAN_USE_AFTER_SCOPE:\n\t\tbug_type = \"use-after-scope\";\n\t\tbreak;\n\tcase KASAN_ALLOCA_LEFT:\n\tcase KASAN_ALLOCA_RIGHT:\n\t\tbug_type = \"alloca-out-of-bounds\";\n\t\tbreak;\n\t}\n\n\treturn bug_type;\n}"
  },
  {
    "function_name": "addr_has_shadow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "54-58",
    "snippet": "static bool addr_has_shadow(struct kasan_access_info *info)\n{\n\treturn (info->access_addr >=\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START));\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_shadow_to_mem",
          "args": [
            "(void *)KASAN_SHADOW_START"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_shadow_to_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.h",
          "lines": "102-106",
          "snippet": "static inline const void *kasan_shadow_to_mem(const void *shadow_addr)\n{\n\treturn (void *)(((unsigned long)shadow_addr - KASAN_SHADOW_OFFSET)\n\t\t<< KASAN_SHADOW_SCALE_SHIFT);\n}",
          "includes": [
            "#include <linux/stackdepot.h>",
            "#include <linux/kasan.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/stackdepot.h>\n#include <linux/kasan.h>\n\nstatic inline const void *kasan_shadow_to_mem(const void *shadow_addr)\n{\n\treturn (void *)(((unsigned long)shadow_addr - KASAN_SHADOW_OFFSET)\n\t\t<< KASAN_SHADOW_SCALE_SHIFT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic bool addr_has_shadow(struct kasan_access_info *info)\n{\n\treturn (info->access_addr >=\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START));\n}"
  },
  {
    "function_name": "find_first_bad_addr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
    "lines": "42-52",
    "snippet": "static const void *find_first_bad_addr(const void *addr, size_t size)\n{\n\tu8 shadow_val = *(u8 *)kasan_mem_to_shadow(addr);\n\tconst void *first_bad_addr = addr;\n\n\twhile (!shadow_val && first_bad_addr < addr + size) {\n\t\tfirst_bad_addr += KASAN_SHADOW_SCALE_SIZE;\n\t\tshadow_val = *(u8 *)kasan_mem_to_shadow(first_bad_addr);\n\t}\n\treturn first_bad_addr;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <asm/sections.h>",
      "#include <linux/module.h>",
      "#include <linux/kasan.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/stackdepot.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/init.h>",
      "#include <linux/ftrace.h>",
      "#include <linux/bitops.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "first_bad_addr"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "addr"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nstatic const void *find_first_bad_addr(const void *addr, size_t size)\n{\n\tu8 shadow_val = *(u8 *)kasan_mem_to_shadow(addr);\n\tconst void *first_bad_addr = addr;\n\n\twhile (!shadow_val && first_bad_addr < addr + size) {\n\t\tfirst_bad_addr += KASAN_SHADOW_SCALE_SIZE;\n\t\tshadow_val = *(u8 *)kasan_mem_to_shadow(first_bad_addr);\n\t}\n\treturn first_bad_addr;\n}"
  }
]