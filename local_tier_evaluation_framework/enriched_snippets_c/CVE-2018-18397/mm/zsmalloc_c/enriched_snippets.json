[
  {
    "function_name": "zs_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2525-2534",
    "snippet": "static void __exit zs_exit(void)\n{\n#ifdef CONFIG_ZPOOL\n\tzpool_unregister_driver(&zs_zpool_driver);\n#endif\n\tzsmalloc_unmount();\n\tcpuhp_remove_state(CPUHP_MM_ZS_PREPARE);\n\n\tzs_stat_exit();\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_stat_exit",
          "args": [],
          "line": 2533
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "685-687",
          "snippet": "static void __exit zs_stat_exit(void)\n{\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __exit zs_stat_exit(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuhp_remove_state",
          "args": [
            "CPUHP_MM_ZS_PREPARE"
          ],
          "line": 2531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zsmalloc_unmount",
          "args": [],
          "line": 2530
        },
        "resolved": true,
        "details": {
          "function_name": "zsmalloc_unmount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1844-1847",
          "snippet": "static void zsmalloc_unmount(void)\n{\n\tkern_unmount(zsmalloc_mnt);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zsmalloc_unmount(void)\n{\n\tkern_unmount(zsmalloc_mnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_unregister_driver",
          "args": [
            "&zs_zpool_driver"
          ],
          "line": 2528
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_unregister_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "58-72",
          "snippet": "int zpool_unregister_driver(struct zpool_driver *driver)\n{\n\tint ret = 0, refcount;\n\n\tspin_lock(&drivers_lock);\n\trefcount = atomic_read(&driver->refcount);\n\tWARN_ON(refcount < 0);\n\tif (refcount > 0)\n\t\tret = -EBUSY;\n\telse\n\t\tlist_del(&driver->list);\n\tspin_unlock(&drivers_lock);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(drivers_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(drivers_lock);\n\nint zpool_unregister_driver(struct zpool_driver *driver)\n{\n\tint ret = 0, refcount;\n\n\tspin_lock(&drivers_lock);\n\trefcount = atomic_read(&driver->refcount);\n\tWARN_ON(refcount < 0);\n\tif (refcount > 0)\n\t\tret = -EBUSY;\n\telse\n\t\tlist_del(&driver->list);\n\tspin_unlock(&drivers_lock);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __exit zs_exit(void)\n{\n#ifdef CONFIG_ZPOOL\n\tzpool_unregister_driver(&zs_zpool_driver);\n#endif\n\tzsmalloc_unmount();\n\tcpuhp_remove_state(CPUHP_MM_ZS_PREPARE);\n\n\tzs_stat_exit();\n}"
  },
  {
    "function_name": "zs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2498-2523",
    "snippet": "static int __init zs_init(void)\n{\n\tint ret;\n\n\tret = zsmalloc_mount();\n\tif (ret)\n\t\tgoto out;\n\n\tret = cpuhp_setup_state(CPUHP_MM_ZS_PREPARE, \"mm/zsmalloc:prepare\",\n\t\t\t\tzs_cpu_prepare, zs_cpu_dead);\n\tif (ret)\n\t\tgoto hp_setup_fail;\n\n#ifdef CONFIG_ZPOOL\n\tzpool_register_driver(&zs_zpool_driver);\n#endif\n\n\tzs_stat_init();\n\n\treturn 0;\n\nhp_setup_fail:\n\tzsmalloc_unmount();\nout:\n\treturn ret;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zsmalloc_unmount",
          "args": [],
          "line": 2520
        },
        "resolved": true,
        "details": {
          "function_name": "zsmalloc_unmount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1844-1847",
          "snippet": "static void zsmalloc_unmount(void)\n{\n\tkern_unmount(zsmalloc_mnt);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zsmalloc_unmount(void)\n{\n\tkern_unmount(zsmalloc_mnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_stat_init",
          "args": [],
          "line": 2515
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "681-683",
          "snippet": "static void __init zs_stat_init(void)\n{\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __init zs_stat_init(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_register_driver",
          "args": [
            "&zs_zpool_driver"
          ],
          "line": 2512
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_register_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "39-45",
          "snippet": "void zpool_register_driver(struct zpool_driver *driver)\n{\n\tspin_lock(&drivers_lock);\n\tatomic_set(&driver->refcount, 0);\n\tlist_add(&driver->list, &drivers_head);\n\tspin_unlock(&drivers_lock);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(drivers_head);",
            "static DEFINE_SPINLOCK(drivers_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic LIST_HEAD(drivers_head);\nstatic DEFINE_SPINLOCK(drivers_lock);\n\nvoid zpool_register_driver(struct zpool_driver *driver)\n{\n\tspin_lock(&drivers_lock);\n\tatomic_set(&driver->refcount, 0);\n\tlist_add(&driver->list, &drivers_head);\n\tspin_unlock(&drivers_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuhp_setup_state",
          "args": [
            "CPUHP_MM_ZS_PREPARE",
            "\"mm/zsmalloc:prepare\"",
            "zs_cpu_prepare",
            "zs_cpu_dead"
          ],
          "line": 2506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zsmalloc_mount",
          "args": [],
          "line": 2502
        },
        "resolved": true,
        "details": {
          "function_name": "zsmalloc_mount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1833-1842",
          "snippet": "static int zsmalloc_mount(void)\n{\n\tint ret = 0;\n\n\tzsmalloc_mnt = kern_mount(&zsmalloc_fs);\n\tif (IS_ERR(zsmalloc_mnt))\n\t\tret = PTR_ERR(zsmalloc_mnt);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zsmalloc_mount(void)\n{\n\tint ret = 0;\n\n\tzsmalloc_mnt = kern_mount(&zsmalloc_fs);\n\tif (IS_ERR(zsmalloc_mnt))\n\t\tret = PTR_ERR(zsmalloc_mnt);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int __init zs_init(void)\n{\n\tint ret;\n\n\tret = zsmalloc_mount();\n\tif (ret)\n\t\tgoto out;\n\n\tret = cpuhp_setup_state(CPUHP_MM_ZS_PREPARE, \"mm/zsmalloc:prepare\",\n\t\t\t\tzs_cpu_prepare, zs_cpu_dead);\n\tif (ret)\n\t\tgoto hp_setup_fail;\n\n#ifdef CONFIG_ZPOOL\n\tzpool_register_driver(&zs_zpool_driver);\n#endif\n\n\tzs_stat_init();\n\n\treturn 0;\n\nhp_setup_fail:\n\tzsmalloc_unmount();\nout:\n\treturn ret;\n}"
  },
  {
    "function_name": "zs_destroy_pool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2465-2495",
    "snippet": "void zs_destroy_pool(struct zs_pool *pool)\n{\n\tint i;\n\n\tzs_unregister_shrinker(pool);\n\tzs_unregister_migration(pool);\n\tzs_pool_stat_destroy(pool);\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tint fg;\n\t\tstruct size_class *class = pool->size_class[i];\n\n\t\tif (!class)\n\t\t\tcontinue;\n\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tfor (fg = ZS_EMPTY; fg < NR_ZS_FULLNESS; fg++) {\n\t\t\tif (!list_empty(&class->fullness_list[fg])) {\n\t\t\t\tpr_info(\"Freeing non-empty class with size %db, fullness group %d\\n\",\n\t\t\t\t\tclass->size, fg);\n\t\t\t}\n\t\t}\n\t\tkfree(class);\n\t}\n\n\tdestroy_cache(pool);\n\tkfree(pool->name);\n\tkfree(pool);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "pool"
          ],
          "line": 2494
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "destroy_cache",
          "args": [
            "pool"
          ],
          "line": 2492
        },
        "resolved": true,
        "details": {
          "function_name": "destroy_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "339-343",
          "snippet": "static void destroy_cache(struct zs_pool *pool)\n{\n\tkmem_cache_destroy(pool->handle_cachep);\n\tkmem_cache_destroy(pool->zspage_cachep);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void destroy_cache(struct zs_pool *pool)\n{\n\tkmem_cache_destroy(pool->handle_cachep);\n\tkmem_cache_destroy(pool->zspage_cachep);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Freeing non-empty class with size %db, fullness group %d\\n\"",
            "class->size",
            "fg"
          ],
          "line": 2485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&class->fullness_list[fg]"
          ],
          "line": 2484
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_pool_stat_destroy",
          "args": [
            "pool"
          ],
          "line": 2471
        },
        "resolved": true,
        "details": {
          "function_name": "zs_pool_stat_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "693-695",
          "snippet": "static inline void zs_pool_stat_destroy(struct zs_pool *pool)\n{\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_pool_stat_destroy(struct zs_pool *pool)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_unregister_migration",
          "args": [
            "pool"
          ],
          "line": 2470
        },
        "resolved": true,
        "details": {
          "function_name": "zs_unregister_migration",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2130-2134",
          "snippet": "static void zs_unregister_migration(struct zs_pool *pool)\n{\n\tflush_work(&pool->free_work);\n\tiput(pool->inode);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_unregister_migration(struct zs_pool *pool)\n{\n\tflush_work(&pool->free_work);\n\tiput(pool->inode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_unregister_shrinker",
          "args": [
            "pool"
          ],
          "line": 2469
        },
        "resolved": true,
        "details": {
          "function_name": "zs_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2328-2331",
          "snippet": "static void zs_unregister_shrinker(struct zs_pool *pool)\n{\n\tunregister_shrinker(&pool->shrinker);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_unregister_shrinker(struct zs_pool *pool)\n{\n\tunregister_shrinker(&pool->shrinker);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n\nvoid zs_destroy_pool(struct zs_pool *pool)\n{\n\tint i;\n\n\tzs_unregister_shrinker(pool);\n\tzs_unregister_migration(pool);\n\tzs_pool_stat_destroy(pool);\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tint fg;\n\t\tstruct size_class *class = pool->size_class[i];\n\n\t\tif (!class)\n\t\t\tcontinue;\n\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tfor (fg = ZS_EMPTY; fg < NR_ZS_FULLNESS; fg++) {\n\t\t\tif (!list_empty(&class->fullness_list[fg])) {\n\t\t\t\tpr_info(\"Freeing non-empty class with size %db, fullness group %d\\n\",\n\t\t\t\t\tclass->size, fg);\n\t\t\t}\n\t\t}\n\t\tkfree(class);\n\t}\n\n\tdestroy_cache(pool);\n\tkfree(pool->name);\n\tkfree(pool);\n}"
  },
  {
    "function_name": "zs_create_pool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2353-2462",
    "snippet": "struct zs_pool *zs_create_pool(const char *name)\n{\n\tint i;\n\tstruct zs_pool *pool;\n\tstruct size_class *prev_class = NULL;\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\tinit_deferred_free(pool);\n\n\tpool->name = kstrdup(name, GFP_KERNEL);\n\tif (!pool->name)\n\t\tgoto err;\n\n\tif (create_cache(pool))\n\t\tgoto err;\n\n\t/*\n\t * Iterate reversely, because, size of size_class that we want to use\n\t * for merging should be larger or equal to current size.\n\t */\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tint size;\n\t\tint pages_per_zspage;\n\t\tint objs_per_zspage;\n\t\tstruct size_class *class;\n\t\tint fullness = 0;\n\n\t\tsize = ZS_MIN_ALLOC_SIZE + i * ZS_SIZE_CLASS_DELTA;\n\t\tif (size > ZS_MAX_ALLOC_SIZE)\n\t\t\tsize = ZS_MAX_ALLOC_SIZE;\n\t\tpages_per_zspage = get_pages_per_zspage(size);\n\t\tobjs_per_zspage = pages_per_zspage * PAGE_SIZE / size;\n\n\t\t/*\n\t\t * We iterate from biggest down to smallest classes,\n\t\t * so huge_class_size holds the size of the first huge\n\t\t * class. Any object bigger than or equal to that will\n\t\t * endup in the huge class.\n\t\t */\n\t\tif (pages_per_zspage != 1 && objs_per_zspage != 1 &&\n\t\t\t\t!huge_class_size) {\n\t\t\thuge_class_size = size;\n\t\t\t/*\n\t\t\t * The object uses ZS_HANDLE_SIZE bytes to store the\n\t\t\t * handle. We need to subtract it, because zs_malloc()\n\t\t\t * unconditionally adds handle size before it performs\n\t\t\t * size class search - so object may be smaller than\n\t\t\t * huge class size, yet it still can end up in the huge\n\t\t\t * class because it grows by ZS_HANDLE_SIZE extra bytes\n\t\t\t * right before class lookup.\n\t\t\t */\n\t\t\thuge_class_size -= (ZS_HANDLE_SIZE - 1);\n\t\t}\n\n\t\t/*\n\t\t * size_class is used for normal zsmalloc operation such\n\t\t * as alloc/free for that size. Although it is natural that we\n\t\t * have one size_class for each size, there is a chance that we\n\t\t * can get more memory utilization if we use one size_class for\n\t\t * many different sizes whose size_class have same\n\t\t * characteristics. So, we makes size_class point to\n\t\t * previous size_class if possible.\n\t\t */\n\t\tif (prev_class) {\n\t\t\tif (can_merge(prev_class, pages_per_zspage, objs_per_zspage)) {\n\t\t\t\tpool->size_class[i] = prev_class;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tclass = kzalloc(sizeof(struct size_class), GFP_KERNEL);\n\t\tif (!class)\n\t\t\tgoto err;\n\n\t\tclass->size = size;\n\t\tclass->index = i;\n\t\tclass->pages_per_zspage = pages_per_zspage;\n\t\tclass->objs_per_zspage = objs_per_zspage;\n\t\tspin_lock_init(&class->lock);\n\t\tpool->size_class[i] = class;\n\t\tfor (fullness = ZS_EMPTY; fullness < NR_ZS_FULLNESS;\n\t\t\t\t\t\t\tfullness++)\n\t\t\tINIT_LIST_HEAD(&class->fullness_list[fullness]);\n\n\t\tprev_class = class;\n\t}\n\n\t/* debug only, don't abort if it fails */\n\tzs_pool_stat_create(pool, name);\n\n\tif (zs_register_migration(pool))\n\t\tgoto err;\n\n\t/*\n\t * Not critical since shrinker is only used to trigger internal\n\t * defragmentation of the pool which is pretty optional thing.  If\n\t * registration fails we still can use the pool normally and user can\n\t * trigger compaction manually. Thus, ignore return code.\n\t */\n\tzs_register_shrinker(pool);\n\n\treturn pool;\n\nerr:\n\tzs_destroy_pool(pool);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)",
      "#define ZS_SIZE_CLASS_DELTA\t(PAGE_SIZE >> CLASS_BITS)",
      "#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE",
      "#define ZS_MIN_ALLOC_SIZE \\\n\tMAX(32, (ZS_MAX_PAGES_PER_ZSPAGE << PAGE_SHIFT >> OBJ_INDEX_BITS))",
      "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
    ],
    "globals_used": [
      "static size_t huge_class_size;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_destroy_pool",
          "args": [
            "pool"
          ],
          "line": 2460
        },
        "resolved": true,
        "details": {
          "function_name": "zs_destroy_pool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2465-2495",
          "snippet": "void zs_destroy_pool(struct zs_pool *pool)\n{\n\tint i;\n\n\tzs_unregister_shrinker(pool);\n\tzs_unregister_migration(pool);\n\tzs_pool_stat_destroy(pool);\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tint fg;\n\t\tstruct size_class *class = pool->size_class[i];\n\n\t\tif (!class)\n\t\t\tcontinue;\n\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tfor (fg = ZS_EMPTY; fg < NR_ZS_FULLNESS; fg++) {\n\t\t\tif (!list_empty(&class->fullness_list[fg])) {\n\t\t\t\tpr_info(\"Freeing non-empty class with size %db, fullness group %d\\n\",\n\t\t\t\t\tclass->size, fg);\n\t\t\t}\n\t\t}\n\t\tkfree(class);\n\t}\n\n\tdestroy_cache(pool);\n\tkfree(pool->name);\n\tkfree(pool);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n\nvoid zs_destroy_pool(struct zs_pool *pool)\n{\n\tint i;\n\n\tzs_unregister_shrinker(pool);\n\tzs_unregister_migration(pool);\n\tzs_pool_stat_destroy(pool);\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tint fg;\n\t\tstruct size_class *class = pool->size_class[i];\n\n\t\tif (!class)\n\t\t\tcontinue;\n\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tfor (fg = ZS_EMPTY; fg < NR_ZS_FULLNESS; fg++) {\n\t\t\tif (!list_empty(&class->fullness_list[fg])) {\n\t\t\t\tpr_info(\"Freeing non-empty class with size %db, fullness group %d\\n\",\n\t\t\t\t\tclass->size, fg);\n\t\t\t}\n\t\t}\n\t\tkfree(class);\n\t}\n\n\tdestroy_cache(pool);\n\tkfree(pool->name);\n\tkfree(pool);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_register_shrinker",
          "args": [
            "pool"
          ],
          "line": 2455
        },
        "resolved": true,
        "details": {
          "function_name": "zs_register_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2333-2341",
          "snippet": "static int zs_register_shrinker(struct zs_pool *pool)\n{\n\tpool->shrinker.scan_objects = zs_shrinker_scan;\n\tpool->shrinker.count_objects = zs_shrinker_count;\n\tpool->shrinker.batch = 0;\n\tpool->shrinker.seeks = DEFAULT_SEEKS;\n\n\treturn register_shrinker(&pool->shrinker);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zs_register_shrinker(struct zs_pool *pool)\n{\n\tpool->shrinker.scan_objects = zs_shrinker_scan;\n\tpool->shrinker.count_objects = zs_shrinker_count;\n\tpool->shrinker.batch = 0;\n\tpool->shrinker.seeks = DEFAULT_SEEKS;\n\n\treturn register_shrinker(&pool->shrinker);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_register_migration",
          "args": [
            "pool"
          ],
          "line": 2446
        },
        "resolved": true,
        "details": {
          "function_name": "zs_register_migration",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2117-2128",
          "snippet": "static int zs_register_migration(struct zs_pool *pool)\n{\n\tpool->inode = alloc_anon_inode(zsmalloc_mnt->mnt_sb);\n\tif (IS_ERR(pool->inode)) {\n\t\tpool->inode = NULL;\n\t\treturn 1;\n\t}\n\n\tpool->inode->i_mapping->private_data = pool;\n\tpool->inode->i_mapping->a_ops = &zsmalloc_aops;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zs_register_migration(struct zs_pool *pool)\n{\n\tpool->inode = alloc_anon_inode(zsmalloc_mnt->mnt_sb);\n\tif (IS_ERR(pool->inode)) {\n\t\tpool->inode = NULL;\n\t\treturn 1;\n\t}\n\n\tpool->inode->i_mapping->private_data = pool;\n\tpool->inode->i_mapping->a_ops = &zsmalloc_aops;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_pool_stat_create",
          "args": [
            "pool",
            "name"
          ],
          "line": 2444
        },
        "resolved": true,
        "details": {
          "function_name": "zs_pool_stat_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "689-691",
          "snippet": "static inline void zs_pool_stat_create(struct zs_pool *pool, const char *name)\n{\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_pool_stat_create(struct zs_pool *pool, const char *name)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&class->fullness_list[fullness]"
          ],
          "line": 2438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&class->lock"
          ],
          "line": 2434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(struct size_class)",
            "GFP_KERNEL"
          ],
          "line": 2426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "can_merge",
          "args": [
            "prev_class",
            "pages_per_zspage",
            "objs_per_zspage"
          ],
          "line": 2420
        },
        "resolved": true,
        "details": {
          "function_name": "can_merge",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1268-1276",
          "snippet": "static bool can_merge(struct size_class *prev, int pages_per_zspage,\n\t\t\t\t\tint objs_per_zspage)\n{\n\tif (prev->pages_per_zspage == pages_per_zspage &&\n\t\tprev->objs_per_zspage == objs_per_zspage)\n\t\treturn true;\n\n\treturn false;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool can_merge(struct size_class *prev, int pages_per_zspage,\n\t\t\t\t\tint objs_per_zspage)\n{\n\tif (prev->pages_per_zspage == pages_per_zspage &&\n\t\tprev->objs_per_zspage == objs_per_zspage)\n\t\treturn true;\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_pages_per_zspage",
          "args": [
            "size"
          ],
          "line": 2386
        },
        "resolved": true,
        "details": {
          "function_name": "get_pages_per_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "814-835",
          "snippet": "static int get_pages_per_zspage(int class_size)\n{\n\tint i, max_usedpc = 0;\n\t/* zspage order which gives maximum used size per KB */\n\tint max_usedpc_order = 1;\n\n\tfor (i = 1; i <= ZS_MAX_PAGES_PER_ZSPAGE; i++) {\n\t\tint zspage_size;\n\t\tint waste, usedpc;\n\n\t\tzspage_size = i * PAGE_SIZE;\n\t\twaste = zspage_size % class_size;\n\t\tusedpc = (zspage_size - waste) * 100 / zspage_size;\n\n\t\tif (usedpc > max_usedpc) {\n\t\t\tmax_usedpc = usedpc;\n\t\t\tmax_usedpc_order = i;\n\t\t}\n\t}\n\n\treturn max_usedpc_order;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)\n\nstatic int get_pages_per_zspage(int class_size)\n{\n\tint i, max_usedpc = 0;\n\t/* zspage order which gives maximum used size per KB */\n\tint max_usedpc_order = 1;\n\n\tfor (i = 1; i <= ZS_MAX_PAGES_PER_ZSPAGE; i++) {\n\t\tint zspage_size;\n\t\tint waste, usedpc;\n\n\t\tzspage_size = i * PAGE_SIZE;\n\t\twaste = zspage_size % class_size;\n\t\tusedpc = (zspage_size - waste) * 100 / zspage_size;\n\n\t\tif (usedpc > max_usedpc) {\n\t\t\tmax_usedpc = usedpc;\n\t\t\tmax_usedpc_order = i;\n\t\t}\n\t}\n\n\treturn max_usedpc_order;\n}"
        }
      },
      {
        "call_info": {
          "callee": "create_cache",
          "args": [
            "pool"
          ],
          "line": 2369
        },
        "resolved": true,
        "details": {
          "function_name": "create_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "321-337",
          "snippet": "static int create_cache(struct zs_pool *pool)\n{\n\tpool->handle_cachep = kmem_cache_create(\"zs_handle\", ZS_HANDLE_SIZE,\n\t\t\t\t\t0, 0, NULL);\n\tif (!pool->handle_cachep)\n\t\treturn 1;\n\n\tpool->zspage_cachep = kmem_cache_create(\"zspage\", sizeof(struct zspage),\n\t\t\t\t\t0, 0, NULL);\n\tif (!pool->zspage_cachep) {\n\t\tkmem_cache_destroy(pool->handle_cachep);\n\t\tpool->handle_cachep = NULL;\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nstatic int create_cache(struct zs_pool *pool)\n{\n\tpool->handle_cachep = kmem_cache_create(\"zs_handle\", ZS_HANDLE_SIZE,\n\t\t\t\t\t0, 0, NULL);\n\tif (!pool->handle_cachep)\n\t\treturn 1;\n\n\tpool->zspage_cachep = kmem_cache_create(\"zspage\", sizeof(struct zspage),\n\t\t\t\t\t0, 0, NULL);\n\tif (!pool->zspage_cachep) {\n\t\tkmem_cache_destroy(pool->handle_cachep);\n\t\tpool->handle_cachep = NULL;\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrdup",
          "args": [
            "name",
            "GFP_KERNEL"
          ],
          "line": 2365
        },
        "resolved": true,
        "details": {
          "function_name": "kstrdup_const",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "65-71",
          "snippet": "const char *kstrdup_const(const char *s, gfp_t gfp)\n{\n\tif (is_kernel_rodata((unsigned long)s))\n\t\treturn s;\n\n\treturn kstrdup(s, gfp);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nconst char *kstrdup_const(const char *s, gfp_t gfp)\n{\n\tif (is_kernel_rodata((unsigned long)s))\n\t\treturn s;\n\n\treturn kstrdup(s, gfp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_deferred_free",
          "args": [
            "pool"
          ],
          "line": 2363
        },
        "resolved": true,
        "details": {
          "function_name": "init_deferred_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2180-2183",
          "snippet": "static void init_deferred_free(struct zs_pool *pool)\n{\n\tINIT_WORK(&pool->free_work, async_free_zspage);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void init_deferred_free(struct zs_pool *pool)\n{\n\tINIT_WORK(&pool->free_work, async_free_zspage);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*pool)",
            "GFP_KERNEL"
          ],
          "line": 2359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n#define ZS_SIZE_CLASS_DELTA\t(PAGE_SIZE >> CLASS_BITS)\n#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE\n#define ZS_MIN_ALLOC_SIZE \\\n\tMAX(32, (ZS_MAX_PAGES_PER_ZSPAGE << PAGE_SHIFT >> OBJ_INDEX_BITS))\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nstatic size_t huge_class_size;\n\nstruct zs_pool *zs_create_pool(const char *name)\n{\n\tint i;\n\tstruct zs_pool *pool;\n\tstruct size_class *prev_class = NULL;\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\tinit_deferred_free(pool);\n\n\tpool->name = kstrdup(name, GFP_KERNEL);\n\tif (!pool->name)\n\t\tgoto err;\n\n\tif (create_cache(pool))\n\t\tgoto err;\n\n\t/*\n\t * Iterate reversely, because, size of size_class that we want to use\n\t * for merging should be larger or equal to current size.\n\t */\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tint size;\n\t\tint pages_per_zspage;\n\t\tint objs_per_zspage;\n\t\tstruct size_class *class;\n\t\tint fullness = 0;\n\n\t\tsize = ZS_MIN_ALLOC_SIZE + i * ZS_SIZE_CLASS_DELTA;\n\t\tif (size > ZS_MAX_ALLOC_SIZE)\n\t\t\tsize = ZS_MAX_ALLOC_SIZE;\n\t\tpages_per_zspage = get_pages_per_zspage(size);\n\t\tobjs_per_zspage = pages_per_zspage * PAGE_SIZE / size;\n\n\t\t/*\n\t\t * We iterate from biggest down to smallest classes,\n\t\t * so huge_class_size holds the size of the first huge\n\t\t * class. Any object bigger than or equal to that will\n\t\t * endup in the huge class.\n\t\t */\n\t\tif (pages_per_zspage != 1 && objs_per_zspage != 1 &&\n\t\t\t\t!huge_class_size) {\n\t\t\thuge_class_size = size;\n\t\t\t/*\n\t\t\t * The object uses ZS_HANDLE_SIZE bytes to store the\n\t\t\t * handle. We need to subtract it, because zs_malloc()\n\t\t\t * unconditionally adds handle size before it performs\n\t\t\t * size class search - so object may be smaller than\n\t\t\t * huge class size, yet it still can end up in the huge\n\t\t\t * class because it grows by ZS_HANDLE_SIZE extra bytes\n\t\t\t * right before class lookup.\n\t\t\t */\n\t\t\thuge_class_size -= (ZS_HANDLE_SIZE - 1);\n\t\t}\n\n\t\t/*\n\t\t * size_class is used for normal zsmalloc operation such\n\t\t * as alloc/free for that size. Although it is natural that we\n\t\t * have one size_class for each size, there is a chance that we\n\t\t * can get more memory utilization if we use one size_class for\n\t\t * many different sizes whose size_class have same\n\t\t * characteristics. So, we makes size_class point to\n\t\t * previous size_class if possible.\n\t\t */\n\t\tif (prev_class) {\n\t\t\tif (can_merge(prev_class, pages_per_zspage, objs_per_zspage)) {\n\t\t\t\tpool->size_class[i] = prev_class;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tclass = kzalloc(sizeof(struct size_class), GFP_KERNEL);\n\t\tif (!class)\n\t\t\tgoto err;\n\n\t\tclass->size = size;\n\t\tclass->index = i;\n\t\tclass->pages_per_zspage = pages_per_zspage;\n\t\tclass->objs_per_zspage = objs_per_zspage;\n\t\tspin_lock_init(&class->lock);\n\t\tpool->size_class[i] = class;\n\t\tfor (fullness = ZS_EMPTY; fullness < NR_ZS_FULLNESS;\n\t\t\t\t\t\t\tfullness++)\n\t\t\tINIT_LIST_HEAD(&class->fullness_list[fullness]);\n\n\t\tprev_class = class;\n\t}\n\n\t/* debug only, don't abort if it fails */\n\tzs_pool_stat_create(pool, name);\n\n\tif (zs_register_migration(pool))\n\t\tgoto err;\n\n\t/*\n\t * Not critical since shrinker is only used to trigger internal\n\t * defragmentation of the pool which is pretty optional thing.  If\n\t * registration fails we still can use the pool normally and user can\n\t * trigger compaction manually. Thus, ignore return code.\n\t */\n\tzs_register_shrinker(pool);\n\n\treturn pool;\n\nerr:\n\tzs_destroy_pool(pool);\n\treturn NULL;\n}"
  },
  {
    "function_name": "zs_register_shrinker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2333-2341",
    "snippet": "static int zs_register_shrinker(struct zs_pool *pool)\n{\n\tpool->shrinker.scan_objects = zs_shrinker_scan;\n\tpool->shrinker.count_objects = zs_shrinker_count;\n\tpool->shrinker.batch = 0;\n\tpool->shrinker.seeks = DEFAULT_SEEKS;\n\n\treturn register_shrinker(&pool->shrinker);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_shrinker",
          "args": [
            "&pool->shrinker"
          ],
          "line": 2340
        },
        "resolved": true,
        "details": {
          "function_name": "zs_register_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2333-2341",
          "snippet": "static int zs_register_shrinker(struct zs_pool *pool)\n{\n\tpool->shrinker.scan_objects = zs_shrinker_scan;\n\tpool->shrinker.count_objects = zs_shrinker_count;\n\tpool->shrinker.batch = 0;\n\tpool->shrinker.seeks = DEFAULT_SEEKS;\n\n\treturn register_shrinker(&pool->shrinker);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zs_register_shrinker(struct zs_pool *pool)\n{\n\tpool->shrinker.scan_objects = zs_shrinker_scan;\n\tpool->shrinker.count_objects = zs_shrinker_count;\n\tpool->shrinker.batch = 0;\n\tpool->shrinker.seeks = DEFAULT_SEEKS;\n\n\treturn register_shrinker(&pool->shrinker);\n}"
  },
  {
    "function_name": "zs_unregister_shrinker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2328-2331",
    "snippet": "static void zs_unregister_shrinker(struct zs_pool *pool)\n{\n\tunregister_shrinker(&pool->shrinker);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_shrinker",
          "args": [
            "&pool->shrinker"
          ],
          "line": 2330
        },
        "resolved": true,
        "details": {
          "function_name": "zs_unregister_shrinker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2328-2331",
          "snippet": "static void zs_unregister_shrinker(struct zs_pool *pool)\n{\n\tunregister_shrinker(&pool->shrinker);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_unregister_shrinker(struct zs_pool *pool)\n{\n\tunregister_shrinker(&pool->shrinker);\n}"
  },
  {
    "function_name": "zs_shrinker_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2306-2326",
    "snippet": "static unsigned long zs_shrinker_count(struct shrinker *shrinker,\n\t\tstruct shrink_control *sc)\n{\n\tint i;\n\tstruct size_class *class;\n\tunsigned long pages_to_free = 0;\n\tstruct zs_pool *pool = container_of(shrinker, struct zs_pool,\n\t\t\tshrinker);\n\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tclass = pool->size_class[i];\n\t\tif (!class)\n\t\t\tcontinue;\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tpages_to_free += zs_can_compact(class);\n\t}\n\n\treturn pages_to_free;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_can_compact",
          "args": [
            "class"
          ],
          "line": 2322
        },
        "resolved": true,
        "details": {
          "function_name": "zs_can_compact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2202-2215",
          "snippet": "static unsigned long zs_can_compact(struct size_class *class)\n{\n\tunsigned long obj_wasted;\n\tunsigned long obj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\tunsigned long obj_used = zs_stat_get(class, OBJ_USED);\n\n\tif (obj_allocated <= obj_used)\n\t\treturn 0;\n\n\tobj_wasted = obj_allocated - obj_used;\n\tobj_wasted /= class->objs_per_zspage;\n\n\treturn obj_wasted * class->pages_per_zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long zs_can_compact(struct size_class *class)\n{\n\tunsigned long obj_wasted;\n\tunsigned long obj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\tunsigned long obj_used = zs_stat_get(class, OBJ_USED);\n\n\tif (obj_allocated <= obj_used)\n\t\treturn 0;\n\n\tobj_wasted = obj_allocated - obj_used;\n\tobj_wasted /= class->objs_per_zspage;\n\n\treturn obj_wasted * class->pages_per_zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "shrinker",
            "structzs_pool",
            "shrinker"
          ],
          "line": 2312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n\nstatic unsigned long zs_shrinker_count(struct shrinker *shrinker,\n\t\tstruct shrink_control *sc)\n{\n\tint i;\n\tstruct size_class *class;\n\tunsigned long pages_to_free = 0;\n\tstruct zs_pool *pool = container_of(shrinker, struct zs_pool,\n\t\t\tshrinker);\n\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tclass = pool->size_class[i];\n\t\tif (!class)\n\t\t\tcontinue;\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tpages_to_free += zs_can_compact(class);\n\t}\n\n\treturn pages_to_free;\n}"
  },
  {
    "function_name": "zs_shrinker_scan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2288-2304",
    "snippet": "static unsigned long zs_shrinker_scan(struct shrinker *shrinker,\n\t\tstruct shrink_control *sc)\n{\n\tunsigned long pages_freed;\n\tstruct zs_pool *pool = container_of(shrinker, struct zs_pool,\n\t\t\tshrinker);\n\n\tpages_freed = pool->stats.pages_compacted;\n\t/*\n\t * Compact classes and calculate compaction delta.\n\t * Can run concurrently with a manually triggered\n\t * (by user) compaction.\n\t */\n\tpages_freed = zs_compact(pool) - pages_freed;\n\n\treturn pages_freed ? pages_freed : SHRINK_STOP;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_compact",
          "args": [
            "pool"
          ],
          "line": 2301
        },
        "resolved": true,
        "details": {
          "function_name": "zs_compact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2264-2279",
          "snippet": "unsigned long zs_compact(struct zs_pool *pool)\n{\n\tint i;\n\tstruct size_class *class;\n\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tclass = pool->size_class[i];\n\t\tif (!class)\n\t\t\tcontinue;\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\t\t__zs_compact(pool, class);\n\t}\n\n\treturn pool->stats.pages_compacted;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n\nunsigned long zs_compact(struct zs_pool *pool)\n{\n\tint i;\n\tstruct size_class *class;\n\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tclass = pool->size_class[i];\n\t\tif (!class)\n\t\t\tcontinue;\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\t\t__zs_compact(pool, class);\n\t}\n\n\treturn pool->stats.pages_compacted;\n}"
        }
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "shrinker",
            "structzs_pool",
            "shrinker"
          ],
          "line": 2292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long zs_shrinker_scan(struct shrinker *shrinker,\n\t\tstruct shrink_control *sc)\n{\n\tunsigned long pages_freed;\n\tstruct zs_pool *pool = container_of(shrinker, struct zs_pool,\n\t\t\tshrinker);\n\n\tpages_freed = pool->stats.pages_compacted;\n\t/*\n\t * Compact classes and calculate compaction delta.\n\t * Can run concurrently with a manually triggered\n\t * (by user) compaction.\n\t */\n\tpages_freed = zs_compact(pool) - pages_freed;\n\n\treturn pages_freed ? pages_freed : SHRINK_STOP;\n}"
  },
  {
    "function_name": "zs_pool_stats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2282-2285",
    "snippet": "void zs_pool_stats(struct zs_pool *pool, struct zs_pool_stats *stats)\n{\n\tmemcpy(stats, &pool->stats, sizeof(struct zs_pool_stats));\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "stats",
            "&pool->stats",
            "sizeof(struct zs_pool_stats)"
          ],
          "line": 2284
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nvoid zs_pool_stats(struct zs_pool *pool, struct zs_pool_stats *stats)\n{\n\tmemcpy(stats, &pool->stats, sizeof(struct zs_pool_stats));\n}"
  },
  {
    "function_name": "zs_compact",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2264-2279",
    "snippet": "unsigned long zs_compact(struct zs_pool *pool)\n{\n\tint i;\n\tstruct size_class *class;\n\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tclass = pool->size_class[i];\n\t\tif (!class)\n\t\t\tcontinue;\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\t\t__zs_compact(pool, class);\n\t}\n\n\treturn pool->stats.pages_compacted;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__zs_compact",
          "args": [
            "pool",
            "class"
          ],
          "line": 2275
        },
        "resolved": true,
        "details": {
          "function_name": "__zs_compact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2217-2262",
          "snippet": "static void __zs_compact(struct zs_pool *pool, struct size_class *class)\n{\n\tstruct zs_compact_control cc;\n\tstruct zspage *src_zspage;\n\tstruct zspage *dst_zspage = NULL;\n\n\tspin_lock(&class->lock);\n\twhile ((src_zspage = isolate_zspage(class, true))) {\n\n\t\tif (!zs_can_compact(class))\n\t\t\tbreak;\n\n\t\tcc.obj_idx = 0;\n\t\tcc.s_page = get_first_page(src_zspage);\n\n\t\twhile ((dst_zspage = isolate_zspage(class, false))) {\n\t\t\tcc.d_page = get_first_page(dst_zspage);\n\t\t\t/*\n\t\t\t * If there is no more space in dst_page, resched\n\t\t\t * and see if anyone had allocated another zspage.\n\t\t\t */\n\t\t\tif (!migrate_zspage(pool, class, &cc))\n\t\t\t\tbreak;\n\n\t\t\tputback_zspage(class, dst_zspage);\n\t\t}\n\n\t\t/* Stop if we couldn't find slot */\n\t\tif (dst_zspage == NULL)\n\t\t\tbreak;\n\n\t\tputback_zspage(class, dst_zspage);\n\t\tif (putback_zspage(class, src_zspage) == ZS_EMPTY) {\n\t\t\tfree_zspage(pool, class, src_zspage);\n\t\t\tpool->stats.pages_compacted += class->pages_per_zspage;\n\t\t}\n\t\tspin_unlock(&class->lock);\n\t\tcond_resched();\n\t\tspin_lock(&class->lock);\n\t}\n\n\tif (src_zspage)\n\t\tputback_zspage(class, src_zspage);\n\n\tspin_unlock(&class->lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __zs_compact(struct zs_pool *pool, struct size_class *class)\n{\n\tstruct zs_compact_control cc;\n\tstruct zspage *src_zspage;\n\tstruct zspage *dst_zspage = NULL;\n\n\tspin_lock(&class->lock);\n\twhile ((src_zspage = isolate_zspage(class, true))) {\n\n\t\tif (!zs_can_compact(class))\n\t\t\tbreak;\n\n\t\tcc.obj_idx = 0;\n\t\tcc.s_page = get_first_page(src_zspage);\n\n\t\twhile ((dst_zspage = isolate_zspage(class, false))) {\n\t\t\tcc.d_page = get_first_page(dst_zspage);\n\t\t\t/*\n\t\t\t * If there is no more space in dst_page, resched\n\t\t\t * and see if anyone had allocated another zspage.\n\t\t\t */\n\t\t\tif (!migrate_zspage(pool, class, &cc))\n\t\t\t\tbreak;\n\n\t\t\tputback_zspage(class, dst_zspage);\n\t\t}\n\n\t\t/* Stop if we couldn't find slot */\n\t\tif (dst_zspage == NULL)\n\t\t\tbreak;\n\n\t\tputback_zspage(class, dst_zspage);\n\t\tif (putback_zspage(class, src_zspage) == ZS_EMPTY) {\n\t\t\tfree_zspage(pool, class, src_zspage);\n\t\t\tpool->stats.pages_compacted += class->pages_per_zspage;\n\t\t}\n\t\tspin_unlock(&class->lock);\n\t\tcond_resched();\n\t\tspin_lock(&class->lock);\n\t}\n\n\tif (src_zspage)\n\t\tputback_zspage(class, src_zspage);\n\n\tspin_unlock(&class->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n\nunsigned long zs_compact(struct zs_pool *pool)\n{\n\tint i;\n\tstruct size_class *class;\n\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tclass = pool->size_class[i];\n\t\tif (!class)\n\t\t\tcontinue;\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\t\t__zs_compact(pool, class);\n\t}\n\n\treturn pool->stats.pages_compacted;\n}"
  },
  {
    "function_name": "__zs_compact",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2217-2262",
    "snippet": "static void __zs_compact(struct zs_pool *pool, struct size_class *class)\n{\n\tstruct zs_compact_control cc;\n\tstruct zspage *src_zspage;\n\tstruct zspage *dst_zspage = NULL;\n\n\tspin_lock(&class->lock);\n\twhile ((src_zspage = isolate_zspage(class, true))) {\n\n\t\tif (!zs_can_compact(class))\n\t\t\tbreak;\n\n\t\tcc.obj_idx = 0;\n\t\tcc.s_page = get_first_page(src_zspage);\n\n\t\twhile ((dst_zspage = isolate_zspage(class, false))) {\n\t\t\tcc.d_page = get_first_page(dst_zspage);\n\t\t\t/*\n\t\t\t * If there is no more space in dst_page, resched\n\t\t\t * and see if anyone had allocated another zspage.\n\t\t\t */\n\t\t\tif (!migrate_zspage(pool, class, &cc))\n\t\t\t\tbreak;\n\n\t\t\tputback_zspage(class, dst_zspage);\n\t\t}\n\n\t\t/* Stop if we couldn't find slot */\n\t\tif (dst_zspage == NULL)\n\t\t\tbreak;\n\n\t\tputback_zspage(class, dst_zspage);\n\t\tif (putback_zspage(class, src_zspage) == ZS_EMPTY) {\n\t\t\tfree_zspage(pool, class, src_zspage);\n\t\t\tpool->stats.pages_compacted += class->pages_per_zspage;\n\t\t}\n\t\tspin_unlock(&class->lock);\n\t\tcond_resched();\n\t\tspin_lock(&class->lock);\n\t}\n\n\tif (src_zspage)\n\t\tputback_zspage(class, src_zspage);\n\n\tspin_unlock(&class->lock);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 2261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "putback_zspage",
          "args": [
            "class",
            "src_zspage"
          ],
          "line": 2259
        },
        "resolved": true,
        "details": {
          "function_name": "putback_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1789-1801",
          "snippet": "static enum fullness_group putback_zspage(struct size_class *class,\n\t\t\tstruct zspage *zspage)\n{\n\tenum fullness_group fullness;\n\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tfullness = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, fullness);\n\tset_zspage_mapping(zspage, class->index, fullness);\n\n\treturn fullness;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic enum fullness_group putback_zspage(struct size_class *class,\n\t\t\tstruct zspage *zspage)\n{\n\tenum fullness_group fullness;\n\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tfullness = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, fullness);\n\tset_zspage_mapping(zspage, class->index, fullness);\n\n\treturn fullness;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 2255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 2254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 2253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_zspage",
          "args": [
            "pool",
            "class",
            "src_zspage"
          ],
          "line": 2250
        },
        "resolved": true,
        "details": {
          "function_name": "free_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "980-993",
          "snippet": "static void free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(list_empty(&zspage->list));\n\n\tif (!trylock_zspage(zspage)) {\n\t\tkick_deferred_free(pool);\n\t\treturn;\n\t}\n\n\tremove_zspage(class, zspage, ZS_EMPTY);\n\t__free_zspage(pool, class, zspage);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(list_empty(&zspage->list));\n\n\tif (!trylock_zspage(zspage)) {\n\t\tkick_deferred_free(pool);\n\t\treturn;\n\t}\n\n\tremove_zspage(class, zspage, ZS_EMPTY);\n\t__free_zspage(pool, class, zspage);\n}"
        }
      },
      {
        "call_info": {
          "callee": "migrate_zspage",
          "args": [
            "pool",
            "class",
            "&cc"
          ],
          "line": 2238
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1708-1756",
          "snippet": "static int migrate_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zs_compact_control *cc)\n{\n\tunsigned long used_obj, free_obj;\n\tunsigned long handle;\n\tstruct page *s_page = cc->s_page;\n\tstruct page *d_page = cc->d_page;\n\tint obj_idx = cc->obj_idx;\n\tint ret = 0;\n\n\twhile (1) {\n\t\thandle = find_alloced_obj(class, s_page, &obj_idx);\n\t\tif (!handle) {\n\t\t\ts_page = get_next_page(s_page);\n\t\t\tif (!s_page)\n\t\t\t\tbreak;\n\t\t\tobj_idx = 0;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Stop if there is no more space */\n\t\tif (zspage_full(class, get_zspage(d_page))) {\n\t\t\tunpin_tag(handle);\n\t\t\tret = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tused_obj = handle_to_obj(handle);\n\t\tfree_obj = obj_malloc(class, get_zspage(d_page), handle);\n\t\tzs_object_copy(class, free_obj, used_obj);\n\t\tobj_idx++;\n\t\t/*\n\t\t * record_obj updates handle's value to free_obj and it will\n\t\t * invalidate lock bit(ie, HANDLE_PIN_BIT) of handle, which\n\t\t * breaks synchronization using pin_tag(e,g, zs_free) so\n\t\t * let's keep the lock bit.\n\t\t */\n\t\tfree_obj |= BIT(HANDLE_PIN_BIT);\n\t\trecord_obj(handle, free_obj);\n\t\tunpin_tag(handle);\n\t\tobj_free(class, used_obj);\n\t}\n\n\t/* Remember last position in this iteration */\n\tcc->s_page = s_page;\n\tcc->obj_idx = obj_idx;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic int migrate_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zs_compact_control *cc)\n{\n\tunsigned long used_obj, free_obj;\n\tunsigned long handle;\n\tstruct page *s_page = cc->s_page;\n\tstruct page *d_page = cc->d_page;\n\tint obj_idx = cc->obj_idx;\n\tint ret = 0;\n\n\twhile (1) {\n\t\thandle = find_alloced_obj(class, s_page, &obj_idx);\n\t\tif (!handle) {\n\t\t\ts_page = get_next_page(s_page);\n\t\t\tif (!s_page)\n\t\t\t\tbreak;\n\t\t\tobj_idx = 0;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Stop if there is no more space */\n\t\tif (zspage_full(class, get_zspage(d_page))) {\n\t\t\tunpin_tag(handle);\n\t\t\tret = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tused_obj = handle_to_obj(handle);\n\t\tfree_obj = obj_malloc(class, get_zspage(d_page), handle);\n\t\tzs_object_copy(class, free_obj, used_obj);\n\t\tobj_idx++;\n\t\t/*\n\t\t * record_obj updates handle's value to free_obj and it will\n\t\t * invalidate lock bit(ie, HANDLE_PIN_BIT) of handle, which\n\t\t * breaks synchronization using pin_tag(e,g, zs_free) so\n\t\t * let's keep the lock bit.\n\t\t */\n\t\tfree_obj |= BIT(HANDLE_PIN_BIT);\n\t\trecord_obj(handle, free_obj);\n\t\tunpin_tag(handle);\n\t\tobj_free(class, used_obj);\n\t}\n\n\t/* Remember last position in this iteration */\n\tcc->s_page = s_page;\n\tcc->obj_idx = obj_idx;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_first_page",
          "args": [
            "dst_zspage"
          ],
          "line": 2233
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "483-489",
          "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "isolate_zspage",
          "args": [
            "class",
            "false"
          ],
          "line": 2232
        },
        "resolved": true,
        "details": {
          "function_name": "isolate_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1758-1780",
          "snippet": "static struct zspage *isolate_zspage(struct size_class *class, bool source)\n{\n\tint i;\n\tstruct zspage *zspage;\n\tenum fullness_group fg[2] = {ZS_ALMOST_EMPTY, ZS_ALMOST_FULL};\n\n\tif (!source) {\n\t\tfg[0] = ZS_ALMOST_FULL;\n\t\tfg[1] = ZS_ALMOST_EMPTY;\n\t}\n\n\tfor (i = 0; i < 2; i++) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[fg[i]],\n\t\t\t\t\t\t\tstruct zspage, list);\n\t\tif (zspage) {\n\t\t\tVM_BUG_ON(is_zspage_isolated(zspage));\n\t\t\tremove_zspage(class, zspage, fg[i]);\n\t\t\treturn zspage;\n\t\t}\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *isolate_zspage(struct size_class *class, bool source)\n{\n\tint i;\n\tstruct zspage *zspage;\n\tenum fullness_group fg[2] = {ZS_ALMOST_EMPTY, ZS_ALMOST_FULL};\n\n\tif (!source) {\n\t\tfg[0] = ZS_ALMOST_FULL;\n\t\tfg[1] = ZS_ALMOST_EMPTY;\n\t}\n\n\tfor (i = 0; i < 2; i++) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[fg[i]],\n\t\t\t\t\t\t\tstruct zspage, list);\n\t\tif (zspage) {\n\t\t\tVM_BUG_ON(is_zspage_isolated(zspage));\n\t\t\tremove_zspage(class, zspage, fg[i]);\n\t\t\treturn zspage;\n\t\t}\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_can_compact",
          "args": [
            "class"
          ],
          "line": 2226
        },
        "resolved": true,
        "details": {
          "function_name": "zs_can_compact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2202-2215",
          "snippet": "static unsigned long zs_can_compact(struct size_class *class)\n{\n\tunsigned long obj_wasted;\n\tunsigned long obj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\tunsigned long obj_used = zs_stat_get(class, OBJ_USED);\n\n\tif (obj_allocated <= obj_used)\n\t\treturn 0;\n\n\tobj_wasted = obj_allocated - obj_used;\n\tobj_wasted /= class->objs_per_zspage;\n\n\treturn obj_wasted * class->pages_per_zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long zs_can_compact(struct size_class *class)\n{\n\tunsigned long obj_wasted;\n\tunsigned long obj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\tunsigned long obj_used = zs_stat_get(class, OBJ_USED);\n\n\tif (obj_allocated <= obj_used)\n\t\treturn 0;\n\n\tobj_wasted = obj_allocated - obj_used;\n\tobj_wasted /= class->objs_per_zspage;\n\n\treturn obj_wasted * class->pages_per_zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 2223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __zs_compact(struct zs_pool *pool, struct size_class *class)\n{\n\tstruct zs_compact_control cc;\n\tstruct zspage *src_zspage;\n\tstruct zspage *dst_zspage = NULL;\n\n\tspin_lock(&class->lock);\n\twhile ((src_zspage = isolate_zspage(class, true))) {\n\n\t\tif (!zs_can_compact(class))\n\t\t\tbreak;\n\n\t\tcc.obj_idx = 0;\n\t\tcc.s_page = get_first_page(src_zspage);\n\n\t\twhile ((dst_zspage = isolate_zspage(class, false))) {\n\t\t\tcc.d_page = get_first_page(dst_zspage);\n\t\t\t/*\n\t\t\t * If there is no more space in dst_page, resched\n\t\t\t * and see if anyone had allocated another zspage.\n\t\t\t */\n\t\t\tif (!migrate_zspage(pool, class, &cc))\n\t\t\t\tbreak;\n\n\t\t\tputback_zspage(class, dst_zspage);\n\t\t}\n\n\t\t/* Stop if we couldn't find slot */\n\t\tif (dst_zspage == NULL)\n\t\t\tbreak;\n\n\t\tputback_zspage(class, dst_zspage);\n\t\tif (putback_zspage(class, src_zspage) == ZS_EMPTY) {\n\t\t\tfree_zspage(pool, class, src_zspage);\n\t\t\tpool->stats.pages_compacted += class->pages_per_zspage;\n\t\t}\n\t\tspin_unlock(&class->lock);\n\t\tcond_resched();\n\t\tspin_lock(&class->lock);\n\t}\n\n\tif (src_zspage)\n\t\tputback_zspage(class, src_zspage);\n\n\tspin_unlock(&class->lock);\n}"
  },
  {
    "function_name": "zs_can_compact",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2202-2215",
    "snippet": "static unsigned long zs_can_compact(struct size_class *class)\n{\n\tunsigned long obj_wasted;\n\tunsigned long obj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\tunsigned long obj_used = zs_stat_get(class, OBJ_USED);\n\n\tif (obj_allocated <= obj_used)\n\t\treturn 0;\n\n\tobj_wasted = obj_allocated - obj_used;\n\tobj_wasted /= class->objs_per_zspage;\n\n\treturn obj_wasted * class->pages_per_zspage;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_stat_get",
          "args": [
            "class",
            "OBJ_USED"
          ],
          "line": 2206
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "562-566",
          "snippet": "static inline unsigned long zs_stat_get(struct size_class *class,\n\t\t\t\tint type)\n{\n\treturn class->stats.objs[type];\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline unsigned long zs_stat_get(struct size_class *class,\n\t\t\t\tint type)\n{\n\treturn class->stats.objs[type];\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long zs_can_compact(struct size_class *class)\n{\n\tunsigned long obj_wasted;\n\tunsigned long obj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\tunsigned long obj_used = zs_stat_get(class, OBJ_USED);\n\n\tif (obj_allocated <= obj_used)\n\t\treturn 0;\n\n\tobj_wasted = obj_allocated - obj_used;\n\tobj_wasted /= class->objs_per_zspage;\n\n\treturn obj_wasted * class->pages_per_zspage;\n}"
  },
  {
    "function_name": "SetZsPageMovable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2185-2194",
    "snippet": "static void SetZsPageMovable(struct zs_pool *pool, struct zspage *zspage)\n{\n\tstruct page *page = get_first_page(zspage);\n\n\tdo {\n\t\tWARN_ON(!trylock_page(page));\n\t\t__SetPageMovable(page, pool->inode->i_mapping);\n\t\tunlock_page(page);\n\t} while ((page = get_next_page(page)) != NULL);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "page"
          ],
          "line": 2193
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 2192
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__SetPageMovable",
          "args": [
            "page",
            "pool->inode->i_mapping"
          ],
          "line": 2191
        },
        "resolved": true,
        "details": {
          "function_name": "__SetPageMovable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/compaction.c",
          "lines": "112-117",
          "snippet": "void __SetPageMovable(struct page *page, struct address_space *mapping)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE((unsigned long)mapping & PAGE_MAPPING_MOVABLE, page);\n\tpage->mapping = (void *)((unsigned long)mapping | PAGE_MAPPING_MOVABLE);\n}",
          "includes": [
            "#include <trace/events/compaction.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kasan.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/compaction.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/page_owner.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/kasan.h>\n#include <linux/page-isolation.h>\n#include <linux/sysfs.h>\n#include <linux/sysctl.h>\n#include <linux/backing-dev.h>\n#include <linux/sched/signal.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/cpu.h>\n\nvoid __SetPageMovable(struct page *page, struct address_space *mapping)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE((unsigned long)mapping & PAGE_MAPPING_MOVABLE, page);\n\tpage->mapping = (void *)((unsigned long)mapping | PAGE_MAPPING_MOVABLE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!trylock_page(page)"
          ],
          "line": 2190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trylock_page",
          "args": [
            "page"
          ],
          "line": 2190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_first_page",
          "args": [
            "zspage"
          ],
          "line": 2187
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "483-489",
          "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void SetZsPageMovable(struct zs_pool *pool, struct zspage *zspage)\n{\n\tstruct page *page = get_first_page(zspage);\n\n\tdo {\n\t\tWARN_ON(!trylock_page(page));\n\t\t__SetPageMovable(page, pool->inode->i_mapping);\n\t\tunlock_page(page);\n\t} while ((page = get_next_page(page)) != NULL);\n}"
  },
  {
    "function_name": "init_deferred_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2180-2183",
    "snippet": "static void init_deferred_free(struct zs_pool *pool)\n{\n\tINIT_WORK(&pool->free_work, async_free_zspage);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "INIT_WORK",
          "args": [
            "&pool->free_work",
            "async_free_zspage"
          ],
          "line": 2182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void init_deferred_free(struct zs_pool *pool)\n{\n\tINIT_WORK(&pool->free_work, async_free_zspage);\n}"
  },
  {
    "function_name": "kick_deferred_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2175-2178",
    "snippet": "static void kick_deferred_free(struct zs_pool *pool)\n{\n\tschedule_work(&pool->free_work);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&pool->free_work"
          ],
          "line": 2177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void kick_deferred_free(struct zs_pool *pool)\n{\n\tschedule_work(&pool->free_work);\n}"
  },
  {
    "function_name": "async_free_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2140-2173",
    "snippet": "static void async_free_zspage(struct work_struct *work)\n{\n\tint i;\n\tstruct size_class *class;\n\tunsigned int class_idx;\n\tenum fullness_group fullness;\n\tstruct zspage *zspage, *tmp;\n\tLIST_HEAD(free_pages);\n\tstruct zs_pool *pool = container_of(work, struct zs_pool,\n\t\t\t\t\tfree_work);\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tclass = pool->size_class[i];\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tspin_lock(&class->lock);\n\t\tlist_splice_init(&class->fullness_list[ZS_EMPTY], &free_pages);\n\t\tspin_unlock(&class->lock);\n\t}\n\n\n\tlist_for_each_entry_safe(zspage, tmp, &free_pages, list) {\n\t\tlist_del(&zspage->list);\n\t\tlock_zspage(zspage);\n\n\t\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\t\tVM_BUG_ON(fullness != ZS_EMPTY);\n\t\tclass = pool->size_class[class_idx];\n\t\tspin_lock(&class->lock);\n\t\t__free_zspage(pool, pool->size_class[class_idx], zspage);\n\t\tspin_unlock(&class->lock);\n\t}\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 2171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__free_zspage",
          "args": [
            "pool",
            "pool->size_class[class_idx]",
            "zspage"
          ],
          "line": 2170
        },
        "resolved": true,
        "details": {
          "function_name": "__free_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "948-978",
          "snippet": "static void __free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tstruct page *page, *next;\n\tenum fullness_group fg;\n\tunsigned int class_idx;\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\n\tassert_spin_locked(&class->lock);\n\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(fg != ZS_EMPTY);\n\n\tnext = page = get_first_page(zspage);\n\tdo {\n\t\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\t\tnext = get_next_page(page);\n\t\treset_page(page);\n\t\tunlock_page(page);\n\t\tdec_zone_page_state(page, NR_ZSPAGES);\n\t\tput_page(page);\n\t\tpage = next;\n\t} while (page != NULL);\n\n\tcache_free_zspage(pool, zspage);\n\n\tzs_stat_dec(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\tatomic_long_sub(class->pages_per_zspage,\n\t\t\t\t\t&pool->pages_allocated);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tstruct page *page, *next;\n\tenum fullness_group fg;\n\tunsigned int class_idx;\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\n\tassert_spin_locked(&class->lock);\n\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(fg != ZS_EMPTY);\n\n\tnext = page = get_first_page(zspage);\n\tdo {\n\t\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\t\tnext = get_next_page(page);\n\t\treset_page(page);\n\t\tunlock_page(page);\n\t\tdec_zone_page_state(page, NR_ZSPAGES);\n\t\tput_page(page);\n\t\tpage = next;\n\t} while (page != NULL);\n\n\tcache_free_zspage(pool, zspage);\n\n\tzs_stat_dec(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\tatomic_long_sub(class->pages_per_zspage,\n\t\t\t\t\t&pool->pages_allocated);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 2169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "fullness != ZS_EMPTY"
          ],
          "line": 2167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&fullness"
          ],
          "line": 2166
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lock_zspage",
          "args": [
            "zspage"
          ],
          "line": 2164
        },
        "resolved": true,
        "details": {
          "function_name": "lock_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1808-1815",
          "snippet": "static void lock_zspage(struct zspage *zspage)\n{\n\tstruct page *page = get_first_page(zspage);\n\n\tdo {\n\t\tlock_page(page);\n\t} while ((page = get_next_page(page)) != NULL);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void lock_zspage(struct zspage *zspage)\n{\n\tstruct page *page = get_first_page(zspage);\n\n\tdo {\n\t\tlock_page(page);\n\t} while ((page = get_next_page(page)) != NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&zspage->list"
          ],
          "line": 2163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "zspage",
            "tmp",
            "&free_pages",
            "list"
          ],
          "line": 2162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 2158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_splice_init",
          "args": [
            "&class->fullness_list[ZS_EMPTY]",
            "&free_pages"
          ],
          "line": 2157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 2156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "work",
            "structzs_pool",
            "free_work"
          ],
          "line": 2148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LIST_HEAD",
          "args": [
            "free_pages"
          ],
          "line": 2147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n\nstatic void async_free_zspage(struct work_struct *work)\n{\n\tint i;\n\tstruct size_class *class;\n\tunsigned int class_idx;\n\tenum fullness_group fullness;\n\tstruct zspage *zspage, *tmp;\n\tLIST_HEAD(free_pages);\n\tstruct zs_pool *pool = container_of(work, struct zs_pool,\n\t\t\t\t\tfree_work);\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tclass = pool->size_class[i];\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tspin_lock(&class->lock);\n\t\tlist_splice_init(&class->fullness_list[ZS_EMPTY], &free_pages);\n\t\tspin_unlock(&class->lock);\n\t}\n\n\n\tlist_for_each_entry_safe(zspage, tmp, &free_pages, list) {\n\t\tlist_del(&zspage->list);\n\t\tlock_zspage(zspage);\n\n\t\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\t\tVM_BUG_ON(fullness != ZS_EMPTY);\n\t\tclass = pool->size_class[class_idx];\n\t\tspin_lock(&class->lock);\n\t\t__free_zspage(pool, pool->size_class[class_idx], zspage);\n\t\tspin_unlock(&class->lock);\n\t}\n}"
  },
  {
    "function_name": "zs_unregister_migration",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2130-2134",
    "snippet": "static void zs_unregister_migration(struct zs_pool *pool)\n{\n\tflush_work(&pool->free_work);\n\tiput(pool->inode);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iput",
          "args": [
            "pool->inode"
          ],
          "line": 2133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flush_work",
          "args": [
            "&pool->free_work"
          ],
          "line": 2132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_unregister_migration(struct zs_pool *pool)\n{\n\tflush_work(&pool->free_work);\n\tiput(pool->inode);\n}"
  },
  {
    "function_name": "zs_register_migration",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2117-2128",
    "snippet": "static int zs_register_migration(struct zs_pool *pool)\n{\n\tpool->inode = alloc_anon_inode(zsmalloc_mnt->mnt_sb);\n\tif (IS_ERR(pool->inode)) {\n\t\tpool->inode = NULL;\n\t\treturn 1;\n\t}\n\n\tpool->inode->i_mapping->private_data = pool;\n\tpool->inode->i_mapping->a_ops = &zsmalloc_aops;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "pool->inode"
          ],
          "line": 2120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_anon_inode",
          "args": [
            "zsmalloc_mnt->mnt_sb"
          ],
          "line": 2119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zs_register_migration(struct zs_pool *pool)\n{\n\tpool->inode = alloc_anon_inode(zsmalloc_mnt->mnt_sb);\n\tif (IS_ERR(pool->inode)) {\n\t\tpool->inode = NULL;\n\t\treturn 1;\n\t}\n\n\tpool->inode->i_mapping->private_data = pool;\n\tpool->inode->i_mapping->a_ops = &zsmalloc_aops;\n\treturn 0;\n}"
  },
  {
    "function_name": "zs_page_putback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "2079-2109",
    "snippet": "static void zs_page_putback(struct page *page)\n{\n\tstruct zs_pool *pool;\n\tstruct size_class *class;\n\tint class_idx;\n\tenum fullness_group fg;\n\tstruct address_space *mapping;\n\tstruct zspage *zspage;\n\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\tVM_BUG_ON_PAGE(!PageIsolated(page), page);\n\n\tzspage = get_zspage(page);\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tmapping = page_mapping(page);\n\tpool = mapping->private_data;\n\tclass = pool->size_class[class_idx];\n\n\tspin_lock(&class->lock);\n\tdec_zspage_isolation(zspage);\n\tif (!is_zspage_isolated(zspage)) {\n\t\tfg = putback_zspage(class, zspage);\n\t\t/*\n\t\t * Due to page_lock, we cannot free zspage immediately\n\t\t * so let's defer.\n\t\t */\n\t\tif (fg == ZS_EMPTY)\n\t\t\tschedule_work(&pool->free_work);\n\t}\n\tspin_unlock(&class->lock);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 2108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&pool->free_work"
          ],
          "line": 2106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "putback_zspage",
          "args": [
            "class",
            "zspage"
          ],
          "line": 2100
        },
        "resolved": true,
        "details": {
          "function_name": "putback_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1789-1801",
          "snippet": "static enum fullness_group putback_zspage(struct size_class *class,\n\t\t\tstruct zspage *zspage)\n{\n\tenum fullness_group fullness;\n\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tfullness = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, fullness);\n\tset_zspage_mapping(zspage, class->index, fullness);\n\n\treturn fullness;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic enum fullness_group putback_zspage(struct size_class *class,\n\t\t\tstruct zspage *zspage)\n{\n\tenum fullness_group fullness;\n\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tfullness = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, fullness);\n\tset_zspage_mapping(zspage, class->index, fullness);\n\n\treturn fullness;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_zspage_isolated",
          "args": [
            "zspage"
          ],
          "line": 2099
        },
        "resolved": true,
        "details": {
          "function_name": "is_zspage_isolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "457-460",
          "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dec_zspage_isolation",
          "args": [
            "zspage"
          ],
          "line": 2098
        },
        "resolved": true,
        "details": {
          "function_name": "dec_zspage_isolation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1880-1883",
          "snippet": "static void dec_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated--;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void dec_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 2097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_mapping",
          "args": [
            "page"
          ],
          "line": 2093
        },
        "resolved": true,
        "details": {
          "function_name": "page_mapping_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "528-533",
          "snippet": "struct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nstruct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&fg"
          ],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage",
          "args": [
            "page"
          ],
          "line": 2091
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!PageIsolated(page)",
            "page"
          ],
          "line": 2089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageIsolated",
          "args": [
            "page"
          ],
          "line": 2089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!PageMovable(page)",
            "page"
          ],
          "line": 2088
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageMovable",
          "args": [
            "page"
          ],
          "line": 2088
        },
        "resolved": true,
        "details": {
          "function_name": "__ClearPageMovable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/compaction.c",
          "lines": "120-131",
          "snippet": "void __ClearPageMovable(struct page *page)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\t/*\n\t * Clear registered address_space val with keeping PAGE_MAPPING_MOVABLE\n\t * flag so that VM can catch up released page by driver after isolation.\n\t * With it, VM migration doesn't try to put it back.\n\t */\n\tpage->mapping = (void *)((unsigned long)page->mapping &\n\t\t\t\tPAGE_MAPPING_MOVABLE);\n}",
          "includes": [
            "#include <trace/events/compaction.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kasan.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/compaction.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/page_owner.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/kasan.h>\n#include <linux/page-isolation.h>\n#include <linux/sysfs.h>\n#include <linux/sysctl.h>\n#include <linux/backing-dev.h>\n#include <linux/sched/signal.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/cpu.h>\n\nvoid __ClearPageMovable(struct page *page)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\t/*\n\t * Clear registered address_space val with keeping PAGE_MAPPING_MOVABLE\n\t * flag so that VM can catch up released page by driver after isolation.\n\t * With it, VM migration doesn't try to put it back.\n\t */\n\tpage->mapping = (void *)((unsigned long)page->mapping &\n\t\t\t\tPAGE_MAPPING_MOVABLE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_page_putback(struct page *page)\n{\n\tstruct zs_pool *pool;\n\tstruct size_class *class;\n\tint class_idx;\n\tenum fullness_group fg;\n\tstruct address_space *mapping;\n\tstruct zspage *zspage;\n\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\tVM_BUG_ON_PAGE(!PageIsolated(page), page);\n\n\tzspage = get_zspage(page);\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tmapping = page_mapping(page);\n\tpool = mapping->private_data;\n\tclass = pool->size_class[class_idx];\n\n\tspin_lock(&class->lock);\n\tdec_zspage_isolation(zspage);\n\tif (!is_zspage_isolated(zspage)) {\n\t\tfg = putback_zspage(class, zspage);\n\t\t/*\n\t\t * Due to page_lock, we cannot free zspage immediately\n\t\t * so let's defer.\n\t\t */\n\t\tif (fg == ZS_EMPTY)\n\t\t\tschedule_work(&pool->free_work);\n\t}\n\tspin_unlock(&class->lock);\n}"
  },
  {
    "function_name": "zs_page_migrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1963-2077",
    "snippet": "static int zs_page_migrate(struct address_space *mapping, struct page *newpage,\n\t\tstruct page *page, enum migrate_mode mode)\n{\n\tstruct zs_pool *pool;\n\tstruct size_class *class;\n\tint class_idx;\n\tenum fullness_group fullness;\n\tstruct zspage *zspage;\n\tstruct page *dummy;\n\tvoid *s_addr, *d_addr, *addr;\n\tint offset, pos;\n\tunsigned long handle, head;\n\tunsigned long old_obj, new_obj;\n\tunsigned int obj_idx;\n\tint ret = -EAGAIN;\n\n\t/*\n\t * We cannot support the _NO_COPY case here, because copy needs to\n\t * happen under the zs lock, which does not work with\n\t * MIGRATE_SYNC_NO_COPY workflow.\n\t */\n\tif (mode == MIGRATE_SYNC_NO_COPY)\n\t\treturn -EINVAL;\n\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\tVM_BUG_ON_PAGE(!PageIsolated(page), page);\n\n\tzspage = get_zspage(page);\n\n\t/* Concurrent compactor cannot migrate any subpage in zspage */\n\tmigrate_write_lock(zspage);\n\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\tpool = mapping->private_data;\n\tclass = pool->size_class[class_idx];\n\toffset = get_first_obj_offset(page);\n\n\tspin_lock(&class->lock);\n\tif (!get_zspage_inuse(zspage)) {\n\t\t/*\n\t\t * Set \"offset\" to end of the page so that every loops\n\t\t * skips unnecessary object scanning.\n\t\t */\n\t\toffset = PAGE_SIZE;\n\t}\n\n\tpos = offset;\n\ts_addr = kmap_atomic(page);\n\twhile (pos < PAGE_SIZE) {\n\t\thead = obj_to_head(page, s_addr + pos);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (!trypin_tag(handle))\n\t\t\t\tgoto unpin_objects;\n\t\t}\n\t\tpos += class->size;\n\t}\n\n\t/*\n\t * Here, any user cannot access all objects in the zspage so let's move.\n\t */\n\td_addr = kmap_atomic(newpage);\n\tmemcpy(d_addr, s_addr, PAGE_SIZE);\n\tkunmap_atomic(d_addr);\n\n\tfor (addr = s_addr + offset; addr < s_addr + pos;\n\t\t\t\t\taddr += class->size) {\n\t\thead = obj_to_head(page, addr);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (!testpin_tag(handle))\n\t\t\t\tBUG();\n\n\t\t\told_obj = handle_to_obj(handle);\n\t\t\tobj_to_location(old_obj, &dummy, &obj_idx);\n\t\t\tnew_obj = (unsigned long)location_to_obj(newpage,\n\t\t\t\t\t\t\t\tobj_idx);\n\t\t\tnew_obj |= BIT(HANDLE_PIN_BIT);\n\t\t\trecord_obj(handle, new_obj);\n\t\t}\n\t}\n\n\treplace_sub_page(class, zspage, newpage, page);\n\tget_page(newpage);\n\n\tdec_zspage_isolation(zspage);\n\n\t/*\n\t * Page migration is done so let's putback isolated zspage to\n\t * the list if @page is final isolated subpage in the zspage.\n\t */\n\tif (!is_zspage_isolated(zspage))\n\t\tputback_zspage(class, zspage);\n\n\treset_page(page);\n\tput_page(page);\n\tpage = newpage;\n\n\tret = MIGRATEPAGE_SUCCESS;\nunpin_objects:\n\tfor (addr = s_addr + offset; addr < s_addr + pos;\n\t\t\t\t\t\taddr += class->size) {\n\t\thead = obj_to_head(page, addr);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (!testpin_tag(handle))\n\t\t\t\tBUG();\n\t\t\tunpin_tag(handle);\n\t\t}\n\t}\n\tkunmap_atomic(s_addr);\n\tspin_unlock(&class->lock);\n\tmigrate_write_unlock(zspage);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define OBJ_ALLOCATED_TAG 1",
      "#define HANDLE_PIN_BIT\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "migrate_write_unlock",
          "args": [
            "zspage"
          ],
          "line": 2074
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_write_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1869-1872",
          "snippet": "static void migrate_write_unlock(struct zspage *zspage)\n{\n\twrite_unlock(&zspage->lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_write_unlock(struct zspage *zspage)\n{\n\twrite_unlock(&zspage->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 2073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "s_addr"
          ],
          "line": 2072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unpin_tag",
          "args": [
            "handle"
          ],
          "line": 2069
        },
        "resolved": true,
        "details": {
          "function_name": "unpin_tag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "912-915",
          "snippet": "static void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 2068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testpin_tag",
          "args": [
            "handle"
          ],
          "line": 2067
        },
        "resolved": true,
        "details": {
          "function_name": "testpin_tag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "897-900",
          "snippet": "static inline int testpin_tag(unsigned long handle)\n{\n\treturn bit_spin_is_locked(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic inline int testpin_tag(unsigned long handle)\n{\n\treturn bit_spin_is_locked(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_to_head",
          "args": [
            "page",
            "addr"
          ],
          "line": 2064
        },
        "resolved": true,
        "details": {
          "function_name": "obj_to_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "888-895",
          "snippet": "static unsigned long obj_to_head(struct page *page, void *obj)\n{\n\tif (unlikely(PageHugeObject(page))) {\n\t\tVM_BUG_ON_PAGE(!is_first_page(page), page);\n\t\treturn page->index;\n\t} else\n\t\treturn *(unsigned long *)obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long obj_to_head(struct page *page, void *obj)\n{\n\tif (unlikely(PageHugeObject(page))) {\n\t\tVM_BUG_ON_PAGE(!is_first_page(page), page);\n\t\treturn page->index;\n\t} else\n\t\treturn *(unsigned long *)obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 2057
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "reset_page",
          "args": [
            "page"
          ],
          "line": 2056
        },
        "resolved": true,
        "details": {
          "function_name": "reset_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "917-925",
          "snippet": "static void reset_page(struct page *page)\n{\n\t__ClearPageMovable(page);\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_mapcount_reset(page);\n\tClearPageHugeObject(page);\n\tpage->freelist = NULL;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void reset_page(struct page *page)\n{\n\t__ClearPageMovable(page);\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_mapcount_reset(page);\n\tClearPageHugeObject(page);\n\tpage->freelist = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "putback_zspage",
          "args": [
            "class",
            "zspage"
          ],
          "line": 2054
        },
        "resolved": true,
        "details": {
          "function_name": "putback_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1789-1801",
          "snippet": "static enum fullness_group putback_zspage(struct size_class *class,\n\t\t\tstruct zspage *zspage)\n{\n\tenum fullness_group fullness;\n\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tfullness = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, fullness);\n\tset_zspage_mapping(zspage, class->index, fullness);\n\n\treturn fullness;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic enum fullness_group putback_zspage(struct size_class *class,\n\t\t\tstruct zspage *zspage)\n{\n\tenum fullness_group fullness;\n\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tfullness = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, fullness);\n\tset_zspage_mapping(zspage, class->index, fullness);\n\n\treturn fullness;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_zspage_isolated",
          "args": [
            "zspage"
          ],
          "line": 2053
        },
        "resolved": true,
        "details": {
          "function_name": "is_zspage_isolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "457-460",
          "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dec_zspage_isolation",
          "args": [
            "zspage"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "dec_zspage_isolation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1880-1883",
          "snippet": "static void dec_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated--;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void dec_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated--;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_page",
          "args": [
            "newpage"
          ],
          "line": 2045
        },
        "resolved": true,
        "details": {
          "function_name": "get_pages_per_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "814-835",
          "snippet": "static int get_pages_per_zspage(int class_size)\n{\n\tint i, max_usedpc = 0;\n\t/* zspage order which gives maximum used size per KB */\n\tint max_usedpc_order = 1;\n\n\tfor (i = 1; i <= ZS_MAX_PAGES_PER_ZSPAGE; i++) {\n\t\tint zspage_size;\n\t\tint waste, usedpc;\n\n\t\tzspage_size = i * PAGE_SIZE;\n\t\twaste = zspage_size % class_size;\n\t\tusedpc = (zspage_size - waste) * 100 / zspage_size;\n\n\t\tif (usedpc > max_usedpc) {\n\t\t\tmax_usedpc = usedpc;\n\t\t\tmax_usedpc_order = i;\n\t\t}\n\t}\n\n\treturn max_usedpc_order;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)\n\nstatic int get_pages_per_zspage(int class_size)\n{\n\tint i, max_usedpc = 0;\n\t/* zspage order which gives maximum used size per KB */\n\tint max_usedpc_order = 1;\n\n\tfor (i = 1; i <= ZS_MAX_PAGES_PER_ZSPAGE; i++) {\n\t\tint zspage_size;\n\t\tint waste, usedpc;\n\n\t\tzspage_size = i * PAGE_SIZE;\n\t\twaste = zspage_size % class_size;\n\t\tusedpc = (zspage_size - waste) * 100 / zspage_size;\n\n\t\tif (usedpc > max_usedpc) {\n\t\t\tmax_usedpc = usedpc;\n\t\t\tmax_usedpc_order = i;\n\t\t}\n\t}\n\n\treturn max_usedpc_order;\n}"
        }
      },
      {
        "call_info": {
          "callee": "replace_sub_page",
          "args": [
            "class",
            "zspage",
            "newpage",
            "page"
          ],
          "line": 2044
        },
        "resolved": true,
        "details": {
          "function_name": "replace_sub_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1885-1906",
          "snippet": "static void replace_sub_page(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *newpage, struct page *oldpage)\n{\n\tstruct page *page;\n\tstruct page *pages[ZS_MAX_PAGES_PER_ZSPAGE] = {NULL, };\n\tint idx = 0;\n\n\tpage = get_first_page(zspage);\n\tdo {\n\t\tif (page == oldpage)\n\t\t\tpages[idx] = newpage;\n\t\telse\n\t\t\tpages[idx] = page;\n\t\tidx++;\n\t} while ((page = get_next_page(page)) != NULL);\n\n\tcreate_page_chain(class, zspage, pages);\n\tset_first_obj_offset(newpage, get_first_obj_offset(oldpage));\n\tif (unlikely(PageHugeObject(oldpage)))\n\t\tnewpage->index = oldpage->index;\n\t__SetPageMovable(newpage, page_mapping(oldpage));\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)\n\nstatic void replace_sub_page(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *newpage, struct page *oldpage)\n{\n\tstruct page *page;\n\tstruct page *pages[ZS_MAX_PAGES_PER_ZSPAGE] = {NULL, };\n\tint idx = 0;\n\n\tpage = get_first_page(zspage);\n\tdo {\n\t\tif (page == oldpage)\n\t\t\tpages[idx] = newpage;\n\t\telse\n\t\t\tpages[idx] = page;\n\t\tidx++;\n\t} while ((page = get_next_page(page)) != NULL);\n\n\tcreate_page_chain(class, zspage, pages);\n\tset_first_obj_offset(newpage, get_first_obj_offset(oldpage));\n\tif (unlikely(PageHugeObject(oldpage)))\n\t\tnewpage->index = oldpage->index;\n\t__SetPageMovable(newpage, page_mapping(oldpage));\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_obj",
          "args": [
            "handle",
            "new_obj"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "record_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "367-375",
          "snippet": "static void record_obj(unsigned long handle, unsigned long obj)\n{\n\t/*\n\t * lsb of @obj represents handle lock while other bits\n\t * represent object value the handle is pointing so\n\t * updating shouldn't do store tearing.\n\t */\n\tWRITE_ONCE(*(unsigned long *)handle, obj);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void record_obj(unsigned long handle, unsigned long obj)\n{\n\t/*\n\t * lsb of @obj represents handle lock while other bits\n\t * represent object value the handle is pointing so\n\t * updating shouldn't do store tearing.\n\t */\n\tWRITE_ONCE(*(unsigned long *)handle, obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIT",
          "args": [
            "HANDLE_PIN_BIT"
          ],
          "line": 2039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "location_to_obj",
          "args": [
            "newpage",
            "obj_idx"
          ],
          "line": 2037
        },
        "resolved": true,
        "details": {
          "function_name": "location_to_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "872-881",
          "snippet": "static unsigned long location_to_obj(struct page *page, unsigned int obj_idx)\n{\n\tunsigned long obj;\n\n\tobj = page_to_pfn(page) << OBJ_INDEX_BITS;\n\tobj |= obj_idx & OBJ_INDEX_MASK;\n\tobj <<= OBJ_TAG_BITS;\n\n\treturn obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
            "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic unsigned long location_to_obj(struct page *page, unsigned int obj_idx)\n{\n\tunsigned long obj;\n\n\tobj = page_to_pfn(page) << OBJ_INDEX_BITS;\n\tobj |= obj_idx & OBJ_INDEX_MASK;\n\tobj <<= OBJ_TAG_BITS;\n\n\treturn obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_to_location",
          "args": [
            "old_obj",
            "&dummy",
            "&obj_idx"
          ],
          "line": 2036
        },
        "resolved": true,
        "details": {
          "function_name": "obj_to_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "859-865",
          "snippet": "static void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
            "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle_to_obj",
          "args": [
            "handle"
          ],
          "line": 2035
        },
        "resolved": true,
        "details": {
          "function_name": "handle_to_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "883-886",
          "snippet": "static unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 2033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "d_addr"
          ],
          "line": 2025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "d_addr",
            "s_addr",
            "PAGE_SIZE"
          ],
          "line": 2024
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "newpage"
          ],
          "line": 2023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trypin_tag",
          "args": [
            "handle"
          ],
          "line": 2014
        },
        "resolved": true,
        "details": {
          "function_name": "trypin_tag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "902-905",
          "snippet": "static inline int trypin_tag(unsigned long handle)\n{\n\treturn bit_spin_trylock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic inline int trypin_tag(unsigned long handle)\n{\n\treturn bit_spin_trylock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 2009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_inuse",
          "args": [
            "zspage"
          ],
          "line": 2000
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "468-471",
          "snippet": "static inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 1999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_first_obj_offset",
          "args": [
            "page"
          ],
          "line": 1997
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_obj_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "491-494",
          "snippet": "static inline int get_first_obj_offset(struct page *page)\n{\n\treturn page->units;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_first_obj_offset(struct page *page)\n{\n\treturn page->units;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&fullness"
          ],
          "line": 1994
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      },
      {
        "call_info": {
          "callee": "migrate_write_lock",
          "args": [
            "zspage"
          ],
          "line": 1993
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_write_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1864-1867",
          "snippet": "static void migrate_write_lock(struct zspage *zspage)\n{\n\twrite_lock(&zspage->lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_write_lock(struct zspage *zspage)\n{\n\twrite_lock(&zspage->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage",
          "args": [
            "page"
          ],
          "line": 1990
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!PageIsolated(page)",
            "page"
          ],
          "line": 1988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageIsolated",
          "args": [
            "page"
          ],
          "line": 1988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!PageMovable(page)",
            "page"
          ],
          "line": 1987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageMovable",
          "args": [
            "page"
          ],
          "line": 1987
        },
        "resolved": true,
        "details": {
          "function_name": "__ClearPageMovable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/compaction.c",
          "lines": "120-131",
          "snippet": "void __ClearPageMovable(struct page *page)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\t/*\n\t * Clear registered address_space val with keeping PAGE_MAPPING_MOVABLE\n\t * flag so that VM can catch up released page by driver after isolation.\n\t * With it, VM migration doesn't try to put it back.\n\t */\n\tpage->mapping = (void *)((unsigned long)page->mapping &\n\t\t\t\tPAGE_MAPPING_MOVABLE);\n}",
          "includes": [
            "#include <trace/events/compaction.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kasan.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/compaction.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/page_owner.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/kasan.h>\n#include <linux/page-isolation.h>\n#include <linux/sysfs.h>\n#include <linux/sysctl.h>\n#include <linux/backing-dev.h>\n#include <linux/sched/signal.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/cpu.h>\n\nvoid __ClearPageMovable(struct page *page)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\t/*\n\t * Clear registered address_space val with keeping PAGE_MAPPING_MOVABLE\n\t * flag so that VM can catch up released page by driver after isolation.\n\t * With it, VM migration doesn't try to put it back.\n\t */\n\tpage->mapping = (void *)((unsigned long)page->mapping &\n\t\t\t\tPAGE_MAPPING_MOVABLE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_ALLOCATED_TAG 1\n#define HANDLE_PIN_BIT\t0\n\nstatic int zs_page_migrate(struct address_space *mapping, struct page *newpage,\n\t\tstruct page *page, enum migrate_mode mode)\n{\n\tstruct zs_pool *pool;\n\tstruct size_class *class;\n\tint class_idx;\n\tenum fullness_group fullness;\n\tstruct zspage *zspage;\n\tstruct page *dummy;\n\tvoid *s_addr, *d_addr, *addr;\n\tint offset, pos;\n\tunsigned long handle, head;\n\tunsigned long old_obj, new_obj;\n\tunsigned int obj_idx;\n\tint ret = -EAGAIN;\n\n\t/*\n\t * We cannot support the _NO_COPY case here, because copy needs to\n\t * happen under the zs lock, which does not work with\n\t * MIGRATE_SYNC_NO_COPY workflow.\n\t */\n\tif (mode == MIGRATE_SYNC_NO_COPY)\n\t\treturn -EINVAL;\n\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\tVM_BUG_ON_PAGE(!PageIsolated(page), page);\n\n\tzspage = get_zspage(page);\n\n\t/* Concurrent compactor cannot migrate any subpage in zspage */\n\tmigrate_write_lock(zspage);\n\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\tpool = mapping->private_data;\n\tclass = pool->size_class[class_idx];\n\toffset = get_first_obj_offset(page);\n\n\tspin_lock(&class->lock);\n\tif (!get_zspage_inuse(zspage)) {\n\t\t/*\n\t\t * Set \"offset\" to end of the page so that every loops\n\t\t * skips unnecessary object scanning.\n\t\t */\n\t\toffset = PAGE_SIZE;\n\t}\n\n\tpos = offset;\n\ts_addr = kmap_atomic(page);\n\twhile (pos < PAGE_SIZE) {\n\t\thead = obj_to_head(page, s_addr + pos);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (!trypin_tag(handle))\n\t\t\t\tgoto unpin_objects;\n\t\t}\n\t\tpos += class->size;\n\t}\n\n\t/*\n\t * Here, any user cannot access all objects in the zspage so let's move.\n\t */\n\td_addr = kmap_atomic(newpage);\n\tmemcpy(d_addr, s_addr, PAGE_SIZE);\n\tkunmap_atomic(d_addr);\n\n\tfor (addr = s_addr + offset; addr < s_addr + pos;\n\t\t\t\t\taddr += class->size) {\n\t\thead = obj_to_head(page, addr);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (!testpin_tag(handle))\n\t\t\t\tBUG();\n\n\t\t\told_obj = handle_to_obj(handle);\n\t\t\tobj_to_location(old_obj, &dummy, &obj_idx);\n\t\t\tnew_obj = (unsigned long)location_to_obj(newpage,\n\t\t\t\t\t\t\t\tobj_idx);\n\t\t\tnew_obj |= BIT(HANDLE_PIN_BIT);\n\t\t\trecord_obj(handle, new_obj);\n\t\t}\n\t}\n\n\treplace_sub_page(class, zspage, newpage, page);\n\tget_page(newpage);\n\n\tdec_zspage_isolation(zspage);\n\n\t/*\n\t * Page migration is done so let's putback isolated zspage to\n\t * the list if @page is final isolated subpage in the zspage.\n\t */\n\tif (!is_zspage_isolated(zspage))\n\t\tputback_zspage(class, zspage);\n\n\treset_page(page);\n\tput_page(page);\n\tpage = newpage;\n\n\tret = MIGRATEPAGE_SUCCESS;\nunpin_objects:\n\tfor (addr = s_addr + offset; addr < s_addr + pos;\n\t\t\t\t\t\taddr += class->size) {\n\t\thead = obj_to_head(page, addr);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (!testpin_tag(handle))\n\t\t\t\tBUG();\n\t\t\tunpin_tag(handle);\n\t\t}\n\t}\n\tkunmap_atomic(s_addr);\n\tspin_unlock(&class->lock);\n\tmigrate_write_unlock(zspage);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "zs_page_isolate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1908-1961",
    "snippet": "static bool zs_page_isolate(struct page *page, isolate_mode_t mode)\n{\n\tstruct zs_pool *pool;\n\tstruct size_class *class;\n\tint class_idx;\n\tenum fullness_group fullness;\n\tstruct zspage *zspage;\n\tstruct address_space *mapping;\n\n\t/*\n\t * Page is locked so zspage couldn't be destroyed. For detail, look at\n\t * lock_zspage in free_zspage.\n\t */\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\tVM_BUG_ON_PAGE(PageIsolated(page), page);\n\n\tzspage = get_zspage(page);\n\n\t/*\n\t * Without class lock, fullness could be stale while class_idx is okay\n\t * because class_idx is constant unless page is freed so we should get\n\t * fullness again under class lock.\n\t */\n\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\tmapping = page_mapping(page);\n\tpool = mapping->private_data;\n\tclass = pool->size_class[class_idx];\n\n\tspin_lock(&class->lock);\n\tif (get_zspage_inuse(zspage) == 0) {\n\t\tspin_unlock(&class->lock);\n\t\treturn false;\n\t}\n\n\t/* zspage is isolated for object migration */\n\tif (list_empty(&zspage->list) && !is_zspage_isolated(zspage)) {\n\t\tspin_unlock(&class->lock);\n\t\treturn false;\n\t}\n\n\t/*\n\t * If this is first time isolation for the zspage, isolate zspage from\n\t * size_class to prevent further object allocation from the zspage.\n\t */\n\tif (!list_empty(&zspage->list) && !is_zspage_isolated(zspage)) {\n\t\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\t\tremove_zspage(class, zspage, fullness);\n\t}\n\n\tinc_zspage_isolation(zspage);\n\tspin_unlock(&class->lock);\n\n\treturn true;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 1958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inc_zspage_isolation",
          "args": [
            "zspage"
          ],
          "line": 1957
        },
        "resolved": true,
        "details": {
          "function_name": "inc_zspage_isolation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1875-1878",
          "snippet": "static void inc_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated++;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void inc_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_zspage",
          "args": [
            "class",
            "zspage",
            "fullness"
          ],
          "line": 1954
        },
        "resolved": true,
        "details": {
          "function_name": "remove_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "759-768",
          "snippet": "static void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&fullness"
          ],
          "line": 1953
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_zspage_isolated",
          "args": [
            "zspage"
          ],
          "line": 1952
        },
        "resolved": true,
        "details": {
          "function_name": "is_zspage_isolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "457-460",
          "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&zspage->list"
          ],
          "line": 1952
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 1944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 1938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_inuse",
          "args": [
            "zspage"
          ],
          "line": 1937
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "468-471",
          "snippet": "static inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 1936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_mapping",
          "args": [
            "page"
          ],
          "line": 1932
        },
        "resolved": true,
        "details": {
          "function_name": "page_mapping_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "528-533",
          "snippet": "struct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nstruct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage",
          "args": [
            "page"
          ],
          "line": 1924
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "PageIsolated(page)",
            "page"
          ],
          "line": 1922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageIsolated",
          "args": [
            "page"
          ],
          "line": 1922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!PageMovable(page)",
            "page"
          ],
          "line": 1921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageMovable",
          "args": [
            "page"
          ],
          "line": 1921
        },
        "resolved": true,
        "details": {
          "function_name": "__ClearPageMovable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/compaction.c",
          "lines": "120-131",
          "snippet": "void __ClearPageMovable(struct page *page)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\t/*\n\t * Clear registered address_space val with keeping PAGE_MAPPING_MOVABLE\n\t * flag so that VM can catch up released page by driver after isolation.\n\t * With it, VM migration doesn't try to put it back.\n\t */\n\tpage->mapping = (void *)((unsigned long)page->mapping &\n\t\t\t\tPAGE_MAPPING_MOVABLE);\n}",
          "includes": [
            "#include <trace/events/compaction.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kasan.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/compaction.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/page_owner.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/kasan.h>\n#include <linux/page-isolation.h>\n#include <linux/sysfs.h>\n#include <linux/sysctl.h>\n#include <linux/backing-dev.h>\n#include <linux/sched/signal.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/cpu.h>\n\nvoid __ClearPageMovable(struct page *page)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\t/*\n\t * Clear registered address_space val with keeping PAGE_MAPPING_MOVABLE\n\t * flag so that VM can catch up released page by driver after isolation.\n\t * With it, VM migration doesn't try to put it back.\n\t */\n\tpage->mapping = (void *)((unsigned long)page->mapping &\n\t\t\t\tPAGE_MAPPING_MOVABLE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool zs_page_isolate(struct page *page, isolate_mode_t mode)\n{\n\tstruct zs_pool *pool;\n\tstruct size_class *class;\n\tint class_idx;\n\tenum fullness_group fullness;\n\tstruct zspage *zspage;\n\tstruct address_space *mapping;\n\n\t/*\n\t * Page is locked so zspage couldn't be destroyed. For detail, look at\n\t * lock_zspage in free_zspage.\n\t */\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\tVM_BUG_ON_PAGE(PageIsolated(page), page);\n\n\tzspage = get_zspage(page);\n\n\t/*\n\t * Without class lock, fullness could be stale while class_idx is okay\n\t * because class_idx is constant unless page is freed so we should get\n\t * fullness again under class lock.\n\t */\n\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\tmapping = page_mapping(page);\n\tpool = mapping->private_data;\n\tclass = pool->size_class[class_idx];\n\n\tspin_lock(&class->lock);\n\tif (get_zspage_inuse(zspage) == 0) {\n\t\tspin_unlock(&class->lock);\n\t\treturn false;\n\t}\n\n\t/* zspage is isolated for object migration */\n\tif (list_empty(&zspage->list) && !is_zspage_isolated(zspage)) {\n\t\tspin_unlock(&class->lock);\n\t\treturn false;\n\t}\n\n\t/*\n\t * If this is first time isolation for the zspage, isolate zspage from\n\t * size_class to prevent further object allocation from the zspage.\n\t */\n\tif (!list_empty(&zspage->list) && !is_zspage_isolated(zspage)) {\n\t\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\t\tremove_zspage(class, zspage, fullness);\n\t}\n\n\tinc_zspage_isolation(zspage);\n\tspin_unlock(&class->lock);\n\n\treturn true;\n}"
  },
  {
    "function_name": "replace_sub_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1885-1906",
    "snippet": "static void replace_sub_page(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *newpage, struct page *oldpage)\n{\n\tstruct page *page;\n\tstruct page *pages[ZS_MAX_PAGES_PER_ZSPAGE] = {NULL, };\n\tint idx = 0;\n\n\tpage = get_first_page(zspage);\n\tdo {\n\t\tif (page == oldpage)\n\t\t\tpages[idx] = newpage;\n\t\telse\n\t\t\tpages[idx] = page;\n\t\tidx++;\n\t} while ((page = get_next_page(page)) != NULL);\n\n\tcreate_page_chain(class, zspage, pages);\n\tset_first_obj_offset(newpage, get_first_obj_offset(oldpage));\n\tif (unlikely(PageHugeObject(oldpage)))\n\t\tnewpage->index = oldpage->index;\n\t__SetPageMovable(newpage, page_mapping(oldpage));\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__SetPageMovable",
          "args": [
            "newpage",
            "page_mapping(oldpage)"
          ],
          "line": 1905
        },
        "resolved": true,
        "details": {
          "function_name": "__SetPageMovable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/compaction.c",
          "lines": "112-117",
          "snippet": "void __SetPageMovable(struct page *page, struct address_space *mapping)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE((unsigned long)mapping & PAGE_MAPPING_MOVABLE, page);\n\tpage->mapping = (void *)((unsigned long)mapping | PAGE_MAPPING_MOVABLE);\n}",
          "includes": [
            "#include <trace/events/compaction.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kasan.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/compaction.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/page_owner.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/kasan.h>\n#include <linux/page-isolation.h>\n#include <linux/sysfs.h>\n#include <linux/sysctl.h>\n#include <linux/backing-dev.h>\n#include <linux/sched/signal.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/cpu.h>\n\nvoid __SetPageMovable(struct page *page, struct address_space *mapping)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE((unsigned long)mapping & PAGE_MAPPING_MOVABLE, page);\n\tpage->mapping = (void *)((unsigned long)mapping | PAGE_MAPPING_MOVABLE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_mapping",
          "args": [
            "oldpage"
          ],
          "line": 1905
        },
        "resolved": true,
        "details": {
          "function_name": "page_mapping_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "528-533",
          "snippet": "struct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nstruct address_space *page_mapping_file(struct page *page)\n{\n\tif (unlikely(PageSwapCache(page)))\n\t\treturn NULL;\n\treturn page_mapping(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "PageHugeObject(oldpage)"
          ],
          "line": 1903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHugeObject",
          "args": [
            "oldpage"
          ],
          "line": 1903
        },
        "resolved": true,
        "details": {
          "function_name": "PageHugeObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "225-228",
          "snippet": "static int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_first_obj_offset",
          "args": [
            "newpage",
            "get_first_obj_offset(oldpage)"
          ],
          "line": 1902
        },
        "resolved": true,
        "details": {
          "function_name": "set_first_obj_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "496-499",
          "snippet": "static inline void set_first_obj_offset(struct page *page, int offset)\n{\n\tpage->units = offset;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void set_first_obj_offset(struct page *page, int offset)\n{\n\tpage->units = offset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_first_obj_offset",
          "args": [
            "oldpage"
          ],
          "line": 1902
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_obj_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "491-494",
          "snippet": "static inline int get_first_obj_offset(struct page *page)\n{\n\treturn page->units;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_first_obj_offset(struct page *page)\n{\n\treturn page->units;\n}"
        }
      },
      {
        "call_info": {
          "callee": "create_page_chain",
          "args": [
            "class",
            "zspage",
            "pages"
          ],
          "line": 1901
        },
        "resolved": true,
        "details": {
          "function_name": "create_page_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1040-1071",
          "snippet": "static void create_page_chain(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *pages[])\n{\n\tint i;\n\tstruct page *page;\n\tstruct page *prev_page = NULL;\n\tint nr_pages = class->pages_per_zspage;\n\n\t/*\n\t * Allocate individual pages and link them together as:\n\t * 1. all pages are linked together using page->freelist\n\t * 2. each sub-page point to zspage using page->private\n\t *\n\t * we set PG_private to identify the first page (i.e. no other sub-page\n\t * has this flag set).\n\t */\n\tfor (i = 0; i < nr_pages; i++) {\n\t\tpage = pages[i];\n\t\tset_page_private(page, (unsigned long)zspage);\n\t\tpage->freelist = NULL;\n\t\tif (i == 0) {\n\t\t\tzspage->first_page = page;\n\t\t\tSetPagePrivate(page);\n\t\t\tif (unlikely(class->objs_per_zspage == 1 &&\n\t\t\t\t\tclass->pages_per_zspage == 1))\n\t\t\t\tSetPageHugeObject(page);\n\t\t} else {\n\t\t\tprev_page->freelist = page;\n\t\t}\n\t\tprev_page = page;\n\t}\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void create_page_chain(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *pages[])\n{\n\tint i;\n\tstruct page *page;\n\tstruct page *prev_page = NULL;\n\tint nr_pages = class->pages_per_zspage;\n\n\t/*\n\t * Allocate individual pages and link them together as:\n\t * 1. all pages are linked together using page->freelist\n\t * 2. each sub-page point to zspage using page->private\n\t *\n\t * we set PG_private to identify the first page (i.e. no other sub-page\n\t * has this flag set).\n\t */\n\tfor (i = 0; i < nr_pages; i++) {\n\t\tpage = pages[i];\n\t\tset_page_private(page, (unsigned long)zspage);\n\t\tpage->freelist = NULL;\n\t\tif (i == 0) {\n\t\t\tzspage->first_page = page;\n\t\t\tSetPagePrivate(page);\n\t\t\tif (unlikely(class->objs_per_zspage == 1 &&\n\t\t\t\t\tclass->pages_per_zspage == 1))\n\t\t\t\tSetPageHugeObject(page);\n\t\t} else {\n\t\t\tprev_page->freelist = page;\n\t\t}\n\t\tprev_page = page;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "page"
          ],
          "line": 1899
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_first_page",
          "args": [
            "zspage"
          ],
          "line": 1892
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "483-489",
          "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)\n\nstatic void replace_sub_page(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *newpage, struct page *oldpage)\n{\n\tstruct page *page;\n\tstruct page *pages[ZS_MAX_PAGES_PER_ZSPAGE] = {NULL, };\n\tint idx = 0;\n\n\tpage = get_first_page(zspage);\n\tdo {\n\t\tif (page == oldpage)\n\t\t\tpages[idx] = newpage;\n\t\telse\n\t\t\tpages[idx] = page;\n\t\tidx++;\n\t} while ((page = get_next_page(page)) != NULL);\n\n\tcreate_page_chain(class, zspage, pages);\n\tset_first_obj_offset(newpage, get_first_obj_offset(oldpage));\n\tif (unlikely(PageHugeObject(oldpage)))\n\t\tnewpage->index = oldpage->index;\n\t__SetPageMovable(newpage, page_mapping(oldpage));\n}"
  },
  {
    "function_name": "dec_zspage_isolation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1880-1883",
    "snippet": "static void dec_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated--;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void dec_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated--;\n}"
  },
  {
    "function_name": "inc_zspage_isolation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1875-1878",
    "snippet": "static void inc_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated++;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void inc_zspage_isolation(struct zspage *zspage)\n{\n\tzspage->isolated++;\n}"
  },
  {
    "function_name": "migrate_write_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1869-1872",
    "snippet": "static void migrate_write_unlock(struct zspage *zspage)\n{\n\twrite_unlock(&zspage->lock);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_unlock",
          "args": [
            "&zspage->lock"
          ],
          "line": 1871
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_write_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1869-1872",
          "snippet": "static void migrate_write_unlock(struct zspage *zspage)\n{\n\twrite_unlock(&zspage->lock);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_write_unlock(struct zspage *zspage)\n{\n\twrite_unlock(&zspage->lock);\n}"
  },
  {
    "function_name": "migrate_write_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1864-1867",
    "snippet": "static void migrate_write_lock(struct zspage *zspage)\n{\n\twrite_lock(&zspage->lock);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write_lock",
          "args": [
            "&zspage->lock"
          ],
          "line": 1866
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_write_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1864-1867",
          "snippet": "static void migrate_write_lock(struct zspage *zspage)\n{\n\twrite_lock(&zspage->lock);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_write_lock(struct zspage *zspage)\n{\n\twrite_lock(&zspage->lock);\n}"
  },
  {
    "function_name": "migrate_read_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1859-1862",
    "snippet": "static void migrate_read_unlock(struct zspage *zspage)\n{\n\tread_unlock(&zspage->lock);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_unlock",
          "args": [
            "&zspage->lock"
          ],
          "line": 1861
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_read_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1859-1862",
          "snippet": "static void migrate_read_unlock(struct zspage *zspage)\n{\n\tread_unlock(&zspage->lock);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_read_unlock(struct zspage *zspage)\n{\n\tread_unlock(&zspage->lock);\n}"
  },
  {
    "function_name": "migrate_read_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1854-1857",
    "snippet": "static void migrate_read_lock(struct zspage *zspage)\n{\n\tread_lock(&zspage->lock);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_lock",
          "args": [
            "&zspage->lock"
          ],
          "line": 1856
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_read_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1854-1857",
          "snippet": "static void migrate_read_lock(struct zspage *zspage)\n{\n\tread_lock(&zspage->lock);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_read_lock(struct zspage *zspage)\n{\n\tread_lock(&zspage->lock);\n}"
  },
  {
    "function_name": "migrate_lock_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1849-1852",
    "snippet": "static void migrate_lock_init(struct zspage *zspage)\n{\n\trwlock_init(&zspage->lock);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rwlock_init",
          "args": [
            "&zspage->lock"
          ],
          "line": 1851
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_lock_init(struct zspage *zspage)\n{\n\trwlock_init(&zspage->lock);\n}"
  },
  {
    "function_name": "zsmalloc_unmount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1844-1847",
    "snippet": "static void zsmalloc_unmount(void)\n{\n\tkern_unmount(zsmalloc_mnt);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kern_unmount",
          "args": [
            "zsmalloc_mnt"
          ],
          "line": 1846
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zsmalloc_unmount(void)\n{\n\tkern_unmount(zsmalloc_mnt);\n}"
  },
  {
    "function_name": "zsmalloc_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1833-1842",
    "snippet": "static int zsmalloc_mount(void)\n{\n\tint ret = 0;\n\n\tzsmalloc_mnt = kern_mount(&zsmalloc_fs);\n\tif (IS_ERR(zsmalloc_mnt))\n\t\tret = PTR_ERR(zsmalloc_mnt);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "zsmalloc_mnt"
          ],
          "line": 1839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "zsmalloc_mnt"
          ],
          "line": 1838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kern_mount",
          "args": [
            "&zsmalloc_fs"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zsmalloc_mount(void)\n{\n\tint ret = 0;\n\n\tzsmalloc_mnt = kern_mount(&zsmalloc_fs);\n\tif (IS_ERR(zsmalloc_mnt))\n\t\tret = PTR_ERR(zsmalloc_mnt);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "zs_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1817-1825",
    "snippet": "static struct dentry *zs_mount(struct file_system_type *fs_type,\n\t\t\t\tint flags, const char *dev_name, void *data)\n{\n\tstatic const struct dentry_operations ops = {\n\t\t.d_dname = simple_dname,\n\t};\n\n\treturn mount_pseudo(fs_type, \"zsmalloc:\", NULL, &ops, ZSMALLOC_MAGIC);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mount_pseudo",
          "args": [
            "fs_type",
            "\"zsmalloc:\"",
            "NULL",
            "&ops",
            "ZSMALLOC_MAGIC"
          ],
          "line": 1824
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct dentry *zs_mount(struct file_system_type *fs_type,\n\t\t\t\tint flags, const char *dev_name, void *data)\n{\n\tstatic const struct dentry_operations ops = {\n\t\t.d_dname = simple_dname,\n\t};\n\n\treturn mount_pseudo(fs_type, \"zsmalloc:\", NULL, &ops, ZSMALLOC_MAGIC);\n}"
  },
  {
    "function_name": "lock_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1808-1815",
    "snippet": "static void lock_zspage(struct zspage *zspage)\n{\n\tstruct page *page = get_first_page(zspage);\n\n\tdo {\n\t\tlock_page(page);\n\t} while ((page = get_next_page(page)) != NULL);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "page"
          ],
          "line": 1814
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lock_page",
          "args": [
            "page"
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_first_page",
          "args": [
            "zspage"
          ],
          "line": 1810
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "483-489",
          "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void lock_zspage(struct zspage *zspage)\n{\n\tstruct page *page = get_first_page(zspage);\n\n\tdo {\n\t\tlock_page(page);\n\t} while ((page = get_next_page(page)) != NULL);\n}"
  },
  {
    "function_name": "putback_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1789-1801",
    "snippet": "static enum fullness_group putback_zspage(struct size_class *class,\n\t\t\tstruct zspage *zspage)\n{\n\tenum fullness_group fullness;\n\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tfullness = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, fullness);\n\tset_zspage_mapping(zspage, class->index, fullness);\n\n\treturn fullness;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_zspage_mapping",
          "args": [
            "zspage",
            "class->index",
            "fullness"
          ],
          "line": 1798
        },
        "resolved": true,
        "details": {
          "function_name": "set_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "521-527",
          "snippet": "static void set_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int class_idx,\n\t\t\t\tenum fullness_group fullness)\n{\n\tzspage->class = class_idx;\n\tzspage->fullness = fullness;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void set_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int class_idx,\n\t\t\t\tenum fullness_group fullness)\n{\n\tzspage->class = class_idx;\n\tzspage->fullness = fullness;\n}"
        }
      },
      {
        "call_info": {
          "callee": "insert_zspage",
          "args": [
            "class",
            "zspage",
            "fullness"
          ],
          "line": 1797
        },
        "resolved": true,
        "details": {
          "function_name": "insert_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "733-753",
          "snippet": "static void insert_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tstruct zspage *head;\n\n\tzs_stat_inc(class, fullness, 1);\n\thead = list_first_entry_or_null(&class->fullness_list[fullness],\n\t\t\t\t\tstruct zspage, list);\n\t/*\n\t * We want to see more ZS_FULL pages and less almost empty/full.\n\t * Put pages with higher ->inuse first.\n\t */\n\tif (head) {\n\t\tif (get_zspage_inuse(zspage) < get_zspage_inuse(head)) {\n\t\t\tlist_add(&zspage->list, &head->list);\n\t\t\treturn;\n\t\t}\n\t}\n\tlist_add(&zspage->list, &class->fullness_list[fullness]);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void insert_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tstruct zspage *head;\n\n\tzs_stat_inc(class, fullness, 1);\n\thead = list_first_entry_or_null(&class->fullness_list[fullness],\n\t\t\t\t\tstruct zspage, list);\n\t/*\n\t * We want to see more ZS_FULL pages and less almost empty/full.\n\t * Put pages with higher ->inuse first.\n\t */\n\tif (head) {\n\t\tif (get_zspage_inuse(zspage) < get_zspage_inuse(head)) {\n\t\t\tlist_add(&zspage->list, &head->list);\n\t\t\treturn;\n\t\t}\n\t}\n\tlist_add(&zspage->list, &class->fullness_list[fullness]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_fullness_group",
          "args": [
            "class",
            "zspage"
          ],
          "line": 1796
        },
        "resolved": true,
        "details": {
          "function_name": "get_fullness_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "706-725",
          "snippet": "static enum fullness_group get_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint inuse, objs_per_zspage;\n\tenum fullness_group fg;\n\n\tinuse = get_zspage_inuse(zspage);\n\tobjs_per_zspage = class->objs_per_zspage;\n\n\tif (inuse == 0)\n\t\tfg = ZS_EMPTY;\n\telse if (inuse == objs_per_zspage)\n\t\tfg = ZS_FULL;\n\telse if (inuse <= 3 * objs_per_zspage / fullness_threshold_frac)\n\t\tfg = ZS_ALMOST_EMPTY;\n\telse\n\t\tfg = ZS_ALMOST_FULL;\n\n\treturn fg;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const int fullness_threshold_frac = 4;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const int fullness_threshold_frac = 4;\n\nstatic enum fullness_group get_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint inuse, objs_per_zspage;\n\tenum fullness_group fg;\n\n\tinuse = get_zspage_inuse(zspage);\n\tobjs_per_zspage = class->objs_per_zspage;\n\n\tif (inuse == 0)\n\t\tfg = ZS_EMPTY;\n\telse if (inuse == objs_per_zspage)\n\t\tfg = ZS_FULL;\n\telse if (inuse <= 3 * objs_per_zspage / fullness_threshold_frac)\n\t\tfg = ZS_ALMOST_EMPTY;\n\telse\n\t\tfg = ZS_ALMOST_FULL;\n\n\treturn fg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "is_zspage_isolated(zspage)"
          ],
          "line": 1794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_zspage_isolated",
          "args": [
            "zspage"
          ],
          "line": 1794
        },
        "resolved": true,
        "details": {
          "function_name": "is_zspage_isolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "457-460",
          "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic enum fullness_group putback_zspage(struct size_class *class,\n\t\t\tstruct zspage *zspage)\n{\n\tenum fullness_group fullness;\n\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tfullness = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, fullness);\n\tset_zspage_mapping(zspage, class->index, fullness);\n\n\treturn fullness;\n}"
  },
  {
    "function_name": "isolate_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1758-1780",
    "snippet": "static struct zspage *isolate_zspage(struct size_class *class, bool source)\n{\n\tint i;\n\tstruct zspage *zspage;\n\tenum fullness_group fg[2] = {ZS_ALMOST_EMPTY, ZS_ALMOST_FULL};\n\n\tif (!source) {\n\t\tfg[0] = ZS_ALMOST_FULL;\n\t\tfg[1] = ZS_ALMOST_EMPTY;\n\t}\n\n\tfor (i = 0; i < 2; i++) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[fg[i]],\n\t\t\t\t\t\t\tstruct zspage, list);\n\t\tif (zspage) {\n\t\t\tVM_BUG_ON(is_zspage_isolated(zspage));\n\t\t\tremove_zspage(class, zspage, fg[i]);\n\t\t\treturn zspage;\n\t\t}\n\t}\n\n\treturn zspage;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_zspage",
          "args": [
            "class",
            "zspage",
            "fg[i]"
          ],
          "line": 1774
        },
        "resolved": true,
        "details": {
          "function_name": "remove_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "759-768",
          "snippet": "static void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "is_zspage_isolated(zspage)"
          ],
          "line": 1773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_zspage_isolated",
          "args": [
            "zspage"
          ],
          "line": 1773
        },
        "resolved": true,
        "details": {
          "function_name": "is_zspage_isolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "457-460",
          "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_first_entry_or_null",
          "args": [
            "&class->fullness_list[fg[i]]",
            "structzspage",
            "list"
          ],
          "line": 1770
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *isolate_zspage(struct size_class *class, bool source)\n{\n\tint i;\n\tstruct zspage *zspage;\n\tenum fullness_group fg[2] = {ZS_ALMOST_EMPTY, ZS_ALMOST_FULL};\n\n\tif (!source) {\n\t\tfg[0] = ZS_ALMOST_FULL;\n\t\tfg[1] = ZS_ALMOST_EMPTY;\n\t}\n\n\tfor (i = 0; i < 2; i++) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[fg[i]],\n\t\t\t\t\t\t\tstruct zspage, list);\n\t\tif (zspage) {\n\t\t\tVM_BUG_ON(is_zspage_isolated(zspage));\n\t\t\tremove_zspage(class, zspage, fg[i]);\n\t\t\treturn zspage;\n\t\t}\n\t}\n\n\treturn zspage;\n}"
  },
  {
    "function_name": "migrate_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1708-1756",
    "snippet": "static int migrate_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zs_compact_control *cc)\n{\n\tunsigned long used_obj, free_obj;\n\tunsigned long handle;\n\tstruct page *s_page = cc->s_page;\n\tstruct page *d_page = cc->d_page;\n\tint obj_idx = cc->obj_idx;\n\tint ret = 0;\n\n\twhile (1) {\n\t\thandle = find_alloced_obj(class, s_page, &obj_idx);\n\t\tif (!handle) {\n\t\t\ts_page = get_next_page(s_page);\n\t\t\tif (!s_page)\n\t\t\t\tbreak;\n\t\t\tobj_idx = 0;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Stop if there is no more space */\n\t\tif (zspage_full(class, get_zspage(d_page))) {\n\t\t\tunpin_tag(handle);\n\t\t\tret = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tused_obj = handle_to_obj(handle);\n\t\tfree_obj = obj_malloc(class, get_zspage(d_page), handle);\n\t\tzs_object_copy(class, free_obj, used_obj);\n\t\tobj_idx++;\n\t\t/*\n\t\t * record_obj updates handle's value to free_obj and it will\n\t\t * invalidate lock bit(ie, HANDLE_PIN_BIT) of handle, which\n\t\t * breaks synchronization using pin_tag(e,g, zs_free) so\n\t\t * let's keep the lock bit.\n\t\t */\n\t\tfree_obj |= BIT(HANDLE_PIN_BIT);\n\t\trecord_obj(handle, free_obj);\n\t\tunpin_tag(handle);\n\t\tobj_free(class, used_obj);\n\t}\n\n\t/* Remember last position in this iteration */\n\tcc->s_page = s_page;\n\tcc->obj_idx = obj_idx;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define HANDLE_PIN_BIT\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "obj_free",
          "args": [
            "class",
            "used_obj"
          ],
          "line": 1748
        },
        "resolved": true,
        "details": {
          "function_name": "obj_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1528-1551",
          "snippet": "static void obj_free(struct size_class *class, unsigned long obj)\n{\n\tstruct link_free *link;\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long f_offset;\n\tunsigned int f_objidx;\n\tvoid *vaddr;\n\n\tobj &= ~OBJ_ALLOCATED_TAG;\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tf_offset = (class->size * f_objidx) & ~PAGE_MASK;\n\tzspage = get_zspage(f_page);\n\n\tvaddr = kmap_atomic(f_page);\n\n\t/* Insert this object in containing zspage's freelist */\n\tlink = (struct link_free *)(vaddr + f_offset);\n\tlink->next = get_freeobj(zspage) << OBJ_TAG_BITS;\n\tkunmap_atomic(vaddr);\n\tset_freeobj(zspage, f_objidx);\n\tmod_zspage_inuse(zspage, -1);\n\tzs_stat_dec(class, OBJ_USED, 1);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_TAG_BITS 1",
            "#define OBJ_ALLOCATED_TAG 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_TAG_BITS 1\n#define OBJ_ALLOCATED_TAG 1\n\nstatic void obj_free(struct size_class *class, unsigned long obj)\n{\n\tstruct link_free *link;\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long f_offset;\n\tunsigned int f_objidx;\n\tvoid *vaddr;\n\n\tobj &= ~OBJ_ALLOCATED_TAG;\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tf_offset = (class->size * f_objidx) & ~PAGE_MASK;\n\tzspage = get_zspage(f_page);\n\n\tvaddr = kmap_atomic(f_page);\n\n\t/* Insert this object in containing zspage's freelist */\n\tlink = (struct link_free *)(vaddr + f_offset);\n\tlink->next = get_freeobj(zspage) << OBJ_TAG_BITS;\n\tkunmap_atomic(vaddr);\n\tset_freeobj(zspage, f_objidx);\n\tmod_zspage_inuse(zspage, -1);\n\tzs_stat_dec(class, OBJ_USED, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unpin_tag",
          "args": [
            "handle"
          ],
          "line": 1747
        },
        "resolved": true,
        "details": {
          "function_name": "unpin_tag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "912-915",
          "snippet": "static void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_obj",
          "args": [
            "handle",
            "free_obj"
          ],
          "line": 1746
        },
        "resolved": true,
        "details": {
          "function_name": "record_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "367-375",
          "snippet": "static void record_obj(unsigned long handle, unsigned long obj)\n{\n\t/*\n\t * lsb of @obj represents handle lock while other bits\n\t * represent object value the handle is pointing so\n\t * updating shouldn't do store tearing.\n\t */\n\tWRITE_ONCE(*(unsigned long *)handle, obj);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void record_obj(unsigned long handle, unsigned long obj)\n{\n\t/*\n\t * lsb of @obj represents handle lock while other bits\n\t * represent object value the handle is pointing so\n\t * updating shouldn't do store tearing.\n\t */\n\tWRITE_ONCE(*(unsigned long *)handle, obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BIT",
          "args": [
            "HANDLE_PIN_BIT"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zs_object_copy",
          "args": [
            "class",
            "free_obj",
            "used_obj"
          ],
          "line": 1737
        },
        "resolved": true,
        "details": {
          "function_name": "zs_object_copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1598-1659",
          "snippet": "static void zs_object_copy(struct size_class *class, unsigned long dst,\n\t\t\t\tunsigned long src)\n{\n\tstruct page *s_page, *d_page;\n\tunsigned int s_objidx, d_objidx;\n\tunsigned long s_off, d_off;\n\tvoid *s_addr, *d_addr;\n\tint s_size, d_size, size;\n\tint written = 0;\n\n\ts_size = d_size = class->size;\n\n\tobj_to_location(src, &s_page, &s_objidx);\n\tobj_to_location(dst, &d_page, &d_objidx);\n\n\ts_off = (class->size * s_objidx) & ~PAGE_MASK;\n\td_off = (class->size * d_objidx) & ~PAGE_MASK;\n\n\tif (s_off + class->size > PAGE_SIZE)\n\t\ts_size = PAGE_SIZE - s_off;\n\n\tif (d_off + class->size > PAGE_SIZE)\n\t\td_size = PAGE_SIZE - d_off;\n\n\ts_addr = kmap_atomic(s_page);\n\td_addr = kmap_atomic(d_page);\n\n\twhile (1) {\n\t\tsize = min(s_size, d_size);\n\t\tmemcpy(d_addr + d_off, s_addr + s_off, size);\n\t\twritten += size;\n\n\t\tif (written == class->size)\n\t\t\tbreak;\n\n\t\ts_off += size;\n\t\ts_size -= size;\n\t\td_off += size;\n\t\td_size -= size;\n\n\t\tif (s_off >= PAGE_SIZE) {\n\t\t\tkunmap_atomic(d_addr);\n\t\t\tkunmap_atomic(s_addr);\n\t\t\ts_page = get_next_page(s_page);\n\t\t\ts_addr = kmap_atomic(s_page);\n\t\t\td_addr = kmap_atomic(d_page);\n\t\t\ts_size = class->size - written;\n\t\t\ts_off = 0;\n\t\t}\n\n\t\tif (d_off >= PAGE_SIZE) {\n\t\t\tkunmap_atomic(d_addr);\n\t\t\td_page = get_next_page(d_page);\n\t\t\td_addr = kmap_atomic(d_page);\n\t\t\td_size = class->size - written;\n\t\t\td_off = 0;\n\t\t}\n\t}\n\n\tkunmap_atomic(d_addr);\n\tkunmap_atomic(s_addr);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_object_copy(struct size_class *class, unsigned long dst,\n\t\t\t\tunsigned long src)\n{\n\tstruct page *s_page, *d_page;\n\tunsigned int s_objidx, d_objidx;\n\tunsigned long s_off, d_off;\n\tvoid *s_addr, *d_addr;\n\tint s_size, d_size, size;\n\tint written = 0;\n\n\ts_size = d_size = class->size;\n\n\tobj_to_location(src, &s_page, &s_objidx);\n\tobj_to_location(dst, &d_page, &d_objidx);\n\n\ts_off = (class->size * s_objidx) & ~PAGE_MASK;\n\td_off = (class->size * d_objidx) & ~PAGE_MASK;\n\n\tif (s_off + class->size > PAGE_SIZE)\n\t\ts_size = PAGE_SIZE - s_off;\n\n\tif (d_off + class->size > PAGE_SIZE)\n\t\td_size = PAGE_SIZE - d_off;\n\n\ts_addr = kmap_atomic(s_page);\n\td_addr = kmap_atomic(d_page);\n\n\twhile (1) {\n\t\tsize = min(s_size, d_size);\n\t\tmemcpy(d_addr + d_off, s_addr + s_off, size);\n\t\twritten += size;\n\n\t\tif (written == class->size)\n\t\t\tbreak;\n\n\t\ts_off += size;\n\t\ts_size -= size;\n\t\td_off += size;\n\t\td_size -= size;\n\n\t\tif (s_off >= PAGE_SIZE) {\n\t\t\tkunmap_atomic(d_addr);\n\t\t\tkunmap_atomic(s_addr);\n\t\t\ts_page = get_next_page(s_page);\n\t\t\ts_addr = kmap_atomic(s_page);\n\t\t\td_addr = kmap_atomic(d_page);\n\t\t\ts_size = class->size - written;\n\t\t\ts_off = 0;\n\t\t}\n\n\t\tif (d_off >= PAGE_SIZE) {\n\t\t\tkunmap_atomic(d_addr);\n\t\t\td_page = get_next_page(d_page);\n\t\t\td_addr = kmap_atomic(d_page);\n\t\t\td_size = class->size - written;\n\t\t\td_off = 0;\n\t\t}\n\t}\n\n\tkunmap_atomic(d_addr);\n\tkunmap_atomic(s_addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_malloc",
          "args": [
            "class",
            "get_zspage(d_page)",
            "handle"
          ],
          "line": 1736
        },
        "resolved": true,
        "details": {
          "function_name": "obj_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1420-1459",
          "snippet": "static unsigned long obj_malloc(struct size_class *class,\n\t\t\t\tstruct zspage *zspage, unsigned long handle)\n{\n\tint i, nr_page, offset;\n\tunsigned long obj;\n\tstruct link_free *link;\n\n\tstruct page *m_page;\n\tunsigned long m_offset;\n\tvoid *vaddr;\n\n\thandle |= OBJ_ALLOCATED_TAG;\n\tobj = get_freeobj(zspage);\n\n\toffset = obj * class->size;\n\tnr_page = offset >> PAGE_SHIFT;\n\tm_offset = offset & ~PAGE_MASK;\n\tm_page = get_first_page(zspage);\n\n\tfor (i = 0; i < nr_page; i++)\n\t\tm_page = get_next_page(m_page);\n\n\tvaddr = kmap_atomic(m_page);\n\tlink = (struct link_free *)vaddr + m_offset / sizeof(*link);\n\tset_freeobj(zspage, link->next >> OBJ_TAG_BITS);\n\tif (likely(!PageHugeObject(m_page)))\n\t\t/* record handle in the header of allocated chunk */\n\t\tlink->handle = handle;\n\telse\n\t\t/* record handle to page->index */\n\t\tzspage->first_page->index = handle;\n\n\tkunmap_atomic(vaddr);\n\tmod_zspage_inuse(zspage, 1);\n\tzs_stat_inc(class, OBJ_USED, 1);\n\n\tobj = location_to_obj(m_page, obj);\n\n\treturn obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_TAG_BITS 1",
            "#define OBJ_ALLOCATED_TAG 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_TAG_BITS 1\n#define OBJ_ALLOCATED_TAG 1\n\nstatic unsigned long obj_malloc(struct size_class *class,\n\t\t\t\tstruct zspage *zspage, unsigned long handle)\n{\n\tint i, nr_page, offset;\n\tunsigned long obj;\n\tstruct link_free *link;\n\n\tstruct page *m_page;\n\tunsigned long m_offset;\n\tvoid *vaddr;\n\n\thandle |= OBJ_ALLOCATED_TAG;\n\tobj = get_freeobj(zspage);\n\n\toffset = obj * class->size;\n\tnr_page = offset >> PAGE_SHIFT;\n\tm_offset = offset & ~PAGE_MASK;\n\tm_page = get_first_page(zspage);\n\n\tfor (i = 0; i < nr_page; i++)\n\t\tm_page = get_next_page(m_page);\n\n\tvaddr = kmap_atomic(m_page);\n\tlink = (struct link_free *)vaddr + m_offset / sizeof(*link);\n\tset_freeobj(zspage, link->next >> OBJ_TAG_BITS);\n\tif (likely(!PageHugeObject(m_page)))\n\t\t/* record handle in the header of allocated chunk */\n\t\tlink->handle = handle;\n\telse\n\t\t/* record handle to page->index */\n\t\tzspage->first_page->index = handle;\n\n\tkunmap_atomic(vaddr);\n\tmod_zspage_inuse(zspage, 1);\n\tzs_stat_inc(class, OBJ_USED, 1);\n\n\tobj = location_to_obj(m_page, obj);\n\n\treturn obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage",
          "args": [
            "d_page"
          ],
          "line": 1736
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle_to_obj",
          "args": [
            "handle"
          ],
          "line": 1735
        },
        "resolved": true,
        "details": {
          "function_name": "handle_to_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "883-886",
          "snippet": "static unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zspage_full",
          "args": [
            "class",
            "get_zspage(d_page)"
          ],
          "line": 1729
        },
        "resolved": true,
        "details": {
          "function_name": "zspage_full",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1278-1281",
          "snippet": "static bool zspage_full(struct size_class *class, struct zspage *zspage)\n{\n\treturn get_zspage_inuse(zspage) == class->objs_per_zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool zspage_full(struct size_class *class, struct zspage *zspage)\n{\n\treturn get_zspage_inuse(zspage) == class->objs_per_zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "s_page"
          ],
          "line": 1721
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_alloced_obj",
          "args": [
            "class",
            "s_page",
            "&obj_idx"
          ],
          "line": 1719
        },
        "resolved": true,
        "details": {
          "function_name": "find_alloced_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1665-1695",
          "snippet": "static unsigned long find_alloced_obj(struct size_class *class,\n\t\t\t\t\tstruct page *page, int *obj_idx)\n{\n\tunsigned long head;\n\tint offset = 0;\n\tint index = *obj_idx;\n\tunsigned long handle = 0;\n\tvoid *addr = kmap_atomic(page);\n\n\toffset = get_first_obj_offset(page);\n\toffset += class->size * index;\n\n\twhile (offset < PAGE_SIZE) {\n\t\thead = obj_to_head(page, addr + offset);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (trypin_tag(handle))\n\t\t\t\tbreak;\n\t\t\thandle = 0;\n\t\t}\n\n\t\toffset += class->size;\n\t\tindex++;\n\t}\n\n\tkunmap_atomic(addr);\n\n\t*obj_idx = index;\n\n\treturn handle;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_ALLOCATED_TAG 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_ALLOCATED_TAG 1\n\nstatic unsigned long find_alloced_obj(struct size_class *class,\n\t\t\t\t\tstruct page *page, int *obj_idx)\n{\n\tunsigned long head;\n\tint offset = 0;\n\tint index = *obj_idx;\n\tunsigned long handle = 0;\n\tvoid *addr = kmap_atomic(page);\n\n\toffset = get_first_obj_offset(page);\n\toffset += class->size * index;\n\n\twhile (offset < PAGE_SIZE) {\n\t\thead = obj_to_head(page, addr + offset);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (trypin_tag(handle))\n\t\t\t\tbreak;\n\t\t\thandle = 0;\n\t\t}\n\n\t\toffset += class->size;\n\t\tindex++;\n\t}\n\n\tkunmap_atomic(addr);\n\n\t*obj_idx = index;\n\n\treturn handle;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic int migrate_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zs_compact_control *cc)\n{\n\tunsigned long used_obj, free_obj;\n\tunsigned long handle;\n\tstruct page *s_page = cc->s_page;\n\tstruct page *d_page = cc->d_page;\n\tint obj_idx = cc->obj_idx;\n\tint ret = 0;\n\n\twhile (1) {\n\t\thandle = find_alloced_obj(class, s_page, &obj_idx);\n\t\tif (!handle) {\n\t\t\ts_page = get_next_page(s_page);\n\t\t\tif (!s_page)\n\t\t\t\tbreak;\n\t\t\tobj_idx = 0;\n\t\t\tcontinue;\n\t\t}\n\n\t\t/* Stop if there is no more space */\n\t\tif (zspage_full(class, get_zspage(d_page))) {\n\t\t\tunpin_tag(handle);\n\t\t\tret = -ENOMEM;\n\t\t\tbreak;\n\t\t}\n\n\t\tused_obj = handle_to_obj(handle);\n\t\tfree_obj = obj_malloc(class, get_zspage(d_page), handle);\n\t\tzs_object_copy(class, free_obj, used_obj);\n\t\tobj_idx++;\n\t\t/*\n\t\t * record_obj updates handle's value to free_obj and it will\n\t\t * invalidate lock bit(ie, HANDLE_PIN_BIT) of handle, which\n\t\t * breaks synchronization using pin_tag(e,g, zs_free) so\n\t\t * let's keep the lock bit.\n\t\t */\n\t\tfree_obj |= BIT(HANDLE_PIN_BIT);\n\t\trecord_obj(handle, free_obj);\n\t\tunpin_tag(handle);\n\t\tobj_free(class, used_obj);\n\t}\n\n\t/* Remember last position in this iteration */\n\tcc->s_page = s_page;\n\tcc->obj_idx = obj_idx;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "find_alloced_obj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1665-1695",
    "snippet": "static unsigned long find_alloced_obj(struct size_class *class,\n\t\t\t\t\tstruct page *page, int *obj_idx)\n{\n\tunsigned long head;\n\tint offset = 0;\n\tint index = *obj_idx;\n\tunsigned long handle = 0;\n\tvoid *addr = kmap_atomic(page);\n\n\toffset = get_first_obj_offset(page);\n\toffset += class->size * index;\n\n\twhile (offset < PAGE_SIZE) {\n\t\thead = obj_to_head(page, addr + offset);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (trypin_tag(handle))\n\t\t\t\tbreak;\n\t\t\thandle = 0;\n\t\t}\n\n\t\toffset += class->size;\n\t\tindex++;\n\t}\n\n\tkunmap_atomic(addr);\n\n\t*obj_idx = index;\n\n\treturn handle;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define OBJ_ALLOCATED_TAG 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "addr"
          ],
          "line": 1690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trypin_tag",
          "args": [
            "handle"
          ],
          "line": 1681
        },
        "resolved": true,
        "details": {
          "function_name": "trypin_tag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "902-905",
          "snippet": "static inline int trypin_tag(unsigned long handle)\n{\n\treturn bit_spin_trylock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic inline int trypin_tag(unsigned long handle)\n{\n\treturn bit_spin_trylock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_to_head",
          "args": [
            "page",
            "addr + offset"
          ],
          "line": 1678
        },
        "resolved": true,
        "details": {
          "function_name": "obj_to_head",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "888-895",
          "snippet": "static unsigned long obj_to_head(struct page *page, void *obj)\n{\n\tif (unlikely(PageHugeObject(page))) {\n\t\tVM_BUG_ON_PAGE(!is_first_page(page), page);\n\t\treturn page->index;\n\t} else\n\t\treturn *(unsigned long *)obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long obj_to_head(struct page *page, void *obj)\n{\n\tif (unlikely(PageHugeObject(page))) {\n\t\tVM_BUG_ON_PAGE(!is_first_page(page), page);\n\t\treturn page->index;\n\t} else\n\t\treturn *(unsigned long *)obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_first_obj_offset",
          "args": [
            "page"
          ],
          "line": 1674
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_obj_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "491-494",
          "snippet": "static inline int get_first_obj_offset(struct page *page)\n{\n\treturn page->units;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_first_obj_offset(struct page *page)\n{\n\treturn page->units;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 1672
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_ALLOCATED_TAG 1\n\nstatic unsigned long find_alloced_obj(struct size_class *class,\n\t\t\t\t\tstruct page *page, int *obj_idx)\n{\n\tunsigned long head;\n\tint offset = 0;\n\tint index = *obj_idx;\n\tunsigned long handle = 0;\n\tvoid *addr = kmap_atomic(page);\n\n\toffset = get_first_obj_offset(page);\n\toffset += class->size * index;\n\n\twhile (offset < PAGE_SIZE) {\n\t\thead = obj_to_head(page, addr + offset);\n\t\tif (head & OBJ_ALLOCATED_TAG) {\n\t\t\thandle = head & ~OBJ_ALLOCATED_TAG;\n\t\t\tif (trypin_tag(handle))\n\t\t\t\tbreak;\n\t\t\thandle = 0;\n\t\t}\n\n\t\toffset += class->size;\n\t\tindex++;\n\t}\n\n\tkunmap_atomic(addr);\n\n\t*obj_idx = index;\n\n\treturn handle;\n}"
  },
  {
    "function_name": "zs_object_copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1598-1659",
    "snippet": "static void zs_object_copy(struct size_class *class, unsigned long dst,\n\t\t\t\tunsigned long src)\n{\n\tstruct page *s_page, *d_page;\n\tunsigned int s_objidx, d_objidx;\n\tunsigned long s_off, d_off;\n\tvoid *s_addr, *d_addr;\n\tint s_size, d_size, size;\n\tint written = 0;\n\n\ts_size = d_size = class->size;\n\n\tobj_to_location(src, &s_page, &s_objidx);\n\tobj_to_location(dst, &d_page, &d_objidx);\n\n\ts_off = (class->size * s_objidx) & ~PAGE_MASK;\n\td_off = (class->size * d_objidx) & ~PAGE_MASK;\n\n\tif (s_off + class->size > PAGE_SIZE)\n\t\ts_size = PAGE_SIZE - s_off;\n\n\tif (d_off + class->size > PAGE_SIZE)\n\t\td_size = PAGE_SIZE - d_off;\n\n\ts_addr = kmap_atomic(s_page);\n\td_addr = kmap_atomic(d_page);\n\n\twhile (1) {\n\t\tsize = min(s_size, d_size);\n\t\tmemcpy(d_addr + d_off, s_addr + s_off, size);\n\t\twritten += size;\n\n\t\tif (written == class->size)\n\t\t\tbreak;\n\n\t\ts_off += size;\n\t\ts_size -= size;\n\t\td_off += size;\n\t\td_size -= size;\n\n\t\tif (s_off >= PAGE_SIZE) {\n\t\t\tkunmap_atomic(d_addr);\n\t\t\tkunmap_atomic(s_addr);\n\t\t\ts_page = get_next_page(s_page);\n\t\t\ts_addr = kmap_atomic(s_page);\n\t\t\td_addr = kmap_atomic(d_page);\n\t\t\ts_size = class->size - written;\n\t\t\ts_off = 0;\n\t\t}\n\n\t\tif (d_off >= PAGE_SIZE) {\n\t\t\tkunmap_atomic(d_addr);\n\t\t\td_page = get_next_page(d_page);\n\t\t\td_addr = kmap_atomic(d_page);\n\t\t\td_size = class->size - written;\n\t\t\td_off = 0;\n\t\t}\n\t}\n\n\tkunmap_atomic(d_addr);\n\tkunmap_atomic(s_addr);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "s_addr"
          ],
          "line": 1658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "d_addr"
          ],
          "line": 1657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "d_page"
          ],
          "line": 1651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "d_page"
          ],
          "line": 1650
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "d_addr"
          ],
          "line": 1649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "d_page"
          ],
          "line": 1643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "s_page"
          ],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "s_addr"
          ],
          "line": 1640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "d_addr"
          ],
          "line": 1639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "d_addr + d_off",
            "s_addr + s_off",
            "size"
          ],
          "line": 1627
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "s_size",
            "d_size"
          ],
          "line": 1626
        },
        "resolved": true,
        "details": {
          "function_name": "si_meminfo_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "4761-4790",
          "snippet": "void si_meminfo_node(struct sysinfo *val, int nid)\n{\n\tint zone_type;\t\t/* needs to be signed */\n\tunsigned long managed_pages = 0;\n\tunsigned long managed_highpages = 0;\n\tunsigned long free_highpages = 0;\n\tpg_data_t *pgdat = NODE_DATA(nid);\n\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++)\n\t\tmanaged_pages += pgdat->node_zones[zone_type].managed_pages;\n\tval->totalram = managed_pages;\n\tval->sharedram = node_page_state(pgdat, NR_SHMEM);\n\tval->freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);\n#ifdef CONFIG_HIGHMEM\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++) {\n\t\tstruct zone *zone = &pgdat->node_zones[zone_type];\n\n\t\tif (is_highmem(zone)) {\n\t\t\tmanaged_highpages += zone->managed_pages;\n\t\t\tfree_highpages += zone_page_state(zone, NR_FREE_PAGES);\n\t\t}\n\t}\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#else\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#endif\n\tval->mem_unit = PAGE_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nvoid si_meminfo_node(struct sysinfo *val, int nid)\n{\n\tint zone_type;\t\t/* needs to be signed */\n\tunsigned long managed_pages = 0;\n\tunsigned long managed_highpages = 0;\n\tunsigned long free_highpages = 0;\n\tpg_data_t *pgdat = NODE_DATA(nid);\n\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++)\n\t\tmanaged_pages += pgdat->node_zones[zone_type].managed_pages;\n\tval->totalram = managed_pages;\n\tval->sharedram = node_page_state(pgdat, NR_SHMEM);\n\tval->freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);\n#ifdef CONFIG_HIGHMEM\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++) {\n\t\tstruct zone *zone = &pgdat->node_zones[zone_type];\n\n\t\tif (is_highmem(zone)) {\n\t\t\tmanaged_highpages += zone->managed_pages;\n\t\t\tfree_highpages += zone_page_state(zone, NR_FREE_PAGES);\n\t\t}\n\t}\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#else\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#endif\n\tval->mem_unit = PAGE_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "d_page"
          ],
          "line": 1623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "s_page"
          ],
          "line": 1622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "obj_to_location",
          "args": [
            "dst",
            "&d_page",
            "&d_objidx"
          ],
          "line": 1611
        },
        "resolved": true,
        "details": {
          "function_name": "obj_to_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "859-865",
          "snippet": "static void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
            "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_object_copy(struct size_class *class, unsigned long dst,\n\t\t\t\tunsigned long src)\n{\n\tstruct page *s_page, *d_page;\n\tunsigned int s_objidx, d_objidx;\n\tunsigned long s_off, d_off;\n\tvoid *s_addr, *d_addr;\n\tint s_size, d_size, size;\n\tint written = 0;\n\n\ts_size = d_size = class->size;\n\n\tobj_to_location(src, &s_page, &s_objidx);\n\tobj_to_location(dst, &d_page, &d_objidx);\n\n\ts_off = (class->size * s_objidx) & ~PAGE_MASK;\n\td_off = (class->size * d_objidx) & ~PAGE_MASK;\n\n\tif (s_off + class->size > PAGE_SIZE)\n\t\ts_size = PAGE_SIZE - s_off;\n\n\tif (d_off + class->size > PAGE_SIZE)\n\t\td_size = PAGE_SIZE - d_off;\n\n\ts_addr = kmap_atomic(s_page);\n\td_addr = kmap_atomic(d_page);\n\n\twhile (1) {\n\t\tsize = min(s_size, d_size);\n\t\tmemcpy(d_addr + d_off, s_addr + s_off, size);\n\t\twritten += size;\n\n\t\tif (written == class->size)\n\t\t\tbreak;\n\n\t\ts_off += size;\n\t\ts_size -= size;\n\t\td_off += size;\n\t\td_size -= size;\n\n\t\tif (s_off >= PAGE_SIZE) {\n\t\t\tkunmap_atomic(d_addr);\n\t\t\tkunmap_atomic(s_addr);\n\t\t\ts_page = get_next_page(s_page);\n\t\t\ts_addr = kmap_atomic(s_page);\n\t\t\td_addr = kmap_atomic(d_page);\n\t\t\ts_size = class->size - written;\n\t\t\ts_off = 0;\n\t\t}\n\n\t\tif (d_off >= PAGE_SIZE) {\n\t\t\tkunmap_atomic(d_addr);\n\t\t\td_page = get_next_page(d_page);\n\t\t\td_addr = kmap_atomic(d_page);\n\t\t\td_size = class->size - written;\n\t\t\td_off = 0;\n\t\t}\n\t}\n\n\tkunmap_atomic(d_addr);\n\tkunmap_atomic(s_addr);\n}"
  },
  {
    "function_name": "zs_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1553-1595",
    "snippet": "void zs_free(struct zs_pool *pool, unsigned long handle)\n{\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long obj;\n\tunsigned int f_objidx;\n\tint class_idx;\n\tstruct size_class *class;\n\tenum fullness_group fullness;\n\tbool isolated;\n\n\tif (unlikely(!handle))\n\t\treturn;\n\n\tpin_tag(handle);\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tzspage = get_zspage(f_page);\n\n\tmigrate_read_lock(zspage);\n\n\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\tclass = pool->size_class[class_idx];\n\n\tspin_lock(&class->lock);\n\tobj_free(class, obj);\n\tfullness = fix_fullness_group(class, zspage);\n\tif (fullness != ZS_EMPTY) {\n\t\tmigrate_read_unlock(zspage);\n\t\tgoto out;\n\t}\n\n\tisolated = is_zspage_isolated(zspage);\n\tmigrate_read_unlock(zspage);\n\t/* If zspage is isolated, zs_page_putback will free the zspage */\n\tif (likely(!isolated))\n\t\tfree_zspage(pool, class, zspage);\nout:\n\n\tspin_unlock(&class->lock);\n\tunpin_tag(handle);\n\tcache_free_handle(pool, handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_free_handle",
          "args": [
            "pool",
            "handle"
          ],
          "line": 1594
        },
        "resolved": true,
        "details": {
          "function_name": "cache_free_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "351-354",
          "snippet": "static void cache_free_handle(struct zs_pool *pool, unsigned long handle)\n{\n\tkmem_cache_free(pool->handle_cachep, (void *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void cache_free_handle(struct zs_pool *pool, unsigned long handle)\n{\n\tkmem_cache_free(pool->handle_cachep, (void *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unpin_tag",
          "args": [
            "handle"
          ],
          "line": 1593
        },
        "resolved": true,
        "details": {
          "function_name": "unpin_tag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "912-915",
          "snippet": "static void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_zspage",
          "args": [
            "pool",
            "class",
            "zspage"
          ],
          "line": 1589
        },
        "resolved": true,
        "details": {
          "function_name": "free_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "980-993",
          "snippet": "static void free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(list_empty(&zspage->list));\n\n\tif (!trylock_zspage(zspage)) {\n\t\tkick_deferred_free(pool);\n\t\treturn;\n\t}\n\n\tremove_zspage(class, zspage, ZS_EMPTY);\n\t__free_zspage(pool, class, zspage);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(list_empty(&zspage->list));\n\n\tif (!trylock_zspage(zspage)) {\n\t\tkick_deferred_free(pool);\n\t\treturn;\n\t}\n\n\tremove_zspage(class, zspage, ZS_EMPTY);\n\t__free_zspage(pool, class, zspage);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!isolated"
          ],
          "line": 1588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "migrate_read_unlock",
          "args": [
            "zspage"
          ],
          "line": 1586
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_read_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1859-1862",
          "snippet": "static void migrate_read_unlock(struct zspage *zspage)\n{\n\tread_unlock(&zspage->lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_read_unlock(struct zspage *zspage)\n{\n\tread_unlock(&zspage->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_zspage_isolated",
          "args": [
            "zspage"
          ],
          "line": 1585
        },
        "resolved": true,
        "details": {
          "function_name": "is_zspage_isolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "457-460",
          "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fix_fullness_group",
          "args": [
            "class",
            "zspage"
          ],
          "line": 1579
        },
        "resolved": true,
        "details": {
          "function_name": "fix_fullness_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "779-799",
          "snippet": "static enum fullness_group fix_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint class_idx;\n\tenum fullness_group currfg, newfg;\n\n\tget_zspage_mapping(zspage, &class_idx, &currfg);\n\tnewfg = get_fullness_group(class, zspage);\n\tif (newfg == currfg)\n\t\tgoto out;\n\n\tif (!is_zspage_isolated(zspage)) {\n\t\tremove_zspage(class, zspage, currfg);\n\t\tinsert_zspage(class, zspage, newfg);\n\t}\n\n\tset_zspage_mapping(zspage, class_idx, newfg);\n\nout:\n\treturn newfg;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic enum fullness_group fix_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint class_idx;\n\tenum fullness_group currfg, newfg;\n\n\tget_zspage_mapping(zspage, &class_idx, &currfg);\n\tnewfg = get_fullness_group(class, zspage);\n\tif (newfg == currfg)\n\t\tgoto out;\n\n\tif (!is_zspage_isolated(zspage)) {\n\t\tremove_zspage(class, zspage, currfg);\n\t\tinsert_zspage(class, zspage, newfg);\n\t}\n\n\tset_zspage_mapping(zspage, class_idx, newfg);\n\nout:\n\treturn newfg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_free",
          "args": [
            "class",
            "obj"
          ],
          "line": 1578
        },
        "resolved": true,
        "details": {
          "function_name": "obj_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1528-1551",
          "snippet": "static void obj_free(struct size_class *class, unsigned long obj)\n{\n\tstruct link_free *link;\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long f_offset;\n\tunsigned int f_objidx;\n\tvoid *vaddr;\n\n\tobj &= ~OBJ_ALLOCATED_TAG;\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tf_offset = (class->size * f_objidx) & ~PAGE_MASK;\n\tzspage = get_zspage(f_page);\n\n\tvaddr = kmap_atomic(f_page);\n\n\t/* Insert this object in containing zspage's freelist */\n\tlink = (struct link_free *)(vaddr + f_offset);\n\tlink->next = get_freeobj(zspage) << OBJ_TAG_BITS;\n\tkunmap_atomic(vaddr);\n\tset_freeobj(zspage, f_objidx);\n\tmod_zspage_inuse(zspage, -1);\n\tzs_stat_dec(class, OBJ_USED, 1);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_TAG_BITS 1",
            "#define OBJ_ALLOCATED_TAG 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_TAG_BITS 1\n#define OBJ_ALLOCATED_TAG 1\n\nstatic void obj_free(struct size_class *class, unsigned long obj)\n{\n\tstruct link_free *link;\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long f_offset;\n\tunsigned int f_objidx;\n\tvoid *vaddr;\n\n\tobj &= ~OBJ_ALLOCATED_TAG;\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tf_offset = (class->size * f_objidx) & ~PAGE_MASK;\n\tzspage = get_zspage(f_page);\n\n\tvaddr = kmap_atomic(f_page);\n\n\t/* Insert this object in containing zspage's freelist */\n\tlink = (struct link_free *)(vaddr + f_offset);\n\tlink->next = get_freeobj(zspage) << OBJ_TAG_BITS;\n\tkunmap_atomic(vaddr);\n\tset_freeobj(zspage, f_objidx);\n\tmod_zspage_inuse(zspage, -1);\n\tzs_stat_dec(class, OBJ_USED, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&fullness"
          ],
          "line": 1574
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      },
      {
        "call_info": {
          "callee": "migrate_read_lock",
          "args": [
            "zspage"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_read_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1854-1857",
          "snippet": "static void migrate_read_lock(struct zspage *zspage)\n{\n\tread_lock(&zspage->lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_read_lock(struct zspage *zspage)\n{\n\tread_lock(&zspage->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage",
          "args": [
            "f_page"
          ],
          "line": 1570
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_to_location",
          "args": [
            "obj",
            "&f_page",
            "&f_objidx"
          ],
          "line": 1569
        },
        "resolved": true,
        "details": {
          "function_name": "obj_to_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "859-865",
          "snippet": "static void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
            "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle_to_obj",
          "args": [
            "handle"
          ],
          "line": 1568
        },
        "resolved": true,
        "details": {
          "function_name": "handle_to_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "883-886",
          "snippet": "static unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!handle"
          ],
          "line": 1564
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nvoid zs_free(struct zs_pool *pool, unsigned long handle)\n{\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long obj;\n\tunsigned int f_objidx;\n\tint class_idx;\n\tstruct size_class *class;\n\tenum fullness_group fullness;\n\tbool isolated;\n\n\tif (unlikely(!handle))\n\t\treturn;\n\n\tpin_tag(handle);\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tzspage = get_zspage(f_page);\n\n\tmigrate_read_lock(zspage);\n\n\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\tclass = pool->size_class[class_idx];\n\n\tspin_lock(&class->lock);\n\tobj_free(class, obj);\n\tfullness = fix_fullness_group(class, zspage);\n\tif (fullness != ZS_EMPTY) {\n\t\tmigrate_read_unlock(zspage);\n\t\tgoto out;\n\t}\n\n\tisolated = is_zspage_isolated(zspage);\n\tmigrate_read_unlock(zspage);\n\t/* If zspage is isolated, zs_page_putback will free the zspage */\n\tif (likely(!isolated))\n\t\tfree_zspage(pool, class, zspage);\nout:\n\n\tspin_unlock(&class->lock);\n\tunpin_tag(handle);\n\tcache_free_handle(pool, handle);\n}"
  },
  {
    "function_name": "obj_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1528-1551",
    "snippet": "static void obj_free(struct size_class *class, unsigned long obj)\n{\n\tstruct link_free *link;\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long f_offset;\n\tunsigned int f_objidx;\n\tvoid *vaddr;\n\n\tobj &= ~OBJ_ALLOCATED_TAG;\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tf_offset = (class->size * f_objidx) & ~PAGE_MASK;\n\tzspage = get_zspage(f_page);\n\n\tvaddr = kmap_atomic(f_page);\n\n\t/* Insert this object in containing zspage's freelist */\n\tlink = (struct link_free *)(vaddr + f_offset);\n\tlink->next = get_freeobj(zspage) << OBJ_TAG_BITS;\n\tkunmap_atomic(vaddr);\n\tset_freeobj(zspage, f_objidx);\n\tmod_zspage_inuse(zspage, -1);\n\tzs_stat_dec(class, OBJ_USED, 1);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define OBJ_TAG_BITS 1",
      "#define OBJ_ALLOCATED_TAG 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_stat_dec",
          "args": [
            "class",
            "OBJ_USED",
            "1"
          ],
          "line": 1550
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "555-559",
          "snippet": "static inline void zs_stat_dec(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] -= cnt;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_stat_dec(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] -= cnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mod_zspage_inuse",
          "args": [
            "zspage",
            "-1"
          ],
          "line": 1549
        },
        "resolved": true,
        "details": {
          "function_name": "mod_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "478-481",
          "snippet": "static inline void mod_zspage_inuse(struct zspage *zspage, int val)\n{\n\tzspage->inuse += val;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void mod_zspage_inuse(struct zspage *zspage, int val)\n{\n\tzspage->inuse += val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_freeobj",
          "args": [
            "zspage",
            "f_objidx"
          ],
          "line": 1548
        },
        "resolved": true,
        "details": {
          "function_name": "set_freeobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "506-509",
          "snippet": "static inline void set_freeobj(struct zspage *zspage, unsigned int obj)\n{\n\tzspage->freeobj = obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void set_freeobj(struct zspage *zspage, unsigned int obj)\n{\n\tzspage->freeobj = obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "vaddr"
          ],
          "line": 1547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_freeobj",
          "args": [
            "zspage"
          ],
          "line": 1546
        },
        "resolved": true,
        "details": {
          "function_name": "get_freeobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "501-504",
          "snippet": "static inline unsigned int get_freeobj(struct zspage *zspage)\n{\n\treturn zspage->freeobj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline unsigned int get_freeobj(struct zspage *zspage)\n{\n\treturn zspage->freeobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "f_page"
          ],
          "line": 1542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage",
          "args": [
            "f_page"
          ],
          "line": 1540
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_to_location",
          "args": [
            "obj",
            "&f_page",
            "&f_objidx"
          ],
          "line": 1538
        },
        "resolved": true,
        "details": {
          "function_name": "obj_to_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "859-865",
          "snippet": "static void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
            "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_TAG_BITS 1\n#define OBJ_ALLOCATED_TAG 1\n\nstatic void obj_free(struct size_class *class, unsigned long obj)\n{\n\tstruct link_free *link;\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long f_offset;\n\tunsigned int f_objidx;\n\tvoid *vaddr;\n\n\tobj &= ~OBJ_ALLOCATED_TAG;\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tf_offset = (class->size * f_objidx) & ~PAGE_MASK;\n\tzspage = get_zspage(f_page);\n\n\tvaddr = kmap_atomic(f_page);\n\n\t/* Insert this object in containing zspage's freelist */\n\tlink = (struct link_free *)(vaddr + f_offset);\n\tlink->next = get_freeobj(zspage) << OBJ_TAG_BITS;\n\tkunmap_atomic(vaddr);\n\tset_freeobj(zspage, f_objidx);\n\tmod_zspage_inuse(zspage, -1);\n\tzs_stat_dec(class, OBJ_USED, 1);\n}"
  },
  {
    "function_name": "zs_malloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1472-1525",
    "snippet": "unsigned long zs_malloc(struct zs_pool *pool, size_t size, gfp_t gfp)\n{\n\tunsigned long handle, obj;\n\tstruct size_class *class;\n\tenum fullness_group newfg;\n\tstruct zspage *zspage;\n\n\tif (unlikely(!size || size > ZS_MAX_ALLOC_SIZE))\n\t\treturn 0;\n\n\thandle = cache_alloc_handle(pool, gfp);\n\tif (!handle)\n\t\treturn 0;\n\n\t/* extra space in chunk to keep the handle */\n\tsize += ZS_HANDLE_SIZE;\n\tclass = pool->size_class[get_size_class_index(size)];\n\n\tspin_lock(&class->lock);\n\tzspage = find_get_zspage(class);\n\tif (likely(zspage)) {\n\t\tobj = obj_malloc(class, zspage, handle);\n\t\t/* Now move the zspage to another fullness group, if required */\n\t\tfix_fullness_group(class, zspage);\n\t\trecord_obj(handle, obj);\n\t\tspin_unlock(&class->lock);\n\n\t\treturn handle;\n\t}\n\n\tspin_unlock(&class->lock);\n\n\tzspage = alloc_zspage(pool, class, gfp);\n\tif (!zspage) {\n\t\tcache_free_handle(pool, handle);\n\t\treturn 0;\n\t}\n\n\tspin_lock(&class->lock);\n\tobj = obj_malloc(class, zspage, handle);\n\tnewfg = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, newfg);\n\tset_zspage_mapping(zspage, class->index, newfg);\n\trecord_obj(handle, obj);\n\tatomic_long_add(class->pages_per_zspage,\n\t\t\t\t&pool->pages_allocated);\n\tzs_stat_inc(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\n\t/* We completely set up zspage so mark them as movable */\n\tSetZsPageMovable(pool, zspage);\n\tspin_unlock(&class->lock);\n\n\treturn handle;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE",
      "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 1522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetZsPageMovable",
          "args": [
            "pool",
            "zspage"
          ],
          "line": 1521
        },
        "resolved": true,
        "details": {
          "function_name": "SetZsPageMovable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2185-2194",
          "snippet": "static void SetZsPageMovable(struct zs_pool *pool, struct zspage *zspage)\n{\n\tstruct page *page = get_first_page(zspage);\n\n\tdo {\n\t\tWARN_ON(!trylock_page(page));\n\t\t__SetPageMovable(page, pool->inode->i_mapping);\n\t\tunlock_page(page);\n\t} while ((page = get_next_page(page)) != NULL);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void SetZsPageMovable(struct zs_pool *pool, struct zspage *zspage)\n{\n\tstruct page *page = get_first_page(zspage);\n\n\tdo {\n\t\tWARN_ON(!trylock_page(page));\n\t\t__SetPageMovable(page, pool->inode->i_mapping);\n\t\tunlock_page(page);\n\t} while ((page = get_next_page(page)) != NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_stat_inc",
          "args": [
            "class",
            "OBJ_ALLOCATED",
            "class->objs_per_zspage"
          ],
          "line": 1518
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "548-552",
          "snippet": "static inline void zs_stat_inc(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] += cnt;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_stat_inc(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] += cnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_long_add",
          "args": [
            "class->pages_per_zspage",
            "&pool->pages_allocated"
          ],
          "line": 1516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "record_obj",
          "args": [
            "handle",
            "obj"
          ],
          "line": 1515
        },
        "resolved": true,
        "details": {
          "function_name": "record_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "367-375",
          "snippet": "static void record_obj(unsigned long handle, unsigned long obj)\n{\n\t/*\n\t * lsb of @obj represents handle lock while other bits\n\t * represent object value the handle is pointing so\n\t * updating shouldn't do store tearing.\n\t */\n\tWRITE_ONCE(*(unsigned long *)handle, obj);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void record_obj(unsigned long handle, unsigned long obj)\n{\n\t/*\n\t * lsb of @obj represents handle lock while other bits\n\t * represent object value the handle is pointing so\n\t * updating shouldn't do store tearing.\n\t */\n\tWRITE_ONCE(*(unsigned long *)handle, obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_zspage_mapping",
          "args": [
            "zspage",
            "class->index",
            "newfg"
          ],
          "line": 1514
        },
        "resolved": true,
        "details": {
          "function_name": "set_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "521-527",
          "snippet": "static void set_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int class_idx,\n\t\t\t\tenum fullness_group fullness)\n{\n\tzspage->class = class_idx;\n\tzspage->fullness = fullness;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void set_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int class_idx,\n\t\t\t\tenum fullness_group fullness)\n{\n\tzspage->class = class_idx;\n\tzspage->fullness = fullness;\n}"
        }
      },
      {
        "call_info": {
          "callee": "insert_zspage",
          "args": [
            "class",
            "zspage",
            "newfg"
          ],
          "line": 1513
        },
        "resolved": true,
        "details": {
          "function_name": "insert_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "733-753",
          "snippet": "static void insert_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tstruct zspage *head;\n\n\tzs_stat_inc(class, fullness, 1);\n\thead = list_first_entry_or_null(&class->fullness_list[fullness],\n\t\t\t\t\tstruct zspage, list);\n\t/*\n\t * We want to see more ZS_FULL pages and less almost empty/full.\n\t * Put pages with higher ->inuse first.\n\t */\n\tif (head) {\n\t\tif (get_zspage_inuse(zspage) < get_zspage_inuse(head)) {\n\t\t\tlist_add(&zspage->list, &head->list);\n\t\t\treturn;\n\t\t}\n\t}\n\tlist_add(&zspage->list, &class->fullness_list[fullness]);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void insert_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tstruct zspage *head;\n\n\tzs_stat_inc(class, fullness, 1);\n\thead = list_first_entry_or_null(&class->fullness_list[fullness],\n\t\t\t\t\tstruct zspage, list);\n\t/*\n\t * We want to see more ZS_FULL pages and less almost empty/full.\n\t * Put pages with higher ->inuse first.\n\t */\n\tif (head) {\n\t\tif (get_zspage_inuse(zspage) < get_zspage_inuse(head)) {\n\t\t\tlist_add(&zspage->list, &head->list);\n\t\t\treturn;\n\t\t}\n\t}\n\tlist_add(&zspage->list, &class->fullness_list[fullness]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_fullness_group",
          "args": [
            "class",
            "zspage"
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "get_fullness_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "706-725",
          "snippet": "static enum fullness_group get_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint inuse, objs_per_zspage;\n\tenum fullness_group fg;\n\n\tinuse = get_zspage_inuse(zspage);\n\tobjs_per_zspage = class->objs_per_zspage;\n\n\tif (inuse == 0)\n\t\tfg = ZS_EMPTY;\n\telse if (inuse == objs_per_zspage)\n\t\tfg = ZS_FULL;\n\telse if (inuse <= 3 * objs_per_zspage / fullness_threshold_frac)\n\t\tfg = ZS_ALMOST_EMPTY;\n\telse\n\t\tfg = ZS_ALMOST_FULL;\n\n\treturn fg;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const int fullness_threshold_frac = 4;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const int fullness_threshold_frac = 4;\n\nstatic enum fullness_group get_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint inuse, objs_per_zspage;\n\tenum fullness_group fg;\n\n\tinuse = get_zspage_inuse(zspage);\n\tobjs_per_zspage = class->objs_per_zspage;\n\n\tif (inuse == 0)\n\t\tfg = ZS_EMPTY;\n\telse if (inuse == objs_per_zspage)\n\t\tfg = ZS_FULL;\n\telse if (inuse <= 3 * objs_per_zspage / fullness_threshold_frac)\n\t\tfg = ZS_ALMOST_EMPTY;\n\telse\n\t\tfg = ZS_ALMOST_FULL;\n\n\treturn fg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_malloc",
          "args": [
            "class",
            "zspage",
            "handle"
          ],
          "line": 1511
        },
        "resolved": true,
        "details": {
          "function_name": "obj_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1420-1459",
          "snippet": "static unsigned long obj_malloc(struct size_class *class,\n\t\t\t\tstruct zspage *zspage, unsigned long handle)\n{\n\tint i, nr_page, offset;\n\tunsigned long obj;\n\tstruct link_free *link;\n\n\tstruct page *m_page;\n\tunsigned long m_offset;\n\tvoid *vaddr;\n\n\thandle |= OBJ_ALLOCATED_TAG;\n\tobj = get_freeobj(zspage);\n\n\toffset = obj * class->size;\n\tnr_page = offset >> PAGE_SHIFT;\n\tm_offset = offset & ~PAGE_MASK;\n\tm_page = get_first_page(zspage);\n\n\tfor (i = 0; i < nr_page; i++)\n\t\tm_page = get_next_page(m_page);\n\n\tvaddr = kmap_atomic(m_page);\n\tlink = (struct link_free *)vaddr + m_offset / sizeof(*link);\n\tset_freeobj(zspage, link->next >> OBJ_TAG_BITS);\n\tif (likely(!PageHugeObject(m_page)))\n\t\t/* record handle in the header of allocated chunk */\n\t\tlink->handle = handle;\n\telse\n\t\t/* record handle to page->index */\n\t\tzspage->first_page->index = handle;\n\n\tkunmap_atomic(vaddr);\n\tmod_zspage_inuse(zspage, 1);\n\tzs_stat_inc(class, OBJ_USED, 1);\n\n\tobj = location_to_obj(m_page, obj);\n\n\treturn obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_TAG_BITS 1",
            "#define OBJ_ALLOCATED_TAG 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_TAG_BITS 1\n#define OBJ_ALLOCATED_TAG 1\n\nstatic unsigned long obj_malloc(struct size_class *class,\n\t\t\t\tstruct zspage *zspage, unsigned long handle)\n{\n\tint i, nr_page, offset;\n\tunsigned long obj;\n\tstruct link_free *link;\n\n\tstruct page *m_page;\n\tunsigned long m_offset;\n\tvoid *vaddr;\n\n\thandle |= OBJ_ALLOCATED_TAG;\n\tobj = get_freeobj(zspage);\n\n\toffset = obj * class->size;\n\tnr_page = offset >> PAGE_SHIFT;\n\tm_offset = offset & ~PAGE_MASK;\n\tm_page = get_first_page(zspage);\n\n\tfor (i = 0; i < nr_page; i++)\n\t\tm_page = get_next_page(m_page);\n\n\tvaddr = kmap_atomic(m_page);\n\tlink = (struct link_free *)vaddr + m_offset / sizeof(*link);\n\tset_freeobj(zspage, link->next >> OBJ_TAG_BITS);\n\tif (likely(!PageHugeObject(m_page)))\n\t\t/* record handle in the header of allocated chunk */\n\t\tlink->handle = handle;\n\telse\n\t\t/* record handle to page->index */\n\t\tzspage->first_page->index = handle;\n\n\tkunmap_atomic(vaddr);\n\tmod_zspage_inuse(zspage, 1);\n\tzs_stat_inc(class, OBJ_USED, 1);\n\n\tobj = location_to_obj(m_page, obj);\n\n\treturn obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 1510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_free_handle",
          "args": [
            "pool",
            "handle"
          ],
          "line": 1506
        },
        "resolved": true,
        "details": {
          "function_name": "cache_free_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "351-354",
          "snippet": "static void cache_free_handle(struct zs_pool *pool, unsigned long handle)\n{\n\tkmem_cache_free(pool->handle_cachep, (void *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void cache_free_handle(struct zs_pool *pool, unsigned long handle)\n{\n\tkmem_cache_free(pool->handle_cachep, (void *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_zspage",
          "args": [
            "pool",
            "class",
            "gfp"
          ],
          "line": 1504
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1076-1112",
          "snippet": "static struct zspage *alloc_zspage(struct zs_pool *pool,\n\t\t\t\t\tstruct size_class *class,\n\t\t\t\t\tgfp_t gfp)\n{\n\tint i;\n\tstruct page *pages[ZS_MAX_PAGES_PER_ZSPAGE];\n\tstruct zspage *zspage = cache_alloc_zspage(pool, gfp);\n\n\tif (!zspage)\n\t\treturn NULL;\n\n\tmemset(zspage, 0, sizeof(struct zspage));\n\tzspage->magic = ZSPAGE_MAGIC;\n\tmigrate_lock_init(zspage);\n\n\tfor (i = 0; i < class->pages_per_zspage; i++) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_page(gfp);\n\t\tif (!page) {\n\t\t\twhile (--i >= 0) {\n\t\t\t\tdec_zone_page_state(pages[i], NR_ZSPAGES);\n\t\t\t\t__free_page(pages[i]);\n\t\t\t}\n\t\t\tcache_free_zspage(pool, zspage);\n\t\t\treturn NULL;\n\t\t}\n\n\t\tinc_zone_page_state(page, NR_ZSPAGES);\n\t\tpages[i] = page;\n\t}\n\n\tcreate_page_chain(class, zspage, pages);\n\tinit_zspage(class, zspage);\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)",
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)\n#define ZSPAGE_MAGIC\t0x58\n\nstatic struct zspage *alloc_zspage(struct zs_pool *pool,\n\t\t\t\t\tstruct size_class *class,\n\t\t\t\t\tgfp_t gfp)\n{\n\tint i;\n\tstruct page *pages[ZS_MAX_PAGES_PER_ZSPAGE];\n\tstruct zspage *zspage = cache_alloc_zspage(pool, gfp);\n\n\tif (!zspage)\n\t\treturn NULL;\n\n\tmemset(zspage, 0, sizeof(struct zspage));\n\tzspage->magic = ZSPAGE_MAGIC;\n\tmigrate_lock_init(zspage);\n\n\tfor (i = 0; i < class->pages_per_zspage; i++) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_page(gfp);\n\t\tif (!page) {\n\t\t\twhile (--i >= 0) {\n\t\t\t\tdec_zone_page_state(pages[i], NR_ZSPAGES);\n\t\t\t\t__free_page(pages[i]);\n\t\t\t}\n\t\t\tcache_free_zspage(pool, zspage);\n\t\t\treturn NULL;\n\t\t}\n\n\t\tinc_zone_page_state(page, NR_ZSPAGES);\n\t\tpages[i] = page;\n\t}\n\n\tcreate_page_chain(class, zspage, pages);\n\tinit_zspage(class, zspage);\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 1502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fix_fullness_group",
          "args": [
            "class",
            "zspage"
          ],
          "line": 1495
        },
        "resolved": true,
        "details": {
          "function_name": "fix_fullness_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "779-799",
          "snippet": "static enum fullness_group fix_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint class_idx;\n\tenum fullness_group currfg, newfg;\n\n\tget_zspage_mapping(zspage, &class_idx, &currfg);\n\tnewfg = get_fullness_group(class, zspage);\n\tif (newfg == currfg)\n\t\tgoto out;\n\n\tif (!is_zspage_isolated(zspage)) {\n\t\tremove_zspage(class, zspage, currfg);\n\t\tinsert_zspage(class, zspage, newfg);\n\t}\n\n\tset_zspage_mapping(zspage, class_idx, newfg);\n\nout:\n\treturn newfg;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic enum fullness_group fix_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint class_idx;\n\tenum fullness_group currfg, newfg;\n\n\tget_zspage_mapping(zspage, &class_idx, &currfg);\n\tnewfg = get_fullness_group(class, zspage);\n\tif (newfg == currfg)\n\t\tgoto out;\n\n\tif (!is_zspage_isolated(zspage)) {\n\t\tremove_zspage(class, zspage, currfg);\n\t\tinsert_zspage(class, zspage, newfg);\n\t}\n\n\tset_zspage_mapping(zspage, class_idx, newfg);\n\nout:\n\treturn newfg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "zspage"
          ],
          "line": 1492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_get_zspage",
          "args": [
            "class"
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_size_class_index",
          "args": [
            "size"
          ],
          "line": 1488
        },
        "resolved": true,
        "details": {
          "function_name": "get_size_class_index",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "536-545",
          "snippet": "static int get_size_class_index(int size)\n{\n\tint idx = 0;\n\n\tif (likely(size > ZS_MIN_ALLOC_SIZE))\n\t\tidx = DIV_ROUND_UP(size - ZS_MIN_ALLOC_SIZE,\n\t\t\t\tZS_SIZE_CLASS_DELTA);\n\n\treturn min_t(int, ZS_SIZE_CLASSES - 1, idx);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)",
            "#define ZS_SIZE_CLASS_DELTA\t(PAGE_SIZE >> CLASS_BITS)",
            "#define ZS_MIN_ALLOC_SIZE \\\n\tMAX(32, (ZS_MAX_PAGES_PER_ZSPAGE << PAGE_SHIFT >> OBJ_INDEX_BITS))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n#define ZS_SIZE_CLASS_DELTA\t(PAGE_SIZE >> CLASS_BITS)\n#define ZS_MIN_ALLOC_SIZE \\\n\tMAX(32, (ZS_MAX_PAGES_PER_ZSPAGE << PAGE_SHIFT >> OBJ_INDEX_BITS))\n\nstatic int get_size_class_index(int size)\n{\n\tint idx = 0;\n\n\tif (likely(size > ZS_MIN_ALLOC_SIZE))\n\t\tidx = DIV_ROUND_UP(size - ZS_MIN_ALLOC_SIZE,\n\t\t\t\tZS_SIZE_CLASS_DELTA);\n\n\treturn min_t(int, ZS_SIZE_CLASSES - 1, idx);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_alloc_handle",
          "args": [
            "pool",
            "gfp"
          ],
          "line": 1482
        },
        "resolved": true,
        "details": {
          "function_name": "cache_alloc_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "345-349",
          "snippet": "static unsigned long cache_alloc_handle(struct zs_pool *pool, gfp_t gfp)\n{\n\treturn (unsigned long)kmem_cache_alloc(pool->handle_cachep,\n\t\t\tgfp & ~(__GFP_HIGHMEM|__GFP_MOVABLE));\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long cache_alloc_handle(struct zs_pool *pool, gfp_t gfp)\n{\n\treturn (unsigned long)kmem_cache_alloc(pool->handle_cachep,\n\t\t\tgfp & ~(__GFP_HIGHMEM|__GFP_MOVABLE));\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!size || size > ZS_MAX_ALLOC_SIZE"
          ],
          "line": 1479
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nunsigned long zs_malloc(struct zs_pool *pool, size_t size, gfp_t gfp)\n{\n\tunsigned long handle, obj;\n\tstruct size_class *class;\n\tenum fullness_group newfg;\n\tstruct zspage *zspage;\n\n\tif (unlikely(!size || size > ZS_MAX_ALLOC_SIZE))\n\t\treturn 0;\n\n\thandle = cache_alloc_handle(pool, gfp);\n\tif (!handle)\n\t\treturn 0;\n\n\t/* extra space in chunk to keep the handle */\n\tsize += ZS_HANDLE_SIZE;\n\tclass = pool->size_class[get_size_class_index(size)];\n\n\tspin_lock(&class->lock);\n\tzspage = find_get_zspage(class);\n\tif (likely(zspage)) {\n\t\tobj = obj_malloc(class, zspage, handle);\n\t\t/* Now move the zspage to another fullness group, if required */\n\t\tfix_fullness_group(class, zspage);\n\t\trecord_obj(handle, obj);\n\t\tspin_unlock(&class->lock);\n\n\t\treturn handle;\n\t}\n\n\tspin_unlock(&class->lock);\n\n\tzspage = alloc_zspage(pool, class, gfp);\n\tif (!zspage) {\n\t\tcache_free_handle(pool, handle);\n\t\treturn 0;\n\t}\n\n\tspin_lock(&class->lock);\n\tobj = obj_malloc(class, zspage, handle);\n\tnewfg = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, newfg);\n\tset_zspage_mapping(zspage, class->index, newfg);\n\trecord_obj(handle, obj);\n\tatomic_long_add(class->pages_per_zspage,\n\t\t\t\t&pool->pages_allocated);\n\tzs_stat_inc(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\n\t/* We completely set up zspage so mark them as movable */\n\tSetZsPageMovable(pool, zspage);\n\tspin_unlock(&class->lock);\n\n\treturn handle;\n}"
  },
  {
    "function_name": "obj_malloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1420-1459",
    "snippet": "static unsigned long obj_malloc(struct size_class *class,\n\t\t\t\tstruct zspage *zspage, unsigned long handle)\n{\n\tint i, nr_page, offset;\n\tunsigned long obj;\n\tstruct link_free *link;\n\n\tstruct page *m_page;\n\tunsigned long m_offset;\n\tvoid *vaddr;\n\n\thandle |= OBJ_ALLOCATED_TAG;\n\tobj = get_freeobj(zspage);\n\n\toffset = obj * class->size;\n\tnr_page = offset >> PAGE_SHIFT;\n\tm_offset = offset & ~PAGE_MASK;\n\tm_page = get_first_page(zspage);\n\n\tfor (i = 0; i < nr_page; i++)\n\t\tm_page = get_next_page(m_page);\n\n\tvaddr = kmap_atomic(m_page);\n\tlink = (struct link_free *)vaddr + m_offset / sizeof(*link);\n\tset_freeobj(zspage, link->next >> OBJ_TAG_BITS);\n\tif (likely(!PageHugeObject(m_page)))\n\t\t/* record handle in the header of allocated chunk */\n\t\tlink->handle = handle;\n\telse\n\t\t/* record handle to page->index */\n\t\tzspage->first_page->index = handle;\n\n\tkunmap_atomic(vaddr);\n\tmod_zspage_inuse(zspage, 1);\n\tzs_stat_inc(class, OBJ_USED, 1);\n\n\tobj = location_to_obj(m_page, obj);\n\n\treturn obj;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define OBJ_TAG_BITS 1",
      "#define OBJ_ALLOCATED_TAG 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "location_to_obj",
          "args": [
            "m_page",
            "obj"
          ],
          "line": 1456
        },
        "resolved": true,
        "details": {
          "function_name": "location_to_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "872-881",
          "snippet": "static unsigned long location_to_obj(struct page *page, unsigned int obj_idx)\n{\n\tunsigned long obj;\n\n\tobj = page_to_pfn(page) << OBJ_INDEX_BITS;\n\tobj |= obj_idx & OBJ_INDEX_MASK;\n\tobj <<= OBJ_TAG_BITS;\n\n\treturn obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
            "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic unsigned long location_to_obj(struct page *page, unsigned int obj_idx)\n{\n\tunsigned long obj;\n\n\tobj = page_to_pfn(page) << OBJ_INDEX_BITS;\n\tobj |= obj_idx & OBJ_INDEX_MASK;\n\tobj <<= OBJ_TAG_BITS;\n\n\treturn obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_stat_inc",
          "args": [
            "class",
            "OBJ_USED",
            "1"
          ],
          "line": 1454
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "548-552",
          "snippet": "static inline void zs_stat_inc(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] += cnt;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_stat_inc(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] += cnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mod_zspage_inuse",
          "args": [
            "zspage",
            "1"
          ],
          "line": 1453
        },
        "resolved": true,
        "details": {
          "function_name": "mod_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "478-481",
          "snippet": "static inline void mod_zspage_inuse(struct zspage *zspage, int val)\n{\n\tzspage->inuse += val;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void mod_zspage_inuse(struct zspage *zspage, int val)\n{\n\tzspage->inuse += val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "vaddr"
          ],
          "line": 1452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!PageHugeObject(m_page)"
          ],
          "line": 1445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHugeObject",
          "args": [
            "m_page"
          ],
          "line": 1445
        },
        "resolved": true,
        "details": {
          "function_name": "PageHugeObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "225-228",
          "snippet": "static int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_freeobj",
          "args": [
            "zspage",
            "link->next >> OBJ_TAG_BITS"
          ],
          "line": 1444
        },
        "resolved": true,
        "details": {
          "function_name": "set_freeobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "506-509",
          "snippet": "static inline void set_freeobj(struct zspage *zspage, unsigned int obj)\n{\n\tzspage->freeobj = obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void set_freeobj(struct zspage *zspage, unsigned int obj)\n{\n\tzspage->freeobj = obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "m_page"
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "m_page"
          ],
          "line": 1440
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_first_page",
          "args": [
            "zspage"
          ],
          "line": 1437
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "483-489",
          "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_freeobj",
          "args": [
            "zspage"
          ],
          "line": 1432
        },
        "resolved": true,
        "details": {
          "function_name": "get_freeobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "501-504",
          "snippet": "static inline unsigned int get_freeobj(struct zspage *zspage)\n{\n\treturn zspage->freeobj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline unsigned int get_freeobj(struct zspage *zspage)\n{\n\treturn zspage->freeobj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_TAG_BITS 1\n#define OBJ_ALLOCATED_TAG 1\n\nstatic unsigned long obj_malloc(struct size_class *class,\n\t\t\t\tstruct zspage *zspage, unsigned long handle)\n{\n\tint i, nr_page, offset;\n\tunsigned long obj;\n\tstruct link_free *link;\n\n\tstruct page *m_page;\n\tunsigned long m_offset;\n\tvoid *vaddr;\n\n\thandle |= OBJ_ALLOCATED_TAG;\n\tobj = get_freeobj(zspage);\n\n\toffset = obj * class->size;\n\tnr_page = offset >> PAGE_SHIFT;\n\tm_offset = offset & ~PAGE_MASK;\n\tm_page = get_first_page(zspage);\n\n\tfor (i = 0; i < nr_page; i++)\n\t\tm_page = get_next_page(m_page);\n\n\tvaddr = kmap_atomic(m_page);\n\tlink = (struct link_free *)vaddr + m_offset / sizeof(*link);\n\tset_freeobj(zspage, link->next >> OBJ_TAG_BITS);\n\tif (likely(!PageHugeObject(m_page)))\n\t\t/* record handle in the header of allocated chunk */\n\t\tlink->handle = handle;\n\telse\n\t\t/* record handle to page->index */\n\t\tzspage->first_page->index = handle;\n\n\tkunmap_atomic(vaddr);\n\tmod_zspage_inuse(zspage, 1);\n\tzs_stat_inc(class, OBJ_USED, 1);\n\n\tobj = location_to_obj(m_page, obj);\n\n\treturn obj;\n}"
  },
  {
    "function_name": "zs_huge_class_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1414-1417",
    "snippet": "size_t zs_huge_class_size(struct zs_pool *pool)\n{\n\treturn huge_class_size;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static size_t huge_class_size;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic size_t huge_class_size;\n\nsize_t zs_huge_class_size(struct zs_pool *pool)\n{\n\treturn huge_class_size;\n}"
  },
  {
    "function_name": "zs_unmap_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1363-1398",
    "snippet": "void zs_unmap_object(struct zs_pool *pool, unsigned long handle)\n{\n\tstruct zspage *zspage;\n\tstruct page *page;\n\tunsigned long obj, off;\n\tunsigned int obj_idx;\n\n\tunsigned int class_idx;\n\tenum fullness_group fg;\n\tstruct size_class *class;\n\tstruct mapping_area *area;\n\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &page, &obj_idx);\n\tzspage = get_zspage(page);\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tclass = pool->size_class[class_idx];\n\toff = (class->size * obj_idx) & ~PAGE_MASK;\n\n\tarea = this_cpu_ptr(&zs_map_area);\n\tif (off + class->size <= PAGE_SIZE)\n\t\tkunmap_atomic(area->vm_addr);\n\telse {\n\t\tstruct page *pages[2];\n\n\t\tpages[0] = page;\n\t\tpages[1] = get_next_page(page);\n\t\tBUG_ON(!pages[1]);\n\n\t\t__zs_unmap_object(area, pages, off, class->size);\n\t}\n\tput_cpu_var(zs_map_area);\n\n\tmigrate_read_unlock(zspage);\n\tunpin_tag(handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct mapping_area, zs_map_area);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unpin_tag",
          "args": [
            "handle"
          ],
          "line": 1397
        },
        "resolved": true,
        "details": {
          "function_name": "unpin_tag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "912-915",
          "snippet": "static void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "migrate_read_unlock",
          "args": [
            "zspage"
          ],
          "line": 1396
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_read_unlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1859-1862",
          "snippet": "static void migrate_read_unlock(struct zspage *zspage)\n{\n\tread_unlock(&zspage->lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_read_unlock(struct zspage *zspage)\n{\n\tread_unlock(&zspage->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_cpu_var",
          "args": [
            "zs_map_area"
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__zs_unmap_object",
          "args": [
            "area",
            "pages",
            "off",
            "class->size"
          ],
          "line": 1392
        },
        "resolved": true,
        "details": {
          "function_name": "__zs_unmap_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1217-1247",
          "snippet": "static void __zs_unmap_object(struct mapping_area *area,\n\t\t\tstruct page *pages[2], int off, int size)\n{\n\tint sizes[2];\n\tvoid *addr;\n\tchar *buf;\n\n\t/* no write fastpath */\n\tif (area->vm_mm == ZS_MM_RO)\n\t\tgoto out;\n\n\tbuf = area->vm_buf;\n\tbuf = buf + ZS_HANDLE_SIZE;\n\tsize -= ZS_HANDLE_SIZE;\n\toff += ZS_HANDLE_SIZE;\n\n\tsizes[0] = PAGE_SIZE - off;\n\tsizes[1] = size - sizes[0];\n\n\t/* copy per-cpu buffer to object */\n\taddr = kmap_atomic(pages[0]);\n\tmemcpy(addr + off, buf, sizes[0]);\n\tkunmap_atomic(addr);\n\taddr = kmap_atomic(pages[1]);\n\tmemcpy(addr, buf + sizes[0], sizes[1]);\n\tkunmap_atomic(addr);\n\nout:\n\t/* enable page faults to match kunmap_atomic() return conditions */\n\tpagefault_enable();\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nstatic void __zs_unmap_object(struct mapping_area *area,\n\t\t\tstruct page *pages[2], int off, int size)\n{\n\tint sizes[2];\n\tvoid *addr;\n\tchar *buf;\n\n\t/* no write fastpath */\n\tif (area->vm_mm == ZS_MM_RO)\n\t\tgoto out;\n\n\tbuf = area->vm_buf;\n\tbuf = buf + ZS_HANDLE_SIZE;\n\tsize -= ZS_HANDLE_SIZE;\n\toff += ZS_HANDLE_SIZE;\n\n\tsizes[0] = PAGE_SIZE - off;\n\tsizes[1] = size - sizes[0];\n\n\t/* copy per-cpu buffer to object */\n\taddr = kmap_atomic(pages[0]);\n\tmemcpy(addr + off, buf, sizes[0]);\n\tkunmap_atomic(addr);\n\taddr = kmap_atomic(pages[1]);\n\tmemcpy(addr, buf + sizes[0], sizes[1]);\n\tkunmap_atomic(addr);\n\nout:\n\t/* enable page faults to match kunmap_atomic() return conditions */\n\tpagefault_enable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!pages[1]"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "page"
          ],
          "line": 1389
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "area->vm_addr"
          ],
          "line": 1384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&zs_map_area"
          ],
          "line": 1382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&fg"
          ],
          "line": 1378
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage",
          "args": [
            "page"
          ],
          "line": 1377
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_to_location",
          "args": [
            "obj",
            "&page",
            "&obj_idx"
          ],
          "line": 1376
        },
        "resolved": true,
        "details": {
          "function_name": "obj_to_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "859-865",
          "snippet": "static void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
            "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle_to_obj",
          "args": [
            "handle"
          ],
          "line": 1375
        },
        "resolved": true,
        "details": {
          "function_name": "handle_to_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "883-886",
          "snippet": "static unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic DEFINE_PER_CPU(struct mapping_area, zs_map_area);\n\nvoid zs_unmap_object(struct zs_pool *pool, unsigned long handle)\n{\n\tstruct zspage *zspage;\n\tstruct page *page;\n\tunsigned long obj, off;\n\tunsigned int obj_idx;\n\n\tunsigned int class_idx;\n\tenum fullness_group fg;\n\tstruct size_class *class;\n\tstruct mapping_area *area;\n\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &page, &obj_idx);\n\tzspage = get_zspage(page);\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tclass = pool->size_class[class_idx];\n\toff = (class->size * obj_idx) & ~PAGE_MASK;\n\n\tarea = this_cpu_ptr(&zs_map_area);\n\tif (off + class->size <= PAGE_SIZE)\n\t\tkunmap_atomic(area->vm_addr);\n\telse {\n\t\tstruct page *pages[2];\n\n\t\tpages[0] = page;\n\t\tpages[1] = get_next_page(page);\n\t\tBUG_ON(!pages[1]);\n\n\t\t__zs_unmap_object(area, pages, off, class->size);\n\t}\n\tput_cpu_var(zs_map_area);\n\n\tmigrate_read_unlock(zspage);\n\tunpin_tag(handle);\n}"
  },
  {
    "function_name": "zs_map_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1304-1360",
    "snippet": "void *zs_map_object(struct zs_pool *pool, unsigned long handle,\n\t\t\tenum zs_mapmode mm)\n{\n\tstruct zspage *zspage;\n\tstruct page *page;\n\tunsigned long obj, off;\n\tunsigned int obj_idx;\n\n\tunsigned int class_idx;\n\tenum fullness_group fg;\n\tstruct size_class *class;\n\tstruct mapping_area *area;\n\tstruct page *pages[2];\n\tvoid *ret;\n\n\t/*\n\t * Because we use per-cpu mapping areas shared among the\n\t * pools/users, we can't allow mapping in interrupt context\n\t * because it can corrupt another users mappings.\n\t */\n\tBUG_ON(in_interrupt());\n\n\t/* From now on, migration cannot move the object */\n\tpin_tag(handle);\n\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &page, &obj_idx);\n\tzspage = get_zspage(page);\n\n\t/* migration cannot move any subpage in this zspage */\n\tmigrate_read_lock(zspage);\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tclass = pool->size_class[class_idx];\n\toff = (class->size * obj_idx) & ~PAGE_MASK;\n\n\tarea = &get_cpu_var(zs_map_area);\n\tarea->vm_mm = mm;\n\tif (off + class->size <= PAGE_SIZE) {\n\t\t/* this object is contained entirely within a page */\n\t\tarea->vm_addr = kmap_atomic(page);\n\t\tret = area->vm_addr + off;\n\t\tgoto out;\n\t}\n\n\t/* this object spans two pages */\n\tpages[0] = page;\n\tpages[1] = get_next_page(page);\n\tBUG_ON(!pages[1]);\n\n\tret = __zs_map_object(area, pages, off, class->size);\nout:\n\tif (likely(!PageHugeObject(page)))\n\t\tret += ZS_HANDLE_SIZE;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
    ],
    "globals_used": [
      "static DEFINE_PER_CPU(struct mapping_area, zs_map_area);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!PageHugeObject(page)"
          ],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHugeObject",
          "args": [
            "page"
          ],
          "line": 1356
        },
        "resolved": true,
        "details": {
          "function_name": "PageHugeObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "225-228",
          "snippet": "static int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__zs_map_object",
          "args": [
            "area",
            "pages",
            "off",
            "class->size"
          ],
          "line": 1354
        },
        "resolved": true,
        "details": {
          "function_name": "__zs_map_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1189-1215",
          "snippet": "static void *__zs_map_object(struct mapping_area *area,\n\t\t\tstruct page *pages[2], int off, int size)\n{\n\tint sizes[2];\n\tvoid *addr;\n\tchar *buf = area->vm_buf;\n\n\t/* disable page faults to match kmap_atomic() return conditions */\n\tpagefault_disable();\n\n\t/* no read fastpath */\n\tif (area->vm_mm == ZS_MM_WO)\n\t\tgoto out;\n\n\tsizes[0] = PAGE_SIZE - off;\n\tsizes[1] = size - sizes[0];\n\n\t/* copy object to per-cpu buffer */\n\taddr = kmap_atomic(pages[0]);\n\tmemcpy(buf, addr + off, sizes[0]);\n\tkunmap_atomic(addr);\n\taddr = kmap_atomic(pages[1]);\n\tmemcpy(buf + sizes[0], addr, sizes[1]);\n\tkunmap_atomic(addr);\nout:\n\treturn area->vm_buf;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void *__zs_map_object(struct mapping_area *area,\n\t\t\tstruct page *pages[2], int off, int size)\n{\n\tint sizes[2];\n\tvoid *addr;\n\tchar *buf = area->vm_buf;\n\n\t/* disable page faults to match kmap_atomic() return conditions */\n\tpagefault_disable();\n\n\t/* no read fastpath */\n\tif (area->vm_mm == ZS_MM_WO)\n\t\tgoto out;\n\n\tsizes[0] = PAGE_SIZE - off;\n\tsizes[1] = size - sizes[0];\n\n\t/* copy object to per-cpu buffer */\n\taddr = kmap_atomic(pages[0]);\n\tmemcpy(buf, addr + off, sizes[0]);\n\tkunmap_atomic(addr);\n\taddr = kmap_atomic(pages[1]);\n\tmemcpy(buf + sizes[0], addr, sizes[1]);\n\tkunmap_atomic(addr);\nout:\n\treturn area->vm_buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!pages[1]"
          ],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "page"
          ],
          "line": 1351
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 1344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_var",
          "args": [
            "zs_map_area"
          ],
          "line": 1340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&fg"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      },
      {
        "call_info": {
          "callee": "migrate_read_lock",
          "args": [
            "zspage"
          ],
          "line": 1334
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_read_lock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1854-1857",
          "snippet": "static void migrate_read_lock(struct zspage *zspage)\n{\n\tread_lock(&zspage->lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_read_lock(struct zspage *zspage)\n{\n\tread_lock(&zspage->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage",
          "args": [
            "page"
          ],
          "line": 1331
        },
        "resolved": true,
        "details": {
          "function_name": "find_get_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1114-1127",
          "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "obj_to_location",
          "args": [
            "obj",
            "&page",
            "&obj_idx"
          ],
          "line": 1330
        },
        "resolved": true,
        "details": {
          "function_name": "obj_to_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "859-865",
          "snippet": "static void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
            "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "handle_to_obj",
          "args": [
            "handle"
          ],
          "line": 1329
        },
        "resolved": true,
        "details": {
          "function_name": "handle_to_obj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "883-886",
          "snippet": "static unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pin_tag",
          "args": [
            "handle"
          ],
          "line": 1327
        },
        "resolved": true,
        "details": {
          "function_name": "unpin_tag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "912-915",
          "snippet": "static void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define HANDLE_PIN_BIT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "in_interrupt()"
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_interrupt",
          "args": [],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nstatic DEFINE_PER_CPU(struct mapping_area, zs_map_area);\n\nvoid *zs_map_object(struct zs_pool *pool, unsigned long handle,\n\t\t\tenum zs_mapmode mm)\n{\n\tstruct zspage *zspage;\n\tstruct page *page;\n\tunsigned long obj, off;\n\tunsigned int obj_idx;\n\n\tunsigned int class_idx;\n\tenum fullness_group fg;\n\tstruct size_class *class;\n\tstruct mapping_area *area;\n\tstruct page *pages[2];\n\tvoid *ret;\n\n\t/*\n\t * Because we use per-cpu mapping areas shared among the\n\t * pools/users, we can't allow mapping in interrupt context\n\t * because it can corrupt another users mappings.\n\t */\n\tBUG_ON(in_interrupt());\n\n\t/* From now on, migration cannot move the object */\n\tpin_tag(handle);\n\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &page, &obj_idx);\n\tzspage = get_zspage(page);\n\n\t/* migration cannot move any subpage in this zspage */\n\tmigrate_read_lock(zspage);\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tclass = pool->size_class[class_idx];\n\toff = (class->size * obj_idx) & ~PAGE_MASK;\n\n\tarea = &get_cpu_var(zs_map_area);\n\tarea->vm_mm = mm;\n\tif (off + class->size <= PAGE_SIZE) {\n\t\t/* this object is contained entirely within a page */\n\t\tarea->vm_addr = kmap_atomic(page);\n\t\tret = area->vm_addr + off;\n\t\tgoto out;\n\t}\n\n\t/* this object spans two pages */\n\tpages[0] = page;\n\tpages[1] = get_next_page(page);\n\tBUG_ON(!pages[1]);\n\n\tret = __zs_map_object(area, pages, off, class->size);\nout:\n\tif (likely(!PageHugeObject(page)))\n\t\tret += ZS_HANDLE_SIZE;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "zs_get_total_pages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1283-1286",
    "snippet": "unsigned long zs_get_total_pages(struct zs_pool *pool)\n{\n\treturn atomic_long_read(&pool->pages_allocated);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_long_read",
          "args": [
            "&pool->pages_allocated"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nunsigned long zs_get_total_pages(struct zs_pool *pool)\n{\n\treturn atomic_long_read(&pool->pages_allocated);\n}"
  },
  {
    "function_name": "zspage_full",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1278-1281",
    "snippet": "static bool zspage_full(struct size_class *class, struct zspage *zspage)\n{\n\treturn get_zspage_inuse(zspage) == class->objs_per_zspage;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_zspage_inuse",
          "args": [
            "zspage"
          ],
          "line": 1280
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "468-471",
          "snippet": "static inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool zspage_full(struct size_class *class, struct zspage *zspage)\n{\n\treturn get_zspage_inuse(zspage) == class->objs_per_zspage;\n}"
  },
  {
    "function_name": "can_merge",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1268-1276",
    "snippet": "static bool can_merge(struct size_class *prev, int pages_per_zspage,\n\t\t\t\t\tint objs_per_zspage)\n{\n\tif (prev->pages_per_zspage == pages_per_zspage &&\n\t\tprev->objs_per_zspage == objs_per_zspage)\n\t\treturn true;\n\n\treturn false;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool can_merge(struct size_class *prev, int pages_per_zspage,\n\t\t\t\t\tint objs_per_zspage)\n{\n\tif (prev->pages_per_zspage == pages_per_zspage &&\n\t\tprev->objs_per_zspage == objs_per_zspage)\n\t\treturn true;\n\n\treturn false;\n}"
  },
  {
    "function_name": "zs_cpu_dead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1259-1266",
    "snippet": "static int zs_cpu_dead(unsigned int cpu)\n{\n\tstruct mapping_area *area;\n\n\tarea = &per_cpu(zs_map_area, cpu);\n\t__zs_cpu_down(area);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct mapping_area, zs_map_area);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__zs_cpu_down",
          "args": [
            "area"
          ],
          "line": 1264
        },
        "resolved": true,
        "details": {
          "function_name": "__zs_cpu_down",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1183-1187",
          "snippet": "static inline void __zs_cpu_down(struct mapping_area *area)\n{\n\tkfree(area->vm_buf);\n\tarea->vm_buf = NULL;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void __zs_cpu_down(struct mapping_area *area)\n{\n\tkfree(area->vm_buf);\n\tarea->vm_buf = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "zs_map_area",
            "cpu"
          ],
          "line": 1263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic DEFINE_PER_CPU(struct mapping_area, zs_map_area);\n\nstatic int zs_cpu_dead(unsigned int cpu)\n{\n\tstruct mapping_area *area;\n\n\tarea = &per_cpu(zs_map_area, cpu);\n\t__zs_cpu_down(area);\n\treturn 0;\n}"
  },
  {
    "function_name": "zs_cpu_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1251-1257",
    "snippet": "static int zs_cpu_prepare(unsigned int cpu)\n{\n\tstruct mapping_area *area;\n\n\tarea = &per_cpu(zs_map_area, cpu);\n\treturn __zs_cpu_up(area);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(struct mapping_area, zs_map_area);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__zs_cpu_up",
          "args": [
            "area"
          ],
          "line": 1256
        },
        "resolved": true,
        "details": {
          "function_name": "__zs_cpu_up",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1169-1181",
          "snippet": "static inline int __zs_cpu_up(struct mapping_area *area)\n{\n\t/*\n\t * Make sure we don't leak memory if a cpu UP notification\n\t * and zs_init() race and both call zs_cpu_up() on the same cpu\n\t */\n\tif (area->vm_buf)\n\t\treturn 0;\n\tarea->vm_buf = kmalloc(ZS_MAX_ALLOC_SIZE, GFP_KERNEL);\n\tif (!area->vm_buf)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE\n\nstatic inline int __zs_cpu_up(struct mapping_area *area)\n{\n\t/*\n\t * Make sure we don't leak memory if a cpu UP notification\n\t * and zs_init() race and both call zs_cpu_up() on the same cpu\n\t */\n\tif (area->vm_buf)\n\t\treturn 0;\n\tarea->vm_buf = kmalloc(ZS_MAX_ALLOC_SIZE, GFP_KERNEL);\n\tif (!area->vm_buf)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "zs_map_area",
            "cpu"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic DEFINE_PER_CPU(struct mapping_area, zs_map_area);\n\nstatic int zs_cpu_prepare(unsigned int cpu)\n{\n\tstruct mapping_area *area;\n\n\tarea = &per_cpu(zs_map_area, cpu);\n\treturn __zs_cpu_up(area);\n}"
  },
  {
    "function_name": "__zs_unmap_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1217-1247",
    "snippet": "static void __zs_unmap_object(struct mapping_area *area,\n\t\t\tstruct page *pages[2], int off, int size)\n{\n\tint sizes[2];\n\tvoid *addr;\n\tchar *buf;\n\n\t/* no write fastpath */\n\tif (area->vm_mm == ZS_MM_RO)\n\t\tgoto out;\n\n\tbuf = area->vm_buf;\n\tbuf = buf + ZS_HANDLE_SIZE;\n\tsize -= ZS_HANDLE_SIZE;\n\toff += ZS_HANDLE_SIZE;\n\n\tsizes[0] = PAGE_SIZE - off;\n\tsizes[1] = size - sizes[0];\n\n\t/* copy per-cpu buffer to object */\n\taddr = kmap_atomic(pages[0]);\n\tmemcpy(addr + off, buf, sizes[0]);\n\tkunmap_atomic(addr);\n\taddr = kmap_atomic(pages[1]);\n\tmemcpy(addr, buf + sizes[0], sizes[1]);\n\tkunmap_atomic(addr);\n\nout:\n\t/* enable page faults to match kunmap_atomic() return conditions */\n\tpagefault_enable();\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pagefault_enable",
          "args": [],
          "line": 1246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "addr"
          ],
          "line": 1242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "addr",
            "buf + sizes[0]",
            "sizes[1]"
          ],
          "line": 1241
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "pages[1]"
          ],
          "line": 1240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "addr"
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "pages[0]"
          ],
          "line": 1237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nstatic void __zs_unmap_object(struct mapping_area *area,\n\t\t\tstruct page *pages[2], int off, int size)\n{\n\tint sizes[2];\n\tvoid *addr;\n\tchar *buf;\n\n\t/* no write fastpath */\n\tif (area->vm_mm == ZS_MM_RO)\n\t\tgoto out;\n\n\tbuf = area->vm_buf;\n\tbuf = buf + ZS_HANDLE_SIZE;\n\tsize -= ZS_HANDLE_SIZE;\n\toff += ZS_HANDLE_SIZE;\n\n\tsizes[0] = PAGE_SIZE - off;\n\tsizes[1] = size - sizes[0];\n\n\t/* copy per-cpu buffer to object */\n\taddr = kmap_atomic(pages[0]);\n\tmemcpy(addr + off, buf, sizes[0]);\n\tkunmap_atomic(addr);\n\taddr = kmap_atomic(pages[1]);\n\tmemcpy(addr, buf + sizes[0], sizes[1]);\n\tkunmap_atomic(addr);\n\nout:\n\t/* enable page faults to match kunmap_atomic() return conditions */\n\tpagefault_enable();\n}"
  },
  {
    "function_name": "__zs_map_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1189-1215",
    "snippet": "static void *__zs_map_object(struct mapping_area *area,\n\t\t\tstruct page *pages[2], int off, int size)\n{\n\tint sizes[2];\n\tvoid *addr;\n\tchar *buf = area->vm_buf;\n\n\t/* disable page faults to match kmap_atomic() return conditions */\n\tpagefault_disable();\n\n\t/* no read fastpath */\n\tif (area->vm_mm == ZS_MM_WO)\n\t\tgoto out;\n\n\tsizes[0] = PAGE_SIZE - off;\n\tsizes[1] = size - sizes[0];\n\n\t/* copy object to per-cpu buffer */\n\taddr = kmap_atomic(pages[0]);\n\tmemcpy(buf, addr + off, sizes[0]);\n\tkunmap_atomic(addr);\n\taddr = kmap_atomic(pages[1]);\n\tmemcpy(buf + sizes[0], addr, sizes[1]);\n\tkunmap_atomic(addr);\nout:\n\treturn area->vm_buf;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "addr"
          ],
          "line": 1212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf + sizes[0]",
            "addr",
            "sizes[1]"
          ],
          "line": 1211
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "pages[1]"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "addr"
          ],
          "line": 1209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "pages[0]"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pagefault_disable",
          "args": [],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void *__zs_map_object(struct mapping_area *area,\n\t\t\tstruct page *pages[2], int off, int size)\n{\n\tint sizes[2];\n\tvoid *addr;\n\tchar *buf = area->vm_buf;\n\n\t/* disable page faults to match kmap_atomic() return conditions */\n\tpagefault_disable();\n\n\t/* no read fastpath */\n\tif (area->vm_mm == ZS_MM_WO)\n\t\tgoto out;\n\n\tsizes[0] = PAGE_SIZE - off;\n\tsizes[1] = size - sizes[0];\n\n\t/* copy object to per-cpu buffer */\n\taddr = kmap_atomic(pages[0]);\n\tmemcpy(buf, addr + off, sizes[0]);\n\tkunmap_atomic(addr);\n\taddr = kmap_atomic(pages[1]);\n\tmemcpy(buf + sizes[0], addr, sizes[1]);\n\tkunmap_atomic(addr);\nout:\n\treturn area->vm_buf;\n}"
  },
  {
    "function_name": "__zs_cpu_down",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1183-1187",
    "snippet": "static inline void __zs_cpu_down(struct mapping_area *area)\n{\n\tkfree(area->vm_buf);\n\tarea->vm_buf = NULL;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "area->vm_buf"
          ],
          "line": 1185
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void __zs_cpu_down(struct mapping_area *area)\n{\n\tkfree(area->vm_buf);\n\tarea->vm_buf = NULL;\n}"
  },
  {
    "function_name": "__zs_cpu_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1169-1181",
    "snippet": "static inline int __zs_cpu_up(struct mapping_area *area)\n{\n\t/*\n\t * Make sure we don't leak memory if a cpu UP notification\n\t * and zs_init() race and both call zs_cpu_up() on the same cpu\n\t */\n\tif (area->vm_buf)\n\t\treturn 0;\n\tarea->vm_buf = kmalloc(ZS_MAX_ALLOC_SIZE, GFP_KERNEL);\n\tif (!area->vm_buf)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "ZS_MAX_ALLOC_SIZE",
            "GFP_KERNEL"
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "__kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3729-3732",
          "snippet": "void *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nvoid *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE\n\nstatic inline int __zs_cpu_up(struct mapping_area *area)\n{\n\t/*\n\t * Make sure we don't leak memory if a cpu UP notification\n\t * and zs_init() race and both call zs_cpu_up() on the same cpu\n\t */\n\tif (area->vm_buf)\n\t\treturn 0;\n\tarea->vm_buf = kmalloc(ZS_MAX_ALLOC_SIZE, GFP_KERNEL);\n\tif (!area->vm_buf)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
  },
  {
    "function_name": "__zs_unmap_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1159-1165",
    "snippet": "static inline void __zs_unmap_object(struct mapping_area *area,\n\t\t\t\tstruct page *pages[2], int off, int size)\n{\n\tunsigned long addr = (unsigned long)area->vm_addr;\n\n\tunmap_kernel_range(addr, PAGE_SIZE * 2);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unmap_kernel_range",
          "args": [
            "addr",
            "PAGE_SIZE * 2"
          ],
          "line": 1164
        },
        "resolved": true,
        "details": {
          "function_name": "unmap_kernel_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmalloc.c",
          "lines": "1327-1334",
          "snippet": "void unmap_kernel_range(unsigned long addr, unsigned long size)\n{\n\tunsigned long end = addr + size;\n\n\tflush_cache_vunmap(addr, end);\n\tvunmap_page_range(addr, end);\n\tflush_tlb_kernel_range(addr, end);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/shmparam.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/bitops.h>",
            "#include <linux/llist.h>",
            "#include <linux/compiler.h>",
            "#include <linux/atomic.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/pfn.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/shmparam.h>\n#include <asm/tlbflush.h>\n#include <linux/uaccess.h>\n#include <linux/bitops.h>\n#include <linux/llist.h>\n#include <linux/compiler.h>\n#include <linux/atomic.h>\n#include <linux/kmemleak.h>\n#include <linux/pfn.h>\n#include <linux/rcupdate.h>\n#include <linux/radix-tree.h>\n#include <linux/rbtree.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kallsyms.h>\n#include <linux/debugobjects.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n\nvoid unmap_kernel_range(unsigned long addr, unsigned long size)\n{\n\tunsigned long end = addr + size;\n\n\tflush_cache_vunmap(addr, end);\n\tvunmap_page_range(addr, end);\n\tflush_tlb_kernel_range(addr, end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void __zs_unmap_object(struct mapping_area *area,\n\t\t\t\tstruct page *pages[2], int off, int size)\n{\n\tunsigned long addr = (unsigned long)area->vm_addr;\n\n\tunmap_kernel_range(addr, PAGE_SIZE * 2);\n}"
  },
  {
    "function_name": "__zs_map_object",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1151-1157",
    "snippet": "static inline void *__zs_map_object(struct mapping_area *area,\n\t\t\t\tstruct page *pages[2], int off, int size)\n{\n\tBUG_ON(map_vm_area(area->vm, PAGE_KERNEL, pages));\n\tarea->vm_addr = area->vm->addr;\n\treturn area->vm_addr + off;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "map_vm_area(area->vm, PAGE_KERNEL, pages)"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map_vm_area",
          "args": [
            "area->vm",
            "PAGE_KERNEL",
            "pages"
          ],
          "line": 1154
        },
        "resolved": true,
        "details": {
          "function_name": "map_vm_area",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmalloc.c",
          "lines": "1337-1346",
          "snippet": "int map_vm_area(struct vm_struct *area, pgprot_t prot, struct page **pages)\n{\n\tunsigned long addr = (unsigned long)area->addr;\n\tunsigned long end = addr + get_vm_area_size(area);\n\tint err;\n\n\terr = vmap_page_range(addr, end, prot, pages);\n\n\treturn err > 0 ? 0 : err;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/shmparam.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/bitops.h>",
            "#include <linux/llist.h>",
            "#include <linux/compiler.h>",
            "#include <linux/atomic.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/pfn.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/shmparam.h>\n#include <asm/tlbflush.h>\n#include <linux/uaccess.h>\n#include <linux/bitops.h>\n#include <linux/llist.h>\n#include <linux/compiler.h>\n#include <linux/atomic.h>\n#include <linux/kmemleak.h>\n#include <linux/pfn.h>\n#include <linux/rcupdate.h>\n#include <linux/radix-tree.h>\n#include <linux/rbtree.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kallsyms.h>\n#include <linux/debugobjects.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n\nint map_vm_area(struct vm_struct *area, pgprot_t prot, struct page **pages)\n{\n\tunsigned long addr = (unsigned long)area->addr;\n\tunsigned long end = addr + get_vm_area_size(area);\n\tint err;\n\n\terr = vmap_page_range(addr, end, prot, pages);\n\n\treturn err > 0 ? 0 : err;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void *__zs_map_object(struct mapping_area *area,\n\t\t\t\tstruct page *pages[2], int off, int size)\n{\n\tBUG_ON(map_vm_area(area->vm, PAGE_KERNEL, pages));\n\tarea->vm_addr = area->vm->addr;\n\treturn area->vm_addr + off;\n}"
  },
  {
    "function_name": "__zs_cpu_down",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1144-1149",
    "snippet": "static inline void __zs_cpu_down(struct mapping_area *area)\n{\n\tif (area->vm)\n\t\tfree_vm_area(area->vm);\n\tarea->vm = NULL;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_vm_area",
          "args": [
            "area->vm"
          ],
          "line": 1147
        },
        "resolved": true,
        "details": {
          "function_name": "free_vm_area",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/nommu.c",
          "lines": "463-466",
          "snippet": "void free_vm_area(struct vm_struct *area)\n{\n\tBUG();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/mmu_context.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/printk.h>",
            "#include <linux/audit.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/mount.h>",
            "#include <linux/compiler.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/file.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/mmu_context.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <linux/printk.h>\n#include <linux/audit.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/mount.h>\n#include <linux/compiler.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/file.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/vmacache.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid free_vm_area(struct vm_struct *area)\n{\n\tBUG();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void __zs_cpu_down(struct mapping_area *area)\n{\n\tif (area->vm)\n\t\tfree_vm_area(area->vm);\n\tarea->vm = NULL;\n}"
  },
  {
    "function_name": "__zs_cpu_up",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1130-1142",
    "snippet": "static inline int __zs_cpu_up(struct mapping_area *area)\n{\n\t/*\n\t * Make sure we don't leak memory if a cpu UP notification\n\t * and zs_init() race and both call zs_cpu_up() on the same cpu\n\t */\n\tif (area->vm)\n\t\treturn 0;\n\tarea->vm = alloc_vm_area(PAGE_SIZE * 2, NULL);\n\tif (!area->vm)\n\t\treturn -ENOMEM;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_vm_area",
          "args": [
            "PAGE_SIZE * 2",
            "NULL"
          ],
          "line": 1138
        },
        "resolved": true,
        "details": {
          "function_name": "alloc_vm_area",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/nommu.c",
          "lines": "456-460",
          "snippet": "struct vm_struct *alloc_vm_area(size_t size, pte_t **ptes)\n{\n\tBUG();\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/mmu_context.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/printk.h>",
            "#include <linux/audit.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/mount.h>",
            "#include <linux/compiler.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/file.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/mmu_context.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <linux/printk.h>\n#include <linux/audit.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/mount.h>\n#include <linux/compiler.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/file.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/vmacache.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nstruct vm_struct *alloc_vm_area(size_t size, pte_t **ptes)\n{\n\tBUG();\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int __zs_cpu_up(struct mapping_area *area)\n{\n\t/*\n\t * Make sure we don't leak memory if a cpu UP notification\n\t * and zs_init() race and both call zs_cpu_up() on the same cpu\n\t */\n\tif (area->vm)\n\t\treturn 0;\n\tarea->vm = alloc_vm_area(PAGE_SIZE * 2, NULL);\n\tif (!area->vm)\n\t\treturn -ENOMEM;\n\treturn 0;\n}"
  },
  {
    "function_name": "find_get_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1114-1127",
    "snippet": "static struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_first_entry_or_null",
          "args": [
            "&class->fullness_list[i]",
            "structzspage",
            "list"
          ],
          "line": 1120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *find_get_zspage(struct size_class *class)\n{\n\tint i;\n\tstruct zspage *zspage;\n\n\tfor (i = ZS_ALMOST_FULL; i >= ZS_EMPTY; i--) {\n\t\tzspage = list_first_entry_or_null(&class->fullness_list[i],\n\t\t\t\tstruct zspage, list);\n\t\tif (zspage)\n\t\t\tbreak;\n\t}\n\n\treturn zspage;\n}"
  },
  {
    "function_name": "alloc_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1076-1112",
    "snippet": "static struct zspage *alloc_zspage(struct zs_pool *pool,\n\t\t\t\t\tstruct size_class *class,\n\t\t\t\t\tgfp_t gfp)\n{\n\tint i;\n\tstruct page *pages[ZS_MAX_PAGES_PER_ZSPAGE];\n\tstruct zspage *zspage = cache_alloc_zspage(pool, gfp);\n\n\tif (!zspage)\n\t\treturn NULL;\n\n\tmemset(zspage, 0, sizeof(struct zspage));\n\tzspage->magic = ZSPAGE_MAGIC;\n\tmigrate_lock_init(zspage);\n\n\tfor (i = 0; i < class->pages_per_zspage; i++) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_page(gfp);\n\t\tif (!page) {\n\t\t\twhile (--i >= 0) {\n\t\t\t\tdec_zone_page_state(pages[i], NR_ZSPAGES);\n\t\t\t\t__free_page(pages[i]);\n\t\t\t}\n\t\t\tcache_free_zspage(pool, zspage);\n\t\t\treturn NULL;\n\t\t}\n\n\t\tinc_zone_page_state(page, NR_ZSPAGES);\n\t\tpages[i] = page;\n\t}\n\n\tcreate_page_chain(class, zspage, pages);\n\tinit_zspage(class, zspage);\n\n\treturn zspage;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)",
      "#define ZSPAGE_MAGIC\t0x58"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_zspage",
          "args": [
            "class",
            "zspage"
          ],
          "line": 1109
        },
        "resolved": true,
        "details": {
          "function_name": "init_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "996-1038",
          "snippet": "static void init_zspage(struct size_class *class, struct zspage *zspage)\n{\n\tunsigned int freeobj = 1;\n\tunsigned long off = 0;\n\tstruct page *page = get_first_page(zspage);\n\n\twhile (page) {\n\t\tstruct page *next_page;\n\t\tstruct link_free *link;\n\t\tvoid *vaddr;\n\n\t\tset_first_obj_offset(page, off);\n\n\t\tvaddr = kmap_atomic(page);\n\t\tlink = (struct link_free *)vaddr + off / sizeof(*link);\n\n\t\twhile ((off += class->size) < PAGE_SIZE) {\n\t\t\tlink->next = freeobj++ << OBJ_TAG_BITS;\n\t\t\tlink += class->size / sizeof(*link);\n\t\t}\n\n\t\t/*\n\t\t * We now come to the last (full or partial) object on this\n\t\t * page, which must point to the first object on the next\n\t\t * page (if present)\n\t\t */\n\t\tnext_page = get_next_page(page);\n\t\tif (next_page) {\n\t\t\tlink->next = freeobj++ << OBJ_TAG_BITS;\n\t\t} else {\n\t\t\t/*\n\t\t\t * Reset OBJ_TAG_BITS bit to last link to tell\n\t\t\t * whether it's allocated object or not.\n\t\t\t */\n\t\t\tlink->next = -1UL << OBJ_TAG_BITS;\n\t\t}\n\t\tkunmap_atomic(vaddr);\n\t\tpage = next_page;\n\t\toff %= PAGE_SIZE;\n\t}\n\n\tset_freeobj(zspage, 0);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define OBJ_TAG_BITS 1"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_TAG_BITS 1\n\nstatic void init_zspage(struct size_class *class, struct zspage *zspage)\n{\n\tunsigned int freeobj = 1;\n\tunsigned long off = 0;\n\tstruct page *page = get_first_page(zspage);\n\n\twhile (page) {\n\t\tstruct page *next_page;\n\t\tstruct link_free *link;\n\t\tvoid *vaddr;\n\n\t\tset_first_obj_offset(page, off);\n\n\t\tvaddr = kmap_atomic(page);\n\t\tlink = (struct link_free *)vaddr + off / sizeof(*link);\n\n\t\twhile ((off += class->size) < PAGE_SIZE) {\n\t\t\tlink->next = freeobj++ << OBJ_TAG_BITS;\n\t\t\tlink += class->size / sizeof(*link);\n\t\t}\n\n\t\t/*\n\t\t * We now come to the last (full or partial) object on this\n\t\t * page, which must point to the first object on the next\n\t\t * page (if present)\n\t\t */\n\t\tnext_page = get_next_page(page);\n\t\tif (next_page) {\n\t\t\tlink->next = freeobj++ << OBJ_TAG_BITS;\n\t\t} else {\n\t\t\t/*\n\t\t\t * Reset OBJ_TAG_BITS bit to last link to tell\n\t\t\t * whether it's allocated object or not.\n\t\t\t */\n\t\t\tlink->next = -1UL << OBJ_TAG_BITS;\n\t\t}\n\t\tkunmap_atomic(vaddr);\n\t\tpage = next_page;\n\t\toff %= PAGE_SIZE;\n\t}\n\n\tset_freeobj(zspage, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "create_page_chain",
          "args": [
            "class",
            "zspage",
            "pages"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "create_page_chain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1040-1071",
          "snippet": "static void create_page_chain(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *pages[])\n{\n\tint i;\n\tstruct page *page;\n\tstruct page *prev_page = NULL;\n\tint nr_pages = class->pages_per_zspage;\n\n\t/*\n\t * Allocate individual pages and link them together as:\n\t * 1. all pages are linked together using page->freelist\n\t * 2. each sub-page point to zspage using page->private\n\t *\n\t * we set PG_private to identify the first page (i.e. no other sub-page\n\t * has this flag set).\n\t */\n\tfor (i = 0; i < nr_pages; i++) {\n\t\tpage = pages[i];\n\t\tset_page_private(page, (unsigned long)zspage);\n\t\tpage->freelist = NULL;\n\t\tif (i == 0) {\n\t\t\tzspage->first_page = page;\n\t\t\tSetPagePrivate(page);\n\t\t\tif (unlikely(class->objs_per_zspage == 1 &&\n\t\t\t\t\tclass->pages_per_zspage == 1))\n\t\t\t\tSetPageHugeObject(page);\n\t\t} else {\n\t\t\tprev_page->freelist = page;\n\t\t}\n\t\tprev_page = page;\n\t}\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void create_page_chain(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *pages[])\n{\n\tint i;\n\tstruct page *page;\n\tstruct page *prev_page = NULL;\n\tint nr_pages = class->pages_per_zspage;\n\n\t/*\n\t * Allocate individual pages and link them together as:\n\t * 1. all pages are linked together using page->freelist\n\t * 2. each sub-page point to zspage using page->private\n\t *\n\t * we set PG_private to identify the first page (i.e. no other sub-page\n\t * has this flag set).\n\t */\n\tfor (i = 0; i < nr_pages; i++) {\n\t\tpage = pages[i];\n\t\tset_page_private(page, (unsigned long)zspage);\n\t\tpage->freelist = NULL;\n\t\tif (i == 0) {\n\t\t\tzspage->first_page = page;\n\t\t\tSetPagePrivate(page);\n\t\t\tif (unlikely(class->objs_per_zspage == 1 &&\n\t\t\t\t\tclass->pages_per_zspage == 1))\n\t\t\t\tSetPageHugeObject(page);\n\t\t} else {\n\t\t\tprev_page->freelist = page;\n\t\t}\n\t\tprev_page = page;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "inc_zone_page_state",
          "args": [
            "page",
            "NR_ZSPAGES"
          ],
          "line": 1104
        },
        "resolved": true,
        "details": {
          "function_name": "inc_zone_page_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmstat.c",
          "lines": "612-621",
          "snippet": "void inc_zone_page_state(struct page *page, enum zone_stat_item item)\n{\n\tunsigned long flags;\n\tstruct zone *zone;\n\n\tzone = page_zone(page);\n\tlocal_irq_save(flags);\n\t__inc_zone_state(zone, item);\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/writeback.h>",
            "#include <linux/math64.h>",
            "#include <linux/sched.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/err.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/page_ext.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/writeback.h>\n#include <linux/math64.h>\n#include <linux/sched.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/vmstat.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nvoid inc_zone_page_state(struct page *page, enum zone_stat_item item)\n{\n\tunsigned long flags;\n\tstruct zone *zone;\n\n\tzone = page_zone(page);\n\tlocal_irq_save(flags);\n\t__inc_zone_state(zone, item);\n\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_free_zspage",
          "args": [
            "pool",
            "zspage"
          ],
          "line": 1100
        },
        "resolved": true,
        "details": {
          "function_name": "cache_free_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "362-365",
          "snippet": "static void cache_free_zspage(struct zs_pool *pool, struct zspage *zspage)\n{\n\tkmem_cache_free(pool->zspage_cachep, zspage);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void cache_free_zspage(struct zs_pool *pool, struct zspage *zspage)\n{\n\tkmem_cache_free(pool->zspage_cachep, zspage);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__free_page",
          "args": [
            "pages[i]"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "__free_page_ext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_ext.c",
          "lines": "280-291",
          "snippet": "static void __free_page_ext(unsigned long pfn)\n{\n\tstruct mem_section *ms;\n\tstruct page_ext *base;\n\n\tms = __pfn_to_section(pfn);\n\tif (!ms || !ms->page_ext)\n\t\treturn;\n\tbase = get_entry(ms->page_ext, pfn);\n\tfree_page_ext(base);\n\tms->page_ext = NULL;\n}",
          "includes": [
            "#include <linux/page_idle.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/memory.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/memblock.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/page_idle.h>\n#include <linux/page_owner.h>\n#include <linux/kmemleak.h>\n#include <linux/vmalloc.h>\n#include <linux/memory.h>\n#include <linux/page_ext.h>\n#include <linux/memblock.h>\n#include <linux/mmzone.h>\n#include <linux/mm.h>\n\nstatic void __free_page_ext(unsigned long pfn)\n{\n\tstruct mem_section *ms;\n\tstruct page_ext *base;\n\n\tms = __pfn_to_section(pfn);\n\tif (!ms || !ms->page_ext)\n\t\treturn;\n\tbase = get_entry(ms->page_ext, pfn);\n\tfree_page_ext(base);\n\tms->page_ext = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dec_zone_page_state",
          "args": [
            "pages[i]",
            "NR_ZSPAGES"
          ],
          "line": 1097
        },
        "resolved": true,
        "details": {
          "function_name": "dec_zone_page_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmstat.c",
          "lines": "624-631",
          "snippet": "void dec_zone_page_state(struct page *page, enum zone_stat_item item)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\t__dec_zone_page_state(page, item);\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/writeback.h>",
            "#include <linux/math64.h>",
            "#include <linux/sched.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/err.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/page_ext.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/writeback.h>\n#include <linux/math64.h>\n#include <linux/sched.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/vmstat.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nvoid dec_zone_page_state(struct page *page, enum zone_stat_item item)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\t__dec_zone_page_state(page, item);\n\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_page",
          "args": [
            "gfp"
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "hugetlb_hstate_alloc_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/hugetlb.c",
          "lines": "2163-2184",
          "snippet": "static void __init hugetlb_hstate_alloc_pages(struct hstate *h)\n{\n\tunsigned long i;\n\n\tfor (i = 0; i < h->max_huge_pages; ++i) {\n\t\tif (hstate_is_gigantic(h)) {\n\t\t\tif (!alloc_bootmem_huge_page(h))\n\t\t\t\tbreak;\n\t\t} else if (!alloc_pool_huge_page(h,\n\t\t\t\t\t &node_states[N_MEMORY]))\n\t\t\tbreak;\n\t\tcond_resched();\n\t}\n\tif (i < h->max_huge_pages) {\n\t\tchar buf[32];\n\n\t\tstring_get_size(huge_page_size(h), 1, STRING_UNITS_2, buf, 32);\n\t\tpr_warn(\"HugeTLB: allocating %lu of page size %s failed.  Only allocated %lu hugepages.\\n\",\n\t\t\th->max_huge_pages, buf, i);\n\t\th->max_huge_pages = i;\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/node.h>",
            "#include <linux/hugetlb_cgroup.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/io.h>",
            "#include <asm/tlb.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/page.h>",
            "#include <linux/jhash.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/string_helpers.h>",
            "#include <linux/rmap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mmdebug.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/memblock.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/compiler.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/highmem.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/mm.h>",
            "#include <linux/init.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/node.h>\n#include <linux/hugetlb_cgroup.h>\n#include <linux/hugetlb.h>\n#include <linux/io.h>\n#include <asm/tlb.h>\n#include <asm/pgtable.h>\n#include <asm/page.h>\n#include <linux/jhash.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/string_helpers.h>\n#include <linux/rmap.h>\n#include <linux/sched/signal.h>\n#include <linux/mmdebug.h>\n#include <linux/slab.h>\n#include <linux/sysfs.h>\n#include <linux/memblock.h>\n#include <linux/mutex.h>\n#include <linux/cpuset.h>\n#include <linux/compiler.h>\n#include <linux/mempolicy.h>\n#include <linux/pagemap.h>\n#include <linux/nodemask.h>\n#include <linux/mmu_notifier.h>\n#include <linux/highmem.h>\n#include <linux/sysctl.h>\n#include <linux/seq_file.h>\n#include <linux/mm.h>\n#include <linux/init.h>\n#include <linux/list.h>\n\nstatic void __init hugetlb_hstate_alloc_pages(struct hstate *h)\n{\n\tunsigned long i;\n\n\tfor (i = 0; i < h->max_huge_pages; ++i) {\n\t\tif (hstate_is_gigantic(h)) {\n\t\t\tif (!alloc_bootmem_huge_page(h))\n\t\t\t\tbreak;\n\t\t} else if (!alloc_pool_huge_page(h,\n\t\t\t\t\t &node_states[N_MEMORY]))\n\t\t\tbreak;\n\t\tcond_resched();\n\t}\n\tif (i < h->max_huge_pages) {\n\t\tchar buf[32];\n\n\t\tstring_get_size(huge_page_size(h), 1, STRING_UNITS_2, buf, 32);\n\t\tpr_warn(\"HugeTLB: allocating %lu of page size %s failed.  Only allocated %lu hugepages.\\n\",\n\t\t\th->max_huge_pages, buf, i);\n\t\th->max_huge_pages = i;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "migrate_lock_init",
          "args": [
            "zspage"
          ],
          "line": 1089
        },
        "resolved": true,
        "details": {
          "function_name": "migrate_lock_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1849-1852",
          "snippet": "static void migrate_lock_init(struct zspage *zspage)\n{\n\trwlock_init(&zspage->lock);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_lock_init(struct zspage *zspage)\n{\n\trwlock_init(&zspage->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "zspage",
            "0",
            "sizeof(struct zspage)"
          ],
          "line": 1087
        },
        "resolved": true,
        "details": {
          "function_name": "memset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "283-288",
          "snippet": "void *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_alloc_zspage",
          "args": [
            "pool",
            "gfp"
          ],
          "line": 1082
        },
        "resolved": true,
        "details": {
          "function_name": "cache_alloc_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "356-360",
          "snippet": "static struct zspage *cache_alloc_zspage(struct zs_pool *pool, gfp_t flags)\n{\n\treturn kmem_cache_alloc(pool->zspage_cachep,\n\t\t\tflags & ~(__GFP_HIGHMEM|__GFP_MOVABLE));\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *cache_alloc_zspage(struct zs_pool *pool, gfp_t flags)\n{\n\treturn kmem_cache_alloc(pool->zspage_cachep,\n\t\t\tflags & ~(__GFP_HIGHMEM|__GFP_MOVABLE));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)\n#define ZSPAGE_MAGIC\t0x58\n\nstatic struct zspage *alloc_zspage(struct zs_pool *pool,\n\t\t\t\t\tstruct size_class *class,\n\t\t\t\t\tgfp_t gfp)\n{\n\tint i;\n\tstruct page *pages[ZS_MAX_PAGES_PER_ZSPAGE];\n\tstruct zspage *zspage = cache_alloc_zspage(pool, gfp);\n\n\tif (!zspage)\n\t\treturn NULL;\n\n\tmemset(zspage, 0, sizeof(struct zspage));\n\tzspage->magic = ZSPAGE_MAGIC;\n\tmigrate_lock_init(zspage);\n\n\tfor (i = 0; i < class->pages_per_zspage; i++) {\n\t\tstruct page *page;\n\n\t\tpage = alloc_page(gfp);\n\t\tif (!page) {\n\t\t\twhile (--i >= 0) {\n\t\t\t\tdec_zone_page_state(pages[i], NR_ZSPAGES);\n\t\t\t\t__free_page(pages[i]);\n\t\t\t}\n\t\t\tcache_free_zspage(pool, zspage);\n\t\t\treturn NULL;\n\t\t}\n\n\t\tinc_zone_page_state(page, NR_ZSPAGES);\n\t\tpages[i] = page;\n\t}\n\n\tcreate_page_chain(class, zspage, pages);\n\tinit_zspage(class, zspage);\n\n\treturn zspage;\n}"
  },
  {
    "function_name": "create_page_chain",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "1040-1071",
    "snippet": "static void create_page_chain(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *pages[])\n{\n\tint i;\n\tstruct page *page;\n\tstruct page *prev_page = NULL;\n\tint nr_pages = class->pages_per_zspage;\n\n\t/*\n\t * Allocate individual pages and link them together as:\n\t * 1. all pages are linked together using page->freelist\n\t * 2. each sub-page point to zspage using page->private\n\t *\n\t * we set PG_private to identify the first page (i.e. no other sub-page\n\t * has this flag set).\n\t */\n\tfor (i = 0; i < nr_pages; i++) {\n\t\tpage = pages[i];\n\t\tset_page_private(page, (unsigned long)zspage);\n\t\tpage->freelist = NULL;\n\t\tif (i == 0) {\n\t\t\tzspage->first_page = page;\n\t\t\tSetPagePrivate(page);\n\t\t\tif (unlikely(class->objs_per_zspage == 1 &&\n\t\t\t\t\tclass->pages_per_zspage == 1))\n\t\t\t\tSetPageHugeObject(page);\n\t\t} else {\n\t\t\tprev_page->freelist = page;\n\t\t}\n\t\tprev_page = page;\n\t}\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetPageHugeObject",
          "args": [
            "page"
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "SetPageHugeObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "215-218",
          "snippet": "static void SetPageHugeObject(struct page *page)\n{\n\tSetPageOwnerPriv1(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void SetPageHugeObject(struct page *page)\n{\n\tSetPageOwnerPriv1(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "class->objs_per_zspage == 1 &&\n\t\t\t\t\tclass->pages_per_zspage == 1"
          ],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetPagePrivate",
          "args": [
            "page"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_page_private",
          "args": [
            "page",
            "(unsigned long)zspage"
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void create_page_chain(struct size_class *class, struct zspage *zspage,\n\t\t\t\tstruct page *pages[])\n{\n\tint i;\n\tstruct page *page;\n\tstruct page *prev_page = NULL;\n\tint nr_pages = class->pages_per_zspage;\n\n\t/*\n\t * Allocate individual pages and link them together as:\n\t * 1. all pages are linked together using page->freelist\n\t * 2. each sub-page point to zspage using page->private\n\t *\n\t * we set PG_private to identify the first page (i.e. no other sub-page\n\t * has this flag set).\n\t */\n\tfor (i = 0; i < nr_pages; i++) {\n\t\tpage = pages[i];\n\t\tset_page_private(page, (unsigned long)zspage);\n\t\tpage->freelist = NULL;\n\t\tif (i == 0) {\n\t\t\tzspage->first_page = page;\n\t\t\tSetPagePrivate(page);\n\t\t\tif (unlikely(class->objs_per_zspage == 1 &&\n\t\t\t\t\tclass->pages_per_zspage == 1))\n\t\t\t\tSetPageHugeObject(page);\n\t\t} else {\n\t\t\tprev_page->freelist = page;\n\t\t}\n\t\tprev_page = page;\n\t}\n}"
  },
  {
    "function_name": "init_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "996-1038",
    "snippet": "static void init_zspage(struct size_class *class, struct zspage *zspage)\n{\n\tunsigned int freeobj = 1;\n\tunsigned long off = 0;\n\tstruct page *page = get_first_page(zspage);\n\n\twhile (page) {\n\t\tstruct page *next_page;\n\t\tstruct link_free *link;\n\t\tvoid *vaddr;\n\n\t\tset_first_obj_offset(page, off);\n\n\t\tvaddr = kmap_atomic(page);\n\t\tlink = (struct link_free *)vaddr + off / sizeof(*link);\n\n\t\twhile ((off += class->size) < PAGE_SIZE) {\n\t\t\tlink->next = freeobj++ << OBJ_TAG_BITS;\n\t\t\tlink += class->size / sizeof(*link);\n\t\t}\n\n\t\t/*\n\t\t * We now come to the last (full or partial) object on this\n\t\t * page, which must point to the first object on the next\n\t\t * page (if present)\n\t\t */\n\t\tnext_page = get_next_page(page);\n\t\tif (next_page) {\n\t\t\tlink->next = freeobj++ << OBJ_TAG_BITS;\n\t\t} else {\n\t\t\t/*\n\t\t\t * Reset OBJ_TAG_BITS bit to last link to tell\n\t\t\t * whether it's allocated object or not.\n\t\t\t */\n\t\t\tlink->next = -1UL << OBJ_TAG_BITS;\n\t\t}\n\t\tkunmap_atomic(vaddr);\n\t\tpage = next_page;\n\t\toff %= PAGE_SIZE;\n\t}\n\n\tset_freeobj(zspage, 0);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define OBJ_TAG_BITS 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_freeobj",
          "args": [
            "zspage",
            "0"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "set_freeobj",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "506-509",
          "snippet": "static inline void set_freeobj(struct zspage *zspage, unsigned int obj)\n{\n\tzspage->freeobj = obj;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void set_freeobj(struct zspage *zspage, unsigned int obj)\n{\n\tzspage->freeobj = obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "vaddr"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "page"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_first_obj_offset",
          "args": [
            "page",
            "off"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "set_first_obj_offset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "496-499",
          "snippet": "static inline void set_first_obj_offset(struct page *page, int offset)\n{\n\tpage->units = offset;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void set_first_obj_offset(struct page *page, int offset)\n{\n\tpage->units = offset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_first_page",
          "args": [
            "zspage"
          ],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "483-489",
          "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_TAG_BITS 1\n\nstatic void init_zspage(struct size_class *class, struct zspage *zspage)\n{\n\tunsigned int freeobj = 1;\n\tunsigned long off = 0;\n\tstruct page *page = get_first_page(zspage);\n\n\twhile (page) {\n\t\tstruct page *next_page;\n\t\tstruct link_free *link;\n\t\tvoid *vaddr;\n\n\t\tset_first_obj_offset(page, off);\n\n\t\tvaddr = kmap_atomic(page);\n\t\tlink = (struct link_free *)vaddr + off / sizeof(*link);\n\n\t\twhile ((off += class->size) < PAGE_SIZE) {\n\t\t\tlink->next = freeobj++ << OBJ_TAG_BITS;\n\t\t\tlink += class->size / sizeof(*link);\n\t\t}\n\n\t\t/*\n\t\t * We now come to the last (full or partial) object on this\n\t\t * page, which must point to the first object on the next\n\t\t * page (if present)\n\t\t */\n\t\tnext_page = get_next_page(page);\n\t\tif (next_page) {\n\t\t\tlink->next = freeobj++ << OBJ_TAG_BITS;\n\t\t} else {\n\t\t\t/*\n\t\t\t * Reset OBJ_TAG_BITS bit to last link to tell\n\t\t\t * whether it's allocated object or not.\n\t\t\t */\n\t\t\tlink->next = -1UL << OBJ_TAG_BITS;\n\t\t}\n\t\tkunmap_atomic(vaddr);\n\t\tpage = next_page;\n\t\toff %= PAGE_SIZE;\n\t}\n\n\tset_freeobj(zspage, 0);\n}"
  },
  {
    "function_name": "free_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "980-993",
    "snippet": "static void free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(list_empty(&zspage->list));\n\n\tif (!trylock_zspage(zspage)) {\n\t\tkick_deferred_free(pool);\n\t\treturn;\n\t}\n\n\tremove_zspage(class, zspage, ZS_EMPTY);\n\t__free_zspage(pool, class, zspage);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__free_zspage",
          "args": [
            "pool",
            "class",
            "zspage"
          ],
          "line": 992
        },
        "resolved": true,
        "details": {
          "function_name": "__free_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "948-978",
          "snippet": "static void __free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tstruct page *page, *next;\n\tenum fullness_group fg;\n\tunsigned int class_idx;\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\n\tassert_spin_locked(&class->lock);\n\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(fg != ZS_EMPTY);\n\n\tnext = page = get_first_page(zspage);\n\tdo {\n\t\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\t\tnext = get_next_page(page);\n\t\treset_page(page);\n\t\tunlock_page(page);\n\t\tdec_zone_page_state(page, NR_ZSPAGES);\n\t\tput_page(page);\n\t\tpage = next;\n\t} while (page != NULL);\n\n\tcache_free_zspage(pool, zspage);\n\n\tzs_stat_dec(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\tatomic_long_sub(class->pages_per_zspage,\n\t\t\t\t\t&pool->pages_allocated);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tstruct page *page, *next;\n\tenum fullness_group fg;\n\tunsigned int class_idx;\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\n\tassert_spin_locked(&class->lock);\n\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(fg != ZS_EMPTY);\n\n\tnext = page = get_first_page(zspage);\n\tdo {\n\t\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\t\tnext = get_next_page(page);\n\t\treset_page(page);\n\t\tunlock_page(page);\n\t\tdec_zone_page_state(page, NR_ZSPAGES);\n\t\tput_page(page);\n\t\tpage = next;\n\t} while (page != NULL);\n\n\tcache_free_zspage(pool, zspage);\n\n\tzs_stat_dec(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\tatomic_long_sub(class->pages_per_zspage,\n\t\t\t\t\t&pool->pages_allocated);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_zspage",
          "args": [
            "class",
            "zspage",
            "ZS_EMPTY"
          ],
          "line": 991
        },
        "resolved": true,
        "details": {
          "function_name": "remove_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "759-768",
          "snippet": "static void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kick_deferred_free",
          "args": [
            "pool"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "kick_deferred_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2175-2178",
          "snippet": "static void kick_deferred_free(struct zs_pool *pool)\n{\n\tschedule_work(&pool->free_work);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void kick_deferred_free(struct zs_pool *pool)\n{\n\tschedule_work(&pool->free_work);\n}"
        }
      },
      {
        "call_info": {
          "callee": "trylock_zspage",
          "args": [
            "zspage"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "trylock_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "927-946",
          "snippet": "static int trylock_zspage(struct zspage *zspage)\n{\n\tstruct page *cursor, *fail;\n\n\tfor (cursor = get_first_page(zspage); cursor != NULL; cursor =\n\t\t\t\t\tget_next_page(cursor)) {\n\t\tif (!trylock_page(cursor)) {\n\t\t\tfail = cursor;\n\t\t\tgoto unlock;\n\t\t}\n\t}\n\n\treturn 1;\nunlock:\n\tfor (cursor = get_first_page(zspage); cursor != fail; cursor =\n\t\t\t\t\tget_next_page(cursor))\n\t\tunlock_page(cursor);\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int trylock_zspage(struct zspage *zspage)\n{\n\tstruct page *cursor, *fail;\n\n\tfor (cursor = get_first_page(zspage); cursor != NULL; cursor =\n\t\t\t\t\tget_next_page(cursor)) {\n\t\tif (!trylock_page(cursor)) {\n\t\t\tfail = cursor;\n\t\t\tgoto unlock;\n\t\t}\n\t}\n\n\treturn 1;\nunlock:\n\tfor (cursor = get_first_page(zspage); cursor != fail; cursor =\n\t\t\t\t\tget_next_page(cursor))\n\t\tunlock_page(cursor);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "list_empty(&zspage->list)"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&zspage->list"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "get_zspage_inuse(zspage)"
          ],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_inuse",
          "args": [
            "zspage"
          ],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "468-471",
          "snippet": "static inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(list_empty(&zspage->list));\n\n\tif (!trylock_zspage(zspage)) {\n\t\tkick_deferred_free(pool);\n\t\treturn;\n\t}\n\n\tremove_zspage(class, zspage, ZS_EMPTY);\n\t__free_zspage(pool, class, zspage);\n}"
  },
  {
    "function_name": "__free_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "948-978",
    "snippet": "static void __free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tstruct page *page, *next;\n\tenum fullness_group fg;\n\tunsigned int class_idx;\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\n\tassert_spin_locked(&class->lock);\n\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(fg != ZS_EMPTY);\n\n\tnext = page = get_first_page(zspage);\n\tdo {\n\t\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\t\tnext = get_next_page(page);\n\t\treset_page(page);\n\t\tunlock_page(page);\n\t\tdec_zone_page_state(page, NR_ZSPAGES);\n\t\tput_page(page);\n\t\tpage = next;\n\t} while (page != NULL);\n\n\tcache_free_zspage(pool, zspage);\n\n\tzs_stat_dec(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\tatomic_long_sub(class->pages_per_zspage,\n\t\t\t\t\t&pool->pages_allocated);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_long_sub",
          "args": [
            "class->pages_per_zspage",
            "&pool->pages_allocated"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zs_stat_dec",
          "args": [
            "class",
            "OBJ_ALLOCATED",
            "class->objs_per_zspage"
          ],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "555-559",
          "snippet": "static inline void zs_stat_dec(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] -= cnt;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_stat_dec(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] -= cnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_free_zspage",
          "args": [
            "pool",
            "zspage"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "cache_free_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "362-365",
          "snippet": "static void cache_free_zspage(struct zs_pool *pool, struct zspage *zspage)\n{\n\tkmem_cache_free(pool->zspage_cachep, zspage);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void cache_free_zspage(struct zs_pool *pool, struct zspage *zspage)\n{\n\tkmem_cache_free(pool->zspage_cachep, zspage);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "dec_zone_page_state",
          "args": [
            "page",
            "NR_ZSPAGES"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "dec_zone_page_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmstat.c",
          "lines": "624-631",
          "snippet": "void dec_zone_page_state(struct page *page, enum zone_stat_item item)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\t__dec_zone_page_state(page, item);\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/page_owner.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/writeback.h>",
            "#include <linux/math64.h>",
            "#include <linux/sched.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/cpu.h>",
            "#include <linux/slab.h>",
            "#include <linux/module.h>",
            "#include <linux/err.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/page_owner.h>\n#include <linux/page_ext.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/writeback.h>\n#include <linux/math64.h>\n#include <linux/sched.h>\n#include <linux/debugfs.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/vmstat.h>\n#include <linux/cpumask.h>\n#include <linux/cpu.h>\n#include <linux/slab.h>\n#include <linux/module.h>\n#include <linux/err.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n\nvoid dec_zone_page_state(struct page *page, enum zone_stat_item item)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\t__dec_zone_page_state(page, item);\n\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "page"
          ],
          "line": 967
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reset_page",
          "args": [
            "page"
          ],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "reset_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "917-925",
          "snippet": "static void reset_page(struct page *page)\n{\n\t__ClearPageMovable(page);\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_mapcount_reset(page);\n\tClearPageHugeObject(page);\n\tpage->freelist = NULL;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void reset_page(struct page *page)\n{\n\t__ClearPageMovable(page);\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_mapcount_reset(page);\n\tClearPageHugeObject(page);\n\tpage->freelist = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "page"
          ],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!PageLocked(page)",
            "page"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageLocked",
          "args": [
            "page"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_first_page",
          "args": [
            "zspage"
          ],
          "line": 962
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "483-489",
          "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "fg != ZS_EMPTY"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "get_zspage_inuse(zspage)"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_inuse",
          "args": [
            "zspage"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "468-471",
          "snippet": "static inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&class->lock"
          ],
          "line": 957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&fg"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __free_zspage(struct zs_pool *pool, struct size_class *class,\n\t\t\t\tstruct zspage *zspage)\n{\n\tstruct page *page, *next;\n\tenum fullness_group fg;\n\tunsigned int class_idx;\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\n\tassert_spin_locked(&class->lock);\n\n\tVM_BUG_ON(get_zspage_inuse(zspage));\n\tVM_BUG_ON(fg != ZS_EMPTY);\n\n\tnext = page = get_first_page(zspage);\n\tdo {\n\t\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\t\tnext = get_next_page(page);\n\t\treset_page(page);\n\t\tunlock_page(page);\n\t\tdec_zone_page_state(page, NR_ZSPAGES);\n\t\tput_page(page);\n\t\tpage = next;\n\t} while (page != NULL);\n\n\tcache_free_zspage(pool, zspage);\n\n\tzs_stat_dec(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\tatomic_long_sub(class->pages_per_zspage,\n\t\t\t\t\t&pool->pages_allocated);\n}"
  },
  {
    "function_name": "trylock_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "927-946",
    "snippet": "static int trylock_zspage(struct zspage *zspage)\n{\n\tstruct page *cursor, *fail;\n\n\tfor (cursor = get_first_page(zspage); cursor != NULL; cursor =\n\t\t\t\t\tget_next_page(cursor)) {\n\t\tif (!trylock_page(cursor)) {\n\t\t\tfail = cursor;\n\t\t\tgoto unlock;\n\t\t}\n\t}\n\n\treturn 1;\nunlock:\n\tfor (cursor = get_first_page(zspage); cursor != fail; cursor =\n\t\t\t\t\tget_next_page(cursor))\n\t\tunlock_page(cursor);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlock_page",
          "args": [
            "cursor"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "unlock_page_memcg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memcontrol.c",
          "lines": "1916-1919",
          "snippet": "void unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}",
          "includes": [
            "#include <trace/events/vmscan.h>",
            "#include <linux/uaccess.h>",
            "#include \"slab.h\"",
            "#include <net/ip.h>",
            "#include <net/sock.h>",
            "#include \"internal.h\"",
            "#include <linux/tracehook.h>",
            "#include <linux/file.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/swap_cgroup.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/vmpressure.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/fs.h>",
            "#include <linux/sort.h>",
            "#include <linux/poll.h>",
            "#include <linux/eventfd.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/slab.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/limits.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/bit_spinlock.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/smp.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/page_counter.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/vmscan.h>\n#include <linux/uaccess.h>\n#include \"slab.h\"\n#include <net/ip.h>\n#include <net/sock.h>\n#include \"internal.h\"\n#include <linux/tracehook.h>\n#include <linux/file.h>\n#include <linux/lockdep.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/swap_cgroup.h>\n#include <linux/mm_inline.h>\n#include <linux/vmpressure.h>\n#include <linux/seq_file.h>\n#include <linux/fs.h>\n#include <linux/sort.h>\n#include <linux/poll.h>\n#include <linux/eventfd.h>\n#include <linux/spinlock.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/slab.h>\n#include <linux/rbtree.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/limits.h>\n#include <linux/rcupdate.h>\n#include <linux/bit_spinlock.h>\n#include <linux/backing-dev.h>\n#include <linux/page-flags.h>\n#include <linux/smp.h>\n#include <linux/pagemap.h>\n#include <linux/hugetlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/cgroup.h>\n#include <linux/memcontrol.h>\n#include <linux/page_counter.h>\n\nstatic __always_inline struct;\n\nvoid unlock_page_memcg(struct page *page)\n{\n\t__unlock_page_memcg(page->mem_cgroup);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_next_page",
          "args": [
            "cursor"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "get_next_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "845-851",
          "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_first_page",
          "args": [
            "zspage"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "get_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "483-489",
          "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trylock_page",
          "args": [
            "cursor"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int trylock_zspage(struct zspage *zspage)\n{\n\tstruct page *cursor, *fail;\n\n\tfor (cursor = get_first_page(zspage); cursor != NULL; cursor =\n\t\t\t\t\tget_next_page(cursor)) {\n\t\tif (!trylock_page(cursor)) {\n\t\t\tfail = cursor;\n\t\t\tgoto unlock;\n\t\t}\n\t}\n\n\treturn 1;\nunlock:\n\tfor (cursor = get_first_page(zspage); cursor != fail; cursor =\n\t\t\t\t\tget_next_page(cursor))\n\t\tunlock_page(cursor);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "reset_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "917-925",
    "snippet": "static void reset_page(struct page *page)\n{\n\t__ClearPageMovable(page);\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_mapcount_reset(page);\n\tClearPageHugeObject(page);\n\tpage->freelist = NULL;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ClearPageHugeObject",
          "args": [
            "page"
          ],
          "line": 923
        },
        "resolved": true,
        "details": {
          "function_name": "ClearPageHugeObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "220-223",
          "snippet": "static void ClearPageHugeObject(struct page *page)\n{\n\tClearPageOwnerPriv1(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void ClearPageHugeObject(struct page *page)\n{\n\tClearPageOwnerPriv1(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_mapcount_reset",
          "args": [
            "page"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_page_private",
          "args": [
            "page",
            "0"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ClearPagePrivate",
          "args": [
            "page"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__ClearPageMovable",
          "args": [
            "page"
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "__ClearPageMovable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/compaction.c",
          "lines": "120-131",
          "snippet": "void __ClearPageMovable(struct page *page)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\t/*\n\t * Clear registered address_space val with keeping PAGE_MAPPING_MOVABLE\n\t * flag so that VM can catch up released page by driver after isolation.\n\t * With it, VM migration doesn't try to put it back.\n\t */\n\tpage->mapping = (void *)((unsigned long)page->mapping &\n\t\t\t\tPAGE_MAPPING_MOVABLE);\n}",
          "includes": [
            "#include <trace/events/compaction.h>",
            "#include \"internal.h\"",
            "#include <linux/psi.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kasan.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/compaction.h>",
            "#include <linux/migrate.h>",
            "#include <linux/swap.h>",
            "#include <linux/cpu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/compaction.h>\n#include \"internal.h\"\n#include <linux/psi.h>\n#include <linux/page_owner.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/kasan.h>\n#include <linux/page-isolation.h>\n#include <linux/sysfs.h>\n#include <linux/sysctl.h>\n#include <linux/backing-dev.h>\n#include <linux/sched/signal.h>\n#include <linux/mm_inline.h>\n#include <linux/compaction.h>\n#include <linux/migrate.h>\n#include <linux/swap.h>\n#include <linux/cpu.h>\n\nvoid __ClearPageMovable(struct page *page)\n{\n\tVM_BUG_ON_PAGE(!PageLocked(page), page);\n\tVM_BUG_ON_PAGE(!PageMovable(page), page);\n\t/*\n\t * Clear registered address_space val with keeping PAGE_MAPPING_MOVABLE\n\t * flag so that VM can catch up released page by driver after isolation.\n\t * With it, VM migration doesn't try to put it back.\n\t */\n\tpage->mapping = (void *)((unsigned long)page->mapping &\n\t\t\t\tPAGE_MAPPING_MOVABLE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void reset_page(struct page *page)\n{\n\t__ClearPageMovable(page);\n\tClearPagePrivate(page);\n\tset_page_private(page, 0);\n\tpage_mapcount_reset(page);\n\tClearPageHugeObject(page);\n\tpage->freelist = NULL;\n}"
  },
  {
    "function_name": "unpin_tag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "912-915",
    "snippet": "static void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define HANDLE_PIN_BIT\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bit_spin_unlock",
          "args": [
            "HANDLE_PIN_BIT",
            "(unsigned long *)handle"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic void unpin_tag(unsigned long handle)\n{\n\tbit_spin_unlock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
  },
  {
    "function_name": "pin_tag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "907-910",
    "snippet": "static void pin_tag(unsigned long handle)\n{\n\tbit_spin_lock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define HANDLE_PIN_BIT\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bit_spin_lock",
          "args": [
            "HANDLE_PIN_BIT",
            "(unsigned long *)handle"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic void pin_tag(unsigned long handle)\n{\n\tbit_spin_lock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
  },
  {
    "function_name": "trypin_tag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "902-905",
    "snippet": "static inline int trypin_tag(unsigned long handle)\n{\n\treturn bit_spin_trylock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define HANDLE_PIN_BIT\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bit_spin_trylock",
          "args": [
            "HANDLE_PIN_BIT",
            "(unsigned long *)handle"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic inline int trypin_tag(unsigned long handle)\n{\n\treturn bit_spin_trylock(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
  },
  {
    "function_name": "testpin_tag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "897-900",
    "snippet": "static inline int testpin_tag(unsigned long handle)\n{\n\treturn bit_spin_is_locked(HANDLE_PIN_BIT, (unsigned long *)handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define HANDLE_PIN_BIT\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bit_spin_is_locked",
          "args": [
            "HANDLE_PIN_BIT",
            "(unsigned long *)handle"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define HANDLE_PIN_BIT\t0\n\nstatic inline int testpin_tag(unsigned long handle)\n{\n\treturn bit_spin_is_locked(HANDLE_PIN_BIT, (unsigned long *)handle);\n}"
  },
  {
    "function_name": "obj_to_head",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "888-895",
    "snippet": "static unsigned long obj_to_head(struct page *page, void *obj)\n{\n\tif (unlikely(PageHugeObject(page))) {\n\t\tVM_BUG_ON_PAGE(!is_first_page(page), page);\n\t\treturn page->index;\n\t} else\n\t\treturn *(unsigned long *)obj;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!is_first_page(page)",
            "page"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_first_page",
          "args": [
            "page"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "is_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "462-465",
          "snippet": "static __maybe_unused int is_first_page(struct page *page)\n{\n\treturn PagePrivate(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic __maybe_unused int is_first_page(struct page *page)\n{\n\treturn PagePrivate(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "PageHugeObject(page)"
          ],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHugeObject",
          "args": [
            "page"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "PageHugeObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "225-228",
          "snippet": "static int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long obj_to_head(struct page *page, void *obj)\n{\n\tif (unlikely(PageHugeObject(page))) {\n\t\tVM_BUG_ON_PAGE(!is_first_page(page), page);\n\t\treturn page->index;\n\t} else\n\t\treturn *(unsigned long *)obj;\n}"
  },
  {
    "function_name": "handle_to_obj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "883-886",
    "snippet": "static unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long handle_to_obj(unsigned long handle)\n{\n\treturn *(unsigned long *)handle;\n}"
  },
  {
    "function_name": "location_to_obj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "872-881",
    "snippet": "static unsigned long location_to_obj(struct page *page, unsigned int obj_idx)\n{\n\tunsigned long obj;\n\n\tobj = page_to_pfn(page) << OBJ_INDEX_BITS;\n\tobj |= obj_idx & OBJ_INDEX_MASK;\n\tobj <<= OBJ_TAG_BITS;\n\n\treturn obj;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
      "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
      "#define OBJ_TAG_BITS 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "page_to_pfn",
          "args": [
            "page"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic unsigned long location_to_obj(struct page *page, unsigned int obj_idx)\n{\n\tunsigned long obj;\n\n\tobj = page_to_pfn(page) << OBJ_INDEX_BITS;\n\tobj |= obj_idx & OBJ_INDEX_MASK;\n\tobj <<= OBJ_TAG_BITS;\n\n\treturn obj;\n}"
  },
  {
    "function_name": "obj_to_location",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "859-865",
    "snippet": "static void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)",
      "#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)",
      "#define OBJ_TAG_BITS 1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pfn_to_page",
          "args": [
            "obj >> OBJ_INDEX_BITS"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define OBJ_INDEX_MASK\t((_AC(1, UL) << OBJ_INDEX_BITS) - 1)\n#define OBJ_INDEX_BITS\t(BITS_PER_LONG - _PFN_BITS - OBJ_TAG_BITS)\n#define OBJ_TAG_BITS 1\n\nstatic void obj_to_location(unsigned long obj, struct page **page,\n\t\t\t\tunsigned int *obj_idx)\n{\n\tobj >>= OBJ_TAG_BITS;\n\t*page = pfn_to_page(obj >> OBJ_INDEX_BITS);\n\t*obj_idx = (obj & OBJ_INDEX_MASK);\n}"
  },
  {
    "function_name": "get_next_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "845-851",
    "snippet": "static struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "PageHugeObject(page)"
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHugeObject",
          "args": [
            "page"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "PageHugeObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "225-228",
          "snippet": "static int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct page *get_next_page(struct page *page)\n{\n\tif (unlikely(PageHugeObject(page)))\n\t\treturn NULL;\n\n\treturn page->freelist;\n}"
  },
  {
    "function_name": "get_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "837-843",
    "snippet": "static struct zspage *get_zspage(struct page *page)\n{\n\tstruct zspage *zspage = (struct zspage *)page->private;\n\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\treturn zspage;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZSPAGE_MAGIC\t0x58"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "zspage->magic != ZSPAGE_MAGIC"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic struct zspage *get_zspage(struct page *page)\n{\n\tstruct zspage *zspage = (struct zspage *)page->private;\n\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\treturn zspage;\n}"
  },
  {
    "function_name": "get_pages_per_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "814-835",
    "snippet": "static int get_pages_per_zspage(int class_size)\n{\n\tint i, max_usedpc = 0;\n\t/* zspage order which gives maximum used size per KB */\n\tint max_usedpc_order = 1;\n\n\tfor (i = 1; i <= ZS_MAX_PAGES_PER_ZSPAGE; i++) {\n\t\tint zspage_size;\n\t\tint waste, usedpc;\n\n\t\tzspage_size = i * PAGE_SIZE;\n\t\twaste = zspage_size % class_size;\n\t\tusedpc = (zspage_size - waste) * 100 / zspage_size;\n\n\t\tif (usedpc > max_usedpc) {\n\t\t\tmax_usedpc = usedpc;\n\t\t\tmax_usedpc_order = i;\n\t\t}\n\t}\n\n\treturn max_usedpc_order;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)"
    ],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_PAGES_PER_ZSPAGE (_AC(1, UL) << ZS_MAX_ZSPAGE_ORDER)\n\nstatic int get_pages_per_zspage(int class_size)\n{\n\tint i, max_usedpc = 0;\n\t/* zspage order which gives maximum used size per KB */\n\tint max_usedpc_order = 1;\n\n\tfor (i = 1; i <= ZS_MAX_PAGES_PER_ZSPAGE; i++) {\n\t\tint zspage_size;\n\t\tint waste, usedpc;\n\n\t\tzspage_size = i * PAGE_SIZE;\n\t\twaste = zspage_size % class_size;\n\t\tusedpc = (zspage_size - waste) * 100 / zspage_size;\n\n\t\tif (usedpc > max_usedpc) {\n\t\t\tmax_usedpc = usedpc;\n\t\t\tmax_usedpc_order = i;\n\t\t}\n\t}\n\n\treturn max_usedpc_order;\n}"
  },
  {
    "function_name": "fix_fullness_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "779-799",
    "snippet": "static enum fullness_group fix_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint class_idx;\n\tenum fullness_group currfg, newfg;\n\n\tget_zspage_mapping(zspage, &class_idx, &currfg);\n\tnewfg = get_fullness_group(class, zspage);\n\tif (newfg == currfg)\n\t\tgoto out;\n\n\tif (!is_zspage_isolated(zspage)) {\n\t\tremove_zspage(class, zspage, currfg);\n\t\tinsert_zspage(class, zspage, newfg);\n\t}\n\n\tset_zspage_mapping(zspage, class_idx, newfg);\n\nout:\n\treturn newfg;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_zspage_mapping",
          "args": [
            "zspage",
            "class_idx",
            "newfg"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "set_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "521-527",
          "snippet": "static void set_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int class_idx,\n\t\t\t\tenum fullness_group fullness)\n{\n\tzspage->class = class_idx;\n\tzspage->fullness = fullness;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void set_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int class_idx,\n\t\t\t\tenum fullness_group fullness)\n{\n\tzspage->class = class_idx;\n\tzspage->fullness = fullness;\n}"
        }
      },
      {
        "call_info": {
          "callee": "insert_zspage",
          "args": [
            "class",
            "zspage",
            "newfg"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "insert_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "733-753",
          "snippet": "static void insert_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tstruct zspage *head;\n\n\tzs_stat_inc(class, fullness, 1);\n\thead = list_first_entry_or_null(&class->fullness_list[fullness],\n\t\t\t\t\tstruct zspage, list);\n\t/*\n\t * We want to see more ZS_FULL pages and less almost empty/full.\n\t * Put pages with higher ->inuse first.\n\t */\n\tif (head) {\n\t\tif (get_zspage_inuse(zspage) < get_zspage_inuse(head)) {\n\t\t\tlist_add(&zspage->list, &head->list);\n\t\t\treturn;\n\t\t}\n\t}\n\tlist_add(&zspage->list, &class->fullness_list[fullness]);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void insert_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tstruct zspage *head;\n\n\tzs_stat_inc(class, fullness, 1);\n\thead = list_first_entry_or_null(&class->fullness_list[fullness],\n\t\t\t\t\tstruct zspage, list);\n\t/*\n\t * We want to see more ZS_FULL pages and less almost empty/full.\n\t * Put pages with higher ->inuse first.\n\t */\n\tif (head) {\n\t\tif (get_zspage_inuse(zspage) < get_zspage_inuse(head)) {\n\t\t\tlist_add(&zspage->list, &head->list);\n\t\t\treturn;\n\t\t}\n\t}\n\tlist_add(&zspage->list, &class->fullness_list[fullness]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "remove_zspage",
          "args": [
            "class",
            "zspage",
            "currfg"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "remove_zspage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "759-768",
          "snippet": "static void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "is_zspage_isolated",
          "args": [
            "zspage"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "is_zspage_isolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "457-460",
          "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_fullness_group",
          "args": [
            "class",
            "zspage"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "get_fullness_group",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "706-725",
          "snippet": "static enum fullness_group get_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint inuse, objs_per_zspage;\n\tenum fullness_group fg;\n\n\tinuse = get_zspage_inuse(zspage);\n\tobjs_per_zspage = class->objs_per_zspage;\n\n\tif (inuse == 0)\n\t\tfg = ZS_EMPTY;\n\telse if (inuse == objs_per_zspage)\n\t\tfg = ZS_FULL;\n\telse if (inuse <= 3 * objs_per_zspage / fullness_threshold_frac)\n\t\tfg = ZS_ALMOST_EMPTY;\n\telse\n\t\tfg = ZS_ALMOST_FULL;\n\n\treturn fg;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const int fullness_threshold_frac = 4;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const int fullness_threshold_frac = 4;\n\nstatic enum fullness_group get_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint inuse, objs_per_zspage;\n\tenum fullness_group fg;\n\n\tinuse = get_zspage_inuse(zspage);\n\tobjs_per_zspage = class->objs_per_zspage;\n\n\tif (inuse == 0)\n\t\tfg = ZS_EMPTY;\n\telse if (inuse == objs_per_zspage)\n\t\tfg = ZS_FULL;\n\telse if (inuse <= 3 * objs_per_zspage / fullness_threshold_frac)\n\t\tfg = ZS_ALMOST_EMPTY;\n\telse\n\t\tfg = ZS_ALMOST_FULL;\n\n\treturn fg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_zspage_mapping",
          "args": [
            "zspage",
            "&class_idx",
            "&currfg"
          ],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_mapping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "511-519",
          "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSPAGE_MAGIC\t0x58"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic enum fullness_group fix_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint class_idx;\n\tenum fullness_group currfg, newfg;\n\n\tget_zspage_mapping(zspage, &class_idx, &currfg);\n\tnewfg = get_fullness_group(class, zspage);\n\tif (newfg == currfg)\n\t\tgoto out;\n\n\tif (!is_zspage_isolated(zspage)) {\n\t\tremove_zspage(class, zspage, currfg);\n\t\tinsert_zspage(class, zspage, newfg);\n\t}\n\n\tset_zspage_mapping(zspage, class_idx, newfg);\n\nout:\n\treturn newfg;\n}"
  },
  {
    "function_name": "remove_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "759-768",
    "snippet": "static void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_stat_dec",
          "args": [
            "class",
            "fullness",
            "1"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_dec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "555-559",
          "snippet": "static inline void zs_stat_dec(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] -= cnt;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_stat_dec(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] -= cnt;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_init",
          "args": [
            "&zspage->list"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "is_zspage_isolated(zspage)"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_zspage_isolated",
          "args": [
            "zspage"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "is_zspage_isolated",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "457-460",
          "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "list_empty(&class->fullness_list[fullness])"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&class->fullness_list[fullness]"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void remove_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tVM_BUG_ON(list_empty(&class->fullness_list[fullness]));\n\tVM_BUG_ON(is_zspage_isolated(zspage));\n\n\tlist_del_init(&zspage->list);\n\tzs_stat_dec(class, fullness, 1);\n}"
  },
  {
    "function_name": "insert_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "733-753",
    "snippet": "static void insert_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tstruct zspage *head;\n\n\tzs_stat_inc(class, fullness, 1);\n\thead = list_first_entry_or_null(&class->fullness_list[fullness],\n\t\t\t\t\tstruct zspage, list);\n\t/*\n\t * We want to see more ZS_FULL pages and less almost empty/full.\n\t * Put pages with higher ->inuse first.\n\t */\n\tif (head) {\n\t\tif (get_zspage_inuse(zspage) < get_zspage_inuse(head)) {\n\t\t\tlist_add(&zspage->list, &head->list);\n\t\t\treturn;\n\t\t}\n\t}\n\tlist_add(&zspage->list, &class->fullness_list[fullness]);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&zspage->list",
            "&class->fullness_list[fullness]"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&zspage->list",
            "&head->list"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_zspage_inuse",
          "args": [
            "head"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "468-471",
          "snippet": "static inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_first_entry_or_null",
          "args": [
            "&class->fullness_list[fullness]",
            "structzspage",
            "list"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zs_stat_inc",
          "args": [
            "class",
            "fullness",
            "1"
          ],
          "line": 739
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_inc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "548-552",
          "snippet": "static inline void zs_stat_inc(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] += cnt;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_stat_inc(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] += cnt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void insert_zspage(struct size_class *class,\n\t\t\t\tstruct zspage *zspage,\n\t\t\t\tenum fullness_group fullness)\n{\n\tstruct zspage *head;\n\n\tzs_stat_inc(class, fullness, 1);\n\thead = list_first_entry_or_null(&class->fullness_list[fullness],\n\t\t\t\t\tstruct zspage, list);\n\t/*\n\t * We want to see more ZS_FULL pages and less almost empty/full.\n\t * Put pages with higher ->inuse first.\n\t */\n\tif (head) {\n\t\tif (get_zspage_inuse(zspage) < get_zspage_inuse(head)) {\n\t\t\tlist_add(&zspage->list, &head->list);\n\t\t\treturn;\n\t\t}\n\t}\n\tlist_add(&zspage->list, &class->fullness_list[fullness]);\n}"
  },
  {
    "function_name": "get_fullness_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "706-725",
    "snippet": "static enum fullness_group get_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint inuse, objs_per_zspage;\n\tenum fullness_group fg;\n\n\tinuse = get_zspage_inuse(zspage);\n\tobjs_per_zspage = class->objs_per_zspage;\n\n\tif (inuse == 0)\n\t\tfg = ZS_EMPTY;\n\telse if (inuse == objs_per_zspage)\n\t\tfg = ZS_FULL;\n\telse if (inuse <= 3 * objs_per_zspage / fullness_threshold_frac)\n\t\tfg = ZS_ALMOST_EMPTY;\n\telse\n\t\tfg = ZS_ALMOST_FULL;\n\n\treturn fg;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const int fullness_threshold_frac = 4;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_zspage_inuse",
          "args": [
            "zspage"
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "get_zspage_inuse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "468-471",
          "snippet": "static inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic const int fullness_threshold_frac = 4;\n\nstatic enum fullness_group get_fullness_group(struct size_class *class,\n\t\t\t\t\t\tstruct zspage *zspage)\n{\n\tint inuse, objs_per_zspage;\n\tenum fullness_group fg;\n\n\tinuse = get_zspage_inuse(zspage);\n\tobjs_per_zspage = class->objs_per_zspage;\n\n\tif (inuse == 0)\n\t\tfg = ZS_EMPTY;\n\telse if (inuse == objs_per_zspage)\n\t\tfg = ZS_FULL;\n\telse if (inuse <= 3 * objs_per_zspage / fullness_threshold_frac)\n\t\tfg = ZS_ALMOST_EMPTY;\n\telse\n\t\tfg = ZS_ALMOST_FULL;\n\n\treturn fg;\n}"
  },
  {
    "function_name": "zs_pool_stat_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "693-695",
    "snippet": "static inline void zs_pool_stat_destroy(struct zs_pool *pool)\n{\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_pool_stat_destroy(struct zs_pool *pool)\n{\n}"
  },
  {
    "function_name": "zs_pool_stat_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "689-691",
    "snippet": "static inline void zs_pool_stat_create(struct zs_pool *pool, const char *name)\n{\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_pool_stat_create(struct zs_pool *pool, const char *name)\n{\n}"
  },
  {
    "function_name": "zs_stat_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "685-687",
    "snippet": "static void __exit zs_stat_exit(void)\n{\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __exit zs_stat_exit(void)\n{\n}"
  },
  {
    "function_name": "zs_stat_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "681-683",
    "snippet": "static void __init zs_stat_init(void)\n{\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __init zs_stat_init(void)\n{\n}"
  },
  {
    "function_name": "zs_pool_stat_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "675-678",
    "snippet": "static void zs_pool_stat_destroy(struct zs_pool *pool)\n{\n\tdebugfs_remove_recursive(pool->stat_dentry);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove_recursive",
          "args": [
            "pool->stat_dentry"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_pool_stat_destroy(struct zs_pool *pool)\n{\n\tdebugfs_remove_recursive(pool->stat_dentry);\n}"
  },
  {
    "function_name": "zs_pool_stat_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "648-673",
    "snippet": "static void zs_pool_stat_create(struct zs_pool *pool, const char *name)\n{\n\tstruct dentry *entry;\n\n\tif (!zs_stat_root) {\n\t\tpr_warn(\"no root stat dir, not creating <%s> stat dir\\n\", name);\n\t\treturn;\n\t}\n\n\tentry = debugfs_create_dir(name, zs_stat_root);\n\tif (!entry) {\n\t\tpr_warn(\"debugfs dir <%s> creation failed\\n\", name);\n\t\treturn;\n\t}\n\tpool->stat_dentry = entry;\n\n\tentry = debugfs_create_file(\"classes\", S_IFREG | 0444,\n\t\t\t\t    pool->stat_dentry, pool,\n\t\t\t\t    &zs_stats_size_fops);\n\tif (!entry) {\n\t\tpr_warn(\"%s: debugfs file entry <%s> creation failed\\n\",\n\t\t\t\tname, \"classes\");\n\t\tdebugfs_remove_recursive(pool->stat_dentry);\n\t\tpool->stat_dentry = NULL;\n\t}\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove_recursive",
          "args": [
            "pool->stat_dentry"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"%s: debugfs file entry <%s> creation failed\\n\"",
            "name",
            "\"classes\""
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"classes\"",
            "S_IFREG | 0444",
            "pool->stat_dentry",
            "pool",
            "&zs_stats_size_fops"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"debugfs dir <%s> creation failed\\n\"",
            "name"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "name",
            "zs_stat_root"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"no root stat dir, not creating <%s> stat dir\\n\"",
            "name"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_pool_stat_create(struct zs_pool *pool, const char *name)\n{\n\tstruct dentry *entry;\n\n\tif (!zs_stat_root) {\n\t\tpr_warn(\"no root stat dir, not creating <%s> stat dir\\n\", name);\n\t\treturn;\n\t}\n\n\tentry = debugfs_create_dir(name, zs_stat_root);\n\tif (!entry) {\n\t\tpr_warn(\"debugfs dir <%s> creation failed\\n\", name);\n\t\treturn;\n\t}\n\tpool->stat_dentry = entry;\n\n\tentry = debugfs_create_file(\"classes\", S_IFREG | 0444,\n\t\t\t\t    pool->stat_dentry, pool,\n\t\t\t\t    &zs_stats_size_fops);\n\tif (!entry) {\n\t\tpr_warn(\"%s: debugfs file entry <%s> creation failed\\n\",\n\t\t\t\tname, \"classes\");\n\t\tdebugfs_remove_recursive(pool->stat_dentry);\n\t\tpool->stat_dentry = NULL;\n\t}\n}"
  },
  {
    "function_name": "zs_stats_size_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "589-645",
    "snippet": "static int zs_stats_size_show(struct seq_file *s, void *v)\n{\n\tint i;\n\tstruct zs_pool *pool = s->private;\n\tstruct size_class *class;\n\tint objs_per_zspage;\n\tunsigned long class_almost_full, class_almost_empty;\n\tunsigned long obj_allocated, obj_used, pages_used, freeable;\n\tunsigned long total_class_almost_full = 0, total_class_almost_empty = 0;\n\tunsigned long total_objs = 0, total_used_objs = 0, total_pages = 0;\n\tunsigned long total_freeable = 0;\n\n\tseq_printf(s, \" %5s %5s %11s %12s %13s %10s %10s %16s %8s\\n\",\n\t\t\t\"class\", \"size\", \"almost_full\", \"almost_empty\",\n\t\t\t\"obj_allocated\", \"obj_used\", \"pages_used\",\n\t\t\t\"pages_per_zspage\", \"freeable\");\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tclass = pool->size_class[i];\n\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tspin_lock(&class->lock);\n\t\tclass_almost_full = zs_stat_get(class, CLASS_ALMOST_FULL);\n\t\tclass_almost_empty = zs_stat_get(class, CLASS_ALMOST_EMPTY);\n\t\tobj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\t\tobj_used = zs_stat_get(class, OBJ_USED);\n\t\tfreeable = zs_can_compact(class);\n\t\tspin_unlock(&class->lock);\n\n\t\tobjs_per_zspage = class->objs_per_zspage;\n\t\tpages_used = obj_allocated / objs_per_zspage *\n\t\t\t\tclass->pages_per_zspage;\n\n\t\tseq_printf(s, \" %5u %5u %11lu %12lu %13lu\"\n\t\t\t\t\" %10lu %10lu %16d %8lu\\n\",\n\t\t\ti, class->size, class_almost_full, class_almost_empty,\n\t\t\tobj_allocated, obj_used, pages_used,\n\t\t\tclass->pages_per_zspage, freeable);\n\n\t\ttotal_class_almost_full += class_almost_full;\n\t\ttotal_class_almost_empty += class_almost_empty;\n\t\ttotal_objs += obj_allocated;\n\t\ttotal_used_objs += obj_used;\n\t\ttotal_pages += pages_used;\n\t\ttotal_freeable += freeable;\n\t}\n\n\tseq_puts(s, \"\\n\");\n\tseq_printf(s, \" %5s %5s %11lu %12lu %13lu %10lu %10lu %16s %8lu\\n\",\n\t\t\t\"Total\", \"\", total_class_almost_full,\n\t\t\ttotal_class_almost_empty, total_objs,\n\t\t\ttotal_used_objs, total_pages, \"\", total_freeable);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\" %5s %5s %11lu %12lu %13lu %10lu %10lu %16s %8lu\\n\"",
            "\"Total\"",
            "\"\"",
            "total_class_almost_full",
            "total_class_almost_empty",
            "total_objs",
            "total_used_objs",
            "total_pages",
            "\"\"",
            "total_freeable"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "s",
            "\"\\n\""
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\" %5u %5u %11lu %12lu %13lu\"\n\t\t\t\t\" %10lu %10lu %16d %8lu\\n\"",
            "i",
            "class->size",
            "class_almost_full",
            "class_almost_empty",
            "obj_allocated",
            "obj_used",
            "pages_used",
            "class->pages_per_zspage",
            "freeable"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&class->lock"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zs_can_compact",
          "args": [
            "class"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "zs_can_compact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2202-2215",
          "snippet": "static unsigned long zs_can_compact(struct size_class *class)\n{\n\tunsigned long obj_wasted;\n\tunsigned long obj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\tunsigned long obj_used = zs_stat_get(class, OBJ_USED);\n\n\tif (obj_allocated <= obj_used)\n\t\treturn 0;\n\n\tobj_wasted = obj_allocated - obj_used;\n\tobj_wasted /= class->objs_per_zspage;\n\n\treturn obj_wasted * class->pages_per_zspage;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long zs_can_compact(struct size_class *class)\n{\n\tunsigned long obj_wasted;\n\tunsigned long obj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\tunsigned long obj_used = zs_stat_get(class, OBJ_USED);\n\n\tif (obj_allocated <= obj_used)\n\t\treturn 0;\n\n\tobj_wasted = obj_allocated - obj_used;\n\tobj_wasted /= class->objs_per_zspage;\n\n\treturn obj_wasted * class->pages_per_zspage;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zs_stat_get",
          "args": [
            "class",
            "OBJ_USED"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "zs_stat_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "562-566",
          "snippet": "static inline unsigned long zs_stat_get(struct size_class *class,\n\t\t\t\tint type)\n{\n\treturn class->stats.objs[type];\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline unsigned long zs_stat_get(struct size_class *class,\n\t\t\t\tint type)\n{\n\treturn class->stats.objs[type];\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&class->lock"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "s",
            "\" %5s %5s %11s %12s %13s %10s %10s %16s %8s\\n\"",
            "\"class\"",
            "\"size\"",
            "\"almost_full\"",
            "\"almost_empty\"",
            "\"obj_allocated\"",
            "\"obj_used\"",
            "\"pages_used\"",
            "\"pages_per_zspage\"",
            "\"freeable\""
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n\nstatic int zs_stats_size_show(struct seq_file *s, void *v)\n{\n\tint i;\n\tstruct zs_pool *pool = s->private;\n\tstruct size_class *class;\n\tint objs_per_zspage;\n\tunsigned long class_almost_full, class_almost_empty;\n\tunsigned long obj_allocated, obj_used, pages_used, freeable;\n\tunsigned long total_class_almost_full = 0, total_class_almost_empty = 0;\n\tunsigned long total_objs = 0, total_used_objs = 0, total_pages = 0;\n\tunsigned long total_freeable = 0;\n\n\tseq_printf(s, \" %5s %5s %11s %12s %13s %10s %10s %16s %8s\\n\",\n\t\t\t\"class\", \"size\", \"almost_full\", \"almost_empty\",\n\t\t\t\"obj_allocated\", \"obj_used\", \"pages_used\",\n\t\t\t\"pages_per_zspage\", \"freeable\");\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tclass = pool->size_class[i];\n\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tspin_lock(&class->lock);\n\t\tclass_almost_full = zs_stat_get(class, CLASS_ALMOST_FULL);\n\t\tclass_almost_empty = zs_stat_get(class, CLASS_ALMOST_EMPTY);\n\t\tobj_allocated = zs_stat_get(class, OBJ_ALLOCATED);\n\t\tobj_used = zs_stat_get(class, OBJ_USED);\n\t\tfreeable = zs_can_compact(class);\n\t\tspin_unlock(&class->lock);\n\n\t\tobjs_per_zspage = class->objs_per_zspage;\n\t\tpages_used = obj_allocated / objs_per_zspage *\n\t\t\t\tclass->pages_per_zspage;\n\n\t\tseq_printf(s, \" %5u %5u %11lu %12lu %13lu\"\n\t\t\t\t\" %10lu %10lu %16d %8lu\\n\",\n\t\t\ti, class->size, class_almost_full, class_almost_empty,\n\t\t\tobj_allocated, obj_used, pages_used,\n\t\t\tclass->pages_per_zspage, freeable);\n\n\t\ttotal_class_almost_full += class_almost_full;\n\t\ttotal_class_almost_empty += class_almost_empty;\n\t\ttotal_objs += obj_allocated;\n\t\ttotal_used_objs += obj_used;\n\t\ttotal_pages += pages_used;\n\t\ttotal_freeable += freeable;\n\t}\n\n\tseq_puts(s, \"\\n\");\n\tseq_printf(s, \" %5s %5s %11lu %12lu %13lu %10lu %10lu %16s %8lu\\n\",\n\t\t\t\"Total\", \"\", total_class_almost_full,\n\t\t\ttotal_class_almost_empty, total_objs,\n\t\t\ttotal_used_objs, total_pages, \"\", total_freeable);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "zs_stat_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "582-585",
    "snippet": "static void __exit zs_stat_exit(void)\n{\n\tdebugfs_remove_recursive(zs_stat_root);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove_recursive",
          "args": [
            "zs_stat_root"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __exit zs_stat_exit(void)\n{\n\tdebugfs_remove_recursive(zs_stat_root);\n}"
  },
  {
    "function_name": "zs_stat_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "570-580",
    "snippet": "static void __init zs_stat_init(void)\n{\n\tif (!debugfs_initialized()) {\n\t\tpr_warn(\"debugfs not available, stat dir not created\\n\");\n\t\treturn;\n\t}\n\n\tzs_stat_root = debugfs_create_dir(\"zsmalloc\", NULL);\n\tif (!zs_stat_root)\n\t\tpr_warn(\"debugfs 'zsmalloc' stat dir creation failed\\n\");\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"debugfs 'zsmalloc' stat dir creation failed\\n\""
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"zsmalloc\"",
            "NULL"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"debugfs not available, stat dir not created\\n\""
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_initialized",
          "args": [],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void __init zs_stat_init(void)\n{\n\tif (!debugfs_initialized()) {\n\t\tpr_warn(\"debugfs not available, stat dir not created\\n\");\n\t\treturn;\n\t}\n\n\tzs_stat_root = debugfs_create_dir(\"zsmalloc\", NULL);\n\tif (!zs_stat_root)\n\t\tpr_warn(\"debugfs 'zsmalloc' stat dir creation failed\\n\");\n}"
  },
  {
    "function_name": "zs_stat_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "562-566",
    "snippet": "static inline unsigned long zs_stat_get(struct size_class *class,\n\t\t\t\tint type)\n{\n\treturn class->stats.objs[type];\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline unsigned long zs_stat_get(struct size_class *class,\n\t\t\t\tint type)\n{\n\treturn class->stats.objs[type];\n}"
  },
  {
    "function_name": "zs_stat_dec",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "555-559",
    "snippet": "static inline void zs_stat_dec(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] -= cnt;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_stat_dec(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] -= cnt;\n}"
  },
  {
    "function_name": "zs_stat_inc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "548-552",
    "snippet": "static inline void zs_stat_inc(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] += cnt;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void zs_stat_inc(struct size_class *class,\n\t\t\t\tint type, unsigned long cnt)\n{\n\tclass->stats.objs[type] += cnt;\n}"
  },
  {
    "function_name": "get_size_class_index",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "536-545",
    "snippet": "static int get_size_class_index(int size)\n{\n\tint idx = 0;\n\n\tif (likely(size > ZS_MIN_ALLOC_SIZE))\n\t\tidx = DIV_ROUND_UP(size - ZS_MIN_ALLOC_SIZE,\n\t\t\t\tZS_SIZE_CLASS_DELTA);\n\n\treturn min_t(int, ZS_SIZE_CLASSES - 1, idx);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)",
      "#define ZS_SIZE_CLASS_DELTA\t(PAGE_SIZE >> CLASS_BITS)",
      "#define ZS_MIN_ALLOC_SIZE \\\n\tMAX(32, (ZS_MAX_PAGES_PER_ZSPAGE << PAGE_SHIFT >> OBJ_INDEX_BITS))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "int",
            "ZS_SIZE_CLASSES - 1",
            "idx"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "size - ZS_MIN_ALLOC_SIZE",
            "ZS_SIZE_CLASS_DELTA"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "size > ZS_MIN_ALLOC_SIZE"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n#define ZS_SIZE_CLASS_DELTA\t(PAGE_SIZE >> CLASS_BITS)\n#define ZS_MIN_ALLOC_SIZE \\\n\tMAX(32, (ZS_MAX_PAGES_PER_ZSPAGE << PAGE_SHIFT >> OBJ_INDEX_BITS))\n\nstatic int get_size_class_index(int size)\n{\n\tint idx = 0;\n\n\tif (likely(size > ZS_MIN_ALLOC_SIZE))\n\t\tidx = DIV_ROUND_UP(size - ZS_MIN_ALLOC_SIZE,\n\t\t\t\tZS_SIZE_CLASS_DELTA);\n\n\treturn min_t(int, ZS_SIZE_CLASSES - 1, idx);\n}"
  },
  {
    "function_name": "set_zspage_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "521-527",
    "snippet": "static void set_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int class_idx,\n\t\t\t\tenum fullness_group fullness)\n{\n\tzspage->class = class_idx;\n\tzspage->fullness = fullness;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void set_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int class_idx,\n\t\t\t\tenum fullness_group fullness)\n{\n\tzspage->class = class_idx;\n\tzspage->fullness = fullness;\n}"
  },
  {
    "function_name": "get_zspage_mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "511-519",
    "snippet": "static void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZSPAGE_MAGIC\t0x58"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "zspage->magic != ZSPAGE_MAGIC"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZSPAGE_MAGIC\t0x58\n\nstatic void get_zspage_mapping(struct zspage *zspage,\n\t\t\t\tunsigned int *class_idx,\n\t\t\t\tenum fullness_group *fullness)\n{\n\tBUG_ON(zspage->magic != ZSPAGE_MAGIC);\n\n\t*fullness = zspage->fullness;\n\t*class_idx = zspage->class;\n}"
  },
  {
    "function_name": "set_freeobj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "506-509",
    "snippet": "static inline void set_freeobj(struct zspage *zspage, unsigned int obj)\n{\n\tzspage->freeobj = obj;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void set_freeobj(struct zspage *zspage, unsigned int obj)\n{\n\tzspage->freeobj = obj;\n}"
  },
  {
    "function_name": "get_freeobj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "501-504",
    "snippet": "static inline unsigned int get_freeobj(struct zspage *zspage)\n{\n\treturn zspage->freeobj;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline unsigned int get_freeobj(struct zspage *zspage)\n{\n\treturn zspage->freeobj;\n}"
  },
  {
    "function_name": "set_first_obj_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "496-499",
    "snippet": "static inline void set_first_obj_offset(struct page *page, int offset)\n{\n\tpage->units = offset;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void set_first_obj_offset(struct page *page, int offset)\n{\n\tpage->units = offset;\n}"
  },
  {
    "function_name": "get_first_obj_offset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "491-494",
    "snippet": "static inline int get_first_obj_offset(struct page *page)\n{\n\treturn page->units;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_first_obj_offset(struct page *page)\n{\n\treturn page->units;\n}"
  },
  {
    "function_name": "get_first_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "483-489",
    "snippet": "static inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VM_BUG_ON_PAGE",
          "args": [
            "!is_first_page(first_page)",
            "first_page"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_first_page",
          "args": [
            "first_page"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "is_first_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "462-465",
          "snippet": "static __maybe_unused int is_first_page(struct page *page)\n{\n\treturn PagePrivate(page);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic __maybe_unused int is_first_page(struct page *page)\n{\n\treturn PagePrivate(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline struct page *get_first_page(struct zspage *zspage)\n{\n\tstruct page *first_page = zspage->first_page;\n\n\tVM_BUG_ON_PAGE(!is_first_page(first_page), first_page);\n\treturn first_page;\n}"
  },
  {
    "function_name": "mod_zspage_inuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "478-481",
    "snippet": "static inline void mod_zspage_inuse(struct zspage *zspage, int val)\n{\n\tzspage->inuse += val;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void mod_zspage_inuse(struct zspage *zspage, int val)\n{\n\tzspage->inuse += val;\n}"
  },
  {
    "function_name": "set_zspage_inuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "473-476",
    "snippet": "static inline void set_zspage_inuse(struct zspage *zspage, int val)\n{\n\tzspage->inuse = val;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline void set_zspage_inuse(struct zspage *zspage, int val)\n{\n\tzspage->inuse = val;\n}"
  },
  {
    "function_name": "get_zspage_inuse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "468-471",
    "snippet": "static inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic inline int get_zspage_inuse(struct zspage *zspage)\n{\n\treturn zspage->inuse;\n}"
  },
  {
    "function_name": "is_first_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "462-465",
    "snippet": "static __maybe_unused int is_first_page(struct page *page)\n{\n\treturn PagePrivate(page);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PagePrivate",
          "args": [
            "page"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic __maybe_unused int is_first_page(struct page *page)\n{\n\treturn PagePrivate(page);\n}"
  },
  {
    "function_name": "is_zspage_isolated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "457-460",
    "snippet": "static bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic bool is_zspage_isolated(struct zspage *zspage)\n{\n\treturn zspage->isolated;\n}"
  },
  {
    "function_name": "zs_zpool_total_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "434-437",
    "snippet": "static u64 zs_zpool_total_size(void *pool)\n{\n\treturn zs_get_total_pages(pool) << PAGE_SHIFT;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_get_total_pages",
          "args": [
            "pool"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "zs_get_total_pages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1283-1286",
          "snippet": "unsigned long zs_get_total_pages(struct zs_pool *pool)\n{\n\treturn atomic_long_read(&pool->pages_allocated);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nunsigned long zs_get_total_pages(struct zs_pool *pool)\n{\n\treturn atomic_long_read(&pool->pages_allocated);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic u64 zs_zpool_total_size(void *pool)\n{\n\treturn zs_get_total_pages(pool) << PAGE_SHIFT;\n}"
  },
  {
    "function_name": "zs_zpool_unmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "429-432",
    "snippet": "static void zs_zpool_unmap(void *pool, unsigned long handle)\n{\n\tzs_unmap_object(pool, handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_unmap_object",
          "args": [
            "pool",
            "handle"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "zs_unmap_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1363-1398",
          "snippet": "void zs_unmap_object(struct zs_pool *pool, unsigned long handle)\n{\n\tstruct zspage *zspage;\n\tstruct page *page;\n\tunsigned long obj, off;\n\tunsigned int obj_idx;\n\n\tunsigned int class_idx;\n\tenum fullness_group fg;\n\tstruct size_class *class;\n\tstruct mapping_area *area;\n\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &page, &obj_idx);\n\tzspage = get_zspage(page);\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tclass = pool->size_class[class_idx];\n\toff = (class->size * obj_idx) & ~PAGE_MASK;\n\n\tarea = this_cpu_ptr(&zs_map_area);\n\tif (off + class->size <= PAGE_SIZE)\n\t\tkunmap_atomic(area->vm_addr);\n\telse {\n\t\tstruct page *pages[2];\n\n\t\tpages[0] = page;\n\t\tpages[1] = get_next_page(page);\n\t\tBUG_ON(!pages[1]);\n\n\t\t__zs_unmap_object(area, pages, off, class->size);\n\t}\n\tput_cpu_var(zs_map_area);\n\n\tmigrate_read_unlock(zspage);\n\tunpin_tag(handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(struct mapping_area, zs_map_area);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic DEFINE_PER_CPU(struct mapping_area, zs_map_area);\n\nvoid zs_unmap_object(struct zs_pool *pool, unsigned long handle)\n{\n\tstruct zspage *zspage;\n\tstruct page *page;\n\tunsigned long obj, off;\n\tunsigned int obj_idx;\n\n\tunsigned int class_idx;\n\tenum fullness_group fg;\n\tstruct size_class *class;\n\tstruct mapping_area *area;\n\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &page, &obj_idx);\n\tzspage = get_zspage(page);\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tclass = pool->size_class[class_idx];\n\toff = (class->size * obj_idx) & ~PAGE_MASK;\n\n\tarea = this_cpu_ptr(&zs_map_area);\n\tif (off + class->size <= PAGE_SIZE)\n\t\tkunmap_atomic(area->vm_addr);\n\telse {\n\t\tstruct page *pages[2];\n\n\t\tpages[0] = page;\n\t\tpages[1] = get_next_page(page);\n\t\tBUG_ON(!pages[1]);\n\n\t\t__zs_unmap_object(area, pages, off, class->size);\n\t}\n\tput_cpu_var(zs_map_area);\n\n\tmigrate_read_unlock(zspage);\n\tunpin_tag(handle);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_zpool_unmap(void *pool, unsigned long handle)\n{\n\tzs_unmap_object(pool, handle);\n}"
  },
  {
    "function_name": "zs_zpool_map",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "409-428",
    "snippet": "static void *zs_zpool_map(void *pool, unsigned long handle,\n\t\t\tenum zpool_mapmode mm)\n{\n\tenum zs_mapmode zs_mm;\n\n\tswitch (mm) {\n\tcase ZPOOL_MM_RO:\n\t\tzs_mm = ZS_MM_RO;\n\t\tbreak;\n\tcase ZPOOL_MM_WO:\n\t\tzs_mm = ZS_MM_WO;\n\t\tbreak;\n\tcase ZPOOL_MM_RW: /* fall through */\n\tdefault:\n\t\tzs_mm = ZS_MM_RW;\n\t\tbreak;\n\t}\n\n\treturn zs_map_object(pool, handle, zs_mm);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_map_object",
          "args": [
            "pool",
            "handle",
            "zs_mm"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "zs_map_object",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1304-1360",
          "snippet": "void *zs_map_object(struct zs_pool *pool, unsigned long handle,\n\t\t\tenum zs_mapmode mm)\n{\n\tstruct zspage *zspage;\n\tstruct page *page;\n\tunsigned long obj, off;\n\tunsigned int obj_idx;\n\n\tunsigned int class_idx;\n\tenum fullness_group fg;\n\tstruct size_class *class;\n\tstruct mapping_area *area;\n\tstruct page *pages[2];\n\tvoid *ret;\n\n\t/*\n\t * Because we use per-cpu mapping areas shared among the\n\t * pools/users, we can't allow mapping in interrupt context\n\t * because it can corrupt another users mappings.\n\t */\n\tBUG_ON(in_interrupt());\n\n\t/* From now on, migration cannot move the object */\n\tpin_tag(handle);\n\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &page, &obj_idx);\n\tzspage = get_zspage(page);\n\n\t/* migration cannot move any subpage in this zspage */\n\tmigrate_read_lock(zspage);\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tclass = pool->size_class[class_idx];\n\toff = (class->size * obj_idx) & ~PAGE_MASK;\n\n\tarea = &get_cpu_var(zs_map_area);\n\tarea->vm_mm = mm;\n\tif (off + class->size <= PAGE_SIZE) {\n\t\t/* this object is contained entirely within a page */\n\t\tarea->vm_addr = kmap_atomic(page);\n\t\tret = area->vm_addr + off;\n\t\tgoto out;\n\t}\n\n\t/* this object spans two pages */\n\tpages[0] = page;\n\tpages[1] = get_next_page(page);\n\tBUG_ON(!pages[1]);\n\n\tret = __zs_map_object(area, pages, off, class->size);\nout:\n\tif (likely(!PageHugeObject(page)))\n\t\tret += ZS_HANDLE_SIZE;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
          ],
          "globals_used": [
            "static DEFINE_PER_CPU(struct mapping_area, zs_map_area);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nstatic DEFINE_PER_CPU(struct mapping_area, zs_map_area);\n\nvoid *zs_map_object(struct zs_pool *pool, unsigned long handle,\n\t\t\tenum zs_mapmode mm)\n{\n\tstruct zspage *zspage;\n\tstruct page *page;\n\tunsigned long obj, off;\n\tunsigned int obj_idx;\n\n\tunsigned int class_idx;\n\tenum fullness_group fg;\n\tstruct size_class *class;\n\tstruct mapping_area *area;\n\tstruct page *pages[2];\n\tvoid *ret;\n\n\t/*\n\t * Because we use per-cpu mapping areas shared among the\n\t * pools/users, we can't allow mapping in interrupt context\n\t * because it can corrupt another users mappings.\n\t */\n\tBUG_ON(in_interrupt());\n\n\t/* From now on, migration cannot move the object */\n\tpin_tag(handle);\n\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &page, &obj_idx);\n\tzspage = get_zspage(page);\n\n\t/* migration cannot move any subpage in this zspage */\n\tmigrate_read_lock(zspage);\n\n\tget_zspage_mapping(zspage, &class_idx, &fg);\n\tclass = pool->size_class[class_idx];\n\toff = (class->size * obj_idx) & ~PAGE_MASK;\n\n\tarea = &get_cpu_var(zs_map_area);\n\tarea->vm_mm = mm;\n\tif (off + class->size <= PAGE_SIZE) {\n\t\t/* this object is contained entirely within a page */\n\t\tarea->vm_addr = kmap_atomic(page);\n\t\tret = area->vm_addr + off;\n\t\tgoto out;\n\t}\n\n\t/* this object spans two pages */\n\tpages[0] = page;\n\tpages[1] = get_next_page(page);\n\tBUG_ON(!pages[1]);\n\n\tret = __zs_map_object(area, pages, off, class->size);\nout:\n\tif (likely(!PageHugeObject(page)))\n\t\tret += ZS_HANDLE_SIZE;\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void *zs_zpool_map(void *pool, unsigned long handle,\n\t\t\tenum zpool_mapmode mm)\n{\n\tenum zs_mapmode zs_mm;\n\n\tswitch (mm) {\n\tcase ZPOOL_MM_RO:\n\t\tzs_mm = ZS_MM_RO;\n\t\tbreak;\n\tcase ZPOOL_MM_WO:\n\t\tzs_mm = ZS_MM_WO;\n\t\tbreak;\n\tcase ZPOOL_MM_RW: /* fall through */\n\tdefault:\n\t\tzs_mm = ZS_MM_RW;\n\t\tbreak;\n\t}\n\n\treturn zs_map_object(pool, handle, zs_mm);\n}"
  },
  {
    "function_name": "zs_zpool_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "404-407",
    "snippet": "static void zs_zpool_free(void *pool, unsigned long handle)\n{\n\tzs_free(pool, handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_free",
          "args": [
            "pool",
            "handle"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "zs_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1553-1595",
          "snippet": "void zs_free(struct zs_pool *pool, unsigned long handle)\n{\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long obj;\n\tunsigned int f_objidx;\n\tint class_idx;\n\tstruct size_class *class;\n\tenum fullness_group fullness;\n\tbool isolated;\n\n\tif (unlikely(!handle))\n\t\treturn;\n\n\tpin_tag(handle);\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tzspage = get_zspage(f_page);\n\n\tmigrate_read_lock(zspage);\n\n\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\tclass = pool->size_class[class_idx];\n\n\tspin_lock(&class->lock);\n\tobj_free(class, obj);\n\tfullness = fix_fullness_group(class, zspage);\n\tif (fullness != ZS_EMPTY) {\n\t\tmigrate_read_unlock(zspage);\n\t\tgoto out;\n\t}\n\n\tisolated = is_zspage_isolated(zspage);\n\tmigrate_read_unlock(zspage);\n\t/* If zspage is isolated, zs_page_putback will free the zspage */\n\tif (likely(!isolated))\n\t\tfree_zspage(pool, class, zspage);\nout:\n\n\tspin_unlock(&class->lock);\n\tunpin_tag(handle);\n\tcache_free_handle(pool, handle);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nvoid zs_free(struct zs_pool *pool, unsigned long handle)\n{\n\tstruct zspage *zspage;\n\tstruct page *f_page;\n\tunsigned long obj;\n\tunsigned int f_objidx;\n\tint class_idx;\n\tstruct size_class *class;\n\tenum fullness_group fullness;\n\tbool isolated;\n\n\tif (unlikely(!handle))\n\t\treturn;\n\n\tpin_tag(handle);\n\tobj = handle_to_obj(handle);\n\tobj_to_location(obj, &f_page, &f_objidx);\n\tzspage = get_zspage(f_page);\n\n\tmigrate_read_lock(zspage);\n\n\tget_zspage_mapping(zspage, &class_idx, &fullness);\n\tclass = pool->size_class[class_idx];\n\n\tspin_lock(&class->lock);\n\tobj_free(class, obj);\n\tfullness = fix_fullness_group(class, zspage);\n\tif (fullness != ZS_EMPTY) {\n\t\tmigrate_read_unlock(zspage);\n\t\tgoto out;\n\t}\n\n\tisolated = is_zspage_isolated(zspage);\n\tmigrate_read_unlock(zspage);\n\t/* If zspage is isolated, zs_page_putback will free the zspage */\n\tif (likely(!isolated))\n\t\tfree_zspage(pool, class, zspage);\nout:\n\n\tspin_unlock(&class->lock);\n\tunpin_tag(handle);\n\tcache_free_handle(pool, handle);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_zpool_free(void *pool, unsigned long handle)\n{\n\tzs_free(pool, handle);\n}"
  },
  {
    "function_name": "zs_zpool_malloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "398-403",
    "snippet": "static int zs_zpool_malloc(void *pool, size_t size, gfp_t gfp,\n\t\t\tunsigned long *handle)\n{\n\t*handle = zs_malloc(pool, size, gfp);\n\treturn *handle ? 0 : -1;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_malloc",
          "args": [
            "pool",
            "size",
            "gfp"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "zs_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "1472-1525",
          "snippet": "unsigned long zs_malloc(struct zs_pool *pool, size_t size, gfp_t gfp)\n{\n\tunsigned long handle, obj;\n\tstruct size_class *class;\n\tenum fullness_group newfg;\n\tstruct zspage *zspage;\n\n\tif (unlikely(!size || size > ZS_MAX_ALLOC_SIZE))\n\t\treturn 0;\n\n\thandle = cache_alloc_handle(pool, gfp);\n\tif (!handle)\n\t\treturn 0;\n\n\t/* extra space in chunk to keep the handle */\n\tsize += ZS_HANDLE_SIZE;\n\tclass = pool->size_class[get_size_class_index(size)];\n\n\tspin_lock(&class->lock);\n\tzspage = find_get_zspage(class);\n\tif (likely(zspage)) {\n\t\tobj = obj_malloc(class, zspage, handle);\n\t\t/* Now move the zspage to another fullness group, if required */\n\t\tfix_fullness_group(class, zspage);\n\t\trecord_obj(handle, obj);\n\t\tspin_unlock(&class->lock);\n\n\t\treturn handle;\n\t}\n\n\tspin_unlock(&class->lock);\n\n\tzspage = alloc_zspage(pool, class, gfp);\n\tif (!zspage) {\n\t\tcache_free_handle(pool, handle);\n\t\treturn 0;\n\t}\n\n\tspin_lock(&class->lock);\n\tobj = obj_malloc(class, zspage, handle);\n\tnewfg = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, newfg);\n\tset_zspage_mapping(zspage, class->index, newfg);\n\trecord_obj(handle, obj);\n\tatomic_long_add(class->pages_per_zspage,\n\t\t\t\t&pool->pages_allocated);\n\tzs_stat_inc(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\n\t/* We completely set up zspage so mark them as movable */\n\tSetZsPageMovable(pool, zspage);\n\tspin_unlock(&class->lock);\n\n\treturn handle;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE",
            "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nunsigned long zs_malloc(struct zs_pool *pool, size_t size, gfp_t gfp)\n{\n\tunsigned long handle, obj;\n\tstruct size_class *class;\n\tenum fullness_group newfg;\n\tstruct zspage *zspage;\n\n\tif (unlikely(!size || size > ZS_MAX_ALLOC_SIZE))\n\t\treturn 0;\n\n\thandle = cache_alloc_handle(pool, gfp);\n\tif (!handle)\n\t\treturn 0;\n\n\t/* extra space in chunk to keep the handle */\n\tsize += ZS_HANDLE_SIZE;\n\tclass = pool->size_class[get_size_class_index(size)];\n\n\tspin_lock(&class->lock);\n\tzspage = find_get_zspage(class);\n\tif (likely(zspage)) {\n\t\tobj = obj_malloc(class, zspage, handle);\n\t\t/* Now move the zspage to another fullness group, if required */\n\t\tfix_fullness_group(class, zspage);\n\t\trecord_obj(handle, obj);\n\t\tspin_unlock(&class->lock);\n\n\t\treturn handle;\n\t}\n\n\tspin_unlock(&class->lock);\n\n\tzspage = alloc_zspage(pool, class, gfp);\n\tif (!zspage) {\n\t\tcache_free_handle(pool, handle);\n\t\treturn 0;\n\t}\n\n\tspin_lock(&class->lock);\n\tobj = obj_malloc(class, zspage, handle);\n\tnewfg = get_fullness_group(class, zspage);\n\tinsert_zspage(class, zspage, newfg);\n\tset_zspage_mapping(zspage, class->index, newfg);\n\trecord_obj(handle, obj);\n\tatomic_long_add(class->pages_per_zspage,\n\t\t\t\t&pool->pages_allocated);\n\tzs_stat_inc(class, OBJ_ALLOCATED, class->objs_per_zspage);\n\n\t/* We completely set up zspage so mark them as movable */\n\tSetZsPageMovable(pool, zspage);\n\tspin_unlock(&class->lock);\n\n\treturn handle;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zs_zpool_malloc(void *pool, size_t size, gfp_t gfp,\n\t\t\tunsigned long *handle)\n{\n\t*handle = zs_malloc(pool, size, gfp);\n\treturn *handle ? 0 : -1;\n}"
  },
  {
    "function_name": "zs_zpool_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "393-396",
    "snippet": "static void zs_zpool_destroy(void *pool)\n{\n\tzs_destroy_pool(pool);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_destroy_pool",
          "args": [
            "pool"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "zs_destroy_pool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2465-2495",
          "snippet": "void zs_destroy_pool(struct zs_pool *pool)\n{\n\tint i;\n\n\tzs_unregister_shrinker(pool);\n\tzs_unregister_migration(pool);\n\tzs_pool_stat_destroy(pool);\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tint fg;\n\t\tstruct size_class *class = pool->size_class[i];\n\n\t\tif (!class)\n\t\t\tcontinue;\n\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tfor (fg = ZS_EMPTY; fg < NR_ZS_FULLNESS; fg++) {\n\t\t\tif (!list_empty(&class->fullness_list[fg])) {\n\t\t\t\tpr_info(\"Freeing non-empty class with size %db, fullness group %d\\n\",\n\t\t\t\t\tclass->size, fg);\n\t\t\t}\n\t\t}\n\t\tkfree(class);\n\t}\n\n\tdestroy_cache(pool);\n\tkfree(pool->name);\n\tkfree(pool);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n\nvoid zs_destroy_pool(struct zs_pool *pool)\n{\n\tint i;\n\n\tzs_unregister_shrinker(pool);\n\tzs_unregister_migration(pool);\n\tzs_pool_stat_destroy(pool);\n\n\tfor (i = 0; i < ZS_SIZE_CLASSES; i++) {\n\t\tint fg;\n\t\tstruct size_class *class = pool->size_class[i];\n\n\t\tif (!class)\n\t\t\tcontinue;\n\n\t\tif (class->index != i)\n\t\t\tcontinue;\n\n\t\tfor (fg = ZS_EMPTY; fg < NR_ZS_FULLNESS; fg++) {\n\t\t\tif (!list_empty(&class->fullness_list[fg])) {\n\t\t\t\tpr_info(\"Freeing non-empty class with size %db, fullness group %d\\n\",\n\t\t\t\t\tclass->size, fg);\n\t\t\t}\n\t\t}\n\t\tkfree(class);\n\t}\n\n\tdestroy_cache(pool);\n\tkfree(pool->name);\n\tkfree(pool);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_zpool_destroy(void *pool)\n{\n\tzs_destroy_pool(pool);\n}"
  },
  {
    "function_name": "zs_zpool_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "381-391",
    "snippet": "static void *zs_zpool_create(const char *name, gfp_t gfp,\n\t\t\t     const struct zpool_ops *zpool_ops,\n\t\t\t     struct zpool *zpool)\n{\n\t/*\n\t * Ignore global gfp flags: zs_malloc() may be invoked from\n\t * different contexts and its caller must provide a valid\n\t * gfp mask.\n\t */\n\treturn zs_create_pool(name);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zs_create_pool",
          "args": [
            "name"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "zs_create_pool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
          "lines": "2353-2462",
          "snippet": "struct zs_pool *zs_create_pool(const char *name)\n{\n\tint i;\n\tstruct zs_pool *pool;\n\tstruct size_class *prev_class = NULL;\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\tinit_deferred_free(pool);\n\n\tpool->name = kstrdup(name, GFP_KERNEL);\n\tif (!pool->name)\n\t\tgoto err;\n\n\tif (create_cache(pool))\n\t\tgoto err;\n\n\t/*\n\t * Iterate reversely, because, size of size_class that we want to use\n\t * for merging should be larger or equal to current size.\n\t */\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tint size;\n\t\tint pages_per_zspage;\n\t\tint objs_per_zspage;\n\t\tstruct size_class *class;\n\t\tint fullness = 0;\n\n\t\tsize = ZS_MIN_ALLOC_SIZE + i * ZS_SIZE_CLASS_DELTA;\n\t\tif (size > ZS_MAX_ALLOC_SIZE)\n\t\t\tsize = ZS_MAX_ALLOC_SIZE;\n\t\tpages_per_zspage = get_pages_per_zspage(size);\n\t\tobjs_per_zspage = pages_per_zspage * PAGE_SIZE / size;\n\n\t\t/*\n\t\t * We iterate from biggest down to smallest classes,\n\t\t * so huge_class_size holds the size of the first huge\n\t\t * class. Any object bigger than or equal to that will\n\t\t * endup in the huge class.\n\t\t */\n\t\tif (pages_per_zspage != 1 && objs_per_zspage != 1 &&\n\t\t\t\t!huge_class_size) {\n\t\t\thuge_class_size = size;\n\t\t\t/*\n\t\t\t * The object uses ZS_HANDLE_SIZE bytes to store the\n\t\t\t * handle. We need to subtract it, because zs_malloc()\n\t\t\t * unconditionally adds handle size before it performs\n\t\t\t * size class search - so object may be smaller than\n\t\t\t * huge class size, yet it still can end up in the huge\n\t\t\t * class because it grows by ZS_HANDLE_SIZE extra bytes\n\t\t\t * right before class lookup.\n\t\t\t */\n\t\t\thuge_class_size -= (ZS_HANDLE_SIZE - 1);\n\t\t}\n\n\t\t/*\n\t\t * size_class is used for normal zsmalloc operation such\n\t\t * as alloc/free for that size. Although it is natural that we\n\t\t * have one size_class for each size, there is a chance that we\n\t\t * can get more memory utilization if we use one size_class for\n\t\t * many different sizes whose size_class have same\n\t\t * characteristics. So, we makes size_class point to\n\t\t * previous size_class if possible.\n\t\t */\n\t\tif (prev_class) {\n\t\t\tif (can_merge(prev_class, pages_per_zspage, objs_per_zspage)) {\n\t\t\t\tpool->size_class[i] = prev_class;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tclass = kzalloc(sizeof(struct size_class), GFP_KERNEL);\n\t\tif (!class)\n\t\t\tgoto err;\n\n\t\tclass->size = size;\n\t\tclass->index = i;\n\t\tclass->pages_per_zspage = pages_per_zspage;\n\t\tclass->objs_per_zspage = objs_per_zspage;\n\t\tspin_lock_init(&class->lock);\n\t\tpool->size_class[i] = class;\n\t\tfor (fullness = ZS_EMPTY; fullness < NR_ZS_FULLNESS;\n\t\t\t\t\t\t\tfullness++)\n\t\t\tINIT_LIST_HEAD(&class->fullness_list[fullness]);\n\n\t\tprev_class = class;\n\t}\n\n\t/* debug only, don't abort if it fails */\n\tzs_pool_stat_create(pool, name);\n\n\tif (zs_register_migration(pool))\n\t\tgoto err;\n\n\t/*\n\t * Not critical since shrinker is only used to trigger internal\n\t * defragmentation of the pool which is pretty optional thing.  If\n\t * registration fails we still can use the pool normally and user can\n\t * trigger compaction manually. Thus, ignore return code.\n\t */\n\tzs_register_shrinker(pool);\n\n\treturn pool;\n\nerr:\n\tzs_destroy_pool(pool);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mount.h>",
            "#include <linux/zpool.h>",
            "#include <linux/zsmalloc.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/types.h>",
            "#include <linux/shrinker.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/cpu.h>",
            "#include <linux/cpumask.h>",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/highmem.h>",
            "#include <linux/errno.h>",
            "#include <linux/bitops.h>",
            "#include <linux/magic.h>",
            "#include <linux/sched.h>",
            "#include <linux/kernel.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)",
            "#define ZS_SIZE_CLASS_DELTA\t(PAGE_SIZE >> CLASS_BITS)",
            "#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE",
            "#define ZS_MIN_ALLOC_SIZE \\\n\tMAX(32, (ZS_MAX_PAGES_PER_ZSPAGE << PAGE_SHIFT >> OBJ_INDEX_BITS))",
            "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
          ],
          "globals_used": [
            "static size_t huge_class_size;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_SIZE_CLASSES\t(DIV_ROUND_UP(ZS_MAX_ALLOC_SIZE - ZS_MIN_ALLOC_SIZE, \\\n\t\t\t\t      ZS_SIZE_CLASS_DELTA) + 1)\n#define ZS_SIZE_CLASS_DELTA\t(PAGE_SIZE >> CLASS_BITS)\n#define ZS_MAX_ALLOC_SIZE\tPAGE_SIZE\n#define ZS_MIN_ALLOC_SIZE \\\n\tMAX(32, (ZS_MAX_PAGES_PER_ZSPAGE << PAGE_SHIFT >> OBJ_INDEX_BITS))\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nstatic size_t huge_class_size;\n\nstruct zs_pool *zs_create_pool(const char *name)\n{\n\tint i;\n\tstruct zs_pool *pool;\n\tstruct size_class *prev_class = NULL;\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\tinit_deferred_free(pool);\n\n\tpool->name = kstrdup(name, GFP_KERNEL);\n\tif (!pool->name)\n\t\tgoto err;\n\n\tif (create_cache(pool))\n\t\tgoto err;\n\n\t/*\n\t * Iterate reversely, because, size of size_class that we want to use\n\t * for merging should be larger or equal to current size.\n\t */\n\tfor (i = ZS_SIZE_CLASSES - 1; i >= 0; i--) {\n\t\tint size;\n\t\tint pages_per_zspage;\n\t\tint objs_per_zspage;\n\t\tstruct size_class *class;\n\t\tint fullness = 0;\n\n\t\tsize = ZS_MIN_ALLOC_SIZE + i * ZS_SIZE_CLASS_DELTA;\n\t\tif (size > ZS_MAX_ALLOC_SIZE)\n\t\t\tsize = ZS_MAX_ALLOC_SIZE;\n\t\tpages_per_zspage = get_pages_per_zspage(size);\n\t\tobjs_per_zspage = pages_per_zspage * PAGE_SIZE / size;\n\n\t\t/*\n\t\t * We iterate from biggest down to smallest classes,\n\t\t * so huge_class_size holds the size of the first huge\n\t\t * class. Any object bigger than or equal to that will\n\t\t * endup in the huge class.\n\t\t */\n\t\tif (pages_per_zspage != 1 && objs_per_zspage != 1 &&\n\t\t\t\t!huge_class_size) {\n\t\t\thuge_class_size = size;\n\t\t\t/*\n\t\t\t * The object uses ZS_HANDLE_SIZE bytes to store the\n\t\t\t * handle. We need to subtract it, because zs_malloc()\n\t\t\t * unconditionally adds handle size before it performs\n\t\t\t * size class search - so object may be smaller than\n\t\t\t * huge class size, yet it still can end up in the huge\n\t\t\t * class because it grows by ZS_HANDLE_SIZE extra bytes\n\t\t\t * right before class lookup.\n\t\t\t */\n\t\t\thuge_class_size -= (ZS_HANDLE_SIZE - 1);\n\t\t}\n\n\t\t/*\n\t\t * size_class is used for normal zsmalloc operation such\n\t\t * as alloc/free for that size. Although it is natural that we\n\t\t * have one size_class for each size, there is a chance that we\n\t\t * can get more memory utilization if we use one size_class for\n\t\t * many different sizes whose size_class have same\n\t\t * characteristics. So, we makes size_class point to\n\t\t * previous size_class if possible.\n\t\t */\n\t\tif (prev_class) {\n\t\t\tif (can_merge(prev_class, pages_per_zspage, objs_per_zspage)) {\n\t\t\t\tpool->size_class[i] = prev_class;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tclass = kzalloc(sizeof(struct size_class), GFP_KERNEL);\n\t\tif (!class)\n\t\t\tgoto err;\n\n\t\tclass->size = size;\n\t\tclass->index = i;\n\t\tclass->pages_per_zspage = pages_per_zspage;\n\t\tclass->objs_per_zspage = objs_per_zspage;\n\t\tspin_lock_init(&class->lock);\n\t\tpool->size_class[i] = class;\n\t\tfor (fullness = ZS_EMPTY; fullness < NR_ZS_FULLNESS;\n\t\t\t\t\t\t\tfullness++)\n\t\t\tINIT_LIST_HEAD(&class->fullness_list[fullness]);\n\n\t\tprev_class = class;\n\t}\n\n\t/* debug only, don't abort if it fails */\n\tzs_pool_stat_create(pool, name);\n\n\tif (zs_register_migration(pool))\n\t\tgoto err;\n\n\t/*\n\t * Not critical since shrinker is only used to trigger internal\n\t * defragmentation of the pool which is pretty optional thing.  If\n\t * registration fails we still can use the pool normally and user can\n\t * trigger compaction manually. Thus, ignore return code.\n\t */\n\tzs_register_shrinker(pool);\n\n\treturn pool;\n\nerr:\n\tzs_destroy_pool(pool);\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void *zs_zpool_create(const char *name, gfp_t gfp,\n\t\t\t     const struct zpool_ops *zpool_ops,\n\t\t\t     struct zpool *zpool)\n{\n\t/*\n\t * Ignore global gfp flags: zs_malloc() may be invoked from\n\t * different contexts and its caller must provide a valid\n\t * gfp mask.\n\t */\n\treturn zs_create_pool(name);\n}"
  },
  {
    "function_name": "record_obj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "367-375",
    "snippet": "static void record_obj(unsigned long handle, unsigned long obj)\n{\n\t/*\n\t * lsb of @obj represents handle lock while other bits\n\t * represent object value the handle is pointing so\n\t * updating shouldn't do store tearing.\n\t */\n\tWRITE_ONCE(*(unsigned long *)handle, obj);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "*(unsigned long *)handle",
            "obj"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void record_obj(unsigned long handle, unsigned long obj)\n{\n\t/*\n\t * lsb of @obj represents handle lock while other bits\n\t * represent object value the handle is pointing so\n\t * updating shouldn't do store tearing.\n\t */\n\tWRITE_ONCE(*(unsigned long *)handle, obj);\n}"
  },
  {
    "function_name": "cache_free_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "362-365",
    "snippet": "static void cache_free_zspage(struct zs_pool *pool, struct zspage *zspage)\n{\n\tkmem_cache_free(pool->zspage_cachep, zspage);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "pool->zspage_cachep",
            "zspage"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3749-3764",
          "snippet": "void kmem_cache_free(struct kmem_cache *cachep, void *objp)\n{\n\tunsigned long flags;\n\tcachep = cache_from_obj(cachep, objp);\n\tif (!cachep)\n\t\treturn;\n\n\tlocal_irq_save(flags);\n\tdebug_check_no_locks_freed(objp, cachep->object_size);\n\tif (!(cachep->flags & SLAB_DEBUG_OBJECTS))\n\t\tdebug_check_no_obj_freed(objp, cachep->object_size);\n\t__cache_free(cachep, objp, _RET_IP_);\n\tlocal_irq_restore(flags);\n\n\ttrace_kmem_cache_free(_RET_IP_, objp);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid kmem_cache_free(struct kmem_cache *cachep, void *objp)\n{\n\tunsigned long flags;\n\tcachep = cache_from_obj(cachep, objp);\n\tif (!cachep)\n\t\treturn;\n\n\tlocal_irq_save(flags);\n\tdebug_check_no_locks_freed(objp, cachep->object_size);\n\tif (!(cachep->flags & SLAB_DEBUG_OBJECTS))\n\t\tdebug_check_no_obj_freed(objp, cachep->object_size);\n\t__cache_free(cachep, objp, _RET_IP_);\n\tlocal_irq_restore(flags);\n\n\ttrace_kmem_cache_free(_RET_IP_, objp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void cache_free_zspage(struct zs_pool *pool, struct zspage *zspage)\n{\n\tkmem_cache_free(pool->zspage_cachep, zspage);\n}"
  },
  {
    "function_name": "cache_alloc_zspage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "356-360",
    "snippet": "static struct zspage *cache_alloc_zspage(struct zs_pool *pool, gfp_t flags)\n{\n\treturn kmem_cache_alloc(pool->zspage_cachep,\n\t\t\tflags & ~(__GFP_HIGHMEM|__GFP_MOVABLE));\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "pool->zspage_cachep",
            "flags & ~(__GFP_HIGHMEM|__GFP_MOVABLE)"
          ],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3550-3559",
          "snippet": "void *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic struct zspage *cache_alloc_zspage(struct zs_pool *pool, gfp_t flags)\n{\n\treturn kmem_cache_alloc(pool->zspage_cachep,\n\t\t\tflags & ~(__GFP_HIGHMEM|__GFP_MOVABLE));\n}"
  },
  {
    "function_name": "cache_free_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "351-354",
    "snippet": "static void cache_free_handle(struct zs_pool *pool, unsigned long handle)\n{\n\tkmem_cache_free(pool->handle_cachep, (void *)handle);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "pool->handle_cachep",
            "(void *)handle"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3749-3764",
          "snippet": "void kmem_cache_free(struct kmem_cache *cachep, void *objp)\n{\n\tunsigned long flags;\n\tcachep = cache_from_obj(cachep, objp);\n\tif (!cachep)\n\t\treturn;\n\n\tlocal_irq_save(flags);\n\tdebug_check_no_locks_freed(objp, cachep->object_size);\n\tif (!(cachep->flags & SLAB_DEBUG_OBJECTS))\n\t\tdebug_check_no_obj_freed(objp, cachep->object_size);\n\t__cache_free(cachep, objp, _RET_IP_);\n\tlocal_irq_restore(flags);\n\n\ttrace_kmem_cache_free(_RET_IP_, objp);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid kmem_cache_free(struct kmem_cache *cachep, void *objp)\n{\n\tunsigned long flags;\n\tcachep = cache_from_obj(cachep, objp);\n\tif (!cachep)\n\t\treturn;\n\n\tlocal_irq_save(flags);\n\tdebug_check_no_locks_freed(objp, cachep->object_size);\n\tif (!(cachep->flags & SLAB_DEBUG_OBJECTS))\n\t\tdebug_check_no_obj_freed(objp, cachep->object_size);\n\t__cache_free(cachep, objp, _RET_IP_);\n\tlocal_irq_restore(flags);\n\n\ttrace_kmem_cache_free(_RET_IP_, objp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void cache_free_handle(struct zs_pool *pool, unsigned long handle)\n{\n\tkmem_cache_free(pool->handle_cachep, (void *)handle);\n}"
  },
  {
    "function_name": "cache_alloc_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "345-349",
    "snippet": "static unsigned long cache_alloc_handle(struct zs_pool *pool, gfp_t gfp)\n{\n\treturn (unsigned long)kmem_cache_alloc(pool->handle_cachep,\n\t\t\tgfp & ~(__GFP_HIGHMEM|__GFP_MOVABLE));\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "pool->handle_cachep",
            "gfp & ~(__GFP_HIGHMEM|__GFP_MOVABLE)"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3550-3559",
          "snippet": "void *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic unsigned long cache_alloc_handle(struct zs_pool *pool, gfp_t gfp)\n{\n\treturn (unsigned long)kmem_cache_alloc(pool->handle_cachep,\n\t\t\tgfp & ~(__GFP_HIGHMEM|__GFP_MOVABLE));\n}"
  },
  {
    "function_name": "destroy_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "339-343",
    "snippet": "static void destroy_cache(struct zs_pool *pool)\n{\n\tkmem_cache_destroy(pool->handle_cachep);\n\tkmem_cache_destroy(pool->zspage_cachep);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "pool->zspage_cachep"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "874-906",
          "snippet": "void kmem_cache_destroy(struct kmem_cache *s)\n{\n\tint err;\n\n\tif (unlikely(!s))\n\t\treturn;\n\n\tflush_memcg_workqueue(s);\n\n\tget_online_cpus();\n\tget_online_mems();\n\n\tmutex_lock(&slab_mutex);\n\n\ts->refcount--;\n\tif (s->refcount)\n\t\tgoto out_unlock;\n\n\terr = shutdown_memcg_caches(s);\n\tif (!err)\n\t\terr = shutdown_cache(s);\n\n\tif (err) {\n\t\tpr_err(\"kmem_cache_destroy %s: Slab cache still has objects\\n\",\n\t\t       s->name);\n\t\tdump_stack();\n\t}\nout_unlock:\n\tmutex_unlock(&slab_mutex);\n\n\tput_online_mems();\n\tput_online_cpus();\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct kmem_cache *kmem_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nstruct kmem_cache *kmem_cache;\n\nvoid kmem_cache_destroy(struct kmem_cache *s)\n{\n\tint err;\n\n\tif (unlikely(!s))\n\t\treturn;\n\n\tflush_memcg_workqueue(s);\n\n\tget_online_cpus();\n\tget_online_mems();\n\n\tmutex_lock(&slab_mutex);\n\n\ts->refcount--;\n\tif (s->refcount)\n\t\tgoto out_unlock;\n\n\terr = shutdown_memcg_caches(s);\n\tif (!err)\n\t\terr = shutdown_cache(s);\n\n\tif (err) {\n\t\tpr_err(\"kmem_cache_destroy %s: Slab cache still has objects\\n\",\n\t\t       s->name);\n\t\tdump_stack();\n\t}\nout_unlock:\n\tmutex_unlock(&slab_mutex);\n\n\tput_online_mems();\n\tput_online_cpus();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void destroy_cache(struct zs_pool *pool)\n{\n\tkmem_cache_destroy(pool->handle_cachep);\n\tkmem_cache_destroy(pool->zspage_cachep);\n}"
  },
  {
    "function_name": "create_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "321-337",
    "snippet": "static int create_cache(struct zs_pool *pool)\n{\n\tpool->handle_cachep = kmem_cache_create(\"zs_handle\", ZS_HANDLE_SIZE,\n\t\t\t\t\t0, 0, NULL);\n\tif (!pool->handle_cachep)\n\t\treturn 1;\n\n\tpool->zspage_cachep = kmem_cache_create(\"zspage\", sizeof(struct zspage),\n\t\t\t\t\t0, 0, NULL);\n\tif (!pool->zspage_cachep) {\n\t\tkmem_cache_destroy(pool->handle_cachep);\n\t\tpool->handle_cachep = NULL;\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZS_HANDLE_SIZE (sizeof(unsigned long))"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "pool->handle_cachep"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "874-906",
          "snippet": "void kmem_cache_destroy(struct kmem_cache *s)\n{\n\tint err;\n\n\tif (unlikely(!s))\n\t\treturn;\n\n\tflush_memcg_workqueue(s);\n\n\tget_online_cpus();\n\tget_online_mems();\n\n\tmutex_lock(&slab_mutex);\n\n\ts->refcount--;\n\tif (s->refcount)\n\t\tgoto out_unlock;\n\n\terr = shutdown_memcg_caches(s);\n\tif (!err)\n\t\terr = shutdown_cache(s);\n\n\tif (err) {\n\t\tpr_err(\"kmem_cache_destroy %s: Slab cache still has objects\\n\",\n\t\t       s->name);\n\t\tdump_stack();\n\t}\nout_unlock:\n\tmutex_unlock(&slab_mutex);\n\n\tput_online_mems();\n\tput_online_cpus();\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct kmem_cache *kmem_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nstruct kmem_cache *kmem_cache;\n\nvoid kmem_cache_destroy(struct kmem_cache *s)\n{\n\tint err;\n\n\tif (unlikely(!s))\n\t\treturn;\n\n\tflush_memcg_workqueue(s);\n\n\tget_online_cpus();\n\tget_online_mems();\n\n\tmutex_lock(&slab_mutex);\n\n\ts->refcount--;\n\tif (s->refcount)\n\t\tgoto out_unlock;\n\n\terr = shutdown_memcg_caches(s);\n\tif (!err)\n\t\terr = shutdown_cache(s);\n\n\tif (err) {\n\t\tpr_err(\"kmem_cache_destroy %s: Slab cache still has objects\\n\",\n\t\t       s->name);\n\t\tdump_stack();\n\t}\nout_unlock:\n\tmutex_unlock(&slab_mutex);\n\n\tput_online_mems();\n\tput_online_cpus();\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmem_cache_create",
          "args": [
            "\"zspage\"",
            "sizeof(struct zspage)",
            "0",
            "0",
            "NULL"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "517-523",
          "snippet": "struct kmem_cache *\nkmem_cache_create(const char *name, unsigned int size, unsigned int align,\n\t\tslab_flags_t flags, void (*ctor)(void *))\n{\n\treturn kmem_cache_create_usercopy(name, size, align, flags, 0, 0,\n\t\t\t\t\t  ctor);\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct kmem_cache *kmem_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nstruct kmem_cache *kmem_cache;\n\nstruct kmem_cache *\nkmem_cache_create(const char *name, unsigned int size, unsigned int align,\n\t\tslab_flags_t flags, void (*ctor)(void *))\n{\n\treturn kmem_cache_create_usercopy(name, size, align, flags, 0, 0,\n\t\t\t\t\t  ctor);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\n#define ZS_HANDLE_SIZE (sizeof(unsigned long))\n\nstatic int create_cache(struct zs_pool *pool)\n{\n\tpool->handle_cachep = kmem_cache_create(\"zs_handle\", ZS_HANDLE_SIZE,\n\t\t\t\t\t0, 0, NULL);\n\tif (!pool->handle_cachep)\n\t\treturn 1;\n\n\tpool->zspage_cachep = kmem_cache_create(\"zspage\", sizeof(struct zspage),\n\t\t\t\t\t0, 0, NULL);\n\tif (!pool->zspage_cachep) {\n\t\tkmem_cache_destroy(pool->handle_cachep);\n\t\tpool->handle_cachep = NULL;\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "SetZsPageMovable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "318-318",
    "snippet": "static void SetZsPageMovable(struct zs_pool *pool, struct zspage *zspage) {}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void SetZsPageMovable(struct zs_pool *pool, struct zspage *zspage) {}"
  },
  {
    "function_name": "init_deferred_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "317-317",
    "snippet": "static void init_deferred_free(struct zs_pool *pool) {}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void init_deferred_free(struct zs_pool *pool) {}"
  },
  {
    "function_name": "kick_deferred_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "316-316",
    "snippet": "static void kick_deferred_free(struct zs_pool *pool) {}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void kick_deferred_free(struct zs_pool *pool) {}"
  },
  {
    "function_name": "migrate_read_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "315-315",
    "snippet": "static void migrate_read_unlock(struct zspage *zspage) {}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_read_unlock(struct zspage *zspage) {}"
  },
  {
    "function_name": "migrate_read_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "314-314",
    "snippet": "static void migrate_read_lock(struct zspage *zspage) {}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_read_lock(struct zspage *zspage) {}"
  },
  {
    "function_name": "migrate_lock_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "313-313",
    "snippet": "static void migrate_lock_init(struct zspage *zspage) {}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void migrate_lock_init(struct zspage *zspage) {}"
  },
  {
    "function_name": "zs_unregister_migration",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "312-312",
    "snippet": "static void zs_unregister_migration(struct zs_pool *pool) {}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zs_unregister_migration(struct zs_pool *pool) {}"
  },
  {
    "function_name": "zs_register_migration",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "311-311",
    "snippet": "static int zs_register_migration(struct zs_pool *pool) { return 0; }",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zs_register_migration(struct zs_pool *pool) { return 0; }"
  },
  {
    "function_name": "zsmalloc_unmount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "310-310",
    "snippet": "static void zsmalloc_unmount(void) {}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void zsmalloc_unmount(void) {}"
  },
  {
    "function_name": "zsmalloc_mount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "309-309",
    "snippet": "static int zsmalloc_mount(void) { return 0; }",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int zsmalloc_mount(void) { return 0; }"
  },
  {
    "function_name": "PageHugeObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "225-228",
    "snippet": "static int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PageOwnerPriv1",
          "args": [
            "page"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic int PageHugeObject(struct page *page)\n{\n\treturn PageOwnerPriv1(page);\n}"
  },
  {
    "function_name": "ClearPageHugeObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "220-223",
    "snippet": "static void ClearPageHugeObject(struct page *page)\n{\n\tClearPageOwnerPriv1(page);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ClearPageOwnerPriv1",
          "args": [
            "page"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void ClearPageHugeObject(struct page *page)\n{\n\tClearPageOwnerPriv1(page);\n}"
  },
  {
    "function_name": "SetPageHugeObject",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zsmalloc.c",
    "lines": "215-218",
    "snippet": "static void SetPageHugeObject(struct page *page)\n{\n\tSetPageOwnerPriv1(page);\n}",
    "includes": [
      "#include <linux/fs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/migrate.h>",
      "#include <linux/mount.h>",
      "#include <linux/zpool.h>",
      "#include <linux/zsmalloc.h>",
      "#include <linux/debugfs.h>",
      "#include <linux/types.h>",
      "#include <linux/shrinker.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/preempt.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/cpu.h>",
      "#include <linux/cpumask.h>",
      "#include <asm/pgtable.h>",
      "#include <asm/tlbflush.h>",
      "#include <linux/slab.h>",
      "#include <linux/string.h>",
      "#include <linux/highmem.h>",
      "#include <linux/errno.h>",
      "#include <linux/bitops.h>",
      "#include <linux/magic.h>",
      "#include <linux/sched.h>",
      "#include <linux/kernel.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetPageOwnerPriv1",
          "args": [
            "page"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs.h>\n#include <linux/pagemap.h>\n#include <linux/migrate.h>\n#include <linux/mount.h>\n#include <linux/zpool.h>\n#include <linux/zsmalloc.h>\n#include <linux/debugfs.h>\n#include <linux/types.h>\n#include <linux/shrinker.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/vmalloc.h>\n#include <linux/cpu.h>\n#include <linux/cpumask.h>\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/highmem.h>\n#include <linux/errno.h>\n#include <linux/bitops.h>\n#include <linux/magic.h>\n#include <linux/sched.h>\n#include <linux/kernel.h>\n#include <linux/module.h>\n\nstatic void SetPageHugeObject(struct page *page)\n{\n\tSetPageOwnerPriv1(page);\n}"
  }
]