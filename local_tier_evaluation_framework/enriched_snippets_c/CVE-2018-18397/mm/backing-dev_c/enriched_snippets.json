[
  {
    "function_name": "wait_iff_congested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "1047-1079",
    "snippet": "long wait_iff_congested(int sync, long timeout)\n{\n\tlong ret;\n\tunsigned long start = jiffies;\n\tDEFINE_WAIT(wait);\n\twait_queue_head_t *wqh = &congestion_wqh[sync];\n\n\t/*\n\t * If there is no congestion, yield if necessary instead\n\t * of sleeping on the congestion queue\n\t */\n\tif (atomic_read(&nr_wb_congested[sync]) == 0) {\n\t\tcond_resched();\n\n\t\t/* In case we scheduled, work out time remaining */\n\t\tret = timeout - (jiffies - start);\n\t\tif (ret < 0)\n\t\t\tret = 0;\n\n\t\tgoto out;\n\t}\n\n\t/* Sleep until uncongested or a write happens */\n\tprepare_to_wait(wqh, &wait, TASK_UNINTERRUPTIBLE);\n\tret = io_schedule_timeout(timeout);\n\tfinish_wait(wqh, &wait);\n\nout:\n\ttrace_writeback_wait_iff_congested(jiffies_to_usecs(timeout),\n\t\t\t\t\tjiffies_to_usecs(jiffies - start));\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static wait_queue_head_t congestion_wqh[2] = {\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[0]),\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[1])\n\t};",
      "static atomic_t nr_wb_congested[2];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_writeback_wait_iff_congested",
          "args": [
            "jiffies_to_usecs(timeout)",
            "jiffies_to_usecs(jiffies - start)"
          ],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jiffies_to_usecs",
          "args": [
            "jiffies - start"
          ],
          "line": 1076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jiffies_to_usecs",
          "args": [
            "timeout"
          ],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "finish_wait",
          "args": [
            "wqh",
            "&wait"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "io_schedule_timeout",
          "args": [
            "timeout"
          ],
          "line": 1071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_to_wait",
          "args": [
            "wqh",
            "&wait",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&nr_wb_congested[sync]"
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEFINE_WAIT",
          "args": [
            "wait"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic wait_queue_head_t congestion_wqh[2] = {\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[0]),\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[1])\n\t};\nstatic atomic_t nr_wb_congested[2];\n\nlong wait_iff_congested(int sync, long timeout)\n{\n\tlong ret;\n\tunsigned long start = jiffies;\n\tDEFINE_WAIT(wait);\n\twait_queue_head_t *wqh = &congestion_wqh[sync];\n\n\t/*\n\t * If there is no congestion, yield if necessary instead\n\t * of sleeping on the congestion queue\n\t */\n\tif (atomic_read(&nr_wb_congested[sync]) == 0) {\n\t\tcond_resched();\n\n\t\t/* In case we scheduled, work out time remaining */\n\t\tret = timeout - (jiffies - start);\n\t\tif (ret < 0)\n\t\t\tret = 0;\n\n\t\tgoto out;\n\t}\n\n\t/* Sleep until uncongested or a write happens */\n\tprepare_to_wait(wqh, &wait, TASK_UNINTERRUPTIBLE);\n\tret = io_schedule_timeout(timeout);\n\tfinish_wait(wqh, &wait);\n\nout:\n\ttrace_writeback_wait_iff_congested(jiffies_to_usecs(timeout),\n\t\t\t\t\tjiffies_to_usecs(jiffies - start));\n\n\treturn ret;\n}"
  },
  {
    "function_name": "congestion_wait",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "1016-1031",
    "snippet": "long congestion_wait(int sync, long timeout)\n{\n\tlong ret;\n\tunsigned long start = jiffies;\n\tDEFINE_WAIT(wait);\n\twait_queue_head_t *wqh = &congestion_wqh[sync];\n\n\tprepare_to_wait(wqh, &wait, TASK_UNINTERRUPTIBLE);\n\tret = io_schedule_timeout(timeout);\n\tfinish_wait(wqh, &wait);\n\n\ttrace_writeback_congestion_wait(jiffies_to_usecs(timeout),\n\t\t\t\t\tjiffies_to_usecs(jiffies - start));\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static wait_queue_head_t congestion_wqh[2] = {\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[0]),\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[1])\n\t};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_writeback_congestion_wait",
          "args": [
            "jiffies_to_usecs(timeout)",
            "jiffies_to_usecs(jiffies - start)"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jiffies_to_usecs",
          "args": [
            "jiffies - start"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jiffies_to_usecs",
          "args": [
            "timeout"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "finish_wait",
          "args": [
            "wqh",
            "&wait"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "io_schedule_timeout",
          "args": [
            "timeout"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prepare_to_wait",
          "args": [
            "wqh",
            "&wait",
            "TASK_UNINTERRUPTIBLE"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEFINE_WAIT",
          "args": [
            "wait"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic wait_queue_head_t congestion_wqh[2] = {\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[0]),\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[1])\n\t};\n\nlong congestion_wait(int sync, long timeout)\n{\n\tlong ret;\n\tunsigned long start = jiffies;\n\tDEFINE_WAIT(wait);\n\twait_queue_head_t *wqh = &congestion_wqh[sync];\n\n\tprepare_to_wait(wqh, &wait, TASK_UNINTERRUPTIBLE);\n\tret = io_schedule_timeout(timeout);\n\tfinish_wait(wqh, &wait);\n\n\ttrace_writeback_congestion_wait(jiffies_to_usecs(timeout),\n\t\t\t\t\tjiffies_to_usecs(jiffies - start));\n\n\treturn ret;\n}"
  },
  {
    "function_name": "set_wb_congested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "997-1004",
    "snippet": "void set_wb_congested(struct bdi_writeback_congested *congested, int sync)\n{\n\tenum wb_congested_state bit;\n\n\tbit = sync ? WB_sync_congested : WB_async_congested;\n\tif (!test_and_set_bit(bit, &congested->state))\n\t\tatomic_inc(&nr_wb_congested[sync]);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static atomic_t nr_wb_congested[2];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&nr_wb_congested[sync]"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_set_bit",
          "args": [
            "bit",
            "&congested->state"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic atomic_t nr_wb_congested[2];\n\nvoid set_wb_congested(struct bdi_writeback_congested *congested, int sync)\n{\n\tenum wb_congested_state bit;\n\n\tbit = sync ? WB_sync_congested : WB_async_congested;\n\tif (!test_and_set_bit(bit, &congested->state))\n\t\tatomic_inc(&nr_wb_congested[sync]);\n}"
  },
  {
    "function_name": "clear_wb_congested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "983-994",
    "snippet": "void clear_wb_congested(struct bdi_writeback_congested *congested, int sync)\n{\n\twait_queue_head_t *wqh = &congestion_wqh[sync];\n\tenum wb_congested_state bit;\n\n\tbit = sync ? WB_sync_congested : WB_async_congested;\n\tif (test_and_clear_bit(bit, &congested->state))\n\t\tatomic_dec(&nr_wb_congested[sync]);\n\tsmp_mb__after_atomic();\n\tif (waitqueue_active(wqh))\n\t\twake_up(wqh);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static wait_queue_head_t congestion_wqh[2] = {\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[0]),\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[1])\n\t};",
      "static atomic_t nr_wb_congested[2];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up",
          "args": [
            "wqh"
          ],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "waitqueue_active",
          "args": [
            "wqh"
          ],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_mb__after_atomic",
          "args": [],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&nr_wb_congested[sync]"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "bit",
            "&congested->state"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic wait_queue_head_t congestion_wqh[2] = {\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[0]),\n\t\t__WAIT_QUEUE_HEAD_INITIALIZER(congestion_wqh[1])\n\t};\nstatic atomic_t nr_wb_congested[2];\n\nvoid clear_wb_congested(struct bdi_writeback_congested *congested, int sync)\n{\n\twait_queue_head_t *wqh = &congestion_wqh[sync];\n\tenum wb_congested_state bit;\n\n\tbit = sync ? WB_sync_congested : WB_async_congested;\n\tif (test_and_clear_bit(bit, &congested->state))\n\t\tatomic_dec(&nr_wb_congested[sync]);\n\tsmp_mb__after_atomic();\n\tif (waitqueue_active(wqh))\n\t\twake_up(wqh);\n}"
  },
  {
    "function_name": "bdi_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "971-974",
    "snippet": "void bdi_put(struct backing_dev_info *bdi)\n{\n\tkref_put(&bdi->refcnt, release_bdi);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&bdi->refcnt",
            "release_bdi"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nvoid bdi_put(struct backing_dev_info *bdi)\n{\n\tkref_put(&bdi->refcnt, release_bdi);\n}"
  },
  {
    "function_name": "release_bdi",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "958-969",
    "snippet": "static void release_bdi(struct kref *ref)\n{\n\tstruct backing_dev_info *bdi =\n\t\t\tcontainer_of(ref, struct backing_dev_info, refcnt);\n\n\tif (test_bit(WB_registered, &bdi->wb.state))\n\t\tbdi_unregister(bdi);\n\tWARN_ON_ONCE(bdi->dev);\n\twb_exit(&bdi->wb);\n\tcgwb_bdi_exit(bdi);\n\tkfree(bdi);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "bdi"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cgwb_bdi_exit",
          "args": [
            "bdi"
          ],
          "line": 967
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_bdi_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "821-824",
          "snippet": "static void cgwb_bdi_exit(struct backing_dev_info *bdi)\n{\n\twb_congested_put(bdi->wb_congested);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void cgwb_bdi_exit(struct backing_dev_info *bdi)\n{\n\twb_congested_put(bdi->wb_congested);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wb_exit",
          "args": [
            "&bdi->wb"
          ],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "wb_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "377-390",
          "snippet": "static void wb_exit(struct bdi_writeback *wb)\n{\n\tint i;\n\n\tWARN_ON(delayed_work_pending(&wb->dwork));\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\n\tfprop_local_destroy_percpu(&wb->completions);\n\twb_congested_put(wb->congested);\n\tif (wb != &wb->bdi->wb)\n\t\tbdi_put(wb->bdi);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void wb_exit(struct bdi_writeback *wb)\n{\n\tint i;\n\n\tWARN_ON(delayed_work_pending(&wb->dwork));\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\n\tfprop_local_destroy_percpu(&wb->completions);\n\twb_congested_put(wb->congested);\n\tif (wb != &wb->bdi->wb)\n\t\tbdi_put(wb->bdi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "bdi->dev"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdi_unregister",
          "args": [
            "bdi"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "939-956",
          "snippet": "void bdi_unregister(struct backing_dev_info *bdi)\n{\n\t/* make sure nobody finds us on the bdi_list anymore */\n\tbdi_remove_from_list(bdi);\n\twb_shutdown(&bdi->wb);\n\tcgwb_bdi_unregister(bdi);\n\n\tif (bdi->dev) {\n\t\tbdi_debug_unregister(bdi);\n\t\tdevice_unregister(bdi->dev);\n\t\tbdi->dev = NULL;\n\t}\n\n\tif (bdi->owner) {\n\t\tput_device(bdi->owner);\n\t\tbdi->owner = NULL;\n\t}\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nvoid bdi_unregister(struct backing_dev_info *bdi)\n{\n\t/* make sure nobody finds us on the bdi_list anymore */\n\tbdi_remove_from_list(bdi);\n\twb_shutdown(&bdi->wb);\n\tcgwb_bdi_unregister(bdi);\n\n\tif (bdi->dev) {\n\t\tbdi_debug_unregister(bdi);\n\t\tdevice_unregister(bdi->dev);\n\t\tbdi->dev = NULL;\n\t}\n\n\tif (bdi->owner) {\n\t\tput_device(bdi->owner);\n\t\tbdi->owner = NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "WB_registered",
            "&bdi->wb.state"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ref",
            "structbacking_dev_info",
            "refcnt"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void release_bdi(struct kref *ref)\n{\n\tstruct backing_dev_info *bdi =\n\t\t\tcontainer_of(ref, struct backing_dev_info, refcnt);\n\n\tif (test_bit(WB_registered, &bdi->wb.state))\n\t\tbdi_unregister(bdi);\n\tWARN_ON_ONCE(bdi->dev);\n\twb_exit(&bdi->wb);\n\tcgwb_bdi_exit(bdi);\n\tkfree(bdi);\n}"
  },
  {
    "function_name": "bdi_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "939-956",
    "snippet": "void bdi_unregister(struct backing_dev_info *bdi)\n{\n\t/* make sure nobody finds us on the bdi_list anymore */\n\tbdi_remove_from_list(bdi);\n\twb_shutdown(&bdi->wb);\n\tcgwb_bdi_unregister(bdi);\n\n\tif (bdi->dev) {\n\t\tbdi_debug_unregister(bdi);\n\t\tdevice_unregister(bdi->dev);\n\t\tbdi->dev = NULL;\n\t}\n\n\tif (bdi->owner) {\n\t\tput_device(bdi->owner);\n\t\tbdi->owner = NULL;\n\t}\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_device",
          "args": [
            "bdi->owner"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_unregister",
          "args": [
            "bdi->dev"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdi_debug_unregister",
          "args": [
            "bdi"
          ],
          "line": 947
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_debug_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "139-141",
          "snippet": "static inline void bdi_debug_unregister(struct backing_dev_info *bdi)\n{\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic inline void bdi_debug_unregister(struct backing_dev_info *bdi)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "cgwb_bdi_unregister",
          "args": [
            "bdi"
          ],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_bdi_unregister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "819-819",
          "snippet": "static void cgwb_bdi_unregister(struct backing_dev_info *bdi) { }",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void cgwb_bdi_unregister(struct backing_dev_info *bdi) { }"
        }
      },
      {
        "call_info": {
          "callee": "wb_shutdown",
          "args": [
            "&bdi->wb"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "wb_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "356-375",
          "snippet": "static void wb_shutdown(struct bdi_writeback *wb)\n{\n\t/* Make sure nobody queues further work */\n\tspin_lock_bh(&wb->work_lock);\n\tif (!test_and_clear_bit(WB_registered, &wb->state)) {\n\t\tspin_unlock_bh(&wb->work_lock);\n\t\treturn;\n\t}\n\tspin_unlock_bh(&wb->work_lock);\n\n\tcgwb_remove_from_bdi_list(wb);\n\t/*\n\t * Drain work list and shutdown the delayed_work.  !WB_registered\n\t * tells wb_workfn() that @wb is dying and its work_list needs to\n\t * be drained no matter what.\n\t */\n\tmod_delayed_work(bdi_wq, &wb->dwork, 0);\n\tflush_delayed_work(&wb->dwork);\n\tWARN_ON(!list_empty(&wb->work_list));\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct workqueue_struct *bdi_wq;",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstruct workqueue_struct *bdi_wq;\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void wb_shutdown(struct bdi_writeback *wb)\n{\n\t/* Make sure nobody queues further work */\n\tspin_lock_bh(&wb->work_lock);\n\tif (!test_and_clear_bit(WB_registered, &wb->state)) {\n\t\tspin_unlock_bh(&wb->work_lock);\n\t\treturn;\n\t}\n\tspin_unlock_bh(&wb->work_lock);\n\n\tcgwb_remove_from_bdi_list(wb);\n\t/*\n\t * Drain work list and shutdown the delayed_work.  !WB_registered\n\t * tells wb_workfn() that @wb is dying and its work_list needs to\n\t * be drained no matter what.\n\t */\n\tmod_delayed_work(bdi_wq, &wb->dwork, 0);\n\tflush_delayed_work(&wb->dwork);\n\tWARN_ON(!list_empty(&wb->work_list));\n}"
        }
      },
      {
        "call_info": {
          "callee": "bdi_remove_from_list",
          "args": [
            "bdi"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_remove_from_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "930-937",
          "snippet": "static void bdi_remove_from_list(struct backing_dev_info *bdi)\n{\n\tspin_lock_bh(&bdi_lock);\n\tlist_del_rcu(&bdi->bdi_list);\n\tspin_unlock_bh(&bdi_lock);\n\n\tsynchronize_rcu_expedited();\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void bdi_remove_from_list(struct backing_dev_info *bdi)\n{\n\tspin_lock_bh(&bdi_lock);\n\tlist_del_rcu(&bdi->bdi_list);\n\tspin_unlock_bh(&bdi_lock);\n\n\tsynchronize_rcu_expedited();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nvoid bdi_unregister(struct backing_dev_info *bdi)\n{\n\t/* make sure nobody finds us on the bdi_list anymore */\n\tbdi_remove_from_list(bdi);\n\twb_shutdown(&bdi->wb);\n\tcgwb_bdi_unregister(bdi);\n\n\tif (bdi->dev) {\n\t\tbdi_debug_unregister(bdi);\n\t\tdevice_unregister(bdi->dev);\n\t\tbdi->dev = NULL;\n\t}\n\n\tif (bdi->owner) {\n\t\tput_device(bdi->owner);\n\t\tbdi->owner = NULL;\n\t}\n}"
  },
  {
    "function_name": "bdi_remove_from_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "930-937",
    "snippet": "static void bdi_remove_from_list(struct backing_dev_info *bdi)\n{\n\tspin_lock_bh(&bdi_lock);\n\tlist_del_rcu(&bdi->bdi_list);\n\tspin_unlock_bh(&bdi_lock);\n\n\tsynchronize_rcu_expedited();\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "synchronize_rcu_expedited",
          "args": [],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_bh",
          "args": [
            "&bdi_lock"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&bdi->bdi_list"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_bh",
          "args": [
            "&bdi_lock"
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void bdi_remove_from_list(struct backing_dev_info *bdi)\n{\n\tspin_lock_bh(&bdi_lock);\n\tlist_del_rcu(&bdi->bdi_list);\n\tspin_unlock_bh(&bdi_lock);\n\n\tsynchronize_rcu_expedited();\n}"
  },
  {
    "function_name": "bdi_register_owner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "912-924",
    "snippet": "int bdi_register_owner(struct backing_dev_info *bdi, struct device *owner)\n{\n\tint rc;\n\n\trc = bdi_register(bdi, \"%u:%u\", MAJOR(owner->devt), MINOR(owner->devt));\n\tif (rc)\n\t\treturn rc;\n\t/* Leaking owner reference... */\n\tWARN_ON(bdi->owner);\n\tbdi->owner = owner;\n\tget_device(owner);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_device",
          "args": [
            "owner"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "bdi->owner"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdi_register",
          "args": [
            "bdi",
            "\"%u:%u\"",
            "MAJOR(owner->devt)",
            "MINOR(owner->devt)"
          ],
          "line": 916
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "900-909",
          "snippet": "int bdi_register(struct backing_dev_info *bdi, const char *fmt, ...)\n{\n\tva_list args;\n\tint ret;\n\n\tva_start(args, fmt);\n\tret = bdi_register_va(bdi, fmt, args);\n\tva_end(args);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nint bdi_register(struct backing_dev_info *bdi, const char *fmt, ...)\n{\n\tva_list args;\n\tint ret;\n\n\tva_start(args, fmt);\n\tret = bdi_register_va(bdi, fmt, args);\n\tva_end(args);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "owner->devt"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "owner->devt"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nint bdi_register_owner(struct backing_dev_info *bdi, struct device *owner)\n{\n\tint rc;\n\n\trc = bdi_register(bdi, \"%u:%u\", MAJOR(owner->devt), MINOR(owner->devt));\n\tif (rc)\n\t\treturn rc;\n\t/* Leaking owner reference... */\n\tWARN_ON(bdi->owner);\n\tbdi->owner = owner;\n\tget_device(owner);\n\treturn 0;\n}"
  },
  {
    "function_name": "bdi_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "900-909",
    "snippet": "int bdi_register(struct backing_dev_info *bdi, const char *fmt, ...)\n{\n\tva_list args;\n\tint ret;\n\n\tva_start(args, fmt);\n\tret = bdi_register_va(bdi, fmt, args);\n\tva_end(args);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdi_register_va",
          "args": [
            "bdi",
            "fmt",
            "args"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_register_va",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "874-897",
          "snippet": "int bdi_register_va(struct backing_dev_info *bdi, const char *fmt, va_list args)\n{\n\tstruct device *dev;\n\n\tif (bdi->dev)\t/* The driver needs to use separate queues per device */\n\t\treturn 0;\n\n\tdev = device_create_vargs(bdi_class, NULL, MKDEV(0, 0), bdi, fmt, args);\n\tif (IS_ERR(dev))\n\t\treturn PTR_ERR(dev);\n\n\tcgwb_bdi_register(bdi);\n\tbdi->dev = dev;\n\n\tbdi_debug_register(bdi, dev_name(dev));\n\tset_bit(WB_registered, &bdi->wb.state);\n\n\tspin_lock_bh(&bdi_lock);\n\tlist_add_tail_rcu(&bdi->bdi_list, &bdi_list);\n\tspin_unlock_bh(&bdi_lock);\n\n\ttrace_writeback_bdi_register(bdi);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct class *bdi_class;",
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic struct class *bdi_class;\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nint bdi_register_va(struct backing_dev_info *bdi, const char *fmt, va_list args)\n{\n\tstruct device *dev;\n\n\tif (bdi->dev)\t/* The driver needs to use separate queues per device */\n\t\treturn 0;\n\n\tdev = device_create_vargs(bdi_class, NULL, MKDEV(0, 0), bdi, fmt, args);\n\tif (IS_ERR(dev))\n\t\treturn PTR_ERR(dev);\n\n\tcgwb_bdi_register(bdi);\n\tbdi->dev = dev;\n\n\tbdi_debug_register(bdi, dev_name(dev));\n\tset_bit(WB_registered, &bdi->wb.state);\n\n\tspin_lock_bh(&bdi_lock);\n\tlist_add_tail_rcu(&bdi->bdi_list, &bdi_list);\n\tspin_unlock_bh(&bdi_lock);\n\n\ttrace_writeback_bdi_register(bdi);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nint bdi_register(struct backing_dev_info *bdi, const char *fmt, ...)\n{\n\tva_list args;\n\tint ret;\n\n\tva_start(args, fmt);\n\tret = bdi_register_va(bdi, fmt, args);\n\tva_end(args);\n\treturn ret;\n}"
  },
  {
    "function_name": "bdi_register_va",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "874-897",
    "snippet": "int bdi_register_va(struct backing_dev_info *bdi, const char *fmt, va_list args)\n{\n\tstruct device *dev;\n\n\tif (bdi->dev)\t/* The driver needs to use separate queues per device */\n\t\treturn 0;\n\n\tdev = device_create_vargs(bdi_class, NULL, MKDEV(0, 0), bdi, fmt, args);\n\tif (IS_ERR(dev))\n\t\treturn PTR_ERR(dev);\n\n\tcgwb_bdi_register(bdi);\n\tbdi->dev = dev;\n\n\tbdi_debug_register(bdi, dev_name(dev));\n\tset_bit(WB_registered, &bdi->wb.state);\n\n\tspin_lock_bh(&bdi_lock);\n\tlist_add_tail_rcu(&bdi->bdi_list, &bdi_list);\n\tspin_unlock_bh(&bdi_lock);\n\n\ttrace_writeback_bdi_register(bdi);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct class *bdi_class;",
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_writeback_bdi_register",
          "args": [
            "bdi"
          ],
          "line": 895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_bh",
          "args": [
            "&bdi_lock"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail_rcu",
          "args": [
            "&bdi->bdi_list",
            "&bdi_list"
          ],
          "line": 892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_bh",
          "args": [
            "&bdi_lock"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "WB_registered",
            "&bdi->wb.state"
          ],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdi_debug_register",
          "args": [
            "bdi",
            "dev_name(dev)"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_debug_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "134-138",
          "snippet": "static inline int bdi_debug_register(struct backing_dev_info *bdi,\n\t\t\t\t      const char *name)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic inline int bdi_debug_register(struct backing_dev_info *bdi,\n\t\t\t\t      const char *name)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dev_name",
          "args": [
            "dev"
          ],
          "line": 888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cgwb_bdi_register",
          "args": [
            "bdi"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_bdi_register",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "826-829",
          "snippet": "static void cgwb_bdi_register(struct backing_dev_info *bdi)\n{\n\tlist_add_tail_rcu(&bdi->wb.bdi_node, &bdi->wb_list);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_bdi_register(struct backing_dev_info *bdi)\n{\n\tlist_add_tail_rcu(&bdi->wb.bdi_node, &bdi->wb_list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "dev"
          ],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "dev"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "device_create_vargs",
          "args": [
            "bdi_class",
            "NULL",
            "MKDEV(0, 0)",
            "bdi",
            "fmt",
            "args"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MKDEV",
          "args": [
            "0",
            "0"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic struct class *bdi_class;\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nint bdi_register_va(struct backing_dev_info *bdi, const char *fmt, va_list args)\n{\n\tstruct device *dev;\n\n\tif (bdi->dev)\t/* The driver needs to use separate queues per device */\n\t\treturn 0;\n\n\tdev = device_create_vargs(bdi_class, NULL, MKDEV(0, 0), bdi, fmt, args);\n\tif (IS_ERR(dev))\n\t\treturn PTR_ERR(dev);\n\n\tcgwb_bdi_register(bdi);\n\tbdi->dev = dev;\n\n\tbdi_debug_register(bdi, dev_name(dev));\n\tset_bit(WB_registered, &bdi->wb.state);\n\n\tspin_lock_bh(&bdi_lock);\n\tlist_add_tail_rcu(&bdi->bdi_list, &bdi_list);\n\tspin_unlock_bh(&bdi_lock);\n\n\ttrace_writeback_bdi_register(bdi);\n\treturn 0;\n}"
  },
  {
    "function_name": "bdi_alloc_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "857-871",
    "snippet": "struct backing_dev_info *bdi_alloc_node(gfp_t gfp_mask, int node_id)\n{\n\tstruct backing_dev_info *bdi;\n\n\tbdi = kmalloc_node(sizeof(struct backing_dev_info),\n\t\t\t   gfp_mask | __GFP_ZERO, node_id);\n\tif (!bdi)\n\t\treturn NULL;\n\n\tif (bdi_init(bdi)) {\n\t\tkfree(bdi);\n\t\treturn NULL;\n\t}\n\treturn bdi;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "bdi"
          ],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bdi_init",
          "args": [
            "bdi"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "838-855",
          "snippet": "static int bdi_init(struct backing_dev_info *bdi)\n{\n\tint ret;\n\n\tbdi->dev = NULL;\n\n\tkref_init(&bdi->refcnt);\n\tbdi->min_ratio = 0;\n\tbdi->max_ratio = 100;\n\tbdi->max_prop_frac = FPROP_FRAC_BASE;\n\tINIT_LIST_HEAD(&bdi->bdi_list);\n\tINIT_LIST_HEAD(&bdi->wb_list);\n\tinit_waitqueue_head(&bdi->wb_waitq);\n\n\tret = cgwb_bdi_init(bdi);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic int bdi_init(struct backing_dev_info *bdi)\n{\n\tint ret;\n\n\tbdi->dev = NULL;\n\n\tkref_init(&bdi->refcnt);\n\tbdi->min_ratio = 0;\n\tbdi->max_ratio = 100;\n\tbdi->max_prop_frac = FPROP_FRAC_BASE;\n\tINIT_LIST_HEAD(&bdi->bdi_list);\n\tINIT_LIST_HEAD(&bdi->wb_list);\n\tinit_waitqueue_head(&bdi->wb_waitq);\n\n\tret = cgwb_bdi_init(bdi);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc_node",
          "args": [
            "sizeof(struct backing_dev_info)",
            "gfp_mask | __GFP_ZERO",
            "node_id"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "__kmalloc_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3689-3692",
          "snippet": "void *__kmalloc_node(size_t size, gfp_t flags, int node)\n{\n\treturn __do_kmalloc_node(size, flags, node, _RET_IP_);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nvoid *__kmalloc_node(size_t size, gfp_t flags, int node)\n{\n\treturn __do_kmalloc_node(size, flags, node, _RET_IP_);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstruct backing_dev_info *bdi_alloc_node(gfp_t gfp_mask, int node_id)\n{\n\tstruct backing_dev_info *bdi;\n\n\tbdi = kmalloc_node(sizeof(struct backing_dev_info),\n\t\t\t   gfp_mask | __GFP_ZERO, node_id);\n\tif (!bdi)\n\t\treturn NULL;\n\n\tif (bdi_init(bdi)) {\n\t\tkfree(bdi);\n\t\treturn NULL;\n\t}\n\treturn bdi;\n}"
  },
  {
    "function_name": "bdi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "838-855",
    "snippet": "static int bdi_init(struct backing_dev_info *bdi)\n{\n\tint ret;\n\n\tbdi->dev = NULL;\n\n\tkref_init(&bdi->refcnt);\n\tbdi->min_ratio = 0;\n\tbdi->max_ratio = 100;\n\tbdi->max_prop_frac = FPROP_FRAC_BASE;\n\tINIT_LIST_HEAD(&bdi->bdi_list);\n\tINIT_LIST_HEAD(&bdi->wb_list);\n\tinit_waitqueue_head(&bdi->wb_waitq);\n\n\tret = cgwb_bdi_init(bdi);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cgwb_bdi_init",
          "args": [
            "bdi"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_bdi_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "801-817",
          "snippet": "static int cgwb_bdi_init(struct backing_dev_info *bdi)\n{\n\tint err;\n\n\tbdi->wb_congested = kzalloc(sizeof(*bdi->wb_congested), GFP_KERNEL);\n\tif (!bdi->wb_congested)\n\t\treturn -ENOMEM;\n\n\trefcount_set(&bdi->wb_congested->refcnt, 1);\n\n\terr = wb_init(&bdi->wb, bdi, 1, GFP_KERNEL);\n\tif (err) {\n\t\twb_congested_put(bdi->wb_congested);\n\t\treturn err;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int cgwb_bdi_init(struct backing_dev_info *bdi)\n{\n\tint err;\n\n\tbdi->wb_congested = kzalloc(sizeof(*bdi->wb_congested), GFP_KERNEL);\n\tif (!bdi->wb_congested)\n\t\treturn -ENOMEM;\n\n\trefcount_set(&bdi->wb_congested->refcnt, 1);\n\n\terr = wb_init(&bdi->wb, bdi, 1, GFP_KERNEL);\n\tif (err) {\n\t\twb_congested_put(bdi->wb_congested);\n\t\treturn err;\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "init_waitqueue_head",
          "args": [
            "&bdi->wb_waitq"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&bdi->wb_list"
          ],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&bdi->bdi_list"
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kref_init",
          "args": [
            "&bdi->refcnt"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic int bdi_init(struct backing_dev_info *bdi)\n{\n\tint ret;\n\n\tbdi->dev = NULL;\n\n\tkref_init(&bdi->refcnt);\n\tbdi->min_ratio = 0;\n\tbdi->max_ratio = 100;\n\tbdi->max_prop_frac = FPROP_FRAC_BASE;\n\tINIT_LIST_HEAD(&bdi->bdi_list);\n\tINIT_LIST_HEAD(&bdi->wb_list);\n\tinit_waitqueue_head(&bdi->wb_waitq);\n\n\tret = cgwb_bdi_init(bdi);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "cgwb_remove_from_bdi_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "831-834",
    "snippet": "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb)\n{\n\tlist_del_rcu(&wb->bdi_node);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&wb->bdi_node"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb)\n{\n\tlist_del_rcu(&wb->bdi_node);\n}"
  },
  {
    "function_name": "cgwb_bdi_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "826-829",
    "snippet": "static void cgwb_bdi_register(struct backing_dev_info *bdi)\n{\n\tlist_add_tail_rcu(&bdi->wb.bdi_node, &bdi->wb_list);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail_rcu",
          "args": [
            "&bdi->wb.bdi_node",
            "&bdi->wb_list"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_bdi_register(struct backing_dev_info *bdi)\n{\n\tlist_add_tail_rcu(&bdi->wb.bdi_node, &bdi->wb_list);\n}"
  },
  {
    "function_name": "cgwb_bdi_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "821-824",
    "snippet": "static void cgwb_bdi_exit(struct backing_dev_info *bdi)\n{\n\twb_congested_put(bdi->wb_congested);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wb_congested_put",
          "args": [
            "bdi->wb_congested"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "wb_congested_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "472-488",
          "snippet": "void wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nvoid wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void cgwb_bdi_exit(struct backing_dev_info *bdi)\n{\n\twb_congested_put(bdi->wb_congested);\n}"
  },
  {
    "function_name": "cgwb_bdi_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "819-819",
    "snippet": "static void cgwb_bdi_unregister(struct backing_dev_info *bdi) { }",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void cgwb_bdi_unregister(struct backing_dev_info *bdi) { }"
  },
  {
    "function_name": "cgwb_bdi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "801-817",
    "snippet": "static int cgwb_bdi_init(struct backing_dev_info *bdi)\n{\n\tint err;\n\n\tbdi->wb_congested = kzalloc(sizeof(*bdi->wb_congested), GFP_KERNEL);\n\tif (!bdi->wb_congested)\n\t\treturn -ENOMEM;\n\n\trefcount_set(&bdi->wb_congested->refcnt, 1);\n\n\terr = wb_init(&bdi->wb, bdi, 1, GFP_KERNEL);\n\tif (err) {\n\t\twb_congested_put(bdi->wb_congested);\n\t\treturn err;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wb_congested_put",
          "args": [
            "bdi->wb_congested"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "wb_congested_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "472-488",
          "snippet": "void wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nvoid wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wb_init",
          "args": [
            "&bdi->wb",
            "bdi",
            "1",
            "GFP_KERNEL"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "wb_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "293-349",
          "snippet": "static int wb_init(struct bdi_writeback *wb, struct backing_dev_info *bdi,\n\t\t   int blkcg_id, gfp_t gfp)\n{\n\tint i, err;\n\n\tmemset(wb, 0, sizeof(*wb));\n\n\tif (wb != &bdi->wb)\n\t\tbdi_get(bdi);\n\twb->bdi = bdi;\n\twb->last_old_flush = jiffies;\n\tINIT_LIST_HEAD(&wb->b_dirty);\n\tINIT_LIST_HEAD(&wb->b_io);\n\tINIT_LIST_HEAD(&wb->b_more_io);\n\tINIT_LIST_HEAD(&wb->b_dirty_time);\n\tspin_lock_init(&wb->list_lock);\n\n\twb->bw_time_stamp = jiffies;\n\twb->balanced_dirty_ratelimit = INIT_BW;\n\twb->dirty_ratelimit = INIT_BW;\n\twb->write_bandwidth = INIT_BW;\n\twb->avg_write_bandwidth = INIT_BW;\n\n\tspin_lock_init(&wb->work_lock);\n\tINIT_LIST_HEAD(&wb->work_list);\n\tINIT_DELAYED_WORK(&wb->dwork, wb_workfn);\n\twb->dirty_sleep = jiffies;\n\n\twb->congested = wb_congested_get_create(bdi, blkcg_id, gfp);\n\tif (!wb->congested) {\n\t\terr = -ENOMEM;\n\t\tgoto out_put_bdi;\n\t}\n\n\terr = fprop_local_init_percpu(&wb->completions, gfp);\n\tif (err)\n\t\tgoto out_put_cong;\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++) {\n\t\terr = percpu_counter_init(&wb->stat[i], 0, gfp);\n\t\tif (err)\n\t\t\tgoto out_destroy_stat;\n\t}\n\n\treturn 0;\n\nout_destroy_stat:\n\twhile (i--)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\tfprop_local_destroy_percpu(&wb->completions);\nout_put_cong:\n\twb_congested_put(wb->congested);\nout_put_bdi:\n\tif (wb != &bdi->wb)\n\t\tbdi_put(bdi);\n\treturn err;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [
            "#define INIT_BW\t\t(100 << (20 - PAGE_SHIFT))"
          ],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\n#define INIT_BW\t\t(100 << (20 - PAGE_SHIFT))\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int wb_init(struct bdi_writeback *wb, struct backing_dev_info *bdi,\n\t\t   int blkcg_id, gfp_t gfp)\n{\n\tint i, err;\n\n\tmemset(wb, 0, sizeof(*wb));\n\n\tif (wb != &bdi->wb)\n\t\tbdi_get(bdi);\n\twb->bdi = bdi;\n\twb->last_old_flush = jiffies;\n\tINIT_LIST_HEAD(&wb->b_dirty);\n\tINIT_LIST_HEAD(&wb->b_io);\n\tINIT_LIST_HEAD(&wb->b_more_io);\n\tINIT_LIST_HEAD(&wb->b_dirty_time);\n\tspin_lock_init(&wb->list_lock);\n\n\twb->bw_time_stamp = jiffies;\n\twb->balanced_dirty_ratelimit = INIT_BW;\n\twb->dirty_ratelimit = INIT_BW;\n\twb->write_bandwidth = INIT_BW;\n\twb->avg_write_bandwidth = INIT_BW;\n\n\tspin_lock_init(&wb->work_lock);\n\tINIT_LIST_HEAD(&wb->work_list);\n\tINIT_DELAYED_WORK(&wb->dwork, wb_workfn);\n\twb->dirty_sleep = jiffies;\n\n\twb->congested = wb_congested_get_create(bdi, blkcg_id, gfp);\n\tif (!wb->congested) {\n\t\terr = -ENOMEM;\n\t\tgoto out_put_bdi;\n\t}\n\n\terr = fprop_local_init_percpu(&wb->completions, gfp);\n\tif (err)\n\t\tgoto out_put_cong;\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++) {\n\t\terr = percpu_counter_init(&wb->stat[i], 0, gfp);\n\t\tif (err)\n\t\t\tgoto out_destroy_stat;\n\t}\n\n\treturn 0;\n\nout_destroy_stat:\n\twhile (i--)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\tfprop_local_destroy_percpu(&wb->completions);\nout_put_cong:\n\twb_congested_put(wb->congested);\nout_put_bdi:\n\tif (wb != &bdi->wb)\n\t\tbdi_put(bdi);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "refcount_set",
          "args": [
            "&bdi->wb_congested->refcnt",
            "1"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*bdi->wb_congested)",
            "GFP_KERNEL"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int cgwb_bdi_init(struct backing_dev_info *bdi)\n{\n\tint err;\n\n\tbdi->wb_congested = kzalloc(sizeof(*bdi->wb_congested), GFP_KERNEL);\n\tif (!bdi->wb_congested)\n\t\treturn -ENOMEM;\n\n\trefcount_set(&bdi->wb_congested->refcnt, 1);\n\n\terr = wb_init(&bdi->wb, bdi, 1, GFP_KERNEL);\n\tif (err) {\n\t\twb_congested_put(bdi->wb_congested);\n\t\treturn err;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "cgwb_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "784-796",
    "snippet": "static int __init cgwb_init(void)\n{\n\t/*\n\t * There can be many concurrent release work items overwhelming\n\t * system_wq.  Put them in a separate wq and limit concurrency.\n\t * There's no point in executing many of these in parallel.\n\t */\n\tcgwb_release_wq = alloc_workqueue(\"cgwb_release\", 0, 1);\n\tif (!cgwb_release_wq)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"cgwb_release\"",
            "0",
            "1"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int __init cgwb_init(void)\n{\n\t/*\n\t * There can be many concurrent release work items overwhelming\n\t * system_wq.  Put them in a separate wq and limit concurrency.\n\t * There's no point in executing many of these in parallel.\n\t */\n\tcgwb_release_wq = alloc_workqueue(\"cgwb_release\", 0, 1);\n\tif (!cgwb_release_wq)\n\t\treturn -ENOMEM;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "cgwb_bdi_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "777-782",
    "snippet": "static void cgwb_bdi_register(struct backing_dev_info *bdi)\n{\n\tspin_lock_irq(&cgwb_lock);\n\tlist_add_tail_rcu(&bdi->wb.bdi_node, &bdi->wb_list);\n\tspin_unlock_irq(&cgwb_lock);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail_rcu",
          "args": [
            "&bdi->wb.bdi_node",
            "&bdi->wb_list"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_bdi_register(struct backing_dev_info *bdi)\n{\n\tspin_lock_irq(&cgwb_lock);\n\tlist_add_tail_rcu(&bdi->wb.bdi_node, &bdi->wb_list);\n\tspin_unlock_irq(&cgwb_lock);\n}"
  },
  {
    "function_name": "cgwb_bdi_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "762-775",
    "snippet": "static void cgwb_bdi_exit(struct backing_dev_info *bdi)\n{\n\tstruct rb_node *rbn;\n\n\tspin_lock_irq(&cgwb_lock);\n\twhile ((rbn = rb_first(&bdi->cgwb_congested_tree))) {\n\t\tstruct bdi_writeback_congested *congested =\n\t\t\trb_entry(rbn, struct bdi_writeback_congested, rb_node);\n\n\t\trb_erase(rbn, &bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\t/* mark @congested unlinked */\n\t}\n\tspin_unlock_irq(&cgwb_lock);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "rbn",
            "&bdi->cgwb_congested_tree"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "vma_rb_erase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mmap.c",
          "lines": "479-489",
          "snippet": "static __always_inline void vma_rb_erase(struct vm_area_struct *vma,\n\t\t\t\t\t struct rb_root *root)\n{\n\t/*\n\t * All rb_subtree_gap values must be consistent prior to erase,\n\t * with the possible exception of the vma being erased.\n\t */\n\tvalidate_mm_rb(root, vma);\n\n\t__vma_rb_erase(vma, root);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/mmu_context.h>",
            "#include <asm/tlb.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/oom.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/printk.h>",
            "#include <linux/memory.h>",
            "#include <linux/notifier.h>",
            "#include <linux/rbtree_augmented.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/audit.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/mmdebug.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/profile.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/init.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/shm.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/mmu_context.h>\n#include <asm/tlb.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/oom.h>\n#include <linux/pkeys.h>\n#include <linux/moduleparam.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/printk.h>\n#include <linux/memory.h>\n#include <linux/notifier.h>\n#include <linux/rbtree_augmented.h>\n#include <linux/uprobes.h>\n#include <linux/khugepaged.h>\n#include <linux/audit.h>\n#include <linux/perf_event.h>\n#include <linux/mmdebug.h>\n#include <linux/mmu_notifier.h>\n#include <linux/rmap.h>\n#include <linux/mempolicy.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/profile.h>\n#include <linux/shmem_fs.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/init.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/shm.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic __always_inline void vma_rb_erase(struct vm_area_struct *vma,\n\t\t\t\t\t struct rb_root *root)\n{\n\t/*\n\t * All rb_subtree_gap values must be consistent prior to erase,\n\t * with the possible exception of the vma being erased.\n\t */\n\tvalidate_mm_rb(root, vma);\n\n\t__vma_rb_erase(vma, root);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "rbn",
            "structbdi_writeback_congested",
            "rb_node"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_first",
          "args": [
            "&bdi->cgwb_congested_tree"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void cgwb_bdi_exit(struct backing_dev_info *bdi)\n{\n\tstruct rb_node *rbn;\n\n\tspin_lock_irq(&cgwb_lock);\n\twhile ((rbn = rb_first(&bdi->cgwb_congested_tree))) {\n\t\tstruct bdi_writeback_congested *congested =\n\t\t\trb_entry(rbn, struct bdi_writeback_congested, rb_node);\n\n\t\trb_erase(rbn, &bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\t/* mark @congested unlinked */\n\t}\n\tspin_unlock_irq(&cgwb_lock);\n}"
  },
  {
    "function_name": "wb_blkcg_offline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "751-760",
    "snippet": "void wb_blkcg_offline(struct blkcg *blkcg)\n{\n\tstruct bdi_writeback *wb, *next;\n\n\tspin_lock_irq(&cgwb_lock);\n\tlist_for_each_entry_safe(wb, next, &blkcg->cgwb_list, blkcg_node)\n\t\tcgwb_kill(wb);\n\tblkcg->cgwb_list.next = NULL;\t/* prevent new wb's */\n\tspin_unlock_irq(&cgwb_lock);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cgwb_kill",
          "args": [
            "wb"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_kill",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "519-527",
          "snippet": "static void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "wb",
            "next",
            "&blkcg->cgwb_list",
            "blkcg_node"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nvoid wb_blkcg_offline(struct blkcg *blkcg)\n{\n\tstruct bdi_writeback *wb, *next;\n\n\tspin_lock_irq(&cgwb_lock);\n\tlist_for_each_entry_safe(wb, next, &blkcg->cgwb_list, blkcg_node)\n\t\tcgwb_kill(wb);\n\tblkcg->cgwb_list.next = NULL;\t/* prevent new wb's */\n\tspin_unlock_irq(&cgwb_lock);\n}"
  },
  {
    "function_name": "wb_memcg_offline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "733-743",
    "snippet": "void wb_memcg_offline(struct mem_cgroup *memcg)\n{\n\tstruct list_head *memcg_cgwb_list = &memcg->cgwb_list;\n\tstruct bdi_writeback *wb, *next;\n\n\tspin_lock_irq(&cgwb_lock);\n\tlist_for_each_entry_safe(wb, next, memcg_cgwb_list, memcg_node)\n\t\tcgwb_kill(wb);\n\tmemcg_cgwb_list->next = NULL;\t/* prevent new wb's */\n\tspin_unlock_irq(&cgwb_lock);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cgwb_kill",
          "args": [
            "wb"
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_kill",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "519-527",
          "snippet": "static void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "wb",
            "next",
            "memcg_cgwb_list",
            "memcg_node"
          ],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nvoid wb_memcg_offline(struct mem_cgroup *memcg)\n{\n\tstruct list_head *memcg_cgwb_list = &memcg->cgwb_list;\n\tstruct bdi_writeback *wb, *next;\n\n\tspin_lock_irq(&cgwb_lock);\n\tlist_for_each_entry_safe(wb, next, memcg_cgwb_list, memcg_node)\n\t\tcgwb_kill(wb);\n\tmemcg_cgwb_list->next = NULL;\t/* prevent new wb's */\n\tspin_unlock_irq(&cgwb_lock);\n}"
  },
  {
    "function_name": "cgwb_bdi_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "701-725",
    "snippet": "static void cgwb_bdi_unregister(struct backing_dev_info *bdi)\n{\n\tstruct radix_tree_iter iter;\n\tvoid **slot;\n\tstruct bdi_writeback *wb;\n\n\tWARN_ON(test_bit(WB_registered, &bdi->wb.state));\n\n\tspin_lock_irq(&cgwb_lock);\n\tradix_tree_for_each_slot(slot, &bdi->cgwb_tree, &iter, 0)\n\t\tcgwb_kill(*slot);\n\tspin_unlock_irq(&cgwb_lock);\n\n\tmutex_lock(&bdi->cgwb_release_mutex);\n\tspin_lock_irq(&cgwb_lock);\n\twhile (!list_empty(&bdi->wb_list)) {\n\t\twb = list_first_entry(&bdi->wb_list, struct bdi_writeback,\n\t\t\t\t      bdi_node);\n\t\tspin_unlock_irq(&cgwb_lock);\n\t\twb_shutdown(wb);\n\t\tspin_lock_irq(&cgwb_lock);\n\t}\n\tspin_unlock_irq(&cgwb_lock);\n\tmutex_unlock(&bdi->cgwb_release_mutex);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&bdi->cgwb_release_mutex"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_shutdown",
          "args": [
            "wb"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "wb_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "356-375",
          "snippet": "static void wb_shutdown(struct bdi_writeback *wb)\n{\n\t/* Make sure nobody queues further work */\n\tspin_lock_bh(&wb->work_lock);\n\tif (!test_and_clear_bit(WB_registered, &wb->state)) {\n\t\tspin_unlock_bh(&wb->work_lock);\n\t\treturn;\n\t}\n\tspin_unlock_bh(&wb->work_lock);\n\n\tcgwb_remove_from_bdi_list(wb);\n\t/*\n\t * Drain work list and shutdown the delayed_work.  !WB_registered\n\t * tells wb_workfn() that @wb is dying and its work_list needs to\n\t * be drained no matter what.\n\t */\n\tmod_delayed_work(bdi_wq, &wb->dwork, 0);\n\tflush_delayed_work(&wb->dwork);\n\tWARN_ON(!list_empty(&wb->work_list));\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct workqueue_struct *bdi_wq;",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstruct workqueue_struct *bdi_wq;\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void wb_shutdown(struct bdi_writeback *wb)\n{\n\t/* Make sure nobody queues further work */\n\tspin_lock_bh(&wb->work_lock);\n\tif (!test_and_clear_bit(WB_registered, &wb->state)) {\n\t\tspin_unlock_bh(&wb->work_lock);\n\t\treturn;\n\t}\n\tspin_unlock_bh(&wb->work_lock);\n\n\tcgwb_remove_from_bdi_list(wb);\n\t/*\n\t * Drain work list and shutdown the delayed_work.  !WB_registered\n\t * tells wb_workfn() that @wb is dying and its work_list needs to\n\t * be drained no matter what.\n\t */\n\tmod_delayed_work(bdi_wq, &wb->dwork, 0);\n\tflush_delayed_work(&wb->dwork);\n\tWARN_ON(!list_empty(&wb->work_list));\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry",
          "args": [
            "&bdi->wb_list",
            "structbdi_writeback",
            "bdi_node"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&bdi->wb_list"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&bdi->cgwb_release_mutex"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cgwb_kill",
          "args": [
            "*slot"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_kill",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "519-527",
          "snippet": "static void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "radix_tree_for_each_slot",
          "args": [
            "slot",
            "&bdi->cgwb_tree",
            "&iter",
            "0"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "test_bit(WB_registered, &bdi->wb.state)"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "WB_registered",
            "&bdi->wb.state"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_bdi_unregister(struct backing_dev_info *bdi)\n{\n\tstruct radix_tree_iter iter;\n\tvoid **slot;\n\tstruct bdi_writeback *wb;\n\n\tWARN_ON(test_bit(WB_registered, &bdi->wb.state));\n\n\tspin_lock_irq(&cgwb_lock);\n\tradix_tree_for_each_slot(slot, &bdi->cgwb_tree, &iter, 0)\n\t\tcgwb_kill(*slot);\n\tspin_unlock_irq(&cgwb_lock);\n\n\tmutex_lock(&bdi->cgwb_release_mutex);\n\tspin_lock_irq(&cgwb_lock);\n\twhile (!list_empty(&bdi->wb_list)) {\n\t\twb = list_first_entry(&bdi->wb_list, struct bdi_writeback,\n\t\t\t\t      bdi_node);\n\t\tspin_unlock_irq(&cgwb_lock);\n\t\twb_shutdown(wb);\n\t\tspin_lock_irq(&cgwb_lock);\n\t}\n\tspin_unlock_irq(&cgwb_lock);\n\tmutex_unlock(&bdi->cgwb_release_mutex);\n}"
  },
  {
    "function_name": "cgwb_bdi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "685-699",
    "snippet": "static int cgwb_bdi_init(struct backing_dev_info *bdi)\n{\n\tint ret;\n\n\tINIT_RADIX_TREE(&bdi->cgwb_tree, GFP_ATOMIC);\n\tbdi->cgwb_congested_tree = RB_ROOT;\n\tmutex_init(&bdi->cgwb_release_mutex);\n\n\tret = wb_init(&bdi->wb, bdi, 1, GFP_KERNEL);\n\tif (!ret) {\n\t\tbdi->wb.memcg_css = &root_mem_cgroup->css;\n\t\tbdi->wb.blkcg_css = blkcg_root_css;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wb_init",
          "args": [
            "&bdi->wb",
            "bdi",
            "1",
            "GFP_KERNEL"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "wb_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "293-349",
          "snippet": "static int wb_init(struct bdi_writeback *wb, struct backing_dev_info *bdi,\n\t\t   int blkcg_id, gfp_t gfp)\n{\n\tint i, err;\n\n\tmemset(wb, 0, sizeof(*wb));\n\n\tif (wb != &bdi->wb)\n\t\tbdi_get(bdi);\n\twb->bdi = bdi;\n\twb->last_old_flush = jiffies;\n\tINIT_LIST_HEAD(&wb->b_dirty);\n\tINIT_LIST_HEAD(&wb->b_io);\n\tINIT_LIST_HEAD(&wb->b_more_io);\n\tINIT_LIST_HEAD(&wb->b_dirty_time);\n\tspin_lock_init(&wb->list_lock);\n\n\twb->bw_time_stamp = jiffies;\n\twb->balanced_dirty_ratelimit = INIT_BW;\n\twb->dirty_ratelimit = INIT_BW;\n\twb->write_bandwidth = INIT_BW;\n\twb->avg_write_bandwidth = INIT_BW;\n\n\tspin_lock_init(&wb->work_lock);\n\tINIT_LIST_HEAD(&wb->work_list);\n\tINIT_DELAYED_WORK(&wb->dwork, wb_workfn);\n\twb->dirty_sleep = jiffies;\n\n\twb->congested = wb_congested_get_create(bdi, blkcg_id, gfp);\n\tif (!wb->congested) {\n\t\terr = -ENOMEM;\n\t\tgoto out_put_bdi;\n\t}\n\n\terr = fprop_local_init_percpu(&wb->completions, gfp);\n\tif (err)\n\t\tgoto out_put_cong;\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++) {\n\t\terr = percpu_counter_init(&wb->stat[i], 0, gfp);\n\t\tif (err)\n\t\t\tgoto out_destroy_stat;\n\t}\n\n\treturn 0;\n\nout_destroy_stat:\n\twhile (i--)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\tfprop_local_destroy_percpu(&wb->completions);\nout_put_cong:\n\twb_congested_put(wb->congested);\nout_put_bdi:\n\tif (wb != &bdi->wb)\n\t\tbdi_put(bdi);\n\treturn err;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [
            "#define INIT_BW\t\t(100 << (20 - PAGE_SHIFT))"
          ],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\n#define INIT_BW\t\t(100 << (20 - PAGE_SHIFT))\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int wb_init(struct bdi_writeback *wb, struct backing_dev_info *bdi,\n\t\t   int blkcg_id, gfp_t gfp)\n{\n\tint i, err;\n\n\tmemset(wb, 0, sizeof(*wb));\n\n\tif (wb != &bdi->wb)\n\t\tbdi_get(bdi);\n\twb->bdi = bdi;\n\twb->last_old_flush = jiffies;\n\tINIT_LIST_HEAD(&wb->b_dirty);\n\tINIT_LIST_HEAD(&wb->b_io);\n\tINIT_LIST_HEAD(&wb->b_more_io);\n\tINIT_LIST_HEAD(&wb->b_dirty_time);\n\tspin_lock_init(&wb->list_lock);\n\n\twb->bw_time_stamp = jiffies;\n\twb->balanced_dirty_ratelimit = INIT_BW;\n\twb->dirty_ratelimit = INIT_BW;\n\twb->write_bandwidth = INIT_BW;\n\twb->avg_write_bandwidth = INIT_BW;\n\n\tspin_lock_init(&wb->work_lock);\n\tINIT_LIST_HEAD(&wb->work_list);\n\tINIT_DELAYED_WORK(&wb->dwork, wb_workfn);\n\twb->dirty_sleep = jiffies;\n\n\twb->congested = wb_congested_get_create(bdi, blkcg_id, gfp);\n\tif (!wb->congested) {\n\t\terr = -ENOMEM;\n\t\tgoto out_put_bdi;\n\t}\n\n\terr = fprop_local_init_percpu(&wb->completions, gfp);\n\tif (err)\n\t\tgoto out_put_cong;\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++) {\n\t\terr = percpu_counter_init(&wb->stat[i], 0, gfp);\n\t\tif (err)\n\t\t\tgoto out_destroy_stat;\n\t}\n\n\treturn 0;\n\nout_destroy_stat:\n\twhile (i--)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\tfprop_local_destroy_percpu(&wb->completions);\nout_put_cong:\n\twb_congested_put(wb->congested);\nout_put_bdi:\n\tif (wb != &bdi->wb)\n\t\tbdi_put(bdi);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&bdi->cgwb_release_mutex"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_RADIX_TREE",
          "args": [
            "&bdi->cgwb_tree",
            "GFP_ATOMIC"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int cgwb_bdi_init(struct backing_dev_info *bdi)\n{\n\tint ret;\n\n\tINIT_RADIX_TREE(&bdi->cgwb_tree, GFP_ATOMIC);\n\tbdi->cgwb_congested_tree = RB_ROOT;\n\tmutex_init(&bdi->cgwb_release_mutex);\n\n\tret = wb_init(&bdi->wb, bdi, 1, GFP_KERNEL);\n\tif (!ret) {\n\t\tbdi->wb.memcg_css = &root_mem_cgroup->css;\n\t\tbdi->wb.blkcg_css = blkcg_root_css;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "wb_get_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "654-683",
    "snippet": "struct bdi_writeback *wb_get_create(struct backing_dev_info *bdi,\n\t\t\t\t    struct cgroup_subsys_state *memcg_css,\n\t\t\t\t    gfp_t gfp)\n{\n\tstruct bdi_writeback *wb;\n\n\tmight_sleep_if(gfpflags_allow_blocking(gfp));\n\n\tif (!memcg_css->parent)\n\t\treturn &bdi->wb;\n\n\tdo {\n\t\trcu_read_lock();\n\t\twb = radix_tree_lookup(&bdi->cgwb_tree, memcg_css->id);\n\t\tif (wb) {\n\t\t\tstruct cgroup_subsys_state *blkcg_css;\n\n\t\t\t/* see whether the blkcg association has changed */\n\t\t\tblkcg_css = cgroup_get_e_css(memcg_css->cgroup,\n\t\t\t\t\t\t     &io_cgrp_subsys);\n\t\t\tif (unlikely(wb->blkcg_css != blkcg_css ||\n\t\t\t\t     !wb_tryget(wb)))\n\t\t\t\twb = NULL;\n\t\t\tcss_put(blkcg_css);\n\t\t}\n\t\trcu_read_unlock();\n\t} while (!wb && !cgwb_create(bdi, memcg_css, gfp));\n\n\treturn wb;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cgwb_create",
          "args": [
            "bdi",
            "memcg_css",
            "gfp"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "536-628",
          "snippet": "static int cgwb_create(struct backing_dev_info *bdi,\n\t\t       struct cgroup_subsys_state *memcg_css, gfp_t gfp)\n{\n\tstruct mem_cgroup *memcg;\n\tstruct cgroup_subsys_state *blkcg_css;\n\tstruct blkcg *blkcg;\n\tstruct list_head *memcg_cgwb_list, *blkcg_cgwb_list;\n\tstruct bdi_writeback *wb;\n\tunsigned long flags;\n\tint ret = 0;\n\n\tmemcg = mem_cgroup_from_css(memcg_css);\n\tblkcg_css = cgroup_get_e_css(memcg_css->cgroup, &io_cgrp_subsys);\n\tblkcg = css_to_blkcg(blkcg_css);\n\tmemcg_cgwb_list = &memcg->cgwb_list;\n\tblkcg_cgwb_list = &blkcg->cgwb_list;\n\n\t/* look up again under lock and discard on blkcg mismatch */\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\twb = radix_tree_lookup(&bdi->cgwb_tree, memcg_css->id);\n\tif (wb && wb->blkcg_css != blkcg_css) {\n\t\tcgwb_kill(wb);\n\t\twb = NULL;\n\t}\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tif (wb)\n\t\tgoto out_put;\n\n\t/* need to create a new one */\n\twb = kmalloc(sizeof(*wb), gfp);\n\tif (!wb) {\n\t\tret = -ENOMEM;\n\t\tgoto out_put;\n\t}\n\n\tret = wb_init(wb, bdi, blkcg_css->id, gfp);\n\tif (ret)\n\t\tgoto err_free;\n\n\tret = percpu_ref_init(&wb->refcnt, cgwb_release, 0, gfp);\n\tif (ret)\n\t\tgoto err_wb_exit;\n\n\tret = fprop_local_init_percpu(&wb->memcg_completions, gfp);\n\tif (ret)\n\t\tgoto err_ref_exit;\n\n\twb->memcg_css = memcg_css;\n\twb->blkcg_css = blkcg_css;\n\tINIT_WORK(&wb->release_work, cgwb_release_workfn);\n\tset_bit(WB_registered, &wb->state);\n\n\t/*\n\t * The root wb determines the registered state of the whole bdi and\n\t * memcg_cgwb_list and blkcg_cgwb_list's next pointers indicate\n\t * whether they're still online.  Don't link @wb if any is dead.\n\t * See wb_memcg_offline() and wb_blkcg_offline().\n\t */\n\tret = -ENODEV;\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\tif (test_bit(WB_registered, &bdi->wb.state) &&\n\t    blkcg_cgwb_list->next && memcg_cgwb_list->next) {\n\t\t/* we might have raced another instance of this function */\n\t\tret = radix_tree_insert(&bdi->cgwb_tree, memcg_css->id, wb);\n\t\tif (!ret) {\n\t\t\tlist_add_tail_rcu(&wb->bdi_node, &bdi->wb_list);\n\t\t\tlist_add(&wb->memcg_node, memcg_cgwb_list);\n\t\t\tlist_add(&wb->blkcg_node, blkcg_cgwb_list);\n\t\t\tblkcg_cgwb_get(blkcg);\n\t\t\tcss_get(memcg_css);\n\t\t\tcss_get(blkcg_css);\n\t\t}\n\t}\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tif (ret) {\n\t\tif (ret == -EEXIST)\n\t\t\tret = 0;\n\t\tgoto err_fprop_exit;\n\t}\n\tgoto out_put;\n\nerr_fprop_exit:\n\tfprop_local_destroy_percpu(&wb->memcg_completions);\nerr_ref_exit:\n\tpercpu_ref_exit(&wb->refcnt);\nerr_wb_exit:\n\twb_exit(wb);\nerr_free:\n\tkfree(wb);\nout_put:\n\tcss_put(blkcg_css);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int cgwb_create(struct backing_dev_info *bdi,\n\t\t       struct cgroup_subsys_state *memcg_css, gfp_t gfp)\n{\n\tstruct mem_cgroup *memcg;\n\tstruct cgroup_subsys_state *blkcg_css;\n\tstruct blkcg *blkcg;\n\tstruct list_head *memcg_cgwb_list, *blkcg_cgwb_list;\n\tstruct bdi_writeback *wb;\n\tunsigned long flags;\n\tint ret = 0;\n\n\tmemcg = mem_cgroup_from_css(memcg_css);\n\tblkcg_css = cgroup_get_e_css(memcg_css->cgroup, &io_cgrp_subsys);\n\tblkcg = css_to_blkcg(blkcg_css);\n\tmemcg_cgwb_list = &memcg->cgwb_list;\n\tblkcg_cgwb_list = &blkcg->cgwb_list;\n\n\t/* look up again under lock and discard on blkcg mismatch */\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\twb = radix_tree_lookup(&bdi->cgwb_tree, memcg_css->id);\n\tif (wb && wb->blkcg_css != blkcg_css) {\n\t\tcgwb_kill(wb);\n\t\twb = NULL;\n\t}\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tif (wb)\n\t\tgoto out_put;\n\n\t/* need to create a new one */\n\twb = kmalloc(sizeof(*wb), gfp);\n\tif (!wb) {\n\t\tret = -ENOMEM;\n\t\tgoto out_put;\n\t}\n\n\tret = wb_init(wb, bdi, blkcg_css->id, gfp);\n\tif (ret)\n\t\tgoto err_free;\n\n\tret = percpu_ref_init(&wb->refcnt, cgwb_release, 0, gfp);\n\tif (ret)\n\t\tgoto err_wb_exit;\n\n\tret = fprop_local_init_percpu(&wb->memcg_completions, gfp);\n\tif (ret)\n\t\tgoto err_ref_exit;\n\n\twb->memcg_css = memcg_css;\n\twb->blkcg_css = blkcg_css;\n\tINIT_WORK(&wb->release_work, cgwb_release_workfn);\n\tset_bit(WB_registered, &wb->state);\n\n\t/*\n\t * The root wb determines the registered state of the whole bdi and\n\t * memcg_cgwb_list and blkcg_cgwb_list's next pointers indicate\n\t * whether they're still online.  Don't link @wb if any is dead.\n\t * See wb_memcg_offline() and wb_blkcg_offline().\n\t */\n\tret = -ENODEV;\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\tif (test_bit(WB_registered, &bdi->wb.state) &&\n\t    blkcg_cgwb_list->next && memcg_cgwb_list->next) {\n\t\t/* we might have raced another instance of this function */\n\t\tret = radix_tree_insert(&bdi->cgwb_tree, memcg_css->id, wb);\n\t\tif (!ret) {\n\t\t\tlist_add_tail_rcu(&wb->bdi_node, &bdi->wb_list);\n\t\t\tlist_add(&wb->memcg_node, memcg_cgwb_list);\n\t\t\tlist_add(&wb->blkcg_node, blkcg_cgwb_list);\n\t\t\tblkcg_cgwb_get(blkcg);\n\t\t\tcss_get(memcg_css);\n\t\t\tcss_get(blkcg_css);\n\t\t}\n\t}\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tif (ret) {\n\t\tif (ret == -EEXIST)\n\t\t\tret = 0;\n\t\tgoto err_fprop_exit;\n\t}\n\tgoto out_put;\n\nerr_fprop_exit:\n\tfprop_local_destroy_percpu(&wb->memcg_completions);\nerr_ref_exit:\n\tpercpu_ref_exit(&wb->refcnt);\nerr_wb_exit:\n\twb_exit(wb);\nerr_free:\n\tkfree(wb);\nout_put:\n\tcss_put(blkcg_css);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "css_put",
          "args": [
            "blkcg_css"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "wb->blkcg_css != blkcg_css ||\n\t\t\t\t     !wb_tryget(wb)"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_tryget",
          "args": [
            "wb"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cgroup_get_e_css",
          "args": [
            "memcg_css->cgroup",
            "&io_cgrp_subsys"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_tree_lookup",
          "args": [
            "&bdi->cgwb_tree",
            "memcg_css->id"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep_if",
          "args": [
            "gfpflags_allow_blocking(gfp)"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gfpflags_allow_blocking",
          "args": [
            "gfp"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstruct bdi_writeback *wb_get_create(struct backing_dev_info *bdi,\n\t\t\t\t    struct cgroup_subsys_state *memcg_css,\n\t\t\t\t    gfp_t gfp)\n{\n\tstruct bdi_writeback *wb;\n\n\tmight_sleep_if(gfpflags_allow_blocking(gfp));\n\n\tif (!memcg_css->parent)\n\t\treturn &bdi->wb;\n\n\tdo {\n\t\trcu_read_lock();\n\t\twb = radix_tree_lookup(&bdi->cgwb_tree, memcg_css->id);\n\t\tif (wb) {\n\t\t\tstruct cgroup_subsys_state *blkcg_css;\n\n\t\t\t/* see whether the blkcg association has changed */\n\t\t\tblkcg_css = cgroup_get_e_css(memcg_css->cgroup,\n\t\t\t\t\t\t     &io_cgrp_subsys);\n\t\t\tif (unlikely(wb->blkcg_css != blkcg_css ||\n\t\t\t\t     !wb_tryget(wb)))\n\t\t\t\twb = NULL;\n\t\t\tcss_put(blkcg_css);\n\t\t}\n\t\trcu_read_unlock();\n\t} while (!wb && !cgwb_create(bdi, memcg_css, gfp));\n\n\treturn wb;\n}"
  },
  {
    "function_name": "cgwb_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "536-628",
    "snippet": "static int cgwb_create(struct backing_dev_info *bdi,\n\t\t       struct cgroup_subsys_state *memcg_css, gfp_t gfp)\n{\n\tstruct mem_cgroup *memcg;\n\tstruct cgroup_subsys_state *blkcg_css;\n\tstruct blkcg *blkcg;\n\tstruct list_head *memcg_cgwb_list, *blkcg_cgwb_list;\n\tstruct bdi_writeback *wb;\n\tunsigned long flags;\n\tint ret = 0;\n\n\tmemcg = mem_cgroup_from_css(memcg_css);\n\tblkcg_css = cgroup_get_e_css(memcg_css->cgroup, &io_cgrp_subsys);\n\tblkcg = css_to_blkcg(blkcg_css);\n\tmemcg_cgwb_list = &memcg->cgwb_list;\n\tblkcg_cgwb_list = &blkcg->cgwb_list;\n\n\t/* look up again under lock and discard on blkcg mismatch */\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\twb = radix_tree_lookup(&bdi->cgwb_tree, memcg_css->id);\n\tif (wb && wb->blkcg_css != blkcg_css) {\n\t\tcgwb_kill(wb);\n\t\twb = NULL;\n\t}\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tif (wb)\n\t\tgoto out_put;\n\n\t/* need to create a new one */\n\twb = kmalloc(sizeof(*wb), gfp);\n\tif (!wb) {\n\t\tret = -ENOMEM;\n\t\tgoto out_put;\n\t}\n\n\tret = wb_init(wb, bdi, blkcg_css->id, gfp);\n\tif (ret)\n\t\tgoto err_free;\n\n\tret = percpu_ref_init(&wb->refcnt, cgwb_release, 0, gfp);\n\tif (ret)\n\t\tgoto err_wb_exit;\n\n\tret = fprop_local_init_percpu(&wb->memcg_completions, gfp);\n\tif (ret)\n\t\tgoto err_ref_exit;\n\n\twb->memcg_css = memcg_css;\n\twb->blkcg_css = blkcg_css;\n\tINIT_WORK(&wb->release_work, cgwb_release_workfn);\n\tset_bit(WB_registered, &wb->state);\n\n\t/*\n\t * The root wb determines the registered state of the whole bdi and\n\t * memcg_cgwb_list and blkcg_cgwb_list's next pointers indicate\n\t * whether they're still online.  Don't link @wb if any is dead.\n\t * See wb_memcg_offline() and wb_blkcg_offline().\n\t */\n\tret = -ENODEV;\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\tif (test_bit(WB_registered, &bdi->wb.state) &&\n\t    blkcg_cgwb_list->next && memcg_cgwb_list->next) {\n\t\t/* we might have raced another instance of this function */\n\t\tret = radix_tree_insert(&bdi->cgwb_tree, memcg_css->id, wb);\n\t\tif (!ret) {\n\t\t\tlist_add_tail_rcu(&wb->bdi_node, &bdi->wb_list);\n\t\t\tlist_add(&wb->memcg_node, memcg_cgwb_list);\n\t\t\tlist_add(&wb->blkcg_node, blkcg_cgwb_list);\n\t\t\tblkcg_cgwb_get(blkcg);\n\t\t\tcss_get(memcg_css);\n\t\t\tcss_get(blkcg_css);\n\t\t}\n\t}\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tif (ret) {\n\t\tif (ret == -EEXIST)\n\t\t\tret = 0;\n\t\tgoto err_fprop_exit;\n\t}\n\tgoto out_put;\n\nerr_fprop_exit:\n\tfprop_local_destroy_percpu(&wb->memcg_completions);\nerr_ref_exit:\n\tpercpu_ref_exit(&wb->refcnt);\nerr_wb_exit:\n\twb_exit(wb);\nerr_free:\n\tkfree(wb);\nout_put:\n\tcss_put(blkcg_css);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "css_put",
          "args": [
            "blkcg_css"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "wb"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wb_exit",
          "args": [
            "wb"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "wb_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "377-390",
          "snippet": "static void wb_exit(struct bdi_writeback *wb)\n{\n\tint i;\n\n\tWARN_ON(delayed_work_pending(&wb->dwork));\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\n\tfprop_local_destroy_percpu(&wb->completions);\n\twb_congested_put(wb->congested);\n\tif (wb != &wb->bdi->wb)\n\t\tbdi_put(wb->bdi);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void wb_exit(struct bdi_writeback *wb)\n{\n\tint i;\n\n\tWARN_ON(delayed_work_pending(&wb->dwork));\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\n\tfprop_local_destroy_percpu(&wb->completions);\n\twb_congested_put(wb->congested);\n\tif (wb != &wb->bdi->wb)\n\t\tbdi_put(wb->bdi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_ref_exit",
          "args": [
            "&wb->refcnt"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprop_local_destroy_percpu",
          "args": [
            "&wb->memcg_completions"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "css_get",
          "args": [
            "blkcg_css"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "css_get",
          "args": [
            "memcg_css"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blkcg_cgwb_get",
          "args": [
            "blkcg"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&wb->blkcg_node",
            "blkcg_cgwb_list"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&wb->memcg_node",
            "memcg_cgwb_list"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail_rcu",
          "args": [
            "&wb->bdi_node",
            "&bdi->wb_list"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_tree_insert",
          "args": [
            "&bdi->cgwb_tree",
            "memcg_css->id",
            "wb"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "WB_registered",
            "&bdi->wb.state"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "WB_registered",
            "&wb->state"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_WORK",
          "args": [
            "&wb->release_work",
            "cgwb_release_workfn"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprop_local_init_percpu",
          "args": [
            "&wb->memcg_completions",
            "gfp"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_ref_init",
          "args": [
            "&wb->refcnt",
            "cgwb_release",
            "0",
            "gfp"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_init",
          "args": [
            "wb",
            "bdi",
            "blkcg_css->id",
            "gfp"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "wb_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "293-349",
          "snippet": "static int wb_init(struct bdi_writeback *wb, struct backing_dev_info *bdi,\n\t\t   int blkcg_id, gfp_t gfp)\n{\n\tint i, err;\n\n\tmemset(wb, 0, sizeof(*wb));\n\n\tif (wb != &bdi->wb)\n\t\tbdi_get(bdi);\n\twb->bdi = bdi;\n\twb->last_old_flush = jiffies;\n\tINIT_LIST_HEAD(&wb->b_dirty);\n\tINIT_LIST_HEAD(&wb->b_io);\n\tINIT_LIST_HEAD(&wb->b_more_io);\n\tINIT_LIST_HEAD(&wb->b_dirty_time);\n\tspin_lock_init(&wb->list_lock);\n\n\twb->bw_time_stamp = jiffies;\n\twb->balanced_dirty_ratelimit = INIT_BW;\n\twb->dirty_ratelimit = INIT_BW;\n\twb->write_bandwidth = INIT_BW;\n\twb->avg_write_bandwidth = INIT_BW;\n\n\tspin_lock_init(&wb->work_lock);\n\tINIT_LIST_HEAD(&wb->work_list);\n\tINIT_DELAYED_WORK(&wb->dwork, wb_workfn);\n\twb->dirty_sleep = jiffies;\n\n\twb->congested = wb_congested_get_create(bdi, blkcg_id, gfp);\n\tif (!wb->congested) {\n\t\terr = -ENOMEM;\n\t\tgoto out_put_bdi;\n\t}\n\n\terr = fprop_local_init_percpu(&wb->completions, gfp);\n\tif (err)\n\t\tgoto out_put_cong;\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++) {\n\t\terr = percpu_counter_init(&wb->stat[i], 0, gfp);\n\t\tif (err)\n\t\t\tgoto out_destroy_stat;\n\t}\n\n\treturn 0;\n\nout_destroy_stat:\n\twhile (i--)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\tfprop_local_destroy_percpu(&wb->completions);\nout_put_cong:\n\twb_congested_put(wb->congested);\nout_put_bdi:\n\tif (wb != &bdi->wb)\n\t\tbdi_put(bdi);\n\treturn err;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [
            "#define INIT_BW\t\t(100 << (20 - PAGE_SHIFT))"
          ],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\n#define INIT_BW\t\t(100 << (20 - PAGE_SHIFT))\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int wb_init(struct bdi_writeback *wb, struct backing_dev_info *bdi,\n\t\t   int blkcg_id, gfp_t gfp)\n{\n\tint i, err;\n\n\tmemset(wb, 0, sizeof(*wb));\n\n\tif (wb != &bdi->wb)\n\t\tbdi_get(bdi);\n\twb->bdi = bdi;\n\twb->last_old_flush = jiffies;\n\tINIT_LIST_HEAD(&wb->b_dirty);\n\tINIT_LIST_HEAD(&wb->b_io);\n\tINIT_LIST_HEAD(&wb->b_more_io);\n\tINIT_LIST_HEAD(&wb->b_dirty_time);\n\tspin_lock_init(&wb->list_lock);\n\n\twb->bw_time_stamp = jiffies;\n\twb->balanced_dirty_ratelimit = INIT_BW;\n\twb->dirty_ratelimit = INIT_BW;\n\twb->write_bandwidth = INIT_BW;\n\twb->avg_write_bandwidth = INIT_BW;\n\n\tspin_lock_init(&wb->work_lock);\n\tINIT_LIST_HEAD(&wb->work_list);\n\tINIT_DELAYED_WORK(&wb->dwork, wb_workfn);\n\twb->dirty_sleep = jiffies;\n\n\twb->congested = wb_congested_get_create(bdi, blkcg_id, gfp);\n\tif (!wb->congested) {\n\t\terr = -ENOMEM;\n\t\tgoto out_put_bdi;\n\t}\n\n\terr = fprop_local_init_percpu(&wb->completions, gfp);\n\tif (err)\n\t\tgoto out_put_cong;\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++) {\n\t\terr = percpu_counter_init(&wb->stat[i], 0, gfp);\n\t\tif (err)\n\t\t\tgoto out_destroy_stat;\n\t}\n\n\treturn 0;\n\nout_destroy_stat:\n\twhile (i--)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\tfprop_local_destroy_percpu(&wb->completions);\nout_put_cong:\n\twb_congested_put(wb->congested);\nout_put_bdi:\n\tif (wb != &bdi->wb)\n\t\tbdi_put(bdi);\n\treturn err;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*wb)",
            "gfp"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "__kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3729-3732",
          "snippet": "void *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nvoid *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cgwb_kill",
          "args": [
            "wb"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_kill",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "519-527",
          "snippet": "static void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}"
        }
      },
      {
        "call_info": {
          "callee": "radix_tree_lookup",
          "args": [
            "&bdi->cgwb_tree",
            "memcg_css->id"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "css_to_blkcg",
          "args": [
            "blkcg_css"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cgroup_get_e_css",
          "args": [
            "memcg_css->cgroup",
            "&io_cgrp_subsys"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mem_cgroup_from_css",
          "args": [
            "memcg_css"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int cgwb_create(struct backing_dev_info *bdi,\n\t\t       struct cgroup_subsys_state *memcg_css, gfp_t gfp)\n{\n\tstruct mem_cgroup *memcg;\n\tstruct cgroup_subsys_state *blkcg_css;\n\tstruct blkcg *blkcg;\n\tstruct list_head *memcg_cgwb_list, *blkcg_cgwb_list;\n\tstruct bdi_writeback *wb;\n\tunsigned long flags;\n\tint ret = 0;\n\n\tmemcg = mem_cgroup_from_css(memcg_css);\n\tblkcg_css = cgroup_get_e_css(memcg_css->cgroup, &io_cgrp_subsys);\n\tblkcg = css_to_blkcg(blkcg_css);\n\tmemcg_cgwb_list = &memcg->cgwb_list;\n\tblkcg_cgwb_list = &blkcg->cgwb_list;\n\n\t/* look up again under lock and discard on blkcg mismatch */\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\twb = radix_tree_lookup(&bdi->cgwb_tree, memcg_css->id);\n\tif (wb && wb->blkcg_css != blkcg_css) {\n\t\tcgwb_kill(wb);\n\t\twb = NULL;\n\t}\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tif (wb)\n\t\tgoto out_put;\n\n\t/* need to create a new one */\n\twb = kmalloc(sizeof(*wb), gfp);\n\tif (!wb) {\n\t\tret = -ENOMEM;\n\t\tgoto out_put;\n\t}\n\n\tret = wb_init(wb, bdi, blkcg_css->id, gfp);\n\tif (ret)\n\t\tgoto err_free;\n\n\tret = percpu_ref_init(&wb->refcnt, cgwb_release, 0, gfp);\n\tif (ret)\n\t\tgoto err_wb_exit;\n\n\tret = fprop_local_init_percpu(&wb->memcg_completions, gfp);\n\tif (ret)\n\t\tgoto err_ref_exit;\n\n\twb->memcg_css = memcg_css;\n\twb->blkcg_css = blkcg_css;\n\tINIT_WORK(&wb->release_work, cgwb_release_workfn);\n\tset_bit(WB_registered, &wb->state);\n\n\t/*\n\t * The root wb determines the registered state of the whole bdi and\n\t * memcg_cgwb_list and blkcg_cgwb_list's next pointers indicate\n\t * whether they're still online.  Don't link @wb if any is dead.\n\t * See wb_memcg_offline() and wb_blkcg_offline().\n\t */\n\tret = -ENODEV;\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\tif (test_bit(WB_registered, &bdi->wb.state) &&\n\t    blkcg_cgwb_list->next && memcg_cgwb_list->next) {\n\t\t/* we might have raced another instance of this function */\n\t\tret = radix_tree_insert(&bdi->cgwb_tree, memcg_css->id, wb);\n\t\tif (!ret) {\n\t\t\tlist_add_tail_rcu(&wb->bdi_node, &bdi->wb_list);\n\t\t\tlist_add(&wb->memcg_node, memcg_cgwb_list);\n\t\t\tlist_add(&wb->blkcg_node, blkcg_cgwb_list);\n\t\t\tblkcg_cgwb_get(blkcg);\n\t\t\tcss_get(memcg_css);\n\t\t\tcss_get(blkcg_css);\n\t\t}\n\t}\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tif (ret) {\n\t\tif (ret == -EEXIST)\n\t\t\tret = 0;\n\t\tgoto err_fprop_exit;\n\t}\n\tgoto out_put;\n\nerr_fprop_exit:\n\tfprop_local_destroy_percpu(&wb->memcg_completions);\nerr_ref_exit:\n\tpercpu_ref_exit(&wb->refcnt);\nerr_wb_exit:\n\twb_exit(wb);\nerr_free:\n\tkfree(wb);\nout_put:\n\tcss_put(blkcg_css);\n\treturn ret;\n}"
  },
  {
    "function_name": "cgwb_remove_from_bdi_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "529-534",
    "snippet": "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb)\n{\n\tspin_lock_irq(&cgwb_lock);\n\tlist_del_rcu(&wb->bdi_node);\n\tspin_unlock_irq(&cgwb_lock);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&wb->bdi_node"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irq",
          "args": [
            "&cgwb_lock"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb)\n{\n\tspin_lock_irq(&cgwb_lock);\n\tlist_del_rcu(&wb->bdi_node);\n\tspin_unlock_irq(&cgwb_lock);\n}"
  },
  {
    "function_name": "cgwb_kill",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "519-527",
    "snippet": "static void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "percpu_ref_kill",
          "args": [
            "&wb->refcnt"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&wb->blkcg_node"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&wb->memcg_node"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id)"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "radix_tree_delete",
          "args": [
            "&wb->bdi->cgwb_tree",
            "wb->memcg_css->id"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&cgwb_lock"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_kill(struct bdi_writeback *wb)\n{\n\tlockdep_assert_held(&cgwb_lock);\n\n\tWARN_ON(!radix_tree_delete(&wb->bdi->cgwb_tree, wb->memcg_css->id));\n\tlist_del(&wb->memcg_node);\n\tlist_del(&wb->blkcg_node);\n\tpercpu_ref_kill(&wb->refcnt);\n}"
  },
  {
    "function_name": "cgwb_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "512-517",
    "snippet": "static void cgwb_release(struct percpu_ref *refcnt)\n{\n\tstruct bdi_writeback *wb = container_of(refcnt, struct bdi_writeback,\n\t\t\t\t\t\trefcnt);\n\tqueue_work(cgwb_release_wq, &wb->release_work);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue_work",
          "args": [
            "cgwb_release_wq",
            "&wb->release_work"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "refcnt",
            "structbdi_writeback",
            "refcnt"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_release(struct percpu_ref *refcnt)\n{\n\tstruct bdi_writeback *wb = container_of(refcnt, struct bdi_writeback,\n\t\t\t\t\t\trefcnt);\n\tqueue_work(cgwb_release_wq, &wb->release_work);\n}"
  },
  {
    "function_name": "cgwb_release_workfn",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "490-510",
    "snippet": "static void cgwb_release_workfn(struct work_struct *work)\n{\n\tstruct bdi_writeback *wb = container_of(work, struct bdi_writeback,\n\t\t\t\t\t\trelease_work);\n\tstruct blkcg *blkcg = css_to_blkcg(wb->blkcg_css);\n\n\tmutex_lock(&wb->bdi->cgwb_release_mutex);\n\twb_shutdown(wb);\n\n\tcss_put(wb->memcg_css);\n\tcss_put(wb->blkcg_css);\n\tmutex_unlock(&wb->bdi->cgwb_release_mutex);\n\n\t/* triggers blkg destruction if cgwb_refcnt becomes zero */\n\tblkcg_cgwb_put(blkcg);\n\n\tfprop_local_destroy_percpu(&wb->memcg_completions);\n\tpercpu_ref_exit(&wb->refcnt);\n\twb_exit(wb);\n\tkfree_rcu(wb, rcu);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree_rcu",
          "args": [
            "wb",
            "rcu"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_exit",
          "args": [
            "wb"
          ],
          "line": 508
        },
        "resolved": true,
        "details": {
          "function_name": "wb_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "377-390",
          "snippet": "static void wb_exit(struct bdi_writeback *wb)\n{\n\tint i;\n\n\tWARN_ON(delayed_work_pending(&wb->dwork));\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\n\tfprop_local_destroy_percpu(&wb->completions);\n\twb_congested_put(wb->congested);\n\tif (wb != &wb->bdi->wb)\n\t\tbdi_put(wb->bdi);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void wb_exit(struct bdi_writeback *wb)\n{\n\tint i;\n\n\tWARN_ON(delayed_work_pending(&wb->dwork));\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\n\tfprop_local_destroy_percpu(&wb->completions);\n\twb_congested_put(wb->congested);\n\tif (wb != &wb->bdi->wb)\n\t\tbdi_put(wb->bdi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "percpu_ref_exit",
          "args": [
            "&wb->refcnt"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprop_local_destroy_percpu",
          "args": [
            "&wb->memcg_completions"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "blkcg_cgwb_put",
          "args": [
            "blkcg"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&wb->bdi->cgwb_release_mutex"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "css_put",
          "args": [
            "wb->blkcg_css"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "css_put",
          "args": [
            "wb->memcg_css"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_shutdown",
          "args": [
            "wb"
          ],
          "line": 497
        },
        "resolved": true,
        "details": {
          "function_name": "wb_shutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "356-375",
          "snippet": "static void wb_shutdown(struct bdi_writeback *wb)\n{\n\t/* Make sure nobody queues further work */\n\tspin_lock_bh(&wb->work_lock);\n\tif (!test_and_clear_bit(WB_registered, &wb->state)) {\n\t\tspin_unlock_bh(&wb->work_lock);\n\t\treturn;\n\t}\n\tspin_unlock_bh(&wb->work_lock);\n\n\tcgwb_remove_from_bdi_list(wb);\n\t/*\n\t * Drain work list and shutdown the delayed_work.  !WB_registered\n\t * tells wb_workfn() that @wb is dying and its work_list needs to\n\t * be drained no matter what.\n\t */\n\tmod_delayed_work(bdi_wq, &wb->dwork, 0);\n\tflush_delayed_work(&wb->dwork);\n\tWARN_ON(!list_empty(&wb->work_list));\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct workqueue_struct *bdi_wq;",
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstruct workqueue_struct *bdi_wq;\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void wb_shutdown(struct bdi_writeback *wb)\n{\n\t/* Make sure nobody queues further work */\n\tspin_lock_bh(&wb->work_lock);\n\tif (!test_and_clear_bit(WB_registered, &wb->state)) {\n\t\tspin_unlock_bh(&wb->work_lock);\n\t\treturn;\n\t}\n\tspin_unlock_bh(&wb->work_lock);\n\n\tcgwb_remove_from_bdi_list(wb);\n\t/*\n\t * Drain work list and shutdown the delayed_work.  !WB_registered\n\t * tells wb_workfn() that @wb is dying and its work_list needs to\n\t * be drained no matter what.\n\t */\n\tmod_delayed_work(bdi_wq, &wb->dwork, 0);\n\tflush_delayed_work(&wb->dwork);\n\tWARN_ON(!list_empty(&wb->work_list));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&wb->bdi->cgwb_release_mutex"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "css_to_blkcg",
          "args": [
            "wb->blkcg_css"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "work",
            "structbdi_writeback",
            "release_work"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_release_workfn(struct work_struct *work)\n{\n\tstruct bdi_writeback *wb = container_of(work, struct bdi_writeback,\n\t\t\t\t\t\trelease_work);\n\tstruct blkcg *blkcg = css_to_blkcg(wb->blkcg_css);\n\n\tmutex_lock(&wb->bdi->cgwb_release_mutex);\n\twb_shutdown(wb);\n\n\tcss_put(wb->memcg_css);\n\tcss_put(wb->blkcg_css);\n\tmutex_unlock(&wb->bdi->cgwb_release_mutex);\n\n\t/* triggers blkg destruction if cgwb_refcnt becomes zero */\n\tblkcg_cgwb_put(blkcg);\n\n\tfprop_local_destroy_percpu(&wb->memcg_completions);\n\tpercpu_ref_exit(&wb->refcnt);\n\twb_exit(wb);\n\tkfree_rcu(wb, rcu);\n}"
  },
  {
    "function_name": "wb_congested_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "472-488",
    "snippet": "void wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "congested"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "&congested->rb_node",
            "&congested->__bdi->cgwb_congested_tree"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "vma_rb_erase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/mmap.c",
          "lines": "479-489",
          "snippet": "static __always_inline void vma_rb_erase(struct vm_area_struct *vma,\n\t\t\t\t\t struct rb_root *root)\n{\n\t/*\n\t * All rb_subtree_gap values must be consistent prior to erase,\n\t * with the possible exception of the vma being erased.\n\t */\n\tvalidate_mm_rb(root, vma);\n\n\t__vma_rb_erase(vma, root);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/mmu_context.h>",
            "#include <asm/tlb.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/oom.h>",
            "#include <linux/pkeys.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/printk.h>",
            "#include <linux/memory.h>",
            "#include <linux/notifier.h>",
            "#include <linux/rbtree_augmented.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/audit.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/mmdebug.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/mount.h>",
            "#include <linux/export.h>",
            "#include <linux/profile.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/init.h>",
            "#include <linux/capability.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mman.h>",
            "#include <linux/shm.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/mmu_context.h>\n#include <asm/tlb.h>\n#include <asm/cacheflush.h>\n#include <linux/uaccess.h>\n#include <linux/oom.h>\n#include <linux/pkeys.h>\n#include <linux/moduleparam.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/printk.h>\n#include <linux/memory.h>\n#include <linux/notifier.h>\n#include <linux/rbtree_augmented.h>\n#include <linux/uprobes.h>\n#include <linux/khugepaged.h>\n#include <linux/audit.h>\n#include <linux/perf_event.h>\n#include <linux/mmdebug.h>\n#include <linux/mmu_notifier.h>\n#include <linux/rmap.h>\n#include <linux/mempolicy.h>\n#include <linux/mount.h>\n#include <linux/export.h>\n#include <linux/profile.h>\n#include <linux/shmem_fs.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/init.h>\n#include <linux/capability.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/pagemap.h>\n#include <linux/mman.h>\n#include <linux/shm.h>\n#include <linux/vmacache.h>\n#include <linux/mm.h>\n#include <linux/backing-dev.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nstatic __always_inline void vma_rb_erase(struct vm_area_struct *vma,\n\t\t\t\t\t struct rb_root *root)\n{\n\t/*\n\t * All rb_subtree_gap values must be consistent prior to erase,\n\t * with the possible exception of the vma being erased.\n\t */\n\tvalidate_mm_rb(root, vma);\n\n\t__vma_rb_erase(vma, root);\n}"
        }
      },
      {
        "call_info": {
          "callee": "refcount_dec_and_lock_irqsave",
          "args": [
            "&congested->refcnt",
            "&cgwb_lock",
            "&flags"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nvoid wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}"
  },
  {
    "function_name": "wb_congested_get_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "414-464",
    "snippet": "struct bdi_writeback_congested *\nwb_congested_get_create(struct backing_dev_info *bdi, int blkcg_id, gfp_t gfp)\n{\n\tstruct bdi_writeback_congested *new_congested = NULL, *congested;\n\tstruct rb_node **node, *parent;\n\tunsigned long flags;\nretry:\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\n\tnode = &bdi->cgwb_congested_tree.rb_node;\n\tparent = NULL;\n\n\twhile (*node != NULL) {\n\t\tparent = *node;\n\t\tcongested = rb_entry(parent, struct bdi_writeback_congested,\n\t\t\t\t     rb_node);\n\t\tif (congested->blkcg_id < blkcg_id)\n\t\t\tnode = &parent->rb_left;\n\t\telse if (congested->blkcg_id > blkcg_id)\n\t\t\tnode = &parent->rb_right;\n\t\telse\n\t\t\tgoto found;\n\t}\n\n\tif (new_congested) {\n\t\t/* !found and storage for new one already allocated, insert */\n\t\tcongested = new_congested;\n\t\trb_link_node(&congested->rb_node, parent, node);\n\t\trb_insert_color(&congested->rb_node, &bdi->cgwb_congested_tree);\n\t\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\t\treturn congested;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\n\t/* allocate storage for new one and retry */\n\tnew_congested = kzalloc(sizeof(*new_congested), gfp);\n\tif (!new_congested)\n\t\treturn NULL;\n\n\trefcount_set(&new_congested->refcnt, 1);\n\tnew_congested->__bdi = bdi;\n\tnew_congested->blkcg_id = blkcg_id;\n\tgoto retry;\n\nfound:\n\trefcount_inc(&congested->refcnt);\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(new_congested);\n\treturn congested;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "new_congested"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "refcount_inc",
          "args": [
            "&congested->refcnt"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "refcount_set",
          "args": [
            "&new_congested->refcnt",
            "1"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*new_congested)",
            "gfp"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_insert_color",
          "args": [
            "&congested->rb_node",
            "&bdi->cgwb_congested_tree"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_link_node",
          "args": [
            "&congested->rb_node",
            "parent",
            "node"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "parent",
            "structbdi_writeback_congested",
            "rb_node"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&cgwb_lock",
            "flags"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstruct bdi_writeback_congested *\nwb_congested_get_create(struct backing_dev_info *bdi, int blkcg_id, gfp_t gfp)\n{\n\tstruct bdi_writeback_congested *new_congested = NULL, *congested;\n\tstruct rb_node **node, *parent;\n\tunsigned long flags;\nretry:\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\n\tnode = &bdi->cgwb_congested_tree.rb_node;\n\tparent = NULL;\n\n\twhile (*node != NULL) {\n\t\tparent = *node;\n\t\tcongested = rb_entry(parent, struct bdi_writeback_congested,\n\t\t\t\t     rb_node);\n\t\tif (congested->blkcg_id < blkcg_id)\n\t\t\tnode = &parent->rb_left;\n\t\telse if (congested->blkcg_id > blkcg_id)\n\t\t\tnode = &parent->rb_right;\n\t\telse\n\t\t\tgoto found;\n\t}\n\n\tif (new_congested) {\n\t\t/* !found and storage for new one already allocated, insert */\n\t\tcongested = new_congested;\n\t\trb_link_node(&congested->rb_node, parent, node);\n\t\trb_insert_color(&congested->rb_node, &bdi->cgwb_congested_tree);\n\t\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\t\treturn congested;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\n\t/* allocate storage for new one and retry */\n\tnew_congested = kzalloc(sizeof(*new_congested), gfp);\n\tif (!new_congested)\n\t\treturn NULL;\n\n\trefcount_set(&new_congested->refcnt, 1);\n\tnew_congested->__bdi = bdi;\n\tnew_congested->blkcg_id = blkcg_id;\n\tgoto retry;\n\nfound:\n\trefcount_inc(&congested->refcnt);\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(new_congested);\n\treturn congested;\n}"
  },
  {
    "function_name": "wb_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "377-390",
    "snippet": "static void wb_exit(struct bdi_writeback *wb)\n{\n\tint i;\n\n\tWARN_ON(delayed_work_pending(&wb->dwork));\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\n\tfprop_local_destroy_percpu(&wb->completions);\n\twb_congested_put(wb->congested);\n\tif (wb != &wb->bdi->wb)\n\t\tbdi_put(wb->bdi);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bdi_put",
          "args": [
            "wb->bdi"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "971-974",
          "snippet": "void bdi_put(struct backing_dev_info *bdi)\n{\n\tkref_put(&bdi->refcnt, release_bdi);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nvoid bdi_put(struct backing_dev_info *bdi)\n{\n\tkref_put(&bdi->refcnt, release_bdi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wb_congested_put",
          "args": [
            "wb->congested"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "wb_congested_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "472-488",
          "snippet": "void wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nvoid wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprop_local_destroy_percpu",
          "args": [
            "&wb->completions"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_destroy",
          "args": [
            "&wb->stat[i]"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "delayed_work_pending(&wb->dwork)"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "delayed_work_pending",
          "args": [
            "&wb->dwork"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void wb_exit(struct bdi_writeback *wb)\n{\n\tint i;\n\n\tWARN_ON(delayed_work_pending(&wb->dwork));\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\n\tfprop_local_destroy_percpu(&wb->completions);\n\twb_congested_put(wb->congested);\n\tif (wb != &wb->bdi->wb)\n\t\tbdi_put(wb->bdi);\n}"
  },
  {
    "function_name": "wb_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "356-375",
    "snippet": "static void wb_shutdown(struct bdi_writeback *wb)\n{\n\t/* Make sure nobody queues further work */\n\tspin_lock_bh(&wb->work_lock);\n\tif (!test_and_clear_bit(WB_registered, &wb->state)) {\n\t\tspin_unlock_bh(&wb->work_lock);\n\t\treturn;\n\t}\n\tspin_unlock_bh(&wb->work_lock);\n\n\tcgwb_remove_from_bdi_list(wb);\n\t/*\n\t * Drain work list and shutdown the delayed_work.  !WB_registered\n\t * tells wb_workfn() that @wb is dying and its work_list needs to\n\t * be drained no matter what.\n\t */\n\tmod_delayed_work(bdi_wq, &wb->dwork, 0);\n\tflush_delayed_work(&wb->dwork);\n\tWARN_ON(!list_empty(&wb->work_list));\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct workqueue_struct *bdi_wq;",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!list_empty(&wb->work_list)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&wb->work_list"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "flush_delayed_work",
          "args": [
            "&wb->dwork"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod_delayed_work",
          "args": [
            "bdi_wq",
            "&wb->dwork",
            "0"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cgwb_remove_from_bdi_list",
          "args": [
            "wb"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "cgwb_remove_from_bdi_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "831-834",
          "snippet": "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb)\n{\n\tlist_del_rcu(&wb->bdi_node);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb)\n{\n\tlist_del_rcu(&wb->bdi_node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_bh",
          "args": [
            "&wb->work_lock"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock_bh",
          "args": [
            "&wb->work_lock"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_and_clear_bit",
          "args": [
            "WB_registered",
            "&wb->state"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_bh",
          "args": [
            "&wb->work_lock"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstruct workqueue_struct *bdi_wq;\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic void wb_shutdown(struct bdi_writeback *wb)\n{\n\t/* Make sure nobody queues further work */\n\tspin_lock_bh(&wb->work_lock);\n\tif (!test_and_clear_bit(WB_registered, &wb->state)) {\n\t\tspin_unlock_bh(&wb->work_lock);\n\t\treturn;\n\t}\n\tspin_unlock_bh(&wb->work_lock);\n\n\tcgwb_remove_from_bdi_list(wb);\n\t/*\n\t * Drain work list and shutdown the delayed_work.  !WB_registered\n\t * tells wb_workfn() that @wb is dying and its work_list needs to\n\t * be drained no matter what.\n\t */\n\tmod_delayed_work(bdi_wq, &wb->dwork, 0);\n\tflush_delayed_work(&wb->dwork);\n\tWARN_ON(!list_empty(&wb->work_list));\n}"
  },
  {
    "function_name": "wb_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "293-349",
    "snippet": "static int wb_init(struct bdi_writeback *wb, struct backing_dev_info *bdi,\n\t\t   int blkcg_id, gfp_t gfp)\n{\n\tint i, err;\n\n\tmemset(wb, 0, sizeof(*wb));\n\n\tif (wb != &bdi->wb)\n\t\tbdi_get(bdi);\n\twb->bdi = bdi;\n\twb->last_old_flush = jiffies;\n\tINIT_LIST_HEAD(&wb->b_dirty);\n\tINIT_LIST_HEAD(&wb->b_io);\n\tINIT_LIST_HEAD(&wb->b_more_io);\n\tINIT_LIST_HEAD(&wb->b_dirty_time);\n\tspin_lock_init(&wb->list_lock);\n\n\twb->bw_time_stamp = jiffies;\n\twb->balanced_dirty_ratelimit = INIT_BW;\n\twb->dirty_ratelimit = INIT_BW;\n\twb->write_bandwidth = INIT_BW;\n\twb->avg_write_bandwidth = INIT_BW;\n\n\tspin_lock_init(&wb->work_lock);\n\tINIT_LIST_HEAD(&wb->work_list);\n\tINIT_DELAYED_WORK(&wb->dwork, wb_workfn);\n\twb->dirty_sleep = jiffies;\n\n\twb->congested = wb_congested_get_create(bdi, blkcg_id, gfp);\n\tif (!wb->congested) {\n\t\terr = -ENOMEM;\n\t\tgoto out_put_bdi;\n\t}\n\n\terr = fprop_local_init_percpu(&wb->completions, gfp);\n\tif (err)\n\t\tgoto out_put_cong;\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++) {\n\t\terr = percpu_counter_init(&wb->stat[i], 0, gfp);\n\t\tif (err)\n\t\t\tgoto out_destroy_stat;\n\t}\n\n\treturn 0;\n\nout_destroy_stat:\n\twhile (i--)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\tfprop_local_destroy_percpu(&wb->completions);\nout_put_cong:\n\twb_congested_put(wb->congested);\nout_put_bdi:\n\tif (wb != &bdi->wb)\n\t\tbdi_put(bdi);\n\treturn err;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [
      "#define INIT_BW\t\t(100 << (20 - PAGE_SHIFT))"
    ],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bdi_put",
          "args": [
            "bdi"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "971-974",
          "snippet": "void bdi_put(struct backing_dev_info *bdi)\n{\n\tkref_put(&bdi->refcnt, release_bdi);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nvoid bdi_put(struct backing_dev_info *bdi)\n{\n\tkref_put(&bdi->refcnt, release_bdi);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wb_congested_put",
          "args": [
            "wb->congested"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "wb_congested_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "472-488",
          "snippet": "void wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nvoid wb_congested_put(struct bdi_writeback_congested *congested)\n{\n\tunsigned long flags;\n\n\tif (!refcount_dec_and_lock_irqsave(&congested->refcnt, &cgwb_lock, &flags))\n\t\treturn;\n\n\t/* bdi might already have been destroyed leaving @congested unlinked */\n\tif (congested->__bdi) {\n\t\trb_erase(&congested->rb_node,\n\t\t\t &congested->__bdi->cgwb_congested_tree);\n\t\tcongested->__bdi = NULL;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(congested);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprop_local_destroy_percpu",
          "args": [
            "&wb->completions"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_destroy",
          "args": [
            "&wb->stat[i]"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "percpu_counter_init",
          "args": [
            "&wb->stat[i]",
            "0",
            "gfp"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprop_local_init_percpu",
          "args": [
            "&wb->completions",
            "gfp"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_congested_get_create",
          "args": [
            "bdi",
            "blkcg_id",
            "gfp"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "wb_congested_get_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "414-464",
          "snippet": "struct bdi_writeback_congested *\nwb_congested_get_create(struct backing_dev_info *bdi, int blkcg_id, gfp_t gfp)\n{\n\tstruct bdi_writeback_congested *new_congested = NULL, *congested;\n\tstruct rb_node **node, *parent;\n\tunsigned long flags;\nretry:\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\n\tnode = &bdi->cgwb_congested_tree.rb_node;\n\tparent = NULL;\n\n\twhile (*node != NULL) {\n\t\tparent = *node;\n\t\tcongested = rb_entry(parent, struct bdi_writeback_congested,\n\t\t\t\t     rb_node);\n\t\tif (congested->blkcg_id < blkcg_id)\n\t\t\tnode = &parent->rb_left;\n\t\telse if (congested->blkcg_id > blkcg_id)\n\t\t\tnode = &parent->rb_right;\n\t\telse\n\t\t\tgoto found;\n\t}\n\n\tif (new_congested) {\n\t\t/* !found and storage for new one already allocated, insert */\n\t\tcongested = new_congested;\n\t\trb_link_node(&congested->rb_node, parent, node);\n\t\trb_insert_color(&congested->rb_node, &bdi->cgwb_congested_tree);\n\t\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\t\treturn congested;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\n\t/* allocate storage for new one and retry */\n\tnew_congested = kzalloc(sizeof(*new_congested), gfp);\n\tif (!new_congested)\n\t\treturn NULL;\n\n\trefcount_set(&new_congested->refcnt, 1);\n\tnew_congested->__bdi = bdi;\n\tnew_congested->blkcg_id = blkcg_id;\n\tgoto retry;\n\nfound:\n\trefcount_inc(&congested->refcnt);\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(new_congested);\n\treturn congested;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstruct bdi_writeback_congested *\nwb_congested_get_create(struct backing_dev_info *bdi, int blkcg_id, gfp_t gfp)\n{\n\tstruct bdi_writeback_congested *new_congested = NULL, *congested;\n\tstruct rb_node **node, *parent;\n\tunsigned long flags;\nretry:\n\tspin_lock_irqsave(&cgwb_lock, flags);\n\n\tnode = &bdi->cgwb_congested_tree.rb_node;\n\tparent = NULL;\n\n\twhile (*node != NULL) {\n\t\tparent = *node;\n\t\tcongested = rb_entry(parent, struct bdi_writeback_congested,\n\t\t\t\t     rb_node);\n\t\tif (congested->blkcg_id < blkcg_id)\n\t\t\tnode = &parent->rb_left;\n\t\telse if (congested->blkcg_id > blkcg_id)\n\t\t\tnode = &parent->rb_right;\n\t\telse\n\t\t\tgoto found;\n\t}\n\n\tif (new_congested) {\n\t\t/* !found and storage for new one already allocated, insert */\n\t\tcongested = new_congested;\n\t\trb_link_node(&congested->rb_node, parent, node);\n\t\trb_insert_color(&congested->rb_node, &bdi->cgwb_congested_tree);\n\t\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\t\treturn congested;\n\t}\n\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\n\t/* allocate storage for new one and retry */\n\tnew_congested = kzalloc(sizeof(*new_congested), gfp);\n\tif (!new_congested)\n\t\treturn NULL;\n\n\trefcount_set(&new_congested->refcnt, 1);\n\tnew_congested->__bdi = bdi;\n\tnew_congested->blkcg_id = blkcg_id;\n\tgoto retry;\n\nfound:\n\trefcount_inc(&congested->refcnt);\n\tspin_unlock_irqrestore(&cgwb_lock, flags);\n\tkfree(new_congested);\n\treturn congested;\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_DELAYED_WORK",
          "args": [
            "&wb->dwork",
            "wb_workfn"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&wb->work_list"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&wb->work_lock"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&wb->list_lock"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&wb->b_dirty_time"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&wb->b_more_io"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&wb->b_io"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&wb->b_dirty"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdi_get",
          "args": [
            "bdi"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "wb",
            "0",
            "sizeof(*wb)"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "memset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "283-288",
          "snippet": "void *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\n#define INIT_BW\t\t(100 << (20 - PAGE_SHIFT))\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int wb_init(struct bdi_writeback *wb, struct backing_dev_info *bdi,\n\t\t   int blkcg_id, gfp_t gfp)\n{\n\tint i, err;\n\n\tmemset(wb, 0, sizeof(*wb));\n\n\tif (wb != &bdi->wb)\n\t\tbdi_get(bdi);\n\twb->bdi = bdi;\n\twb->last_old_flush = jiffies;\n\tINIT_LIST_HEAD(&wb->b_dirty);\n\tINIT_LIST_HEAD(&wb->b_io);\n\tINIT_LIST_HEAD(&wb->b_more_io);\n\tINIT_LIST_HEAD(&wb->b_dirty_time);\n\tspin_lock_init(&wb->list_lock);\n\n\twb->bw_time_stamp = jiffies;\n\twb->balanced_dirty_ratelimit = INIT_BW;\n\twb->dirty_ratelimit = INIT_BW;\n\twb->write_bandwidth = INIT_BW;\n\twb->avg_write_bandwidth = INIT_BW;\n\n\tspin_lock_init(&wb->work_lock);\n\tINIT_LIST_HEAD(&wb->work_list);\n\tINIT_DELAYED_WORK(&wb->dwork, wb_workfn);\n\twb->dirty_sleep = jiffies;\n\n\twb->congested = wb_congested_get_create(bdi, blkcg_id, gfp);\n\tif (!wb->congested) {\n\t\terr = -ENOMEM;\n\t\tgoto out_put_bdi;\n\t}\n\n\terr = fprop_local_init_percpu(&wb->completions, gfp);\n\tif (err)\n\t\tgoto out_put_cong;\n\n\tfor (i = 0; i < NR_WB_STAT_ITEMS; i++) {\n\t\terr = percpu_counter_init(&wb->stat[i], 0, gfp);\n\t\tif (err)\n\t\t\tgoto out_destroy_stat;\n\t}\n\n\treturn 0;\n\nout_destroy_stat:\n\twhile (i--)\n\t\tpercpu_counter_destroy(&wb->stat[i]);\n\tfprop_local_destroy_percpu(&wb->completions);\nout_put_cong:\n\twb_congested_put(wb->congested);\nout_put_bdi:\n\tif (wb != &bdi->wb)\n\t\tbdi_put(bdi);\n\treturn err;\n}"
  },
  {
    "function_name": "wb_wakeup_delayed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "277-286",
    "snippet": "void wb_wakeup_delayed(struct bdi_writeback *wb)\n{\n\tunsigned long timeout;\n\n\ttimeout = msecs_to_jiffies(dirty_writeback_interval * 10);\n\tspin_lock_bh(&wb->work_lock);\n\tif (test_bit(WB_registered, &wb->state))\n\t\tqueue_delayed_work(bdi_wq, &wb->dwork, timeout);\n\tspin_unlock_bh(&wb->work_lock);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct workqueue_struct *bdi_wq;",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_bh",
          "args": [
            "&wb->work_lock"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_delayed_work",
          "args": [
            "bdi_wq",
            "&wb->dwork",
            "timeout"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "WB_registered",
            "&wb->state"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_bh",
          "args": [
            "&wb->work_lock"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msecs_to_jiffies",
          "args": [
            "dirty_writeback_interval * 10"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstruct workqueue_struct *bdi_wq;\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nvoid wb_wakeup_delayed(struct bdi_writeback *wb)\n{\n\tunsigned long timeout;\n\n\ttimeout = msecs_to_jiffies(dirty_writeback_interval * 10);\n\tspin_lock_bh(&wb->work_lock);\n\tif (test_bit(WB_registered, &wb->state))\n\t\tqueue_delayed_work(bdi_wq, &wb->dwork, timeout);\n\tspin_unlock_bh(&wb->work_lock);\n}"
  },
  {
    "function_name": "default_bdi_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "248-260",
    "snippet": "static int __init default_bdi_init(void)\n{\n\tint err;\n\n\tbdi_wq = alloc_workqueue(\"writeback\", WQ_MEM_RECLAIM | WQ_FREEZABLE |\n\t\t\t\t\t      WQ_UNBOUND | WQ_SYSFS, 0);\n\tif (!bdi_wq)\n\t\treturn -ENOMEM;\n\n\terr = bdi_init(&noop_backing_dev_info);\n\n\treturn err;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct backing_dev_info noop_backing_dev_info = {\n\t.name\t\t= \"noop\",\n\t.capabilities\t= BDI_CAP_NO_ACCT_AND_WRITEBACK,\n};",
      "struct workqueue_struct *bdi_wq;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bdi_init",
          "args": [
            "&noop_backing_dev_info"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "838-855",
          "snippet": "static int bdi_init(struct backing_dev_info *bdi)\n{\n\tint ret;\n\n\tbdi->dev = NULL;\n\n\tkref_init(&bdi->refcnt);\n\tbdi->min_ratio = 0;\n\tbdi->max_ratio = 100;\n\tbdi->max_prop_frac = FPROP_FRAC_BASE;\n\tINIT_LIST_HEAD(&bdi->bdi_list);\n\tINIT_LIST_HEAD(&bdi->wb_list);\n\tinit_waitqueue_head(&bdi->wb_waitq);\n\n\tret = cgwb_bdi_init(bdi);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int bdi_init(struct backing_dev_info *bdi);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic int bdi_init(struct backing_dev_info *bdi)\n{\n\tint ret;\n\n\tbdi->dev = NULL;\n\n\tkref_init(&bdi->refcnt);\n\tbdi->min_ratio = 0;\n\tbdi->max_ratio = 100;\n\tbdi->max_prop_frac = FPROP_FRAC_BASE;\n\tINIT_LIST_HEAD(&bdi->bdi_list);\n\tINIT_LIST_HEAD(&bdi->wb_list);\n\tinit_waitqueue_head(&bdi->wb_waitq);\n\n\tret = cgwb_bdi_init(bdi);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloc_workqueue",
          "args": [
            "\"writeback\"",
            "WQ_MEM_RECLAIM | WQ_FREEZABLE |\n\t\t\t\t\t      WQ_UNBOUND | WQ_SYSFS",
            "0"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstruct backing_dev_info noop_backing_dev_info = {\n\t.name\t\t= \"noop\",\n\t.capabilities\t= BDI_CAP_NO_ACCT_AND_WRITEBACK,\n};\nstruct workqueue_struct *bdi_wq;\n\nstatic int __init default_bdi_init(void)\n{\n\tint err;\n\n\tbdi_wq = alloc_workqueue(\"writeback\", WQ_MEM_RECLAIM | WQ_FREEZABLE |\n\t\t\t\t\t      WQ_UNBOUND | WQ_SYSFS, 0);\n\tif (!bdi_wq)\n\t\treturn -ENOMEM;\n\n\terr = bdi_init(&noop_backing_dev_info);\n\n\treturn err;\n}"
  },
  {
    "function_name": "bdi_class_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "233-243",
    "snippet": "static __init int bdi_class_init(void)\n{\n\tbdi_class = class_create(THIS_MODULE, \"bdi\");\n\tif (IS_ERR(bdi_class))\n\t\treturn PTR_ERR(bdi_class);\n\n\tbdi_class->dev_groups = bdi_dev_groups;\n\tbdi_debug_init();\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct class *bdi_class;",
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bdi_debug_init",
          "args": [],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_debug_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
          "lines": "131-133",
          "snippet": "static inline void bdi_debug_init(void)\n{\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <trace/events/writeback.h>",
            "#include <linux/device.h>",
            "#include <linux/writeback.h>",
            "#include <linux/module.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/fs.h>",
            "#include <linux/freezer.h>",
            "#include <linux/kthread.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/wait.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic inline void bdi_debug_init(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "bdi_class"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "bdi_class"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "class_create",
          "args": [
            "THIS_MODULE",
            "\"bdi\""
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic struct class *bdi_class;\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic __init int bdi_class_init(void)\n{\n\tbdi_class = class_create(THIS_MODULE, \"bdi\");\n\tif (IS_ERR(bdi_class))\n\t\treturn PTR_ERR(bdi_class);\n\n\tbdi_class->dev_groups = bdi_dev_groups;\n\tbdi_debug_init();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "stable_pages_required_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "213-221",
    "snippet": "static ssize_t stable_pages_required_show(struct device *dev,\n\t\t\t\t\t  struct device_attribute *attr,\n\t\t\t\t\t  char *page)\n{\n\tstruct backing_dev_info *bdi = dev_get_drvdata(dev);\n\n\treturn snprintf(page, PAGE_SIZE-1, \"%d\\n\",\n\t\t\tbdi_cap_stable_pages_required(bdi) ? 1 : 0);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "page",
            "PAGE_SIZE-1",
            "\"%d\\n\"",
            "bdi_cap_stable_pages_required(bdi) ? 1 : 0"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bdi_cap_stable_pages_required",
          "args": [
            "bdi"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_get_drvdata",
          "args": [
            "dev"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic ssize_t stable_pages_required_show(struct device *dev,\n\t\t\t\t\t  struct device_attribute *attr,\n\t\t\t\t\t  char *page)\n{\n\tstruct backing_dev_info *bdi = dev_get_drvdata(dev);\n\n\treturn snprintf(page, PAGE_SIZE-1, \"%d\\n\",\n\t\t\tbdi_cap_stable_pages_required(bdi) ? 1 : 0);\n}"
  },
  {
    "function_name": "max_ratio_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "194-210",
    "snippet": "static ssize_t max_ratio_store(struct device *dev,\n\t\tstruct device_attribute *attr, const char *buf, size_t count)\n{\n\tstruct backing_dev_info *bdi = dev_get_drvdata(dev);\n\tunsigned int ratio;\n\tssize_t ret;\n\n\tret = kstrtouint(buf, 10, &ratio);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = bdi_set_max_ratio(bdi, ratio);\n\tif (!ret)\n\t\tret = count;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bdi_set_max_ratio",
          "args": [
            "bdi",
            "ratio"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_set_max_ratio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "695-712",
          "snippet": "int bdi_set_max_ratio(struct backing_dev_info *bdi, unsigned max_ratio)\n{\n\tint ret = 0;\n\n\tif (max_ratio > 100)\n\t\treturn -EINVAL;\n\n\tspin_lock_bh(&bdi_lock);\n\tif (bdi->min_ratio > max_ratio) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tbdi->max_ratio = max_ratio;\n\t\tbdi->max_prop_frac = (FPROP_FRAC_BASE * max_ratio) / 100;\n\t}\n\tspin_unlock_bh(&bdi_lock);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nint bdi_set_max_ratio(struct backing_dev_info *bdi, unsigned max_ratio)\n{\n\tint ret = 0;\n\n\tif (max_ratio > 100)\n\t\treturn -EINVAL;\n\n\tspin_lock_bh(&bdi_lock);\n\tif (bdi->min_ratio > max_ratio) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tbdi->max_ratio = max_ratio;\n\t\tbdi->max_prop_frac = (FPROP_FRAC_BASE * max_ratio) / 100;\n\t}\n\tspin_unlock_bh(&bdi_lock);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtouint",
          "args": [
            "buf",
            "10",
            "&ratio"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_get_drvdata",
          "args": [
            "dev"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic ssize_t max_ratio_store(struct device *dev,\n\t\tstruct device_attribute *attr, const char *buf, size_t count)\n{\n\tstruct backing_dev_info *bdi = dev_get_drvdata(dev);\n\tunsigned int ratio;\n\tssize_t ret;\n\n\tret = kstrtouint(buf, 10, &ratio);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = bdi_set_max_ratio(bdi, ratio);\n\tif (!ret)\n\t\tret = count;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "min_ratio_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "175-191",
    "snippet": "static ssize_t min_ratio_store(struct device *dev,\n\t\tstruct device_attribute *attr, const char *buf, size_t count)\n{\n\tstruct backing_dev_info *bdi = dev_get_drvdata(dev);\n\tunsigned int ratio;\n\tssize_t ret;\n\n\tret = kstrtouint(buf, 10, &ratio);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = bdi_set_min_ratio(bdi, ratio);\n\tif (!ret)\n\t\tret = count;\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "bdi_set_min_ratio",
          "args": [
            "bdi",
            "ratio"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "bdi_set_min_ratio",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "674-693",
          "snippet": "int bdi_set_min_ratio(struct backing_dev_info *bdi, unsigned int min_ratio)\n{\n\tint ret = 0;\n\n\tspin_lock_bh(&bdi_lock);\n\tif (min_ratio > bdi->max_ratio) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tmin_ratio -= bdi->min_ratio;\n\t\tif (bdi_min_ratio + min_ratio < 100) {\n\t\t\tbdi_min_ratio += min_ratio;\n\t\t\tbdi->min_ratio += min_ratio;\n\t\t} else {\n\t\t\tret = -EINVAL;\n\t\t}\n\t}\n\tspin_unlock_bh(&bdi_lock);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned int bdi_min_ratio;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nstatic unsigned int bdi_min_ratio;\n\nint bdi_set_min_ratio(struct backing_dev_info *bdi, unsigned int min_ratio)\n{\n\tint ret = 0;\n\n\tspin_lock_bh(&bdi_lock);\n\tif (min_ratio > bdi->max_ratio) {\n\t\tret = -EINVAL;\n\t} else {\n\t\tmin_ratio -= bdi->min_ratio;\n\t\tif (bdi_min_ratio + min_ratio < 100) {\n\t\t\tbdi_min_ratio += min_ratio;\n\t\t\tbdi->min_ratio += min_ratio;\n\t\t} else {\n\t\t\tret = -EINVAL;\n\t\t}\n\t}\n\tspin_unlock_bh(&bdi_lock);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kstrtouint",
          "args": [
            "buf",
            "10",
            "&ratio"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_get_drvdata",
          "args": [
            "dev"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic ssize_t min_ratio_store(struct device *dev,\n\t\tstruct device_attribute *attr, const char *buf, size_t count)\n{\n\tstruct backing_dev_info *bdi = dev_get_drvdata(dev);\n\tunsigned int ratio;\n\tssize_t ret;\n\n\tret = kstrtouint(buf, 10, &ratio);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tret = bdi_set_min_ratio(bdi, ratio);\n\tif (!ret)\n\t\tret = count;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "read_ahead_kb_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "144-159",
    "snippet": "static ssize_t read_ahead_kb_store(struct device *dev,\n\t\t\t\t  struct device_attribute *attr,\n\t\t\t\t  const char *buf, size_t count)\n{\n\tstruct backing_dev_info *bdi = dev_get_drvdata(dev);\n\tunsigned long read_ahead_kb;\n\tssize_t ret;\n\n\tret = kstrtoul(buf, 10, &read_ahead_kb);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tbdi->ra_pages = read_ahead_kb >> (PAGE_SHIFT - 10);\n\n\treturn count;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtoul",
          "args": [
            "buf",
            "10",
            "&read_ahead_kb"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_get_drvdata",
          "args": [
            "dev"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic ssize_t read_ahead_kb_store(struct device *dev,\n\t\t\t\t  struct device_attribute *attr,\n\t\t\t\t  const char *buf, size_t count)\n{\n\tstruct backing_dev_info *bdi = dev_get_drvdata(dev);\n\tunsigned long read_ahead_kb;\n\tssize_t ret;\n\n\tret = kstrtoul(buf, 10, &read_ahead_kb);\n\tif (ret < 0)\n\t\treturn ret;\n\n\tbdi->ra_pages = read_ahead_kb >> (PAGE_SHIFT - 10);\n\n\treturn count;\n}"
  },
  {
    "function_name": "bdi_debug_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "139-141",
    "snippet": "static inline void bdi_debug_unregister(struct backing_dev_info *bdi)\n{\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic inline void bdi_debug_unregister(struct backing_dev_info *bdi)\n{\n}"
  },
  {
    "function_name": "bdi_debug_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "134-138",
    "snippet": "static inline int bdi_debug_register(struct backing_dev_info *bdi,\n\t\t\t\t      const char *name)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic inline int bdi_debug_register(struct backing_dev_info *bdi,\n\t\t\t\t      const char *name)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "bdi_debug_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "131-133",
    "snippet": "static inline void bdi_debug_init(void)\n{\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic inline void bdi_debug_init(void)\n{\n}"
  },
  {
    "function_name": "bdi_debug_unregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "125-129",
    "snippet": "static void bdi_debug_unregister(struct backing_dev_info *bdi)\n{\n\tdebugfs_remove(bdi->debug_stats);\n\tdebugfs_remove(bdi->debug_dir);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "bdi->debug_dir"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "bdi->debug_stats"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void bdi_debug_unregister(struct backing_dev_info *bdi)\n{\n\tdebugfs_remove(bdi->debug_stats);\n\tdebugfs_remove(bdi->debug_dir);\n}"
  },
  {
    "function_name": "bdi_debug_register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "105-123",
    "snippet": "static int bdi_debug_register(struct backing_dev_info *bdi, const char *name)\n{\n\tif (!bdi_debug_root)\n\t\treturn -ENOMEM;\n\n\tbdi->debug_dir = debugfs_create_dir(name, bdi_debug_root);\n\tif (!bdi->debug_dir)\n\t\treturn -ENOMEM;\n\n\tbdi->debug_stats = debugfs_create_file(\"stats\", 0444, bdi->debug_dir,\n\t\t\t\t\t       bdi, &bdi_debug_stats_fops);\n\tif (!bdi->debug_stats) {\n\t\tdebugfs_remove(bdi->debug_dir);\n\t\tbdi->debug_dir = NULL;\n\t\treturn -ENOMEM;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove",
          "args": [
            "bdi->debug_dir"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_file",
          "args": [
            "\"stats\"",
            "0444",
            "bdi->debug_dir",
            "bdi",
            "&bdi_debug_stats_fops"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "name",
            "bdi_debug_root"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic int bdi_debug_register(struct backing_dev_info *bdi, const char *name)\n{\n\tif (!bdi_debug_root)\n\t\treturn -ENOMEM;\n\n\tbdi->debug_dir = debugfs_create_dir(name, bdi_debug_root);\n\tif (!bdi->debug_dir)\n\t\treturn -ENOMEM;\n\n\tbdi->debug_stats = debugfs_create_file(\"stats\", 0444, bdi->debug_dir,\n\t\t\t\t\t       bdi, &bdi_debug_stats_fops);\n\tif (!bdi->debug_stats) {\n\t\tdebugfs_remove(bdi->debug_dir);\n\t\tbdi->debug_dir = NULL;\n\t\treturn -ENOMEM;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "bdi_debug_stats_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "44-102",
    "snippet": "static int bdi_debug_stats_show(struct seq_file *m, void *v)\n{\n\tstruct backing_dev_info *bdi = m->private;\n\tstruct bdi_writeback *wb = &bdi->wb;\n\tunsigned long background_thresh;\n\tunsigned long dirty_thresh;\n\tunsigned long wb_thresh;\n\tunsigned long nr_dirty, nr_io, nr_more_io, nr_dirty_time;\n\tstruct inode *inode;\n\n\tnr_dirty = nr_io = nr_more_io = nr_dirty_time = 0;\n\tspin_lock(&wb->list_lock);\n\tlist_for_each_entry(inode, &wb->b_dirty, i_io_list)\n\t\tnr_dirty++;\n\tlist_for_each_entry(inode, &wb->b_io, i_io_list)\n\t\tnr_io++;\n\tlist_for_each_entry(inode, &wb->b_more_io, i_io_list)\n\t\tnr_more_io++;\n\tlist_for_each_entry(inode, &wb->b_dirty_time, i_io_list)\n\t\tif (inode->i_state & I_DIRTY_TIME)\n\t\t\tnr_dirty_time++;\n\tspin_unlock(&wb->list_lock);\n\n\tglobal_dirty_limits(&background_thresh, &dirty_thresh);\n\twb_thresh = wb_calc_thresh(wb, dirty_thresh);\n\n#define K(x) ((x) << (PAGE_SHIFT - 10))\n\tseq_printf(m,\n\t\t   \"BdiWriteback:       %10lu kB\\n\"\n\t\t   \"BdiReclaimable:     %10lu kB\\n\"\n\t\t   \"BdiDirtyThresh:     %10lu kB\\n\"\n\t\t   \"DirtyThresh:        %10lu kB\\n\"\n\t\t   \"BackgroundThresh:   %10lu kB\\n\"\n\t\t   \"BdiDirtied:         %10lu kB\\n\"\n\t\t   \"BdiWritten:         %10lu kB\\n\"\n\t\t   \"BdiWriteBandwidth:  %10lu kBps\\n\"\n\t\t   \"b_dirty:            %10lu\\n\"\n\t\t   \"b_io:               %10lu\\n\"\n\t\t   \"b_more_io:          %10lu\\n\"\n\t\t   \"b_dirty_time:       %10lu\\n\"\n\t\t   \"bdi_list:           %10u\\n\"\n\t\t   \"state:              %10lx\\n\",\n\t\t   (unsigned long) K(wb_stat(wb, WB_WRITEBACK)),\n\t\t   (unsigned long) K(wb_stat(wb, WB_RECLAIMABLE)),\n\t\t   K(wb_thresh),\n\t\t   K(dirty_thresh),\n\t\t   K(background_thresh),\n\t\t   (unsigned long) K(wb_stat(wb, WB_DIRTIED)),\n\t\t   (unsigned long) K(wb_stat(wb, WB_WRITTEN)),\n\t\t   (unsigned long) K(wb->write_bandwidth),\n\t\t   nr_dirty,\n\t\t   nr_io,\n\t\t   nr_more_io,\n\t\t   nr_dirty_time,\n\t\t   !list_empty(&bdi->bdi_list), bdi->wb.state);\n#undef K\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);",
      "static void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"BdiWriteback:       %10lu kB\\n\"\n\t\t   \"BdiReclaimable:     %10lu kB\\n\"\n\t\t   \"BdiDirtyThresh:     %10lu kB\\n\"\n\t\t   \"DirtyThresh:        %10lu kB\\n\"\n\t\t   \"BackgroundThresh:   %10lu kB\\n\"\n\t\t   \"BdiDirtied:         %10lu kB\\n\"\n\t\t   \"BdiWritten:         %10lu kB\\n\"\n\t\t   \"BdiWriteBandwidth:  %10lu kBps\\n\"\n\t\t   \"b_dirty:            %10lu\\n\"\n\t\t   \"b_io:               %10lu\\n\"\n\t\t   \"b_more_io:          %10lu\\n\"\n\t\t   \"b_dirty_time:       %10lu\\n\"\n\t\t   \"bdi_list:           %10u\\n\"\n\t\t   \"state:              %10lx\\n\"",
            "(unsigned long) K(wb_stat(wb, WB_WRITEBACK))",
            "(unsigned long) K(wb_stat(wb, WB_RECLAIMABLE))",
            "K(wb_thresh)",
            "K(dirty_thresh)",
            "K(background_thresh)",
            "(unsigned long) K(wb_stat(wb, WB_DIRTIED))",
            "(unsigned long) K(wb_stat(wb, WB_WRITTEN))",
            "(unsigned long) K(wb->write_bandwidth)",
            "nr_dirty",
            "nr_io",
            "nr_more_io",
            "nr_dirty_time",
            "!list_empty(&bdi->bdi_list)",
            "bdi->wb.state"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&bdi->bdi_list"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "cluster_list_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "349-352",
          "snippet": "static inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline bool cluster_list_empty(struct swap_cluster_list *list)\n{\n\treturn cluster_is_null(&list->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "K",
          "args": [
            "wb->write_bandwidth"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "K",
          "args": [
            "wb_stat(wb, WB_WRITTEN)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_stat",
          "args": [
            "wb",
            "WB_WRITTEN"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "K",
          "args": [
            "wb_stat(wb, WB_DIRTIED)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_stat",
          "args": [
            "wb",
            "WB_DIRTIED"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "K",
          "args": [
            "background_thresh"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "K",
          "args": [
            "dirty_thresh"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "K",
          "args": [
            "wb_thresh"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "K",
          "args": [
            "wb_stat(wb, WB_RECLAIMABLE)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_stat",
          "args": [
            "wb",
            "WB_RECLAIMABLE"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "K",
          "args": [
            "wb_stat(wb, WB_WRITEBACK)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_stat",
          "args": [
            "wb",
            "WB_WRITEBACK"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wb_calc_thresh",
          "args": [
            "wb",
            "dirty_thresh"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "wb_calc_thresh",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "790-795",
          "snippet": "unsigned long wb_calc_thresh(struct bdi_writeback *wb, unsigned long thresh)\n{\n\tstruct dirty_throttle_control gdtc = { GDTC_INIT(wb),\n\t\t\t\t\t       .thresh = thresh };\n\treturn __wb_calc_thresh(&gdtc);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\nunsigned long wb_calc_thresh(struct bdi_writeback *wb, unsigned long thresh)\n{\n\tstruct dirty_throttle_control gdtc = { GDTC_INIT(wb),\n\t\t\t\t\t       .thresh = thresh };\n\treturn __wb_calc_thresh(&gdtc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "global_dirty_limits",
          "args": [
            "&background_thresh",
            "&dirty_thresh"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "global_dirty_limits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "458-467",
          "snippet": "void global_dirty_limits(unsigned long *pbackground, unsigned long *pdirty)\n{\n\tstruct dirty_throttle_control gdtc = { GDTC_INIT_NO_WB };\n\n\tgdtc.avail = global_dirtyable_memory();\n\tdomain_dirty_limits(&gdtc);\n\n\t*pbackground = gdtc.bg_thresh;\n\t*pdirty = gdtc.thresh;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define GDTC_INIT_NO_WB",
            "#define GDTC_INIT_NO_WB\t\t.dom = &global_wb_domain"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define GDTC_INIT_NO_WB\n#define GDTC_INIT_NO_WB\t\t.dom = &global_wb_domain\n\nvoid global_dirty_limits(unsigned long *pbackground, unsigned long *pdirty)\n{\n\tstruct dirty_throttle_control gdtc = { GDTC_INIT_NO_WB };\n\n\tgdtc.avail = global_dirtyable_memory();\n\tdomain_dirty_limits(&gdtc);\n\n\t*pbackground = gdtc.bg_thresh;\n\t*pdirty = gdtc.thresh;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&wb->list_lock"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "inode",
            "&wb->b_dirty_time",
            "i_io_list"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "inode",
            "&wb->b_more_io",
            "i_io_list"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "inode",
            "&wb->b_io",
            "i_io_list"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "inode",
            "&wb->b_dirty",
            "i_io_list"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&wb->list_lock"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\nstatic void cgwb_remove_from_bdi_list(struct bdi_writeback *wb);\n\nstatic int bdi_debug_stats_show(struct seq_file *m, void *v)\n{\n\tstruct backing_dev_info *bdi = m->private;\n\tstruct bdi_writeback *wb = &bdi->wb;\n\tunsigned long background_thresh;\n\tunsigned long dirty_thresh;\n\tunsigned long wb_thresh;\n\tunsigned long nr_dirty, nr_io, nr_more_io, nr_dirty_time;\n\tstruct inode *inode;\n\n\tnr_dirty = nr_io = nr_more_io = nr_dirty_time = 0;\n\tspin_lock(&wb->list_lock);\n\tlist_for_each_entry(inode, &wb->b_dirty, i_io_list)\n\t\tnr_dirty++;\n\tlist_for_each_entry(inode, &wb->b_io, i_io_list)\n\t\tnr_io++;\n\tlist_for_each_entry(inode, &wb->b_more_io, i_io_list)\n\t\tnr_more_io++;\n\tlist_for_each_entry(inode, &wb->b_dirty_time, i_io_list)\n\t\tif (inode->i_state & I_DIRTY_TIME)\n\t\t\tnr_dirty_time++;\n\tspin_unlock(&wb->list_lock);\n\n\tglobal_dirty_limits(&background_thresh, &dirty_thresh);\n\twb_thresh = wb_calc_thresh(wb, dirty_thresh);\n\n#define K(x) ((x) << (PAGE_SHIFT - 10))\n\tseq_printf(m,\n\t\t   \"BdiWriteback:       %10lu kB\\n\"\n\t\t   \"BdiReclaimable:     %10lu kB\\n\"\n\t\t   \"BdiDirtyThresh:     %10lu kB\\n\"\n\t\t   \"DirtyThresh:        %10lu kB\\n\"\n\t\t   \"BackgroundThresh:   %10lu kB\\n\"\n\t\t   \"BdiDirtied:         %10lu kB\\n\"\n\t\t   \"BdiWritten:         %10lu kB\\n\"\n\t\t   \"BdiWriteBandwidth:  %10lu kBps\\n\"\n\t\t   \"b_dirty:            %10lu\\n\"\n\t\t   \"b_io:               %10lu\\n\"\n\t\t   \"b_more_io:          %10lu\\n\"\n\t\t   \"b_dirty_time:       %10lu\\n\"\n\t\t   \"bdi_list:           %10u\\n\"\n\t\t   \"state:              %10lx\\n\",\n\t\t   (unsigned long) K(wb_stat(wb, WB_WRITEBACK)),\n\t\t   (unsigned long) K(wb_stat(wb, WB_RECLAIMABLE)),\n\t\t   K(wb_thresh),\n\t\t   K(dirty_thresh),\n\t\t   K(background_thresh),\n\t\t   (unsigned long) K(wb_stat(wb, WB_DIRTIED)),\n\t\t   (unsigned long) K(wb_stat(wb, WB_WRITTEN)),\n\t\t   (unsigned long) K(wb->write_bandwidth),\n\t\t   nr_dirty,\n\t\t   nr_io,\n\t\t   nr_more_io,\n\t\t   nr_dirty_time,\n\t\t   !list_empty(&bdi->bdi_list), bdi->wb.state);\n#undef K\n\n\treturn 0;\n}"
  },
  {
    "function_name": "bdi_debug_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/backing-dev.c",
    "lines": "39-42",
    "snippet": "static void bdi_debug_init(void)\n{\n\tbdi_debug_root = debugfs_create_dir(\"bdi\", NULL);\n}",
    "includes": [
      "#include <linux/memcontrol.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/debugfs.h>",
      "#include <trace/events/writeback.h>",
      "#include <linux/device.h>",
      "#include <linux/writeback.h>",
      "#include <linux/module.h>",
      "#include <linux/sched.h>",
      "#include <linux/mm.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/fs.h>",
      "#include <linux/freezer.h>",
      "#include <linux/kthread.h>",
      "#include <linux/backing-dev.h>",
      "#include <linux/wait.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int bdi_init(struct backing_dev_info *bdi);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"bdi\"",
            "NULL"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <trace/events/writeback.h>\n#include <linux/device.h>\n#include <linux/writeback.h>\n#include <linux/module.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n#include <linux/pagemap.h>\n#include <linux/fs.h>\n#include <linux/freezer.h>\n#include <linux/kthread.h>\n#include <linux/backing-dev.h>\n#include <linux/wait.h>\n\nstatic int bdi_init(struct backing_dev_info *bdi);\n\nstatic void bdi_debug_init(void)\n{\n\tbdi_debug_root = debugfs_create_dir(\"bdi\", NULL);\n}"
  }
]