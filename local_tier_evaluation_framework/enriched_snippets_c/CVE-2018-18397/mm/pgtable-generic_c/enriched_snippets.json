[
  {
    "function_name": "pmdp_collapse_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "195-211",
    "snippet": "pmd_t pmdp_collapse_flush(struct vm_area_struct *vma, unsigned long address,\n\t\t\t  pmd_t *pmdp)\n{\n\t/*\n\t * pmd and hugepage pte format are same. So we could\n\t * use the same function.\n\t */\n\tpmd_t pmd;\n\n\tVM_BUG_ON(address & ~HPAGE_PMD_MASK);\n\tVM_BUG_ON(pmd_trans_huge(*pmdp));\n\tpmd = pmdp_huge_get_and_clear(vma->vm_mm, address, pmdp);\n\n\t/* collapse entails shooting down ptes not pmd */\n\tflush_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\treturn pmd;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_tlb_range",
          "args": [
            "vma",
            "address",
            "address + HPAGE_PMD_SIZE"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmdp_huge_get_and_clear",
          "args": [
            "vma->vm_mm",
            "address",
            "pmdp"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "pmd_trans_huge(*pmdp)"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_trans_huge",
          "args": [
            "*pmdp"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "address & ~HPAGE_PMD_MASK"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\npmd_t pmdp_collapse_flush(struct vm_area_struct *vma, unsigned long address,\n\t\t\t  pmd_t *pmdp)\n{\n\t/*\n\t * pmd and hugepage pte format are same. So we could\n\t * use the same function.\n\t */\n\tpmd_t pmd;\n\n\tVM_BUG_ON(address & ~HPAGE_PMD_MASK);\n\tVM_BUG_ON(pmd_trans_huge(*pmdp));\n\tpmd = pmdp_huge_get_and_clear(vma->vm_mm, address, pmdp);\n\n\t/* collapse entails shooting down ptes not pmd */\n\tflush_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\treturn pmd;\n}"
  },
  {
    "function_name": "pmdp_invalidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "185-191",
    "snippet": "pmd_t pmdp_invalidate(struct vm_area_struct *vma, unsigned long address,\n\t\t     pmd_t *pmdp)\n{\n\tpmd_t old = pmdp_establish(vma, address, pmdp, pmd_mknotpresent(*pmdp));\n\tflush_pmd_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\treturn old;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_pmd_tlb_range",
          "args": [
            "vma",
            "address",
            "address + HPAGE_PMD_SIZE"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmdp_establish",
          "args": [
            "vma",
            "address",
            "pmdp",
            "pmd_mknotpresent(*pmdp)"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_mknotpresent",
          "args": [
            "*pmdp"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\npmd_t pmdp_invalidate(struct vm_area_struct *vma, unsigned long address,\n\t\t     pmd_t *pmdp)\n{\n\tpmd_t old = pmdp_establish(vma, address, pmdp, pmd_mknotpresent(*pmdp));\n\tflush_pmd_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\treturn old;\n}"
  },
  {
    "function_name": "pgtable_trans_huge_withdraw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "168-181",
    "snippet": "pgtable_t pgtable_trans_huge_withdraw(struct mm_struct *mm, pmd_t *pmdp)\n{\n\tpgtable_t pgtable;\n\n\tassert_spin_locked(pmd_lockptr(mm, pmdp));\n\n\t/* FIFO */\n\tpgtable = pmd_huge_pte(mm, pmdp);\n\tpmd_huge_pte(mm, pmdp) = list_first_entry_or_null(&pgtable->lru,\n\t\t\t\t\t\t\t  struct page, lru);\n\tif (pmd_huge_pte(mm, pmdp))\n\t\tlist_del(&pgtable->lru);\n\treturn pgtable;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&pgtable->lru"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_huge_pte",
          "args": [
            "mm",
            "pmdp"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry_or_null",
          "args": [
            "&pgtable->lru",
            "structpage",
            "lru"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_huge_pte",
          "args": [
            "mm",
            "pmdp"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_huge_pte",
          "args": [
            "mm",
            "pmdp"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "pmd_lockptr(mm, pmdp)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_lockptr",
          "args": [
            "mm",
            "pmdp"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\npgtable_t pgtable_trans_huge_withdraw(struct mm_struct *mm, pmd_t *pmdp)\n{\n\tpgtable_t pgtable;\n\n\tassert_spin_locked(pmd_lockptr(mm, pmdp));\n\n\t/* FIFO */\n\tpgtable = pmd_huge_pte(mm, pmdp);\n\tpmd_huge_pte(mm, pmdp) = list_first_entry_or_null(&pgtable->lru,\n\t\t\t\t\t\t\t  struct page, lru);\n\tif (pmd_huge_pte(mm, pmdp))\n\t\tlist_del(&pgtable->lru);\n\treturn pgtable;\n}"
  },
  {
    "function_name": "pgtable_trans_huge_deposit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "152-163",
    "snippet": "void pgtable_trans_huge_deposit(struct mm_struct *mm, pmd_t *pmdp,\n\t\t\t\tpgtable_t pgtable)\n{\n\tassert_spin_locked(pmd_lockptr(mm, pmdp));\n\n\t/* FIFO */\n\tif (!pmd_huge_pte(mm, pmdp))\n\t\tINIT_LIST_HEAD(&pgtable->lru);\n\telse\n\t\tlist_add(&pgtable->lru, &pmd_huge_pte(mm, pmdp)->lru);\n\tpmd_huge_pte(mm, pmdp) = pgtable;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pmd_huge_pte",
          "args": [
            "mm",
            "pmdp"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&pgtable->lru",
            "&pmd_huge_pte(mm, pmdp)->lru"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_huge_pte",
          "args": [
            "mm",
            "pmdp"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&pgtable->lru"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_huge_pte",
          "args": [
            "mm",
            "pmdp"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "pmd_lockptr(mm, pmdp)"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_lockptr",
          "args": [
            "mm",
            "pmdp"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pgtable_trans_huge_deposit(struct mm_struct *mm, pmd_t *pmdp,\n\t\t\t\tpgtable_t pgtable)\n{\n\tassert_spin_locked(pmd_lockptr(mm, pmdp));\n\n\t/* FIFO */\n\tif (!pmd_huge_pte(mm, pmdp))\n\t\tINIT_LIST_HEAD(&pgtable->lru);\n\telse\n\t\tlist_add(&pgtable->lru, &pmd_huge_pte(mm, pmdp)->lru);\n\tpmd_huge_pte(mm, pmdp) = pgtable;\n}"
  },
  {
    "function_name": "pudp_huge_clear_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "137-147",
    "snippet": "pud_t pudp_huge_clear_flush(struct vm_area_struct *vma, unsigned long address,\n\t\t\t    pud_t *pudp)\n{\n\tpud_t pud;\n\n\tVM_BUG_ON(address & ~HPAGE_PUD_MASK);\n\tVM_BUG_ON(!pud_trans_huge(*pudp) && !pud_devmap(*pudp));\n\tpud = pudp_huge_get_and_clear(vma->vm_mm, address, pudp);\n\tflush_pud_tlb_range(vma, address, address + HPAGE_PUD_SIZE);\n\treturn pud;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_pud_tlb_range",
          "args": [
            "vma",
            "address",
            "address + HPAGE_PUD_SIZE"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pudp_huge_get_and_clear",
          "args": [
            "vma->vm_mm",
            "address",
            "pudp"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "!pud_trans_huge(*pudp) && !pud_devmap(*pudp)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_devmap",
          "args": [
            "*pudp"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_trans_huge",
          "args": [
            "*pudp"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "address & ~HPAGE_PUD_MASK"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\npud_t pudp_huge_clear_flush(struct vm_area_struct *vma, unsigned long address,\n\t\t\t    pud_t *pudp)\n{\n\tpud_t pud;\n\n\tVM_BUG_ON(address & ~HPAGE_PUD_MASK);\n\tVM_BUG_ON(!pud_trans_huge(*pudp) && !pud_devmap(*pudp));\n\tpud = pudp_huge_get_and_clear(vma->vm_mm, address, pudp);\n\tflush_pud_tlb_range(vma, address, address + HPAGE_PUD_SIZE);\n\treturn pud;\n}"
  },
  {
    "function_name": "pmdp_huge_clear_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "124-134",
    "snippet": "pmd_t pmdp_huge_clear_flush(struct vm_area_struct *vma, unsigned long address,\n\t\t\t    pmd_t *pmdp)\n{\n\tpmd_t pmd;\n\tVM_BUG_ON(address & ~HPAGE_PMD_MASK);\n\tVM_BUG_ON((pmd_present(*pmdp) && !pmd_trans_huge(*pmdp) &&\n\t\t\t   !pmd_devmap(*pmdp)) || !pmd_present(*pmdp));\n\tpmd = pmdp_huge_get_and_clear(vma->vm_mm, address, pmdp);\n\tflush_pmd_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\treturn pmd;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_pmd_tlb_range",
          "args": [
            "vma",
            "address",
            "address + HPAGE_PMD_SIZE"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmdp_huge_get_and_clear",
          "args": [
            "vma->vm_mm",
            "address",
            "pmdp"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "(pmd_present(*pmdp) && !pmd_trans_huge(*pmdp) &&\n\t\t\t   !pmd_devmap(*pmdp)) || !pmd_present(*pmdp)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_present",
          "args": [
            "*pmdp"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_devmap",
          "args": [
            "*pmdp"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "pmd_devmap_trans_unstable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory.c",
          "lines": "3023-3026",
          "snippet": "static int pmd_devmap_trans_unstable(pmd_t *pmd)\n{\n\treturn pmd_devmap(*pmd) || pmd_trans_unstable(pmd);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/io.h>",
            "#include <linux/oom.h>",
            "#include <linux/dax.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/dma-debug.h>",
            "#include <linux/string.h>",
            "#include <linux/migrate.h>",
            "#include <linux/gfp.h>",
            "#include <linux/elf.h>",
            "#include <linux/swapops.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pfn_t.h>",
            "#include <linux/init.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/export.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/memremap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel_stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <asm/mmu_context.h>\n#include <asm/io.h>\n#include <linux/oom.h>\n#include <linux/dax.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/debugfs.h>\n#include <linux/dma-debug.h>\n#include <linux/string.h>\n#include <linux/migrate.h>\n#include <linux/gfp.h>\n#include <linux/elf.h>\n#include <linux/swapops.h>\n#include <linux/mmu_notifier.h>\n#include <linux/memcontrol.h>\n#include <linux/writeback.h>\n#include <linux/pfn_t.h>\n#include <linux/init.h>\n#include <linux/delayacct.h>\n#include <linux/export.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/memremap.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/kernel_stat.h>\n\nstatic int pmd_devmap_trans_unstable(pmd_t *pmd)\n{\n\treturn pmd_devmap(*pmd) || pmd_trans_unstable(pmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pmd_trans_huge",
          "args": [
            "*pmdp"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_present",
          "args": [
            "*pmdp"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "address & ~HPAGE_PMD_MASK"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\npmd_t pmdp_huge_clear_flush(struct vm_area_struct *vma, unsigned long address,\n\t\t\t    pmd_t *pmdp)\n{\n\tpmd_t pmd;\n\tVM_BUG_ON(address & ~HPAGE_PMD_MASK);\n\tVM_BUG_ON((pmd_present(*pmdp) && !pmd_trans_huge(*pmdp) &&\n\t\t\t   !pmd_devmap(*pmdp)) || !pmd_present(*pmdp));\n\tpmd = pmdp_huge_get_and_clear(vma->vm_mm, address, pmdp);\n\tflush_pmd_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\treturn pmd;\n}"
  },
  {
    "function_name": "pmdp_clear_flush_young",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "111-120",
    "snippet": "int pmdp_clear_flush_young(struct vm_area_struct *vma,\n\t\t\t   unsigned long address, pmd_t *pmdp)\n{\n\tint young;\n\tVM_BUG_ON(address & ~HPAGE_PMD_MASK);\n\tyoung = pmdp_test_and_clear_young(vma, address, pmdp);\n\tif (young)\n\t\tflush_pmd_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\treturn young;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_pmd_tlb_range",
          "args": [
            "vma",
            "address",
            "address + HPAGE_PMD_SIZE"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmdp_test_and_clear_young",
          "args": [
            "vma",
            "address",
            "pmdp"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "address & ~HPAGE_PMD_MASK"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nint pmdp_clear_flush_young(struct vm_area_struct *vma,\n\t\t\t   unsigned long address, pmd_t *pmdp)\n{\n\tint young;\n\tVM_BUG_ON(address & ~HPAGE_PMD_MASK);\n\tyoung = pmdp_test_and_clear_young(vma, address, pmdp);\n\tif (young)\n\t\tflush_pmd_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\treturn young;\n}"
  },
  {
    "function_name": "pmdp_set_access_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "96-107",
    "snippet": "int pmdp_set_access_flags(struct vm_area_struct *vma,\n\t\t\t  unsigned long address, pmd_t *pmdp,\n\t\t\t  pmd_t entry, int dirty)\n{\n\tint changed = !pmd_same(*pmdp, entry);\n\tVM_BUG_ON(address & ~HPAGE_PMD_MASK);\n\tif (changed) {\n\t\tset_pmd_at(vma->vm_mm, address, pmdp, entry);\n\t\tflush_pmd_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\t}\n\treturn changed;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_pmd_tlb_range",
          "args": [
            "vma",
            "address",
            "address + HPAGE_PMD_SIZE"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_pmd_at",
          "args": [
            "vma->vm_mm",
            "address",
            "pmdp",
            "entry"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VM_BUG_ON",
          "args": [
            "address & ~HPAGE_PMD_MASK"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_same",
          "args": [
            "*pmdp",
            "entry"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nint pmdp_set_access_flags(struct vm_area_struct *vma,\n\t\t\t  unsigned long address, pmd_t *pmdp,\n\t\t\t  pmd_t entry, int dirty)\n{\n\tint changed = !pmd_same(*pmdp, entry);\n\tVM_BUG_ON(address & ~HPAGE_PMD_MASK);\n\tif (changed) {\n\t\tset_pmd_at(vma->vm_mm, address, pmdp, entry);\n\t\tflush_pmd_tlb_range(vma, address, address + HPAGE_PMD_SIZE);\n\t}\n\treturn changed;\n}"
  },
  {
    "function_name": "ptep_clear_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "81-90",
    "snippet": "pte_t ptep_clear_flush(struct vm_area_struct *vma, unsigned long address,\n\t\t       pte_t *ptep)\n{\n\tstruct mm_struct *mm = (vma)->vm_mm;\n\tpte_t pte;\n\tpte = ptep_get_and_clear(mm, address, ptep);\n\tif (pte_accessible(mm, pte))\n\t\tflush_tlb_page(vma, address);\n\treturn pte;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_tlb_page",
          "args": [
            "vma",
            "address"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_accessible",
          "args": [
            "mm",
            "pte"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptep_get_and_clear",
          "args": [
            "mm",
            "address",
            "ptep"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\npte_t ptep_clear_flush(struct vm_area_struct *vma, unsigned long address,\n\t\t       pte_t *ptep)\n{\n\tstruct mm_struct *mm = (vma)->vm_mm;\n\tpte_t pte;\n\tpte = ptep_get_and_clear(mm, address, ptep);\n\tif (pte_accessible(mm, pte))\n\t\tflush_tlb_page(vma, address);\n\treturn pte;\n}"
  },
  {
    "function_name": "ptep_clear_flush_young",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "69-77",
    "snippet": "int ptep_clear_flush_young(struct vm_area_struct *vma,\n\t\t\t   unsigned long address, pte_t *ptep)\n{\n\tint young;\n\tyoung = ptep_test_and_clear_young(vma, address, ptep);\n\tif (young)\n\t\tflush_tlb_page(vma, address);\n\treturn young;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_tlb_page",
          "args": [
            "vma",
            "address"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptep_test_and_clear_young",
          "args": [
            "vma",
            "address",
            "ptep"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nint ptep_clear_flush_young(struct vm_area_struct *vma,\n\t\t\t   unsigned long address, pte_t *ptep)\n{\n\tint young;\n\tyoung = ptep_test_and_clear_young(vma, address, ptep);\n\tif (young)\n\t\tflush_tlb_page(vma, address);\n\treturn young;\n}"
  },
  {
    "function_name": "ptep_set_access_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "55-65",
    "snippet": "int ptep_set_access_flags(struct vm_area_struct *vma,\n\t\t\t  unsigned long address, pte_t *ptep,\n\t\t\t  pte_t entry, int dirty)\n{\n\tint changed = !pte_same(*ptep, entry);\n\tif (changed) {\n\t\tset_pte_at(vma->vm_mm, address, ptep, entry);\n\t\tflush_tlb_fix_spurious_fault(vma, address);\n\t}\n\treturn changed;\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flush_tlb_fix_spurious_fault",
          "args": [
            "vma",
            "address"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_pte_at",
          "args": [
            "vma->vm_mm",
            "address",
            "ptep",
            "entry"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_same",
          "args": [
            "*ptep",
            "entry"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "pte_same_as_swp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "1735-1738",
          "snippet": "static inline int pte_same_as_swp(pte_t pte, pte_t swp_pte)\n{\n\treturn pte_same(pte_swp_clear_soft_dirty(pte), swp_pte);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic inline int pte_same_as_swp(pte_t pte, pte_t swp_pte)\n{\n\treturn pte_same(pte_swp_clear_soft_dirty(pte), swp_pte);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nint ptep_set_access_flags(struct vm_area_struct *vma,\n\t\t\t  unsigned long address, pte_t *ptep,\n\t\t\t  pte_t entry, int dirty)\n{\n\tint changed = !pte_same(*ptep, entry);\n\tif (changed) {\n\t\tset_pte_at(vma->vm_mm, address, ptep, entry);\n\t\tflush_tlb_fix_spurious_fault(vma, address);\n\t}\n\treturn changed;\n}"
  },
  {
    "function_name": "pmd_clear_bad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "39-43",
    "snippet": "void pmd_clear_bad(pmd_t *pmd)\n{\n\tpmd_ERROR(*pmd);\n\tpmd_clear(pmd);\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pmd_clear",
          "args": [
            "pmd"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "pmd_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "39-43",
          "snippet": "void pmd_clear_bad(pmd_t *pmd)\n{\n\tpmd_ERROR(*pmd);\n\tpmd_clear(pmd);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "pmd_ERROR",
          "args": [
            "*pmd"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pmd_clear_bad(pmd_t *pmd)\n{\n\tpmd_ERROR(*pmd);\n\tpmd_clear(pmd);\n}"
  },
  {
    "function_name": "pud_clear_bad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "33-37",
    "snippet": "void pud_clear_bad(pud_t *pud)\n{\n\tpud_ERROR(*pud);\n\tpud_clear(pud);\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pud_clear",
          "args": [
            "pud"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "pud_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "33-37",
          "snippet": "void pud_clear_bad(pud_t *pud)\n{\n\tpud_ERROR(*pud);\n\tpud_clear(pud);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "pud_ERROR",
          "args": [
            "*pud"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pud_clear_bad(pud_t *pud)\n{\n\tpud_ERROR(*pud);\n\tpud_clear(pud);\n}"
  },
  {
    "function_name": "p4d_clear_bad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "27-31",
    "snippet": "void p4d_clear_bad(p4d_t *p4d)\n{\n\tp4d_ERROR(*p4d);\n\tp4d_clear(p4d);\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p4d_clear",
          "args": [
            "p4d"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "p4d_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "27-31",
          "snippet": "void p4d_clear_bad(p4d_t *p4d)\n{\n\tp4d_ERROR(*p4d);\n\tp4d_clear(p4d);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "p4d_ERROR",
          "args": [
            "*p4d"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid p4d_clear_bad(p4d_t *p4d)\n{\n\tp4d_ERROR(*p4d);\n\tp4d_clear(p4d);\n}"
  },
  {
    "function_name": "pgd_clear_bad",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
    "lines": "21-25",
    "snippet": "void pgd_clear_bad(pgd_t *pgd)\n{\n\tpgd_ERROR(*pgd);\n\tpgd_clear(pgd);\n}",
    "includes": [
      "#include <asm-generic/pgtable.h>",
      "#include <asm/tlb.h>",
      "#include <linux/hugetlb.h>",
      "#include <linux/pagemap.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pgd_clear",
          "args": [
            "pgd"
          ],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "pgd_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "21-25",
          "snippet": "void pgd_clear_bad(pgd_t *pgd)\n{\n\tpgd_ERROR(*pgd);\n\tpgd_clear(pgd);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "pgd_ERROR",
          "args": [
            "*pgd"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pgd_clear_bad(pgd_t *pgd)\n{\n\tpgd_ERROR(*pgd);\n\tpgd_clear(pgd);\n}"
  }
]