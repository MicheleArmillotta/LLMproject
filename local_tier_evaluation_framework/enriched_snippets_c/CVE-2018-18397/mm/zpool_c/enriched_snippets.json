[
  {
    "function_name": "zpool_evictable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "374-377",
    "snippet": "bool zpool_evictable(struct zpool *zpool)\n{\n\treturn zpool->evictable;\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nbool zpool_evictable(struct zpool *zpool)\n{\n\treturn zpool->evictable;\n}"
  },
  {
    "function_name": "zpool_get_total_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "356-359",
    "snippet": "u64 zpool_get_total_size(struct zpool *zpool)\n{\n\treturn zpool->driver->total_size(zpool->pool);\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zpool->driver->total_size",
          "args": [
            "zpool->pool"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nu64 zpool_get_total_size(struct zpool *zpool)\n{\n\treturn zpool->driver->total_size(zpool->pool);\n}"
  },
  {
    "function_name": "zpool_unmap_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "343-346",
    "snippet": "void zpool_unmap_handle(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->unmap(zpool->pool, handle);\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zpool->driver->unmap",
          "args": [
            "zpool->pool",
            "handle"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid zpool_unmap_handle(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->unmap(zpool->pool, handle);\n}"
  },
  {
    "function_name": "zpool_map_handle",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "327-331",
    "snippet": "void *zpool_map_handle(struct zpool *zpool, unsigned long handle,\n\t\t\tenum zpool_mapmode mapmode)\n{\n\treturn zpool->driver->map(zpool->pool, handle, mapmode);\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zpool->driver->map",
          "args": [
            "zpool->pool",
            "handle",
            "mapmode"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid *zpool_map_handle(struct zpool *zpool, unsigned long handle,\n\t\t\tenum zpool_mapmode mapmode)\n{\n\treturn zpool->driver->map(zpool->pool, handle, mapmode);\n}"
  },
  {
    "function_name": "zpool_shrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "298-303",
    "snippet": "int zpool_shrink(struct zpool *zpool, unsigned int pages,\n\t\t\tunsigned int *reclaimed)\n{\n\treturn zpool->driver->shrink ?\n\t       zpool->driver->shrink(zpool->pool, pages, reclaimed) : -EINVAL;\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zpool->driver->shrink",
          "args": [
            "zpool->pool",
            "pages",
            "reclaimed"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nint zpool_shrink(struct zpool *zpool, unsigned int pages,\n\t\t\tunsigned int *reclaimed)\n{\n\treturn zpool->driver->shrink ?\n\t       zpool->driver->shrink(zpool->pool, pages, reclaimed) : -EINVAL;\n}"
  },
  {
    "function_name": "zpool_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "276-279",
    "snippet": "void zpool_free(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->free(zpool->pool, handle);\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zpool->driver->free",
          "args": [
            "zpool->pool",
            "handle"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid zpool_free(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->free(zpool->pool, handle);\n}"
  },
  {
    "function_name": "zpool_malloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "256-260",
    "snippet": "int zpool_malloc(struct zpool *zpool, size_t size, gfp_t gfp,\n\t\t\tunsigned long *handle)\n{\n\treturn zpool->driver->malloc(zpool->pool, size, gfp, handle);\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zpool->driver->malloc",
          "args": [
            "zpool->pool",
            "size",
            "gfp",
            "handle"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nint zpool_malloc(struct zpool *zpool, size_t size, gfp_t gfp,\n\t\t\tunsigned long *handle)\n{\n\treturn zpool->driver->malloc(zpool->pool, size, gfp, handle);\n}"
  },
  {
    "function_name": "zpool_get_type",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "235-238",
    "snippet": "const char *zpool_get_type(struct zpool *zpool)\n{\n\treturn zpool->driver->type;\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nconst char *zpool_get_type(struct zpool *zpool)\n{\n\treturn zpool->driver->type;\n}"
  },
  {
    "function_name": "zpool_destroy_pool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "213-223",
    "snippet": "void zpool_destroy_pool(struct zpool *zpool)\n{\n\tpr_debug(\"destroying pool type %s\\n\", zpool->driver->type);\n\n\tspin_lock(&pools_lock);\n\tlist_del(&zpool->list);\n\tspin_unlock(&pools_lock);\n\tzpool->driver->destroy(zpool->pool);\n\tzpool_put_driver(zpool->driver);\n\tkfree(zpool);\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(pools_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "zpool"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_put_driver",
          "args": [
            "zpool->driver"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_put_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "96-100",
          "snippet": "static void zpool_put_driver(struct zpool_driver *driver)\n{\n\tatomic_dec(&driver->refcount);\n\tmodule_put(driver->owner);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic void zpool_put_driver(struct zpool_driver *driver)\n{\n\tatomic_dec(&driver->refcount);\n\tmodule_put(driver->owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool->driver->destroy",
          "args": [
            "zpool->pool"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&pools_lock"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&zpool->list"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&pools_lock"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"destroying pool type %s\\n\"",
            "zpool->driver->type"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(pools_lock);\n\nvoid zpool_destroy_pool(struct zpool *zpool)\n{\n\tpr_debug(\"destroying pool type %s\\n\", zpool->driver->type);\n\n\tspin_lock(&pools_lock);\n\tlist_del(&zpool->list);\n\tspin_unlock(&pools_lock);\n\tzpool->driver->destroy(zpool->pool);\n\tzpool_put_driver(zpool->driver);\n\tkfree(zpool);\n}"
  },
  {
    "function_name": "zpool_create_pool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "154-200",
    "snippet": "struct zpool *zpool_create_pool(const char *type, const char *name, gfp_t gfp,\n\t\tconst struct zpool_ops *ops)\n{\n\tstruct zpool_driver *driver;\n\tstruct zpool *zpool;\n\n\tpr_debug(\"creating pool type %s\\n\", type);\n\n\tdriver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver) {\n\t\tpr_err(\"no driver for type %s\\n\", type);\n\t\treturn NULL;\n\t}\n\n\tzpool = kmalloc(sizeof(*zpool), gfp);\n\tif (!zpool) {\n\t\tpr_err(\"couldn't create zpool - out of memory\\n\");\n\t\tzpool_put_driver(driver);\n\t\treturn NULL;\n\t}\n\n\tzpool->driver = driver;\n\tzpool->pool = driver->create(name, gfp, ops, zpool);\n\tzpool->ops = ops;\n\tzpool->evictable = driver->shrink && ops && ops->evict;\n\n\tif (!zpool->pool) {\n\t\tpr_err(\"couldn't create %s pool\\n\", type);\n\t\tzpool_put_driver(driver);\n\t\tkfree(zpool);\n\t\treturn NULL;\n\t}\n\n\tpr_debug(\"created pool type %s\\n\", type);\n\n\tspin_lock(&pools_lock);\n\tlist_add(&zpool->list, &pools_head);\n\tspin_unlock(&pools_lock);\n\n\treturn zpool;\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(pools_head);",
      "static DEFINE_SPINLOCK(pools_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&pools_lock"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&zpool->list",
            "&pools_head"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&pools_lock"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"created pool type %s\\n\"",
            "type"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "zpool"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_put_driver",
          "args": [
            "driver"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_put_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "96-100",
          "snippet": "static void zpool_put_driver(struct zpool_driver *driver)\n{\n\tatomic_dec(&driver->refcount);\n\tmodule_put(driver->owner);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic void zpool_put_driver(struct zpool_driver *driver)\n{\n\tatomic_dec(&driver->refcount);\n\tmodule_put(driver->owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"couldn't create %s pool\\n\"",
            "type"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "driver->create",
          "args": [
            "name",
            "gfp",
            "ops",
            "zpool"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"couldn't create zpool - out of memory\\n\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*zpool)",
            "gfp"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "__kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3729-3732",
          "snippet": "void *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nvoid *__kmalloc(size_t size, gfp_t flags)\n{\n\treturn __do_kmalloc(size, flags, _RET_IP_);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"no driver for type %s\\n\"",
            "type"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_get_driver",
          "args": [
            "type"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_get_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "76-94",
          "snippet": "static struct zpool_driver *zpool_get_driver(const char *type)\n{\n\tstruct zpool_driver *driver;\n\n\tspin_lock(&drivers_lock);\n\tlist_for_each_entry(driver, &drivers_head, list) {\n\t\tif (!strcmp(driver->type, type)) {\n\t\t\tbool got = try_module_get(driver->owner);\n\n\t\t\tif (got)\n\t\t\t\tatomic_inc(&driver->refcount);\n\t\t\tspin_unlock(&drivers_lock);\n\t\t\treturn got ? driver : NULL;\n\t\t}\n\t}\n\n\tspin_unlock(&drivers_lock);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(drivers_head);",
            "static DEFINE_SPINLOCK(drivers_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic LIST_HEAD(drivers_head);\nstatic DEFINE_SPINLOCK(drivers_lock);\n\nstatic struct zpool_driver *zpool_get_driver(const char *type)\n{\n\tstruct zpool_driver *driver;\n\n\tspin_lock(&drivers_lock);\n\tlist_for_each_entry(driver, &drivers_head, list) {\n\t\tif (!strcmp(driver->type, type)) {\n\t\t\tbool got = try_module_get(driver->owner);\n\n\t\t\tif (got)\n\t\t\t\tatomic_inc(&driver->refcount);\n\t\t\tspin_unlock(&drivers_lock);\n\t\t\treturn got ? driver : NULL;\n\t\t}\n\t}\n\n\tspin_unlock(&drivers_lock);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "\"zpool-%s\"",
            "type"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"creating pool type %s\\n\"",
            "type"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic LIST_HEAD(pools_head);\nstatic DEFINE_SPINLOCK(pools_lock);\n\nstruct zpool *zpool_create_pool(const char *type, const char *name, gfp_t gfp,\n\t\tconst struct zpool_ops *ops)\n{\n\tstruct zpool_driver *driver;\n\tstruct zpool *zpool;\n\n\tpr_debug(\"creating pool type %s\\n\", type);\n\n\tdriver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver) {\n\t\tpr_err(\"no driver for type %s\\n\", type);\n\t\treturn NULL;\n\t}\n\n\tzpool = kmalloc(sizeof(*zpool), gfp);\n\tif (!zpool) {\n\t\tpr_err(\"couldn't create zpool - out of memory\\n\");\n\t\tzpool_put_driver(driver);\n\t\treturn NULL;\n\t}\n\n\tzpool->driver = driver;\n\tzpool->pool = driver->create(name, gfp, ops, zpool);\n\tzpool->ops = ops;\n\tzpool->evictable = driver->shrink && ops && ops->evict;\n\n\tif (!zpool->pool) {\n\t\tpr_err(\"couldn't create %s pool\\n\", type);\n\t\tzpool_put_driver(driver);\n\t\tkfree(zpool);\n\t\treturn NULL;\n\t}\n\n\tpr_debug(\"created pool type %s\\n\", type);\n\n\tspin_lock(&pools_lock);\n\tlist_add(&zpool->list, &pools_head);\n\tspin_unlock(&pools_lock);\n\n\treturn zpool;\n}"
  },
  {
    "function_name": "zpool_has_pool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "120-134",
    "snippet": "bool zpool_has_pool(char *type)\n{\n\tstruct zpool_driver *driver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver)\n\t\treturn false;\n\n\tzpool_put_driver(driver);\n\treturn true;\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "zpool_put_driver",
          "args": [
            "driver"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_put_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "96-100",
          "snippet": "static void zpool_put_driver(struct zpool_driver *driver)\n{\n\tatomic_dec(&driver->refcount);\n\tmodule_put(driver->owner);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic void zpool_put_driver(struct zpool_driver *driver)\n{\n\tatomic_dec(&driver->refcount);\n\tmodule_put(driver->owner);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_get_driver",
          "args": [
            "type"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_get_driver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "76-94",
          "snippet": "static struct zpool_driver *zpool_get_driver(const char *type)\n{\n\tstruct zpool_driver *driver;\n\n\tspin_lock(&drivers_lock);\n\tlist_for_each_entry(driver, &drivers_head, list) {\n\t\tif (!strcmp(driver->type, type)) {\n\t\t\tbool got = try_module_get(driver->owner);\n\n\t\t\tif (got)\n\t\t\t\tatomic_inc(&driver->refcount);\n\t\t\tspin_unlock(&drivers_lock);\n\t\t\treturn got ? driver : NULL;\n\t\t}\n\t}\n\n\tspin_unlock(&drivers_lock);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(drivers_head);",
            "static DEFINE_SPINLOCK(drivers_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic LIST_HEAD(drivers_head);\nstatic DEFINE_SPINLOCK(drivers_lock);\n\nstatic struct zpool_driver *zpool_get_driver(const char *type)\n{\n\tstruct zpool_driver *driver;\n\n\tspin_lock(&drivers_lock);\n\tlist_for_each_entry(driver, &drivers_head, list) {\n\t\tif (!strcmp(driver->type, type)) {\n\t\t\tbool got = try_module_get(driver->owner);\n\n\t\t\tif (got)\n\t\t\t\tatomic_inc(&driver->refcount);\n\t\t\tspin_unlock(&drivers_lock);\n\t\t\treturn got ? driver : NULL;\n\t\t}\n\t}\n\n\tspin_unlock(&drivers_lock);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "request_module",
          "args": [
            "\"zpool-%s\"",
            "type"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nbool zpool_has_pool(char *type)\n{\n\tstruct zpool_driver *driver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver)\n\t\treturn false;\n\n\tzpool_put_driver(driver);\n\treturn true;\n}"
  },
  {
    "function_name": "zpool_put_driver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "96-100",
    "snippet": "static void zpool_put_driver(struct zpool_driver *driver)\n{\n\tatomic_dec(&driver->refcount);\n\tmodule_put(driver->owner);\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module_put",
          "args": [
            "driver->owner"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&driver->refcount"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic void zpool_put_driver(struct zpool_driver *driver)\n{\n\tatomic_dec(&driver->refcount);\n\tmodule_put(driver->owner);\n}"
  },
  {
    "function_name": "zpool_get_driver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "76-94",
    "snippet": "static struct zpool_driver *zpool_get_driver(const char *type)\n{\n\tstruct zpool_driver *driver;\n\n\tspin_lock(&drivers_lock);\n\tlist_for_each_entry(driver, &drivers_head, list) {\n\t\tif (!strcmp(driver->type, type)) {\n\t\t\tbool got = try_module_get(driver->owner);\n\n\t\t\tif (got)\n\t\t\t\tatomic_inc(&driver->refcount);\n\t\t\tspin_unlock(&drivers_lock);\n\t\t\treturn got ? driver : NULL;\n\t\t}\n\t}\n\n\tspin_unlock(&drivers_lock);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(drivers_head);",
      "static DEFINE_SPINLOCK(drivers_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&drivers_lock"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&drivers_lock"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&driver->refcount"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_module_get",
          "args": [
            "driver->owner"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "driver->type",
            "type"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "driver",
            "&drivers_head",
            "list"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&drivers_lock"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic LIST_HEAD(drivers_head);\nstatic DEFINE_SPINLOCK(drivers_lock);\n\nstatic struct zpool_driver *zpool_get_driver(const char *type)\n{\n\tstruct zpool_driver *driver;\n\n\tspin_lock(&drivers_lock);\n\tlist_for_each_entry(driver, &drivers_head, list) {\n\t\tif (!strcmp(driver->type, type)) {\n\t\t\tbool got = try_module_get(driver->owner);\n\n\t\t\tif (got)\n\t\t\t\tatomic_inc(&driver->refcount);\n\t\t\tspin_unlock(&drivers_lock);\n\t\t\treturn got ? driver : NULL;\n\t\t}\n\t}\n\n\tspin_unlock(&drivers_lock);\n\treturn NULL;\n}"
  },
  {
    "function_name": "zpool_unregister_driver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "58-72",
    "snippet": "int zpool_unregister_driver(struct zpool_driver *driver)\n{\n\tint ret = 0, refcount;\n\n\tspin_lock(&drivers_lock);\n\trefcount = atomic_read(&driver->refcount);\n\tWARN_ON(refcount < 0);\n\tif (refcount > 0)\n\t\tret = -EBUSY;\n\telse\n\t\tlist_del(&driver->list);\n\tspin_unlock(&drivers_lock);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(drivers_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&drivers_lock"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&driver->list"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "refcount < 0"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&driver->refcount"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&drivers_lock"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(drivers_lock);\n\nint zpool_unregister_driver(struct zpool_driver *driver)\n{\n\tint ret = 0, refcount;\n\n\tspin_lock(&drivers_lock);\n\trefcount = atomic_read(&driver->refcount);\n\tWARN_ON(refcount < 0);\n\tif (refcount > 0)\n\t\tret = -EBUSY;\n\telse\n\t\tlist_del(&driver->list);\n\tspin_unlock(&drivers_lock);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "zpool_register_driver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
    "lines": "39-45",
    "snippet": "void zpool_register_driver(struct zpool_driver *driver)\n{\n\tspin_lock(&drivers_lock);\n\tatomic_set(&driver->refcount, 0);\n\tlist_add(&driver->list, &drivers_head);\n\tspin_unlock(&drivers_lock);\n}",
    "includes": [
      "#include <linux/zpool.h>",
      "#include <linux/module.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/mm.h>",
      "#include <linux/types.h>",
      "#include <linux/list.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(drivers_head);",
      "static DEFINE_SPINLOCK(drivers_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&drivers_lock"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&driver->list",
            "&drivers_head"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_set",
          "args": [
            "&driver->refcount",
            "0"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&drivers_lock"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic LIST_HEAD(drivers_head);\nstatic DEFINE_SPINLOCK(drivers_lock);\n\nvoid zpool_register_driver(struct zpool_driver *driver)\n{\n\tspin_lock(&drivers_lock);\n\tatomic_set(&driver->refcount, 0);\n\tlist_add(&driver->list, &drivers_head);\n\tspin_unlock(&drivers_lock);\n}"
  }
]