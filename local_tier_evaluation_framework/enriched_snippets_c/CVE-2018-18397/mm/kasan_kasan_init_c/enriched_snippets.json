[
  {
    "function_name": "kasan_add_zero_shadow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "470-488",
    "snippet": "int kasan_add_zero_shadow(void *start, unsigned long size)\n{\n\tint ret;\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(start);\n\tshadow_end = shadow_start + (size >> KASAN_SHADOW_SCALE_SHIFT);\n\n\tif (WARN_ON((unsigned long)start %\n\t\t\t(KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)) ||\n\t    WARN_ON(size % (KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)))\n\t\treturn -EINVAL;\n\n\tret = kasan_populate_zero_shadow(shadow_start, shadow_end);\n\tif (ret)\n\t\tkasan_remove_zero_shadow(shadow_start,\n\t\t\t\t\tsize >> KASAN_SHADOW_SCALE_SHIFT);\n\treturn ret;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_remove_zero_shadow",
          "args": [
            "shadow_start",
            "size >> KASAN_SHADOW_SCALE_SHIFT"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_remove_zero_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "435-468",
          "snippet": "void kasan_remove_zero_shadow(void *start, unsigned long size)\n{\n\tunsigned long addr, end, next;\n\tpgd_t *pgd;\n\n\taddr = (unsigned long)kasan_mem_to_shadow(start);\n\tend = addr + (size >> KASAN_SHADOW_SCALE_SHIFT);\n\n\tif (WARN_ON((unsigned long)start %\n\t\t\t(KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)) ||\n\t    WARN_ON(size % (KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)))\n\t\treturn;\n\n\tfor (; addr < end; addr = next) {\n\t\tp4d_t *p4d;\n\n\t\tnext = pgd_addr_end(addr, end);\n\n\t\tpgd = pgd_offset_k(addr);\n\t\tif (!pgd_present(*pgd))\n\t\t\tcontinue;\n\n\t\tif (kasan_p4d_table(*pgd)) {\n\t\t\tif (IS_ALIGNED(addr, PGDIR_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PGDIR_SIZE))\n\t\t\t\tpgd_clear(pgd);\n\t\t\tcontinue;\n\t\t}\n\n\t\tp4d = p4d_offset(pgd, addr);\n\t\tkasan_remove_p4d_table(p4d, addr, next);\n\t\tkasan_free_p4d(p4d_offset(pgd, 0), pgd);\n\t}\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nvoid kasan_remove_zero_shadow(void *start, unsigned long size)\n{\n\tunsigned long addr, end, next;\n\tpgd_t *pgd;\n\n\taddr = (unsigned long)kasan_mem_to_shadow(start);\n\tend = addr + (size >> KASAN_SHADOW_SCALE_SHIFT);\n\n\tif (WARN_ON((unsigned long)start %\n\t\t\t(KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)) ||\n\t    WARN_ON(size % (KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)))\n\t\treturn;\n\n\tfor (; addr < end; addr = next) {\n\t\tp4d_t *p4d;\n\n\t\tnext = pgd_addr_end(addr, end);\n\n\t\tpgd = pgd_offset_k(addr);\n\t\tif (!pgd_present(*pgd))\n\t\t\tcontinue;\n\n\t\tif (kasan_p4d_table(*pgd)) {\n\t\t\tif (IS_ALIGNED(addr, PGDIR_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PGDIR_SIZE))\n\t\t\t\tpgd_clear(pgd);\n\t\t\tcontinue;\n\t\t}\n\n\t\tp4d = p4d_offset(pgd, addr);\n\t\tkasan_remove_p4d_table(p4d, addr, next);\n\t\tkasan_free_p4d(p4d_offset(pgd, 0), pgd);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_populate_zero_shadow",
          "args": [
            "shadow_start",
            "shadow_end"
          ],
          "line": 483
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_populate_zero_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "217-278",
          "snippet": "int __ref kasan_populate_zero_shadow(const void *shadow_start,\n\t\t\t\tconst void *shadow_end)\n{\n\tunsigned long addr = (unsigned long)shadow_start;\n\tunsigned long end = (unsigned long)shadow_end;\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pgd_addr_end(addr, end);\n\n\t\tif (IS_ALIGNED(addr, PGDIR_SIZE) && end - addr >= PGDIR_SIZE) {\n\t\t\tp4d_t *p4d;\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\t/*\n\t\t\t * kasan_zero_pud should be populated with pmds\n\t\t\t * at this moment.\n\t\t\t * [pud,pmd]_populate*() below needed only for\n\t\t\t * 3,2 - level page tables where we don't have\n\t\t\t * puds,pmds, so pgd_populate(), pud_populate()\n\t\t\t * is noops.\n\t\t\t *\n\t\t\t * The ifndef is required to avoid build breakage.\n\t\t\t *\n\t\t\t * With 5level-fixup.h, pgd_populate() is not nop and\n\t\t\t * we reference kasan_zero_p4d. It's not defined\n\t\t\t * unless 5-level paging enabled.\n\t\t\t *\n\t\t\t * The ifndef can be dropped once all KASAN-enabled\n\t\t\t * architectures will switch to pgtable-nop4d.h.\n\t\t\t */\n#ifndef __ARCH_HAS_5LEVEL_HACK\n\t\t\tpgd_populate(&init_mm, pgd, lm_alias(kasan_zero_p4d));\n#endif\n\t\t\tp4d = p4d_offset(pgd, addr);\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pgd_none(*pgd)) {\n\t\t\tp4d_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = p4d_alloc(&init_mm, pgd, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpgd_populate(&init_mm, pgd,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_p4d_populate(pgd, addr, next);\n\t} while (pgd++, addr = next, addr != end);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "pte_t kasan_zero_pte[PTRS_PER_PTE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nint __ref kasan_populate_zero_shadow(const void *shadow_start,\n\t\t\t\tconst void *shadow_end)\n{\n\tunsigned long addr = (unsigned long)shadow_start;\n\tunsigned long end = (unsigned long)shadow_end;\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pgd_addr_end(addr, end);\n\n\t\tif (IS_ALIGNED(addr, PGDIR_SIZE) && end - addr >= PGDIR_SIZE) {\n\t\t\tp4d_t *p4d;\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\t/*\n\t\t\t * kasan_zero_pud should be populated with pmds\n\t\t\t * at this moment.\n\t\t\t * [pud,pmd]_populate*() below needed only for\n\t\t\t * 3,2 - level page tables where we don't have\n\t\t\t * puds,pmds, so pgd_populate(), pud_populate()\n\t\t\t * is noops.\n\t\t\t *\n\t\t\t * The ifndef is required to avoid build breakage.\n\t\t\t *\n\t\t\t * With 5level-fixup.h, pgd_populate() is not nop and\n\t\t\t * we reference kasan_zero_p4d. It's not defined\n\t\t\t * unless 5-level paging enabled.\n\t\t\t *\n\t\t\t * The ifndef can be dropped once all KASAN-enabled\n\t\t\t * architectures will switch to pgtable-nop4d.h.\n\t\t\t */\n#ifndef __ARCH_HAS_5LEVEL_HACK\n\t\t\tpgd_populate(&init_mm, pgd, lm_alias(kasan_zero_p4d));\n#endif\n\t\t\tp4d = p4d_offset(pgd, addr);\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pgd_none(*pgd)) {\n\t\t\tp4d_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = p4d_alloc(&init_mm, pgd, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpgd_populate(&init_mm, pgd,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_p4d_populate(pgd, addr, next);\n\t} while (pgd++, addr = next, addr != end);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "size % (KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "(unsigned long)start %\n\t\t\t(KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "start"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nint kasan_add_zero_shadow(void *start, unsigned long size)\n{\n\tint ret;\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(start);\n\tshadow_end = shadow_start + (size >> KASAN_SHADOW_SCALE_SHIFT);\n\n\tif (WARN_ON((unsigned long)start %\n\t\t\t(KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)) ||\n\t    WARN_ON(size % (KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)))\n\t\treturn -EINVAL;\n\n\tret = kasan_populate_zero_shadow(shadow_start, shadow_end);\n\tif (ret)\n\t\tkasan_remove_zero_shadow(shadow_start,\n\t\t\t\t\tsize >> KASAN_SHADOW_SCALE_SHIFT);\n\treturn ret;\n}"
  },
  {
    "function_name": "kasan_remove_zero_shadow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "435-468",
    "snippet": "void kasan_remove_zero_shadow(void *start, unsigned long size)\n{\n\tunsigned long addr, end, next;\n\tpgd_t *pgd;\n\n\taddr = (unsigned long)kasan_mem_to_shadow(start);\n\tend = addr + (size >> KASAN_SHADOW_SCALE_SHIFT);\n\n\tif (WARN_ON((unsigned long)start %\n\t\t\t(KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)) ||\n\t    WARN_ON(size % (KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)))\n\t\treturn;\n\n\tfor (; addr < end; addr = next) {\n\t\tp4d_t *p4d;\n\n\t\tnext = pgd_addr_end(addr, end);\n\n\t\tpgd = pgd_offset_k(addr);\n\t\tif (!pgd_present(*pgd))\n\t\t\tcontinue;\n\n\t\tif (kasan_p4d_table(*pgd)) {\n\t\t\tif (IS_ALIGNED(addr, PGDIR_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PGDIR_SIZE))\n\t\t\t\tpgd_clear(pgd);\n\t\t\tcontinue;\n\t\t}\n\n\t\tp4d = p4d_offset(pgd, addr);\n\t\tkasan_remove_p4d_table(p4d, addr, next);\n\t\tkasan_free_p4d(p4d_offset(pgd, 0), pgd);\n\t}\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_free_p4d",
          "args": [
            "p4d_offset(pgd, 0)",
            "pgd"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_free_p4d",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "325-338",
          "snippet": "static void kasan_free_p4d(p4d_t *p4d_start, pgd_t *pgd)\n{\n\tp4d_t *p4d;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_P4D; i++) {\n\t\tp4d = p4d_start + i;\n\t\tif (!p4d_none(*p4d))\n\t\t\treturn;\n\t}\n\n\tp4d_free(&init_mm, (p4d_t *)page_to_virt(pgd_page(*pgd)));\n\tpgd_clear(pgd);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_free_p4d(p4d_t *p4d_start, pgd_t *pgd)\n{\n\tp4d_t *p4d;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_P4D; i++) {\n\t\tp4d = p4d_start + i;\n\t\tif (!p4d_none(*p4d))\n\t\t\treturn;\n\t}\n\n\tp4d_free(&init_mm, (p4d_t *)page_to_virt(pgd_page(*pgd)));\n\tpgd_clear(pgd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p4d_offset",
          "args": [
            "pgd",
            "0"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_remove_p4d_table",
          "args": [
            "p4d",
            "addr",
            "next"
          ],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_remove_p4d_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "410-433",
          "snippet": "static void kasan_remove_p4d_table(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, p4d++) {\n\t\tpud_t *pud;\n\n\t\tnext = p4d_addr_end(addr, end);\n\n\t\tif (!p4d_present(*p4d))\n\t\t\tcontinue;\n\n\t\tif (kasan_pud_table(*p4d)) {\n\t\t\tif (IS_ALIGNED(addr, P4D_SIZE) &&\n\t\t\t    IS_ALIGNED(next, P4D_SIZE))\n\t\t\t\tp4d_clear(p4d);\n\t\t\tcontinue;\n\t\t}\n\t\tpud = pud_offset(p4d, addr);\n\t\tkasan_remove_pud_table(pud, addr, next);\n\t\tkasan_free_pud(pud_offset(p4d, 0), p4d);\n\t}\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_remove_p4d_table(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, p4d++) {\n\t\tpud_t *pud;\n\n\t\tnext = p4d_addr_end(addr, end);\n\n\t\tif (!p4d_present(*p4d))\n\t\t\tcontinue;\n\n\t\tif (kasan_pud_table(*p4d)) {\n\t\t\tif (IS_ALIGNED(addr, P4D_SIZE) &&\n\t\t\t    IS_ALIGNED(next, P4D_SIZE))\n\t\t\t\tp4d_clear(p4d);\n\t\t\tcontinue;\n\t\t}\n\t\tpud = pud_offset(p4d, addr);\n\t\tkasan_remove_pud_table(pud, addr, next);\n\t\tkasan_free_pud(pud_offset(p4d, 0), p4d);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "p4d_offset",
          "args": [
            "pgd",
            "addr"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_clear",
          "args": [
            "pgd"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "pgd_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "21-25",
          "snippet": "void pgd_clear_bad(pgd_t *pgd)\n{\n\tpgd_ERROR(*pgd);\n\tpgd_clear(pgd);\n}",
          "includes": [
            "#include <asm-generic/pgtable.h>",
            "#include <asm/tlb.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pgd_clear_bad(pgd_t *pgd)\n{\n\tpgd_ERROR(*pgd);\n\tpgd_clear(pgd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "next",
            "PGDIR_SIZE"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "PGDIR_SIZE"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_p4d_table",
          "args": [
            "*pgd"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_p4d_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "42-45",
          "snippet": "static inline bool kasan_p4d_table(pgd_t pgd)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_p4d_table(pgd_t pgd)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pgd_present",
          "args": [
            "*pgd"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_offset_k",
          "args": [
            "addr"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_addr_end",
          "args": [
            "addr",
            "end"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "size % (KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "(unsigned long)start %\n\t\t\t(KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "start"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nvoid kasan_remove_zero_shadow(void *start, unsigned long size)\n{\n\tunsigned long addr, end, next;\n\tpgd_t *pgd;\n\n\taddr = (unsigned long)kasan_mem_to_shadow(start);\n\tend = addr + (size >> KASAN_SHADOW_SCALE_SHIFT);\n\n\tif (WARN_ON((unsigned long)start %\n\t\t\t(KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)) ||\n\t    WARN_ON(size % (KASAN_SHADOW_SCALE_SIZE * PAGE_SIZE)))\n\t\treturn;\n\n\tfor (; addr < end; addr = next) {\n\t\tp4d_t *p4d;\n\n\t\tnext = pgd_addr_end(addr, end);\n\n\t\tpgd = pgd_offset_k(addr);\n\t\tif (!pgd_present(*pgd))\n\t\t\tcontinue;\n\n\t\tif (kasan_p4d_table(*pgd)) {\n\t\t\tif (IS_ALIGNED(addr, PGDIR_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PGDIR_SIZE))\n\t\t\t\tpgd_clear(pgd);\n\t\t\tcontinue;\n\t\t}\n\n\t\tp4d = p4d_offset(pgd, addr);\n\t\tkasan_remove_p4d_table(p4d, addr, next);\n\t\tkasan_free_p4d(p4d_offset(pgd, 0), pgd);\n\t}\n}"
  },
  {
    "function_name": "kasan_remove_p4d_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "410-433",
    "snippet": "static void kasan_remove_p4d_table(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, p4d++) {\n\t\tpud_t *pud;\n\n\t\tnext = p4d_addr_end(addr, end);\n\n\t\tif (!p4d_present(*p4d))\n\t\t\tcontinue;\n\n\t\tif (kasan_pud_table(*p4d)) {\n\t\t\tif (IS_ALIGNED(addr, P4D_SIZE) &&\n\t\t\t    IS_ALIGNED(next, P4D_SIZE))\n\t\t\t\tp4d_clear(p4d);\n\t\t\tcontinue;\n\t\t}\n\t\tpud = pud_offset(p4d, addr);\n\t\tkasan_remove_pud_table(pud, addr, next);\n\t\tkasan_free_pud(pud_offset(p4d, 0), p4d);\n\t}\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_free_pud",
          "args": [
            "pud_offset(p4d, 0)",
            "p4d"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_free_pud",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "310-323",
          "snippet": "static void kasan_free_pud(pud_t *pud_start, p4d_t *p4d)\n{\n\tpud_t *pud;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PUD; i++) {\n\t\tpud = pud_start + i;\n\t\tif (!pud_none(*pud))\n\t\t\treturn;\n\t}\n\n\tpud_free(&init_mm, (pud_t *)page_to_virt(p4d_page(*p4d)));\n\tp4d_clear(p4d);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_free_pud(pud_t *pud_start, p4d_t *p4d)\n{\n\tpud_t *pud;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PUD; i++) {\n\t\tpud = pud_start + i;\n\t\tif (!pud_none(*pud))\n\t\t\treturn;\n\t}\n\n\tpud_free(&init_mm, (pud_t *)page_to_virt(p4d_page(*p4d)));\n\tp4d_clear(p4d);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pud_offset",
          "args": [
            "p4d",
            "0"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_remove_pud_table",
          "args": [
            "pud",
            "addr",
            "next"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_remove_pud_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "384-408",
          "snippet": "static void kasan_remove_pud_table(pud_t *pud, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pud++) {\n\t\tpmd_t *pmd, *pmd_base;\n\n\t\tnext = pud_addr_end(addr, end);\n\n\t\tif (!pud_present(*pud))\n\t\t\tcontinue;\n\n\t\tif (kasan_pmd_table(*pud)) {\n\t\t\tif (IS_ALIGNED(addr, PUD_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PUD_SIZE))\n\t\t\t\tpud_clear(pud);\n\t\t\tcontinue;\n\t\t}\n\t\tpmd = pmd_offset(pud, addr);\n\t\tpmd_base = pmd_offset(pud, 0);\n\t\tkasan_remove_pmd_table(pmd, addr, next);\n\t\tkasan_free_pmd(pmd_base, pud);\n\t}\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_remove_pud_table(pud_t *pud, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pud++) {\n\t\tpmd_t *pmd, *pmd_base;\n\n\t\tnext = pud_addr_end(addr, end);\n\n\t\tif (!pud_present(*pud))\n\t\t\tcontinue;\n\n\t\tif (kasan_pmd_table(*pud)) {\n\t\t\tif (IS_ALIGNED(addr, PUD_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PUD_SIZE))\n\t\t\t\tpud_clear(pud);\n\t\t\tcontinue;\n\t\t}\n\t\tpmd = pmd_offset(pud, addr);\n\t\tpmd_base = pmd_offset(pud, 0);\n\t\tkasan_remove_pmd_table(pmd, addr, next);\n\t\tkasan_free_pmd(pmd_base, pud);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pud_offset",
          "args": [
            "p4d",
            "addr"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_clear",
          "args": [
            "p4d"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "p4d_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "27-31",
          "snippet": "void p4d_clear_bad(p4d_t *p4d)\n{\n\tp4d_ERROR(*p4d);\n\tp4d_clear(p4d);\n}",
          "includes": [
            "#include <asm-generic/pgtable.h>",
            "#include <asm/tlb.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid p4d_clear_bad(p4d_t *p4d)\n{\n\tp4d_ERROR(*p4d);\n\tp4d_clear(p4d);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "next",
            "P4D_SIZE"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "P4D_SIZE"
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_pud_table",
          "args": [
            "*p4d"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_pud_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "54-57",
          "snippet": "static inline bool kasan_pud_table(p4d_t p4d)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_pud_table(p4d_t p4d)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p4d_present",
          "args": [
            "*p4d"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_addr_end",
          "args": [
            "addr",
            "end"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_remove_p4d_table(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, p4d++) {\n\t\tpud_t *pud;\n\n\t\tnext = p4d_addr_end(addr, end);\n\n\t\tif (!p4d_present(*p4d))\n\t\t\tcontinue;\n\n\t\tif (kasan_pud_table(*p4d)) {\n\t\t\tif (IS_ALIGNED(addr, P4D_SIZE) &&\n\t\t\t    IS_ALIGNED(next, P4D_SIZE))\n\t\t\t\tp4d_clear(p4d);\n\t\t\tcontinue;\n\t\t}\n\t\tpud = pud_offset(p4d, addr);\n\t\tkasan_remove_pud_table(pud, addr, next);\n\t\tkasan_free_pud(pud_offset(p4d, 0), p4d);\n\t}\n}"
  },
  {
    "function_name": "kasan_remove_pud_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "384-408",
    "snippet": "static void kasan_remove_pud_table(pud_t *pud, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pud++) {\n\t\tpmd_t *pmd, *pmd_base;\n\n\t\tnext = pud_addr_end(addr, end);\n\n\t\tif (!pud_present(*pud))\n\t\t\tcontinue;\n\n\t\tif (kasan_pmd_table(*pud)) {\n\t\t\tif (IS_ALIGNED(addr, PUD_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PUD_SIZE))\n\t\t\t\tpud_clear(pud);\n\t\t\tcontinue;\n\t\t}\n\t\tpmd = pmd_offset(pud, addr);\n\t\tpmd_base = pmd_offset(pud, 0);\n\t\tkasan_remove_pmd_table(pmd, addr, next);\n\t\tkasan_free_pmd(pmd_base, pud);\n\t}\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_free_pmd",
          "args": [
            "pmd_base",
            "pud"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_free_pmd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "295-308",
          "snippet": "static void kasan_free_pmd(pmd_t *pmd_start, pud_t *pud)\n{\n\tpmd_t *pmd;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PMD; i++) {\n\t\tpmd = pmd_start + i;\n\t\tif (!pmd_none(*pmd))\n\t\t\treturn;\n\t}\n\n\tpmd_free(&init_mm, (pmd_t *)page_to_virt(pud_page(*pud)));\n\tpud_clear(pud);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_free_pmd(pmd_t *pmd_start, pud_t *pud)\n{\n\tpmd_t *pmd;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PMD; i++) {\n\t\tpmd = pmd_start + i;\n\t\tif (!pmd_none(*pmd))\n\t\t\treturn;\n\t}\n\n\tpmd_free(&init_mm, (pmd_t *)page_to_virt(pud_page(*pud)));\n\tpud_clear(pud);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_remove_pmd_table",
          "args": [
            "pmd",
            "addr",
            "next"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_remove_pmd_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "359-382",
          "snippet": "static void kasan_remove_pmd_table(pmd_t *pmd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pmd++) {\n\t\tpte_t *pte;\n\n\t\tnext = pmd_addr_end(addr, end);\n\n\t\tif (!pmd_present(*pmd))\n\t\t\tcontinue;\n\n\t\tif (kasan_pte_table(*pmd)) {\n\t\t\tif (IS_ALIGNED(addr, PMD_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PMD_SIZE))\n\t\t\t\tpmd_clear(pmd);\n\t\t\tcontinue;\n\t\t}\n\t\tpte = pte_offset_kernel(pmd, addr);\n\t\tkasan_remove_pte_table(pte, addr, next);\n\t\tkasan_free_pte(pte_offset_kernel(pmd, 0), pmd);\n\t}\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_remove_pmd_table(pmd_t *pmd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pmd++) {\n\t\tpte_t *pte;\n\n\t\tnext = pmd_addr_end(addr, end);\n\n\t\tif (!pmd_present(*pmd))\n\t\t\tcontinue;\n\n\t\tif (kasan_pte_table(*pmd)) {\n\t\t\tif (IS_ALIGNED(addr, PMD_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PMD_SIZE))\n\t\t\t\tpmd_clear(pmd);\n\t\t\tcontinue;\n\t\t}\n\t\tpte = pte_offset_kernel(pmd, addr);\n\t\tkasan_remove_pte_table(pte, addr, next);\n\t\tkasan_free_pte(pte_offset_kernel(pmd, 0), pmd);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pmd_offset",
          "args": [
            "pud",
            "0"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_offset",
          "args": [
            "pud",
            "addr"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_clear",
          "args": [
            "pud"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "pud_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "33-37",
          "snippet": "void pud_clear_bad(pud_t *pud)\n{\n\tpud_ERROR(*pud);\n\tpud_clear(pud);\n}",
          "includes": [
            "#include <asm-generic/pgtable.h>",
            "#include <asm/tlb.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pud_clear_bad(pud_t *pud)\n{\n\tpud_ERROR(*pud);\n\tpud_clear(pud);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "next",
            "PUD_SIZE"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "PUD_SIZE"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_pmd_table",
          "args": [
            "*pud"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_pmd_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "66-69",
          "snippet": "static inline bool kasan_pmd_table(pud_t pud)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_pmd_table(pud_t pud)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pud_present",
          "args": [
            "*pud"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_addr_end",
          "args": [
            "addr",
            "end"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_remove_pud_table(pud_t *pud, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pud++) {\n\t\tpmd_t *pmd, *pmd_base;\n\n\t\tnext = pud_addr_end(addr, end);\n\n\t\tif (!pud_present(*pud))\n\t\t\tcontinue;\n\n\t\tif (kasan_pmd_table(*pud)) {\n\t\t\tif (IS_ALIGNED(addr, PUD_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PUD_SIZE))\n\t\t\t\tpud_clear(pud);\n\t\t\tcontinue;\n\t\t}\n\t\tpmd = pmd_offset(pud, addr);\n\t\tpmd_base = pmd_offset(pud, 0);\n\t\tkasan_remove_pmd_table(pmd, addr, next);\n\t\tkasan_free_pmd(pmd_base, pud);\n\t}\n}"
  },
  {
    "function_name": "kasan_remove_pmd_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "359-382",
    "snippet": "static void kasan_remove_pmd_table(pmd_t *pmd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pmd++) {\n\t\tpte_t *pte;\n\n\t\tnext = pmd_addr_end(addr, end);\n\n\t\tif (!pmd_present(*pmd))\n\t\t\tcontinue;\n\n\t\tif (kasan_pte_table(*pmd)) {\n\t\t\tif (IS_ALIGNED(addr, PMD_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PMD_SIZE))\n\t\t\t\tpmd_clear(pmd);\n\t\t\tcontinue;\n\t\t}\n\t\tpte = pte_offset_kernel(pmd, addr);\n\t\tkasan_remove_pte_table(pte, addr, next);\n\t\tkasan_free_pte(pte_offset_kernel(pmd, 0), pmd);\n\t}\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_free_pte",
          "args": [
            "pte_offset_kernel(pmd, 0)",
            "pmd"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_free_pte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "280-293",
          "snippet": "static void kasan_free_pte(pte_t *pte_start, pmd_t *pmd)\n{\n\tpte_t *pte;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PTE; i++) {\n\t\tpte = pte_start + i;\n\t\tif (!pte_none(*pte))\n\t\t\treturn;\n\t}\n\n\tpte_free_kernel(&init_mm, (pte_t *)page_to_virt(pmd_page(*pmd)));\n\tpmd_clear(pmd);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_free_pte(pte_t *pte_start, pmd_t *pmd)\n{\n\tpte_t *pte;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PTE; i++) {\n\t\tpte = pte_start + i;\n\t\tif (!pte_none(*pte))\n\t\t\treturn;\n\t}\n\n\tpte_free_kernel(&init_mm, (pte_t *)page_to_virt(pmd_page(*pmd)));\n\tpmd_clear(pmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pte_offset_kernel",
          "args": [
            "pmd",
            "0"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_remove_pte_table",
          "args": [
            "pte",
            "addr",
            "next"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_remove_pte_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "340-357",
          "snippet": "static void kasan_remove_pte_table(pte_t *pte, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pte++) {\n\t\tnext = (addr + PAGE_SIZE) & PAGE_MASK;\n\t\tif (next > end)\n\t\t\tnext = end;\n\n\t\tif (!pte_present(*pte))\n\t\t\tcontinue;\n\n\t\tif (WARN_ON(!kasan_zero_page_entry(*pte)))\n\t\t\tcontinue;\n\t\tpte_clear(&init_mm, addr, pte);\n\t}\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_remove_pte_table(pte_t *pte, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pte++) {\n\t\tnext = (addr + PAGE_SIZE) & PAGE_MASK;\n\t\tif (next > end)\n\t\t\tnext = end;\n\n\t\tif (!pte_present(*pte))\n\t\t\tcontinue;\n\n\t\tif (WARN_ON(!kasan_zero_page_entry(*pte)))\n\t\t\tcontinue;\n\t\tpte_clear(&init_mm, addr, pte);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pte_offset_kernel",
          "args": [
            "pmd",
            "addr"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_clear",
          "args": [
            "pmd"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "pmd_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "39-43",
          "snippet": "void pmd_clear_bad(pmd_t *pmd)\n{\n\tpmd_ERROR(*pmd);\n\tpmd_clear(pmd);\n}",
          "includes": [
            "#include <asm-generic/pgtable.h>",
            "#include <asm/tlb.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pmd_clear_bad(pmd_t *pmd)\n{\n\tpmd_ERROR(*pmd);\n\tpmd_clear(pmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "next",
            "PMD_SIZE"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "PMD_SIZE"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_pte_table",
          "args": [
            "*pmd"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_pte_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "73-76",
          "snippet": "static inline bool kasan_pte_table(pmd_t pmd)\n{\n\treturn pmd_page(pmd) == virt_to_page(lm_alias(kasan_zero_pte));\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "pte_t kasan_zero_pte[PTRS_PER_PTE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic inline bool kasan_pte_table(pmd_t pmd)\n{\n\treturn pmd_page(pmd) == virt_to_page(lm_alias(kasan_zero_pte));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pmd_present",
          "args": [
            "*pmd"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_addr_end",
          "args": [
            "addr",
            "end"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_remove_pmd_table(pmd_t *pmd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pmd++) {\n\t\tpte_t *pte;\n\n\t\tnext = pmd_addr_end(addr, end);\n\n\t\tif (!pmd_present(*pmd))\n\t\t\tcontinue;\n\n\t\tif (kasan_pte_table(*pmd)) {\n\t\t\tif (IS_ALIGNED(addr, PMD_SIZE) &&\n\t\t\t    IS_ALIGNED(next, PMD_SIZE))\n\t\t\t\tpmd_clear(pmd);\n\t\t\tcontinue;\n\t\t}\n\t\tpte = pte_offset_kernel(pmd, addr);\n\t\tkasan_remove_pte_table(pte, addr, next);\n\t\tkasan_free_pte(pte_offset_kernel(pmd, 0), pmd);\n\t}\n}"
  },
  {
    "function_name": "kasan_remove_pte_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "340-357",
    "snippet": "static void kasan_remove_pte_table(pte_t *pte, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pte++) {\n\t\tnext = (addr + PAGE_SIZE) & PAGE_MASK;\n\t\tif (next > end)\n\t\t\tnext = end;\n\n\t\tif (!pte_present(*pte))\n\t\t\tcontinue;\n\n\t\tif (WARN_ON(!kasan_zero_page_entry(*pte)))\n\t\t\tcontinue;\n\t\tpte_clear(&init_mm, addr, pte);\n\t}\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pte_clear",
          "args": [
            "&init_mm",
            "addr",
            "pte"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!kasan_zero_page_entry(*pte)"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_zero_page_entry",
          "args": [
            "*pte"
          ],
          "line": 353
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_zero_page_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "78-81",
          "snippet": "static inline bool kasan_zero_page_entry(pte_t pte)\n{\n\treturn pte_page(pte) == virt_to_page(lm_alias(kasan_zero_page));\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned char kasan_zero_page[PAGE_SIZE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nunsigned char kasan_zero_page[PAGE_SIZE];\n\nstatic inline bool kasan_zero_page_entry(pte_t pte)\n{\n\treturn pte_page(pte) == virt_to_page(lm_alias(kasan_zero_page));\n}"
        }
      },
      {
        "call_info": {
          "callee": "pte_present",
          "args": [
            "*pte"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_remove_pte_table(pte_t *pte, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tunsigned long next;\n\n\tfor (; addr < end; addr = next, pte++) {\n\t\tnext = (addr + PAGE_SIZE) & PAGE_MASK;\n\t\tif (next > end)\n\t\t\tnext = end;\n\n\t\tif (!pte_present(*pte))\n\t\t\tcontinue;\n\n\t\tif (WARN_ON(!kasan_zero_page_entry(*pte)))\n\t\t\tcontinue;\n\t\tpte_clear(&init_mm, addr, pte);\n\t}\n}"
  },
  {
    "function_name": "kasan_free_p4d",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "325-338",
    "snippet": "static void kasan_free_p4d(p4d_t *p4d_start, pgd_t *pgd)\n{\n\tp4d_t *p4d;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_P4D; i++) {\n\t\tp4d = p4d_start + i;\n\t\tif (!p4d_none(*p4d))\n\t\t\treturn;\n\t}\n\n\tp4d_free(&init_mm, (p4d_t *)page_to_virt(pgd_page(*pgd)));\n\tpgd_clear(pgd);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pgd_clear",
          "args": [
            "pgd"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "pgd_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "21-25",
          "snippet": "void pgd_clear_bad(pgd_t *pgd)\n{\n\tpgd_ERROR(*pgd);\n\tpgd_clear(pgd);\n}",
          "includes": [
            "#include <asm-generic/pgtable.h>",
            "#include <asm/tlb.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pgd_clear_bad(pgd_t *pgd)\n{\n\tpgd_ERROR(*pgd);\n\tpgd_clear(pgd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p4d_free",
          "args": [
            "&init_mm",
            "(p4d_t *)page_to_virt(pgd_page(*pgd))"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_to_virt",
          "args": [
            "pgd_page(*pgd)"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_page",
          "args": [
            "*pgd"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_none",
          "args": [
            "*p4d"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_free_p4d(p4d_t *p4d_start, pgd_t *pgd)\n{\n\tp4d_t *p4d;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_P4D; i++) {\n\t\tp4d = p4d_start + i;\n\t\tif (!p4d_none(*p4d))\n\t\t\treturn;\n\t}\n\n\tp4d_free(&init_mm, (p4d_t *)page_to_virt(pgd_page(*pgd)));\n\tpgd_clear(pgd);\n}"
  },
  {
    "function_name": "kasan_free_pud",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "310-323",
    "snippet": "static void kasan_free_pud(pud_t *pud_start, p4d_t *p4d)\n{\n\tpud_t *pud;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PUD; i++) {\n\t\tpud = pud_start + i;\n\t\tif (!pud_none(*pud))\n\t\t\treturn;\n\t}\n\n\tpud_free(&init_mm, (pud_t *)page_to_virt(p4d_page(*p4d)));\n\tp4d_clear(p4d);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "p4d_clear",
          "args": [
            "p4d"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "p4d_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "27-31",
          "snippet": "void p4d_clear_bad(p4d_t *p4d)\n{\n\tp4d_ERROR(*p4d);\n\tp4d_clear(p4d);\n}",
          "includes": [
            "#include <asm-generic/pgtable.h>",
            "#include <asm/tlb.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid p4d_clear_bad(p4d_t *p4d)\n{\n\tp4d_ERROR(*p4d);\n\tp4d_clear(p4d);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pud_free",
          "args": [
            "&init_mm",
            "(pud_t *)page_to_virt(p4d_page(*p4d))"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_to_virt",
          "args": [
            "p4d_page(*p4d)"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_page",
          "args": [
            "*p4d"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_none",
          "args": [
            "*pud"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_free_pud(pud_t *pud_start, p4d_t *p4d)\n{\n\tpud_t *pud;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PUD; i++) {\n\t\tpud = pud_start + i;\n\t\tif (!pud_none(*pud))\n\t\t\treturn;\n\t}\n\n\tpud_free(&init_mm, (pud_t *)page_to_virt(p4d_page(*p4d)));\n\tp4d_clear(p4d);\n}"
  },
  {
    "function_name": "kasan_free_pmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "295-308",
    "snippet": "static void kasan_free_pmd(pmd_t *pmd_start, pud_t *pud)\n{\n\tpmd_t *pmd;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PMD; i++) {\n\t\tpmd = pmd_start + i;\n\t\tif (!pmd_none(*pmd))\n\t\t\treturn;\n\t}\n\n\tpmd_free(&init_mm, (pmd_t *)page_to_virt(pud_page(*pud)));\n\tpud_clear(pud);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pud_clear",
          "args": [
            "pud"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "pud_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "33-37",
          "snippet": "void pud_clear_bad(pud_t *pud)\n{\n\tpud_ERROR(*pud);\n\tpud_clear(pud);\n}",
          "includes": [
            "#include <asm-generic/pgtable.h>",
            "#include <asm/tlb.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pud_clear_bad(pud_t *pud)\n{\n\tpud_ERROR(*pud);\n\tpud_clear(pud);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pmd_free",
          "args": [
            "&init_mm",
            "(pmd_t *)page_to_virt(pud_page(*pud))"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_to_virt",
          "args": [
            "pud_page(*pud)"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_page",
          "args": [
            "*pud"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_none",
          "args": [
            "*pmd"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_free_pmd(pmd_t *pmd_start, pud_t *pud)\n{\n\tpmd_t *pmd;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PMD; i++) {\n\t\tpmd = pmd_start + i;\n\t\tif (!pmd_none(*pmd))\n\t\t\treturn;\n\t}\n\n\tpmd_free(&init_mm, (pmd_t *)page_to_virt(pud_page(*pud)));\n\tpud_clear(pud);\n}"
  },
  {
    "function_name": "kasan_free_pte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "280-293",
    "snippet": "static void kasan_free_pte(pte_t *pte_start, pmd_t *pmd)\n{\n\tpte_t *pte;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PTE; i++) {\n\t\tpte = pte_start + i;\n\t\tif (!pte_none(*pte))\n\t\t\treturn;\n\t}\n\n\tpte_free_kernel(&init_mm, (pte_t *)page_to_virt(pmd_page(*pmd)));\n\tpmd_clear(pmd);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pmd_clear",
          "args": [
            "pmd"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "pmd_clear_bad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/pgtable-generic.c",
          "lines": "39-43",
          "snippet": "void pmd_clear_bad(pmd_t *pmd)\n{\n\tpmd_ERROR(*pmd);\n\tpmd_clear(pmd);\n}",
          "includes": [
            "#include <asm-generic/pgtable.h>",
            "#include <asm/tlb.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/pagemap.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm-generic/pgtable.h>\n#include <asm/tlb.h>\n#include <linux/hugetlb.h>\n#include <linux/pagemap.h>\n\nvoid pmd_clear_bad(pmd_t *pmd)\n{\n\tpmd_ERROR(*pmd);\n\tpmd_clear(pmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pte_free_kernel",
          "args": [
            "&init_mm",
            "(pte_t *)page_to_virt(pmd_page(*pmd))"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_to_virt",
          "args": [
            "pmd_page(*pmd)"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_page",
          "args": [
            "*pmd"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_none",
          "args": [
            "*pte"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic void kasan_free_pte(pte_t *pte_start, pmd_t *pmd)\n{\n\tpte_t *pte;\n\tint i;\n\n\tfor (i = 0; i < PTRS_PER_PTE; i++) {\n\t\tpte = pte_start + i;\n\t\tif (!pte_none(*pte))\n\t\t\treturn;\n\t}\n\n\tpte_free_kernel(&init_mm, (pte_t *)page_to_virt(pmd_page(*pmd)));\n\tpmd_clear(pmd);\n}"
  },
  {
    "function_name": "kasan_populate_zero_shadow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "217-278",
    "snippet": "int __ref kasan_populate_zero_shadow(const void *shadow_start,\n\t\t\t\tconst void *shadow_end)\n{\n\tunsigned long addr = (unsigned long)shadow_start;\n\tunsigned long end = (unsigned long)shadow_end;\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pgd_addr_end(addr, end);\n\n\t\tif (IS_ALIGNED(addr, PGDIR_SIZE) && end - addr >= PGDIR_SIZE) {\n\t\t\tp4d_t *p4d;\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\t/*\n\t\t\t * kasan_zero_pud should be populated with pmds\n\t\t\t * at this moment.\n\t\t\t * [pud,pmd]_populate*() below needed only for\n\t\t\t * 3,2 - level page tables where we don't have\n\t\t\t * puds,pmds, so pgd_populate(), pud_populate()\n\t\t\t * is noops.\n\t\t\t *\n\t\t\t * The ifndef is required to avoid build breakage.\n\t\t\t *\n\t\t\t * With 5level-fixup.h, pgd_populate() is not nop and\n\t\t\t * we reference kasan_zero_p4d. It's not defined\n\t\t\t * unless 5-level paging enabled.\n\t\t\t *\n\t\t\t * The ifndef can be dropped once all KASAN-enabled\n\t\t\t * architectures will switch to pgtable-nop4d.h.\n\t\t\t */\n#ifndef __ARCH_HAS_5LEVEL_HACK\n\t\t\tpgd_populate(&init_mm, pgd, lm_alias(kasan_zero_p4d));\n#endif\n\t\t\tp4d = p4d_offset(pgd, addr);\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pgd_none(*pgd)) {\n\t\t\tp4d_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = p4d_alloc(&init_mm, pgd, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpgd_populate(&init_mm, pgd,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_p4d_populate(pgd, addr, next);\n\t} while (pgd++, addr = next, addr != end);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "pte_t kasan_zero_pte[PTRS_PER_PTE]"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zero_p4d_populate",
          "args": [
            "pgd",
            "addr",
            "next"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "zero_p4d_populate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "172-209",
          "snippet": "static int __ref zero_p4d_populate(pgd_t *pgd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tp4d_t *p4d = p4d_offset(pgd, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = p4d_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, P4D_SIZE) && end - addr >= P4D_SIZE) {\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd,\n\t\t\t\t\t\tlm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (p4d_none(*p4d)) {\n\t\t\tpud_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pud_alloc(&init_mm, p4d, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tp4d_populate(&init_mm, p4d,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pud_populate(p4d, addr, next);\n\t} while (p4d++, addr = next, addr != end);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "pte_t kasan_zero_pte[PTRS_PER_PTE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic int __ref zero_p4d_populate(pgd_t *pgd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tp4d_t *p4d = p4d_offset(pgd, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = p4d_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, P4D_SIZE) && end - addr >= P4D_SIZE) {\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd,\n\t\t\t\t\t\tlm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (p4d_none(*p4d)) {\n\t\t\tpud_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pud_alloc(&init_mm, p4d, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tp4d_populate(&init_mm, p4d,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pud_populate(p4d, addr, next);\n\t} while (p4d++, addr = next, addr != end);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pgd_populate",
          "args": [
            "&init_mm",
            "pgd",
            "early_alloc(PAGE_SIZE, NUMA_NO_NODE)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_alloc",
          "args": [
            "PAGE_SIZE",
            "NUMA_NO_NODE"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "early_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "83-87",
          "snippet": "static __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "p4d_alloc",
          "args": [
            "&init_mm",
            "pgd",
            "addr"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "__p4d_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory.c",
          "lines": "3949-3964",
          "snippet": "int __p4d_alloc(struct mm_struct *mm, pgd_t *pgd, unsigned long address)\n{\n\tp4d_t *new = p4d_alloc_one(mm, address);\n\tif (!new)\n\t\treturn -ENOMEM;\n\n\tsmp_wmb(); /* See comment in __pte_alloc */\n\n\tspin_lock(&mm->page_table_lock);\n\tif (pgd_present(*pgd))\t\t/* Another has populated it */\n\t\tp4d_free(mm, new);\n\telse\n\t\tpgd_populate(mm, pgd, new);\n\tspin_unlock(&mm->page_table_lock);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/io.h>",
            "#include <linux/oom.h>",
            "#include <linux/dax.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/dma-debug.h>",
            "#include <linux/string.h>",
            "#include <linux/migrate.h>",
            "#include <linux/gfp.h>",
            "#include <linux/elf.h>",
            "#include <linux/swapops.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pfn_t.h>",
            "#include <linux/init.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/export.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/memremap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel_stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <asm/mmu_context.h>\n#include <asm/io.h>\n#include <linux/oom.h>\n#include <linux/dax.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/debugfs.h>\n#include <linux/dma-debug.h>\n#include <linux/string.h>\n#include <linux/migrate.h>\n#include <linux/gfp.h>\n#include <linux/elf.h>\n#include <linux/swapops.h>\n#include <linux/mmu_notifier.h>\n#include <linux/memcontrol.h>\n#include <linux/writeback.h>\n#include <linux/pfn_t.h>\n#include <linux/init.h>\n#include <linux/delayacct.h>\n#include <linux/export.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/memremap.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/kernel_stat.h>\n\nint __p4d_alloc(struct mm_struct *mm, pgd_t *pgd, unsigned long address)\n{\n\tp4d_t *new = p4d_alloc_one(mm, address);\n\tif (!new)\n\t\treturn -ENOMEM;\n\n\tsmp_wmb(); /* See comment in __pte_alloc */\n\n\tspin_lock(&mm->page_table_lock);\n\tif (pgd_present(*pgd))\t\t/* Another has populated it */\n\t\tp4d_free(mm, new);\n\telse\n\t\tpgd_populate(mm, pgd, new);\n\tspin_unlock(&mm->page_table_lock);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slab_is_available",
          "args": [],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "slab_is_available",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "930-933",
          "snippet": "bool slab_is_available(void)\n{\n\treturn slab_state >= UP;\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "enum slab_state slab_state;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nenum slab_state slab_state;\n\nbool slab_is_available(void)\n{\n\treturn slab_state >= UP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pgd_none",
          "args": [
            "*pgd"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_populate_kernel",
          "args": [
            "&init_mm",
            "pmd",
            "lm_alias(kasan_zero_pte)"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pte"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_offset",
          "args": [
            "pud",
            "addr"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_populate",
          "args": [
            "&init_mm",
            "pud",
            "lm_alias(kasan_zero_pmd)"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "zero_pud_populate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "137-170",
          "snippet": "static int __ref zero_pud_populate(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpud_t *pud = pud_offset(p4d, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pud_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, PUD_SIZE) && end - addr >= PUD_SIZE) {\n\t\t\tpmd_t *pmd;\n\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pud_none(*pud)) {\n\t\t\tpmd_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pmd_alloc(&init_mm, pud, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpud_populate(&init_mm, pud,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pmd_populate(pud, addr, next);\n\t} while (pud++, addr = next, addr != end);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "pte_t kasan_zero_pte[PTRS_PER_PTE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic int __ref zero_pud_populate(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpud_t *pud = pud_offset(p4d, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pud_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, PUD_SIZE) && end - addr >= PUD_SIZE) {\n\t\t\tpmd_t *pmd;\n\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pud_none(*pud)) {\n\t\t\tpmd_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pmd_alloc(&init_mm, pud, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpud_populate(&init_mm, pud,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pmd_populate(pud, addr, next);\n\t} while (pud++, addr = next, addr != end);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pmd"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_offset",
          "args": [
            "p4d",
            "addr"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pud"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_offset",
          "args": [
            "pgd",
            "addr"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_populate",
          "args": [
            "&init_mm",
            "pgd",
            "lm_alias(kasan_zero_p4d)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_p4d"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "PGDIR_SIZE"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_addr_end",
          "args": [
            "addr",
            "end"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_offset_k",
          "args": [
            "addr"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nint __ref kasan_populate_zero_shadow(const void *shadow_start,\n\t\t\t\tconst void *shadow_end)\n{\n\tunsigned long addr = (unsigned long)shadow_start;\n\tunsigned long end = (unsigned long)shadow_end;\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pgd_addr_end(addr, end);\n\n\t\tif (IS_ALIGNED(addr, PGDIR_SIZE) && end - addr >= PGDIR_SIZE) {\n\t\t\tp4d_t *p4d;\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\t/*\n\t\t\t * kasan_zero_pud should be populated with pmds\n\t\t\t * at this moment.\n\t\t\t * [pud,pmd]_populate*() below needed only for\n\t\t\t * 3,2 - level page tables where we don't have\n\t\t\t * puds,pmds, so pgd_populate(), pud_populate()\n\t\t\t * is noops.\n\t\t\t *\n\t\t\t * The ifndef is required to avoid build breakage.\n\t\t\t *\n\t\t\t * With 5level-fixup.h, pgd_populate() is not nop and\n\t\t\t * we reference kasan_zero_p4d. It's not defined\n\t\t\t * unless 5-level paging enabled.\n\t\t\t *\n\t\t\t * The ifndef can be dropped once all KASAN-enabled\n\t\t\t * architectures will switch to pgtable-nop4d.h.\n\t\t\t */\n#ifndef __ARCH_HAS_5LEVEL_HACK\n\t\t\tpgd_populate(&init_mm, pgd, lm_alias(kasan_zero_p4d));\n#endif\n\t\t\tp4d = p4d_offset(pgd, addr);\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pgd_none(*pgd)) {\n\t\t\tp4d_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = p4d_alloc(&init_mm, pgd, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpgd_populate(&init_mm, pgd,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_p4d_populate(pgd, addr, next);\n\t} while (pgd++, addr = next, addr != end);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "zero_p4d_populate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "172-209",
    "snippet": "static int __ref zero_p4d_populate(pgd_t *pgd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tp4d_t *p4d = p4d_offset(pgd, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = p4d_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, P4D_SIZE) && end - addr >= P4D_SIZE) {\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd,\n\t\t\t\t\t\tlm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (p4d_none(*p4d)) {\n\t\t\tpud_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pud_alloc(&init_mm, p4d, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tp4d_populate(&init_mm, p4d,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pud_populate(p4d, addr, next);\n\t} while (p4d++, addr = next, addr != end);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "pte_t kasan_zero_pte[PTRS_PER_PTE]"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zero_pud_populate",
          "args": [
            "p4d",
            "addr",
            "next"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "zero_pud_populate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "137-170",
          "snippet": "static int __ref zero_pud_populate(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpud_t *pud = pud_offset(p4d, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pud_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, PUD_SIZE) && end - addr >= PUD_SIZE) {\n\t\t\tpmd_t *pmd;\n\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pud_none(*pud)) {\n\t\t\tpmd_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pmd_alloc(&init_mm, pud, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpud_populate(&init_mm, pud,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pmd_populate(pud, addr, next);\n\t} while (pud++, addr = next, addr != end);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "pte_t kasan_zero_pte[PTRS_PER_PTE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic int __ref zero_pud_populate(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpud_t *pud = pud_offset(p4d, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pud_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, PUD_SIZE) && end - addr >= PUD_SIZE) {\n\t\t\tpmd_t *pmd;\n\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pud_none(*pud)) {\n\t\t\tpmd_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pmd_alloc(&init_mm, pud, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpud_populate(&init_mm, pud,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pmd_populate(pud, addr, next);\n\t} while (pud++, addr = next, addr != end);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p4d_populate",
          "args": [
            "&init_mm",
            "p4d",
            "early_alloc(PAGE_SIZE, NUMA_NO_NODE)"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "zero_p4d_populate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "172-209",
          "snippet": "static int __ref zero_p4d_populate(pgd_t *pgd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tp4d_t *p4d = p4d_offset(pgd, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = p4d_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, P4D_SIZE) && end - addr >= P4D_SIZE) {\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd,\n\t\t\t\t\t\tlm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (p4d_none(*p4d)) {\n\t\t\tpud_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pud_alloc(&init_mm, p4d, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tp4d_populate(&init_mm, p4d,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pud_populate(p4d, addr, next);\n\t} while (p4d++, addr = next, addr != end);\n\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "early_alloc",
          "args": [
            "PAGE_SIZE",
            "NUMA_NO_NODE"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "early_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "83-87",
          "snippet": "static __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pud_alloc",
          "args": [
            "&init_mm",
            "p4d",
            "addr"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "__pud_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory.c",
          "lines": "3972-3996",
          "snippet": "int __pud_alloc(struct mm_struct *mm, p4d_t *p4d, unsigned long address)\n{\n\tpud_t *new = pud_alloc_one(mm, address);\n\tif (!new)\n\t\treturn -ENOMEM;\n\n\tsmp_wmb(); /* See comment in __pte_alloc */\n\n\tspin_lock(&mm->page_table_lock);\n#ifndef __ARCH_HAS_5LEVEL_HACK\n\tif (!p4d_present(*p4d)) {\n\t\tmm_inc_nr_puds(mm);\n\t\tp4d_populate(mm, p4d, new);\n\t} else\t/* Another has populated it */\n\t\tpud_free(mm, new);\n#else\n\tif (!pgd_present(*p4d)) {\n\t\tmm_inc_nr_puds(mm);\n\t\tpgd_populate(mm, p4d, new);\n\t} else\t/* Another has populated it */\n\t\tpud_free(mm, new);\n#endif /* __ARCH_HAS_5LEVEL_HACK */\n\tspin_unlock(&mm->page_table_lock);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/io.h>",
            "#include <linux/oom.h>",
            "#include <linux/dax.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/dma-debug.h>",
            "#include <linux/string.h>",
            "#include <linux/migrate.h>",
            "#include <linux/gfp.h>",
            "#include <linux/elf.h>",
            "#include <linux/swapops.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pfn_t.h>",
            "#include <linux/init.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/export.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/memremap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel_stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <asm/mmu_context.h>\n#include <asm/io.h>\n#include <linux/oom.h>\n#include <linux/dax.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/debugfs.h>\n#include <linux/dma-debug.h>\n#include <linux/string.h>\n#include <linux/migrate.h>\n#include <linux/gfp.h>\n#include <linux/elf.h>\n#include <linux/swapops.h>\n#include <linux/mmu_notifier.h>\n#include <linux/memcontrol.h>\n#include <linux/writeback.h>\n#include <linux/pfn_t.h>\n#include <linux/init.h>\n#include <linux/delayacct.h>\n#include <linux/export.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/memremap.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/kernel_stat.h>\n\nint __pud_alloc(struct mm_struct *mm, p4d_t *p4d, unsigned long address)\n{\n\tpud_t *new = pud_alloc_one(mm, address);\n\tif (!new)\n\t\treturn -ENOMEM;\n\n\tsmp_wmb(); /* See comment in __pte_alloc */\n\n\tspin_lock(&mm->page_table_lock);\n#ifndef __ARCH_HAS_5LEVEL_HACK\n\tif (!p4d_present(*p4d)) {\n\t\tmm_inc_nr_puds(mm);\n\t\tp4d_populate(mm, p4d, new);\n\t} else\t/* Another has populated it */\n\t\tpud_free(mm, new);\n#else\n\tif (!pgd_present(*p4d)) {\n\t\tmm_inc_nr_puds(mm);\n\t\tpgd_populate(mm, p4d, new);\n\t} else\t/* Another has populated it */\n\t\tpud_free(mm, new);\n#endif /* __ARCH_HAS_5LEVEL_HACK */\n\tspin_unlock(&mm->page_table_lock);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slab_is_available",
          "args": [],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "slab_is_available",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "930-933",
          "snippet": "bool slab_is_available(void)\n{\n\treturn slab_state >= UP;\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "enum slab_state slab_state;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nenum slab_state slab_state;\n\nbool slab_is_available(void)\n{\n\treturn slab_state >= UP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "p4d_none",
          "args": [
            "*p4d"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_populate_kernel",
          "args": [
            "&init_mm",
            "pmd",
            "lm_alias(kasan_zero_pte)"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pte"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_offset",
          "args": [
            "pud",
            "addr"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pmd"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_offset",
          "args": [
            "p4d",
            "addr"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pud"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "P4D_SIZE"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_addr_end",
          "args": [
            "addr",
            "end"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_offset",
          "args": [
            "pgd",
            "addr"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic int __ref zero_p4d_populate(pgd_t *pgd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tp4d_t *p4d = p4d_offset(pgd, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = p4d_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, P4D_SIZE) && end - addr >= P4D_SIZE) {\n\t\t\tpud_t *pud;\n\t\t\tpmd_t *pmd;\n\n\t\t\tp4d_populate(&init_mm, p4d, lm_alias(kasan_zero_pud));\n\t\t\tpud = pud_offset(p4d, addr);\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd,\n\t\t\t\t\t\tlm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (p4d_none(*p4d)) {\n\t\t\tpud_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pud_alloc(&init_mm, p4d, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tp4d_populate(&init_mm, p4d,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pud_populate(p4d, addr, next);\n\t} while (p4d++, addr = next, addr != end);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "zero_pud_populate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "137-170",
    "snippet": "static int __ref zero_pud_populate(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpud_t *pud = pud_offset(p4d, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pud_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, PUD_SIZE) && end - addr >= PUD_SIZE) {\n\t\t\tpmd_t *pmd;\n\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pud_none(*pud)) {\n\t\t\tpmd_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pmd_alloc(&init_mm, pud, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpud_populate(&init_mm, pud,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pmd_populate(pud, addr, next);\n\t} while (pud++, addr = next, addr != end);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "pte_t kasan_zero_pte[PTRS_PER_PTE]"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zero_pmd_populate",
          "args": [
            "pud",
            "addr",
            "next"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "zero_pmd_populate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "105-135",
          "snippet": "static int __ref zero_pmd_populate(pud_t *pud, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpmd_t *pmd = pmd_offset(pud, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pmd_addr_end(addr, end);\n\n\t\tif (IS_ALIGNED(addr, PMD_SIZE) && end - addr >= PMD_SIZE) {\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pmd_none(*pmd)) {\n\t\t\tpte_t *p;\n\n\t\t\tif (slab_is_available())\n\t\t\t\tp = pte_alloc_one_kernel(&init_mm, addr);\n\t\t\telse\n\t\t\t\tp = early_alloc(PAGE_SIZE, NUMA_NO_NODE);\n\t\t\tif (!p)\n\t\t\t\treturn -ENOMEM;\n\n\t\t\tpmd_populate_kernel(&init_mm, pmd, p);\n\t\t}\n\t\tzero_pte_populate(pmd, addr, next);\n\t} while (pmd++, addr = next, addr != end);\n\n\treturn 0;\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "pte_t kasan_zero_pte[PTRS_PER_PTE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic int __ref zero_pmd_populate(pud_t *pud, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpmd_t *pmd = pmd_offset(pud, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pmd_addr_end(addr, end);\n\n\t\tif (IS_ALIGNED(addr, PMD_SIZE) && end - addr >= PMD_SIZE) {\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pmd_none(*pmd)) {\n\t\t\tpte_t *p;\n\n\t\t\tif (slab_is_available())\n\t\t\t\tp = pte_alloc_one_kernel(&init_mm, addr);\n\t\t\telse\n\t\t\t\tp = early_alloc(PAGE_SIZE, NUMA_NO_NODE);\n\t\t\tif (!p)\n\t\t\t\treturn -ENOMEM;\n\n\t\t\tpmd_populate_kernel(&init_mm, pmd, p);\n\t\t}\n\t\tzero_pte_populate(pmd, addr, next);\n\t} while (pmd++, addr = next, addr != end);\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pud_populate",
          "args": [
            "&init_mm",
            "pud",
            "early_alloc(PAGE_SIZE, NUMA_NO_NODE)"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "zero_pud_populate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "137-170",
          "snippet": "static int __ref zero_pud_populate(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpud_t *pud = pud_offset(p4d, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pud_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, PUD_SIZE) && end - addr >= PUD_SIZE) {\n\t\t\tpmd_t *pmd;\n\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pud_none(*pud)) {\n\t\t\tpmd_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pmd_alloc(&init_mm, pud, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpud_populate(&init_mm, pud,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pmd_populate(pud, addr, next);\n\t} while (pud++, addr = next, addr != end);\n\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "early_alloc",
          "args": [
            "PAGE_SIZE",
            "NUMA_NO_NODE"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "early_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "83-87",
          "snippet": "static __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pmd_alloc",
          "args": [
            "&init_mm",
            "pud",
            "addr"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "__pmd_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory.c",
          "lines": "4004-4029",
          "snippet": "int __pmd_alloc(struct mm_struct *mm, pud_t *pud, unsigned long address)\n{\n\tspinlock_t *ptl;\n\tpmd_t *new = pmd_alloc_one(mm, address);\n\tif (!new)\n\t\treturn -ENOMEM;\n\n\tsmp_wmb(); /* See comment in __pte_alloc */\n\n\tptl = pud_lock(mm, pud);\n#ifndef __ARCH_HAS_4LEVEL_HACK\n\tif (!pud_present(*pud)) {\n\t\tmm_inc_nr_pmds(mm);\n\t\tpud_populate(mm, pud, new);\n\t} else\t/* Another has populated it */\n\t\tpmd_free(mm, new);\n#else\n\tif (!pgd_present(*pud)) {\n\t\tmm_inc_nr_pmds(mm);\n\t\tpgd_populate(mm, pud, new);\n\t} else /* Another has populated it */\n\t\tpmd_free(mm, new);\n#endif /* __ARCH_HAS_4LEVEL_HACK */\n\tspin_unlock(ptl);\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/pgtable.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <asm/mmu_context.h>",
            "#include <asm/io.h>",
            "#include <linux/oom.h>",
            "#include <linux/dax.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/dma-debug.h>",
            "#include <linux/string.h>",
            "#include <linux/migrate.h>",
            "#include <linux/gfp.h>",
            "#include <linux/elf.h>",
            "#include <linux/swapops.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pfn_t.h>",
            "#include <linux/init.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/export.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/memremap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel_stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/pgtable.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <asm/mmu_context.h>\n#include <asm/io.h>\n#include <linux/oom.h>\n#include <linux/dax.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/debugfs.h>\n#include <linux/dma-debug.h>\n#include <linux/string.h>\n#include <linux/migrate.h>\n#include <linux/gfp.h>\n#include <linux/elf.h>\n#include <linux/swapops.h>\n#include <linux/mmu_notifier.h>\n#include <linux/memcontrol.h>\n#include <linux/writeback.h>\n#include <linux/pfn_t.h>\n#include <linux/init.h>\n#include <linux/delayacct.h>\n#include <linux/export.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/memremap.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/kernel_stat.h>\n\nint __pmd_alloc(struct mm_struct *mm, pud_t *pud, unsigned long address)\n{\n\tspinlock_t *ptl;\n\tpmd_t *new = pmd_alloc_one(mm, address);\n\tif (!new)\n\t\treturn -ENOMEM;\n\n\tsmp_wmb(); /* See comment in __pte_alloc */\n\n\tptl = pud_lock(mm, pud);\n#ifndef __ARCH_HAS_4LEVEL_HACK\n\tif (!pud_present(*pud)) {\n\t\tmm_inc_nr_pmds(mm);\n\t\tpud_populate(mm, pud, new);\n\t} else\t/* Another has populated it */\n\t\tpmd_free(mm, new);\n#else\n\tif (!pgd_present(*pud)) {\n\t\tmm_inc_nr_pmds(mm);\n\t\tpgd_populate(mm, pud, new);\n\t} else /* Another has populated it */\n\t\tpmd_free(mm, new);\n#endif /* __ARCH_HAS_4LEVEL_HACK */\n\tspin_unlock(ptl);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "slab_is_available",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "slab_is_available",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "930-933",
          "snippet": "bool slab_is_available(void)\n{\n\treturn slab_state >= UP;\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "enum slab_state slab_state;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nenum slab_state slab_state;\n\nbool slab_is_available(void)\n{\n\treturn slab_state >= UP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pud_none",
          "args": [
            "*pud"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_populate_kernel",
          "args": [
            "&init_mm",
            "pmd",
            "lm_alias(kasan_zero_pte)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pte"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_offset",
          "args": [
            "pud",
            "addr"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pmd"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "PUD_SIZE"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_addr_end",
          "args": [
            "addr",
            "end"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_offset",
          "args": [
            "p4d",
            "addr"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic int __ref zero_pud_populate(p4d_t *p4d, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpud_t *pud = pud_offset(p4d, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pud_addr_end(addr, end);\n\t\tif (IS_ALIGNED(addr, PUD_SIZE) && end - addr >= PUD_SIZE) {\n\t\t\tpmd_t *pmd;\n\n\t\t\tpud_populate(&init_mm, pud, lm_alias(kasan_zero_pmd));\n\t\t\tpmd = pmd_offset(pud, addr);\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pud_none(*pud)) {\n\t\t\tpmd_t *p;\n\n\t\t\tif (slab_is_available()) {\n\t\t\t\tp = pmd_alloc(&init_mm, pud, addr);\n\t\t\t\tif (!p)\n\t\t\t\t\treturn -ENOMEM;\n\t\t\t} else {\n\t\t\t\tpud_populate(&init_mm, pud,\n\t\t\t\t\tearly_alloc(PAGE_SIZE, NUMA_NO_NODE));\n\t\t\t}\n\t\t}\n\t\tzero_pmd_populate(pud, addr, next);\n\t} while (pud++, addr = next, addr != end);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "zero_pmd_populate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "105-135",
    "snippet": "static int __ref zero_pmd_populate(pud_t *pud, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpmd_t *pmd = pmd_offset(pud, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pmd_addr_end(addr, end);\n\n\t\tif (IS_ALIGNED(addr, PMD_SIZE) && end - addr >= PMD_SIZE) {\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pmd_none(*pmd)) {\n\t\t\tpte_t *p;\n\n\t\t\tif (slab_is_available())\n\t\t\t\tp = pte_alloc_one_kernel(&init_mm, addr);\n\t\t\telse\n\t\t\t\tp = early_alloc(PAGE_SIZE, NUMA_NO_NODE);\n\t\t\tif (!p)\n\t\t\t\treturn -ENOMEM;\n\n\t\t\tpmd_populate_kernel(&init_mm, pmd, p);\n\t\t}\n\t\tzero_pte_populate(pmd, addr, next);\n\t} while (pmd++, addr = next, addr != end);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "pte_t kasan_zero_pte[PTRS_PER_PTE]"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zero_pte_populate",
          "args": [
            "pmd",
            "addr",
            "next"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "zero_pte_populate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "89-103",
          "snippet": "static void __ref zero_pte_populate(pmd_t *pmd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpte_t *pte = pte_offset_kernel(pmd, addr);\n\tpte_t zero_pte;\n\n\tzero_pte = pfn_pte(PFN_DOWN(__pa_symbol(kasan_zero_page)), PAGE_KERNEL);\n\tzero_pte = pte_wrprotect(zero_pte);\n\n\twhile (addr + PAGE_SIZE <= end) {\n\t\tset_pte_at(&init_mm, addr, pte, zero_pte);\n\t\taddr += PAGE_SIZE;\n\t\tpte = pte_offset_kernel(pmd, addr);\n\t}\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned char kasan_zero_page[PAGE_SIZE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nunsigned char kasan_zero_page[PAGE_SIZE];\n\nstatic void __ref zero_pte_populate(pmd_t *pmd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpte_t *pte = pte_offset_kernel(pmd, addr);\n\tpte_t zero_pte;\n\n\tzero_pte = pfn_pte(PFN_DOWN(__pa_symbol(kasan_zero_page)), PAGE_KERNEL);\n\tzero_pte = pte_wrprotect(zero_pte);\n\n\twhile (addr + PAGE_SIZE <= end) {\n\t\tset_pte_at(&init_mm, addr, pte, zero_pte);\n\t\taddr += PAGE_SIZE;\n\t\tpte = pte_offset_kernel(pmd, addr);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pmd_populate_kernel",
          "args": [
            "&init_mm",
            "pmd",
            "p"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "early_alloc",
          "args": [
            "PAGE_SIZE",
            "NUMA_NO_NODE"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "early_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
          "lines": "83-87",
          "snippet": "static __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}",
          "includes": [
            "#include \"kasan.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/page.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/memblock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pte_alloc_one_kernel",
          "args": [
            "&init_mm",
            "addr"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slab_is_available",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "slab_is_available",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "930-933",
          "snippet": "bool slab_is_available(void)\n{\n\treturn slab_state >= UP;\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "enum slab_state slab_state;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nenum slab_state slab_state;\n\nbool slab_is_available(void)\n{\n\treturn slab_state >= UP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pmd_none",
          "args": [
            "*pmd"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_populate_kernel",
          "args": [
            "&init_mm",
            "pmd",
            "lm_alias(kasan_zero_pte)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pte"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "PMD_SIZE"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_addr_end",
          "args": [
            "addr",
            "end"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_offset",
          "args": [
            "pud",
            "addr"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic int __ref zero_pmd_populate(pud_t *pud, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpmd_t *pmd = pmd_offset(pud, addr);\n\tunsigned long next;\n\n\tdo {\n\t\tnext = pmd_addr_end(addr, end);\n\n\t\tif (IS_ALIGNED(addr, PMD_SIZE) && end - addr >= PMD_SIZE) {\n\t\t\tpmd_populate_kernel(&init_mm, pmd, lm_alias(kasan_zero_pte));\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (pmd_none(*pmd)) {\n\t\t\tpte_t *p;\n\n\t\t\tif (slab_is_available())\n\t\t\t\tp = pte_alloc_one_kernel(&init_mm, addr);\n\t\t\telse\n\t\t\t\tp = early_alloc(PAGE_SIZE, NUMA_NO_NODE);\n\t\t\tif (!p)\n\t\t\t\treturn -ENOMEM;\n\n\t\t\tpmd_populate_kernel(&init_mm, pmd, p);\n\t\t}\n\t\tzero_pte_populate(pmd, addr, next);\n\t} while (pmd++, addr = next, addr != end);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "zero_pte_populate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "89-103",
    "snippet": "static void __ref zero_pte_populate(pmd_t *pmd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpte_t *pte = pte_offset_kernel(pmd, addr);\n\tpte_t zero_pte;\n\n\tzero_pte = pfn_pte(PFN_DOWN(__pa_symbol(kasan_zero_page)), PAGE_KERNEL);\n\tzero_pte = pte_wrprotect(zero_pte);\n\n\twhile (addr + PAGE_SIZE <= end) {\n\t\tset_pte_at(&init_mm, addr, pte, zero_pte);\n\t\taddr += PAGE_SIZE;\n\t\tpte = pte_offset_kernel(pmd, addr);\n\t}\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned char kasan_zero_page[PAGE_SIZE]"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "pte_offset_kernel",
          "args": [
            "pmd",
            "addr"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_pte_at",
          "args": [
            "&init_mm",
            "addr",
            "pte",
            "zero_pte"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_wrprotect",
          "args": [
            "zero_pte"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_pte",
          "args": [
            "PFN_DOWN(__pa_symbol(kasan_zero_page))",
            "PAGE_KERNEL"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PFN_DOWN",
          "args": [
            "__pa_symbol(kasan_zero_page)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__pa_symbol",
          "args": [
            "kasan_zero_page"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_offset_kernel",
          "args": [
            "pmd",
            "addr"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nunsigned char kasan_zero_page[PAGE_SIZE];\n\nstatic void __ref zero_pte_populate(pmd_t *pmd, unsigned long addr,\n\t\t\t\tunsigned long end)\n{\n\tpte_t *pte = pte_offset_kernel(pmd, addr);\n\tpte_t zero_pte;\n\n\tzero_pte = pfn_pte(PFN_DOWN(__pa_symbol(kasan_zero_page)), PAGE_KERNEL);\n\tzero_pte = pte_wrprotect(zero_pte);\n\n\twhile (addr + PAGE_SIZE <= end) {\n\t\tset_pte_at(&init_mm, addr, pte, zero_pte);\n\t\taddr += PAGE_SIZE;\n\t\tpte = pte_offset_kernel(pmd, addr);\n\t}\n}"
  },
  {
    "function_name": "early_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "83-87",
    "snippet": "static __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memblock_alloc_try_nid",
          "args": [
            "size",
            "size",
            "__pa(MAX_DMA_ADDRESS)",
            "MEMBLOCK_ALLOC_ACCESSIBLE",
            "node"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "memblock_alloc_try_nid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memblock.c",
          "lines": "1517-1537",
          "snippet": "void * __init memblock_alloc_try_nid(\n\t\t\tphys_addr_t size, phys_addr_t align,\n\t\t\tphys_addr_t min_addr, phys_addr_t max_addr,\n\t\t\tint nid)\n{\n\tvoid *ptr;\n\n\tmemblock_dbg(\"%s: %llu bytes align=0x%llx nid=%d from=%pa max_addr=%pa %pF\\n\",\n\t\t     __func__, (u64)size, (u64)align, nid, &min_addr,\n\t\t     &max_addr, (void *)_RET_IP_);\n\tptr = memblock_alloc_internal(size, align,\n\t\t\t\t\t   min_addr, max_addr, nid);\n\tif (ptr) {\n\t\tmemset(ptr, 0, size);\n\t\treturn ptr;\n\t}\n\n\tpanic(\"%s: Failed to allocate %llu bytes align=0x%llx nid=%d from=%pa max_addr=%pa\\n\",\n\t      __func__, (u64)size, (u64)align, nid, &min_addr, &max_addr);\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/io.h>",
            "#include <asm/sections.h>",
            "#include <linux/memblock.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/pfn.h>",
            "#include <linux/poison.h>",
            "#include <linux/bitops.h>",
            "#include <linux/init.h>",
            "#include <linux/slab.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/io.h>\n#include <asm/sections.h>\n#include <linux/memblock.h>\n#include <linux/seq_file.h>\n#include <linux/kmemleak.h>\n#include <linux/debugfs.h>\n#include <linux/pfn.h>\n#include <linux/poison.h>\n#include <linux/bitops.h>\n#include <linux/init.h>\n#include <linux/slab.h>\n#include <linux/kernel.h>\n\nvoid * __init memblock_alloc_try_nid(\n\t\t\tphys_addr_t size, phys_addr_t align,\n\t\t\tphys_addr_t min_addr, phys_addr_t max_addr,\n\t\t\tint nid)\n{\n\tvoid *ptr;\n\n\tmemblock_dbg(\"%s: %llu bytes align=0x%llx nid=%d from=%pa max_addr=%pa %pF\\n\",\n\t\t     __func__, (u64)size, (u64)align, nid, &min_addr,\n\t\t     &max_addr, (void *)_RET_IP_);\n\tptr = memblock_alloc_internal(size, align,\n\t\t\t\t\t   min_addr, max_addr, nid);\n\tif (ptr) {\n\t\tmemset(ptr, 0, size);\n\t\treturn ptr;\n\t}\n\n\tpanic(\"%s: Failed to allocate %llu bytes align=0x%llx nid=%d from=%pa max_addr=%pa\\n\",\n\t      __func__, (u64)size, (u64)align, nid, &min_addr, &max_addr);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__pa",
          "args": [
            "MAX_DMA_ADDRESS"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "__page_mapcount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/util.c",
          "lines": "536-552",
          "snippet": "int __page_mapcount(struct page *page)\n{\n\tint ret;\n\n\tret = atomic_read(&page->_mapcount) + 1;\n\t/*\n\t * For file THP page->_mapcount contains total number of mapping\n\t * of the page: no need to look into compound_mapcount.\n\t */\n\tif (!PageAnon(page) && !PageHuge(page))\n\t\treturn ret;\n\tpage = compound_head(page);\n\tret += atomic_read(compound_mapcount_ptr(page)) + 1;\n\tif (PageDoubleMap(page))\n\t\tret--;\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/uaccess.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/mman.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/security.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/err.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/string.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/uaccess.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/vmalloc.h>\n#include <linux/hugetlb.h>\n#include <linux/mman.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/security.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/err.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/string.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n\nint __page_mapcount(struct page *page)\n{\n\tint ret;\n\n\tret = atomic_read(&page->_mapcount) + 1;\n\t/*\n\t * For file THP page->_mapcount contains total number of mapping\n\t * of the page: no need to look into compound_mapcount.\n\t */\n\tif (!PageAnon(page) && !PageHuge(page))\n\t\treturn ret;\n\tpage = compound_head(page);\n\tret += atomic_read(compound_mapcount_ptr(page)) + 1;\n\tif (PageDoubleMap(page))\n\t\tret--;\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic __init void *early_alloc(size_t size, int node)\n{\n\treturn memblock_alloc_try_nid(size, size, __pa(MAX_DMA_ADDRESS),\n\t\t\t\t\tMEMBLOCK_ALLOC_ACCESSIBLE, node);\n}"
  },
  {
    "function_name": "kasan_zero_page_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "78-81",
    "snippet": "static inline bool kasan_zero_page_entry(pte_t pte)\n{\n\treturn pte_page(pte) == virt_to_page(lm_alias(kasan_zero_page));\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "unsigned char kasan_zero_page[PAGE_SIZE]"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "lm_alias(kasan_zero_page)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_page"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_page",
          "args": [
            "pte"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "release_pte_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/khugepaged.c",
          "lines": "504-509",
          "snippet": "static void release_pte_page(struct page *page)\n{\n\tdec_node_page_state(page, NR_ISOLATED_ANON + page_is_file_cache(page));\n\tunlock_page(page);\n\tputback_lru_page(page);\n}",
          "includes": [
            "#include <trace/events/huge_memory.h>",
            "#include \"internal.h\"",
            "#include <asm/pgalloc.h>",
            "#include <asm/tlb.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page_idle.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/mman.h>",
            "#include <linux/freezer.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/kthread.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/swap.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/huge_memory.h>\n#include \"internal.h\"\n#include <asm/pgalloc.h>\n#include <asm/tlb.h>\n#include <linux/shmem_fs.h>\n#include <linux/swapops.h>\n#include <linux/page_idle.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/hashtable.h>\n#include <linux/mman.h>\n#include <linux/freezer.h>\n#include <linux/khugepaged.h>\n#include <linux/kthread.h>\n#include <linux/mm_inline.h>\n#include <linux/swap.h>\n#include <linux/rmap.h>\n#include <linux/mmu_notifier.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched.h>\n#include <linux/mm.h>\n\nstatic void release_pte_page(struct page *page)\n{\n\tdec_node_page_state(page, NR_ISOLATED_ANON + page_is_file_cache(page));\n\tunlock_page(page);\n\tputback_lru_page(page);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nunsigned char kasan_zero_page[PAGE_SIZE];\n\nstatic inline bool kasan_zero_page_entry(pte_t pte)\n{\n\treturn pte_page(pte) == virt_to_page(lm_alias(kasan_zero_page));\n}"
  },
  {
    "function_name": "kasan_pte_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "73-76",
    "snippet": "static inline bool kasan_pte_table(pmd_t pmd)\n{\n\treturn pmd_page(pmd) == virt_to_page(lm_alias(kasan_zero_pte));\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "pte_t kasan_zero_pte[PTRS_PER_PTE]"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "lm_alias(kasan_zero_pte)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pte"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_page",
          "args": [
            "pmd"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\npte_t kasan_zero_pte[PTRS_PER_PTE];\n\nstatic inline bool kasan_pte_table(pmd_t pmd)\n{\n\treturn pmd_page(pmd) == virt_to_page(lm_alias(kasan_zero_pte));\n}"
  },
  {
    "function_name": "kasan_pmd_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "66-69",
    "snippet": "static inline bool kasan_pmd_table(pud_t pud)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_pmd_table(pud_t pud)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "kasan_pmd_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "61-64",
    "snippet": "static inline bool kasan_pmd_table(pud_t pud)\n{\n\treturn pud_page(pud) == virt_to_page(lm_alias(kasan_zero_pmd));\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "lm_alias(kasan_zero_pmd)"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pmd"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_page",
          "args": [
            "pud"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_pmd_table(pud_t pud)\n{\n\treturn pud_page(pud) == virt_to_page(lm_alias(kasan_zero_pmd));\n}"
  },
  {
    "function_name": "kasan_pud_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "54-57",
    "snippet": "static inline bool kasan_pud_table(p4d_t p4d)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_pud_table(p4d_t p4d)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "kasan_pud_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "49-52",
    "snippet": "static inline bool kasan_pud_table(p4d_t p4d)\n{\n\treturn p4d_page(p4d) == virt_to_page(lm_alias(kasan_zero_pud));\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "lm_alias(kasan_zero_pud)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_pud"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_page",
          "args": [
            "p4d"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_pud_table(p4d_t p4d)\n{\n\treturn p4d_page(p4d) == virt_to_page(lm_alias(kasan_zero_pud));\n}"
  },
  {
    "function_name": "kasan_p4d_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "42-45",
    "snippet": "static inline bool kasan_p4d_table(pgd_t pgd)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_p4d_table(pgd_t pgd)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "kasan_p4d_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan_init.c",
    "lines": "37-40",
    "snippet": "static inline bool kasan_p4d_table(pgd_t pgd)\n{\n\treturn pgd_page(pgd) == virt_to_page(lm_alias(kasan_zero_p4d));\n}",
    "includes": [
      "#include \"kasan.h\"",
      "#include <asm/pgalloc.h>",
      "#include <asm/page.h>",
      "#include <linux/slab.h>",
      "#include <linux/pfn.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/memblock.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "lm_alias(kasan_zero_p4d)"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lm_alias",
          "args": [
            "kasan_zero_p4d"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_page",
          "args": [
            "pgd"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"kasan.h\"\n#include <asm/pgalloc.h>\n#include <asm/page.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/memblock.h>\n\nstatic inline bool kasan_p4d_table(pgd_t pgd)\n{\n\treturn pgd_page(pgd) == virt_to_page(lm_alias(kasan_zero_p4d));\n}"
  }
]