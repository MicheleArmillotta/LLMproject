[
  {
    "function_name": "kasan_memhotplug_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "895-900",
    "snippet": "static int __init kasan_memhotplug_init(void)\n{\n\thotplug_memory_notifier(kasan_mem_notifier, 0);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hotplug_memory_notifier",
          "args": [
            "kasan_mem_notifier",
            "0"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic int __init kasan_memhotplug_init(void)\n{\n\thotplug_memory_notifier(kasan_mem_notifier, 0);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "kasan_mem_notifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "830-893",
    "snippet": "static int __meminit kasan_mem_notifier(struct notifier_block *nb,\n\t\t\tunsigned long action, void *data)\n{\n\tstruct memory_notify *mem_data = data;\n\tunsigned long nr_shadow_pages, start_kaddr, shadow_start;\n\tunsigned long shadow_end, shadow_size;\n\n\tnr_shadow_pages = mem_data->nr_pages >> KASAN_SHADOW_SCALE_SHIFT;\n\tstart_kaddr = (unsigned long)pfn_to_kaddr(mem_data->start_pfn);\n\tshadow_start = (unsigned long)kasan_mem_to_shadow((void *)start_kaddr);\n\tshadow_size = nr_shadow_pages << PAGE_SHIFT;\n\tshadow_end = shadow_start + shadow_size;\n\n\tif (WARN_ON(mem_data->nr_pages % KASAN_SHADOW_SCALE_SIZE) ||\n\t\tWARN_ON(start_kaddr % (KASAN_SHADOW_SCALE_SIZE << PAGE_SHIFT)))\n\t\treturn NOTIFY_BAD;\n\n\tswitch (action) {\n\tcase MEM_GOING_ONLINE: {\n\t\tvoid *ret;\n\n\t\t/*\n\t\t * If shadow is mapped already than it must have been mapped\n\t\t * during the boot. This could happen if we onlining previously\n\t\t * offlined memory.\n\t\t */\n\t\tif (shadow_mapped(shadow_start))\n\t\t\treturn NOTIFY_OK;\n\n\t\tret = __vmalloc_node_range(shadow_size, PAGE_SIZE, shadow_start,\n\t\t\t\t\tshadow_end, GFP_KERNEL,\n\t\t\t\t\tPAGE_KERNEL, VM_NO_GUARD,\n\t\t\t\t\tpfn_to_nid(mem_data->start_pfn),\n\t\t\t\t\t__builtin_return_address(0));\n\t\tif (!ret)\n\t\t\treturn NOTIFY_BAD;\n\n\t\tkmemleak_ignore(ret);\n\t\treturn NOTIFY_OK;\n\t}\n\tcase MEM_CANCEL_ONLINE:\n\tcase MEM_OFFLINE: {\n\t\tstruct vm_struct *vm;\n\n\t\t/*\n\t\t * shadow_start was either mapped during boot by kasan_init()\n\t\t * or during memory online by __vmalloc_node_range().\n\t\t * In the latter case we can use vfree() to free shadow.\n\t\t * Non-NULL result of the find_vm_area() will tell us if\n\t\t * that was the second case.\n\t\t *\n\t\t * Currently it's not possible to free shadow mapped\n\t\t * during boot by kasan_init(). It's because the code\n\t\t * to do that hasn't been written yet. So we'll just\n\t\t * leak the memory.\n\t\t */\n\t\tvm = find_vm_area((void *)shadow_start);\n\t\tif (vm)\n\t\t\tvfree((void *)shadow_start);\n\t}\n\t}\n\n\treturn NOTIFY_OK;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfree",
          "args": [
            "(void *)shadow_start"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "vfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/nommu.c",
          "lines": "224-227",
          "snippet": "void vfree(const void *addr)\n{\n\tkfree(addr);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/mmu_context.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/printk.h>",
            "#include <linux/audit.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/mount.h>",
            "#include <linux/compiler.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/file.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/mmu_context.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <linux/printk.h>\n#include <linux/audit.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/mount.h>\n#include <linux/compiler.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/file.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/vmacache.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid vfree(const void *addr)\n{\n\tkfree(addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_vm_area",
          "args": [
            "(void *)shadow_start"
          ],
          "line": 886
        },
        "resolved": true,
        "details": {
          "function_name": "find_vm_area",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmalloc.c",
          "lines": "1454-1463",
          "snippet": "struct vm_struct *find_vm_area(const void *addr)\n{\n\tstruct vmap_area *va;\n\n\tva = find_vmap_area((unsigned long)addr);\n\tif (va && va->flags & VM_VM_AREA)\n\t\treturn va->vm;\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/shmparam.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/bitops.h>",
            "#include <linux/llist.h>",
            "#include <linux/compiler.h>",
            "#include <linux/atomic.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/pfn.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>"
          ],
          "macros_used": [
            "#define VM_VM_AREA\t0x04"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/shmparam.h>\n#include <asm/tlbflush.h>\n#include <linux/uaccess.h>\n#include <linux/bitops.h>\n#include <linux/llist.h>\n#include <linux/compiler.h>\n#include <linux/atomic.h>\n#include <linux/kmemleak.h>\n#include <linux/pfn.h>\n#include <linux/rcupdate.h>\n#include <linux/radix-tree.h>\n#include <linux/rbtree.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kallsyms.h>\n#include <linux/debugobjects.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n\n#define VM_VM_AREA\t0x04\n\nstruct vm_struct *find_vm_area(const void *addr)\n{\n\tstruct vmap_area *va;\n\n\tva = find_vmap_area((unsigned long)addr);\n\tif (va && va->flags & VM_VM_AREA)\n\t\treturn va->vm;\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmemleak_ignore",
          "args": [
            "ret"
          ],
          "line": 867
        },
        "resolved": true,
        "details": {
          "function_name": "kmemleak_ignore_phys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kmemleak.c",
          "lines": "1259-1263",
          "snippet": "void __ref kmemleak_ignore_phys(phys_addr_t phys)\n{\n\tif (!IS_ENABLED(CONFIG_HIGHMEM) || PHYS_PFN(phys) < max_low_pfn)\n\t\tkmemleak_ignore(__va(phys));\n}",
          "includes": [
            "#include <linux/memory_hotplug.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kasan.h>",
            "#include <linux/atomic.h>",
            "#include <asm/processor.h>",
            "#include <asm/sections.h>",
            "#include <linux/crc32.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/mm.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/string.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/err.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/slab.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/pfn.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/cache.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/kthread.h>",
            "#include <linux/export.h>",
            "#include <linux/delay.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memory_hotplug.h>\n#include <linux/kmemleak.h>\n#include <linux/kasan.h>\n#include <linux/atomic.h>\n#include <asm/processor.h>\n#include <asm/sections.h>\n#include <linux/crc32.h>\n#include <linux/workqueue.h>\n#include <linux/mm.h>\n#include <linux/nodemask.h>\n#include <linux/string.h>\n#include <linux/uaccess.h>\n#include <linux/err.h>\n#include <linux/thread_info.h>\n#include <linux/slab.h>\n#include <linux/mmzone.h>\n#include <linux/pfn.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/cache.h>\n#include <linux/stacktrace.h>\n#include <linux/rcupdate.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/kthread.h>\n#include <linux/export.h>\n#include <linux/delay.h>\n#include <linux/jiffies.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid __ref kmemleak_ignore_phys(phys_addr_t phys)\n{\n\tif (!IS_ENABLED(CONFIG_HIGHMEM) || PHYS_PFN(phys) < max_low_pfn)\n\t\tkmemleak_ignore(__va(phys));\n}"
        }
      },
      {
        "call_info": {
          "callee": "__vmalloc_node_range",
          "args": [
            "shadow_size",
            "PAGE_SIZE",
            "shadow_start",
            "shadow_end",
            "GFP_KERNEL",
            "PAGE_KERNEL",
            "VM_NO_GUARD",
            "pfn_to_nid(mem_data->start_pfn)",
            "__builtin_return_address(0)"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "__vmalloc_node_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmalloc.c",
          "lines": "1732-1769",
          "snippet": "void *__vmalloc_node_range(unsigned long size, unsigned long align,\n\t\t\tunsigned long start, unsigned long end, gfp_t gfp_mask,\n\t\t\tpgprot_t prot, unsigned long vm_flags, int node,\n\t\t\tconst void *caller)\n{\n\tstruct vm_struct *area;\n\tvoid *addr;\n\tunsigned long real_size = size;\n\n\tsize = PAGE_ALIGN(size);\n\tif (!size || (size >> PAGE_SHIFT) > totalram_pages)\n\t\tgoto fail;\n\n\tarea = __get_vm_area_node(size, align, VM_ALLOC | VM_UNINITIALIZED |\n\t\t\t\tvm_flags, start, end, node, gfp_mask, caller);\n\tif (!area)\n\t\tgoto fail;\n\n\taddr = __vmalloc_area_node(area, gfp_mask, prot, node);\n\tif (!addr)\n\t\treturn NULL;\n\n\t/*\n\t * In this function, newly allocated vm_struct has VM_UNINITIALIZED\n\t * flag. It means that vm_struct is not fully initialized.\n\t * Now, it is fully initialized, so remove this flag here.\n\t */\n\tclear_vm_uninitialized_flag(area);\n\n\tkmemleak_vmalloc(area, size, gfp_mask);\n\n\treturn addr;\n\nfail:\n\twarn_alloc(gfp_mask, NULL,\n\t\t\t  \"vmalloc: allocation failure: %lu bytes\", real_size);\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/shmparam.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/bitops.h>",
            "#include <linux/llist.h>",
            "#include <linux/compiler.h>",
            "#include <linux/atomic.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/pfn.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void *__vmalloc_node(unsigned long size, unsigned long align,\n\t\t\t    gfp_t gfp_mask, pgprot_t prot,\n\t\t\t    int node, const void *caller);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/shmparam.h>\n#include <asm/tlbflush.h>\n#include <linux/uaccess.h>\n#include <linux/bitops.h>\n#include <linux/llist.h>\n#include <linux/compiler.h>\n#include <linux/atomic.h>\n#include <linux/kmemleak.h>\n#include <linux/pfn.h>\n#include <linux/rcupdate.h>\n#include <linux/radix-tree.h>\n#include <linux/rbtree.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kallsyms.h>\n#include <linux/debugobjects.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n\nstatic void *__vmalloc_node(unsigned long size, unsigned long align,\n\t\t\t    gfp_t gfp_mask, pgprot_t prot,\n\t\t\t    int node, const void *caller);\n\nvoid *__vmalloc_node_range(unsigned long size, unsigned long align,\n\t\t\tunsigned long start, unsigned long end, gfp_t gfp_mask,\n\t\t\tpgprot_t prot, unsigned long vm_flags, int node,\n\t\t\tconst void *caller)\n{\n\tstruct vm_struct *area;\n\tvoid *addr;\n\tunsigned long real_size = size;\n\n\tsize = PAGE_ALIGN(size);\n\tif (!size || (size >> PAGE_SHIFT) > totalram_pages)\n\t\tgoto fail;\n\n\tarea = __get_vm_area_node(size, align, VM_ALLOC | VM_UNINITIALIZED |\n\t\t\t\tvm_flags, start, end, node, gfp_mask, caller);\n\tif (!area)\n\t\tgoto fail;\n\n\taddr = __vmalloc_area_node(area, gfp_mask, prot, node);\n\tif (!addr)\n\t\treturn NULL;\n\n\t/*\n\t * In this function, newly allocated vm_struct has VM_UNINITIALIZED\n\t * flag. It means that vm_struct is not fully initialized.\n\t * Now, it is fully initialized, so remove this flag here.\n\t */\n\tclear_vm_uninitialized_flag(area);\n\n\tkmemleak_vmalloc(area, size, gfp_mask);\n\n\treturn addr;\n\nfail:\n\twarn_alloc(gfp_mask, NULL,\n\t\t\t  \"vmalloc: allocation failure: %lu bytes\", real_size);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__builtin_return_address",
          "args": [
            "0"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_nid",
          "args": [
            "mem_data->start_pfn"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "early_pfn_to_nid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1292-1304",
          "snippet": "int __meminit early_pfn_to_nid(unsigned long pfn)\n{\n\tstatic DEFINE_SPINLOCK(early_pfn_lock);\n\tint nid;\n\n\tspin_lock(&early_pfn_lock);\n\tnid = __early_pfn_to_nid(pfn, &early_pfnnid_cache);\n\tif (nid < 0)\n\t\tnid = first_online_node;\n\tspin_unlock(&early_pfn_lock);\n\n\treturn nid;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nint __meminit early_pfn_to_nid(unsigned long pfn)\n{\n\tstatic DEFINE_SPINLOCK(early_pfn_lock);\n\tint nid;\n\n\tspin_lock(&early_pfn_lock);\n\tnid = __early_pfn_to_nid(pfn, &early_pfnnid_cache);\n\tif (nid < 0)\n\t\tnid = first_online_node;\n\tspin_unlock(&early_pfn_lock);\n\n\treturn nid;\n}"
        }
      },
      {
        "call_info": {
          "callee": "shadow_mapped",
          "args": [
            "shadow_start"
          ],
          "line": 856
        },
        "resolved": true,
        "details": {
          "function_name": "shadow_mapped",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "796-828",
          "snippet": "static bool shadow_mapped(unsigned long addr)\n{\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tp4d_t *p4d;\n\tpud_t *pud;\n\tpmd_t *pmd;\n\tpte_t *pte;\n\n\tif (pgd_none(*pgd))\n\t\treturn false;\n\tp4d = p4d_offset(pgd, addr);\n\tif (p4d_none(*p4d))\n\t\treturn false;\n\tpud = pud_offset(p4d, addr);\n\tif (pud_none(*pud))\n\t\treturn false;\n\n\t/*\n\t * We can't use pud_large() or pud_huge(), the first one is\n\t * arch-specific, the last one depends on HUGETLB_PAGE.  So let's abuse\n\t * pud_bad(), if pud is bad then it's bad because it's huge.\n\t */\n\tif (pud_bad(*pud))\n\t\treturn true;\n\tpmd = pmd_offset(pud, addr);\n\tif (pmd_none(*pmd))\n\t\treturn false;\n\n\tif (pmd_bad(*pmd))\n\t\treturn true;\n\tpte = pte_offset_kernel(pmd, addr);\n\treturn !pte_none(*pte);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic bool shadow_mapped(unsigned long addr)\n{\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tp4d_t *p4d;\n\tpud_t *pud;\n\tpmd_t *pmd;\n\tpte_t *pte;\n\n\tif (pgd_none(*pgd))\n\t\treturn false;\n\tp4d = p4d_offset(pgd, addr);\n\tif (p4d_none(*p4d))\n\t\treturn false;\n\tpud = pud_offset(p4d, addr);\n\tif (pud_none(*pud))\n\t\treturn false;\n\n\t/*\n\t * We can't use pud_large() or pud_huge(), the first one is\n\t * arch-specific, the last one depends on HUGETLB_PAGE.  So let's abuse\n\t * pud_bad(), if pud is bad then it's bad because it's huge.\n\t */\n\tif (pud_bad(*pud))\n\t\treturn true;\n\tpmd = pmd_offset(pud, addr);\n\tif (pmd_none(*pmd))\n\t\treturn false;\n\n\tif (pmd_bad(*pmd))\n\t\treturn true;\n\tpte = pte_offset_kernel(pmd, addr);\n\treturn !pte_none(*pte);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "start_kaddr % (KASAN_SHADOW_SCALE_SIZE << PAGE_SHIFT)"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "mem_data->nr_pages % KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "(void *)start_kaddr"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pfn_to_kaddr",
          "args": [
            "mem_data->start_pfn"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic int __meminit kasan_mem_notifier(struct notifier_block *nb,\n\t\t\tunsigned long action, void *data)\n{\n\tstruct memory_notify *mem_data = data;\n\tunsigned long nr_shadow_pages, start_kaddr, shadow_start;\n\tunsigned long shadow_end, shadow_size;\n\n\tnr_shadow_pages = mem_data->nr_pages >> KASAN_SHADOW_SCALE_SHIFT;\n\tstart_kaddr = (unsigned long)pfn_to_kaddr(mem_data->start_pfn);\n\tshadow_start = (unsigned long)kasan_mem_to_shadow((void *)start_kaddr);\n\tshadow_size = nr_shadow_pages << PAGE_SHIFT;\n\tshadow_end = shadow_start + shadow_size;\n\n\tif (WARN_ON(mem_data->nr_pages % KASAN_SHADOW_SCALE_SIZE) ||\n\t\tWARN_ON(start_kaddr % (KASAN_SHADOW_SCALE_SIZE << PAGE_SHIFT)))\n\t\treturn NOTIFY_BAD;\n\n\tswitch (action) {\n\tcase MEM_GOING_ONLINE: {\n\t\tvoid *ret;\n\n\t\t/*\n\t\t * If shadow is mapped already than it must have been mapped\n\t\t * during the boot. This could happen if we onlining previously\n\t\t * offlined memory.\n\t\t */\n\t\tif (shadow_mapped(shadow_start))\n\t\t\treturn NOTIFY_OK;\n\n\t\tret = __vmalloc_node_range(shadow_size, PAGE_SIZE, shadow_start,\n\t\t\t\t\tshadow_end, GFP_KERNEL,\n\t\t\t\t\tPAGE_KERNEL, VM_NO_GUARD,\n\t\t\t\t\tpfn_to_nid(mem_data->start_pfn),\n\t\t\t\t\t__builtin_return_address(0));\n\t\tif (!ret)\n\t\t\treturn NOTIFY_BAD;\n\n\t\tkmemleak_ignore(ret);\n\t\treturn NOTIFY_OK;\n\t}\n\tcase MEM_CANCEL_ONLINE:\n\tcase MEM_OFFLINE: {\n\t\tstruct vm_struct *vm;\n\n\t\t/*\n\t\t * shadow_start was either mapped during boot by kasan_init()\n\t\t * or during memory online by __vmalloc_node_range().\n\t\t * In the latter case we can use vfree() to free shadow.\n\t\t * Non-NULL result of the find_vm_area() will tell us if\n\t\t * that was the second case.\n\t\t *\n\t\t * Currently it's not possible to free shadow mapped\n\t\t * during boot by kasan_init(). It's because the code\n\t\t * to do that hasn't been written yet. So we'll just\n\t\t * leak the memory.\n\t\t */\n\t\tvm = find_vm_area((void *)shadow_start);\n\t\tif (vm)\n\t\t\tvfree((void *)shadow_start);\n\t}\n\t}\n\n\treturn NOTIFY_OK;\n}"
  },
  {
    "function_name": "shadow_mapped",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "796-828",
    "snippet": "static bool shadow_mapped(unsigned long addr)\n{\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tp4d_t *p4d;\n\tpud_t *pud;\n\tpmd_t *pmd;\n\tpte_t *pte;\n\n\tif (pgd_none(*pgd))\n\t\treturn false;\n\tp4d = p4d_offset(pgd, addr);\n\tif (p4d_none(*p4d))\n\t\treturn false;\n\tpud = pud_offset(p4d, addr);\n\tif (pud_none(*pud))\n\t\treturn false;\n\n\t/*\n\t * We can't use pud_large() or pud_huge(), the first one is\n\t * arch-specific, the last one depends on HUGETLB_PAGE.  So let's abuse\n\t * pud_bad(), if pud is bad then it's bad because it's huge.\n\t */\n\tif (pud_bad(*pud))\n\t\treturn true;\n\tpmd = pmd_offset(pud, addr);\n\tif (pmd_none(*pmd))\n\t\treturn false;\n\n\tif (pmd_bad(*pmd))\n\t\treturn true;\n\tpte = pte_offset_kernel(pmd, addr);\n\treturn !pte_none(*pte);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pte_none",
          "args": [
            "*pte"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pte_offset_kernel",
          "args": [
            "pmd",
            "addr"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_bad",
          "args": [
            "*pmd"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_none",
          "args": [
            "*pmd"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pmd_offset",
          "args": [
            "pud",
            "addr"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_bad",
          "args": [
            "*pud"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_none",
          "args": [
            "*pud"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pud_offset",
          "args": [
            "p4d",
            "addr"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_none",
          "args": [
            "*p4d"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p4d_offset",
          "args": [
            "pgd",
            "addr"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_none",
          "args": [
            "*pgd"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pgd_offset_k",
          "args": [
            "addr"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic bool shadow_mapped(unsigned long addr)\n{\n\tpgd_t *pgd = pgd_offset_k(addr);\n\tp4d_t *p4d;\n\tpud_t *pud;\n\tpmd_t *pmd;\n\tpte_t *pte;\n\n\tif (pgd_none(*pgd))\n\t\treturn false;\n\tp4d = p4d_offset(pgd, addr);\n\tif (p4d_none(*p4d))\n\t\treturn false;\n\tpud = pud_offset(p4d, addr);\n\tif (pud_none(*pud))\n\t\treturn false;\n\n\t/*\n\t * We can't use pud_large() or pud_huge(), the first one is\n\t * arch-specific, the last one depends on HUGETLB_PAGE.  So let's abuse\n\t * pud_bad(), if pud is bad then it's bad because it's huge.\n\t */\n\tif (pud_bad(*pud))\n\t\treturn true;\n\tpmd = pmd_offset(pud, addr);\n\tif (pmd_none(*pmd))\n\t\treturn false;\n\n\tif (pmd_bad(*pmd))\n\t\treturn true;\n\tpte = pte_offset_kernel(pmd, addr);\n\treturn !pte_none(*pte);\n}"
  },
  {
    "function_name": "__asan_allocas_unpoison",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "771-777",
    "snippet": "void __asan_allocas_unpoison(const void *stack_top, const void *stack_bottom)\n{\n\tif (unlikely(!stack_top || stack_top > stack_bottom))\n\t\treturn;\n\n\tkasan_unpoison_shadow(stack_top, stack_bottom - stack_top);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "stack_top",
            "stack_bottom - stack_top"
          ],
          "line": 776
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!stack_top || stack_top > stack_bottom"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid __asan_allocas_unpoison(const void *stack_top, const void *stack_bottom)\n{\n\tif (unlikely(!stack_top || stack_top > stack_bottom))\n\t\treturn;\n\n\tkasan_unpoison_shadow(stack_top, stack_bottom - stack_top);\n}"
  },
  {
    "function_name": "__asan_alloca_poison",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "747-767",
    "snippet": "void __asan_alloca_poison(unsigned long addr, size_t size)\n{\n\tsize_t rounded_up_size = round_up(size, KASAN_SHADOW_SCALE_SIZE);\n\tsize_t padding_size = round_up(size, KASAN_ALLOCA_REDZONE_SIZE) -\n\t\t\trounded_up_size;\n\tsize_t rounded_down_size = round_down(size, KASAN_SHADOW_SCALE_SIZE);\n\n\tconst void *left_redzone = (const void *)(addr -\n\t\t\tKASAN_ALLOCA_REDZONE_SIZE);\n\tconst void *right_redzone = (const void *)(addr + rounded_up_size);\n\n\tWARN_ON(!IS_ALIGNED(addr, KASAN_ALLOCA_REDZONE_SIZE));\n\n\tkasan_unpoison_shadow((const void *)(addr + rounded_down_size),\n\t\t\t      size - rounded_down_size);\n\tkasan_poison_shadow(left_redzone, KASAN_ALLOCA_REDZONE_SIZE,\n\t\t\tKASAN_ALLOCA_LEFT);\n\tkasan_poison_shadow(right_redzone,\n\t\t\tpadding_size + KASAN_ALLOCA_REDZONE_SIZE,\n\t\t\tKASAN_ALLOCA_RIGHT);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "right_redzone",
            "padding_size + KASAN_ALLOCA_REDZONE_SIZE",
            "KASAN_ALLOCA_RIGHT"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "(const void *)(addr + rounded_down_size)",
            "size - rounded_down_size"
          ],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!IS_ALIGNED(addr, KASAN_ALLOCA_REDZONE_SIZE)"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "KASAN_ALLOCA_REDZONE_SIZE"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_down",
          "args": [
            "size",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "size",
            "KASAN_ALLOCA_REDZONE_SIZE"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "size",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid __asan_alloca_poison(unsigned long addr, size_t size)\n{\n\tsize_t rounded_up_size = round_up(size, KASAN_SHADOW_SCALE_SIZE);\n\tsize_t padding_size = round_up(size, KASAN_ALLOCA_REDZONE_SIZE) -\n\t\t\trounded_up_size;\n\tsize_t rounded_down_size = round_down(size, KASAN_SHADOW_SCALE_SIZE);\n\n\tconst void *left_redzone = (const void *)(addr -\n\t\t\tKASAN_ALLOCA_REDZONE_SIZE);\n\tconst void *right_redzone = (const void *)(addr + rounded_up_size);\n\n\tWARN_ON(!IS_ALIGNED(addr, KASAN_ALLOCA_REDZONE_SIZE));\n\n\tkasan_unpoison_shadow((const void *)(addr + rounded_down_size),\n\t\t\t      size - rounded_down_size);\n\tkasan_poison_shadow(left_redzone, KASAN_ALLOCA_REDZONE_SIZE,\n\t\t\tKASAN_ALLOCA_LEFT);\n\tkasan_poison_shadow(right_redzone,\n\t\t\tpadding_size + KASAN_ALLOCA_REDZONE_SIZE,\n\t\t\tKASAN_ALLOCA_RIGHT);\n}"
  },
  {
    "function_name": "__asan_unpoison_stack_memory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "740-743",
    "snippet": "void __asan_unpoison_stack_memory(const void *addr, size_t size)\n{\n\tkasan_unpoison_shadow(addr, size);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "addr",
            "size"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid __asan_unpoison_stack_memory(const void *addr, size_t size)\n{\n\tkasan_unpoison_shadow(addr, size);\n}"
  },
  {
    "function_name": "__asan_poison_stack_memory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "728-736",
    "snippet": "void __asan_poison_stack_memory(const void *addr, size_t size)\n{\n\t/*\n\t * Addr is KASAN_SHADOW_SCALE_SIZE-aligned and the object is surrounded\n\t * by redzones, so we simply round up size to simplify logic.\n\t */\n\tkasan_poison_shadow(addr, round_up(size, KASAN_SHADOW_SCALE_SIZE),\n\t\t\t    KASAN_USE_AFTER_SCOPE);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "addr",
            "round_up(size, KASAN_SHADOW_SCALE_SIZE)",
            "KASAN_USE_AFTER_SCOPE"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "size",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid __asan_poison_stack_memory(const void *addr, size_t size)\n{\n\t/*\n\t * Addr is KASAN_SHADOW_SCALE_SIZE-aligned and the object is surrounded\n\t * by redzones, so we simply round up size to simplify logic.\n\t */\n\tkasan_poison_shadow(addr, round_up(size, KASAN_SHADOW_SCALE_SIZE),\n\t\t\t    KASAN_USE_AFTER_SCOPE);\n}"
  },
  {
    "function_name": "__asan_handle_no_return",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "724-724",
    "snippet": "void __asan_handle_no_return(void) {}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid __asan_handle_no_return(void) {}"
  },
  {
    "function_name": "__asan_storeN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "713-716",
    "snippet": "void __asan_storeN(unsigned long addr, size_t size)\n{\n\tcheck_memory_region(addr, size, true, _RET_IP_);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_memory_region",
          "args": [
            "addr",
            "size",
            "true",
            "_RET_IP_"
          ],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "check_memory_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "263-268",
          "snippet": "static void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid __asan_storeN(unsigned long addr, size_t size)\n{\n\tcheck_memory_region(addr, size, true, _RET_IP_);\n}"
  },
  {
    "function_name": "__asan_loadN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "703-706",
    "snippet": "void __asan_loadN(unsigned long addr, size_t size)\n{\n\tcheck_memory_region(addr, size, false, _RET_IP_);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_memory_region",
          "args": [
            "addr",
            "size",
            "false",
            "_RET_IP_"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "check_memory_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "263-268",
          "snippet": "static void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid __asan_loadN(unsigned long addr, size_t size)\n{\n\tcheck_memory_region(addr, size, false, _RET_IP_);\n}"
  },
  {
    "function_name": "__asan_unregister_globals",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "674-676",
    "snippet": "void __asan_unregister_globals(struct kasan_global *globals, size_t size)\n{\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid __asan_unregister_globals(struct kasan_global *globals, size_t size)\n{\n}"
  },
  {
    "function_name": "__asan_register_globals",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "665-671",
    "snippet": "void __asan_register_globals(struct kasan_global *globals, size_t size)\n{\n\tint i;\n\n\tfor (i = 0; i < size; i++)\n\t\tregister_global(&globals[i]);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_global",
          "args": [
            "&globals[i]"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "register_global",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "654-663",
          "snippet": "static void register_global(struct kasan_global *global)\n{\n\tsize_t aligned_size = round_up(global->size, KASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(global->beg, global->size);\n\n\tkasan_poison_shadow(global->beg + aligned_size,\n\t\tglobal->size_with_redzone - aligned_size,\n\t\tKASAN_GLOBAL_REDZONE);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void register_global(struct kasan_global *global)\n{\n\tsize_t aligned_size = round_up(global->size, KASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(global->beg, global->size);\n\n\tkasan_poison_shadow(global->beg + aligned_size,\n\t\tglobal->size_with_redzone - aligned_size,\n\t\tKASAN_GLOBAL_REDZONE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid __asan_register_globals(struct kasan_global *globals, size_t size)\n{\n\tint i;\n\n\tfor (i = 0; i < size; i++)\n\t\tregister_global(&globals[i]);\n}"
  },
  {
    "function_name": "register_global",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "654-663",
    "snippet": "static void register_global(struct kasan_global *global)\n{\n\tsize_t aligned_size = round_up(global->size, KASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(global->beg, global->size);\n\n\tkasan_poison_shadow(global->beg + aligned_size,\n\t\tglobal->size_with_redzone - aligned_size,\n\t\tKASAN_GLOBAL_REDZONE);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "global->beg + aligned_size",
            "global->size_with_redzone - aligned_size",
            "KASAN_GLOBAL_REDZONE"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "global->beg",
            "global->size"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "global->size",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void register_global(struct kasan_global *global)\n{\n\tsize_t aligned_size = round_up(global->size, KASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(global->beg, global->size);\n\n\tkasan_poison_shadow(global->beg + aligned_size,\n\t\tglobal->size_with_redzone - aligned_size,\n\t\tKASAN_GLOBAL_REDZONE);\n}"
  },
  {
    "function_name": "kasan_free_shadow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "648-652",
    "snippet": "void kasan_free_shadow(const struct vm_struct *vm)\n{\n\tif (vm->flags & VM_KASAN)\n\t\tvfree(kasan_mem_to_shadow(vm->addr));\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vfree",
          "args": [
            "kasan_mem_to_shadow(vm->addr)"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "vfree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/nommu.c",
          "lines": "224-227",
          "snippet": "void vfree(const void *addr)\n{\n\tkfree(addr);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/mmu_context.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/tlb.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/printk.h>",
            "#include <linux/audit.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/personality.h>",
            "#include <linux/mount.h>",
            "#include <linux/compiler.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/slab.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/highmem.h>",
            "#include <linux/file.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/mmu_context.h>\n#include <asm/tlbflush.h>\n#include <asm/tlb.h>\n#include <linux/uaccess.h>\n#include <linux/printk.h>\n#include <linux/audit.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/personality.h>\n#include <linux/mount.h>\n#include <linux/compiler.h>\n#include <linux/backing-dev.h>\n#include <linux/blkdev.h>\n#include <linux/vmalloc.h>\n#include <linux/slab.h>\n#include <linux/pagemap.h>\n#include <linux/highmem.h>\n#include <linux/file.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n#include <linux/vmacache.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n#include <linux/export.h>\n\nvoid vfree(const void *addr)\n{\n\tkfree(addr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "vm->addr"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_free_shadow(const struct vm_struct *vm)\n{\n\tif (vm->flags & VM_KASAN)\n\t\tvfree(kasan_mem_to_shadow(vm->addr));\n}"
  },
  {
    "function_name": "kasan_module_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "619-646",
    "snippet": "int kasan_module_alloc(void *addr, size_t size)\n{\n\tvoid *ret;\n\tsize_t scaled_size;\n\tsize_t shadow_size;\n\tunsigned long shadow_start;\n\n\tshadow_start = (unsigned long)kasan_mem_to_shadow(addr);\n\tscaled_size = (size + KASAN_SHADOW_MASK) >> KASAN_SHADOW_SCALE_SHIFT;\n\tshadow_size = round_up(scaled_size, PAGE_SIZE);\n\n\tif (WARN_ON(!PAGE_ALIGNED(shadow_start)))\n\t\treturn -EINVAL;\n\n\tret = __vmalloc_node_range(shadow_size, 1, shadow_start,\n\t\t\tshadow_start + shadow_size,\n\t\t\tGFP_KERNEL | __GFP_ZERO,\n\t\t\tPAGE_KERNEL, VM_NO_GUARD, NUMA_NO_NODE,\n\t\t\t__builtin_return_address(0));\n\n\tif (ret) {\n\t\tfind_vm_area(addr)->flags |= VM_KASAN;\n\t\tkmemleak_ignore(ret);\n\t\treturn 0;\n\t}\n\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmemleak_ignore",
          "args": [
            "ret"
          ],
          "line": 641
        },
        "resolved": true,
        "details": {
          "function_name": "kmemleak_ignore_phys",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kmemleak.c",
          "lines": "1259-1263",
          "snippet": "void __ref kmemleak_ignore_phys(phys_addr_t phys)\n{\n\tif (!IS_ENABLED(CONFIG_HIGHMEM) || PHYS_PFN(phys) < max_low_pfn)\n\t\tkmemleak_ignore(__va(phys));\n}",
          "includes": [
            "#include <linux/memory_hotplug.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kasan.h>",
            "#include <linux/atomic.h>",
            "#include <asm/processor.h>",
            "#include <asm/sections.h>",
            "#include <linux/crc32.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/mm.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/string.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/err.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/slab.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/pfn.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/cache.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/kthread.h>",
            "#include <linux/export.h>",
            "#include <linux/delay.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memory_hotplug.h>\n#include <linux/kmemleak.h>\n#include <linux/kasan.h>\n#include <linux/atomic.h>\n#include <asm/processor.h>\n#include <asm/sections.h>\n#include <linux/crc32.h>\n#include <linux/workqueue.h>\n#include <linux/mm.h>\n#include <linux/nodemask.h>\n#include <linux/string.h>\n#include <linux/uaccess.h>\n#include <linux/err.h>\n#include <linux/thread_info.h>\n#include <linux/slab.h>\n#include <linux/mmzone.h>\n#include <linux/pfn.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/cache.h>\n#include <linux/stacktrace.h>\n#include <linux/rcupdate.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/kthread.h>\n#include <linux/export.h>\n#include <linux/delay.h>\n#include <linux/jiffies.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nvoid __ref kmemleak_ignore_phys(phys_addr_t phys)\n{\n\tif (!IS_ENABLED(CONFIG_HIGHMEM) || PHYS_PFN(phys) < max_low_pfn)\n\t\tkmemleak_ignore(__va(phys));\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_vm_area",
          "args": [
            "addr"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "find_vm_area",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmalloc.c",
          "lines": "1454-1463",
          "snippet": "struct vm_struct *find_vm_area(const void *addr)\n{\n\tstruct vmap_area *va;\n\n\tva = find_vmap_area((unsigned long)addr);\n\tif (va && va->flags & VM_VM_AREA)\n\t\treturn va->vm;\n\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/shmparam.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/bitops.h>",
            "#include <linux/llist.h>",
            "#include <linux/compiler.h>",
            "#include <linux/atomic.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/pfn.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>"
          ],
          "macros_used": [
            "#define VM_VM_AREA\t0x04"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/shmparam.h>\n#include <asm/tlbflush.h>\n#include <linux/uaccess.h>\n#include <linux/bitops.h>\n#include <linux/llist.h>\n#include <linux/compiler.h>\n#include <linux/atomic.h>\n#include <linux/kmemleak.h>\n#include <linux/pfn.h>\n#include <linux/rcupdate.h>\n#include <linux/radix-tree.h>\n#include <linux/rbtree.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kallsyms.h>\n#include <linux/debugobjects.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n\n#define VM_VM_AREA\t0x04\n\nstruct vm_struct *find_vm_area(const void *addr)\n{\n\tstruct vmap_area *va;\n\n\tva = find_vmap_area((unsigned long)addr);\n\tif (va && va->flags & VM_VM_AREA)\n\t\treturn va->vm;\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__vmalloc_node_range",
          "args": [
            "shadow_size",
            "1",
            "shadow_start",
            "shadow_start + shadow_size",
            "GFP_KERNEL | __GFP_ZERO",
            "PAGE_KERNEL",
            "VM_NO_GUARD",
            "NUMA_NO_NODE",
            "__builtin_return_address(0)"
          ],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "__vmalloc_node_range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/vmalloc.c",
          "lines": "1732-1769",
          "snippet": "void *__vmalloc_node_range(unsigned long size, unsigned long align,\n\t\t\tunsigned long start, unsigned long end, gfp_t gfp_mask,\n\t\t\tpgprot_t prot, unsigned long vm_flags, int node,\n\t\t\tconst void *caller)\n{\n\tstruct vm_struct *area;\n\tvoid *addr;\n\tunsigned long real_size = size;\n\n\tsize = PAGE_ALIGN(size);\n\tif (!size || (size >> PAGE_SHIFT) > totalram_pages)\n\t\tgoto fail;\n\n\tarea = __get_vm_area_node(size, align, VM_ALLOC | VM_UNINITIALIZED |\n\t\t\t\tvm_flags, start, end, node, gfp_mask, caller);\n\tif (!area)\n\t\tgoto fail;\n\n\taddr = __vmalloc_area_node(area, gfp_mask, prot, node);\n\tif (!addr)\n\t\treturn NULL;\n\n\t/*\n\t * In this function, newly allocated vm_struct has VM_UNINITIALIZED\n\t * flag. It means that vm_struct is not fully initialized.\n\t * Now, it is fully initialized, so remove this flag here.\n\t */\n\tclear_vm_uninitialized_flag(area);\n\n\tkmemleak_vmalloc(area, size, gfp_mask);\n\n\treturn addr;\n\nfail:\n\twarn_alloc(gfp_mask, NULL,\n\t\t\t  \"vmalloc: allocation failure: %lu bytes\", real_size);\n\treturn NULL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/shmparam.h>",
            "#include <asm/tlbflush.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/bitops.h>",
            "#include <linux/llist.h>",
            "#include <linux/compiler.h>",
            "#include <linux/atomic.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/pfn.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/radix-tree.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/notifier.h>",
            "#include <linux/list.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/highmem.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void *__vmalloc_node(unsigned long size, unsigned long align,\n\t\t\t    gfp_t gfp_mask, pgprot_t prot,\n\t\t\t    int node, const void *caller);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/shmparam.h>\n#include <asm/tlbflush.h>\n#include <linux/uaccess.h>\n#include <linux/bitops.h>\n#include <linux/llist.h>\n#include <linux/compiler.h>\n#include <linux/atomic.h>\n#include <linux/kmemleak.h>\n#include <linux/pfn.h>\n#include <linux/rcupdate.h>\n#include <linux/radix-tree.h>\n#include <linux/rbtree.h>\n#include <linux/notifier.h>\n#include <linux/list.h>\n#include <linux/kallsyms.h>\n#include <linux/debugobjects.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched/signal.h>\n#include <linux/highmem.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n\nstatic void *__vmalloc_node(unsigned long size, unsigned long align,\n\t\t\t    gfp_t gfp_mask, pgprot_t prot,\n\t\t\t    int node, const void *caller);\n\nvoid *__vmalloc_node_range(unsigned long size, unsigned long align,\n\t\t\tunsigned long start, unsigned long end, gfp_t gfp_mask,\n\t\t\tpgprot_t prot, unsigned long vm_flags, int node,\n\t\t\tconst void *caller)\n{\n\tstruct vm_struct *area;\n\tvoid *addr;\n\tunsigned long real_size = size;\n\n\tsize = PAGE_ALIGN(size);\n\tif (!size || (size >> PAGE_SHIFT) > totalram_pages)\n\t\tgoto fail;\n\n\tarea = __get_vm_area_node(size, align, VM_ALLOC | VM_UNINITIALIZED |\n\t\t\t\tvm_flags, start, end, node, gfp_mask, caller);\n\tif (!area)\n\t\tgoto fail;\n\n\taddr = __vmalloc_area_node(area, gfp_mask, prot, node);\n\tif (!addr)\n\t\treturn NULL;\n\n\t/*\n\t * In this function, newly allocated vm_struct has VM_UNINITIALIZED\n\t * flag. It means that vm_struct is not fully initialized.\n\t * Now, it is fully initialized, so remove this flag here.\n\t */\n\tclear_vm_uninitialized_flag(area);\n\n\tkmemleak_vmalloc(area, size, gfp_mask);\n\n\treturn addr;\n\nfail:\n\twarn_alloc(gfp_mask, NULL,\n\t\t\t  \"vmalloc: allocation failure: %lu bytes\", real_size);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__builtin_return_address",
          "args": [
            "0"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!PAGE_ALIGNED(shadow_start)"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PAGE_ALIGNED",
          "args": [
            "shadow_start"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "scaled_size",
            "PAGE_SIZE"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "addr"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nint kasan_module_alloc(void *addr, size_t size)\n{\n\tvoid *ret;\n\tsize_t scaled_size;\n\tsize_t shadow_size;\n\tunsigned long shadow_start;\n\n\tshadow_start = (unsigned long)kasan_mem_to_shadow(addr);\n\tscaled_size = (size + KASAN_SHADOW_MASK) >> KASAN_SHADOW_SCALE_SHIFT;\n\tshadow_size = round_up(scaled_size, PAGE_SIZE);\n\n\tif (WARN_ON(!PAGE_ALIGNED(shadow_start)))\n\t\treturn -EINVAL;\n\n\tret = __vmalloc_node_range(shadow_size, 1, shadow_start,\n\t\t\tshadow_start + shadow_size,\n\t\t\tGFP_KERNEL | __GFP_ZERO,\n\t\t\tPAGE_KERNEL, VM_NO_GUARD, NUMA_NO_NODE,\n\t\t\t__builtin_return_address(0));\n\n\tif (ret) {\n\t\tfind_vm_area(addr)->flags |= VM_KASAN;\n\t\tkmemleak_ignore(ret);\n\t\treturn 0;\n\t}\n\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "kasan_kfree_large",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "612-617",
    "snippet": "void kasan_kfree_large(void *ptr, unsigned long ip)\n{\n\tif (ptr != page_address(virt_to_head_page(ptr)))\n\t\tkasan_report_invalid_free(ptr, ip);\n\t/* The object will be poisoned by page_alloc. */\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_report_invalid_free",
          "args": [
            "ptr",
            "ip"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_report_invalid_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "329-340",
          "snippet": "void kasan_report_invalid_free(void *object, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\tpr_err(\"BUG: KASAN: double-free or invalid-free in %pS\\n\", (void *)ip);\n\tpr_err(\"\\n\");\n\tprint_address_description(object);\n\tpr_err(\"\\n\");\n\tprint_shadow_for_address(object);\n\tkasan_end_report(&flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid kasan_report_invalid_free(void *object, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\tpr_err(\"BUG: KASAN: double-free or invalid-free in %pS\\n\", (void *)ip);\n\tpr_err(\"\\n\");\n\tprint_address_description(object);\n\tpr_err(\"\\n\");\n\tprint_shadow_for_address(object);\n\tkasan_end_report(&flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "virt_to_head_page(ptr)"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "page_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/highmem.c",
          "lines": "409-434",
          "snippet": "void *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/tlbflush.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/mempool.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/tlbflush.h>\n#include <linux/kgdb.h>\n#include <linux/highmem.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/mempool.h>\n#include <linux/pagemap.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virt_to_head_page",
          "args": [
            "ptr"
          ],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_kfree_large(void *ptr, unsigned long ip)\n{\n\tif (ptr != page_address(virt_to_head_page(ptr)))\n\t\tkasan_report_invalid_free(ptr, ip);\n\t/* The object will be poisoned by page_alloc. */\n}"
  },
  {
    "function_name": "kasan_poison_kfree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "594-610",
    "snippet": "void kasan_poison_kfree(void *ptr, unsigned long ip)\n{\n\tstruct page *page;\n\n\tpage = virt_to_head_page(ptr);\n\n\tif (unlikely(!PageSlab(page))) {\n\t\tif (ptr != page_address(page)) {\n\t\t\tkasan_report_invalid_free(ptr, ip);\n\t\t\treturn;\n\t\t}\n\t\tkasan_poison_shadow(ptr, PAGE_SIZE << compound_order(page),\n\t\t\t\tKASAN_FREE_PAGE);\n\t} else {\n\t\t__kasan_slab_free(page->slab_cache, ptr, ip, false);\n\t}\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__kasan_slab_free",
          "args": [
            "page->slab_cache",
            "ptr",
            "ip",
            "false"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "__kasan_slab_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "493-524",
          "snippet": "static bool __kasan_slab_free(struct kmem_cache *cache, void *object,\n\t\t\t      unsigned long ip, bool quarantine)\n{\n\ts8 shadow_byte;\n\tunsigned long rounded_up_size;\n\n\tif (unlikely(nearest_obj(cache, virt_to_head_page(object), object) !=\n\t    object)) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\t/* RCU slabs could be legally used after free within the RCU period */\n\tif (unlikely(cache->flags & SLAB_TYPESAFE_BY_RCU))\n\t\treturn false;\n\n\tshadow_byte = READ_ONCE(*(s8 *)kasan_mem_to_shadow(object));\n\tif (shadow_byte < 0 || shadow_byte >= KASAN_SHADOW_SCALE_SIZE) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\trounded_up_size = round_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE);\n\tkasan_poison_shadow(object, rounded_up_size, KASAN_KMALLOC_FREE);\n\n\tif (!quarantine || unlikely(!(cache->flags & SLAB_KASAN)))\n\t\treturn false;\n\n\tset_track(&get_alloc_info(cache, object)->free_track, GFP_NOWAIT);\n\tquarantine_put(get_free_info(cache, object), cache);\n\treturn true;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic bool __kasan_slab_free(struct kmem_cache *cache, void *object,\n\t\t\t      unsigned long ip, bool quarantine)\n{\n\ts8 shadow_byte;\n\tunsigned long rounded_up_size;\n\n\tif (unlikely(nearest_obj(cache, virt_to_head_page(object), object) !=\n\t    object)) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\t/* RCU slabs could be legally used after free within the RCU period */\n\tif (unlikely(cache->flags & SLAB_TYPESAFE_BY_RCU))\n\t\treturn false;\n\n\tshadow_byte = READ_ONCE(*(s8 *)kasan_mem_to_shadow(object));\n\tif (shadow_byte < 0 || shadow_byte >= KASAN_SHADOW_SCALE_SIZE) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\trounded_up_size = round_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE);\n\tkasan_poison_shadow(object, rounded_up_size, KASAN_KMALLOC_FREE);\n\n\tif (!quarantine || unlikely(!(cache->flags & SLAB_KASAN)))\n\t\treturn false;\n\n\tset_track(&get_alloc_info(cache, object)->free_track, GFP_NOWAIT);\n\tquarantine_put(get_free_info(cache, object), cache);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "ptr",
            "PAGE_SIZE << compound_order(page)",
            "KASAN_FREE_PAGE"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "page"
          ],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_report_invalid_free",
          "args": [
            "ptr",
            "ip"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_report_invalid_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "329-340",
          "snippet": "void kasan_report_invalid_free(void *object, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\tpr_err(\"BUG: KASAN: double-free or invalid-free in %pS\\n\", (void *)ip);\n\tpr_err(\"\\n\");\n\tprint_address_description(object);\n\tpr_err(\"\\n\");\n\tprint_shadow_for_address(object);\n\tkasan_end_report(&flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid kasan_report_invalid_free(void *object, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\tpr_err(\"BUG: KASAN: double-free or invalid-free in %pS\\n\", (void *)ip);\n\tpr_err(\"\\n\");\n\tprint_address_description(object);\n\tpr_err(\"\\n\");\n\tprint_shadow_for_address(object);\n\tkasan_end_report(&flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "page_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/highmem.c",
          "lines": "409-434",
          "snippet": "void *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/tlbflush.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/mempool.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/tlbflush.h>\n#include <linux/kgdb.h>\n#include <linux/highmem.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/mempool.h>\n#include <linux/pagemap.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!PageSlab(page)"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageSlab",
          "args": [
            "page"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virt_to_head_page",
          "args": [
            "ptr"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_poison_kfree(void *ptr, unsigned long ip)\n{\n\tstruct page *page;\n\n\tpage = virt_to_head_page(ptr);\n\n\tif (unlikely(!PageSlab(page))) {\n\t\tif (ptr != page_address(page)) {\n\t\t\tkasan_report_invalid_free(ptr, ip);\n\t\t\treturn;\n\t\t}\n\t\tkasan_poison_shadow(ptr, PAGE_SIZE << compound_order(page),\n\t\t\t\tKASAN_FREE_PAGE);\n\t} else {\n\t\t__kasan_slab_free(page->slab_cache, ptr, ip, false);\n\t}\n}"
  },
  {
    "function_name": "kasan_krealloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "579-592",
    "snippet": "void kasan_krealloc(const void *object, size_t size, gfp_t flags)\n{\n\tstruct page *page;\n\n\tif (unlikely(object == ZERO_SIZE_PTR))\n\t\treturn;\n\n\tpage = virt_to_head_page(object);\n\n\tif (unlikely(!PageSlab(page)))\n\t\tkasan_kmalloc_large(object, size, flags);\n\telse\n\t\tkasan_kmalloc(page->slab_cache, object, size, flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_kmalloc",
          "args": [
            "page->slab_cache",
            "object",
            "size",
            "flags"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "531-554",
          "snippet": "void kasan_kmalloc(struct kmem_cache *cache, const void *object, size_t size,\n\t\t   gfp_t flags)\n{\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(object == NULL))\n\t\treturn;\n\n\tredzone_start = round_up((unsigned long)(object + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = round_up((unsigned long)object + cache->object_size,\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(object, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_KMALLOC_REDZONE);\n\n\tif (cache->flags & SLAB_KASAN)\n\t\tset_track(&get_alloc_info(cache, object)->alloc_track, flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_kmalloc(struct kmem_cache *cache, const void *object, size_t size,\n\t\t   gfp_t flags)\n{\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(object == NULL))\n\t\treturn;\n\n\tredzone_start = round_up((unsigned long)(object + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = round_up((unsigned long)object + cache->object_size,\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(object, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_KMALLOC_REDZONE);\n\n\tif (cache->flags & SLAB_KASAN)\n\t\tset_track(&get_alloc_info(cache, object)->alloc_track, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_kmalloc_large",
          "args": [
            "object",
            "size",
            "flags"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_kmalloc_large",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "557-577",
          "snippet": "void kasan_kmalloc_large(const void *ptr, size_t size, gfp_t flags)\n{\n\tstruct page *page;\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(ptr == NULL))\n\t\treturn;\n\n\tpage = virt_to_page(ptr);\n\tredzone_start = round_up((unsigned long)(ptr + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = (unsigned long)ptr + (PAGE_SIZE << compound_order(page));\n\n\tkasan_unpoison_shadow(ptr, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_PAGE_REDZONE);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_kmalloc_large(const void *ptr, size_t size, gfp_t flags)\n{\n\tstruct page *page;\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(ptr == NULL))\n\t\treturn;\n\n\tpage = virt_to_page(ptr);\n\tredzone_start = round_up((unsigned long)(ptr + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = (unsigned long)ptr + (PAGE_SIZE << compound_order(page));\n\n\tkasan_unpoison_shadow(ptr, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_PAGE_REDZONE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!PageSlab(page)"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageSlab",
          "args": [
            "page"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virt_to_head_page",
          "args": [
            "object"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "object == ZERO_SIZE_PTR"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_krealloc(const void *object, size_t size, gfp_t flags)\n{\n\tstruct page *page;\n\n\tif (unlikely(object == ZERO_SIZE_PTR))\n\t\treturn;\n\n\tpage = virt_to_head_page(object);\n\n\tif (unlikely(!PageSlab(page)))\n\t\tkasan_kmalloc_large(object, size, flags);\n\telse\n\t\tkasan_kmalloc(page->slab_cache, object, size, flags);\n}"
  },
  {
    "function_name": "kasan_kmalloc_large",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "557-577",
    "snippet": "void kasan_kmalloc_large(const void *ptr, size_t size, gfp_t flags)\n{\n\tstruct page *page;\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(ptr == NULL))\n\t\treturn;\n\n\tpage = virt_to_page(ptr);\n\tredzone_start = round_up((unsigned long)(ptr + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = (unsigned long)ptr + (PAGE_SIZE << compound_order(page));\n\n\tkasan_unpoison_shadow(ptr, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_PAGE_REDZONE);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "(void *)redzone_start",
            "redzone_end - redzone_start",
            "KASAN_PAGE_REDZONE"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "ptr",
            "size"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "page"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "(unsigned long)(ptr + size)",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virt_to_page",
          "args": [
            "ptr"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ptr == NULL"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quarantine_reduce",
          "args": [],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "quarantine_reduce",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.h",
          "lines": "119-119",
          "snippet": "static inline void quarantine_reduce(void) { }",
          "includes": [
            "#include <linux/stackdepot.h>",
            "#include <linux/kasan.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/stackdepot.h>\n#include <linux/kasan.h>\n\nstatic inline void quarantine_reduce(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "gfpflags_allow_blocking",
          "args": [
            "flags"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_kmalloc_large(const void *ptr, size_t size, gfp_t flags)\n{\n\tstruct page *page;\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(ptr == NULL))\n\t\treturn;\n\n\tpage = virt_to_page(ptr);\n\tredzone_start = round_up((unsigned long)(ptr + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = (unsigned long)ptr + (PAGE_SIZE << compound_order(page));\n\n\tkasan_unpoison_shadow(ptr, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_PAGE_REDZONE);\n}"
  },
  {
    "function_name": "kasan_kmalloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "531-554",
    "snippet": "void kasan_kmalloc(struct kmem_cache *cache, const void *object, size_t size,\n\t\t   gfp_t flags)\n{\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(object == NULL))\n\t\treturn;\n\n\tredzone_start = round_up((unsigned long)(object + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = round_up((unsigned long)object + cache->object_size,\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(object, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_KMALLOC_REDZONE);\n\n\tif (cache->flags & SLAB_KASAN)\n\t\tset_track(&get_alloc_info(cache, object)->alloc_track, flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_track",
          "args": [
            "&get_alloc_info(cache, object)->alloc_track",
            "flags"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "set_track",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "457-461",
          "snippet": "static inline void set_track(struct kasan_track *track, gfp_t flags)\n{\n\ttrack->pid = current->pid;\n\ttrack->stack = save_stack(flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline void set_track(struct kasan_track *track, gfp_t flags)\n{\n\ttrack->pid = current->pid;\n\ttrack->stack = save_stack(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_alloc_info",
          "args": [
            "cache",
            "object"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "get_alloc_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "463-468",
          "snippet": "struct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstruct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "(void *)redzone_start",
            "redzone_end - redzone_start",
            "KASAN_KMALLOC_REDZONE"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "object",
            "size"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "(unsigned long)object + cache->object_size",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "(unsigned long)(object + size)",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "object == NULL"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quarantine_reduce",
          "args": [],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "quarantine_reduce",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.h",
          "lines": "119-119",
          "snippet": "static inline void quarantine_reduce(void) { }",
          "includes": [
            "#include <linux/stackdepot.h>",
            "#include <linux/kasan.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/stackdepot.h>\n#include <linux/kasan.h>\n\nstatic inline void quarantine_reduce(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "gfpflags_allow_blocking",
          "args": [
            "flags"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_kmalloc(struct kmem_cache *cache, const void *object, size_t size,\n\t\t   gfp_t flags)\n{\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(object == NULL))\n\t\treturn;\n\n\tredzone_start = round_up((unsigned long)(object + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = round_up((unsigned long)object + cache->object_size,\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(object, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_KMALLOC_REDZONE);\n\n\tif (cache->flags & SLAB_KASAN)\n\t\tset_track(&get_alloc_info(cache, object)->alloc_track, flags);\n}"
  },
  {
    "function_name": "kasan_slab_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "526-529",
    "snippet": "bool kasan_slab_free(struct kmem_cache *cache, void *object, unsigned long ip)\n{\n\treturn __kasan_slab_free(cache, object, ip, true);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__kasan_slab_free",
          "args": [
            "cache",
            "object",
            "ip",
            "true"
          ],
          "line": 528
        },
        "resolved": true,
        "details": {
          "function_name": "__kasan_slab_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "493-524",
          "snippet": "static bool __kasan_slab_free(struct kmem_cache *cache, void *object,\n\t\t\t      unsigned long ip, bool quarantine)\n{\n\ts8 shadow_byte;\n\tunsigned long rounded_up_size;\n\n\tif (unlikely(nearest_obj(cache, virt_to_head_page(object), object) !=\n\t    object)) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\t/* RCU slabs could be legally used after free within the RCU period */\n\tif (unlikely(cache->flags & SLAB_TYPESAFE_BY_RCU))\n\t\treturn false;\n\n\tshadow_byte = READ_ONCE(*(s8 *)kasan_mem_to_shadow(object));\n\tif (shadow_byte < 0 || shadow_byte >= KASAN_SHADOW_SCALE_SIZE) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\trounded_up_size = round_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE);\n\tkasan_poison_shadow(object, rounded_up_size, KASAN_KMALLOC_FREE);\n\n\tif (!quarantine || unlikely(!(cache->flags & SLAB_KASAN)))\n\t\treturn false;\n\n\tset_track(&get_alloc_info(cache, object)->free_track, GFP_NOWAIT);\n\tquarantine_put(get_free_info(cache, object), cache);\n\treturn true;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic bool __kasan_slab_free(struct kmem_cache *cache, void *object,\n\t\t\t      unsigned long ip, bool quarantine)\n{\n\ts8 shadow_byte;\n\tunsigned long rounded_up_size;\n\n\tif (unlikely(nearest_obj(cache, virt_to_head_page(object), object) !=\n\t    object)) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\t/* RCU slabs could be legally used after free within the RCU period */\n\tif (unlikely(cache->flags & SLAB_TYPESAFE_BY_RCU))\n\t\treturn false;\n\n\tshadow_byte = READ_ONCE(*(s8 *)kasan_mem_to_shadow(object));\n\tif (shadow_byte < 0 || shadow_byte >= KASAN_SHADOW_SCALE_SIZE) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\trounded_up_size = round_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE);\n\tkasan_poison_shadow(object, rounded_up_size, KASAN_KMALLOC_FREE);\n\n\tif (!quarantine || unlikely(!(cache->flags & SLAB_KASAN)))\n\t\treturn false;\n\n\tset_track(&get_alloc_info(cache, object)->free_track, GFP_NOWAIT);\n\tquarantine_put(get_free_info(cache, object), cache);\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nbool kasan_slab_free(struct kmem_cache *cache, void *object, unsigned long ip)\n{\n\treturn __kasan_slab_free(cache, object, ip, true);\n}"
  },
  {
    "function_name": "__kasan_slab_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "493-524",
    "snippet": "static bool __kasan_slab_free(struct kmem_cache *cache, void *object,\n\t\t\t      unsigned long ip, bool quarantine)\n{\n\ts8 shadow_byte;\n\tunsigned long rounded_up_size;\n\n\tif (unlikely(nearest_obj(cache, virt_to_head_page(object), object) !=\n\t    object)) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\t/* RCU slabs could be legally used after free within the RCU period */\n\tif (unlikely(cache->flags & SLAB_TYPESAFE_BY_RCU))\n\t\treturn false;\n\n\tshadow_byte = READ_ONCE(*(s8 *)kasan_mem_to_shadow(object));\n\tif (shadow_byte < 0 || shadow_byte >= KASAN_SHADOW_SCALE_SIZE) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\trounded_up_size = round_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE);\n\tkasan_poison_shadow(object, rounded_up_size, KASAN_KMALLOC_FREE);\n\n\tif (!quarantine || unlikely(!(cache->flags & SLAB_KASAN)))\n\t\treturn false;\n\n\tset_track(&get_alloc_info(cache, object)->free_track, GFP_NOWAIT);\n\tquarantine_put(get_free_info(cache, object), cache);\n\treturn true;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quarantine_put",
          "args": [
            "get_free_info(cache, object)",
            "cache"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "quarantine_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.h",
          "lines": "117-118",
          "snippet": "static inline void quarantine_put(struct kasan_free_meta *info,\n\t\t\t\tstruct kmem_cache *cache) { }",
          "includes": [
            "#include <linux/stackdepot.h>",
            "#include <linux/kasan.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/stackdepot.h>\n#include <linux/kasan.h>\n\nstatic inline void quarantine_put(struct kasan_free_meta *info,\n\t\t\t\tstruct kmem_cache *cache) { }"
        }
      },
      {
        "call_info": {
          "callee": "get_free_info",
          "args": [
            "cache",
            "object"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "get_free_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "470-475",
          "snippet": "struct kasan_free_meta *get_free_info(struct kmem_cache *cache,\n\t\t\t\t      const void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_free_meta) > 32);\n\treturn (void *)object + cache->kasan_info.free_meta_offset;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstruct kasan_free_meta *get_free_info(struct kmem_cache *cache,\n\t\t\t\t      const void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_free_meta) > 32);\n\treturn (void *)object + cache->kasan_info.free_meta_offset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_track",
          "args": [
            "&get_alloc_info(cache, object)->free_track",
            "GFP_NOWAIT"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "set_track",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "457-461",
          "snippet": "static inline void set_track(struct kasan_track *track, gfp_t flags)\n{\n\ttrack->pid = current->pid;\n\ttrack->stack = save_stack(flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline void set_track(struct kasan_track *track, gfp_t flags)\n{\n\ttrack->pid = current->pid;\n\ttrack->stack = save_stack(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_alloc_info",
          "args": [
            "cache",
            "object"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "get_alloc_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "463-468",
          "snippet": "struct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstruct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!(cache->flags & SLAB_KASAN)"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "object",
            "rounded_up_size",
            "KASAN_KMALLOC_FREE"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "cache->object_size",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_report_invalid_free",
          "args": [
            "object",
            "ip"
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_report_invalid_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "329-340",
          "snippet": "void kasan_report_invalid_free(void *object, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\tpr_err(\"BUG: KASAN: double-free or invalid-free in %pS\\n\", (void *)ip);\n\tpr_err(\"\\n\");\n\tprint_address_description(object);\n\tpr_err(\"\\n\");\n\tprint_shadow_for_address(object);\n\tkasan_end_report(&flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid kasan_report_invalid_free(void *object, unsigned long ip)\n{\n\tunsigned long flags;\n\n\tkasan_start_report(&flags);\n\tpr_err(\"BUG: KASAN: double-free or invalid-free in %pS\\n\", (void *)ip);\n\tpr_err(\"\\n\");\n\tprint_address_description(object);\n\tpr_err(\"\\n\");\n\tprint_shadow_for_address(object);\n\tkasan_end_report(&flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "*(s8 *)kasan_mem_to_shadow(object)"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "object"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "cache->flags & SLAB_TYPESAFE_BY_RCU"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "nearest_obj(cache, virt_to_head_page(object), object) !=\n\t    object"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nearest_obj",
          "args": [
            "cache",
            "virt_to_head_page(object)",
            "object"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virt_to_head_page",
          "args": [
            "object"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic bool __kasan_slab_free(struct kmem_cache *cache, void *object,\n\t\t\t      unsigned long ip, bool quarantine)\n{\n\ts8 shadow_byte;\n\tunsigned long rounded_up_size;\n\n\tif (unlikely(nearest_obj(cache, virt_to_head_page(object), object) !=\n\t    object)) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\t/* RCU slabs could be legally used after free within the RCU period */\n\tif (unlikely(cache->flags & SLAB_TYPESAFE_BY_RCU))\n\t\treturn false;\n\n\tshadow_byte = READ_ONCE(*(s8 *)kasan_mem_to_shadow(object));\n\tif (shadow_byte < 0 || shadow_byte >= KASAN_SHADOW_SCALE_SIZE) {\n\t\tkasan_report_invalid_free(object, ip);\n\t\treturn true;\n\t}\n\n\trounded_up_size = round_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE);\n\tkasan_poison_shadow(object, rounded_up_size, KASAN_KMALLOC_FREE);\n\n\tif (!quarantine || unlikely(!(cache->flags & SLAB_KASAN)))\n\t\treturn false;\n\n\tset_track(&get_alloc_info(cache, object)->free_track, GFP_NOWAIT);\n\tquarantine_put(get_free_info(cache, object), cache);\n\treturn true;\n}"
  },
  {
    "function_name": "kasan_slab_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "488-491",
    "snippet": "void kasan_slab_alloc(struct kmem_cache *cache, void *object, gfp_t flags)\n{\n\tkasan_kmalloc(cache, object, cache->object_size, flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_kmalloc",
          "args": [
            "cache",
            "object",
            "cache->object_size",
            "flags"
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_kmalloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "531-554",
          "snippet": "void kasan_kmalloc(struct kmem_cache *cache, const void *object, size_t size,\n\t\t   gfp_t flags)\n{\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(object == NULL))\n\t\treturn;\n\n\tredzone_start = round_up((unsigned long)(object + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = round_up((unsigned long)object + cache->object_size,\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(object, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_KMALLOC_REDZONE);\n\n\tif (cache->flags & SLAB_KASAN)\n\t\tset_track(&get_alloc_info(cache, object)->alloc_track, flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_kmalloc(struct kmem_cache *cache, const void *object, size_t size,\n\t\t   gfp_t flags)\n{\n\tunsigned long redzone_start;\n\tunsigned long redzone_end;\n\n\tif (gfpflags_allow_blocking(flags))\n\t\tquarantine_reduce();\n\n\tif (unlikely(object == NULL))\n\t\treturn;\n\n\tredzone_start = round_up((unsigned long)(object + size),\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\tredzone_end = round_up((unsigned long)object + cache->object_size,\n\t\t\t\tKASAN_SHADOW_SCALE_SIZE);\n\n\tkasan_unpoison_shadow(object, size);\n\tkasan_poison_shadow((void *)redzone_start, redzone_end - redzone_start,\n\t\tKASAN_KMALLOC_REDZONE);\n\n\tif (cache->flags & SLAB_KASAN)\n\t\tset_track(&get_alloc_info(cache, object)->alloc_track, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_slab_alloc(struct kmem_cache *cache, void *object, gfp_t flags)\n{\n\tkasan_kmalloc(cache, object, cache->object_size, flags);\n}"
  },
  {
    "function_name": "kasan_init_slab_obj",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "477-486",
    "snippet": "void kasan_init_slab_obj(struct kmem_cache *cache, const void *object)\n{\n\tstruct kasan_alloc_meta *alloc_info;\n\n\tif (!(cache->flags & SLAB_KASAN))\n\t\treturn;\n\n\talloc_info = get_alloc_info(cache, object);\n\t__memset(alloc_info, 0, sizeof(*alloc_info));\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__memset",
          "args": [
            "alloc_info",
            "0",
            "sizeof(*alloc_info)"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_alloc_info",
          "args": [
            "cache",
            "object"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "get_alloc_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "463-468",
          "snippet": "struct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstruct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_init_slab_obj(struct kmem_cache *cache, const void *object)\n{\n\tstruct kasan_alloc_meta *alloc_info;\n\n\tif (!(cache->flags & SLAB_KASAN))\n\t\treturn;\n\n\talloc_info = get_alloc_info(cache, object);\n\t__memset(alloc_info, 0, sizeof(*alloc_info));\n}"
  },
  {
    "function_name": "get_free_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "470-475",
    "snippet": "struct kasan_free_meta *get_free_info(struct kmem_cache *cache,\n\t\t\t\t      const void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_free_meta) > 32);\n\treturn (void *)object + cache->kasan_info.free_meta_offset;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "sizeof(struct kasan_free_meta) > 32"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstruct kasan_free_meta *get_free_info(struct kmem_cache *cache,\n\t\t\t\t      const void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_free_meta) > 32);\n\treturn (void *)object + cache->kasan_info.free_meta_offset;\n}"
  },
  {
    "function_name": "get_alloc_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "463-468",
    "snippet": "struct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "sizeof(struct kasan_alloc_meta) > 32"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstruct kasan_alloc_meta *get_alloc_info(struct kmem_cache *cache,\n\t\t\t\t\tconst void *object)\n{\n\tBUILD_BUG_ON(sizeof(struct kasan_alloc_meta) > 32);\n\treturn (void *)object + cache->kasan_info.alloc_meta_offset;\n}"
  },
  {
    "function_name": "set_track",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "457-461",
    "snippet": "static inline void set_track(struct kasan_track *track, gfp_t flags)\n{\n\ttrack->pid = current->pid;\n\ttrack->stack = save_stack(flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "save_stack",
          "args": [
            "flags"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "save_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "438-455",
          "snippet": "static inline depot_stack_handle_t save_stack(gfp_t flags)\n{\n\tunsigned long entries[KASAN_STACK_DEPTH];\n\tstruct stack_trace trace = {\n\t\t.nr_entries = 0,\n\t\t.entries = entries,\n\t\t.max_entries = KASAN_STACK_DEPTH,\n\t\t.skip = 0\n\t};\n\n\tsave_stack_trace(&trace);\n\tfilter_irq_stacks(&trace);\n\tif (trace.nr_entries != 0 &&\n\t    trace.entries[trace.nr_entries-1] == ULONG_MAX)\n\t\ttrace.nr_entries--;\n\n\treturn depot_save_stack(&trace, flags);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline depot_stack_handle_t save_stack(gfp_t flags)\n{\n\tunsigned long entries[KASAN_STACK_DEPTH];\n\tstruct stack_trace trace = {\n\t\t.nr_entries = 0,\n\t\t.entries = entries,\n\t\t.max_entries = KASAN_STACK_DEPTH,\n\t\t.skip = 0\n\t};\n\n\tsave_stack_trace(&trace);\n\tfilter_irq_stacks(&trace);\n\tif (trace.nr_entries != 0 &&\n\t    trace.entries[trace.nr_entries-1] == ULONG_MAX)\n\t\ttrace.nr_entries--;\n\n\treturn depot_save_stack(&trace, flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline void set_track(struct kasan_track *track, gfp_t flags)\n{\n\ttrack->pid = current->pid;\n\ttrack->stack = save_stack(flags);\n}"
  },
  {
    "function_name": "save_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "438-455",
    "snippet": "static inline depot_stack_handle_t save_stack(gfp_t flags)\n{\n\tunsigned long entries[KASAN_STACK_DEPTH];\n\tstruct stack_trace trace = {\n\t\t.nr_entries = 0,\n\t\t.entries = entries,\n\t\t.max_entries = KASAN_STACK_DEPTH,\n\t\t.skip = 0\n\t};\n\n\tsave_stack_trace(&trace);\n\tfilter_irq_stacks(&trace);\n\tif (trace.nr_entries != 0 &&\n\t    trace.entries[trace.nr_entries-1] == ULONG_MAX)\n\t\ttrace.nr_entries--;\n\n\treturn depot_save_stack(&trace, flags);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "depot_save_stack",
          "args": [
            "&trace",
            "flags"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter_irq_stacks",
          "args": [
            "&trace"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "filter_irq_stacks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "424-436",
          "snippet": "static inline void filter_irq_stacks(struct stack_trace *trace)\n{\n\tint i;\n\n\tif (!trace->nr_entries)\n\t\treturn;\n\tfor (i = 0; i < trace->nr_entries; i++)\n\t\tif (in_irqentry_text(trace->entries[i])) {\n\t\t\t/* Include the irqentry function into the stack. */\n\t\t\ttrace->nr_entries = i + 1;\n\t\t\tbreak;\n\t\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline void filter_irq_stacks(struct stack_trace *trace)\n{\n\tint i;\n\n\tif (!trace->nr_entries)\n\t\treturn;\n\tfor (i = 0; i < trace->nr_entries; i++)\n\t\tif (in_irqentry_text(trace->entries[i])) {\n\t\t\t/* Include the irqentry function into the stack. */\n\t\t\ttrace->nr_entries = i + 1;\n\t\t\tbreak;\n\t\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "save_stack_trace",
          "args": [
            "&trace"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "__save_stack_trace",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kmemleak.c",
          "lines": "554-565",
          "snippet": "static int __save_stack_trace(unsigned long *trace)\n{\n\tstruct stack_trace stack_trace;\n\n\tstack_trace.max_entries = MAX_TRACE;\n\tstack_trace.nr_entries = 0;\n\tstack_trace.entries = trace;\n\tstack_trace.skip = 2;\n\tsave_stack_trace(&stack_trace);\n\n\treturn stack_trace.nr_entries;\n}",
          "includes": [
            "#include <linux/memory_hotplug.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kasan.h>",
            "#include <linux/atomic.h>",
            "#include <asm/processor.h>",
            "#include <asm/sections.h>",
            "#include <linux/crc32.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/mm.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/string.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/err.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/slab.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/pfn.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/cache.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/kthread.h>",
            "#include <linux/export.h>",
            "#include <linux/delay.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [
            "#define MAX_TRACE\t\t16\t/* stack trace length */"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memory_hotplug.h>\n#include <linux/kmemleak.h>\n#include <linux/kasan.h>\n#include <linux/atomic.h>\n#include <asm/processor.h>\n#include <asm/sections.h>\n#include <linux/crc32.h>\n#include <linux/workqueue.h>\n#include <linux/mm.h>\n#include <linux/nodemask.h>\n#include <linux/string.h>\n#include <linux/uaccess.h>\n#include <linux/err.h>\n#include <linux/thread_info.h>\n#include <linux/slab.h>\n#include <linux/mmzone.h>\n#include <linux/pfn.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/cache.h>\n#include <linux/stacktrace.h>\n#include <linux/rcupdate.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/kthread.h>\n#include <linux/export.h>\n#include <linux/delay.h>\n#include <linux/jiffies.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\n#define MAX_TRACE\t\t16\t/* stack trace length */\n\nstatic int __save_stack_trace(unsigned long *trace)\n{\n\tstruct stack_trace stack_trace;\n\n\tstack_trace.max_entries = MAX_TRACE;\n\tstack_trace.nr_entries = 0;\n\tstack_trace.entries = trace;\n\tstack_trace.skip = 2;\n\tsave_stack_trace(&stack_trace);\n\n\treturn stack_trace.nr_entries;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline depot_stack_handle_t save_stack(gfp_t flags)\n{\n\tunsigned long entries[KASAN_STACK_DEPTH];\n\tstruct stack_trace trace = {\n\t\t.nr_entries = 0,\n\t\t.entries = entries,\n\t\t.max_entries = KASAN_STACK_DEPTH,\n\t\t.skip = 0\n\t};\n\n\tsave_stack_trace(&trace);\n\tfilter_irq_stacks(&trace);\n\tif (trace.nr_entries != 0 &&\n\t    trace.entries[trace.nr_entries-1] == ULONG_MAX)\n\t\ttrace.nr_entries--;\n\n\treturn depot_save_stack(&trace, flags);\n}"
  },
  {
    "function_name": "filter_irq_stacks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "424-436",
    "snippet": "static inline void filter_irq_stacks(struct stack_trace *trace)\n{\n\tint i;\n\n\tif (!trace->nr_entries)\n\t\treturn;\n\tfor (i = 0; i < trace->nr_entries; i++)\n\t\tif (in_irqentry_text(trace->entries[i])) {\n\t\t\t/* Include the irqentry function into the stack. */\n\t\t\ttrace->nr_entries = i + 1;\n\t\t\tbreak;\n\t\t}\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_irqentry_text",
          "args": [
            "trace->entries[i]"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "in_irqentry_text",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "416-422",
          "snippet": "static inline int in_irqentry_text(unsigned long ptr)\n{\n\treturn (ptr >= (unsigned long)&__irqentry_text_start &&\n\t\tptr < (unsigned long)&__irqentry_text_end) ||\n\t\t(ptr >= (unsigned long)&__softirqentry_text_start &&\n\t\t ptr < (unsigned long)&__softirqentry_text_end);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline int in_irqentry_text(unsigned long ptr)\n{\n\treturn (ptr >= (unsigned long)&__irqentry_text_start &&\n\t\tptr < (unsigned long)&__irqentry_text_end) ||\n\t\t(ptr >= (unsigned long)&__softirqentry_text_start &&\n\t\t ptr < (unsigned long)&__softirqentry_text_end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline void filter_irq_stacks(struct stack_trace *trace)\n{\n\tint i;\n\n\tif (!trace->nr_entries)\n\t\treturn;\n\tfor (i = 0; i < trace->nr_entries; i++)\n\t\tif (in_irqentry_text(trace->entries[i])) {\n\t\t\t/* Include the irqentry function into the stack. */\n\t\t\ttrace->nr_entries = i + 1;\n\t\t\tbreak;\n\t\t}\n}"
  },
  {
    "function_name": "in_irqentry_text",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "416-422",
    "snippet": "static inline int in_irqentry_text(unsigned long ptr)\n{\n\treturn (ptr >= (unsigned long)&__irqentry_text_start &&\n\t\tptr < (unsigned long)&__irqentry_text_end) ||\n\t\t(ptr >= (unsigned long)&__softirqentry_text_start &&\n\t\t ptr < (unsigned long)&__softirqentry_text_end);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic inline int in_irqentry_text(unsigned long ptr)\n{\n\treturn (ptr >= (unsigned long)&__irqentry_text_start &&\n\t\tptr < (unsigned long)&__irqentry_text_end) ||\n\t\t(ptr >= (unsigned long)&__softirqentry_text_start &&\n\t\t ptr < (unsigned long)&__softirqentry_text_end);\n}"
  },
  {
    "function_name": "kasan_poison_object_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "409-414",
    "snippet": "void kasan_poison_object_data(struct kmem_cache *cache, void *object)\n{\n\tkasan_poison_shadow(object,\n\t\t\tround_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE),\n\t\t\tKASAN_KMALLOC_REDZONE);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "object",
            "round_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE)",
            "KASAN_KMALLOC_REDZONE"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "round_up",
          "args": [
            "cache->object_size",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_poison_object_data(struct kmem_cache *cache, void *object)\n{\n\tkasan_poison_shadow(object,\n\t\t\tround_up(cache->object_size, KASAN_SHADOW_SCALE_SIZE),\n\t\t\tKASAN_KMALLOC_REDZONE);\n}"
  },
  {
    "function_name": "kasan_unpoison_object_data",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "404-407",
    "snippet": "void kasan_unpoison_object_data(struct kmem_cache *cache, void *object)\n{\n\tkasan_unpoison_shadow(object, cache->object_size);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "object",
            "cache->object_size"
          ],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_unpoison_object_data(struct kmem_cache *cache, void *object)\n{\n\tkasan_unpoison_shadow(object, cache->object_size);\n}"
  },
  {
    "function_name": "kasan_poison_slab",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "397-402",
    "snippet": "void kasan_poison_slab(struct page *page)\n{\n\tkasan_poison_shadow(page_address(page),\n\t\t\tPAGE_SIZE << compound_order(page),\n\t\t\tKASAN_KMALLOC_REDZONE);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "page_address(page)",
            "PAGE_SIZE << compound_order(page)",
            "KASAN_KMALLOC_REDZONE"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "compound_order",
          "args": [
            "page"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "page_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/highmem.c",
          "lines": "409-434",
          "snippet": "void *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/tlbflush.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/mempool.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/tlbflush.h>\n#include <linux/kgdb.h>\n#include <linux/highmem.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/mempool.h>\n#include <linux/pagemap.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_poison_slab(struct page *page)\n{\n\tkasan_poison_shadow(page_address(page),\n\t\t\tPAGE_SIZE << compound_order(page),\n\t\t\tKASAN_KMALLOC_REDZONE);\n}"
  },
  {
    "function_name": "kasan_metadata_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "389-395",
    "snippet": "size_t kasan_metadata_size(struct kmem_cache *cache)\n{\n\treturn (cache->kasan_info.alloc_meta_offset ?\n\t\tsizeof(struct kasan_alloc_meta) : 0) +\n\t\t(cache->kasan_info.free_meta_offset ?\n\t\tsizeof(struct kasan_free_meta) : 0);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nsize_t kasan_metadata_size(struct kmem_cache *cache)\n{\n\treturn (cache->kasan_info.alloc_meta_offset ?\n\t\tsizeof(struct kasan_alloc_meta) : 0) +\n\t\t(cache->kasan_info.free_meta_offset ?\n\t\tsizeof(struct kasan_free_meta) : 0);\n}"
  },
  {
    "function_name": "kasan_cache_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "383-387",
    "snippet": "void kasan_cache_shutdown(struct kmem_cache *cache)\n{\n\tif (!__kmem_cache_empty(cache))\n\t\tquarantine_remove_cache(cache);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quarantine_remove_cache",
          "args": [
            "cache"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "quarantine_remove_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.h",
          "lines": "120-120",
          "snippet": "static inline void quarantine_remove_cache(struct kmem_cache *cache) { }",
          "includes": [
            "#include <linux/stackdepot.h>",
            "#include <linux/kasan.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/stackdepot.h>\n#include <linux/kasan.h>\n\nstatic inline void quarantine_remove_cache(struct kmem_cache *cache) { }"
        }
      },
      {
        "call_info": {
          "callee": "__kmem_cache_empty",
          "args": [
            "cache"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "__kmem_cache_empty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "2292-2302",
          "snippet": "bool __kmem_cache_empty(struct kmem_cache *s)\n{\n\tint node;\n\tstruct kmem_cache_node *n;\n\n\tfor_each_kmem_cache_node(s, node, n)\n\t\tif (!list_empty(&n->slabs_full) ||\n\t\t    !list_empty(&n->slabs_partial))\n\t\t\treturn false;\n\treturn true;\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nbool __kmem_cache_empty(struct kmem_cache *s)\n{\n\tint node;\n\tstruct kmem_cache_node *n;\n\n\tfor_each_kmem_cache_node(s, node, n)\n\t\tif (!list_empty(&n->slabs_full) ||\n\t\t    !list_empty(&n->slabs_partial))\n\t\t\treturn false;\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_cache_shutdown(struct kmem_cache *cache)\n{\n\tif (!__kmem_cache_empty(cache))\n\t\tquarantine_remove_cache(cache);\n}"
  },
  {
    "function_name": "kasan_cache_shrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "378-381",
    "snippet": "void kasan_cache_shrink(struct kmem_cache *cache)\n{\n\tquarantine_remove_cache(cache);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "quarantine_remove_cache",
          "args": [
            "cache"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "quarantine_remove_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.h",
          "lines": "120-120",
          "snippet": "static inline void quarantine_remove_cache(struct kmem_cache *cache) { }",
          "includes": [
            "#include <linux/stackdepot.h>",
            "#include <linux/kasan.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/stackdepot.h>\n#include <linux/kasan.h>\n\nstatic inline void quarantine_remove_cache(struct kmem_cache *cache) { }"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_cache_shrink(struct kmem_cache *cache)\n{\n\tquarantine_remove_cache(cache);\n}"
  },
  {
    "function_name": "kasan_cache_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "338-376",
    "snippet": "void kasan_cache_create(struct kmem_cache *cache, unsigned int *size,\n\t\t\tslab_flags_t *flags)\n{\n\tunsigned int orig_size = *size;\n\tint redzone_adjust;\n\n\t/* Add alloc meta. */\n\tcache->kasan_info.alloc_meta_offset = *size;\n\t*size += sizeof(struct kasan_alloc_meta);\n\n\t/* Add free meta. */\n\tif (cache->flags & SLAB_TYPESAFE_BY_RCU || cache->ctor ||\n\t    cache->object_size < sizeof(struct kasan_free_meta)) {\n\t\tcache->kasan_info.free_meta_offset = *size;\n\t\t*size += sizeof(struct kasan_free_meta);\n\t}\n\tredzone_adjust = optimal_redzone(cache->object_size) -\n\t\t(*size - cache->object_size);\n\n\tif (redzone_adjust > 0)\n\t\t*size += redzone_adjust;\n\n\t*size = min_t(unsigned int, KMALLOC_MAX_SIZE,\n\t\t\tmax(*size, cache->object_size +\n\t\t\t\t\toptimal_redzone(cache->object_size)));\n\n\t/*\n\t * If the metadata doesn't fit, don't enable KASAN at all.\n\t */\n\tif (*size <= cache->kasan_info.alloc_meta_offset ||\n\t\t\t*size <= cache->kasan_info.free_meta_offset) {\n\t\tcache->kasan_info.alloc_meta_offset = 0;\n\t\tcache->kasan_info.free_meta_offset = 0;\n\t\t*size = orig_size;\n\t\treturn;\n\t}\n\n\t*flags |= SLAB_KASAN;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "min_t",
          "args": [
            "unsignedint",
            "KMALLOC_MAX_SIZE",
            "max(*size, cache->object_size +\n\t\t\t\t\toptimal_redzone(cache->object_size))"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "*size",
            "cache->object_size +\n\t\t\t\t\toptimal_redzone(cache->object_size)"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "wb_max_pause",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "1418-1435",
          "snippet": "static unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_PAUSE\t\tmax(HZ/5, 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define MAX_PAUSE\t\tmax(HZ/5, 1)\n\nstatic unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "optimal_redzone",
          "args": [
            "cache->object_size"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "optimal_redzone",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "326-336",
          "snippet": "static unsigned int optimal_redzone(unsigned int object_size)\n{\n\treturn\n\t\tobject_size <= 64        - 16   ? 16 :\n\t\tobject_size <= 128       - 32   ? 32 :\n\t\tobject_size <= 512       - 64   ? 64 :\n\t\tobject_size <= 4096      - 128  ? 128 :\n\t\tobject_size <= (1 << 14) - 256  ? 256 :\n\t\tobject_size <= (1 << 15) - 512  ? 512 :\n\t\tobject_size <= (1 << 16) - 1024 ? 1024 : 2048;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic unsigned int optimal_redzone(unsigned int object_size)\n{\n\treturn\n\t\tobject_size <= 64        - 16   ? 16 :\n\t\tobject_size <= 128       - 32   ? 32 :\n\t\tobject_size <= 512       - 64   ? 64 :\n\t\tobject_size <= 4096      - 128  ? 128 :\n\t\tobject_size <= (1 << 14) - 256  ? 256 :\n\t\tobject_size <= (1 << 15) - 512  ? 512 :\n\t\tobject_size <= (1 << 16) - 1024 ? 1024 : 2048;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_cache_create(struct kmem_cache *cache, unsigned int *size,\n\t\t\tslab_flags_t *flags)\n{\n\tunsigned int orig_size = *size;\n\tint redzone_adjust;\n\n\t/* Add alloc meta. */\n\tcache->kasan_info.alloc_meta_offset = *size;\n\t*size += sizeof(struct kasan_alloc_meta);\n\n\t/* Add free meta. */\n\tif (cache->flags & SLAB_TYPESAFE_BY_RCU || cache->ctor ||\n\t    cache->object_size < sizeof(struct kasan_free_meta)) {\n\t\tcache->kasan_info.free_meta_offset = *size;\n\t\t*size += sizeof(struct kasan_free_meta);\n\t}\n\tredzone_adjust = optimal_redzone(cache->object_size) -\n\t\t(*size - cache->object_size);\n\n\tif (redzone_adjust > 0)\n\t\t*size += redzone_adjust;\n\n\t*size = min_t(unsigned int, KMALLOC_MAX_SIZE,\n\t\t\tmax(*size, cache->object_size +\n\t\t\t\t\toptimal_redzone(cache->object_size)));\n\n\t/*\n\t * If the metadata doesn't fit, don't enable KASAN at all.\n\t */\n\tif (*size <= cache->kasan_info.alloc_meta_offset ||\n\t\t\t*size <= cache->kasan_info.free_meta_offset) {\n\t\tcache->kasan_info.alloc_meta_offset = 0;\n\t\tcache->kasan_info.free_meta_offset = 0;\n\t\t*size = orig_size;\n\t\treturn;\n\t}\n\n\t*flags |= SLAB_KASAN;\n}"
  },
  {
    "function_name": "optimal_redzone",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "326-336",
    "snippet": "static unsigned int optimal_redzone(unsigned int object_size)\n{\n\treturn\n\t\tobject_size <= 64        - 16   ? 16 :\n\t\tobject_size <= 128       - 32   ? 32 :\n\t\tobject_size <= 512       - 64   ? 64 :\n\t\tobject_size <= 4096      - 128  ? 128 :\n\t\tobject_size <= (1 << 14) - 256  ? 256 :\n\t\tobject_size <= (1 << 15) - 512  ? 512 :\n\t\tobject_size <= (1 << 16) - 1024 ? 1024 : 2048;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic unsigned int optimal_redzone(unsigned int object_size)\n{\n\treturn\n\t\tobject_size <= 64        - 16   ? 16 :\n\t\tobject_size <= 128       - 32   ? 32 :\n\t\tobject_size <= 512       - 64   ? 64 :\n\t\tobject_size <= 4096      - 128  ? 128 :\n\t\tobject_size <= (1 << 14) - 256  ? 256 :\n\t\tobject_size <= (1 << 15) - 512  ? 512 :\n\t\tobject_size <= (1 << 16) - 1024 ? 1024 : 2048;\n}"
  },
  {
    "function_name": "kasan_free_pages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "314-320",
    "snippet": "void kasan_free_pages(struct page *page, unsigned int order)\n{\n\tif (likely(!PageHighMem(page)))\n\t\tkasan_poison_shadow(page_address(page),\n\t\t\t\tPAGE_SIZE << order,\n\t\t\t\tKASAN_FREE_PAGE);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "page_address(page)",
            "PAGE_SIZE << order",
            "KASAN_FREE_PAGE"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "page_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/highmem.c",
          "lines": "409-434",
          "snippet": "void *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/tlbflush.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/mempool.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/tlbflush.h>\n#include <linux/kgdb.h>\n#include <linux/highmem.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/mempool.h>\n#include <linux/pagemap.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!PageHighMem(page)"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "page"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_free_pages(struct page *page, unsigned int order)\n{\n\tif (likely(!PageHighMem(page)))\n\t\tkasan_poison_shadow(page_address(page),\n\t\t\t\tPAGE_SIZE << order,\n\t\t\t\tKASAN_FREE_PAGE);\n}"
  },
  {
    "function_name": "kasan_alloc_pages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "308-312",
    "snippet": "void kasan_alloc_pages(struct page *page, unsigned int order)\n{\n\tif (likely(!PageHighMem(page)))\n\t\tkasan_unpoison_shadow(page_address(page), PAGE_SIZE << order);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "page_address(page)",
            "PAGE_SIZE << order"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "page_address",
          "args": [
            "page"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "page_address",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/highmem.c",
          "lines": "409-434",
          "snippet": "void *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}",
          "includes": [
            "#include <asm/tlbflush.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/highmem.h>",
            "#include <linux/hash.h>",
            "#include <linux/init.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/mempool.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/tlbflush.h>\n#include <linux/kgdb.h>\n#include <linux/highmem.h>\n#include <linux/hash.h>\n#include <linux/init.h>\n#include <linux/blkdev.h>\n#include <linux/mempool.h>\n#include <linux/pagemap.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n\nvoid *page_address(const struct page *page)\n{\n\tunsigned long flags;\n\tvoid *ret;\n\tstruct page_address_slot *pas;\n\n\tif (!PageHighMem(page))\n\t\treturn lowmem_page_address(page);\n\n\tpas = page_slot(page);\n\tret = NULL;\n\tspin_lock_irqsave(&pas->lock, flags);\n\tif (!list_empty(&pas->lh)) {\n\t\tstruct page_address_map *pam;\n\n\t\tlist_for_each_entry(pam, &pas->lh, list) {\n\t\t\tif (pam->page == page) {\n\t\t\t\tret = pam->virtual;\n\t\t\t\tgoto done;\n\t\t\t}\n\t\t}\n\t}\ndone:\n\tspin_unlock_irqrestore(&pas->lock, flags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!PageHighMem(page)"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PageHighMem",
          "args": [
            "page"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_alloc_pages(struct page *page, unsigned int order)\n{\n\tif (likely(!PageHighMem(page)))\n\t\tkasan_unpoison_shadow(page_address(page), PAGE_SIZE << order);\n}"
  },
  {
    "function_name": "memcpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "300-306",
    "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__memcpy",
          "args": [
            "dest",
            "src",
            "len"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_memory_region",
          "args": [
            "(unsigned long)dest",
            "len",
            "true",
            "_RET_IP_"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "check_memory_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "263-268",
          "snippet": "static void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
  },
  {
    "function_name": "memmove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "291-297",
    "snippet": "void *memmove(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memmove(dest, src, len);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__memmove",
          "args": [
            "dest",
            "src",
            "len"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_memory_region",
          "args": [
            "(unsigned long)dest",
            "len",
            "true",
            "_RET_IP_"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "check_memory_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "263-268",
          "snippet": "static void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memmove(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memmove(dest, src, len);\n}"
  },
  {
    "function_name": "memset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "283-288",
    "snippet": "void *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__memset",
          "args": [
            "addr",
            "c",
            "len"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_memory_region",
          "args": [
            "(unsigned long)addr",
            "len",
            "true",
            "_RET_IP_"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "check_memory_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "263-268",
          "snippet": "static void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}"
  },
  {
    "function_name": "kasan_check_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "276-279",
    "snippet": "void kasan_check_write(const volatile void *p, unsigned int size)\n{\n\tcheck_memory_region((unsigned long)p, size, true, _RET_IP_);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_memory_region",
          "args": [
            "(unsigned long)p",
            "size",
            "true",
            "_RET_IP_"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "check_memory_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "263-268",
          "snippet": "static void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_check_write(const volatile void *p, unsigned int size)\n{\n\tcheck_memory_region((unsigned long)p, size, true, _RET_IP_);\n}"
  },
  {
    "function_name": "kasan_check_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "270-273",
    "snippet": "void kasan_check_read(const volatile void *p, unsigned int size)\n{\n\tcheck_memory_region((unsigned long)p, size, false, _RET_IP_);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_memory_region",
          "args": [
            "(unsigned long)p",
            "size",
            "false",
            "_RET_IP_"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "check_memory_region",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "263-268",
          "snippet": "static void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_check_read(const volatile void *p, unsigned int size)\n{\n\tcheck_memory_region((unsigned long)p, size, false, _RET_IP_);\n}"
  },
  {
    "function_name": "check_memory_region",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "263-268",
    "snippet": "static void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "check_memory_region_inline",
          "args": [
            "addr",
            "size",
            "write",
            "ret_ip"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "check_memory_region_inline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "244-261",
          "snippet": "static __always_inline void check_memory_region_inline(unsigned long addr,\n\t\t\t\t\t\tsize_t size, bool write,\n\t\t\t\t\t\tunsigned long ret_ip)\n{\n\tif (unlikely(size == 0))\n\t\treturn;\n\n\tif (unlikely((void *)addr <\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START))) {\n\t\tkasan_report(addr, size, write, ret_ip);\n\t\treturn;\n\t}\n\n\tif (likely(!memory_is_poisoned(addr, size)))\n\t\treturn;\n\n\tkasan_report(addr, size, write, ret_ip);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic __always_inline void check_memory_region_inline(unsigned long addr,\n\t\t\t\t\t\tsize_t size, bool write,\n\t\t\t\t\t\tunsigned long ret_ip)\n{\n\tif (unlikely(size == 0))\n\t\treturn;\n\n\tif (unlikely((void *)addr <\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START))) {\n\t\tkasan_report(addr, size, write, ret_ip);\n\t\treturn;\n\t}\n\n\tif (likely(!memory_is_poisoned(addr, size)))\n\t\treturn;\n\n\tkasan_report(addr, size, write, ret_ip);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void check_memory_region(unsigned long addr,\n\t\t\t\tsize_t size, bool write,\n\t\t\t\tunsigned long ret_ip)\n{\n\tcheck_memory_region_inline(addr, size, write, ret_ip);\n}"
  },
  {
    "function_name": "check_memory_region_inline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "244-261",
    "snippet": "static __always_inline void check_memory_region_inline(unsigned long addr,\n\t\t\t\t\t\tsize_t size, bool write,\n\t\t\t\t\t\tunsigned long ret_ip)\n{\n\tif (unlikely(size == 0))\n\t\treturn;\n\n\tif (unlikely((void *)addr <\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START))) {\n\t\tkasan_report(addr, size, write, ret_ip);\n\t\treturn;\n\t}\n\n\tif (likely(!memory_is_poisoned(addr, size)))\n\t\treturn;\n\n\tkasan_report(addr, size, write, ret_ip);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_report",
          "args": [
            "addr",
            "size",
            "write",
            "ret_ip"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_report",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/report.c",
          "lines": "396-413",
          "snippet": "void kasan_report(unsigned long addr, size_t size,\n\t\tbool is_write, unsigned long ip)\n{\n\tstruct kasan_access_info info;\n\n\tif (likely(!kasan_report_enabled()))\n\t\treturn;\n\n\tdisable_trace_on_warning();\n\n\tinfo.access_addr = (void *)addr;\n\tinfo.first_bad_addr = (void *)addr;\n\tinfo.access_size = size;\n\tinfo.is_write = is_write;\n\tinfo.ip = ip;\n\n\tkasan_report_error(&info);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <asm/sections.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/stackdepot.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/bitops.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <asm/sections.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/stackdepot.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/ftrace.h>\n#include <linux/bitops.h>\n\nvoid kasan_report(unsigned long addr, size_t size,\n\t\tbool is_write, unsigned long ip)\n{\n\tstruct kasan_access_info info;\n\n\tif (likely(!kasan_report_enabled()))\n\t\treturn;\n\n\tdisable_trace_on_warning();\n\n\tinfo.access_addr = (void *)addr;\n\tinfo.first_bad_addr = (void *)addr;\n\tinfo.access_size = size;\n\tinfo.is_write = is_write;\n\tinfo.ip = ip;\n\n\tkasan_report_error(&info);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "!memory_is_poisoned(addr, size)"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_is_poisoned",
          "args": [
            "addr",
            "size"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "memory_is_poisoned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "224-242",
          "snippet": "static __always_inline bool memory_is_poisoned(unsigned long addr, size_t size)\n{\n\tif (__builtin_constant_p(size)) {\n\t\tswitch (size) {\n\t\tcase 1:\n\t\t\treturn memory_is_poisoned_1(addr);\n\t\tcase 2:\n\t\tcase 4:\n\t\tcase 8:\n\t\t\treturn memory_is_poisoned_2_4_8(addr, size);\n\t\tcase 16:\n\t\t\treturn memory_is_poisoned_16(addr);\n\t\tdefault:\n\t\t\tBUILD_BUG();\n\t\t}\n\t}\n\n\treturn memory_is_poisoned_n(addr, size);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic __always_inline bool memory_is_poisoned(unsigned long addr, size_t size)\n{\n\tif (__builtin_constant_p(size)) {\n\t\tswitch (size) {\n\t\tcase 1:\n\t\t\treturn memory_is_poisoned_1(addr);\n\t\tcase 2:\n\t\tcase 4:\n\t\tcase 8:\n\t\t\treturn memory_is_poisoned_2_4_8(addr, size);\n\t\tcase 16:\n\t\t\treturn memory_is_poisoned_16(addr);\n\t\tdefault:\n\t\t\tBUILD_BUG();\n\t\t}\n\t}\n\n\treturn memory_is_poisoned_n(addr, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "(void *)addr <\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_shadow_to_mem",
          "args": [
            "(void *)KASAN_SHADOW_START"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_shadow_to_mem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.h",
          "lines": "102-106",
          "snippet": "static inline const void *kasan_shadow_to_mem(const void *shadow_addr)\n{\n\treturn (void *)(((unsigned long)shadow_addr - KASAN_SHADOW_OFFSET)\n\t\t<< KASAN_SHADOW_SCALE_SHIFT);\n}",
          "includes": [
            "#include <linux/stackdepot.h>",
            "#include <linux/kasan.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/stackdepot.h>\n#include <linux/kasan.h>\n\nstatic inline const void *kasan_shadow_to_mem(const void *shadow_addr)\n{\n\treturn (void *)(((unsigned long)shadow_addr - KASAN_SHADOW_OFFSET)\n\t\t<< KASAN_SHADOW_SCALE_SHIFT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "size == 0"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic __always_inline void check_memory_region_inline(unsigned long addr,\n\t\t\t\t\t\tsize_t size, bool write,\n\t\t\t\t\t\tunsigned long ret_ip)\n{\n\tif (unlikely(size == 0))\n\t\treturn;\n\n\tif (unlikely((void *)addr <\n\t\tkasan_shadow_to_mem((void *)KASAN_SHADOW_START))) {\n\t\tkasan_report(addr, size, write, ret_ip);\n\t\treturn;\n\t}\n\n\tif (likely(!memory_is_poisoned(addr, size)))\n\t\treturn;\n\n\tkasan_report(addr, size, write, ret_ip);\n}"
  },
  {
    "function_name": "memory_is_poisoned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "224-242",
    "snippet": "static __always_inline bool memory_is_poisoned(unsigned long addr, size_t size)\n{\n\tif (__builtin_constant_p(size)) {\n\t\tswitch (size) {\n\t\tcase 1:\n\t\t\treturn memory_is_poisoned_1(addr);\n\t\tcase 2:\n\t\tcase 4:\n\t\tcase 8:\n\t\t\treturn memory_is_poisoned_2_4_8(addr, size);\n\t\tcase 16:\n\t\t\treturn memory_is_poisoned_16(addr);\n\t\tdefault:\n\t\t\tBUILD_BUG();\n\t\t}\n\t}\n\n\treturn memory_is_poisoned_n(addr, size);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_is_poisoned_n",
          "args": [
            "addr",
            "size"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "memory_is_poisoned_n",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "205-222",
          "snippet": "static __always_inline bool memory_is_poisoned_n(unsigned long addr,\n\t\t\t\t\t\tsize_t size)\n{\n\tunsigned long ret;\n\n\tret = memory_is_nonzero(kasan_mem_to_shadow((void *)addr),\n\t\t\tkasan_mem_to_shadow((void *)addr + size - 1) + 1);\n\n\tif (unlikely(ret)) {\n\t\tunsigned long last_byte = addr + size - 1;\n\t\ts8 *last_shadow = (s8 *)kasan_mem_to_shadow((void *)last_byte);\n\n\t\tif (unlikely(ret != (unsigned long)last_shadow ||\n\t\t\t((long)(last_byte & KASAN_SHADOW_MASK) >= *last_shadow)))\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic __always_inline bool memory_is_poisoned_n(unsigned long addr,\n\t\t\t\t\t\tsize_t size)\n{\n\tunsigned long ret;\n\n\tret = memory_is_nonzero(kasan_mem_to_shadow((void *)addr),\n\t\t\tkasan_mem_to_shadow((void *)addr + size - 1) + 1);\n\n\tif (unlikely(ret)) {\n\t\tunsigned long last_byte = addr + size - 1;\n\t\ts8 *last_shadow = (s8 *)kasan_mem_to_shadow((void *)last_byte);\n\n\t\tif (unlikely(ret != (unsigned long)last_shadow ||\n\t\t\t((long)(last_byte & KASAN_SHADOW_MASK) >= *last_shadow)))\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUILD_BUG",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_is_poisoned_16",
          "args": [
            "addr"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "memory_is_poisoned_16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "152-161",
          "snippet": "static __always_inline bool memory_is_poisoned_16(unsigned long addr)\n{\n\tu16 *shadow_addr = (u16 *)kasan_mem_to_shadow((void *)addr);\n\n\t/* Unaligned 16-bytes access maps into 3 shadow bytes. */\n\tif (unlikely(!IS_ALIGNED(addr, KASAN_SHADOW_SCALE_SIZE)))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + 15);\n\n\treturn *shadow_addr;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic __always_inline bool memory_is_poisoned_16(unsigned long addr)\n{\n\tu16 *shadow_addr = (u16 *)kasan_mem_to_shadow((void *)addr);\n\n\t/* Unaligned 16-bytes access maps into 3 shadow bytes. */\n\tif (unlikely(!IS_ALIGNED(addr, KASAN_SHADOW_SCALE_SIZE)))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + 15);\n\n\treturn *shadow_addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memory_is_poisoned_2_4_8",
          "args": [
            "addr",
            "size"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "memory_is_poisoned_2_4_8",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "137-150",
          "snippet": "static __always_inline bool memory_is_poisoned_2_4_8(unsigned long addr,\n\t\t\t\t\t\tunsigned long size)\n{\n\tu8 *shadow_addr = (u8 *)kasan_mem_to_shadow((void *)addr);\n\n\t/*\n\t * Access crosses 8(shadow size)-byte boundary. Such access maps\n\t * into 2 shadow bytes, so we need to check them both.\n\t */\n\tif (unlikely(((addr + size - 1) & KASAN_SHADOW_MASK) < size - 1))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + size - 1);\n\n\treturn memory_is_poisoned_1(addr + size - 1);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic __always_inline bool memory_is_poisoned_2_4_8(unsigned long addr,\n\t\t\t\t\t\tunsigned long size)\n{\n\tu8 *shadow_addr = (u8 *)kasan_mem_to_shadow((void *)addr);\n\n\t/*\n\t * Access crosses 8(shadow size)-byte boundary. Such access maps\n\t * into 2 shadow bytes, so we need to check them both.\n\t */\n\tif (unlikely(((addr + size - 1) & KASAN_SHADOW_MASK) < size - 1))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + size - 1);\n\n\treturn memory_is_poisoned_1(addr + size - 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__builtin_constant_p",
          "args": [
            "size"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic __always_inline bool memory_is_poisoned(unsigned long addr, size_t size)\n{\n\tif (__builtin_constant_p(size)) {\n\t\tswitch (size) {\n\t\tcase 1:\n\t\t\treturn memory_is_poisoned_1(addr);\n\t\tcase 2:\n\t\tcase 4:\n\t\tcase 8:\n\t\t\treturn memory_is_poisoned_2_4_8(addr, size);\n\t\tcase 16:\n\t\t\treturn memory_is_poisoned_16(addr);\n\t\tdefault:\n\t\t\tBUILD_BUG();\n\t\t}\n\t}\n\n\treturn memory_is_poisoned_n(addr, size);\n}"
  },
  {
    "function_name": "memory_is_poisoned_n",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "205-222",
    "snippet": "static __always_inline bool memory_is_poisoned_n(unsigned long addr,\n\t\t\t\t\t\tsize_t size)\n{\n\tunsigned long ret;\n\n\tret = memory_is_nonzero(kasan_mem_to_shadow((void *)addr),\n\t\t\tkasan_mem_to_shadow((void *)addr + size - 1) + 1);\n\n\tif (unlikely(ret)) {\n\t\tunsigned long last_byte = addr + size - 1;\n\t\ts8 *last_shadow = (s8 *)kasan_mem_to_shadow((void *)last_byte);\n\n\t\tif (unlikely(ret != (unsigned long)last_shadow ||\n\t\t\t((long)(last_byte & KASAN_SHADOW_MASK) >= *last_shadow)))\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ret != (unsigned long)last_shadow ||\n\t\t\t((long)(last_byte & KASAN_SHADOW_MASK) >= *last_shadow)"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "(void *)last_byte"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ret"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memory_is_nonzero",
          "args": [
            "kasan_mem_to_shadow((void *)addr)",
            "kasan_mem_to_shadow((void *)addr + size - 1) + 1"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "memory_is_nonzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "176-203",
          "snippet": "static __always_inline unsigned long memory_is_nonzero(const void *start,\n\t\t\t\t\t\tconst void *end)\n{\n\tunsigned int words;\n\tunsigned long ret;\n\tunsigned int prefix = (unsigned long)start % 8;\n\n\tif (end - start <= 16)\n\t\treturn bytes_is_nonzero(start, end - start);\n\n\tif (prefix) {\n\t\tprefix = 8 - prefix;\n\t\tret = bytes_is_nonzero(start, prefix);\n\t\tif (unlikely(ret))\n\t\t\treturn ret;\n\t\tstart += prefix;\n\t}\n\n\twords = (end - start) / 8;\n\twhile (words) {\n\t\tif (unlikely(*(u64 *)start))\n\t\t\treturn bytes_is_nonzero(start, 8);\n\t\tstart += 8;\n\t\twords--;\n\t}\n\n\treturn bytes_is_nonzero(start, (end - start) % 8);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic __always_inline unsigned long memory_is_nonzero(const void *start,\n\t\t\t\t\t\tconst void *end)\n{\n\tunsigned int words;\n\tunsigned long ret;\n\tunsigned int prefix = (unsigned long)start % 8;\n\n\tif (end - start <= 16)\n\t\treturn bytes_is_nonzero(start, end - start);\n\n\tif (prefix) {\n\t\tprefix = 8 - prefix;\n\t\tret = bytes_is_nonzero(start, prefix);\n\t\tif (unlikely(ret))\n\t\t\treturn ret;\n\t\tstart += prefix;\n\t}\n\n\twords = (end - start) / 8;\n\twhile (words) {\n\t\tif (unlikely(*(u64 *)start))\n\t\t\treturn bytes_is_nonzero(start, 8);\n\t\tstart += 8;\n\t\twords--;\n\t}\n\n\treturn bytes_is_nonzero(start, (end - start) % 8);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "(void *)addr + size - 1"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "(void *)addr"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic __always_inline bool memory_is_poisoned_n(unsigned long addr,\n\t\t\t\t\t\tsize_t size)\n{\n\tunsigned long ret;\n\n\tret = memory_is_nonzero(kasan_mem_to_shadow((void *)addr),\n\t\t\tkasan_mem_to_shadow((void *)addr + size - 1) + 1);\n\n\tif (unlikely(ret)) {\n\t\tunsigned long last_byte = addr + size - 1;\n\t\ts8 *last_shadow = (s8 *)kasan_mem_to_shadow((void *)last_byte);\n\n\t\tif (unlikely(ret != (unsigned long)last_shadow ||\n\t\t\t((long)(last_byte & KASAN_SHADOW_MASK) >= *last_shadow)))\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "memory_is_nonzero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "176-203",
    "snippet": "static __always_inline unsigned long memory_is_nonzero(const void *start,\n\t\t\t\t\t\tconst void *end)\n{\n\tunsigned int words;\n\tunsigned long ret;\n\tunsigned int prefix = (unsigned long)start % 8;\n\n\tif (end - start <= 16)\n\t\treturn bytes_is_nonzero(start, end - start);\n\n\tif (prefix) {\n\t\tprefix = 8 - prefix;\n\t\tret = bytes_is_nonzero(start, prefix);\n\t\tif (unlikely(ret))\n\t\t\treturn ret;\n\t\tstart += prefix;\n\t}\n\n\twords = (end - start) / 8;\n\twhile (words) {\n\t\tif (unlikely(*(u64 *)start))\n\t\t\treturn bytes_is_nonzero(start, 8);\n\t\tstart += 8;\n\t\twords--;\n\t}\n\n\treturn bytes_is_nonzero(start, (end - start) % 8);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bytes_is_nonzero",
          "args": [
            "start",
            "(end - start) % 8"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "bytes_is_nonzero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "163-174",
          "snippet": "static __always_inline unsigned long bytes_is_nonzero(const u8 *start,\n\t\t\t\t\tsize_t size)\n{\n\twhile (size) {\n\t\tif (unlikely(*start))\n\t\t\treturn (unsigned long)start;\n\t\tstart++;\n\t\tsize--;\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic __always_inline unsigned long bytes_is_nonzero(const u8 *start,\n\t\t\t\t\tsize_t size)\n{\n\twhile (size) {\n\t\tif (unlikely(*start))\n\t\t\treturn (unsigned long)start;\n\t\tstart++;\n\t\tsize--;\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "*(u64 *)start"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "ret"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic __always_inline unsigned long memory_is_nonzero(const void *start,\n\t\t\t\t\t\tconst void *end)\n{\n\tunsigned int words;\n\tunsigned long ret;\n\tunsigned int prefix = (unsigned long)start % 8;\n\n\tif (end - start <= 16)\n\t\treturn bytes_is_nonzero(start, end - start);\n\n\tif (prefix) {\n\t\tprefix = 8 - prefix;\n\t\tret = bytes_is_nonzero(start, prefix);\n\t\tif (unlikely(ret))\n\t\t\treturn ret;\n\t\tstart += prefix;\n\t}\n\n\twords = (end - start) / 8;\n\twhile (words) {\n\t\tif (unlikely(*(u64 *)start))\n\t\t\treturn bytes_is_nonzero(start, 8);\n\t\tstart += 8;\n\t\twords--;\n\t}\n\n\treturn bytes_is_nonzero(start, (end - start) % 8);\n}"
  },
  {
    "function_name": "bytes_is_nonzero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "163-174",
    "snippet": "static __always_inline unsigned long bytes_is_nonzero(const u8 *start,\n\t\t\t\t\tsize_t size)\n{\n\twhile (size) {\n\t\tif (unlikely(*start))\n\t\t\treturn (unsigned long)start;\n\t\tstart++;\n\t\tsize--;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "*start"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic __always_inline unsigned long bytes_is_nonzero(const u8 *start,\n\t\t\t\t\tsize_t size)\n{\n\twhile (size) {\n\t\tif (unlikely(*start))\n\t\t\treturn (unsigned long)start;\n\t\tstart++;\n\t\tsize--;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "memory_is_poisoned_16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "152-161",
    "snippet": "static __always_inline bool memory_is_poisoned_16(unsigned long addr)\n{\n\tu16 *shadow_addr = (u16 *)kasan_mem_to_shadow((void *)addr);\n\n\t/* Unaligned 16-bytes access maps into 3 shadow bytes. */\n\tif (unlikely(!IS_ALIGNED(addr, KASAN_SHADOW_SCALE_SIZE)))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + 15);\n\n\treturn *shadow_addr;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_is_poisoned_1",
          "args": [
            "addr + 15"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "memory_is_poisoned_16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "152-161",
          "snippet": "static __always_inline bool memory_is_poisoned_16(unsigned long addr)\n{\n\tu16 *shadow_addr = (u16 *)kasan_mem_to_shadow((void *)addr);\n\n\t/* Unaligned 16-bytes access maps into 3 shadow bytes. */\n\tif (unlikely(!IS_ALIGNED(addr, KASAN_SHADOW_SCALE_SIZE)))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + 15);\n\n\treturn *shadow_addr;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!IS_ALIGNED(addr, KASAN_SHADOW_SCALE_SIZE)"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ALIGNED",
          "args": [
            "addr",
            "KASAN_SHADOW_SCALE_SIZE"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "(void *)addr"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic __always_inline bool memory_is_poisoned_16(unsigned long addr)\n{\n\tu16 *shadow_addr = (u16 *)kasan_mem_to_shadow((void *)addr);\n\n\t/* Unaligned 16-bytes access maps into 3 shadow bytes. */\n\tif (unlikely(!IS_ALIGNED(addr, KASAN_SHADOW_SCALE_SIZE)))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + 15);\n\n\treturn *shadow_addr;\n}"
  },
  {
    "function_name": "memory_is_poisoned_2_4_8",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "137-150",
    "snippet": "static __always_inline bool memory_is_poisoned_2_4_8(unsigned long addr,\n\t\t\t\t\t\tunsigned long size)\n{\n\tu8 *shadow_addr = (u8 *)kasan_mem_to_shadow((void *)addr);\n\n\t/*\n\t * Access crosses 8(shadow size)-byte boundary. Such access maps\n\t * into 2 shadow bytes, so we need to check them both.\n\t */\n\tif (unlikely(((addr + size - 1) & KASAN_SHADOW_MASK) < size - 1))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + size - 1);\n\n\treturn memory_is_poisoned_1(addr + size - 1);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memory_is_poisoned_1",
          "args": [
            "addr + size - 1"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "memory_is_poisoned_16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "152-161",
          "snippet": "static __always_inline bool memory_is_poisoned_16(unsigned long addr)\n{\n\tu16 *shadow_addr = (u16 *)kasan_mem_to_shadow((void *)addr);\n\n\t/* Unaligned 16-bytes access maps into 3 shadow bytes. */\n\tif (unlikely(!IS_ALIGNED(addr, KASAN_SHADOW_SCALE_SIZE)))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + 15);\n\n\treturn *shadow_addr;\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic __always_inline bool memory_is_poisoned_16(unsigned long addr)\n{\n\tu16 *shadow_addr = (u16 *)kasan_mem_to_shadow((void *)addr);\n\n\t/* Unaligned 16-bytes access maps into 3 shadow bytes. */\n\tif (unlikely(!IS_ALIGNED(addr, KASAN_SHADOW_SCALE_SIZE)))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + 15);\n\n\treturn *shadow_addr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "((addr + size - 1) & KASAN_SHADOW_MASK) < size - 1"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "(void *)addr"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic __always_inline bool memory_is_poisoned_2_4_8(unsigned long addr,\n\t\t\t\t\t\tunsigned long size)\n{\n\tu8 *shadow_addr = (u8 *)kasan_mem_to_shadow((void *)addr);\n\n\t/*\n\t * Access crosses 8(shadow size)-byte boundary. Such access maps\n\t * into 2 shadow bytes, so we need to check them both.\n\t */\n\tif (unlikely(((addr + size - 1) & KASAN_SHADOW_MASK) < size - 1))\n\t\treturn *shadow_addr || memory_is_poisoned_1(addr + size - 1);\n\n\treturn memory_is_poisoned_1(addr + size - 1);\n}"
  },
  {
    "function_name": "memory_is_poisoned_1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "125-135",
    "snippet": "static __always_inline bool memory_is_poisoned_1(unsigned long addr)\n{\n\ts8 shadow_value = *(s8 *)kasan_mem_to_shadow((void *)addr);\n\n\tif (unlikely(shadow_value)) {\n\t\ts8 last_accessible_byte = addr & KASAN_SHADOW_MASK;\n\t\treturn unlikely(last_accessible_byte >= shadow_value);\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "last_accessible_byte >= shadow_value"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "shadow_value"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "(void *)addr"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nstatic __always_inline bool memory_is_poisoned_1(unsigned long addr)\n{\n\ts8 shadow_value = *(s8 *)kasan_mem_to_shadow((void *)addr);\n\n\tif (unlikely(shadow_value)) {\n\t\ts8 last_accessible_byte = addr & KASAN_SHADOW_MASK;\n\t\treturn unlikely(last_accessible_byte >= shadow_value);\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "kasan_unpoison_stack_above_sp_to",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "109-117",
    "snippet": "void kasan_unpoison_stack_above_sp_to(const void *watermark)\n{\n\tconst void *sp = __builtin_frame_address(0);\n\tsize_t size = watermark - sp;\n\n\tif (WARN_ON(sp > watermark))\n\t\treturn;\n\tkasan_unpoison_shadow(sp, size);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "sp",
            "size"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "sp > watermark"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__builtin_frame_address",
          "args": [
            "0"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_stack_above_sp_to(const void *watermark)\n{\n\tconst void *sp = __builtin_frame_address(0);\n\tsize_t size = watermark - sp;\n\n\tif (WARN_ON(sp > watermark))\n\t\treturn;\n\tkasan_unpoison_shadow(sp, size);\n}"
  },
  {
    "function_name": "kasan_unpoison_task_stack_below",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "92-102",
    "snippet": "asmlinkage void kasan_unpoison_task_stack_below(const void *watermark)\n{\n\t/*\n\t * Calculate the task stack base address.  Avoid using 'current'\n\t * because this function is called by early resume code which hasn't\n\t * yet set up the percpu register (%gs).\n\t */\n\tvoid *base = (void *)((unsigned long)watermark & ~(THREAD_SIZE - 1));\n\n\tkasan_unpoison_shadow(base, watermark - base);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "base",
            "watermark - base"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nasmlinkage void kasan_unpoison_task_stack_below(const void *watermark)\n{\n\t/*\n\t * Calculate the task stack base address.  Avoid using 'current'\n\t * because this function is called by early resume code which hasn't\n\t * yet set up the percpu register (%gs).\n\t */\n\tvoid *base = (void *)((unsigned long)watermark & ~(THREAD_SIZE - 1));\n\n\tkasan_unpoison_shadow(base, watermark - base);\n}"
  },
  {
    "function_name": "kasan_unpoison_task_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "86-89",
    "snippet": "void kasan_unpoison_task_stack(struct task_struct *task)\n{\n\t__kasan_unpoison_stack(task, task_stack_page(task) + THREAD_SIZE);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__kasan_unpoison_stack",
          "args": [
            "task",
            "task_stack_page(task) + THREAD_SIZE"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "__kasan_unpoison_stack",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "77-83",
          "snippet": "static void __kasan_unpoison_stack(struct task_struct *task, const void *sp)\n{\n\tvoid *base = task_stack_page(task);\n\tsize_t size = sp - base;\n\n\tkasan_unpoison_shadow(base, size);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void __kasan_unpoison_stack(struct task_struct *task, const void *sp)\n{\n\tvoid *base = task_stack_page(task);\n\tsize_t size = sp - base;\n\n\tkasan_unpoison_shadow(base, size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_stack_page",
          "args": [
            "task"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_unpoison_task_stack(struct task_struct *task)\n{\n\t__kasan_unpoison_stack(task, task_stack_page(task) + THREAD_SIZE);\n}"
  },
  {
    "function_name": "__kasan_unpoison_stack",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "77-83",
    "snippet": "static void __kasan_unpoison_stack(struct task_struct *task, const void *sp)\n{\n\tvoid *base = task_stack_page(task);\n\tsize_t size = sp - base;\n\n\tkasan_unpoison_shadow(base, size);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_unpoison_shadow",
          "args": [
            "base",
            "size"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_unpoison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "67-75",
          "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "task_stack_page",
          "args": [
            "task"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void __kasan_unpoison_stack(struct task_struct *task, const void *sp)\n{\n\tvoid *base = task_stack_page(task);\n\tsize_t size = sp - base;\n\n\tkasan_unpoison_shadow(base, size);\n}"
  },
  {
    "function_name": "kasan_unpoison_shadow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "67-75",
    "snippet": "void kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "address + size"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_poison_shadow",
          "args": [
            "address",
            "size",
            "0"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "kasan_poison_shadow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "57-65",
          "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid kasan_unpoison_shadow(const void *address, size_t size)\n{\n\tkasan_poison_shadow(address, size, 0);\n\n\tif (size & KASAN_SHADOW_MASK) {\n\t\tu8 *shadow = (u8 *)kasan_mem_to_shadow(address + size);\n\t\t*shadow = size & KASAN_SHADOW_MASK;\n\t}\n}"
  },
  {
    "function_name": "kasan_poison_shadow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "57-65",
    "snippet": "static void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
      "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "shadow_start",
            "value",
            "shadow_end - shadow_start"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "memset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "283-288",
          "snippet": "void *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memset(void *addr, int c, size_t len)\n{\n\tcheck_memory_region((unsigned long)addr, len, true, _RET_IP_);\n\n\treturn __memset(addr, c, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "address + size"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasan_mem_to_shadow",
          "args": [
            "address"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nstatic void kasan_poison_shadow(const void *address, size_t size, u8 value)\n{\n\tvoid *shadow_start, *shadow_end;\n\n\tshadow_start = kasan_mem_to_shadow(address);\n\tshadow_end = kasan_mem_to_shadow(address + size);\n\n\tmemset(shadow_start, value, shadow_end - shadow_start);\n}"
  },
  {
    "function_name": "kasan_disable_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "48-51",
    "snippet": "void kasan_disable_current(void)\n{\n\tcurrent->kasan_depth--;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_disable_current(void)\n{\n\tcurrent->kasan_depth--;\n}"
  },
  {
    "function_name": "kasan_enable_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
    "lines": "43-46",
    "snippet": "void kasan_enable_current(void)\n{\n\tcurrent->kasan_depth++;\n}",
    "includes": [
      "#include \"../slab.h\"",
      "#include \"kasan.h\"",
      "#include <linux/bug.h>",
      "#include <linux/vmalloc.h>",
      "#include <linux/types.h>",
      "#include <linux/string.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched.h>",
      "#include <linux/printk.h>",
      "#include <linux/module.h>",
      "#include <linux/mm.h>",
      "#include <linux/memory.h>",
      "#include <linux/memblock.h>",
      "#include <linux/linkage.h>",
      "#include <linux/kmemleak.h>",
      "#include <linux/kernel.h>",
      "#include <linux/kasan.h>",
      "#include <linux/init.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/export.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\nvoid kasan_enable_current(void)\n{\n\tcurrent->kasan_depth++;\n}"
  }
]