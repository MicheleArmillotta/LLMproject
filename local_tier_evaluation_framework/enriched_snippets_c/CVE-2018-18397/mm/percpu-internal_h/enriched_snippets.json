[
  {
    "function_name": "pcpu_stats_chunk_dealloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "219-221",
    "snippet": "static inline void pcpu_stats_chunk_dealloc(void)\n{\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_chunk_dealloc(void)\n{\n}"
  },
  {
    "function_name": "pcpu_stats_chunk_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "215-217",
    "snippet": "static inline void pcpu_stats_chunk_alloc(void)\n{\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_chunk_alloc(void)\n{\n}"
  },
  {
    "function_name": "pcpu_stats_area_dealloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "211-213",
    "snippet": "static inline void pcpu_stats_area_dealloc(struct pcpu_chunk *chunk)\n{\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_area_dealloc(struct pcpu_chunk *chunk)\n{\n}"
  },
  {
    "function_name": "pcpu_stats_area_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "207-209",
    "snippet": "static inline void pcpu_stats_area_alloc(struct pcpu_chunk *chunk, size_t size)\n{\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_area_alloc(struct pcpu_chunk *chunk, size_t size)\n{\n}"
  },
  {
    "function_name": "pcpu_stats_save_ai",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "203-205",
    "snippet": "static inline void pcpu_stats_save_ai(const struct pcpu_alloc_info *ai)\n{\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_save_ai(const struct pcpu_alloc_info *ai)\n{\n}"
  },
  {
    "function_name": "pcpu_stats_chunk_dealloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "191-199",
    "snippet": "static inline void pcpu_stats_chunk_dealloc(void)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&pcpu_lock, flags);\n\n\tpcpu_stats.nr_chunks--;\n\n\tspin_unlock_irqrestore(&pcpu_lock, flags);\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pcpu_lock",
            "flags"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pcpu_lock",
            "flags"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_chunk_dealloc(void)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&pcpu_lock, flags);\n\n\tpcpu_stats.nr_chunks--;\n\n\tspin_unlock_irqrestore(&pcpu_lock, flags);\n}"
  },
  {
    "function_name": "pcpu_stats_chunk_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "176-186",
    "snippet": "static inline void pcpu_stats_chunk_alloc(void)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&pcpu_lock, flags);\n\n\tpcpu_stats.nr_chunks++;\n\tpcpu_stats.nr_max_chunks =\n\t\tmax(pcpu_stats.nr_max_chunks, pcpu_stats.nr_chunks);\n\n\tspin_unlock_irqrestore(&pcpu_lock, flags);\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&pcpu_lock",
            "flags"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "pcpu_stats.nr_max_chunks",
            "pcpu_stats.nr_chunks"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "wb_max_pause",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "1418-1435",
          "snippet": "static unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_PAUSE\t\tmax(HZ/5, 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define MAX_PAUSE\t\tmax(HZ/5, 1)\n\nstatic unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&pcpu_lock",
            "flags"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_chunk_alloc(void)\n{\n\tunsigned long flags;\n\tspin_lock_irqsave(&pcpu_lock, flags);\n\n\tpcpu_stats.nr_chunks++;\n\tpcpu_stats.nr_max_chunks =\n\t\tmax(pcpu_stats.nr_max_chunks, pcpu_stats.nr_chunks);\n\n\tspin_unlock_irqrestore(&pcpu_lock, flags);\n}"
  },
  {
    "function_name": "pcpu_stats_area_dealloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "163-171",
    "snippet": "static inline void pcpu_stats_area_dealloc(struct pcpu_chunk *chunk)\n{\n\tlockdep_assert_held(&pcpu_lock);\n\n\tpcpu_stats.nr_dealloc++;\n\tpcpu_stats.nr_cur_alloc--;\n\n\tchunk->nr_alloc--;\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&pcpu_lock"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_area_dealloc(struct pcpu_chunk *chunk)\n{\n\tlockdep_assert_held(&pcpu_lock);\n\n\tpcpu_stats.nr_dealloc++;\n\tpcpu_stats.nr_cur_alloc--;\n\n\tchunk->nr_alloc--;\n}"
  },
  {
    "function_name": "pcpu_stats_area_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "139-154",
    "snippet": "static inline void pcpu_stats_area_alloc(struct pcpu_chunk *chunk, size_t size)\n{\n\tlockdep_assert_held(&pcpu_lock);\n\n\tpcpu_stats.nr_alloc++;\n\tpcpu_stats.nr_cur_alloc++;\n\tpcpu_stats.nr_max_alloc =\n\t\tmax(pcpu_stats.nr_max_alloc, pcpu_stats.nr_cur_alloc);\n\tpcpu_stats.min_alloc_size =\n\t\tmin(pcpu_stats.min_alloc_size, size);\n\tpcpu_stats.max_alloc_size =\n\t\tmax(pcpu_stats.max_alloc_size, size);\n\n\tchunk->nr_alloc++;\n\tchunk->max_alloc_size = max(chunk->max_alloc_size, size);\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "max",
          "args": [
            "chunk->max_alloc_size",
            "size"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "wb_max_pause",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page-writeback.c",
          "lines": "1418-1435",
          "snippet": "static unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <trace/events/writeback.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/timer.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/buffer_head.h> /* __set_page_dirty_buffers */",
            "#include <linux/syscalls.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/smp.h>",
            "#include <linux/percpu.h>",
            "#include <linux/rmap.h>",
            "#include <linux/mpage.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/init.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_PAUSE\t\tmax(HZ/5, 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <trace/events/writeback.h>\n#include <linux/mm_inline.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/timer.h>\n#include <linux/pagevec.h>\n#include <linux/buffer_head.h> /* __set_page_dirty_buffers */\n#include <linux/syscalls.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/smp.h>\n#include <linux/percpu.h>\n#include <linux/rmap.h>\n#include <linux/mpage.h>\n#include <linux/blkdev.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/backing-dev.h>\n#include <linux/init.h>\n#include <linux/writeback.h>\n#include <linux/pagemap.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/spinlock.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n\n#define MAX_PAUSE\t\tmax(HZ/5, 1)\n\nstatic unsigned long wb_max_pause(struct bdi_writeback *wb,\n\t\t\t\t  unsigned long wb_dirty)\n{\n\tunsigned long bw = wb->avg_write_bandwidth;\n\tunsigned long t;\n\n\t/*\n\t * Limit pause time for small memory systems. If sleeping for too long\n\t * time, a small pool of dirty/writeback pages may go empty and disk go\n\t * idle.\n\t *\n\t * 8 serves as the safety ratio.\n\t */\n\tt = wb_dirty / (1 + bw / roundup_pow_of_two(1 + HZ / 8));\n\tt++;\n\n\treturn min_t(unsigned long, t, MAX_PAUSE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "min",
          "args": [
            "pcpu_stats.min_alloc_size",
            "size"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "si_meminfo_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "4761-4790",
          "snippet": "void si_meminfo_node(struct sysinfo *val, int nid)\n{\n\tint zone_type;\t\t/* needs to be signed */\n\tunsigned long managed_pages = 0;\n\tunsigned long managed_highpages = 0;\n\tunsigned long free_highpages = 0;\n\tpg_data_t *pgdat = NODE_DATA(nid);\n\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++)\n\t\tmanaged_pages += pgdat->node_zones[zone_type].managed_pages;\n\tval->totalram = managed_pages;\n\tval->sharedram = node_page_state(pgdat, NR_SHMEM);\n\tval->freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);\n#ifdef CONFIG_HIGHMEM\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++) {\n\t\tstruct zone *zone = &pgdat->node_zones[zone_type];\n\n\t\tif (is_highmem(zone)) {\n\t\t\tmanaged_highpages += zone->managed_pages;\n\t\t\tfree_highpages += zone_page_state(zone, NR_FREE_PAGES);\n\t\t}\n\t}\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#else\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#endif\n\tval->mem_unit = PAGE_SIZE;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nvoid si_meminfo_node(struct sysinfo *val, int nid)\n{\n\tint zone_type;\t\t/* needs to be signed */\n\tunsigned long managed_pages = 0;\n\tunsigned long managed_highpages = 0;\n\tunsigned long free_highpages = 0;\n\tpg_data_t *pgdat = NODE_DATA(nid);\n\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++)\n\t\tmanaged_pages += pgdat->node_zones[zone_type].managed_pages;\n\tval->totalram = managed_pages;\n\tval->sharedram = node_page_state(pgdat, NR_SHMEM);\n\tval->freeram = sum_zone_node_page_state(nid, NR_FREE_PAGES);\n#ifdef CONFIG_HIGHMEM\n\tfor (zone_type = 0; zone_type < MAX_NR_ZONES; zone_type++) {\n\t\tstruct zone *zone = &pgdat->node_zones[zone_type];\n\n\t\tif (is_highmem(zone)) {\n\t\t\tmanaged_highpages += zone->managed_pages;\n\t\t\tfree_highpages += zone_page_state(zone, NR_FREE_PAGES);\n\t\t}\n\t}\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#else\n\tval->totalhigh = managed_highpages;\n\tval->freehigh = free_highpages;\n#endif\n\tval->mem_unit = PAGE_SIZE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&pcpu_lock"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_area_alloc(struct pcpu_chunk *chunk, size_t size)\n{\n\tlockdep_assert_held(&pcpu_lock);\n\n\tpcpu_stats.nr_alloc++;\n\tpcpu_stats.nr_cur_alloc++;\n\tpcpu_stats.nr_max_alloc =\n\t\tmax(pcpu_stats.nr_max_alloc, pcpu_stats.nr_cur_alloc);\n\tpcpu_stats.min_alloc_size =\n\t\tmin(pcpu_stats.min_alloc_size, size);\n\tpcpu_stats.max_alloc_size =\n\t\tmax(pcpu_stats.max_alloc_size, size);\n\n\tchunk->nr_alloc++;\n\tchunk->max_alloc_size = max(chunk->max_alloc_size, size);\n}"
  },
  {
    "function_name": "pcpu_stats_save_ai",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "123-129",
    "snippet": "static inline void pcpu_stats_save_ai(const struct pcpu_alloc_info *ai)\n{\n\tmemcpy(&pcpu_stats_ai, ai, sizeof(struct pcpu_alloc_info));\n\n\t/* initialize min_alloc_size to unit_size */\n\tpcpu_stats.min_alloc_size = pcpu_stats_ai.unit_size;\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&pcpu_stats_ai",
            "ai",
            "sizeof(struct pcpu_alloc_info)"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline void pcpu_stats_save_ai(const struct pcpu_alloc_info *ai)\n{\n\tmemcpy(&pcpu_stats_ai, ai, sizeof(struct pcpu_alloc_info));\n\n\t/* initialize min_alloc_size to unit_size */\n\tpcpu_stats.min_alloc_size = pcpu_stats_ai.unit_size;\n}"
  },
  {
    "function_name": "pcpu_chunk_map_bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "97-100",
    "snippet": "static inline int pcpu_chunk_map_bits(struct pcpu_chunk *chunk)\n{\n\treturn pcpu_nr_pages_to_map_bits(chunk->nr_pages);\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pcpu_nr_pages_to_map_bits",
          "args": [
            "chunk->nr_pages"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "pcpu_nr_pages_to_map_bits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
          "lines": "85-88",
          "snippet": "static inline int pcpu_nr_pages_to_map_bits(int pages)\n{\n\treturn pages * PAGE_SIZE / PCPU_MIN_ALLOC_SIZE;\n}",
          "includes": [
            "#include <linux/spinlock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline int pcpu_nr_pages_to_map_bits(int pages)\n{\n\treturn pages * PAGE_SIZE / PCPU_MIN_ALLOC_SIZE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline int pcpu_chunk_map_bits(struct pcpu_chunk *chunk)\n{\n\treturn pcpu_nr_pages_to_map_bits(chunk->nr_pages);\n}"
  },
  {
    "function_name": "pcpu_nr_pages_to_map_bits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "85-88",
    "snippet": "static inline int pcpu_nr_pages_to_map_bits(int pages)\n{\n\treturn pages * PAGE_SIZE / PCPU_MIN_ALLOC_SIZE;\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline int pcpu_nr_pages_to_map_bits(int pages)\n{\n\treturn pages * PAGE_SIZE / PCPU_MIN_ALLOC_SIZE;\n}"
  },
  {
    "function_name": "pcpu_chunk_nr_blocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu-internal.h",
    "lines": "73-76",
    "snippet": "static inline int pcpu_chunk_nr_blocks(struct pcpu_chunk *chunk)\n{\n\treturn chunk->nr_pages * PAGE_SIZE / PCPU_BITMAP_BLOCK_SIZE;\n}",
    "includes": [
      "#include <linux/spinlock.h>",
      "#include <linux/percpu.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/spinlock.h>\n#include <linux/percpu.h>\n#include <linux/types.h>\n\nstatic inline int pcpu_chunk_nr_blocks(struct pcpu_chunk *chunk)\n{\n\treturn chunk->nr_pages * PAGE_SIZE / PCPU_BITMAP_BLOCK_SIZE;\n}"
  }
]