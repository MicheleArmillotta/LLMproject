[
  {
    "function_name": "init_zswap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1308-1359",
    "snippet": "static int __init init_zswap(void)\n{\n\tstruct zswap_pool *pool;\n\tint ret;\n\n\tzswap_init_started = true;\n\n\tif (zswap_entry_cache_create()) {\n\t\tpr_err(\"entry cache creation failed\\n\");\n\t\tgoto cache_fail;\n\t}\n\n\tret = cpuhp_setup_state(CPUHP_MM_ZSWP_MEM_PREPARE, \"mm/zswap:prepare\",\n\t\t\t\tzswap_dstmem_prepare, zswap_dstmem_dead);\n\tif (ret) {\n\t\tpr_err(\"dstmem alloc failed\\n\");\n\t\tgoto dstmem_fail;\n\t}\n\n\tret = cpuhp_setup_state_multi(CPUHP_MM_ZSWP_POOL_PREPARE,\n\t\t\t\t      \"mm/zswap_pool:prepare\",\n\t\t\t\t      zswap_cpu_comp_prepare,\n\t\t\t\t      zswap_cpu_comp_dead);\n\tif (ret)\n\t\tgoto hp_fail;\n\n\tpool = __zswap_pool_create_fallback();\n\tif (pool) {\n\t\tpr_info(\"loaded using pool %s/%s\\n\", pool->tfm_name,\n\t\t\tzpool_get_type(pool->zpool));\n\t\tlist_add(&pool->list, &zswap_pools);\n\t\tzswap_has_pool = true;\n\t} else {\n\t\tpr_err(\"pool creation failed\\n\");\n\t\tzswap_enabled = false;\n\t}\n\n\tfrontswap_register_ops(&zswap_frontswap_ops);\n\tif (zswap_debugfs_init())\n\t\tpr_warn(\"debugfs initialization failed\\n\");\n\treturn 0;\n\nhp_fail:\n\tcpuhp_remove_state(CPUHP_MM_ZSWP_MEM_PREPARE);\ndstmem_fail:\n\tzswap_entry_cache_destroy();\ncache_fail:\n\t/* if built-in, we aren't unloaded on failure; don't allow use */\n\tzswap_init_failed = true;\n\tzswap_enabled = false;\n\treturn -ENOMEM;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool zswap_enabled;",
      "static LIST_HEAD(zswap_pools);",
      "static bool zswap_init_started;",
      "static bool zswap_init_failed;",
      "static bool zswap_has_pool;",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct",
      "static struct frontswap_ops zswap_frontswap_ops = {\n\t.store = zswap_frontswap_store,\n\t.load = zswap_frontswap_load,\n\t.invalidate_page = zswap_frontswap_invalidate_page,\n\t.invalidate_area = zswap_frontswap_invalidate_area,\n\t.init = zswap_frontswap_init\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_entry_cache_destroy",
          "args": [],
          "line": 1353
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_cache_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "252-255",
          "snippet": "static void __init zswap_entry_cache_destroy(void)\n{\n\tkmem_cache_destroy(zswap_entry_cache);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *zswap_entry_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\n\nstatic void __init zswap_entry_cache_destroy(void)\n{\n\tkmem_cache_destroy(zswap_entry_cache);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuhp_remove_state",
          "args": [
            "CPUHP_MM_ZSWP_MEM_PREPARE"
          ],
          "line": 1351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"debugfs initialization failed\\n\""
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_debugfs_init",
          "args": [],
          "line": 1346
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_debugfs_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "1297-1300",
          "snippet": "static int __init zswap_debugfs_init(void)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int __init zswap_debugfs_init(void)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "frontswap_register_ops",
          "args": [
            "&zswap_frontswap_ops"
          ],
          "line": 1345
        },
        "resolved": true,
        "details": {
          "function_name": "frontswap_register_ops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/frontswap.c",
          "lines": "114-167",
          "snippet": "void frontswap_register_ops(struct frontswap_ops *ops)\n{\n\tDECLARE_BITMAP(a, MAX_SWAPFILES);\n\tDECLARE_BITMAP(b, MAX_SWAPFILES);\n\tstruct swap_info_struct *si;\n\tunsigned int i;\n\n\tbitmap_zero(a, MAX_SWAPFILES);\n\tbitmap_zero(b, MAX_SWAPFILES);\n\n\tspin_lock(&swap_lock);\n\tplist_for_each_entry(si, &swap_active_head, list) {\n\t\tif (!WARN_ON(!si->frontswap_map))\n\t\t\tset_bit(si->type, a);\n\t}\n\tspin_unlock(&swap_lock);\n\n\t/* the new ops needs to know the currently active swap devices */\n\tfor_each_set_bit(i, a, MAX_SWAPFILES)\n\t\tops->init(i);\n\n\t/*\n\t * Setting frontswap_ops must happen after the ops->init() calls\n\t * above; cmpxchg implies smp_mb() which will ensure the init is\n\t * complete at this point.\n\t */\n\tdo {\n\t\tops->next = frontswap_ops;\n\t} while (cmpxchg(&frontswap_ops, ops->next, ops) != ops->next);\n\n\tstatic_branch_inc(&frontswap_enabled_key);\n\n\tspin_lock(&swap_lock);\n\tplist_for_each_entry(si, &swap_active_head, list) {\n\t\tif (si->frontswap_map)\n\t\t\tset_bit(si->type, b);\n\t}\n\tspin_unlock(&swap_lock);\n\n\t/*\n\t * On the very unlikely chance that a swap device was added or\n\t * removed between setting the \"a\" list bits and the ops init\n\t * calls, we re-check and do init or invalidate for any changed\n\t * bits.\n\t */\n\tif (unlikely(!bitmap_equal(a, b, MAX_SWAPFILES))) {\n\t\tfor (i = 0; i < MAX_SWAPFILES; i++) {\n\t\t\tif (!test_bit(i, a) && test_bit(i, b))\n\t\t\t\tops->init(i);\n\t\t\telse if (test_bit(i, a) && !test_bit(i, b))\n\t\t\t\tops->invalidate_area(i);\n\t\t}\n\t}\n}",
          "includes": [
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/module.h>",
            "#include <linux/security.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/mman.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct frontswap_ops *frontswap_ops"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/debugfs.h>\n#include <linux/module.h>\n#include <linux/security.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/mman.h>\n\nstatic struct frontswap_ops *frontswap_ops;\n\nvoid frontswap_register_ops(struct frontswap_ops *ops)\n{\n\tDECLARE_BITMAP(a, MAX_SWAPFILES);\n\tDECLARE_BITMAP(b, MAX_SWAPFILES);\n\tstruct swap_info_struct *si;\n\tunsigned int i;\n\n\tbitmap_zero(a, MAX_SWAPFILES);\n\tbitmap_zero(b, MAX_SWAPFILES);\n\n\tspin_lock(&swap_lock);\n\tplist_for_each_entry(si, &swap_active_head, list) {\n\t\tif (!WARN_ON(!si->frontswap_map))\n\t\t\tset_bit(si->type, a);\n\t}\n\tspin_unlock(&swap_lock);\n\n\t/* the new ops needs to know the currently active swap devices */\n\tfor_each_set_bit(i, a, MAX_SWAPFILES)\n\t\tops->init(i);\n\n\t/*\n\t * Setting frontswap_ops must happen after the ops->init() calls\n\t * above; cmpxchg implies smp_mb() which will ensure the init is\n\t * complete at this point.\n\t */\n\tdo {\n\t\tops->next = frontswap_ops;\n\t} while (cmpxchg(&frontswap_ops, ops->next, ops) != ops->next);\n\n\tstatic_branch_inc(&frontswap_enabled_key);\n\n\tspin_lock(&swap_lock);\n\tplist_for_each_entry(si, &swap_active_head, list) {\n\t\tif (si->frontswap_map)\n\t\t\tset_bit(si->type, b);\n\t}\n\tspin_unlock(&swap_lock);\n\n\t/*\n\t * On the very unlikely chance that a swap device was added or\n\t * removed between setting the \"a\" list bits and the ops init\n\t * calls, we re-check and do init or invalidate for any changed\n\t * bits.\n\t */\n\tif (unlikely(!bitmap_equal(a, b, MAX_SWAPFILES))) {\n\t\tfor (i = 0; i < MAX_SWAPFILES; i++) {\n\t\t\tif (!test_bit(i, a) && test_bit(i, b))\n\t\t\t\tops->init(i);\n\t\t\telse if (test_bit(i, a) && !test_bit(i, b))\n\t\t\t\tops->invalidate_area(i);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"pool creation failed\\n\""
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add",
          "args": [
            "&pool->list",
            "&zswap_pools"
          ],
          "line": 1338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"loaded using pool %s/%s\\n\"",
            "pool->tfm_name",
            "zpool_get_type(pool->zpool)"
          ],
          "line": 1336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_get_type",
          "args": [
            "pool->zpool"
          ],
          "line": 1337
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_get_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "235-238",
          "snippet": "const char *zpool_get_type(struct zpool *zpool)\n{\n\treturn zpool->driver->type;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nconst char *zpool_get_type(struct zpool *zpool)\n{\n\treturn zpool->driver->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__zswap_pool_create_fallback",
          "args": [],
          "line": 1334
        },
        "resolved": true,
        "details": {
          "function_name": "__zswap_pool_create_fallback",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "576-614",
          "snippet": "zswap_pool *__zswap_pool_create_fallback(void)\n{\n\tbool has_comp, has_zpool;\n\n\thas_comp = crypto_has_comp(zswap_compressor, 0, 0);\n\tif (!has_comp && strcmp(zswap_compressor, ZSWAP_COMPRESSOR_DEFAULT)) {\n\t\tpr_err(\"compressor %s not available, using default %s\\n\",\n\t\t       zswap_compressor, ZSWAP_COMPRESSOR_DEFAULT);\n\t\tparam_free_charp(&zswap_compressor);\n\t\tzswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;\n\t\thas_comp = crypto_has_comp(zswap_compressor, 0, 0);\n\t}\n\tif (!has_comp) {\n\t\tpr_err(\"default compressor %s not available\\n\",\n\t\t       zswap_compressor);\n\t\tparam_free_charp(&zswap_compressor);\n\t\tzswap_compressor = ZSWAP_PARAM_UNSET;\n\t}\n\n\thas_zpool = zpool_has_pool(zswap_zpool_type);\n\tif (!has_zpool && strcmp(zswap_zpool_type, ZSWAP_ZPOOL_DEFAULT)) {\n\t\tpr_err(\"zpool %s not available, using default %s\\n\",\n\t\t       zswap_zpool_type, ZSWAP_ZPOOL_DEFAULT);\n\t\tparam_free_charp(&zswap_zpool_type);\n\t\tzswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;\n\t\thas_zpool = zpool_has_pool(zswap_zpool_type);\n\t}\n\tif (!has_zpool) {\n\t\tpr_err(\"default zpool %s not available\\n\",\n\t\t       zswap_zpool_type);\n\t\tparam_free_charp(&zswap_zpool_type);\n\t\tzswap_zpool_type = ZSWAP_PARAM_UNSET;\n\t}\n\n\tif (!has_comp || !has_zpool)\n\t\treturn NULL;\n\n\treturn zswap_pool_create(zswap_zpool_type, zswap_compressor);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSWAP_ZPOOL_DEFAULT \"zbud\"",
            "#define ZSWAP_COMPRESSOR_DEFAULT \"lzo\"",
            "#define ZSWAP_PARAM_UNSET \"\""
          ],
          "globals_used": [
            "static char *zswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;",
            "static char *zswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\n#define ZSWAP_ZPOOL_DEFAULT \"zbud\"\n#define ZSWAP_COMPRESSOR_DEFAULT \"lzo\"\n#define ZSWAP_PARAM_UNSET \"\"\n\nstatic char *zswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;\nstatic char *zswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;\n\nzswap_pool *__zswap_pool_create_fallback(void)\n{\n\tbool has_comp, has_zpool;\n\n\thas_comp = crypto_has_comp(zswap_compressor, 0, 0);\n\tif (!has_comp && strcmp(zswap_compressor, ZSWAP_COMPRESSOR_DEFAULT)) {\n\t\tpr_err(\"compressor %s not available, using default %s\\n\",\n\t\t       zswap_compressor, ZSWAP_COMPRESSOR_DEFAULT);\n\t\tparam_free_charp(&zswap_compressor);\n\t\tzswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;\n\t\thas_comp = crypto_has_comp(zswap_compressor, 0, 0);\n\t}\n\tif (!has_comp) {\n\t\tpr_err(\"default compressor %s not available\\n\",\n\t\t       zswap_compressor);\n\t\tparam_free_charp(&zswap_compressor);\n\t\tzswap_compressor = ZSWAP_PARAM_UNSET;\n\t}\n\n\thas_zpool = zpool_has_pool(zswap_zpool_type);\n\tif (!has_zpool && strcmp(zswap_zpool_type, ZSWAP_ZPOOL_DEFAULT)) {\n\t\tpr_err(\"zpool %s not available, using default %s\\n\",\n\t\t       zswap_zpool_type, ZSWAP_ZPOOL_DEFAULT);\n\t\tparam_free_charp(&zswap_zpool_type);\n\t\tzswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;\n\t\thas_zpool = zpool_has_pool(zswap_zpool_type);\n\t}\n\tif (!has_zpool) {\n\t\tpr_err(\"default zpool %s not available\\n\",\n\t\t       zswap_zpool_type);\n\t\tparam_free_charp(&zswap_zpool_type);\n\t\tzswap_zpool_type = ZSWAP_PARAM_UNSET;\n\t}\n\n\tif (!has_comp || !has_zpool)\n\t\treturn NULL;\n\n\treturn zswap_pool_create(zswap_zpool_type, zswap_compressor);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuhp_setup_state_multi",
          "args": [
            "CPUHP_MM_ZSWP_POOL_PREPARE",
            "\"mm/zswap_pool:prepare\"",
            "zswap_cpu_comp_prepare",
            "zswap_cpu_comp_dead"
          ],
          "line": 1327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"dstmem alloc failed\\n\""
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpuhp_setup_state",
          "args": [
            "CPUHP_MM_ZSWP_MEM_PREPARE",
            "\"mm/zswap:prepare\"",
            "zswap_dstmem_prepare",
            "zswap_dstmem_dead"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"entry cache creation failed\\n\""
          ],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_cache_create",
          "args": [],
          "line": 1315
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_cache_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "246-250",
          "snippet": "static int __init zswap_entry_cache_create(void)\n{\n\tzswap_entry_cache = KMEM_CACHE(zswap_entry, 0);\n\treturn zswap_entry_cache == NULL;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *zswap_entry_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\n\nstatic int __init zswap_entry_cache_create(void)\n{\n\tzswap_entry_cache = KMEM_CACHE(zswap_entry, 0);\n\treturn zswap_entry_cache == NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic bool zswap_enabled;\nstatic LIST_HEAD(zswap_pools);\nstatic bool zswap_init_started;\nstatic bool zswap_init_failed;\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\nstatic struct frontswap_ops zswap_frontswap_ops = {\n\t.store = zswap_frontswap_store,\n\t.load = zswap_frontswap_load,\n\t.invalidate_page = zswap_frontswap_invalidate_page,\n\t.invalidate_area = zswap_frontswap_invalidate_area,\n\t.init = zswap_frontswap_init\n};\n\nstatic int __init init_zswap(void)\n{\n\tstruct zswap_pool *pool;\n\tint ret;\n\n\tzswap_init_started = true;\n\n\tif (zswap_entry_cache_create()) {\n\t\tpr_err(\"entry cache creation failed\\n\");\n\t\tgoto cache_fail;\n\t}\n\n\tret = cpuhp_setup_state(CPUHP_MM_ZSWP_MEM_PREPARE, \"mm/zswap:prepare\",\n\t\t\t\tzswap_dstmem_prepare, zswap_dstmem_dead);\n\tif (ret) {\n\t\tpr_err(\"dstmem alloc failed\\n\");\n\t\tgoto dstmem_fail;\n\t}\n\n\tret = cpuhp_setup_state_multi(CPUHP_MM_ZSWP_POOL_PREPARE,\n\t\t\t\t      \"mm/zswap_pool:prepare\",\n\t\t\t\t      zswap_cpu_comp_prepare,\n\t\t\t\t      zswap_cpu_comp_dead);\n\tif (ret)\n\t\tgoto hp_fail;\n\n\tpool = __zswap_pool_create_fallback();\n\tif (pool) {\n\t\tpr_info(\"loaded using pool %s/%s\\n\", pool->tfm_name,\n\t\t\tzpool_get_type(pool->zpool));\n\t\tlist_add(&pool->list, &zswap_pools);\n\t\tzswap_has_pool = true;\n\t} else {\n\t\tpr_err(\"pool creation failed\\n\");\n\t\tzswap_enabled = false;\n\t}\n\n\tfrontswap_register_ops(&zswap_frontswap_ops);\n\tif (zswap_debugfs_init())\n\t\tpr_warn(\"debugfs initialization failed\\n\");\n\treturn 0;\n\nhp_fail:\n\tcpuhp_remove_state(CPUHP_MM_ZSWP_MEM_PREPARE);\ndstmem_fail:\n\tzswap_entry_cache_destroy();\ncache_fail:\n\t/* if built-in, we aren't unloaded on failure; don't allow use */\n\tzswap_init_failed = true;\n\tzswap_enabled = false;\n\treturn -ENOMEM;\n}"
  },
  {
    "function_name": "zswap_debugfs_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1302-1302",
    "snippet": "static void __exit zswap_debugfs_exit(void) { }",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic void __exit zswap_debugfs_exit(void) { }"
  },
  {
    "function_name": "zswap_debugfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1297-1300",
    "snippet": "static int __init zswap_debugfs_init(void)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int __init zswap_debugfs_init(void)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "zswap_debugfs_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1292-1295",
    "snippet": "static void __exit zswap_debugfs_exit(void)\n{\n\tdebugfs_remove_recursive(zswap_debugfs_root);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_remove_recursive",
          "args": [
            "zswap_debugfs_root"
          ],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic void __exit zswap_debugfs_exit(void)\n{\n\tdebugfs_remove_recursive(zswap_debugfs_root);\n}"
  },
  {
    "function_name": "zswap_debugfs_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1259-1290",
    "snippet": "static int __init zswap_debugfs_init(void)\n{\n\tif (!debugfs_initialized())\n\t\treturn -ENODEV;\n\n\tzswap_debugfs_root = debugfs_create_dir(\"zswap\", NULL);\n\tif (!zswap_debugfs_root)\n\t\treturn -ENOMEM;\n\n\tdebugfs_create_u64(\"pool_limit_hit\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_pool_limit_hit);\n\tdebugfs_create_u64(\"reject_reclaim_fail\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_reject_reclaim_fail);\n\tdebugfs_create_u64(\"reject_alloc_fail\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_reject_alloc_fail);\n\tdebugfs_create_u64(\"reject_kmemcache_fail\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_reject_kmemcache_fail);\n\tdebugfs_create_u64(\"reject_compress_poor\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_reject_compress_poor);\n\tdebugfs_create_u64(\"written_back_pages\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_written_back_pages);\n\tdebugfs_create_u64(\"duplicate_entry\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_duplicate_entry);\n\tdebugfs_create_u64(\"pool_total_size\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_pool_total_size);\n\tdebugfs_create_atomic_t(\"stored_pages\", 0444,\n\t\t\t\tzswap_debugfs_root, &zswap_stored_pages);\n\tdebugfs_create_atomic_t(\"same_filled_pages\", 0444,\n\t\t\t\tzswap_debugfs_root, &zswap_same_filled_pages);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 zswap_pool_total_size;",
      "static atomic_t zswap_stored_pages = ATOMIC_INIT(0);",
      "static atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);",
      "static u64 zswap_pool_limit_hit;",
      "static u64 zswap_written_back_pages;",
      "static u64 zswap_reject_reclaim_fail;",
      "static u64 zswap_reject_compress_poor;",
      "static u64 zswap_reject_alloc_fail;",
      "static u64 zswap_reject_kmemcache_fail;",
      "static u64 zswap_duplicate_entry;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "debugfs_create_atomic_t",
          "args": [
            "\"same_filled_pages\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_same_filled_pages"
          ],
          "line": 1286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_atomic_t",
          "args": [
            "\"stored_pages\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_stored_pages"
          ],
          "line": 1284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"pool_total_size\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_pool_total_size"
          ],
          "line": 1282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"duplicate_entry\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_duplicate_entry"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"written_back_pages\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_written_back_pages"
          ],
          "line": 1278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"reject_compress_poor\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_reject_compress_poor"
          ],
          "line": 1276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"reject_kmemcache_fail\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_reject_kmemcache_fail"
          ],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"reject_alloc_fail\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_reject_alloc_fail"
          ],
          "line": 1272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"reject_reclaim_fail\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_reject_reclaim_fail"
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_u64",
          "args": [
            "\"pool_limit_hit\"",
            "0444",
            "zswap_debugfs_root",
            "&zswap_pool_limit_hit"
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_create_dir",
          "args": [
            "\"zswap\"",
            "NULL"
          ],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debugfs_initialized",
          "args": [],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic u64 zswap_pool_total_size;\nstatic atomic_t zswap_stored_pages = ATOMIC_INIT(0);\nstatic atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);\nstatic u64 zswap_pool_limit_hit;\nstatic u64 zswap_written_back_pages;\nstatic u64 zswap_reject_reclaim_fail;\nstatic u64 zswap_reject_compress_poor;\nstatic u64 zswap_reject_alloc_fail;\nstatic u64 zswap_reject_kmemcache_fail;\nstatic u64 zswap_duplicate_entry;\n\nstatic int __init zswap_debugfs_init(void)\n{\n\tif (!debugfs_initialized())\n\t\treturn -ENODEV;\n\n\tzswap_debugfs_root = debugfs_create_dir(\"zswap\", NULL);\n\tif (!zswap_debugfs_root)\n\t\treturn -ENOMEM;\n\n\tdebugfs_create_u64(\"pool_limit_hit\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_pool_limit_hit);\n\tdebugfs_create_u64(\"reject_reclaim_fail\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_reject_reclaim_fail);\n\tdebugfs_create_u64(\"reject_alloc_fail\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_reject_alloc_fail);\n\tdebugfs_create_u64(\"reject_kmemcache_fail\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_reject_kmemcache_fail);\n\tdebugfs_create_u64(\"reject_compress_poor\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_reject_compress_poor);\n\tdebugfs_create_u64(\"written_back_pages\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_written_back_pages);\n\tdebugfs_create_u64(\"duplicate_entry\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_duplicate_entry);\n\tdebugfs_create_u64(\"pool_total_size\", 0444,\n\t\t\t   zswap_debugfs_root, &zswap_pool_total_size);\n\tdebugfs_create_atomic_t(\"stored_pages\", 0444,\n\t\t\t\tzswap_debugfs_root, &zswap_stored_pages);\n\tdebugfs_create_atomic_t(\"same_filled_pages\", 0444,\n\t\t\t\tzswap_debugfs_root, &zswap_same_filled_pages);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "zswap_frontswap_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1228-1241",
    "snippet": "static void zswap_frontswap_init(unsigned type)\n{\n\tstruct zswap_tree *tree;\n\n\ttree = kzalloc(sizeof(*tree), GFP_KERNEL);\n\tif (!tree) {\n\t\tpr_err(\"alloc failed, zswap disabled for swap type %d\\n\", type);\n\t\treturn;\n\t}\n\n\ttree->rbroot = RB_ROOT;\n\tspin_lock_init(&tree->lock);\n\tzswap_trees[type] = tree;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct zswap_tree *zswap_trees[MAX_SWAPFILES];",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_lock_init",
          "args": [
            "&tree->lock"
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"alloc failed, zswap disabled for swap type %d\\n\"",
            "type"
          ],
          "line": 1234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*tree)",
            "GFP_KERNEL"
          ],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct zswap_tree *zswap_trees[MAX_SWAPFILES];\nstatic __init struct;\n\nstatic void zswap_frontswap_init(unsigned type)\n{\n\tstruct zswap_tree *tree;\n\n\ttree = kzalloc(sizeof(*tree), GFP_KERNEL);\n\tif (!tree) {\n\t\tpr_err(\"alloc failed, zswap disabled for swap type %d\\n\", type);\n\t\treturn;\n\t}\n\n\ttree->rbroot = RB_ROOT;\n\tspin_lock_init(&tree->lock);\n\tzswap_trees[type] = tree;\n}"
  },
  {
    "function_name": "zswap_frontswap_invalidate_area",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1210-1226",
    "snippet": "static void zswap_frontswap_invalidate_area(unsigned type)\n{\n\tstruct zswap_tree *tree = zswap_trees[type];\n\tstruct zswap_entry *entry, *n;\n\n\tif (!tree)\n\t\treturn;\n\n\t/* walk the tree and free everything */\n\tspin_lock(&tree->lock);\n\trbtree_postorder_for_each_entry_safe(entry, n, &tree->rbroot, rbnode)\n\t\tzswap_free_entry(entry);\n\ttree->rbroot = RB_ROOT;\n\tspin_unlock(&tree->lock);\n\tkfree(tree);\n\tzswap_trees[type] = NULL;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct zswap_tree *zswap_trees[MAX_SWAPFILES];",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "tree"
          ],
          "line": 1224
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 1223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_free_entry",
          "args": [
            "entry"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_free_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "332-343",
          "snippet": "static void zswap_free_entry(struct zswap_entry *entry)\n{\n\tif (!entry->length)\n\t\tatomic_dec(&zswap_same_filled_pages);\n\telse {\n\t\tzpool_free(entry->pool->zpool, entry->handle);\n\t\tzswap_pool_put(entry->pool);\n\t}\n\tzswap_entry_cache_free(entry);\n\tatomic_dec(&zswap_stored_pages);\n\tzswap_update_total_size();\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_t zswap_stored_pages = ATOMIC_INIT(0);",
            "static atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);",
            "static int zswap_writeback_entry(struct zpool *pool, unsigned long handle);",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic atomic_t zswap_stored_pages = ATOMIC_INIT(0);\nstatic atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);\nstatic int zswap_writeback_entry(struct zpool *pool, unsigned long handle);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_free_entry(struct zswap_entry *entry)\n{\n\tif (!entry->length)\n\t\tatomic_dec(&zswap_same_filled_pages);\n\telse {\n\t\tzpool_free(entry->pool->zpool, entry->handle);\n\t\tzswap_pool_put(entry->pool);\n\t}\n\tzswap_entry_cache_free(entry);\n\tatomic_dec(&zswap_stored_pages);\n\tzswap_update_total_size();\n}"
        }
      },
      {
        "call_info": {
          "callee": "rbtree_postorder_for_each_entry_safe",
          "args": [
            "entry",
            "n",
            "&tree->rbroot",
            "rbnode"
          ],
          "line": 1220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tree->lock"
          ],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct zswap_tree *zswap_trees[MAX_SWAPFILES];\nstatic __init struct;\n\nstatic void zswap_frontswap_invalidate_area(unsigned type)\n{\n\tstruct zswap_tree *tree = zswap_trees[type];\n\tstruct zswap_entry *entry, *n;\n\n\tif (!tree)\n\t\treturn;\n\n\t/* walk the tree and free everything */\n\tspin_lock(&tree->lock);\n\trbtree_postorder_for_each_entry_safe(entry, n, &tree->rbroot, rbnode)\n\t\tzswap_free_entry(entry);\n\ttree->rbroot = RB_ROOT;\n\tspin_unlock(&tree->lock);\n\tkfree(tree);\n\tzswap_trees[type] = NULL;\n}"
  },
  {
    "function_name": "zswap_frontswap_invalidate_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1186-1207",
    "snippet": "static void zswap_frontswap_invalidate_page(unsigned type, pgoff_t offset)\n{\n\tstruct zswap_tree *tree = zswap_trees[type];\n\tstruct zswap_entry *entry;\n\n\t/* find */\n\tspin_lock(&tree->lock);\n\tentry = zswap_rb_search(&tree->rbroot, offset);\n\tif (!entry) {\n\t\t/* entry was written back */\n\t\tspin_unlock(&tree->lock);\n\t\treturn;\n\t}\n\n\t/* remove from rbtree */\n\tzswap_rb_erase(&tree->rbroot, entry);\n\n\t/* drop the initial reference from entry creation */\n\tzswap_entry_put(tree, entry);\n\n\tspin_unlock(&tree->lock);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct zswap_tree *zswap_trees[MAX_SWAPFILES];",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_put",
          "args": [
            "tree",
            "entry"
          ],
          "line": 1204
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "354-364",
          "snippet": "static void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_rb_erase",
          "args": [
            "&tree->rbroot",
            "entry"
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_rb_erase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "320-326",
          "snippet": "static void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 1196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_rb_search",
          "args": [
            "&tree->rbroot",
            "offset"
          ],
          "line": 1193
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_rb_search",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "276-291",
          "snippet": "static struct zswap_entry *zswap_rb_search(struct rb_root *root, pgoff_t offset)\n{\n\tstruct rb_node *node = root->rb_node;\n\tstruct zswap_entry *entry;\n\n\twhile (node) {\n\t\tentry = rb_entry(node, struct zswap_entry, rbnode);\n\t\tif (entry->offset > offset)\n\t\t\tnode = node->rb_left;\n\t\telse if (entry->offset < offset)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn entry;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_rb_search(struct rb_root *root, pgoff_t offset)\n{\n\tstruct rb_node *node = root->rb_node;\n\tstruct zswap_entry *entry;\n\n\twhile (node) {\n\t\tentry = rb_entry(node, struct zswap_entry, rbnode);\n\t\tif (entry->offset > offset)\n\t\t\tnode = node->rb_left;\n\t\telse if (entry->offset < offset)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn entry;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tree->lock"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct zswap_tree *zswap_trees[MAX_SWAPFILES];\nstatic __init struct;\n\nstatic void zswap_frontswap_invalidate_page(unsigned type, pgoff_t offset)\n{\n\tstruct zswap_tree *tree = zswap_trees[type];\n\tstruct zswap_entry *entry;\n\n\t/* find */\n\tspin_lock(&tree->lock);\n\tentry = zswap_rb_search(&tree->rbroot, offset);\n\tif (!entry) {\n\t\t/* entry was written back */\n\t\tspin_unlock(&tree->lock);\n\t\treturn;\n\t}\n\n\t/* remove from rbtree */\n\tzswap_rb_erase(&tree->rbroot, entry);\n\n\t/* drop the initial reference from entry creation */\n\tzswap_entry_put(tree, entry);\n\n\tspin_unlock(&tree->lock);\n}"
  },
  {
    "function_name": "zswap_frontswap_load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "1137-1183",
    "snippet": "static int zswap_frontswap_load(unsigned type, pgoff_t offset,\n\t\t\t\tstruct page *page)\n{\n\tstruct zswap_tree *tree = zswap_trees[type];\n\tstruct zswap_entry *entry;\n\tstruct crypto_comp *tfm;\n\tu8 *src, *dst;\n\tunsigned int dlen;\n\tint ret;\n\n\t/* find */\n\tspin_lock(&tree->lock);\n\tentry = zswap_entry_find_get(&tree->rbroot, offset);\n\tif (!entry) {\n\t\t/* entry was written back */\n\t\tspin_unlock(&tree->lock);\n\t\treturn -1;\n\t}\n\tspin_unlock(&tree->lock);\n\n\tif (!entry->length) {\n\t\tdst = kmap_atomic(page);\n\t\tzswap_fill_page(dst, entry->value);\n\t\tkunmap_atomic(dst);\n\t\tgoto freeentry;\n\t}\n\n\t/* decompress */\n\tdlen = PAGE_SIZE;\n\tsrc = zpool_map_handle(entry->pool->zpool, entry->handle, ZPOOL_MM_RO);\n\tif (zpool_evictable(entry->pool->zpool))\n\t\tsrc += sizeof(struct zswap_header);\n\tdst = kmap_atomic(page);\n\ttfm = *get_cpu_ptr(entry->pool->tfm);\n\tret = crypto_comp_decompress(tfm, src, entry->length, dst, &dlen);\n\tput_cpu_ptr(entry->pool->tfm);\n\tkunmap_atomic(dst);\n\tzpool_unmap_handle(entry->pool->zpool, entry->handle);\n\tBUG_ON(ret);\n\nfreeentry:\n\tspin_lock(&tree->lock);\n\tzswap_entry_put(tree, entry);\n\tspin_unlock(&tree->lock);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct zswap_tree *zswap_trees[MAX_SWAPFILES];",
      "static int zswap_writeback_entry(struct zpool *pool, unsigned long handle);",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 1180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_put",
          "args": [
            "tree",
            "entry"
          ],
          "line": 1179
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "354-364",
          "snippet": "static void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tree->lock"
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "ret"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_unmap_handle",
          "args": [
            "entry->pool->zpool",
            "entry->handle"
          ],
          "line": 1174
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_unmap_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "343-346",
          "snippet": "void zpool_unmap_handle(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->unmap(zpool->pool, handle);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid zpool_unmap_handle(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->unmap(zpool->pool, handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "dst"
          ],
          "line": 1173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_cpu_ptr",
          "args": [
            "entry->pool->tfm"
          ],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crypto_comp_decompress",
          "args": [
            "tfm",
            "src",
            "entry->length",
            "dst",
            "&dlen"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_ptr",
          "args": [
            "entry->pool->tfm"
          ],
          "line": 1170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_evictable",
          "args": [
            "entry->pool->zpool"
          ],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_evictable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "374-377",
          "snippet": "bool zpool_evictable(struct zpool *zpool)\n{\n\treturn zpool->evictable;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nbool zpool_evictable(struct zpool *zpool)\n{\n\treturn zpool->evictable;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_map_handle",
          "args": [
            "entry->pool->zpool",
            "entry->handle",
            "ZPOOL_MM_RO"
          ],
          "line": 1166
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_map_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "327-331",
          "snippet": "void *zpool_map_handle(struct zpool *zpool, unsigned long handle,\n\t\t\tenum zpool_mapmode mapmode)\n{\n\treturn zpool->driver->map(zpool->pool, handle, mapmode);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid *zpool_map_handle(struct zpool *zpool, unsigned long handle,\n\t\t\tenum zpool_mapmode mapmode)\n{\n\treturn zpool->driver->map(zpool->pool, handle, mapmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "dst"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_fill_page",
          "args": [
            "dst",
            "entry->value"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_fill_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "985-991",
          "snippet": "static void zswap_fill_page(void *ptr, unsigned long value)\n{\n\tunsigned long *page;\n\n\tpage = (unsigned long *)ptr;\n\tmemset_l(page, value, PAGE_SIZE / sizeof(unsigned long));\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic void zswap_fill_page(void *ptr, unsigned long value)\n{\n\tunsigned long *page;\n\n\tpage = (unsigned long *)ptr;\n\tmemset_l(page, value, PAGE_SIZE / sizeof(unsigned long));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 1158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_find_get",
          "args": [
            "&tree->rbroot",
            "offset"
          ],
          "line": 1149
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_find_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "367-377",
          "snippet": "static struct zswap_entry *zswap_entry_find_get(struct rb_root *root,\n\t\t\t\tpgoff_t offset)\n{\n\tstruct zswap_entry *entry;\n\n\tentry = zswap_rb_search(root, offset);\n\tif (entry)\n\t\tzswap_entry_get(entry);\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_entry_find_get(struct rb_root *root,\n\t\t\t\tpgoff_t offset)\n{\n\tstruct zswap_entry *entry;\n\n\tentry = zswap_rb_search(root, offset);\n\tif (entry)\n\t\tzswap_entry_get(entry);\n\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tree->lock"
          ],
          "line": 1148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct zswap_tree *zswap_trees[MAX_SWAPFILES];\nstatic int zswap_writeback_entry(struct zpool *pool, unsigned long handle);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int zswap_frontswap_load(unsigned type, pgoff_t offset,\n\t\t\t\tstruct page *page)\n{\n\tstruct zswap_tree *tree = zswap_trees[type];\n\tstruct zswap_entry *entry;\n\tstruct crypto_comp *tfm;\n\tu8 *src, *dst;\n\tunsigned int dlen;\n\tint ret;\n\n\t/* find */\n\tspin_lock(&tree->lock);\n\tentry = zswap_entry_find_get(&tree->rbroot, offset);\n\tif (!entry) {\n\t\t/* entry was written back */\n\t\tspin_unlock(&tree->lock);\n\t\treturn -1;\n\t}\n\tspin_unlock(&tree->lock);\n\n\tif (!entry->length) {\n\t\tdst = kmap_atomic(page);\n\t\tzswap_fill_page(dst, entry->value);\n\t\tkunmap_atomic(dst);\n\t\tgoto freeentry;\n\t}\n\n\t/* decompress */\n\tdlen = PAGE_SIZE;\n\tsrc = zpool_map_handle(entry->pool->zpool, entry->handle, ZPOOL_MM_RO);\n\tif (zpool_evictable(entry->pool->zpool))\n\t\tsrc += sizeof(struct zswap_header);\n\tdst = kmap_atomic(page);\n\ttfm = *get_cpu_ptr(entry->pool->tfm);\n\tret = crypto_comp_decompress(tfm, src, entry->length, dst, &dlen);\n\tput_cpu_ptr(entry->pool->tfm);\n\tkunmap_atomic(dst);\n\tzpool_unmap_handle(entry->pool->zpool, entry->handle);\n\tBUG_ON(ret);\n\nfreeentry:\n\tspin_lock(&tree->lock);\n\tzswap_entry_put(tree, entry);\n\tspin_unlock(&tree->lock);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "zswap_frontswap_store",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "997-1131",
    "snippet": "static int zswap_frontswap_store(unsigned type, pgoff_t offset,\n\t\t\t\tstruct page *page)\n{\n\tstruct zswap_tree *tree = zswap_trees[type];\n\tstruct zswap_entry *entry, *dupentry;\n\tstruct crypto_comp *tfm;\n\tint ret;\n\tunsigned int hlen, dlen = PAGE_SIZE;\n\tunsigned long handle, value;\n\tchar *buf;\n\tu8 *src, *dst;\n\tstruct zswap_header zhdr = { .swpentry = swp_entry(type, offset) };\n\n\t/* THP isn't supported */\n\tif (PageTransHuge(page)) {\n\t\tret = -EINVAL;\n\t\tgoto reject;\n\t}\n\n\tif (!zswap_enabled || !tree) {\n\t\tret = -ENODEV;\n\t\tgoto reject;\n\t}\n\n\t/* reclaim space if needed */\n\tif (zswap_is_full()) {\n\t\tzswap_pool_limit_hit++;\n\t\tif (zswap_shrink()) {\n\t\t\tzswap_reject_reclaim_fail++;\n\t\t\tret = -ENOMEM;\n\t\t\tgoto reject;\n\t\t}\n\n\t\t/* A second zswap_is_full() check after\n\t\t * zswap_shrink() to make sure it's now\n\t\t * under the max_pool_percent\n\t\t */\n\t\tif (zswap_is_full()) {\n\t\t\tret = -ENOMEM;\n\t\t\tgoto reject;\n\t\t}\n\t}\n\n\t/* allocate entry */\n\tentry = zswap_entry_cache_alloc(GFP_KERNEL);\n\tif (!entry) {\n\t\tzswap_reject_kmemcache_fail++;\n\t\tret = -ENOMEM;\n\t\tgoto reject;\n\t}\n\n\tif (zswap_same_filled_pages_enabled) {\n\t\tsrc = kmap_atomic(page);\n\t\tif (zswap_is_page_same_filled(src, &value)) {\n\t\t\tkunmap_atomic(src);\n\t\t\tentry->offset = offset;\n\t\t\tentry->length = 0;\n\t\t\tentry->value = value;\n\t\t\tatomic_inc(&zswap_same_filled_pages);\n\t\t\tgoto insert_entry;\n\t\t}\n\t\tkunmap_atomic(src);\n\t}\n\n\t/* if entry is successfully added, it keeps the reference */\n\tentry->pool = zswap_pool_current_get();\n\tif (!entry->pool) {\n\t\tret = -EINVAL;\n\t\tgoto freepage;\n\t}\n\n\t/* compress */\n\tdst = get_cpu_var(zswap_dstmem);\n\ttfm = *get_cpu_ptr(entry->pool->tfm);\n\tsrc = kmap_atomic(page);\n\tret = crypto_comp_compress(tfm, src, PAGE_SIZE, dst, &dlen);\n\tkunmap_atomic(src);\n\tput_cpu_ptr(entry->pool->tfm);\n\tif (ret) {\n\t\tret = -EINVAL;\n\t\tgoto put_dstmem;\n\t}\n\n\t/* store */\n\thlen = zpool_evictable(entry->pool->zpool) ? sizeof(zhdr) : 0;\n\tret = zpool_malloc(entry->pool->zpool, hlen + dlen,\n\t\t\t   __GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM,\n\t\t\t   &handle);\n\tif (ret == -ENOSPC) {\n\t\tzswap_reject_compress_poor++;\n\t\tgoto put_dstmem;\n\t}\n\tif (ret) {\n\t\tzswap_reject_alloc_fail++;\n\t\tgoto put_dstmem;\n\t}\n\tbuf = zpool_map_handle(entry->pool->zpool, handle, ZPOOL_MM_RW);\n\tmemcpy(buf, &zhdr, hlen);\n\tmemcpy(buf + hlen, dst, dlen);\n\tzpool_unmap_handle(entry->pool->zpool, handle);\n\tput_cpu_var(zswap_dstmem);\n\n\t/* populate entry */\n\tentry->offset = offset;\n\tentry->handle = handle;\n\tentry->length = dlen;\n\ninsert_entry:\n\t/* map */\n\tspin_lock(&tree->lock);\n\tdo {\n\t\tret = zswap_rb_insert(&tree->rbroot, entry, &dupentry);\n\t\tif (ret == -EEXIST) {\n\t\t\tzswap_duplicate_entry++;\n\t\t\t/* remove from rbtree */\n\t\t\tzswap_rb_erase(&tree->rbroot, dupentry);\n\t\t\tzswap_entry_put(tree, dupentry);\n\t\t}\n\t} while (ret == -EEXIST);\n\tspin_unlock(&tree->lock);\n\n\t/* update stats */\n\tatomic_inc(&zswap_stored_pages);\n\tzswap_update_total_size();\n\n\treturn 0;\n\nput_dstmem:\n\tput_cpu_var(zswap_dstmem);\n\tzswap_pool_put(entry->pool);\nfreepage:\n\tzswap_entry_cache_free(entry);\nreject:\n\treturn ret;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static atomic_t zswap_stored_pages = ATOMIC_INIT(0);",
      "static atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);",
      "static u64 zswap_pool_limit_hit;",
      "static u64 zswap_reject_reclaim_fail;",
      "static u64 zswap_reject_compress_poor;",
      "static u64 zswap_reject_alloc_fail;",
      "static u64 zswap_reject_kmemcache_fail;",
      "static u64 zswap_duplicate_entry;",
      "static bool zswap_enabled;",
      "static bool zswap_same_filled_pages_enabled = true;",
      "static struct zswap_tree *zswap_trees[MAX_SWAPFILES];",
      "static int zswap_writeback_entry(struct zpool *pool, unsigned long handle);",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static DEFINE_PER_CPU(u8 *, zswap_dstmem);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_entry_cache_free",
          "args": [
            "entry"
          ],
          "line": 1128
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "268-271",
          "snippet": "static void zswap_entry_cache_free(struct zswap_entry *entry)\n{\n\tkmem_cache_free(zswap_entry_cache, entry);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *zswap_entry_cache;",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\nstatic __init struct;\n\nstatic void zswap_entry_cache_free(struct zswap_entry *entry)\n{\n\tkmem_cache_free(zswap_entry_cache, entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_pool_put",
          "args": [
            "entry->pool"
          ],
          "line": 1126
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "665-668",
          "snippet": "static void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_cpu_var",
          "args": [
            "zswap_dstmem"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_update_total_size",
          "args": [],
          "line": 1120
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_update_total_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "226-239",
          "snippet": "static void zswap_update_total_size(void)\n{\n\tstruct zswap_pool *pool;\n\tu64 total = 0;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\ttotal += zpool_get_total_size(pool->zpool);\n\n\trcu_read_unlock();\n\n\tzswap_pool_total_size = total;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 zswap_pool_total_size;",
            "static LIST_HEAD(zswap_pools);",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic u64 zswap_pool_total_size;\nstatic LIST_HEAD(zswap_pools);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_update_total_size(void)\n{\n\tstruct zswap_pool *pool;\n\tu64 total = 0;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\ttotal += zpool_get_total_size(pool->zpool);\n\n\trcu_read_unlock();\n\n\tzswap_pool_total_size = total;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&zswap_stored_pages"
          ],
          "line": 1119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_put",
          "args": [
            "tree",
            "dupentry"
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "354-364",
          "snippet": "static void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_rb_erase",
          "args": [
            "&tree->rbroot",
            "dupentry"
          ],
          "line": 1112
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_rb_erase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "320-326",
          "snippet": "static void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_rb_insert",
          "args": [
            "&tree->rbroot",
            "entry",
            "&dupentry"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_rb_insert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "297-318",
          "snippet": "static int zswap_rb_insert(struct rb_root *root, struct zswap_entry *entry,\n\t\t\tstruct zswap_entry **dupentry)\n{\n\tstruct rb_node **link = &root->rb_node, *parent = NULL;\n\tstruct zswap_entry *myentry;\n\n\twhile (*link) {\n\t\tparent = *link;\n\t\tmyentry = rb_entry(parent, struct zswap_entry, rbnode);\n\t\tif (myentry->offset > entry->offset)\n\t\t\tlink = &(*link)->rb_left;\n\t\telse if (myentry->offset < entry->offset)\n\t\t\tlink = &(*link)->rb_right;\n\t\telse {\n\t\t\t*dupentry = myentry;\n\t\t\treturn -EEXIST;\n\t\t}\n\t}\n\trb_link_node(&entry->rbnode, parent, link);\n\trb_insert_color(&entry->rbnode, root);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic int zswap_rb_insert(struct rb_root *root, struct zswap_entry *entry,\n\t\t\tstruct zswap_entry **dupentry)\n{\n\tstruct rb_node **link = &root->rb_node, *parent = NULL;\n\tstruct zswap_entry *myentry;\n\n\twhile (*link) {\n\t\tparent = *link;\n\t\tmyentry = rb_entry(parent, struct zswap_entry, rbnode);\n\t\tif (myentry->offset > entry->offset)\n\t\t\tlink = &(*link)->rb_left;\n\t\telse if (myentry->offset < entry->offset)\n\t\t\tlink = &(*link)->rb_right;\n\t\telse {\n\t\t\t*dupentry = myentry;\n\t\t\treturn -EEXIST;\n\t\t}\n\t}\n\trb_link_node(&entry->rbnode, parent, link);\n\trb_insert_color(&entry->rbnode, root);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tree->lock"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_cpu_var",
          "args": [
            "zswap_dstmem"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_unmap_handle",
          "args": [
            "entry->pool->zpool",
            "handle"
          ],
          "line": 1096
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_unmap_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "343-346",
          "snippet": "void zpool_unmap_handle(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->unmap(zpool->pool, handle);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid zpool_unmap_handle(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->unmap(zpool->pool, handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf + hlen",
            "dst",
            "dlen"
          ],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kasan/kasan.c",
          "lines": "300-306",
          "snippet": "void *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}",
          "includes": [
            "#include \"../slab.h\"",
            "#include \"kasan.h\"",
            "#include <linux/bug.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/types.h>",
            "#include <linux/string.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/memory.h>",
            "#include <linux/memblock.h>",
            "#include <linux/linkage.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kasan.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);",
            "__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"../slab.h\"\n#include \"kasan.h\"\n#include <linux/bug.h>\n#include <linux/vmalloc.h>\n#include <linux/types.h>\n#include <linux/string.h>\n#include <linux/stacktrace.h>\n#include <linux/slab.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/memory.h>\n#include <linux/memblock.h>\n#include <linux/linkage.h>\n#include <linux/kmemleak.h>\n#include <linux/kernel.h>\n#include <linux/kasan.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/export.h>\n\n__alias(__asan_loadN)\nvoid __asan_loadN_noabort(unsigned long, size_t);\n__alias(__asan_storeN)\nvoid __asan_storeN_noabort(unsigned long, size_t);\n\nvoid *memcpy(void *dest, const void *src, size_t len)\n{\n\tcheck_memory_region((unsigned long)src, len, false, _RET_IP_);\n\tcheck_memory_region((unsigned long)dest, len, true, _RET_IP_);\n\n\treturn __memcpy(dest, src, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_map_handle",
          "args": [
            "entry->pool->zpool",
            "handle",
            "ZPOOL_MM_RW"
          ],
          "line": 1093
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_map_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "327-331",
          "snippet": "void *zpool_map_handle(struct zpool *zpool, unsigned long handle,\n\t\t\tenum zpool_mapmode mapmode)\n{\n\treturn zpool->driver->map(zpool->pool, handle, mapmode);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid *zpool_map_handle(struct zpool *zpool, unsigned long handle,\n\t\t\tenum zpool_mapmode mapmode)\n{\n\treturn zpool->driver->map(zpool->pool, handle, mapmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_malloc",
          "args": [
            "entry->pool->zpool",
            "hlen + dlen",
            "__GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM",
            "&handle"
          ],
          "line": 1082
        },
        "resolved": true,
        "details": {
          "function_name": "z3fold_zpool_malloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/z3fold.c",
          "lines": "1075-1079",
          "snippet": "static int z3fold_zpool_malloc(void *pool, size_t size, gfp_t gfp,\n\t\t\tunsigned long *handle)\n{\n\treturn z3fold_alloc(pool, size, gfp, handle);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/preempt.h>",
            "#include <linux/percpu.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/sched.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/preempt.h>\n#include <linux/percpu.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/sched.h>\n#include <linux/atomic.h>\n\nstatic int z3fold_zpool_malloc(void *pool, size_t size, gfp_t gfp,\n\t\t\tunsigned long *handle)\n{\n\treturn z3fold_alloc(pool, size, gfp, handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_evictable",
          "args": [
            "entry->pool->zpool"
          ],
          "line": 1081
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_evictable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "374-377",
          "snippet": "bool zpool_evictable(struct zpool *zpool)\n{\n\treturn zpool->evictable;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nbool zpool_evictable(struct zpool *zpool)\n{\n\treturn zpool->evictable;\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_cpu_ptr",
          "args": [
            "entry->pool->tfm"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "src"
          ],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crypto_comp_compress",
          "args": [
            "tfm",
            "src",
            "PAGE_SIZE",
            "dst",
            "&dlen"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 1071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_ptr",
          "args": [
            "entry->pool->tfm"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_var",
          "args": [
            "zswap_dstmem"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_current_get",
          "args": [],
          "line": 1062
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_current_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "459-472",
          "snippet": "static struct zswap_pool *zswap_pool_current_get(void)\n{\n\tstruct zswap_pool *pool;\n\n\trcu_read_lock();\n\n\tpool = __zswap_pool_current();\n\tif (!zswap_pool_get(pool))\n\t\tpool = NULL;\n\n\trcu_read_unlock();\n\n\treturn pool;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_current_get(void)\n{\n\tstruct zswap_pool *pool;\n\n\trcu_read_lock();\n\n\tpool = __zswap_pool_current();\n\tif (!zswap_pool_get(pool))\n\t\tpool = NULL;\n\n\trcu_read_unlock();\n\n\treturn pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "src"
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&zswap_same_filled_pages"
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "src"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_is_page_same_filled",
          "args": [
            "src",
            "&value"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_is_page_same_filled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "971-983",
          "snippet": "static int zswap_is_page_same_filled(void *ptr, unsigned long *value)\n{\n\tunsigned int pos;\n\tunsigned long *page;\n\n\tpage = (unsigned long *)ptr;\n\tfor (pos = 1; pos < PAGE_SIZE / sizeof(*page); pos++) {\n\t\tif (page[pos] != page[0])\n\t\t\treturn 0;\n\t}\n\t*value = page[0];\n\treturn 1;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_is_page_same_filled(void *ptr, unsigned long *value)\n{\n\tunsigned int pos;\n\tunsigned long *page;\n\n\tpage = (unsigned long *)ptr;\n\tfor (pos = 1; pos < PAGE_SIZE / sizeof(*page); pos++) {\n\t\tif (page[pos] != page[0])\n\t\t\treturn 0;\n\t}\n\t*value = page[0];\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_cache_alloc",
          "args": [
            "GFP_KERNEL"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "257-266",
          "snippet": "static struct zswap_entry *zswap_entry_cache_alloc(gfp_t gfp)\n{\n\tstruct zswap_entry *entry;\n\tentry = kmem_cache_alloc(zswap_entry_cache, gfp);\n\tif (!entry)\n\t\treturn NULL;\n\tentry->refcount = 1;\n\tRB_CLEAR_NODE(&entry->rbnode);\n\treturn entry;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *zswap_entry_cache;",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_entry_cache_alloc(gfp_t gfp)\n{\n\tstruct zswap_entry *entry;\n\tentry = kmem_cache_alloc(zswap_entry_cache, gfp);\n\tif (!entry)\n\t\treturn NULL;\n\tentry->refcount = 1;\n\tRB_CLEAR_NODE(&entry->rbnode);\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_is_full",
          "args": [],
          "line": 1034
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_is_full",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "220-224",
          "snippet": "static bool zswap_is_full(void)\n{\n\treturn totalram_pages * zswap_max_pool_percent / 100 <\n\t\tDIV_ROUND_UP(zswap_pool_total_size, PAGE_SIZE);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 zswap_pool_total_size;",
            "static unsigned int zswap_max_pool_percent = 20;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic u64 zswap_pool_total_size;\nstatic unsigned int zswap_max_pool_percent = 20;\n\nstatic bool zswap_is_full(void)\n{\n\treturn totalram_pages * zswap_max_pool_percent / 100 <\n\t\tDIV_ROUND_UP(zswap_pool_total_size, PAGE_SIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_shrink",
          "args": [],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_shrink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "955-969",
          "snippet": "static int zswap_shrink(void)\n{\n\tstruct zswap_pool *pool;\n\tint ret;\n\n\tpool = zswap_pool_last_get();\n\tif (!pool)\n\t\treturn -ENOENT;\n\n\tret = zpool_shrink(pool->zpool, 1, NULL);\n\n\tzswap_pool_put(pool);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int zswap_shrink(void)\n{\n\tstruct zswap_pool *pool;\n\tint ret;\n\n\tpool = zswap_pool_last_get();\n\tif (!pool)\n\t\treturn -ENOENT;\n\n\tret = zpool_shrink(pool->zpool, 1, NULL);\n\n\tzswap_pool_put(pool);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "PageTransHuge",
          "args": [
            "page"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swp_entry",
          "args": [
            "type",
            "offset"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "swp_entry_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swapfile.c",
          "lines": "1289-1294",
          "snippet": "static int swp_entry_cmp(const void *ent1, const void *ent2)\n{\n\tconst swp_entry_t *e1 = ent1, *e2 = ent2;\n\n\treturn (int)swp_type(*e1) - (int)swp_type(*e2);\n}",
          "includes": [
            "#include <linux/swap_cgroup.h>",
            "#include <linux/swapops.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/pgtable.h>",
            "#include <linux/sort.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/export.h>",
            "#include <linux/swapfile.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/oom.h>",
            "#include <linux/poll.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/capability.h>",
            "#include <linux/mutex.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/security.h>",
            "#include <linux/rmap.h>",
            "#include <linux/ksm.h>",
            "#include <linux/init.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/writeback.h>",
            "#include <linux/random.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/shmem_fs.h>",
            "#include <linux/namei.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/slab.h>",
            "#include <linux/mman.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/swap_cgroup.h>\n#include <linux/swapops.h>\n#include <asm/tlbflush.h>\n#include <asm/pgtable.h>\n#include <linux/sort.h>\n#include <linux/swap_slots.h>\n#include <linux/export.h>\n#include <linux/swapfile.h>\n#include <linux/frontswap.h>\n#include <linux/oom.h>\n#include <linux/poll.h>\n#include <linux/memcontrol.h>\n#include <linux/syscalls.h>\n#include <linux/capability.h>\n#include <linux/mutex.h>\n#include <linux/backing-dev.h>\n#include <linux/security.h>\n#include <linux/rmap.h>\n#include <linux/ksm.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/writeback.h>\n#include <linux/random.h>\n#include <linux/blkdev.h>\n#include <linux/shmem_fs.h>\n#include <linux/namei.h>\n#include <linux/pagemap.h>\n#include <linux/vmalloc.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/slab.h>\n#include <linux/mman.h>\n#include <linux/hugetlb.h>\n#include <linux/sched/task.h>\n#include <linux/sched/mm.h>\n#include <linux/mm.h>\n\nstatic int swp_entry_cmp(const void *ent1, const void *ent2)\n{\n\tconst swp_entry_t *e1 = ent1, *e2 = ent2;\n\n\treturn (int)swp_type(*e1) - (int)swp_type(*e2);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic atomic_t zswap_stored_pages = ATOMIC_INIT(0);\nstatic atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);\nstatic u64 zswap_pool_limit_hit;\nstatic u64 zswap_reject_reclaim_fail;\nstatic u64 zswap_reject_compress_poor;\nstatic u64 zswap_reject_alloc_fail;\nstatic u64 zswap_reject_kmemcache_fail;\nstatic u64 zswap_duplicate_entry;\nstatic bool zswap_enabled;\nstatic bool zswap_same_filled_pages_enabled = true;\nstatic struct zswap_tree *zswap_trees[MAX_SWAPFILES];\nstatic int zswap_writeback_entry(struct zpool *pool, unsigned long handle);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic DEFINE_PER_CPU(u8 *, zswap_dstmem);\nstatic __init struct;\n\nstatic int zswap_frontswap_store(unsigned type, pgoff_t offset,\n\t\t\t\tstruct page *page)\n{\n\tstruct zswap_tree *tree = zswap_trees[type];\n\tstruct zswap_entry *entry, *dupentry;\n\tstruct crypto_comp *tfm;\n\tint ret;\n\tunsigned int hlen, dlen = PAGE_SIZE;\n\tunsigned long handle, value;\n\tchar *buf;\n\tu8 *src, *dst;\n\tstruct zswap_header zhdr = { .swpentry = swp_entry(type, offset) };\n\n\t/* THP isn't supported */\n\tif (PageTransHuge(page)) {\n\t\tret = -EINVAL;\n\t\tgoto reject;\n\t}\n\n\tif (!zswap_enabled || !tree) {\n\t\tret = -ENODEV;\n\t\tgoto reject;\n\t}\n\n\t/* reclaim space if needed */\n\tif (zswap_is_full()) {\n\t\tzswap_pool_limit_hit++;\n\t\tif (zswap_shrink()) {\n\t\t\tzswap_reject_reclaim_fail++;\n\t\t\tret = -ENOMEM;\n\t\t\tgoto reject;\n\t\t}\n\n\t\t/* A second zswap_is_full() check after\n\t\t * zswap_shrink() to make sure it's now\n\t\t * under the max_pool_percent\n\t\t */\n\t\tif (zswap_is_full()) {\n\t\t\tret = -ENOMEM;\n\t\t\tgoto reject;\n\t\t}\n\t}\n\n\t/* allocate entry */\n\tentry = zswap_entry_cache_alloc(GFP_KERNEL);\n\tif (!entry) {\n\t\tzswap_reject_kmemcache_fail++;\n\t\tret = -ENOMEM;\n\t\tgoto reject;\n\t}\n\n\tif (zswap_same_filled_pages_enabled) {\n\t\tsrc = kmap_atomic(page);\n\t\tif (zswap_is_page_same_filled(src, &value)) {\n\t\t\tkunmap_atomic(src);\n\t\t\tentry->offset = offset;\n\t\t\tentry->length = 0;\n\t\t\tentry->value = value;\n\t\t\tatomic_inc(&zswap_same_filled_pages);\n\t\t\tgoto insert_entry;\n\t\t}\n\t\tkunmap_atomic(src);\n\t}\n\n\t/* if entry is successfully added, it keeps the reference */\n\tentry->pool = zswap_pool_current_get();\n\tif (!entry->pool) {\n\t\tret = -EINVAL;\n\t\tgoto freepage;\n\t}\n\n\t/* compress */\n\tdst = get_cpu_var(zswap_dstmem);\n\ttfm = *get_cpu_ptr(entry->pool->tfm);\n\tsrc = kmap_atomic(page);\n\tret = crypto_comp_compress(tfm, src, PAGE_SIZE, dst, &dlen);\n\tkunmap_atomic(src);\n\tput_cpu_ptr(entry->pool->tfm);\n\tif (ret) {\n\t\tret = -EINVAL;\n\t\tgoto put_dstmem;\n\t}\n\n\t/* store */\n\thlen = zpool_evictable(entry->pool->zpool) ? sizeof(zhdr) : 0;\n\tret = zpool_malloc(entry->pool->zpool, hlen + dlen,\n\t\t\t   __GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM,\n\t\t\t   &handle);\n\tif (ret == -ENOSPC) {\n\t\tzswap_reject_compress_poor++;\n\t\tgoto put_dstmem;\n\t}\n\tif (ret) {\n\t\tzswap_reject_alloc_fail++;\n\t\tgoto put_dstmem;\n\t}\n\tbuf = zpool_map_handle(entry->pool->zpool, handle, ZPOOL_MM_RW);\n\tmemcpy(buf, &zhdr, hlen);\n\tmemcpy(buf + hlen, dst, dlen);\n\tzpool_unmap_handle(entry->pool->zpool, handle);\n\tput_cpu_var(zswap_dstmem);\n\n\t/* populate entry */\n\tentry->offset = offset;\n\tentry->handle = handle;\n\tentry->length = dlen;\n\ninsert_entry:\n\t/* map */\n\tspin_lock(&tree->lock);\n\tdo {\n\t\tret = zswap_rb_insert(&tree->rbroot, entry, &dupentry);\n\t\tif (ret == -EEXIST) {\n\t\t\tzswap_duplicate_entry++;\n\t\t\t/* remove from rbtree */\n\t\t\tzswap_rb_erase(&tree->rbroot, dupentry);\n\t\t\tzswap_entry_put(tree, dupentry);\n\t\t}\n\t} while (ret == -EEXIST);\n\tspin_unlock(&tree->lock);\n\n\t/* update stats */\n\tatomic_inc(&zswap_stored_pages);\n\tzswap_update_total_size();\n\n\treturn 0;\n\nput_dstmem:\n\tput_cpu_var(zswap_dstmem);\n\tzswap_pool_put(entry->pool);\nfreepage:\n\tzswap_entry_cache_free(entry);\nreject:\n\treturn ret;\n}"
  },
  {
    "function_name": "zswap_fill_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "985-991",
    "snippet": "static void zswap_fill_page(void *ptr, unsigned long value)\n{\n\tunsigned long *page;\n\n\tpage = (unsigned long *)ptr;\n\tmemset_l(page, value, PAGE_SIZE / sizeof(unsigned long));\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset_l",
          "args": [
            "page",
            "value",
            "PAGE_SIZE / sizeof(unsigned long)"
          ],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic void zswap_fill_page(void *ptr, unsigned long value)\n{\n\tunsigned long *page;\n\n\tpage = (unsigned long *)ptr;\n\tmemset_l(page, value, PAGE_SIZE / sizeof(unsigned long));\n}"
  },
  {
    "function_name": "zswap_is_page_same_filled",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "971-983",
    "snippet": "static int zswap_is_page_same_filled(void *ptr, unsigned long *value)\n{\n\tunsigned int pos;\n\tunsigned long *page;\n\n\tpage = (unsigned long *)ptr;\n\tfor (pos = 1; pos < PAGE_SIZE / sizeof(*page); pos++) {\n\t\tif (page[pos] != page[0])\n\t\t\treturn 0;\n\t}\n\t*value = page[0];\n\treturn 1;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_is_page_same_filled(void *ptr, unsigned long *value)\n{\n\tunsigned int pos;\n\tunsigned long *page;\n\n\tpage = (unsigned long *)ptr;\n\tfor (pos = 1; pos < PAGE_SIZE / sizeof(*page); pos++) {\n\t\tif (page[pos] != page[0])\n\t\t\treturn 0;\n\t}\n\t*value = page[0];\n\treturn 1;\n}"
  },
  {
    "function_name": "zswap_shrink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "955-969",
    "snippet": "static int zswap_shrink(void)\n{\n\tstruct zswap_pool *pool;\n\tint ret;\n\n\tpool = zswap_pool_last_get();\n\tif (!pool)\n\t\treturn -ENOENT;\n\n\tret = zpool_shrink(pool->zpool, 1, NULL);\n\n\tzswap_pool_put(pool);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_pool_put",
          "args": [
            "pool"
          ],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "665-668",
          "snippet": "static void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_shrink",
          "args": [
            "pool->zpool",
            "1",
            "NULL"
          ],
          "line": 964
        },
        "resolved": true,
        "details": {
          "function_name": "z3fold_zpool_shrink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/z3fold.c",
          "lines": "1085-1102",
          "snippet": "static int z3fold_zpool_shrink(void *pool, unsigned int pages,\n\t\t\tunsigned int *reclaimed)\n{\n\tunsigned int total = 0;\n\tint ret = -EINVAL;\n\n\twhile (total < pages) {\n\t\tret = z3fold_reclaim_page(pool, 8);\n\t\tif (ret < 0)\n\t\t\tbreak;\n\t\ttotal++;\n\t}\n\n\tif (reclaimed)\n\t\t*reclaimed = total;\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/preempt.h>",
            "#include <linux/percpu.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/sched.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/preempt.h>\n#include <linux/percpu.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/sched.h>\n#include <linux/atomic.h>\n\nstatic int z3fold_zpool_shrink(void *pool, unsigned int pages,\n\t\t\tunsigned int *reclaimed)\n{\n\tunsigned int total = 0;\n\tint ret = -EINVAL;\n\n\twhile (total < pages) {\n\t\tret = z3fold_reclaim_page(pool, 8);\n\t\tif (ret < 0)\n\t\t\tbreak;\n\t\ttotal++;\n\t}\n\n\tif (reclaimed)\n\t\t*reclaimed = total;\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_pool_last_get",
          "args": [],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_last_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "474-490",
          "snippet": "static struct zswap_pool *zswap_pool_last_get(void)\n{\n\tstruct zswap_pool *pool, *last = NULL;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\tlast = pool;\n\tWARN_ONCE(!last && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\tif (!zswap_pool_get(last))\n\t\tlast = NULL;\n\n\trcu_read_unlock();\n\n\treturn last;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(zswap_pools);",
            "static bool zswap_has_pool;",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(zswap_pools);\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_last_get(void)\n{\n\tstruct zswap_pool *pool, *last = NULL;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\tlast = pool;\n\tWARN_ONCE(!last && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\tif (!zswap_pool_get(last))\n\t\tlast = NULL;\n\n\trcu_read_unlock();\n\n\treturn last;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int zswap_shrink(void)\n{\n\tstruct zswap_pool *pool;\n\tint ret;\n\n\tpool = zswap_pool_last_get();\n\tif (!pool)\n\t\treturn -ENOENT;\n\n\tret = zpool_shrink(pool->zpool, 1, NULL);\n\n\tzswap_pool_put(pool);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "zswap_writeback_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "849-953",
    "snippet": "static int zswap_writeback_entry(struct zpool *pool, unsigned long handle)\n{\n\tstruct zswap_header *zhdr;\n\tswp_entry_t swpentry;\n\tstruct zswap_tree *tree;\n\tpgoff_t offset;\n\tstruct zswap_entry *entry;\n\tstruct page *page;\n\tstruct crypto_comp *tfm;\n\tu8 *src, *dst;\n\tunsigned int dlen;\n\tint ret;\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_NONE,\n\t};\n\n\t/* extract swpentry from data */\n\tzhdr = zpool_map_handle(pool, handle, ZPOOL_MM_RO);\n\tswpentry = zhdr->swpentry; /* here */\n\tzpool_unmap_handle(pool, handle);\n\ttree = zswap_trees[swp_type(swpentry)];\n\toffset = swp_offset(swpentry);\n\n\t/* find and ref zswap entry */\n\tspin_lock(&tree->lock);\n\tentry = zswap_entry_find_get(&tree->rbroot, offset);\n\tif (!entry) {\n\t\t/* entry was invalidated */\n\t\tspin_unlock(&tree->lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(&tree->lock);\n\tBUG_ON(offset != entry->offset);\n\n\t/* try to allocate swap cache page */\n\tswitch (zswap_get_swap_cache_page(swpentry, &page)) {\n\tcase ZSWAP_SWAPCACHE_FAIL: /* no memory or invalidate happened */\n\t\tret = -ENOMEM;\n\t\tgoto fail;\n\n\tcase ZSWAP_SWAPCACHE_EXIST:\n\t\t/* page is already in the swap cache, ignore for now */\n\t\tput_page(page);\n\t\tret = -EEXIST;\n\t\tgoto fail;\n\n\tcase ZSWAP_SWAPCACHE_NEW: /* page is locked */\n\t\t/* decompress */\n\t\tdlen = PAGE_SIZE;\n\t\tsrc = (u8 *)zpool_map_handle(entry->pool->zpool, entry->handle,\n\t\t\t\tZPOOL_MM_RO) + sizeof(struct zswap_header);\n\t\tdst = kmap_atomic(page);\n\t\ttfm = *get_cpu_ptr(entry->pool->tfm);\n\t\tret = crypto_comp_decompress(tfm, src, entry->length,\n\t\t\t\t\t     dst, &dlen);\n\t\tput_cpu_ptr(entry->pool->tfm);\n\t\tkunmap_atomic(dst);\n\t\tzpool_unmap_handle(entry->pool->zpool, entry->handle);\n\t\tBUG_ON(ret);\n\t\tBUG_ON(dlen != PAGE_SIZE);\n\n\t\t/* page is up to date */\n\t\tSetPageUptodate(page);\n\t}\n\n\t/* move it to the tail of the inactive list after end_writeback */\n\tSetPageReclaim(page);\n\n\t/* start writeback */\n\t__swap_writepage(page, &wbc, end_swap_bio_write);\n\tput_page(page);\n\tzswap_written_back_pages++;\n\n\tspin_lock(&tree->lock);\n\t/* drop local reference */\n\tzswap_entry_put(tree, entry);\n\n\t/*\n\t* There are two possible situations for entry here:\n\t* (1) refcount is 1(normal case),  entry is valid and on the tree\n\t* (2) refcount is 0, entry is freed and not on the tree\n\t*     because invalidate happened during writeback\n\t*  search the tree and free the entry if find entry\n\t*/\n\tif (entry == zswap_rb_search(&tree->rbroot, offset))\n\t\tzswap_entry_put(tree, entry);\n\tspin_unlock(&tree->lock);\n\n\tgoto end;\n\n\t/*\n\t* if we get here due to ZSWAP_SWAPCACHE_EXIST\n\t* a load may happening concurrently\n\t* it is safe and okay to not free the entry\n\t* if we free the entry in the following put\n\t* it it either okay to return !0\n\t*/\nfail:\n\tspin_lock(&tree->lock);\n\tzswap_entry_put(tree, entry);\n\tspin_unlock(&tree->lock);\n\nend:\n\treturn ret;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 zswap_written_back_pages;",
      "static struct zswap_tree *zswap_trees[MAX_SWAPFILES];",
      "static int zswap_writeback_entry(struct zpool *pool, unsigned long handle);",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_put",
          "args": [
            "tree",
            "entry"
          ],
          "line": 948
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "354-364",
          "snippet": "static void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tree->lock"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_rb_search",
          "args": [
            "&tree->rbroot",
            "offset"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_rb_search",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "276-291",
          "snippet": "static struct zswap_entry *zswap_rb_search(struct rb_root *root, pgoff_t offset)\n{\n\tstruct rb_node *node = root->rb_node;\n\tstruct zswap_entry *entry;\n\n\twhile (node) {\n\t\tentry = rb_entry(node, struct zswap_entry, rbnode);\n\t\tif (entry->offset > offset)\n\t\t\tnode = node->rb_left;\n\t\telse if (entry->offset < offset)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn entry;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_rb_search(struct rb_root *root, pgoff_t offset)\n{\n\tstruct rb_node *node = root->rb_node;\n\tstruct zswap_entry *entry;\n\n\twhile (node) {\n\t\tentry = rb_entry(node, struct zswap_entry, rbnode);\n\t\tif (entry->offset > offset)\n\t\t\tnode = node->rb_left;\n\t\telse if (entry->offset < offset)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn entry;\n\t}\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tree->lock"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_page",
          "args": [
            "page"
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "put_page_bootmem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/memory_hotplug.c",
          "lines": "143-158",
          "snippet": "void put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/tlbflush.h>",
            "#include <linux/compaction.h>",
            "#include <linux/memblock.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/firmware-map.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/suspend.h>",
            "#include <linux/pfn.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/migrate.h>",
            "#include <linux/delay.h>",
            "#include <linux/ioport.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/highmem.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/memremap.h>",
            "#include <linux/memory.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/writeback.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/export.h>",
            "#include <linux/compiler.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void generic_online_page(struct page *page);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/tlbflush.h>\n#include <linux/compaction.h>\n#include <linux/memblock.h>\n#include <linux/hugetlb.h>\n#include <linux/stop_machine.h>\n#include <linux/firmware-map.h>\n#include <linux/mm_inline.h>\n#include <linux/suspend.h>\n#include <linux/pfn.h>\n#include <linux/page-isolation.h>\n#include <linux/migrate.h>\n#include <linux/delay.h>\n#include <linux/ioport.h>\n#include <linux/vmalloc.h>\n#include <linux/highmem.h>\n#include <linux/memory_hotplug.h>\n#include <linux/memremap.h>\n#include <linux/memory.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/writeback.h>\n#include <linux/pagevec.h>\n#include <linux/export.h>\n#include <linux/compiler.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/sched/signal.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic void generic_online_page(struct page *page);\n\nvoid put_page_bootmem(struct page *page)\n{\n\tunsigned long type;\n\n\ttype = (unsigned long) page->freelist;\n\tBUG_ON(type < MEMORY_HOTPLUG_MIN_BOOTMEM_TYPE ||\n\t       type > MEMORY_HOTPLUG_MAX_BOOTMEM_TYPE);\n\n\tif (page_ref_dec_return(page) == 1) {\n\t\tpage->freelist = NULL;\n\t\tClearPagePrivate(page);\n\t\tset_page_private(page, 0);\n\t\tINIT_LIST_HEAD(&page->lru);\n\t\tfree_reserved_page(page);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "__swap_writepage",
          "args": [
            "page",
            "&wbc",
            "end_swap_bio_write"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "__swap_writepage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_io.c",
          "lines": "278-349",
          "snippet": "int __swap_writepage(struct page *page, struct writeback_control *wbc,\n\t\tbio_end_io_t end_write_func)\n{\n\tstruct bio *bio;\n\tint ret;\n\tstruct swap_info_struct *sis = page_swap_info(page);\n\n\tVM_BUG_ON_PAGE(!PageSwapCache(page), page);\n\tif (sis->flags & SWP_FS) {\n\t\tstruct kiocb kiocb;\n\t\tstruct file *swap_file = sis->swap_file;\n\t\tstruct address_space *mapping = swap_file->f_mapping;\n\t\tstruct bio_vec bv = {\n\t\t\t.bv_page = page,\n\t\t\t.bv_len  = PAGE_SIZE,\n\t\t\t.bv_offset = 0\n\t\t};\n\t\tstruct iov_iter from;\n\n\t\tiov_iter_bvec(&from, WRITE, &bv, 1, PAGE_SIZE);\n\t\tinit_sync_kiocb(&kiocb, swap_file);\n\t\tkiocb.ki_pos = page_file_offset(page);\n\n\t\tset_page_writeback(page);\n\t\tunlock_page(page);\n\t\tret = mapping->a_ops->direct_IO(&kiocb, &from);\n\t\tif (ret == PAGE_SIZE) {\n\t\t\tcount_vm_event(PSWPOUT);\n\t\t\tret = 0;\n\t\t} else {\n\t\t\t/*\n\t\t\t * In the case of swap-over-nfs, this can be a\n\t\t\t * temporary failure if the system has limited\n\t\t\t * memory for allocating transmit buffers.\n\t\t\t * Mark the page dirty and avoid\n\t\t\t * rotate_reclaimable_page but rate-limit the\n\t\t\t * messages but do not flag PageError like\n\t\t\t * the normal direct-to-bio case as it could\n\t\t\t * be temporary.\n\t\t\t */\n\t\t\tset_page_dirty(page);\n\t\t\tClearPageReclaim(page);\n\t\t\tpr_err_ratelimited(\"Write error on dio swapfile (%llu)\\n\",\n\t\t\t\t\t   page_file_offset(page));\n\t\t}\n\t\tend_page_writeback(page);\n\t\treturn ret;\n\t}\n\n\tret = bdev_write_page(sis->bdev, swap_page_sector(page), page, wbc);\n\tif (!ret) {\n\t\tcount_swpout_vm_event(page);\n\t\treturn 0;\n\t}\n\n\tret = 0;\n\tbio = get_swap_bio(GFP_NOIO, page, end_write_func);\n\tif (bio == NULL) {\n\t\tset_page_dirty(page);\n\t\tunlock_page(page);\n\t\tret = -ENOMEM;\n\t\tgoto out;\n\t}\n\tbio->bi_opf = REQ_OP_WRITE | REQ_SWAP | wbc_to_write_flags(wbc);\n\tbio_associate_blkcg_from_page(bio, page);\n\tcount_swpout_vm_event(page);\n\tset_page_writeback(page);\n\tunlock_page(page);\n\tsubmit_bio(bio);\nout:\n\treturn ret;\n}",
          "includes": [
            "#include <asm/pgtable.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/uio.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/buffer_head.h>",
            "#include <linux/swapops.h>",
            "#include <linux/bio.h>",
            "#include <linux/swap.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/pgtable.h>\n#include <linux/sched/task.h>\n#include <linux/uio.h>\n#include <linux/blkdev.h>\n#include <linux/frontswap.h>\n#include <linux/writeback.h>\n#include <linux/buffer_head.h>\n#include <linux/swapops.h>\n#include <linux/bio.h>\n#include <linux/swap.h>\n#include <linux/pagemap.h>\n#include <linux/gfp.h>\n#include <linux/kernel_stat.h>\n#include <linux/mm.h>\n\nint __swap_writepage(struct page *page, struct writeback_control *wbc,\n\t\tbio_end_io_t end_write_func)\n{\n\tstruct bio *bio;\n\tint ret;\n\tstruct swap_info_struct *sis = page_swap_info(page);\n\n\tVM_BUG_ON_PAGE(!PageSwapCache(page), page);\n\tif (sis->flags & SWP_FS) {\n\t\tstruct kiocb kiocb;\n\t\tstruct file *swap_file = sis->swap_file;\n\t\tstruct address_space *mapping = swap_file->f_mapping;\n\t\tstruct bio_vec bv = {\n\t\t\t.bv_page = page,\n\t\t\t.bv_len  = PAGE_SIZE,\n\t\t\t.bv_offset = 0\n\t\t};\n\t\tstruct iov_iter from;\n\n\t\tiov_iter_bvec(&from, WRITE, &bv, 1, PAGE_SIZE);\n\t\tinit_sync_kiocb(&kiocb, swap_file);\n\t\tkiocb.ki_pos = page_file_offset(page);\n\n\t\tset_page_writeback(page);\n\t\tunlock_page(page);\n\t\tret = mapping->a_ops->direct_IO(&kiocb, &from);\n\t\tif (ret == PAGE_SIZE) {\n\t\t\tcount_vm_event(PSWPOUT);\n\t\t\tret = 0;\n\t\t} else {\n\t\t\t/*\n\t\t\t * In the case of swap-over-nfs, this can be a\n\t\t\t * temporary failure if the system has limited\n\t\t\t * memory for allocating transmit buffers.\n\t\t\t * Mark the page dirty and avoid\n\t\t\t * rotate_reclaimable_page but rate-limit the\n\t\t\t * messages but do not flag PageError like\n\t\t\t * the normal direct-to-bio case as it could\n\t\t\t * be temporary.\n\t\t\t */\n\t\t\tset_page_dirty(page);\n\t\t\tClearPageReclaim(page);\n\t\t\tpr_err_ratelimited(\"Write error on dio swapfile (%llu)\\n\",\n\t\t\t\t\t   page_file_offset(page));\n\t\t}\n\t\tend_page_writeback(page);\n\t\treturn ret;\n\t}\n\n\tret = bdev_write_page(sis->bdev, swap_page_sector(page), page, wbc);\n\tif (!ret) {\n\t\tcount_swpout_vm_event(page);\n\t\treturn 0;\n\t}\n\n\tret = 0;\n\tbio = get_swap_bio(GFP_NOIO, page, end_write_func);\n\tif (bio == NULL) {\n\t\tset_page_dirty(page);\n\t\tunlock_page(page);\n\t\tret = -ENOMEM;\n\t\tgoto out;\n\t}\n\tbio->bi_opf = REQ_OP_WRITE | REQ_SWAP | wbc_to_write_flags(wbc);\n\tbio_associate_blkcg_from_page(bio, page);\n\tcount_swpout_vm_event(page);\n\tset_page_writeback(page);\n\tunlock_page(page);\n\tsubmit_bio(bio);\nout:\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetPageReclaim",
          "args": [
            "page"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetPageUptodate",
          "args": [
            "page"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "dlen != PAGE_SIZE"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "ret"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_unmap_handle",
          "args": [
            "entry->pool->zpool",
            "entry->handle"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_unmap_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "343-346",
          "snippet": "void zpool_unmap_handle(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->unmap(zpool->pool, handle);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid zpool_unmap_handle(struct zpool *zpool, unsigned long handle)\n{\n\tzpool->driver->unmap(zpool->pool, handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kunmap_atomic",
          "args": [
            "dst"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "put_cpu_ptr",
          "args": [
            "entry->pool->tfm"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crypto_comp_decompress",
          "args": [
            "tfm",
            "src",
            "entry->length",
            "dst",
            "&dlen"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_cpu_ptr",
          "args": [
            "entry->pool->tfm"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmap_atomic",
          "args": [
            "page"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_map_handle",
          "args": [
            "entry->pool->zpool",
            "entry->handle",
            "ZPOOL_MM_RO"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_map_handle",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "327-331",
          "snippet": "void *zpool_map_handle(struct zpool *zpool, unsigned long handle,\n\t\t\tenum zpool_mapmode mapmode)\n{\n\treturn zpool->driver->map(zpool->pool, handle, mapmode);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nvoid *zpool_map_handle(struct zpool *zpool, unsigned long handle,\n\t\t\tenum zpool_mapmode mapmode)\n{\n\treturn zpool->driver->map(zpool->pool, handle, mapmode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_get_swap_cache_page",
          "args": [
            "swpentry",
            "&page"
          ],
          "line": 884
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_get_swap_cache_page",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "823-835",
          "snippet": "static int zswap_get_swap_cache_page(swp_entry_t entry,\n\t\t\t\tstruct page **retpage)\n{\n\tbool page_was_allocated;\n\n\t*retpage = __read_swap_cache_async(entry, GFP_KERNEL,\n\t\t\tNULL, 0, &page_was_allocated);\n\tif (page_was_allocated)\n\t\treturn ZSWAP_SWAPCACHE_NEW;\n\tif (!*retpage)\n\t\treturn ZSWAP_SWAPCACHE_FAIL;\n\treturn ZSWAP_SWAPCACHE_EXIST;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic int zswap_get_swap_cache_page(swp_entry_t entry,\n\t\t\t\tstruct page **retpage)\n{\n\tbool page_was_allocated;\n\n\t*retpage = __read_swap_cache_async(entry, GFP_KERNEL,\n\t\t\tNULL, 0, &page_was_allocated);\n\tif (page_was_allocated)\n\t\treturn ZSWAP_SWAPCACHE_NEW;\n\tif (!*retpage)\n\t\treturn ZSWAP_SWAPCACHE_FAIL;\n\treturn ZSWAP_SWAPCACHE_EXIST;\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "offset != entry->offset"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&tree->lock"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_find_get",
          "args": [
            "&tree->rbroot",
            "offset"
          ],
          "line": 874
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_find_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "367-377",
          "snippet": "static struct zswap_entry *zswap_entry_find_get(struct rb_root *root,\n\t\t\t\tpgoff_t offset)\n{\n\tstruct zswap_entry *entry;\n\n\tentry = zswap_rb_search(root, offset);\n\tif (entry)\n\t\tzswap_entry_get(entry);\n\n\treturn entry;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_entry_find_get(struct rb_root *root,\n\t\t\t\tpgoff_t offset)\n{\n\tstruct zswap_entry *entry;\n\n\tentry = zswap_rb_search(root, offset);\n\tif (entry)\n\t\tzswap_entry_get(entry);\n\n\treturn entry;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&tree->lock"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swp_offset",
          "args": [
            "swpentry"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "swp_type",
          "args": [
            "swpentry"
          ],
          "line": 869
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic u64 zswap_written_back_pages;\nstatic struct zswap_tree *zswap_trees[MAX_SWAPFILES];\nstatic int zswap_writeback_entry(struct zpool *pool, unsigned long handle);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int zswap_writeback_entry(struct zpool *pool, unsigned long handle)\n{\n\tstruct zswap_header *zhdr;\n\tswp_entry_t swpentry;\n\tstruct zswap_tree *tree;\n\tpgoff_t offset;\n\tstruct zswap_entry *entry;\n\tstruct page *page;\n\tstruct crypto_comp *tfm;\n\tu8 *src, *dst;\n\tunsigned int dlen;\n\tint ret;\n\tstruct writeback_control wbc = {\n\t\t.sync_mode = WB_SYNC_NONE,\n\t};\n\n\t/* extract swpentry from data */\n\tzhdr = zpool_map_handle(pool, handle, ZPOOL_MM_RO);\n\tswpentry = zhdr->swpentry; /* here */\n\tzpool_unmap_handle(pool, handle);\n\ttree = zswap_trees[swp_type(swpentry)];\n\toffset = swp_offset(swpentry);\n\n\t/* find and ref zswap entry */\n\tspin_lock(&tree->lock);\n\tentry = zswap_entry_find_get(&tree->rbroot, offset);\n\tif (!entry) {\n\t\t/* entry was invalidated */\n\t\tspin_unlock(&tree->lock);\n\t\treturn 0;\n\t}\n\tspin_unlock(&tree->lock);\n\tBUG_ON(offset != entry->offset);\n\n\t/* try to allocate swap cache page */\n\tswitch (zswap_get_swap_cache_page(swpentry, &page)) {\n\tcase ZSWAP_SWAPCACHE_FAIL: /* no memory or invalidate happened */\n\t\tret = -ENOMEM;\n\t\tgoto fail;\n\n\tcase ZSWAP_SWAPCACHE_EXIST:\n\t\t/* page is already in the swap cache, ignore for now */\n\t\tput_page(page);\n\t\tret = -EEXIST;\n\t\tgoto fail;\n\n\tcase ZSWAP_SWAPCACHE_NEW: /* page is locked */\n\t\t/* decompress */\n\t\tdlen = PAGE_SIZE;\n\t\tsrc = (u8 *)zpool_map_handle(entry->pool->zpool, entry->handle,\n\t\t\t\tZPOOL_MM_RO) + sizeof(struct zswap_header);\n\t\tdst = kmap_atomic(page);\n\t\ttfm = *get_cpu_ptr(entry->pool->tfm);\n\t\tret = crypto_comp_decompress(tfm, src, entry->length,\n\t\t\t\t\t     dst, &dlen);\n\t\tput_cpu_ptr(entry->pool->tfm);\n\t\tkunmap_atomic(dst);\n\t\tzpool_unmap_handle(entry->pool->zpool, entry->handle);\n\t\tBUG_ON(ret);\n\t\tBUG_ON(dlen != PAGE_SIZE);\n\n\t\t/* page is up to date */\n\t\tSetPageUptodate(page);\n\t}\n\n\t/* move it to the tail of the inactive list after end_writeback */\n\tSetPageReclaim(page);\n\n\t/* start writeback */\n\t__swap_writepage(page, &wbc, end_swap_bio_write);\n\tput_page(page);\n\tzswap_written_back_pages++;\n\n\tspin_lock(&tree->lock);\n\t/* drop local reference */\n\tzswap_entry_put(tree, entry);\n\n\t/*\n\t* There are two possible situations for entry here:\n\t* (1) refcount is 1(normal case),  entry is valid and on the tree\n\t* (2) refcount is 0, entry is freed and not on the tree\n\t*     because invalidate happened during writeback\n\t*  search the tree and free the entry if find entry\n\t*/\n\tif (entry == zswap_rb_search(&tree->rbroot, offset))\n\t\tzswap_entry_put(tree, entry);\n\tspin_unlock(&tree->lock);\n\n\tgoto end;\n\n\t/*\n\t* if we get here due to ZSWAP_SWAPCACHE_EXIST\n\t* a load may happening concurrently\n\t* it is safe and okay to not free the entry\n\t* if we free the entry in the following put\n\t* it it either okay to return !0\n\t*/\nfail:\n\tspin_lock(&tree->lock);\n\tzswap_entry_put(tree, entry);\n\tspin_unlock(&tree->lock);\n\nend:\n\treturn ret;\n}"
  },
  {
    "function_name": "zswap_get_swap_cache_page",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "823-835",
    "snippet": "static int zswap_get_swap_cache_page(swp_entry_t entry,\n\t\t\t\tstruct page **retpage)\n{\n\tbool page_was_allocated;\n\n\t*retpage = __read_swap_cache_async(entry, GFP_KERNEL,\n\t\t\tNULL, 0, &page_was_allocated);\n\tif (page_was_allocated)\n\t\treturn ZSWAP_SWAPCACHE_NEW;\n\tif (!*retpage)\n\t\treturn ZSWAP_SWAPCACHE_FAIL;\n\treturn ZSWAP_SWAPCACHE_EXIST;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__read_swap_cache_async",
          "args": [
            "entry",
            "GFP_KERNEL",
            "NULL",
            "0",
            "&page_was_allocated"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "__read_swap_cache_async",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/swap_state.c",
          "lines": "353-429",
          "snippet": "struct page *__read_swap_cache_async(swp_entry_t entry, gfp_t gfp_mask,\n\t\t\tstruct vm_area_struct *vma, unsigned long addr,\n\t\t\tbool *new_page_allocated)\n{\n\tstruct page *found_page, *new_page = NULL;\n\tstruct address_space *swapper_space = swap_address_space(entry);\n\tint err;\n\t*new_page_allocated = false;\n\n\tdo {\n\t\t/*\n\t\t * First check the swap cache.  Since this is normally\n\t\t * called after lookup_swap_cache() failed, re-calling\n\t\t * that would confuse statistics.\n\t\t */\n\t\tfound_page = find_get_page(swapper_space, swp_offset(entry));\n\t\tif (found_page)\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Just skip read ahead for unused swap slot.\n\t\t * During swap_off when swap_slot_cache is disabled,\n\t\t * we have to handle the race between putting\n\t\t * swap entry in swap cache and marking swap slot\n\t\t * as SWAP_HAS_CACHE.  That's done in later part of code or\n\t\t * else swap_off will be aborted if we return NULL.\n\t\t */\n\t\tif (!__swp_swapcount(entry) && swap_slot_cache_enabled)\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Get a new page to read into from swap.\n\t\t */\n\t\tif (!new_page) {\n\t\t\tnew_page = alloc_page_vma(gfp_mask, vma, addr);\n\t\t\tif (!new_page)\n\t\t\t\tbreak;\t\t/* Out of memory */\n\t\t}\n\n\t\t/*\n\t\t * Swap entry may have been freed since our caller observed it.\n\t\t */\n\t\terr = swapcache_prepare(entry);\n\t\tif (err == -EEXIST) {\n\t\t\t/*\n\t\t\t * We might race against get_swap_page() and stumble\n\t\t\t * across a SWAP_HAS_CACHE swap_map entry whose page\n\t\t\t * has not been brought into the swapcache yet.\n\t\t\t */\n\t\t\tcond_resched();\n\t\t\tcontinue;\n\t\t} else if (err)\t\t/* swp entry is obsolete ? */\n\t\t\tbreak;\n\n\t\t/* May fail (-ENOMEM) if XArray node allocation failed. */\n\t\t__SetPageLocked(new_page);\n\t\t__SetPageSwapBacked(new_page);\n\t\terr = add_to_swap_cache(new_page, entry, gfp_mask & GFP_KERNEL);\n\t\tif (likely(!err)) {\n\t\t\t/* Initiate read into locked page */\n\t\t\tSetPageWorkingset(new_page);\n\t\t\tlru_cache_add_anon(new_page);\n\t\t\t*new_page_allocated = true;\n\t\t\treturn new_page;\n\t\t}\n\t\t__ClearPageLocked(new_page);\n\t\t/*\n\t\t * add_to_swap_cache() doesn't return -EEXIST, so we can safely\n\t\t * clear SWAP_HAS_CACHE flag.\n\t\t */\n\t\tput_swap_page(new_page, entry);\n\t} while (err != -ENOMEM);\n\n\tif (new_page)\n\t\tput_page(new_page);\n\treturn found_page;\n}",
          "includes": [
            "#include <asm/pgtable.h>",
            "#include <linux/huge_mm.h>",
            "#include <linux/swap_slots.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/migrate.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/init.h>",
            "#include <linux/swapops.h>",
            "#include <linux/swap.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/pgtable.h>\n#include <linux/huge_mm.h>\n#include <linux/swap_slots.h>\n#include <linux/vmalloc.h>\n#include <linux/migrate.h>\n#include <linux/pagevec.h>\n#include <linux/blkdev.h>\n#include <linux/backing-dev.h>\n#include <linux/pagemap.h>\n#include <linux/init.h>\n#include <linux/swapops.h>\n#include <linux/swap.h>\n#include <linux/kernel_stat.h>\n#include <linux/gfp.h>\n#include <linux/mm.h>\n\nstruct page *__read_swap_cache_async(swp_entry_t entry, gfp_t gfp_mask,\n\t\t\tstruct vm_area_struct *vma, unsigned long addr,\n\t\t\tbool *new_page_allocated)\n{\n\tstruct page *found_page, *new_page = NULL;\n\tstruct address_space *swapper_space = swap_address_space(entry);\n\tint err;\n\t*new_page_allocated = false;\n\n\tdo {\n\t\t/*\n\t\t * First check the swap cache.  Since this is normally\n\t\t * called after lookup_swap_cache() failed, re-calling\n\t\t * that would confuse statistics.\n\t\t */\n\t\tfound_page = find_get_page(swapper_space, swp_offset(entry));\n\t\tif (found_page)\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Just skip read ahead for unused swap slot.\n\t\t * During swap_off when swap_slot_cache is disabled,\n\t\t * we have to handle the race between putting\n\t\t * swap entry in swap cache and marking swap slot\n\t\t * as SWAP_HAS_CACHE.  That's done in later part of code or\n\t\t * else swap_off will be aborted if we return NULL.\n\t\t */\n\t\tif (!__swp_swapcount(entry) && swap_slot_cache_enabled)\n\t\t\tbreak;\n\n\t\t/*\n\t\t * Get a new page to read into from swap.\n\t\t */\n\t\tif (!new_page) {\n\t\t\tnew_page = alloc_page_vma(gfp_mask, vma, addr);\n\t\t\tif (!new_page)\n\t\t\t\tbreak;\t\t/* Out of memory */\n\t\t}\n\n\t\t/*\n\t\t * Swap entry may have been freed since our caller observed it.\n\t\t */\n\t\terr = swapcache_prepare(entry);\n\t\tif (err == -EEXIST) {\n\t\t\t/*\n\t\t\t * We might race against get_swap_page() and stumble\n\t\t\t * across a SWAP_HAS_CACHE swap_map entry whose page\n\t\t\t * has not been brought into the swapcache yet.\n\t\t\t */\n\t\t\tcond_resched();\n\t\t\tcontinue;\n\t\t} else if (err)\t\t/* swp entry is obsolete ? */\n\t\t\tbreak;\n\n\t\t/* May fail (-ENOMEM) if XArray node allocation failed. */\n\t\t__SetPageLocked(new_page);\n\t\t__SetPageSwapBacked(new_page);\n\t\terr = add_to_swap_cache(new_page, entry, gfp_mask & GFP_KERNEL);\n\t\tif (likely(!err)) {\n\t\t\t/* Initiate read into locked page */\n\t\t\tSetPageWorkingset(new_page);\n\t\t\tlru_cache_add_anon(new_page);\n\t\t\t*new_page_allocated = true;\n\t\t\treturn new_page;\n\t\t}\n\t\t__ClearPageLocked(new_page);\n\t\t/*\n\t\t * add_to_swap_cache() doesn't return -EEXIST, so we can safely\n\t\t * clear SWAP_HAS_CACHE flag.\n\t\t */\n\t\tput_swap_page(new_page, entry);\n\t} while (err != -ENOMEM);\n\n\tif (new_page)\n\t\tput_page(new_page);\n\treturn found_page;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic int zswap_get_swap_cache_page(swp_entry_t entry,\n\t\t\t\tstruct page **retpage)\n{\n\tbool page_was_allocated;\n\n\t*retpage = __read_swap_cache_async(entry, GFP_KERNEL,\n\t\t\tNULL, 0, &page_was_allocated);\n\tif (page_was_allocated)\n\t\treturn ZSWAP_SWAPCACHE_NEW;\n\tif (!*retpage)\n\t\treturn ZSWAP_SWAPCACHE_FAIL;\n\treturn ZSWAP_SWAPCACHE_EXIST;\n}"
  },
  {
    "function_name": "zswap_enabled_param_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "782-795",
    "snippet": "static int zswap_enabled_param_set(const char *val,\n\t\t\t\t   const struct kernel_param *kp)\n{\n\tif (zswap_init_failed) {\n\t\tpr_err(\"can't enable, initialization failed\\n\");\n\t\treturn -ENODEV;\n\t}\n\tif (!zswap_has_pool && zswap_init_started) {\n\t\tpr_err(\"can't enable, no pool configured\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\treturn param_set_bool(val, kp);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);",
      "static int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);",
      "static int zswap_zpool_param_set(const char *, const struct kernel_param *);",
      "static bool zswap_init_started;",
      "static bool zswap_init_failed;",
      "static bool zswap_has_pool;",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "param_set_bool",
          "args": [
            "val",
            "kp"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"can't enable, no pool configured\\n\""
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"can't enable, initialization failed\\n\""
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);\nstatic int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);\nstatic int zswap_zpool_param_set(const char *, const struct kernel_param *);\nstatic bool zswap_init_started;\nstatic bool zswap_init_failed;\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int zswap_enabled_param_set(const char *val,\n\t\t\t\t   const struct kernel_param *kp)\n{\n\tif (zswap_init_failed) {\n\t\tpr_err(\"can't enable, initialization failed\\n\");\n\t\treturn -ENODEV;\n\t}\n\tif (!zswap_has_pool && zswap_init_started) {\n\t\tpr_err(\"can't enable, no pool configured\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\treturn param_set_bool(val, kp);\n}"
  },
  {
    "function_name": "zswap_zpool_param_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "776-780",
    "snippet": "static int zswap_zpool_param_set(const char *val,\n\t\t\t\t const struct kernel_param *kp)\n{\n\treturn __zswap_param_set(val, kp, NULL, zswap_compressor);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);",
      "static char *zswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;",
      "static int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);",
      "static int zswap_zpool_param_set(const char *, const struct kernel_param *);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__zswap_param_set",
          "args": [
            "val",
            "kp",
            "NULL",
            "zswap_compressor"
          ],
          "line": 779
        },
        "resolved": true,
        "details": {
          "function_name": "__zswap_param_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "675-768",
          "snippet": "static int __zswap_param_set(const char *val, const struct kernel_param *kp,\n\t\t\t     char *type, char *compressor)\n{\n\tstruct zswap_pool *pool, *put_pool = NULL;\n\tchar *s = strstrip((char *)val);\n\tint ret;\n\n\tif (zswap_init_failed) {\n\t\tpr_err(\"can't set param, initialization failed\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\t/* no change required */\n\tif (!strcmp(s, *(char **)kp->arg) && zswap_has_pool)\n\t\treturn 0;\n\n\t/* if this is load-time (pre-init) param setting,\n\t * don't create a pool; that's done during init.\n\t */\n\tif (!zswap_init_started)\n\t\treturn param_set_charp(s, kp);\n\n\tif (!type) {\n\t\tif (!zpool_has_pool(s)) {\n\t\t\tpr_err(\"zpool %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\ttype = s;\n\t} else if (!compressor) {\n\t\tif (!crypto_has_comp(s, 0, 0)) {\n\t\t\tpr_err(\"compressor %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcompressor = s;\n\t} else {\n\t\tWARN_ON(1);\n\t\treturn -EINVAL;\n\t}\n\n\tspin_lock(&zswap_pools_lock);\n\n\tpool = zswap_pool_find_get(type, compressor);\n\tif (pool) {\n\t\tzswap_pool_debug(\"using existing\", pool);\n\t\tWARN_ON(pool == zswap_pool_current());\n\t\tlist_del_rcu(&pool->list);\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!pool)\n\t\tpool = zswap_pool_create(type, compressor);\n\n\tif (pool)\n\t\tret = param_set_charp(s, kp);\n\telse\n\t\tret = -EINVAL;\n\n\tspin_lock(&zswap_pools_lock);\n\n\tif (!ret) {\n\t\tput_pool = zswap_pool_current();\n\t\tlist_add_rcu(&pool->list, &zswap_pools);\n\t\tzswap_has_pool = true;\n\t} else if (pool) {\n\t\t/* add the possibly pre-existing pool to the end of the pools\n\t\t * list; if it's new (and empty) then it'll be removed and\n\t\t * destroyed by the put after we drop the lock\n\t\t */\n\t\tlist_add_tail_rcu(&pool->list, &zswap_pools);\n\t\tput_pool = pool;\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!zswap_has_pool && !pool) {\n\t\t/* if initial pool creation failed, and this pool creation also\n\t\t * failed, maybe both compressor and zpool params were bad.\n\t\t * Allow changing this param, so pool creation will succeed\n\t\t * when the other param is changed. We already verified this\n\t\t * param is ok in the zpool_has_pool() or crypto_has_comp()\n\t\t * checks above.\n\t\t */\n\t\tret = param_set_charp(s, kp);\n\t}\n\n\t/* drop the ref from either the old current pool,\n\t * or the new pool we failed to add\n\t */\n\tif (put_pool)\n\t\tzswap_pool_put(put_pool);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);",
            "static int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);",
            "static int zswap_zpool_param_set(const char *, const struct kernel_param *);",
            "static LIST_HEAD(zswap_pools);",
            "static DEFINE_SPINLOCK(zswap_pools_lock);",
            "static bool zswap_init_started;",
            "static bool zswap_init_failed;",
            "static bool zswap_has_pool;",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);\nstatic int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);\nstatic int zswap_zpool_param_set(const char *, const struct kernel_param *);\nstatic LIST_HEAD(zswap_pools);\nstatic DEFINE_SPINLOCK(zswap_pools_lock);\nstatic bool zswap_init_started;\nstatic bool zswap_init_failed;\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int __zswap_param_set(const char *val, const struct kernel_param *kp,\n\t\t\t     char *type, char *compressor)\n{\n\tstruct zswap_pool *pool, *put_pool = NULL;\n\tchar *s = strstrip((char *)val);\n\tint ret;\n\n\tif (zswap_init_failed) {\n\t\tpr_err(\"can't set param, initialization failed\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\t/* no change required */\n\tif (!strcmp(s, *(char **)kp->arg) && zswap_has_pool)\n\t\treturn 0;\n\n\t/* if this is load-time (pre-init) param setting,\n\t * don't create a pool; that's done during init.\n\t */\n\tif (!zswap_init_started)\n\t\treturn param_set_charp(s, kp);\n\n\tif (!type) {\n\t\tif (!zpool_has_pool(s)) {\n\t\t\tpr_err(\"zpool %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\ttype = s;\n\t} else if (!compressor) {\n\t\tif (!crypto_has_comp(s, 0, 0)) {\n\t\t\tpr_err(\"compressor %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcompressor = s;\n\t} else {\n\t\tWARN_ON(1);\n\t\treturn -EINVAL;\n\t}\n\n\tspin_lock(&zswap_pools_lock);\n\n\tpool = zswap_pool_find_get(type, compressor);\n\tif (pool) {\n\t\tzswap_pool_debug(\"using existing\", pool);\n\t\tWARN_ON(pool == zswap_pool_current());\n\t\tlist_del_rcu(&pool->list);\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!pool)\n\t\tpool = zswap_pool_create(type, compressor);\n\n\tif (pool)\n\t\tret = param_set_charp(s, kp);\n\telse\n\t\tret = -EINVAL;\n\n\tspin_lock(&zswap_pools_lock);\n\n\tif (!ret) {\n\t\tput_pool = zswap_pool_current();\n\t\tlist_add_rcu(&pool->list, &zswap_pools);\n\t\tzswap_has_pool = true;\n\t} else if (pool) {\n\t\t/* add the possibly pre-existing pool to the end of the pools\n\t\t * list; if it's new (and empty) then it'll be removed and\n\t\t * destroyed by the put after we drop the lock\n\t\t */\n\t\tlist_add_tail_rcu(&pool->list, &zswap_pools);\n\t\tput_pool = pool;\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!zswap_has_pool && !pool) {\n\t\t/* if initial pool creation failed, and this pool creation also\n\t\t * failed, maybe both compressor and zpool params were bad.\n\t\t * Allow changing this param, so pool creation will succeed\n\t\t * when the other param is changed. We already verified this\n\t\t * param is ok in the zpool_has_pool() or crypto_has_comp()\n\t\t * checks above.\n\t\t */\n\t\tret = param_set_charp(s, kp);\n\t}\n\n\t/* drop the ref from either the old current pool,\n\t * or the new pool we failed to add\n\t */\n\tif (put_pool)\n\t\tzswap_pool_put(put_pool);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);\nstatic char *zswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;\nstatic int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);\nstatic int zswap_zpool_param_set(const char *, const struct kernel_param *);\nstatic __init struct;\n\nstatic int zswap_zpool_param_set(const char *val,\n\t\t\t\t const struct kernel_param *kp)\n{\n\treturn __zswap_param_set(val, kp, NULL, zswap_compressor);\n}"
  },
  {
    "function_name": "zswap_compressor_param_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "770-774",
    "snippet": "static int zswap_compressor_param_set(const char *val,\n\t\t\t\t      const struct kernel_param *kp)\n{\n\treturn __zswap_param_set(val, kp, zswap_zpool_type, NULL);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);",
      "static int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);",
      "static char *zswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;",
      "static int zswap_zpool_param_set(const char *, const struct kernel_param *);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__zswap_param_set",
          "args": [
            "val",
            "kp",
            "zswap_zpool_type",
            "NULL"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "__zswap_param_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "675-768",
          "snippet": "static int __zswap_param_set(const char *val, const struct kernel_param *kp,\n\t\t\t     char *type, char *compressor)\n{\n\tstruct zswap_pool *pool, *put_pool = NULL;\n\tchar *s = strstrip((char *)val);\n\tint ret;\n\n\tif (zswap_init_failed) {\n\t\tpr_err(\"can't set param, initialization failed\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\t/* no change required */\n\tif (!strcmp(s, *(char **)kp->arg) && zswap_has_pool)\n\t\treturn 0;\n\n\t/* if this is load-time (pre-init) param setting,\n\t * don't create a pool; that's done during init.\n\t */\n\tif (!zswap_init_started)\n\t\treturn param_set_charp(s, kp);\n\n\tif (!type) {\n\t\tif (!zpool_has_pool(s)) {\n\t\t\tpr_err(\"zpool %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\ttype = s;\n\t} else if (!compressor) {\n\t\tif (!crypto_has_comp(s, 0, 0)) {\n\t\t\tpr_err(\"compressor %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcompressor = s;\n\t} else {\n\t\tWARN_ON(1);\n\t\treturn -EINVAL;\n\t}\n\n\tspin_lock(&zswap_pools_lock);\n\n\tpool = zswap_pool_find_get(type, compressor);\n\tif (pool) {\n\t\tzswap_pool_debug(\"using existing\", pool);\n\t\tWARN_ON(pool == zswap_pool_current());\n\t\tlist_del_rcu(&pool->list);\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!pool)\n\t\tpool = zswap_pool_create(type, compressor);\n\n\tif (pool)\n\t\tret = param_set_charp(s, kp);\n\telse\n\t\tret = -EINVAL;\n\n\tspin_lock(&zswap_pools_lock);\n\n\tif (!ret) {\n\t\tput_pool = zswap_pool_current();\n\t\tlist_add_rcu(&pool->list, &zswap_pools);\n\t\tzswap_has_pool = true;\n\t} else if (pool) {\n\t\t/* add the possibly pre-existing pool to the end of the pools\n\t\t * list; if it's new (and empty) then it'll be removed and\n\t\t * destroyed by the put after we drop the lock\n\t\t */\n\t\tlist_add_tail_rcu(&pool->list, &zswap_pools);\n\t\tput_pool = pool;\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!zswap_has_pool && !pool) {\n\t\t/* if initial pool creation failed, and this pool creation also\n\t\t * failed, maybe both compressor and zpool params were bad.\n\t\t * Allow changing this param, so pool creation will succeed\n\t\t * when the other param is changed. We already verified this\n\t\t * param is ok in the zpool_has_pool() or crypto_has_comp()\n\t\t * checks above.\n\t\t */\n\t\tret = param_set_charp(s, kp);\n\t}\n\n\t/* drop the ref from either the old current pool,\n\t * or the new pool we failed to add\n\t */\n\tif (put_pool)\n\t\tzswap_pool_put(put_pool);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);",
            "static int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);",
            "static int zswap_zpool_param_set(const char *, const struct kernel_param *);",
            "static LIST_HEAD(zswap_pools);",
            "static DEFINE_SPINLOCK(zswap_pools_lock);",
            "static bool zswap_init_started;",
            "static bool zswap_init_failed;",
            "static bool zswap_has_pool;",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);\nstatic int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);\nstatic int zswap_zpool_param_set(const char *, const struct kernel_param *);\nstatic LIST_HEAD(zswap_pools);\nstatic DEFINE_SPINLOCK(zswap_pools_lock);\nstatic bool zswap_init_started;\nstatic bool zswap_init_failed;\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int __zswap_param_set(const char *val, const struct kernel_param *kp,\n\t\t\t     char *type, char *compressor)\n{\n\tstruct zswap_pool *pool, *put_pool = NULL;\n\tchar *s = strstrip((char *)val);\n\tint ret;\n\n\tif (zswap_init_failed) {\n\t\tpr_err(\"can't set param, initialization failed\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\t/* no change required */\n\tif (!strcmp(s, *(char **)kp->arg) && zswap_has_pool)\n\t\treturn 0;\n\n\t/* if this is load-time (pre-init) param setting,\n\t * don't create a pool; that's done during init.\n\t */\n\tif (!zswap_init_started)\n\t\treturn param_set_charp(s, kp);\n\n\tif (!type) {\n\t\tif (!zpool_has_pool(s)) {\n\t\t\tpr_err(\"zpool %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\ttype = s;\n\t} else if (!compressor) {\n\t\tif (!crypto_has_comp(s, 0, 0)) {\n\t\t\tpr_err(\"compressor %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcompressor = s;\n\t} else {\n\t\tWARN_ON(1);\n\t\treturn -EINVAL;\n\t}\n\n\tspin_lock(&zswap_pools_lock);\n\n\tpool = zswap_pool_find_get(type, compressor);\n\tif (pool) {\n\t\tzswap_pool_debug(\"using existing\", pool);\n\t\tWARN_ON(pool == zswap_pool_current());\n\t\tlist_del_rcu(&pool->list);\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!pool)\n\t\tpool = zswap_pool_create(type, compressor);\n\n\tif (pool)\n\t\tret = param_set_charp(s, kp);\n\telse\n\t\tret = -EINVAL;\n\n\tspin_lock(&zswap_pools_lock);\n\n\tif (!ret) {\n\t\tput_pool = zswap_pool_current();\n\t\tlist_add_rcu(&pool->list, &zswap_pools);\n\t\tzswap_has_pool = true;\n\t} else if (pool) {\n\t\t/* add the possibly pre-existing pool to the end of the pools\n\t\t * list; if it's new (and empty) then it'll be removed and\n\t\t * destroyed by the put after we drop the lock\n\t\t */\n\t\tlist_add_tail_rcu(&pool->list, &zswap_pools);\n\t\tput_pool = pool;\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!zswap_has_pool && !pool) {\n\t\t/* if initial pool creation failed, and this pool creation also\n\t\t * failed, maybe both compressor and zpool params were bad.\n\t\t * Allow changing this param, so pool creation will succeed\n\t\t * when the other param is changed. We already verified this\n\t\t * param is ok in the zpool_has_pool() or crypto_has_comp()\n\t\t * checks above.\n\t\t */\n\t\tret = param_set_charp(s, kp);\n\t}\n\n\t/* drop the ref from either the old current pool,\n\t * or the new pool we failed to add\n\t */\n\tif (put_pool)\n\t\tzswap_pool_put(put_pool);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);\nstatic int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);\nstatic char *zswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;\nstatic int zswap_zpool_param_set(const char *, const struct kernel_param *);\nstatic __init struct;\n\nstatic int zswap_compressor_param_set(const char *val,\n\t\t\t\t      const struct kernel_param *kp)\n{\n\treturn __zswap_param_set(val, kp, zswap_zpool_type, NULL);\n}"
  },
  {
    "function_name": "__zswap_param_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "675-768",
    "snippet": "static int __zswap_param_set(const char *val, const struct kernel_param *kp,\n\t\t\t     char *type, char *compressor)\n{\n\tstruct zswap_pool *pool, *put_pool = NULL;\n\tchar *s = strstrip((char *)val);\n\tint ret;\n\n\tif (zswap_init_failed) {\n\t\tpr_err(\"can't set param, initialization failed\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\t/* no change required */\n\tif (!strcmp(s, *(char **)kp->arg) && zswap_has_pool)\n\t\treturn 0;\n\n\t/* if this is load-time (pre-init) param setting,\n\t * don't create a pool; that's done during init.\n\t */\n\tif (!zswap_init_started)\n\t\treturn param_set_charp(s, kp);\n\n\tif (!type) {\n\t\tif (!zpool_has_pool(s)) {\n\t\t\tpr_err(\"zpool %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\ttype = s;\n\t} else if (!compressor) {\n\t\tif (!crypto_has_comp(s, 0, 0)) {\n\t\t\tpr_err(\"compressor %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcompressor = s;\n\t} else {\n\t\tWARN_ON(1);\n\t\treturn -EINVAL;\n\t}\n\n\tspin_lock(&zswap_pools_lock);\n\n\tpool = zswap_pool_find_get(type, compressor);\n\tif (pool) {\n\t\tzswap_pool_debug(\"using existing\", pool);\n\t\tWARN_ON(pool == zswap_pool_current());\n\t\tlist_del_rcu(&pool->list);\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!pool)\n\t\tpool = zswap_pool_create(type, compressor);\n\n\tif (pool)\n\t\tret = param_set_charp(s, kp);\n\telse\n\t\tret = -EINVAL;\n\n\tspin_lock(&zswap_pools_lock);\n\n\tif (!ret) {\n\t\tput_pool = zswap_pool_current();\n\t\tlist_add_rcu(&pool->list, &zswap_pools);\n\t\tzswap_has_pool = true;\n\t} else if (pool) {\n\t\t/* add the possibly pre-existing pool to the end of the pools\n\t\t * list; if it's new (and empty) then it'll be removed and\n\t\t * destroyed by the put after we drop the lock\n\t\t */\n\t\tlist_add_tail_rcu(&pool->list, &zswap_pools);\n\t\tput_pool = pool;\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!zswap_has_pool && !pool) {\n\t\t/* if initial pool creation failed, and this pool creation also\n\t\t * failed, maybe both compressor and zpool params were bad.\n\t\t * Allow changing this param, so pool creation will succeed\n\t\t * when the other param is changed. We already verified this\n\t\t * param is ok in the zpool_has_pool() or crypto_has_comp()\n\t\t * checks above.\n\t\t */\n\t\tret = param_set_charp(s, kp);\n\t}\n\n\t/* drop the ref from either the old current pool,\n\t * or the new pool we failed to add\n\t */\n\tif (put_pool)\n\t\tzswap_pool_put(put_pool);\n\n\treturn ret;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);",
      "static int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);",
      "static int zswap_zpool_param_set(const char *, const struct kernel_param *);",
      "static LIST_HEAD(zswap_pools);",
      "static DEFINE_SPINLOCK(zswap_pools_lock);",
      "static bool zswap_init_started;",
      "static bool zswap_init_failed;",
      "static bool zswap_has_pool;",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_pool_put",
          "args": [
            "put_pool"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "665-668",
          "snippet": "static void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}"
        }
      },
      {
        "call_info": {
          "callee": "param_set_charp",
          "args": [
            "s",
            "kp"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&zswap_pools_lock"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail_rcu",
          "args": [
            "&pool->list",
            "&zswap_pools"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_rcu",
          "args": [
            "&pool->list",
            "&zswap_pools"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_current",
          "args": [],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_current_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "459-472",
          "snippet": "static struct zswap_pool *zswap_pool_current_get(void)\n{\n\tstruct zswap_pool *pool;\n\n\trcu_read_lock();\n\n\tpool = __zswap_pool_current();\n\tif (!zswap_pool_get(pool))\n\t\tpool = NULL;\n\n\trcu_read_unlock();\n\n\treturn pool;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_current_get(void)\n{\n\tstruct zswap_pool *pool;\n\n\trcu_read_lock();\n\n\tpool = __zswap_pool_current();\n\tif (!zswap_pool_get(pool))\n\t\tpool = NULL;\n\n\trcu_read_unlock();\n\n\treturn pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&zswap_pools_lock"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "param_set_charp",
          "args": [
            "s",
            "kp"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_create",
          "args": [
            "type",
            "compressor"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "513-574",
          "snippet": "static struct zswap_pool *zswap_pool_create(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\tchar name[38]; /* 'zswap' + 32 char (max) num + \\0 */\n\tgfp_t gfp = __GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM;\n\tint ret;\n\n\tif (!zswap_has_pool) {\n\t\t/* if either are unset, pool initialization failed, and we\n\t\t * need both params to be set correctly before trying to\n\t\t * create a pool.\n\t\t */\n\t\tif (!strcmp(type, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t\tif (!strcmp(compressor, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t}\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\t/* unique name for each pool specifically required by zsmalloc */\n\tsnprintf(name, 38, \"zswap%x\", atomic_inc_return(&zswap_pools_count));\n\n\tpool->zpool = zpool_create_pool(type, name, gfp, &zswap_zpool_ops);\n\tif (!pool->zpool) {\n\t\tpr_err(\"%s zpool not available\\n\", type);\n\t\tgoto error;\n\t}\n\tpr_debug(\"using %s zpool\\n\", zpool_get_type(pool->zpool));\n\n\tstrlcpy(pool->tfm_name, compressor, sizeof(pool->tfm_name));\n\tpool->tfm = alloc_percpu(struct crypto_comp *);\n\tif (!pool->tfm) {\n\t\tpr_err(\"percpu alloc failed\\n\");\n\t\tgoto error;\n\t}\n\n\tret = cpuhp_state_add_instance(CPUHP_MM_ZSWP_POOL_PREPARE,\n\t\t\t\t       &pool->node);\n\tif (ret)\n\t\tgoto error;\n\tpr_debug(\"using %s compressor\\n\", pool->tfm_name);\n\n\t/* being the current pool takes 1 ref; this func expects the\n\t * caller to always add the new pool as the current pool\n\t */\n\tkref_init(&pool->kref);\n\tINIT_LIST_HEAD(&pool->list);\n\n\tzswap_pool_debug(\"created\", pool);\n\n\treturn pool;\n\nerror:\n\tfree_percpu(pool->tfm);\n\tif (pool->zpool)\n\t\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSWAP_PARAM_UNSET \"\""
          ],
          "globals_used": [
            "static atomic_t zswap_pools_count = ATOMIC_INIT(0);",
            "static bool zswap_has_pool;",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static const struct zpool_ops zswap_zpool_ops = {\n\t.evict = zswap_writeback_entry\n};",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\n#define ZSWAP_PARAM_UNSET \"\"\n\nstatic atomic_t zswap_pools_count = ATOMIC_INIT(0);\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic const struct zpool_ops zswap_zpool_ops = {\n\t.evict = zswap_writeback_entry\n};\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_create(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\tchar name[38]; /* 'zswap' + 32 char (max) num + \\0 */\n\tgfp_t gfp = __GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM;\n\tint ret;\n\n\tif (!zswap_has_pool) {\n\t\t/* if either are unset, pool initialization failed, and we\n\t\t * need both params to be set correctly before trying to\n\t\t * create a pool.\n\t\t */\n\t\tif (!strcmp(type, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t\tif (!strcmp(compressor, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t}\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\t/* unique name for each pool specifically required by zsmalloc */\n\tsnprintf(name, 38, \"zswap%x\", atomic_inc_return(&zswap_pools_count));\n\n\tpool->zpool = zpool_create_pool(type, name, gfp, &zswap_zpool_ops);\n\tif (!pool->zpool) {\n\t\tpr_err(\"%s zpool not available\\n\", type);\n\t\tgoto error;\n\t}\n\tpr_debug(\"using %s zpool\\n\", zpool_get_type(pool->zpool));\n\n\tstrlcpy(pool->tfm_name, compressor, sizeof(pool->tfm_name));\n\tpool->tfm = alloc_percpu(struct crypto_comp *);\n\tif (!pool->tfm) {\n\t\tpr_err(\"percpu alloc failed\\n\");\n\t\tgoto error;\n\t}\n\n\tret = cpuhp_state_add_instance(CPUHP_MM_ZSWP_POOL_PREPARE,\n\t\t\t\t       &pool->node);\n\tif (ret)\n\t\tgoto error;\n\tpr_debug(\"using %s compressor\\n\", pool->tfm_name);\n\n\t/* being the current pool takes 1 ref; this func expects the\n\t * caller to always add the new pool as the current pool\n\t */\n\tkref_init(&pool->kref);\n\tINIT_LIST_HEAD(&pool->list);\n\n\tzswap_pool_debug(\"created\", pool);\n\n\treturn pool;\n\nerror:\n\tfree_percpu(pool->tfm);\n\tif (pool->zpool)\n\t\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&zswap_pools_lock"
          ],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&pool->list"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "pool == zswap_pool_current()"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_debug",
          "args": [
            "\"using existing\"",
            "pool"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_find_get",
          "args": [
            "type",
            "compressor"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_find_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "493-511",
          "snippet": "static struct zswap_pool *zswap_pool_find_get(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\n\tassert_spin_locked(&zswap_pools_lock);\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list) {\n\t\tif (strcmp(pool->tfm_name, compressor))\n\t\t\tcontinue;\n\t\tif (strcmp(zpool_get_type(pool->zpool), type))\n\t\t\tcontinue;\n\t\t/* if we can't get it, it's about to be destroyed */\n\t\tif (!zswap_pool_get(pool))\n\t\t\tcontinue;\n\t\treturn pool;\n\t}\n\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(zswap_pools);",
            "static DEFINE_SPINLOCK(zswap_pools_lock);",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(zswap_pools);\nstatic DEFINE_SPINLOCK(zswap_pools_lock);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_find_get(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\n\tassert_spin_locked(&zswap_pools_lock);\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list) {\n\t\tif (strcmp(pool->tfm_name, compressor))\n\t\t\tcontinue;\n\t\tif (strcmp(zpool_get_type(pool->zpool), type))\n\t\t\tcontinue;\n\t\t/* if we can't get it, it's about to be destroyed */\n\t\tif (!zswap_pool_get(pool))\n\t\t\tcontinue;\n\t\treturn pool;\n\t}\n\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&zswap_pools_lock"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "1"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"compressor %s not available\\n\"",
            "s"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crypto_has_comp",
          "args": [
            "s",
            "0",
            "0"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"zpool %s not available\\n\"",
            "s"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_has_pool",
          "args": [
            "s"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_has_pool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "120-134",
          "snippet": "bool zpool_has_pool(char *type)\n{\n\tstruct zpool_driver *driver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver)\n\t\treturn false;\n\n\tzpool_put_driver(driver);\n\treturn true;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nbool zpool_has_pool(char *type)\n{\n\tstruct zpool_driver *driver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver)\n\t\treturn false;\n\n\tzpool_put_driver(driver);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "param_set_charp",
          "args": [
            "s",
            "kp"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "s",
            "*(char **)kp->arg"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"can't set param, initialization failed\\n\""
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstrip",
          "args": [
            "(char *)val"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_enabled_param_set(const char *,\n\t\t\t\t   const struct kernel_param *);\nstatic int zswap_compressor_param_set(const char *,\n\t\t\t\t      const struct kernel_param *);\nstatic int zswap_zpool_param_set(const char *, const struct kernel_param *);\nstatic LIST_HEAD(zswap_pools);\nstatic DEFINE_SPINLOCK(zswap_pools_lock);\nstatic bool zswap_init_started;\nstatic bool zswap_init_failed;\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int __zswap_param_set(const char *val, const struct kernel_param *kp,\n\t\t\t     char *type, char *compressor)\n{\n\tstruct zswap_pool *pool, *put_pool = NULL;\n\tchar *s = strstrip((char *)val);\n\tint ret;\n\n\tif (zswap_init_failed) {\n\t\tpr_err(\"can't set param, initialization failed\\n\");\n\t\treturn -ENODEV;\n\t}\n\n\t/* no change required */\n\tif (!strcmp(s, *(char **)kp->arg) && zswap_has_pool)\n\t\treturn 0;\n\n\t/* if this is load-time (pre-init) param setting,\n\t * don't create a pool; that's done during init.\n\t */\n\tif (!zswap_init_started)\n\t\treturn param_set_charp(s, kp);\n\n\tif (!type) {\n\t\tif (!zpool_has_pool(s)) {\n\t\t\tpr_err(\"zpool %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\ttype = s;\n\t} else if (!compressor) {\n\t\tif (!crypto_has_comp(s, 0, 0)) {\n\t\t\tpr_err(\"compressor %s not available\\n\", s);\n\t\t\treturn -ENOENT;\n\t\t}\n\t\tcompressor = s;\n\t} else {\n\t\tWARN_ON(1);\n\t\treturn -EINVAL;\n\t}\n\n\tspin_lock(&zswap_pools_lock);\n\n\tpool = zswap_pool_find_get(type, compressor);\n\tif (pool) {\n\t\tzswap_pool_debug(\"using existing\", pool);\n\t\tWARN_ON(pool == zswap_pool_current());\n\t\tlist_del_rcu(&pool->list);\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!pool)\n\t\tpool = zswap_pool_create(type, compressor);\n\n\tif (pool)\n\t\tret = param_set_charp(s, kp);\n\telse\n\t\tret = -EINVAL;\n\n\tspin_lock(&zswap_pools_lock);\n\n\tif (!ret) {\n\t\tput_pool = zswap_pool_current();\n\t\tlist_add_rcu(&pool->list, &zswap_pools);\n\t\tzswap_has_pool = true;\n\t} else if (pool) {\n\t\t/* add the possibly pre-existing pool to the end of the pools\n\t\t * list; if it's new (and empty) then it'll be removed and\n\t\t * destroyed by the put after we drop the lock\n\t\t */\n\t\tlist_add_tail_rcu(&pool->list, &zswap_pools);\n\t\tput_pool = pool;\n\t}\n\n\tspin_unlock(&zswap_pools_lock);\n\n\tif (!zswap_has_pool && !pool) {\n\t\t/* if initial pool creation failed, and this pool creation also\n\t\t * failed, maybe both compressor and zpool params were bad.\n\t\t * Allow changing this param, so pool creation will succeed\n\t\t * when the other param is changed. We already verified this\n\t\t * param is ok in the zpool_has_pool() or crypto_has_comp()\n\t\t * checks above.\n\t\t */\n\t\tret = param_set_charp(s, kp);\n\t}\n\n\t/* drop the ref from either the old current pool,\n\t * or the new pool we failed to add\n\t */\n\tif (put_pool)\n\t\tzswap_pool_put(put_pool);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "zswap_pool_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "665-668",
    "snippet": "static void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_put",
          "args": [
            "&pool->kref",
            "__zswap_pool_empty"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}"
  },
  {
    "function_name": "__zswap_pool_empty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "647-663",
    "snippet": "static void __zswap_pool_empty(struct kref *kref)\n{\n\tstruct zswap_pool *pool;\n\n\tpool = container_of(kref, typeof(*pool), kref);\n\n\tspin_lock(&zswap_pools_lock);\n\n\tWARN_ON(pool == zswap_pool_current());\n\n\tlist_del_rcu(&pool->list);\n\n\tINIT_WORK(&pool->work, __zswap_pool_release);\n\tschedule_work(&pool->work);\n\n\tspin_unlock(&zswap_pools_lock);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(zswap_pools_lock);",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock",
          "args": [
            "&zswap_pools_lock"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedule_work",
          "args": [
            "&pool->work"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_WORK",
          "args": [
            "&pool->work",
            "__zswap_pool_release"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&pool->list"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "pool == zswap_pool_current()"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_current",
          "args": [],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_current_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "459-472",
          "snippet": "static struct zswap_pool *zswap_pool_current_get(void)\n{\n\tstruct zswap_pool *pool;\n\n\trcu_read_lock();\n\n\tpool = __zswap_pool_current();\n\tif (!zswap_pool_get(pool))\n\t\tpool = NULL;\n\n\trcu_read_unlock();\n\n\treturn pool;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_current_get(void)\n{\n\tstruct zswap_pool *pool;\n\n\trcu_read_lock();\n\n\tpool = __zswap_pool_current();\n\tif (!zswap_pool_get(pool))\n\t\tpool = NULL;\n\n\trcu_read_unlock();\n\n\treturn pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock",
          "args": [
            "&zswap_pools_lock"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kref",
            "typeof(*pool)",
            "kref"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeof",
          "args": [
            "*pool"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(zswap_pools_lock);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void __zswap_pool_empty(struct kref *kref)\n{\n\tstruct zswap_pool *pool;\n\n\tpool = container_of(kref, typeof(*pool), kref);\n\n\tspin_lock(&zswap_pools_lock);\n\n\tWARN_ON(pool == zswap_pool_current());\n\n\tlist_del_rcu(&pool->list);\n\n\tINIT_WORK(&pool->work, __zswap_pool_release);\n\tschedule_work(&pool->work);\n\n\tspin_unlock(&zswap_pools_lock);\n}"
  },
  {
    "function_name": "__zswap_pool_release",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "634-645",
    "snippet": "static void __zswap_pool_release(struct work_struct *work)\n{\n\tstruct zswap_pool *pool = container_of(work, typeof(*pool), work);\n\n\tsynchronize_rcu();\n\n\t/* nobody should have been able to get a kref... */\n\tWARN_ON(kref_get_unless_zero(&pool->kref));\n\n\t/* pool is now off zswap_pools list and has no references. */\n\tzswap_pool_destroy(pool);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(zswap_pools);",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_pool_destroy",
          "args": [
            "pool"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "616-624",
          "snippet": "static void zswap_pool_destroy(struct zswap_pool *pool)\n{\n\tzswap_pool_debug(\"destroying\", pool);\n\n\tcpuhp_state_remove_instance(CPUHP_MM_ZSWP_POOL_PREPARE, &pool->node);\n\tfree_percpu(pool->tfm);\n\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_pool_destroy(struct zswap_pool *pool)\n{\n\tzswap_pool_debug(\"destroying\", pool);\n\n\tcpuhp_state_remove_instance(CPUHP_MM_ZSWP_POOL_PREPARE, &pool->node);\n\tfree_percpu(pool->tfm);\n\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "kref_get_unless_zero(&pool->kref)"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kref_get_unless_zero",
          "args": [
            "&pool->kref"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "synchronize_rcu",
          "args": [],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "work",
            "typeof(*pool)",
            "work"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeof",
          "args": [
            "*pool"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(zswap_pools);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void __zswap_pool_release(struct work_struct *work)\n{\n\tstruct zswap_pool *pool = container_of(work, typeof(*pool), work);\n\n\tsynchronize_rcu();\n\n\t/* nobody should have been able to get a kref... */\n\tWARN_ON(kref_get_unless_zero(&pool->kref));\n\n\t/* pool is now off zswap_pools list and has no references. */\n\tzswap_pool_destroy(pool);\n}"
  },
  {
    "function_name": "zswap_pool_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "626-632",
    "snippet": "static int __must_check zswap_pool_get(struct zswap_pool *pool)\n{\n\tif (!pool)\n\t\treturn 0;\n\n\treturn kref_get_unless_zero(&pool->kref);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kref_get_unless_zero",
          "args": [
            "&pool->kref"
          ],
          "line": 631
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int __must_check zswap_pool_get(struct zswap_pool *pool)\n{\n\tif (!pool)\n\t\treturn 0;\n\n\treturn kref_get_unless_zero(&pool->kref);\n}"
  },
  {
    "function_name": "zswap_pool_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "616-624",
    "snippet": "static void zswap_pool_destroy(struct zswap_pool *pool)\n{\n\tzswap_pool_debug(\"destroying\", pool);\n\n\tcpuhp_state_remove_instance(CPUHP_MM_ZSWP_POOL_PREPARE, &pool->node);\n\tfree_percpu(pool->tfm);\n\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "pool"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_destroy_pool",
          "args": [
            "pool->zpool"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_destroy_pool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "213-223",
          "snippet": "void zpool_destroy_pool(struct zpool *zpool)\n{\n\tpr_debug(\"destroying pool type %s\\n\", zpool->driver->type);\n\n\tspin_lock(&pools_lock);\n\tlist_del(&zpool->list);\n\tspin_unlock(&pools_lock);\n\tzpool->driver->destroy(zpool->pool);\n\tzpool_put_driver(zpool->driver);\n\tkfree(zpool);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(pools_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(pools_lock);\n\nvoid zpool_destroy_pool(struct zpool *zpool)\n{\n\tpr_debug(\"destroying pool type %s\\n\", zpool->driver->type);\n\n\tspin_lock(&pools_lock);\n\tlist_del(&zpool->list);\n\tspin_unlock(&pools_lock);\n\tzpool->driver->destroy(zpool->pool);\n\tzpool_put_driver(zpool->driver);\n\tkfree(zpool);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_percpu",
          "args": [
            "pool->tfm"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "free_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "1718-1753",
          "snippet": "void free_percpu(void __percpu *ptr)\n{\n\tvoid *addr;\n\tstruct pcpu_chunk *chunk;\n\tunsigned long flags;\n\tint off;\n\n\tif (!ptr)\n\t\treturn;\n\n\tkmemleak_free_percpu(ptr);\n\n\taddr = __pcpu_ptr_to_addr(ptr);\n\n\tspin_lock_irqsave(&pcpu_lock, flags);\n\n\tchunk = pcpu_chunk_addr_search(addr);\n\toff = addr - chunk->base_addr;\n\n\tpcpu_free_area(chunk, off);\n\n\t/* if there are more than one fully free chunks, wake up grim reaper */\n\tif (chunk->free_bytes == pcpu_unit_size) {\n\t\tstruct pcpu_chunk *pos;\n\n\t\tlist_for_each_entry(pos, &pcpu_slot[pcpu_nr_slots - 1], list)\n\t\t\tif (pos != chunk) {\n\t\t\t\tpcpu_schedule_balance_work();\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\n\ttrace_percpu_free_percpu(chunk->base_addr, off, ptr);\n\n\tspin_unlock_irqrestore(&pcpu_lock, flags);\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int pcpu_unit_size",
            "int pcpu_nr_slots",
            "static void pcpu_destroy_chunk(struct pcpu_chunk *chunk);",
            "static struct page *pcpu_addr_to_page(void *addr);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic int pcpu_unit_size;\nint pcpu_nr_slots;\nstatic void pcpu_destroy_chunk(struct pcpu_chunk *chunk);\nstatic struct page *pcpu_addr_to_page(void *addr);\n\nvoid free_percpu(void __percpu *ptr)\n{\n\tvoid *addr;\n\tstruct pcpu_chunk *chunk;\n\tunsigned long flags;\n\tint off;\n\n\tif (!ptr)\n\t\treturn;\n\n\tkmemleak_free_percpu(ptr);\n\n\taddr = __pcpu_ptr_to_addr(ptr);\n\n\tspin_lock_irqsave(&pcpu_lock, flags);\n\n\tchunk = pcpu_chunk_addr_search(addr);\n\toff = addr - chunk->base_addr;\n\n\tpcpu_free_area(chunk, off);\n\n\t/* if there are more than one fully free chunks, wake up grim reaper */\n\tif (chunk->free_bytes == pcpu_unit_size) {\n\t\tstruct pcpu_chunk *pos;\n\n\t\tlist_for_each_entry(pos, &pcpu_slot[pcpu_nr_slots - 1], list)\n\t\t\tif (pos != chunk) {\n\t\t\t\tpcpu_schedule_balance_work();\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\n\ttrace_percpu_free_percpu(chunk->base_addr, off, ptr);\n\n\tspin_unlock_irqrestore(&pcpu_lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpuhp_state_remove_instance",
          "args": [
            "CPUHP_MM_ZSWP_POOL_PREPARE",
            "&pool->node"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_debug",
          "args": [
            "\"destroying\"",
            "pool"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_pool_destroy(struct zswap_pool *pool)\n{\n\tzswap_pool_debug(\"destroying\", pool);\n\n\tcpuhp_state_remove_instance(CPUHP_MM_ZSWP_POOL_PREPARE, &pool->node);\n\tfree_percpu(pool->tfm);\n\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n}"
  },
  {
    "function_name": "__zswap_pool_create_fallback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "576-614",
    "snippet": "zswap_pool *__zswap_pool_create_fallback(void)\n{\n\tbool has_comp, has_zpool;\n\n\thas_comp = crypto_has_comp(zswap_compressor, 0, 0);\n\tif (!has_comp && strcmp(zswap_compressor, ZSWAP_COMPRESSOR_DEFAULT)) {\n\t\tpr_err(\"compressor %s not available, using default %s\\n\",\n\t\t       zswap_compressor, ZSWAP_COMPRESSOR_DEFAULT);\n\t\tparam_free_charp(&zswap_compressor);\n\t\tzswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;\n\t\thas_comp = crypto_has_comp(zswap_compressor, 0, 0);\n\t}\n\tif (!has_comp) {\n\t\tpr_err(\"default compressor %s not available\\n\",\n\t\t       zswap_compressor);\n\t\tparam_free_charp(&zswap_compressor);\n\t\tzswap_compressor = ZSWAP_PARAM_UNSET;\n\t}\n\n\thas_zpool = zpool_has_pool(zswap_zpool_type);\n\tif (!has_zpool && strcmp(zswap_zpool_type, ZSWAP_ZPOOL_DEFAULT)) {\n\t\tpr_err(\"zpool %s not available, using default %s\\n\",\n\t\t       zswap_zpool_type, ZSWAP_ZPOOL_DEFAULT);\n\t\tparam_free_charp(&zswap_zpool_type);\n\t\tzswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;\n\t\thas_zpool = zpool_has_pool(zswap_zpool_type);\n\t}\n\tif (!has_zpool) {\n\t\tpr_err(\"default zpool %s not available\\n\",\n\t\t       zswap_zpool_type);\n\t\tparam_free_charp(&zswap_zpool_type);\n\t\tzswap_zpool_type = ZSWAP_PARAM_UNSET;\n\t}\n\n\tif (!has_comp || !has_zpool)\n\t\treturn NULL;\n\n\treturn zswap_pool_create(zswap_zpool_type, zswap_compressor);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZSWAP_ZPOOL_DEFAULT \"zbud\"",
      "#define ZSWAP_COMPRESSOR_DEFAULT \"lzo\"",
      "#define ZSWAP_PARAM_UNSET \"\""
    ],
    "globals_used": [
      "static char *zswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;",
      "static char *zswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_pool_create",
          "args": [
            "zswap_zpool_type",
            "zswap_compressor"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_create",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "513-574",
          "snippet": "static struct zswap_pool *zswap_pool_create(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\tchar name[38]; /* 'zswap' + 32 char (max) num + \\0 */\n\tgfp_t gfp = __GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM;\n\tint ret;\n\n\tif (!zswap_has_pool) {\n\t\t/* if either are unset, pool initialization failed, and we\n\t\t * need both params to be set correctly before trying to\n\t\t * create a pool.\n\t\t */\n\t\tif (!strcmp(type, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t\tif (!strcmp(compressor, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t}\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\t/* unique name for each pool specifically required by zsmalloc */\n\tsnprintf(name, 38, \"zswap%x\", atomic_inc_return(&zswap_pools_count));\n\n\tpool->zpool = zpool_create_pool(type, name, gfp, &zswap_zpool_ops);\n\tif (!pool->zpool) {\n\t\tpr_err(\"%s zpool not available\\n\", type);\n\t\tgoto error;\n\t}\n\tpr_debug(\"using %s zpool\\n\", zpool_get_type(pool->zpool));\n\n\tstrlcpy(pool->tfm_name, compressor, sizeof(pool->tfm_name));\n\tpool->tfm = alloc_percpu(struct crypto_comp *);\n\tif (!pool->tfm) {\n\t\tpr_err(\"percpu alloc failed\\n\");\n\t\tgoto error;\n\t}\n\n\tret = cpuhp_state_add_instance(CPUHP_MM_ZSWP_POOL_PREPARE,\n\t\t\t\t       &pool->node);\n\tif (ret)\n\t\tgoto error;\n\tpr_debug(\"using %s compressor\\n\", pool->tfm_name);\n\n\t/* being the current pool takes 1 ref; this func expects the\n\t * caller to always add the new pool as the current pool\n\t */\n\tkref_init(&pool->kref);\n\tINIT_LIST_HEAD(&pool->list);\n\n\tzswap_pool_debug(\"created\", pool);\n\n\treturn pool;\n\nerror:\n\tfree_percpu(pool->tfm);\n\tif (pool->zpool)\n\t\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ZSWAP_PARAM_UNSET \"\""
          ],
          "globals_used": [
            "static atomic_t zswap_pools_count = ATOMIC_INIT(0);",
            "static bool zswap_has_pool;",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static const struct zpool_ops zswap_zpool_ops = {\n\t.evict = zswap_writeback_entry\n};",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\n#define ZSWAP_PARAM_UNSET \"\"\n\nstatic atomic_t zswap_pools_count = ATOMIC_INIT(0);\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic const struct zpool_ops zswap_zpool_ops = {\n\t.evict = zswap_writeback_entry\n};\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_create(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\tchar name[38]; /* 'zswap' + 32 char (max) num + \\0 */\n\tgfp_t gfp = __GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM;\n\tint ret;\n\n\tif (!zswap_has_pool) {\n\t\t/* if either are unset, pool initialization failed, and we\n\t\t * need both params to be set correctly before trying to\n\t\t * create a pool.\n\t\t */\n\t\tif (!strcmp(type, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t\tif (!strcmp(compressor, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t}\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\t/* unique name for each pool specifically required by zsmalloc */\n\tsnprintf(name, 38, \"zswap%x\", atomic_inc_return(&zswap_pools_count));\n\n\tpool->zpool = zpool_create_pool(type, name, gfp, &zswap_zpool_ops);\n\tif (!pool->zpool) {\n\t\tpr_err(\"%s zpool not available\\n\", type);\n\t\tgoto error;\n\t}\n\tpr_debug(\"using %s zpool\\n\", zpool_get_type(pool->zpool));\n\n\tstrlcpy(pool->tfm_name, compressor, sizeof(pool->tfm_name));\n\tpool->tfm = alloc_percpu(struct crypto_comp *);\n\tif (!pool->tfm) {\n\t\tpr_err(\"percpu alloc failed\\n\");\n\t\tgoto error;\n\t}\n\n\tret = cpuhp_state_add_instance(CPUHP_MM_ZSWP_POOL_PREPARE,\n\t\t\t\t       &pool->node);\n\tif (ret)\n\t\tgoto error;\n\tpr_debug(\"using %s compressor\\n\", pool->tfm_name);\n\n\t/* being the current pool takes 1 ref; this func expects the\n\t * caller to always add the new pool as the current pool\n\t */\n\tkref_init(&pool->kref);\n\tINIT_LIST_HEAD(&pool->list);\n\n\tzswap_pool_debug(\"created\", pool);\n\n\treturn pool;\n\nerror:\n\tfree_percpu(pool->tfm);\n\tif (pool->zpool)\n\t\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "param_free_charp",
          "args": [
            "&zswap_zpool_type"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"default zpool %s not available\\n\"",
            "zswap_zpool_type"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_has_pool",
          "args": [
            "zswap_zpool_type"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_has_pool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "120-134",
          "snippet": "bool zpool_has_pool(char *type)\n{\n\tstruct zpool_driver *driver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver)\n\t\treturn false;\n\n\tzpool_put_driver(driver);\n\treturn true;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nbool zpool_has_pool(char *type)\n{\n\tstruct zpool_driver *driver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver)\n\t\treturn false;\n\n\tzpool_put_driver(driver);\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "param_free_charp",
          "args": [
            "&zswap_zpool_type"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"zpool %s not available, using default %s\\n\"",
            "zswap_zpool_type",
            "ZSWAP_ZPOOL_DEFAULT"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "zswap_zpool_type",
            "ZSWAP_ZPOOL_DEFAULT"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "param_free_charp",
          "args": [
            "&zswap_compressor"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"default compressor %s not available\\n\"",
            "zswap_compressor"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crypto_has_comp",
          "args": [
            "zswap_compressor",
            "0",
            "0"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "param_free_charp",
          "args": [
            "&zswap_compressor"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"compressor %s not available, using default %s\\n\"",
            "zswap_compressor",
            "ZSWAP_COMPRESSOR_DEFAULT"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "zswap_compressor",
            "ZSWAP_COMPRESSOR_DEFAULT"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crypto_has_comp",
          "args": [
            "zswap_compressor",
            "0",
            "0"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\n#define ZSWAP_ZPOOL_DEFAULT \"zbud\"\n#define ZSWAP_COMPRESSOR_DEFAULT \"lzo\"\n#define ZSWAP_PARAM_UNSET \"\"\n\nstatic char *zswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;\nstatic char *zswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;\n\nzswap_pool *__zswap_pool_create_fallback(void)\n{\n\tbool has_comp, has_zpool;\n\n\thas_comp = crypto_has_comp(zswap_compressor, 0, 0);\n\tif (!has_comp && strcmp(zswap_compressor, ZSWAP_COMPRESSOR_DEFAULT)) {\n\t\tpr_err(\"compressor %s not available, using default %s\\n\",\n\t\t       zswap_compressor, ZSWAP_COMPRESSOR_DEFAULT);\n\t\tparam_free_charp(&zswap_compressor);\n\t\tzswap_compressor = ZSWAP_COMPRESSOR_DEFAULT;\n\t\thas_comp = crypto_has_comp(zswap_compressor, 0, 0);\n\t}\n\tif (!has_comp) {\n\t\tpr_err(\"default compressor %s not available\\n\",\n\t\t       zswap_compressor);\n\t\tparam_free_charp(&zswap_compressor);\n\t\tzswap_compressor = ZSWAP_PARAM_UNSET;\n\t}\n\n\thas_zpool = zpool_has_pool(zswap_zpool_type);\n\tif (!has_zpool && strcmp(zswap_zpool_type, ZSWAP_ZPOOL_DEFAULT)) {\n\t\tpr_err(\"zpool %s not available, using default %s\\n\",\n\t\t       zswap_zpool_type, ZSWAP_ZPOOL_DEFAULT);\n\t\tparam_free_charp(&zswap_zpool_type);\n\t\tzswap_zpool_type = ZSWAP_ZPOOL_DEFAULT;\n\t\thas_zpool = zpool_has_pool(zswap_zpool_type);\n\t}\n\tif (!has_zpool) {\n\t\tpr_err(\"default zpool %s not available\\n\",\n\t\t       zswap_zpool_type);\n\t\tparam_free_charp(&zswap_zpool_type);\n\t\tzswap_zpool_type = ZSWAP_PARAM_UNSET;\n\t}\n\n\tif (!has_comp || !has_zpool)\n\t\treturn NULL;\n\n\treturn zswap_pool_create(zswap_zpool_type, zswap_compressor);\n}"
  },
  {
    "function_name": "zswap_pool_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "513-574",
    "snippet": "static struct zswap_pool *zswap_pool_create(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\tchar name[38]; /* 'zswap' + 32 char (max) num + \\0 */\n\tgfp_t gfp = __GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM;\n\tint ret;\n\n\tif (!zswap_has_pool) {\n\t\t/* if either are unset, pool initialization failed, and we\n\t\t * need both params to be set correctly before trying to\n\t\t * create a pool.\n\t\t */\n\t\tif (!strcmp(type, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t\tif (!strcmp(compressor, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t}\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\t/* unique name for each pool specifically required by zsmalloc */\n\tsnprintf(name, 38, \"zswap%x\", atomic_inc_return(&zswap_pools_count));\n\n\tpool->zpool = zpool_create_pool(type, name, gfp, &zswap_zpool_ops);\n\tif (!pool->zpool) {\n\t\tpr_err(\"%s zpool not available\\n\", type);\n\t\tgoto error;\n\t}\n\tpr_debug(\"using %s zpool\\n\", zpool_get_type(pool->zpool));\n\n\tstrlcpy(pool->tfm_name, compressor, sizeof(pool->tfm_name));\n\tpool->tfm = alloc_percpu(struct crypto_comp *);\n\tif (!pool->tfm) {\n\t\tpr_err(\"percpu alloc failed\\n\");\n\t\tgoto error;\n\t}\n\n\tret = cpuhp_state_add_instance(CPUHP_MM_ZSWP_POOL_PREPARE,\n\t\t\t\t       &pool->node);\n\tif (ret)\n\t\tgoto error;\n\tpr_debug(\"using %s compressor\\n\", pool->tfm_name);\n\n\t/* being the current pool takes 1 ref; this func expects the\n\t * caller to always add the new pool as the current pool\n\t */\n\tkref_init(&pool->kref);\n\tINIT_LIST_HEAD(&pool->list);\n\n\tzswap_pool_debug(\"created\", pool);\n\n\treturn pool;\n\nerror:\n\tfree_percpu(pool->tfm);\n\tif (pool->zpool)\n\t\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ZSWAP_PARAM_UNSET \"\""
    ],
    "globals_used": [
      "static atomic_t zswap_pools_count = ATOMIC_INIT(0);",
      "static bool zswap_has_pool;",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static const struct zpool_ops zswap_zpool_ops = {\n\t.evict = zswap_writeback_entry\n};",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "pool"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_destroy_pool",
          "args": [
            "pool->zpool"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_destroy_pool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "213-223",
          "snippet": "void zpool_destroy_pool(struct zpool *zpool)\n{\n\tpr_debug(\"destroying pool type %s\\n\", zpool->driver->type);\n\n\tspin_lock(&pools_lock);\n\tlist_del(&zpool->list);\n\tspin_unlock(&pools_lock);\n\tzpool->driver->destroy(zpool->pool);\n\tzpool_put_driver(zpool->driver);\n\tkfree(zpool);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SPINLOCK(pools_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic DEFINE_SPINLOCK(pools_lock);\n\nvoid zpool_destroy_pool(struct zpool *zpool)\n{\n\tpr_debug(\"destroying pool type %s\\n\", zpool->driver->type);\n\n\tspin_lock(&pools_lock);\n\tlist_del(&zpool->list);\n\tspin_unlock(&pools_lock);\n\tzpool->driver->destroy(zpool->pool);\n\tzpool_put_driver(zpool->driver);\n\tkfree(zpool);\n}"
        }
      },
      {
        "call_info": {
          "callee": "free_percpu",
          "args": [
            "pool->tfm"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "free_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/percpu.c",
          "lines": "1718-1753",
          "snippet": "void free_percpu(void __percpu *ptr)\n{\n\tvoid *addr;\n\tstruct pcpu_chunk *chunk;\n\tunsigned long flags;\n\tint off;\n\n\tif (!ptr)\n\t\treturn;\n\n\tkmemleak_free_percpu(ptr);\n\n\taddr = __pcpu_ptr_to_addr(ptr);\n\n\tspin_lock_irqsave(&pcpu_lock, flags);\n\n\tchunk = pcpu_chunk_addr_search(addr);\n\toff = addr - chunk->base_addr;\n\n\tpcpu_free_area(chunk, off);\n\n\t/* if there are more than one fully free chunks, wake up grim reaper */\n\tif (chunk->free_bytes == pcpu_unit_size) {\n\t\tstruct pcpu_chunk *pos;\n\n\t\tlist_for_each_entry(pos, &pcpu_slot[pcpu_nr_slots - 1], list)\n\t\t\tif (pos != chunk) {\n\t\t\t\tpcpu_schedule_balance_work();\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\n\ttrace_percpu_free_percpu(chunk->base_addr, off, ptr);\n\n\tspin_unlock_irqrestore(&pcpu_lock, flags);\n}",
          "includes": [
            "#include \"percpu-vm.c\"",
            "#include \"percpu-km.c\"",
            "#include \"percpu-internal.h\"",
            "#include <trace/events/percpu.h>",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/sched.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/pfn.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/log2.h>",
            "#include <linux/list.h>",
            "#include <linux/lcm.h>",
            "#include <linux/err.h>",
            "#include <linux/memblock.h>",
            "#include <linux/bitmap.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int pcpu_unit_size",
            "int pcpu_nr_slots",
            "static void pcpu_destroy_chunk(struct pcpu_chunk *chunk);",
            "static struct page *pcpu_addr_to_page(void *addr);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"percpu-vm.c\"\n#include \"percpu-km.c\"\n#include \"percpu-internal.h\"\n#include <trace/events/percpu.h>\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <asm/cacheflush.h>\n#include <linux/sched.h>\n#include <linux/kmemleak.h>\n#include <linux/workqueue.h>\n#include <linux/vmalloc.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/pfn.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/log2.h>\n#include <linux/list.h>\n#include <linux/lcm.h>\n#include <linux/err.h>\n#include <linux/memblock.h>\n#include <linux/bitmap.h>\n\nstatic int pcpu_unit_size;\nint pcpu_nr_slots;\nstatic void pcpu_destroy_chunk(struct pcpu_chunk *chunk);\nstatic struct page *pcpu_addr_to_page(void *addr);\n\nvoid free_percpu(void __percpu *ptr)\n{\n\tvoid *addr;\n\tstruct pcpu_chunk *chunk;\n\tunsigned long flags;\n\tint off;\n\n\tif (!ptr)\n\t\treturn;\n\n\tkmemleak_free_percpu(ptr);\n\n\taddr = __pcpu_ptr_to_addr(ptr);\n\n\tspin_lock_irqsave(&pcpu_lock, flags);\n\n\tchunk = pcpu_chunk_addr_search(addr);\n\toff = addr - chunk->base_addr;\n\n\tpcpu_free_area(chunk, off);\n\n\t/* if there are more than one fully free chunks, wake up grim reaper */\n\tif (chunk->free_bytes == pcpu_unit_size) {\n\t\tstruct pcpu_chunk *pos;\n\n\t\tlist_for_each_entry(pos, &pcpu_slot[pcpu_nr_slots - 1], list)\n\t\t\tif (pos != chunk) {\n\t\t\t\tpcpu_schedule_balance_work();\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\n\ttrace_percpu_free_percpu(chunk->base_addr, off, ptr);\n\n\tspin_unlock_irqrestore(&pcpu_lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_pool_debug",
          "args": [
            "\"created\"",
            "pool"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&pool->list"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kref_init",
          "args": [
            "&pool->kref"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"using %s compressor\\n\"",
            "pool->tfm_name"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpuhp_state_add_instance",
          "args": [
            "CPUHP_MM_ZSWP_POOL_PREPARE",
            "&pool->node"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"percpu alloc failed\\n\""
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloc_percpu",
          "args": [
            "struct crypto_comp *"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "early_alloc_percpu",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/kmemleak.c",
          "lines": "941-950",
          "snippet": "static void early_alloc_percpu(struct early_log *log)\n{\n\tunsigned int cpu;\n\tconst void __percpu *ptr = log->ptr;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tlog->ptr = per_cpu_ptr(ptr, cpu);\n\t\tearly_alloc(log);\n\t}\n}",
          "includes": [
            "#include <linux/memory_hotplug.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/kasan.h>",
            "#include <linux/atomic.h>",
            "#include <asm/processor.h>",
            "#include <asm/sections.h>",
            "#include <linux/crc32.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/mm.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/string.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/err.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/slab.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/pfn.h>",
            "#include <linux/memblock.h>",
            "#include <linux/percpu.h>",
            "#include <linux/cache.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/cpumask.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/fs.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/kthread.h>",
            "#include <linux/export.h>",
            "#include <linux/delay.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct early_log\n\tearly_log[CONFIG_DEBUG_KMEMLEAK_EARLY_LOG_SIZE]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memory_hotplug.h>\n#include <linux/kmemleak.h>\n#include <linux/kasan.h>\n#include <linux/atomic.h>\n#include <asm/processor.h>\n#include <asm/sections.h>\n#include <linux/crc32.h>\n#include <linux/workqueue.h>\n#include <linux/mm.h>\n#include <linux/nodemask.h>\n#include <linux/string.h>\n#include <linux/uaccess.h>\n#include <linux/err.h>\n#include <linux/thread_info.h>\n#include <linux/slab.h>\n#include <linux/mmzone.h>\n#include <linux/pfn.h>\n#include <linux/memblock.h>\n#include <linux/percpu.h>\n#include <linux/cache.h>\n#include <linux/stacktrace.h>\n#include <linux/rcupdate.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/cpumask.h>\n#include <linux/seq_file.h>\n#include <linux/debugfs.h>\n#include <linux/fs.h>\n#include <linux/rbtree.h>\n#include <linux/kthread.h>\n#include <linux/export.h>\n#include <linux/delay.h>\n#include <linux/jiffies.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/signal.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n\nstatic struct early_log\n\tearly_log[CONFIG_DEBUG_KMEMLEAK_EARLY_LOG_SIZE];\n\nstatic void early_alloc_percpu(struct early_log *log)\n{\n\tunsigned int cpu;\n\tconst void __percpu *ptr = log->ptr;\n\n\tfor_each_possible_cpu(cpu) {\n\t\tlog->ptr = per_cpu_ptr(ptr, cpu);\n\t\tearly_alloc(log);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "pool->tfm_name",
            "compressor",
            "sizeof(pool->tfm_name)"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"using %s zpool\\n\"",
            "zpool_get_type(pool->zpool)"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_get_type",
          "args": [
            "pool->zpool"
          ],
          "line": 543
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_get_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "235-238",
          "snippet": "const char *zpool_get_type(struct zpool *zpool)\n{\n\treturn zpool->driver->type;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nconst char *zpool_get_type(struct zpool *zpool)\n{\n\treturn zpool->driver->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"%s zpool not available\\n\"",
            "type"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_create_pool",
          "args": [
            "type",
            "name",
            "gfp",
            "&zswap_zpool_ops"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_create_pool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "154-200",
          "snippet": "struct zpool *zpool_create_pool(const char *type, const char *name, gfp_t gfp,\n\t\tconst struct zpool_ops *ops)\n{\n\tstruct zpool_driver *driver;\n\tstruct zpool *zpool;\n\n\tpr_debug(\"creating pool type %s\\n\", type);\n\n\tdriver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver) {\n\t\tpr_err(\"no driver for type %s\\n\", type);\n\t\treturn NULL;\n\t}\n\n\tzpool = kmalloc(sizeof(*zpool), gfp);\n\tif (!zpool) {\n\t\tpr_err(\"couldn't create zpool - out of memory\\n\");\n\t\tzpool_put_driver(driver);\n\t\treturn NULL;\n\t}\n\n\tzpool->driver = driver;\n\tzpool->pool = driver->create(name, gfp, ops, zpool);\n\tzpool->ops = ops;\n\tzpool->evictable = driver->shrink && ops && ops->evict;\n\n\tif (!zpool->pool) {\n\t\tpr_err(\"couldn't create %s pool\\n\", type);\n\t\tzpool_put_driver(driver);\n\t\tkfree(zpool);\n\t\treturn NULL;\n\t}\n\n\tpr_debug(\"created pool type %s\\n\", type);\n\n\tspin_lock(&pools_lock);\n\tlist_add(&zpool->list, &pools_head);\n\tspin_unlock(&pools_lock);\n\n\treturn zpool;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(pools_head);",
            "static DEFINE_SPINLOCK(pools_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nstatic LIST_HEAD(pools_head);\nstatic DEFINE_SPINLOCK(pools_lock);\n\nstruct zpool *zpool_create_pool(const char *type, const char *name, gfp_t gfp,\n\t\tconst struct zpool_ops *ops)\n{\n\tstruct zpool_driver *driver;\n\tstruct zpool *zpool;\n\n\tpr_debug(\"creating pool type %s\\n\", type);\n\n\tdriver = zpool_get_driver(type);\n\n\tif (!driver) {\n\t\trequest_module(\"zpool-%s\", type);\n\t\tdriver = zpool_get_driver(type);\n\t}\n\n\tif (!driver) {\n\t\tpr_err(\"no driver for type %s\\n\", type);\n\t\treturn NULL;\n\t}\n\n\tzpool = kmalloc(sizeof(*zpool), gfp);\n\tif (!zpool) {\n\t\tpr_err(\"couldn't create zpool - out of memory\\n\");\n\t\tzpool_put_driver(driver);\n\t\treturn NULL;\n\t}\n\n\tzpool->driver = driver;\n\tzpool->pool = driver->create(name, gfp, ops, zpool);\n\tzpool->ops = ops;\n\tzpool->evictable = driver->shrink && ops && ops->evict;\n\n\tif (!zpool->pool) {\n\t\tpr_err(\"couldn't create %s pool\\n\", type);\n\t\tzpool_put_driver(driver);\n\t\tkfree(zpool);\n\t\treturn NULL;\n\t}\n\n\tpr_debug(\"created pool type %s\\n\", type);\n\n\tspin_lock(&pools_lock);\n\tlist_add(&zpool->list, &pools_head);\n\tspin_unlock(&pools_lock);\n\n\treturn zpool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "name",
            "38",
            "\"zswap%x\"",
            "atomic_inc_return(&zswap_pools_count)"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_inc_return",
          "args": [
            "&zswap_pools_count"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*pool)",
            "GFP_KERNEL"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "compressor",
            "ZSWAP_PARAM_UNSET"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "type",
            "ZSWAP_PARAM_UNSET"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\n#define ZSWAP_PARAM_UNSET \"\"\n\nstatic atomic_t zswap_pools_count = ATOMIC_INIT(0);\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic const struct zpool_ops zswap_zpool_ops = {\n\t.evict = zswap_writeback_entry\n};\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_create(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\tchar name[38]; /* 'zswap' + 32 char (max) num + \\0 */\n\tgfp_t gfp = __GFP_NORETRY | __GFP_NOWARN | __GFP_KSWAPD_RECLAIM;\n\tint ret;\n\n\tif (!zswap_has_pool) {\n\t\t/* if either are unset, pool initialization failed, and we\n\t\t * need both params to be set correctly before trying to\n\t\t * create a pool.\n\t\t */\n\t\tif (!strcmp(type, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t\tif (!strcmp(compressor, ZSWAP_PARAM_UNSET))\n\t\t\treturn NULL;\n\t}\n\n\tpool = kzalloc(sizeof(*pool), GFP_KERNEL);\n\tif (!pool)\n\t\treturn NULL;\n\n\t/* unique name for each pool specifically required by zsmalloc */\n\tsnprintf(name, 38, \"zswap%x\", atomic_inc_return(&zswap_pools_count));\n\n\tpool->zpool = zpool_create_pool(type, name, gfp, &zswap_zpool_ops);\n\tif (!pool->zpool) {\n\t\tpr_err(\"%s zpool not available\\n\", type);\n\t\tgoto error;\n\t}\n\tpr_debug(\"using %s zpool\\n\", zpool_get_type(pool->zpool));\n\n\tstrlcpy(pool->tfm_name, compressor, sizeof(pool->tfm_name));\n\tpool->tfm = alloc_percpu(struct crypto_comp *);\n\tif (!pool->tfm) {\n\t\tpr_err(\"percpu alloc failed\\n\");\n\t\tgoto error;\n\t}\n\n\tret = cpuhp_state_add_instance(CPUHP_MM_ZSWP_POOL_PREPARE,\n\t\t\t\t       &pool->node);\n\tif (ret)\n\t\tgoto error;\n\tpr_debug(\"using %s compressor\\n\", pool->tfm_name);\n\n\t/* being the current pool takes 1 ref; this func expects the\n\t * caller to always add the new pool as the current pool\n\t */\n\tkref_init(&pool->kref);\n\tINIT_LIST_HEAD(&pool->list);\n\n\tzswap_pool_debug(\"created\", pool);\n\n\treturn pool;\n\nerror:\n\tfree_percpu(pool->tfm);\n\tif (pool->zpool)\n\t\tzpool_destroy_pool(pool->zpool);\n\tkfree(pool);\n\treturn NULL;\n}"
  },
  {
    "function_name": "zswap_pool_find_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "493-511",
    "snippet": "static struct zswap_pool *zswap_pool_find_get(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\n\tassert_spin_locked(&zswap_pools_lock);\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list) {\n\t\tif (strcmp(pool->tfm_name, compressor))\n\t\t\tcontinue;\n\t\tif (strcmp(zpool_get_type(pool->zpool), type))\n\t\t\tcontinue;\n\t\t/* if we can't get it, it's about to be destroyed */\n\t\tif (!zswap_pool_get(pool))\n\t\t\tcontinue;\n\t\treturn pool;\n\t}\n\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(zswap_pools);",
      "static DEFINE_SPINLOCK(zswap_pools_lock);",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_pool_get",
          "args": [
            "pool"
          ],
          "line": 505
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "626-632",
          "snippet": "static int __must_check zswap_pool_get(struct zswap_pool *pool)\n{\n\tif (!pool)\n\t\treturn 0;\n\n\treturn kref_get_unless_zero(&pool->kref);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int __must_check zswap_pool_get(struct zswap_pool *pool)\n{\n\tif (!pool)\n\t\treturn 0;\n\n\treturn kref_get_unless_zero(&pool->kref);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "zpool_get_type(pool->zpool)",
            "type"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_get_type",
          "args": [
            "pool->zpool"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_get_type",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "235-238",
          "snippet": "const char *zpool_get_type(struct zpool *zpool)\n{\n\treturn zpool->driver->type;\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nconst char *zpool_get_type(struct zpool *zpool)\n{\n\treturn zpool->driver->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "pool->tfm_name",
            "compressor"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "pool",
            "&zswap_pools",
            "list"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&zswap_pools_lock"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(zswap_pools);\nstatic DEFINE_SPINLOCK(zswap_pools_lock);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_find_get(char *type, char *compressor)\n{\n\tstruct zswap_pool *pool;\n\n\tassert_spin_locked(&zswap_pools_lock);\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list) {\n\t\tif (strcmp(pool->tfm_name, compressor))\n\t\t\tcontinue;\n\t\tif (strcmp(zpool_get_type(pool->zpool), type))\n\t\t\tcontinue;\n\t\t/* if we can't get it, it's about to be destroyed */\n\t\tif (!zswap_pool_get(pool))\n\t\t\tcontinue;\n\t\treturn pool;\n\t}\n\n\treturn NULL;\n}"
  },
  {
    "function_name": "zswap_pool_last_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "474-490",
    "snippet": "static struct zswap_pool *zswap_pool_last_get(void)\n{\n\tstruct zswap_pool *pool, *last = NULL;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\tlast = pool;\n\tWARN_ONCE(!last && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\tif (!zswap_pool_get(last))\n\t\tlast = NULL;\n\n\trcu_read_unlock();\n\n\treturn last;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(zswap_pools);",
      "static bool zswap_has_pool;",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_get",
          "args": [
            "last"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "626-632",
          "snippet": "static int __must_check zswap_pool_get(struct zswap_pool *pool)\n{\n\tif (!pool)\n\t\treturn 0;\n\n\treturn kref_get_unless_zero(&pool->kref);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int __must_check zswap_pool_get(struct zswap_pool *pool)\n{\n\tif (!pool)\n\t\treturn 0;\n\n\treturn kref_get_unless_zero(&pool->kref);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "!last && zswap_has_pool",
            "\"%s: no page storage pool!\\n\"",
            "__func__"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "pool",
            "&zswap_pools",
            "list"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(zswap_pools);\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_last_get(void)\n{\n\tstruct zswap_pool *pool, *last = NULL;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\tlast = pool;\n\tWARN_ONCE(!last && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\tif (!zswap_pool_get(last))\n\t\tlast = NULL;\n\n\trcu_read_unlock();\n\n\treturn last;\n}"
  },
  {
    "function_name": "zswap_pool_current_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "459-472",
    "snippet": "static struct zswap_pool *zswap_pool_current_get(void)\n{\n\tstruct zswap_pool *pool;\n\n\trcu_read_lock();\n\n\tpool = __zswap_pool_current();\n\tif (!zswap_pool_get(pool))\n\t\tpool = NULL;\n\n\trcu_read_unlock();\n\n\treturn pool;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_pool_get",
          "args": [
            "pool"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "626-632",
          "snippet": "static int __must_check zswap_pool_get(struct zswap_pool *pool)\n{\n\tif (!pool)\n\t\treturn 0;\n\n\treturn kref_get_unless_zero(&pool->kref);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int __must_check zswap_pool_get(struct zswap_pool *pool)\n{\n\tif (!pool)\n\t\treturn 0;\n\n\treturn kref_get_unless_zero(&pool->kref);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__zswap_pool_current",
          "args": [],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "__zswap_pool_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "441-450",
          "snippet": "static struct zswap_pool *__zswap_pool_current(void)\n{\n\tstruct zswap_pool *pool;\n\n\tpool = list_first_or_null_rcu(&zswap_pools, typeof(*pool), list);\n\tWARN_ONCE(!pool && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\n\treturn pool;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(zswap_pools);",
            "static bool zswap_has_pool;",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(zswap_pools);\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *__zswap_pool_current(void)\n{\n\tstruct zswap_pool *pool;\n\n\tpool = list_first_or_null_rcu(&zswap_pools, typeof(*pool), list);\n\tWARN_ONCE(!pool && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\n\treturn pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_current_get(void)\n{\n\tstruct zswap_pool *pool;\n\n\trcu_read_lock();\n\n\tpool = __zswap_pool_current();\n\tif (!zswap_pool_get(pool))\n\t\tpool = NULL;\n\n\trcu_read_unlock();\n\n\treturn pool;\n}"
  },
  {
    "function_name": "zswap_pool_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "452-457",
    "snippet": "static struct zswap_pool *zswap_pool_current(void)\n{\n\tassert_spin_locked(&zswap_pools_lock);\n\n\treturn __zswap_pool_current();\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SPINLOCK(zswap_pools_lock);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__zswap_pool_current",
          "args": [],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "__zswap_pool_current",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "441-450",
          "snippet": "static struct zswap_pool *__zswap_pool_current(void)\n{\n\tstruct zswap_pool *pool;\n\n\tpool = list_first_or_null_rcu(&zswap_pools, typeof(*pool), list);\n\tWARN_ONCE(!pool && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\n\treturn pool;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(zswap_pools);",
            "static bool zswap_has_pool;",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(zswap_pools);\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *__zswap_pool_current(void)\n{\n\tstruct zswap_pool *pool;\n\n\tpool = list_first_or_null_rcu(&zswap_pools, typeof(*pool), list);\n\tWARN_ONCE(!pool && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\n\treturn pool;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_spin_locked",
          "args": [
            "&zswap_pools_lock"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic DEFINE_SPINLOCK(zswap_pools_lock);\nstatic __init struct;\n\nstatic struct zswap_pool *zswap_pool_current(void)\n{\n\tassert_spin_locked(&zswap_pools_lock);\n\n\treturn __zswap_pool_current();\n}"
  },
  {
    "function_name": "__zswap_pool_current",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "441-450",
    "snippet": "static struct zswap_pool *__zswap_pool_current(void)\n{\n\tstruct zswap_pool *pool;\n\n\tpool = list_first_or_null_rcu(&zswap_pools, typeof(*pool), list);\n\tWARN_ONCE(!pool && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\n\treturn pool;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(zswap_pools);",
      "static bool zswap_has_pool;",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "!pool && zswap_has_pool",
            "\"%s: no page storage pool!\\n\"",
            "__func__"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_or_null_rcu",
          "args": [
            "&zswap_pools",
            "typeof(*pool)",
            "list"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeof",
          "args": [
            "*pool"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic LIST_HEAD(zswap_pools);\nstatic bool zswap_has_pool;\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic struct zswap_pool *__zswap_pool_current(void)\n{\n\tstruct zswap_pool *pool;\n\n\tpool = list_first_or_null_rcu(&zswap_pools, typeof(*pool), list);\n\tWARN_ONCE(!pool && zswap_has_pool,\n\t\t  \"%s: no page storage pool!\\n\", __func__);\n\n\treturn pool;\n}"
  },
  {
    "function_name": "zswap_cpu_comp_dead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "425-435",
    "snippet": "static int zswap_cpu_comp_dead(unsigned int cpu, struct hlist_node *node)\n{\n\tstruct zswap_pool *pool = hlist_entry(node, struct zswap_pool, node);\n\tstruct crypto_comp *tfm;\n\n\ttfm = *per_cpu_ptr(pool->tfm, cpu);\n\tif (!IS_ERR_OR_NULL(tfm))\n\t\tcrypto_free_comp(tfm);\n\t*per_cpu_ptr(pool->tfm, cpu) = NULL;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "pool->tfm",
            "cpu"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crypto_free_comp",
          "args": [
            "tfm"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "tfm"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "pool->tfm",
            "cpu"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_entry",
          "args": [
            "node",
            "structzswap_pool",
            "node"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int zswap_cpu_comp_dead(unsigned int cpu, struct hlist_node *node)\n{\n\tstruct zswap_pool *pool = hlist_entry(node, struct zswap_pool, node);\n\tstruct crypto_comp *tfm;\n\n\ttfm = *per_cpu_ptr(pool->tfm, cpu);\n\tif (!IS_ERR_OR_NULL(tfm))\n\t\tcrypto_free_comp(tfm);\n\t*per_cpu_ptr(pool->tfm, cpu) = NULL;\n\treturn 0;\n}"
  },
  {
    "function_name": "zswap_cpu_comp_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "407-423",
    "snippet": "static int zswap_cpu_comp_prepare(unsigned int cpu, struct hlist_node *node)\n{\n\tstruct zswap_pool *pool = hlist_entry(node, struct zswap_pool, node);\n\tstruct crypto_comp *tfm;\n\n\tif (WARN_ON(*per_cpu_ptr(pool->tfm, cpu)))\n\t\treturn 0;\n\n\ttfm = crypto_alloc_comp(pool->tfm_name, 0, 0);\n\tif (IS_ERR_OR_NULL(tfm)) {\n\t\tpr_err(\"could not alloc crypto comp %s : %ld\\n\",\n\t\t       pool->tfm_name, PTR_ERR(tfm));\n\t\treturn -ENOMEM;\n\t}\n\t*per_cpu_ptr(pool->tfm, cpu) = tfm;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "pool->tfm",
            "cpu"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"could not alloc crypto comp %s : %ld\\n\"",
            "pool->tfm_name",
            "PTR_ERR(tfm)"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "tfm"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR_OR_NULL",
          "args": [
            "tfm"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crypto_alloc_comp",
          "args": [
            "pool->tfm_name",
            "0",
            "0"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "*per_cpu_ptr(pool->tfm, cpu)"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "per_cpu_ptr",
          "args": [
            "pool->tfm",
            "cpu"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hlist_entry",
          "args": [
            "node",
            "structzswap_pool",
            "node"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic int zswap_cpu_comp_prepare(unsigned int cpu, struct hlist_node *node)\n{\n\tstruct zswap_pool *pool = hlist_entry(node, struct zswap_pool, node);\n\tstruct crypto_comp *tfm;\n\n\tif (WARN_ON(*per_cpu_ptr(pool->tfm, cpu)))\n\t\treturn 0;\n\n\ttfm = crypto_alloc_comp(pool->tfm_name, 0, 0);\n\tif (IS_ERR_OR_NULL(tfm)) {\n\t\tpr_err(\"could not alloc crypto comp %s : %ld\\n\",\n\t\t       pool->tfm_name, PTR_ERR(tfm));\n\t\treturn -ENOMEM;\n\t}\n\t*per_cpu_ptr(pool->tfm, cpu) = tfm;\n\treturn 0;\n}"
  },
  {
    "function_name": "zswap_dstmem_dead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "396-405",
    "snippet": "static int zswap_dstmem_dead(unsigned int cpu)\n{\n\tu8 *dst;\n\n\tdst = per_cpu(zswap_dstmem, cpu);\n\tkfree(dst);\n\tper_cpu(zswap_dstmem, cpu) = NULL;\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(u8 *, zswap_dstmem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "zswap_dstmem",
            "cpu"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "dst"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "bulkfree_pcp_prepare",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/page_alloc.c",
          "lines": "1061-1064",
          "snippet": "static bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <asm/div64.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/sections.h>",
            "#include <linux/psi.h>",
            "#include <linux/nmi.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/kthread.h>",
            "#include <linux/page_owner.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/migrate.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/prefetch.h>",
            "#include <trace/events/oom.h>",
            "#include <trace/events/kmem.h>",
            "#include <linux/compaction.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/debugobjects.h>",
            "#include <linux/page_ext.h>",
            "#include <linux/page-isolation.h>",
            "#include <linux/fault-inject.h>",
            "#include <linux/backing-dev.h>",
            "#include <linux/pfn.h>",
            "#include <linux/sort.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/memremap.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/nodemask.h>",
            "#include <linux/memory_hotplug.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpu.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/topology.h>",
            "#include <linux/oom.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/slab.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/pagevec.h>",
            "#include <linux/suspend.h>",
            "#include <linux/module.h>",
            "#include <linux/kasan.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>",
            "#include <linux/memblock.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline\nstruct",
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <asm/div64.h>\n#include <asm/tlbflush.h>\n#include <asm/sections.h>\n#include <linux/psi.h>\n#include <linux/nmi.h>\n#include <linux/lockdep.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/kthread.h>\n#include <linux/page_owner.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/rt.h>\n#include <linux/hugetlb.h>\n#include <linux/migrate.h>\n#include <linux/mm_inline.h>\n#include <linux/prefetch.h>\n#include <trace/events/oom.h>\n#include <trace/events/kmem.h>\n#include <linux/compaction.h>\n#include <linux/kmemleak.h>\n#include <linux/debugobjects.h>\n#include <linux/page_ext.h>\n#include <linux/page-isolation.h>\n#include <linux/fault-inject.h>\n#include <linux/backing-dev.h>\n#include <linux/pfn.h>\n#include <linux/sort.h>\n#include <linux/stop_machine.h>\n#include <linux/memremap.h>\n#include <linux/mempolicy.h>\n#include <linux/vmstat.h>\n#include <linux/vmalloc.h>\n#include <linux/nodemask.h>\n#include <linux/memory_hotplug.h>\n#include <linux/cpuset.h>\n#include <linux/cpu.h>\n#include <linux/sysctl.h>\n#include <linux/topology.h>\n#include <linux/oom.h>\n#include <linux/ratelimit.h>\n#include <linux/slab.h>\n#include <linux/blkdev.h>\n#include <linux/pagevec.h>\n#include <linux/suspend.h>\n#include <linux/module.h>\n#include <linux/kasan.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n#include <linux/memblock.h>\n#include <linux/jiffies.h>\n#include <linux/pagemap.h>\n#include <linux/interrupt.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/stddef.h>\n\nstatic __always_inline\nstruct;\nstatic __always_inline struct;\n\nstatic bool bulkfree_pcp_prepare(struct page *page)\n{\n\treturn free_pages_check(page);\n}"
        }
      },
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "zswap_dstmem",
            "cpu"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic DEFINE_PER_CPU(u8 *, zswap_dstmem);\n\nstatic int zswap_dstmem_dead(unsigned int cpu)\n{\n\tu8 *dst;\n\n\tdst = per_cpu(zswap_dstmem, cpu);\n\tkfree(dst);\n\tper_cpu(zswap_dstmem, cpu) = NULL;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "zswap_dstmem_prepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "384-394",
    "snippet": "static int zswap_dstmem_prepare(unsigned int cpu)\n{\n\tu8 *dst;\n\n\tdst = kmalloc_node(PAGE_SIZE * 2, GFP_KERNEL, cpu_to_node(cpu));\n\tif (!dst)\n\t\treturn -ENOMEM;\n\n\tper_cpu(zswap_dstmem, cpu) = dst;\n\treturn 0;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_PER_CPU(u8 *, zswap_dstmem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "per_cpu",
          "args": [
            "zswap_dstmem",
            "cpu"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc_node",
          "args": [
            "PAGE_SIZE * 2",
            "GFP_KERNEL",
            "cpu_to_node(cpu)"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "__kmalloc_node",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3689-3692",
          "snippet": "void *__kmalloc_node(size_t size, gfp_t flags, int node)\n{\n\treturn __do_kmalloc_node(size, flags, node, _RET_IP_);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nvoid *__kmalloc_node(size_t size, gfp_t flags, int node)\n{\n\treturn __do_kmalloc_node(size, flags, node, _RET_IP_);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_to_node",
          "args": [
            "cpu"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic DEFINE_PER_CPU(u8 *, zswap_dstmem);\n\nstatic int zswap_dstmem_prepare(unsigned int cpu)\n{\n\tu8 *dst;\n\n\tdst = kmalloc_node(PAGE_SIZE * 2, GFP_KERNEL, cpu_to_node(cpu));\n\tif (!dst)\n\t\treturn -ENOMEM;\n\n\tper_cpu(zswap_dstmem, cpu) = dst;\n\treturn 0;\n}"
  },
  {
    "function_name": "zswap_entry_find_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "367-377",
    "snippet": "static struct zswap_entry *zswap_entry_find_get(struct rb_root *root,\n\t\t\t\tpgoff_t offset)\n{\n\tstruct zswap_entry *entry;\n\n\tentry = zswap_rb_search(root, offset);\n\tif (entry)\n\t\tzswap_entry_get(entry);\n\n\treturn entry;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_entry_get",
          "args": [
            "entry"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "346-349",
          "snippet": "static void zswap_entry_get(struct zswap_entry *entry)\n{\n\tentry->refcount++;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_entry_get(struct zswap_entry *entry)\n{\n\tentry->refcount++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_rb_search",
          "args": [
            "root",
            "offset"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_rb_search",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "276-291",
          "snippet": "static struct zswap_entry *zswap_rb_search(struct rb_root *root, pgoff_t offset)\n{\n\tstruct rb_node *node = root->rb_node;\n\tstruct zswap_entry *entry;\n\n\twhile (node) {\n\t\tentry = rb_entry(node, struct zswap_entry, rbnode);\n\t\tif (entry->offset > offset)\n\t\t\tnode = node->rb_left;\n\t\telse if (entry->offset < offset)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn entry;\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_rb_search(struct rb_root *root, pgoff_t offset)\n{\n\tstruct rb_node *node = root->rb_node;\n\tstruct zswap_entry *entry;\n\n\twhile (node) {\n\t\tentry = rb_entry(node, struct zswap_entry, rbnode);\n\t\tif (entry->offset > offset)\n\t\t\tnode = node->rb_left;\n\t\telse if (entry->offset < offset)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn entry;\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_entry_find_get(struct rb_root *root,\n\t\t\t\tpgoff_t offset)\n{\n\tstruct zswap_entry *entry;\n\n\tentry = zswap_rb_search(root, offset);\n\tif (entry)\n\t\tzswap_entry_get(entry);\n\n\treturn entry;\n}"
  },
  {
    "function_name": "zswap_entry_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "354-364",
    "snippet": "static void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_free_entry",
          "args": [
            "entry"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_free_entry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "332-343",
          "snippet": "static void zswap_free_entry(struct zswap_entry *entry)\n{\n\tif (!entry->length)\n\t\tatomic_dec(&zswap_same_filled_pages);\n\telse {\n\t\tzpool_free(entry->pool->zpool, entry->handle);\n\t\tzswap_pool_put(entry->pool);\n\t}\n\tzswap_entry_cache_free(entry);\n\tatomic_dec(&zswap_stored_pages);\n\tzswap_update_total_size();\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static atomic_t zswap_stored_pages = ATOMIC_INIT(0);",
            "static atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);",
            "static int zswap_writeback_entry(struct zpool *pool, unsigned long handle);",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic atomic_t zswap_stored_pages = ATOMIC_INIT(0);\nstatic atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);\nstatic int zswap_writeback_entry(struct zpool *pool, unsigned long handle);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_free_entry(struct zswap_entry *entry)\n{\n\tif (!entry->length)\n\t\tatomic_dec(&zswap_same_filled_pages);\n\telse {\n\t\tzpool_free(entry->pool->zpool, entry->handle);\n\t\tzswap_pool_put(entry->pool);\n\t}\n\tzswap_entry_cache_free(entry);\n\tatomic_dec(&zswap_stored_pages);\n\tzswap_update_total_size();\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_rb_erase",
          "args": [
            "&tree->rbroot",
            "entry"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_rb_erase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "320-326",
          "snippet": "static void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "refcount < 0"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_entry_put(struct zswap_tree *tree,\n\t\t\tstruct zswap_entry *entry)\n{\n\tint refcount = --entry->refcount;\n\n\tBUG_ON(refcount < 0);\n\tif (refcount == 0) {\n\t\tzswap_rb_erase(&tree->rbroot, entry);\n\t\tzswap_free_entry(entry);\n\t}\n}"
  },
  {
    "function_name": "zswap_entry_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "346-349",
    "snippet": "static void zswap_entry_get(struct zswap_entry *entry)\n{\n\tentry->refcount++;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __init struct"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_entry_get(struct zswap_entry *entry)\n{\n\tentry->refcount++;\n}"
  },
  {
    "function_name": "zswap_free_entry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "332-343",
    "snippet": "static void zswap_free_entry(struct zswap_entry *entry)\n{\n\tif (!entry->length)\n\t\tatomic_dec(&zswap_same_filled_pages);\n\telse {\n\t\tzpool_free(entry->pool->zpool, entry->handle);\n\t\tzswap_pool_put(entry->pool);\n\t}\n\tzswap_entry_cache_free(entry);\n\tatomic_dec(&zswap_stored_pages);\n\tzswap_update_total_size();\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static atomic_t zswap_stored_pages = ATOMIC_INIT(0);",
      "static atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);",
      "static int zswap_writeback_entry(struct zpool *pool, unsigned long handle);",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "zswap_update_total_size",
          "args": [],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_update_total_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "226-239",
          "snippet": "static void zswap_update_total_size(void)\n{\n\tstruct zswap_pool *pool;\n\tu64 total = 0;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\ttotal += zpool_get_total_size(pool->zpool);\n\n\trcu_read_unlock();\n\n\tzswap_pool_total_size = total;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static u64 zswap_pool_total_size;",
            "static LIST_HEAD(zswap_pools);",
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic u64 zswap_pool_total_size;\nstatic LIST_HEAD(zswap_pools);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_update_total_size(void)\n{\n\tstruct zswap_pool *pool;\n\tu64 total = 0;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\ttotal += zpool_get_total_size(pool->zpool);\n\n\trcu_read_unlock();\n\n\tzswap_pool_total_size = total;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&zswap_stored_pages"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zswap_entry_cache_free",
          "args": [
            "entry"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_entry_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "268-271",
          "snippet": "static void zswap_entry_cache_free(struct zswap_entry *entry)\n{\n\tkmem_cache_free(zswap_entry_cache, entry);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct kmem_cache *zswap_entry_cache;",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\nstatic __init struct;\n\nstatic void zswap_entry_cache_free(struct zswap_entry *entry)\n{\n\tkmem_cache_free(zswap_entry_cache, entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zswap_pool_put",
          "args": [
            "entry->pool"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_pool_put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "665-668",
          "snippet": "static void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/writeback.h>",
            "#include <linux/swapops.h>",
            "#include <linux/page-flags.h>",
            "#include <linux/mm_types.h>",
            "#include <linux/zpool.h>",
            "#include <linux/mempool.h>",
            "#include <linux/crypto.h>",
            "#include <linux/swap.h>",
            "#include <linux/rbtree.h>",
            "#include <linux/frontswap.h>",
            "#include <linux/atomic.h>",
            "#include <linux/types.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/highmem.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int zswap_pool_get(struct zswap_pool *pool);",
            "static void zswap_pool_put(struct zswap_pool *pool);",
            "static __init struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_pool_put(struct zswap_pool *pool)\n{\n\tkref_put(&pool->kref, __zswap_pool_empty);\n}"
        }
      },
      {
        "call_info": {
          "callee": "zpool_free",
          "args": [
            "entry->pool->zpool",
            "entry->handle"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "z3fold_zpool_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/z3fold.c",
          "lines": "1080-1083",
          "snippet": "static void z3fold_zpool_free(void *pool, unsigned long handle)\n{\n\tz3fold_free(pool, handle);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/workqueue.h>",
            "#include <linux/preempt.h>",
            "#include <linux/percpu.h>",
            "#include <linux/module.h>",
            "#include <linux/mm.h>",
            "#include <linux/list.h>",
            "#include <linux/sched.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/workqueue.h>\n#include <linux/preempt.h>\n#include <linux/percpu.h>\n#include <linux/module.h>\n#include <linux/mm.h>\n#include <linux/list.h>\n#include <linux/sched.h>\n#include <linux/atomic.h>\n\nstatic void z3fold_zpool_free(void *pool, unsigned long handle)\n{\n\tz3fold_free(pool, handle);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&zswap_same_filled_pages"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic atomic_t zswap_stored_pages = ATOMIC_INIT(0);\nstatic atomic_t zswap_same_filled_pages = ATOMIC_INIT(0);\nstatic int zswap_writeback_entry(struct zpool *pool, unsigned long handle);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_free_entry(struct zswap_entry *entry)\n{\n\tif (!entry->length)\n\t\tatomic_dec(&zswap_same_filled_pages);\n\telse {\n\t\tzpool_free(entry->pool->zpool, entry->handle);\n\t\tzswap_pool_put(entry->pool);\n\t}\n\tzswap_entry_cache_free(entry);\n\tatomic_dec(&zswap_stored_pages);\n\tzswap_update_total_size();\n}"
  },
  {
    "function_name": "zswap_rb_erase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "320-326",
    "snippet": "static void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RB_CLEAR_NODE",
          "args": [
            "&entry->rbnode"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_erase",
          "args": [
            "&entry->rbnode",
            "root"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "zswap_rb_erase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
          "lines": "320-326",
          "snippet": "static void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "RB_EMPTY_NODE",
          "args": [
            "&entry->rbnode"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic void zswap_rb_erase(struct rb_root *root, struct zswap_entry *entry)\n{\n\tif (!RB_EMPTY_NODE(&entry->rbnode)) {\n\t\trb_erase(&entry->rbnode, root);\n\t\tRB_CLEAR_NODE(&entry->rbnode);\n\t}\n}"
  },
  {
    "function_name": "zswap_rb_insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "297-318",
    "snippet": "static int zswap_rb_insert(struct rb_root *root, struct zswap_entry *entry,\n\t\t\tstruct zswap_entry **dupentry)\n{\n\tstruct rb_node **link = &root->rb_node, *parent = NULL;\n\tstruct zswap_entry *myentry;\n\n\twhile (*link) {\n\t\tparent = *link;\n\t\tmyentry = rb_entry(parent, struct zswap_entry, rbnode);\n\t\tif (myentry->offset > entry->offset)\n\t\t\tlink = &(*link)->rb_left;\n\t\telse if (myentry->offset < entry->offset)\n\t\t\tlink = &(*link)->rb_right;\n\t\telse {\n\t\t\t*dupentry = myentry;\n\t\t\treturn -EEXIST;\n\t\t}\n\t}\n\trb_link_node(&entry->rbnode, parent, link);\n\trb_insert_color(&entry->rbnode, root);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_insert_color",
          "args": [
            "&entry->rbnode",
            "root"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_link_node",
          "args": [
            "&entry->rbnode",
            "parent",
            "link"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "parent",
            "structzswap_entry",
            "rbnode"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic int zswap_rb_insert(struct rb_root *root, struct zswap_entry *entry,\n\t\t\tstruct zswap_entry **dupentry)\n{\n\tstruct rb_node **link = &root->rb_node, *parent = NULL;\n\tstruct zswap_entry *myentry;\n\n\twhile (*link) {\n\t\tparent = *link;\n\t\tmyentry = rb_entry(parent, struct zswap_entry, rbnode);\n\t\tif (myentry->offset > entry->offset)\n\t\t\tlink = &(*link)->rb_left;\n\t\telse if (myentry->offset < entry->offset)\n\t\t\tlink = &(*link)->rb_right;\n\t\telse {\n\t\t\t*dupentry = myentry;\n\t\t\treturn -EEXIST;\n\t\t}\n\t}\n\trb_link_node(&entry->rbnode, parent, link);\n\trb_insert_color(&entry->rbnode, root);\n\treturn 0;\n}"
  },
  {
    "function_name": "zswap_rb_search",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "276-291",
    "snippet": "static struct zswap_entry *zswap_rb_search(struct rb_root *root, pgoff_t offset)\n{\n\tstruct rb_node *node = root->rb_node;\n\tstruct zswap_entry *entry;\n\n\twhile (node) {\n\t\tentry = rb_entry(node, struct zswap_entry, rbnode);\n\t\tif (entry->offset > offset)\n\t\t\tnode = node->rb_left;\n\t\telse if (entry->offset < offset)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn entry;\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rb_entry",
          "args": [
            "node",
            "structzswap_entry",
            "rbnode"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_rb_search(struct rb_root *root, pgoff_t offset)\n{\n\tstruct rb_node *node = root->rb_node;\n\tstruct zswap_entry *entry;\n\n\twhile (node) {\n\t\tentry = rb_entry(node, struct zswap_entry, rbnode);\n\t\tif (entry->offset > offset)\n\t\t\tnode = node->rb_left;\n\t\telse if (entry->offset < offset)\n\t\t\tnode = node->rb_right;\n\t\telse\n\t\t\treturn entry;\n\t}\n\treturn NULL;\n}"
  },
  {
    "function_name": "zswap_entry_cache_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "268-271",
    "snippet": "static void zswap_entry_cache_free(struct zswap_entry *entry)\n{\n\tkmem_cache_free(zswap_entry_cache, entry);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *zswap_entry_cache;",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_free",
          "args": [
            "zswap_entry_cache",
            "entry"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3749-3764",
          "snippet": "void kmem_cache_free(struct kmem_cache *cachep, void *objp)\n{\n\tunsigned long flags;\n\tcachep = cache_from_obj(cachep, objp);\n\tif (!cachep)\n\t\treturn;\n\n\tlocal_irq_save(flags);\n\tdebug_check_no_locks_freed(objp, cachep->object_size);\n\tif (!(cachep->flags & SLAB_DEBUG_OBJECTS))\n\t\tdebug_check_no_obj_freed(objp, cachep->object_size);\n\t__cache_free(cachep, objp, _RET_IP_);\n\tlocal_irq_restore(flags);\n\n\ttrace_kmem_cache_free(_RET_IP_, objp);\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid kmem_cache_free(struct kmem_cache *cachep, void *objp)\n{\n\tunsigned long flags;\n\tcachep = cache_from_obj(cachep, objp);\n\tif (!cachep)\n\t\treturn;\n\n\tlocal_irq_save(flags);\n\tdebug_check_no_locks_freed(objp, cachep->object_size);\n\tif (!(cachep->flags & SLAB_DEBUG_OBJECTS))\n\t\tdebug_check_no_obj_freed(objp, cachep->object_size);\n\t__cache_free(cachep, objp, _RET_IP_);\n\tlocal_irq_restore(flags);\n\n\ttrace_kmem_cache_free(_RET_IP_, objp);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\nstatic __init struct;\n\nstatic void zswap_entry_cache_free(struct zswap_entry *entry)\n{\n\tkmem_cache_free(zswap_entry_cache, entry);\n}"
  },
  {
    "function_name": "zswap_entry_cache_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "257-266",
    "snippet": "static struct zswap_entry *zswap_entry_cache_alloc(gfp_t gfp)\n{\n\tstruct zswap_entry *entry;\n\tentry = kmem_cache_alloc(zswap_entry_cache, gfp);\n\tif (!entry)\n\t\treturn NULL;\n\tentry->refcount = 1;\n\tRB_CLEAR_NODE(&entry->rbnode);\n\treturn entry;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *zswap_entry_cache;",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "RB_CLEAR_NODE",
          "args": [
            "&entry->rbnode"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmem_cache_alloc",
          "args": [
            "zswap_entry_cache",
            "gfp"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_alloc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab.c",
          "lines": "3550-3559",
          "snippet": "void *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}",
          "includes": [
            "#include\t\"slab.h\"",
            "#include\t\"internal.h\"",
            "#include <trace/events/kmem.h>",
            "#include\t<asm/page.h>",
            "#include\t<asm/tlbflush.h>",
            "#include\t<asm/cacheflush.h>",
            "#include\t<net/sock.h>",
            "#include\t<linux/sched/task_stack.h>",
            "#include\t<linux/prefetch.h>",
            "#include\t<linux/memory.h>",
            "#include\t<linux/debugobjects.h>",
            "#include\t<linux/reciprocal_div.h>",
            "#include\t<linux/rtmutex.h>",
            "#include\t<linux/fault-inject.h>",
            "#include\t<linux/mutex.h>",
            "#include\t<linux/mempolicy.h>",
            "#include\t<linux/kmemleak.h>",
            "#include\t<linux/nodemask.h>",
            "#include\t<linux/uaccess.h>",
            "#include\t<linux/string.h>",
            "#include\t<linux/rcupdate.h>",
            "#include\t<linux/module.h>",
            "#include\t<linux/sysctl.h>",
            "#include\t<linux/cpu.h>",
            "#include\t<linux/kallsyms.h>",
            "#include\t<linux/notifier.h>",
            "#include\t<linux/seq_file.h>",
            "#include\t<linux/proc_fs.h>",
            "#include\t<linux/cpuset.h>",
            "#include\t<linux/compiler.h>",
            "#include\t<linux/init.h>",
            "#include\t<linux/interrupt.h>",
            "#include\t<linux/cache.h>",
            "#include\t<linux/swap.h>",
            "#include\t<linux/poison.h>",
            "#include\t<linux/mm.h>",
            "#include\t<linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include\t\"slab.h\"\n#include\t\"internal.h\"\n#include <trace/events/kmem.h>\n#include\t<asm/page.h>\n#include\t<asm/tlbflush.h>\n#include\t<asm/cacheflush.h>\n#include\t<net/sock.h>\n#include\t<linux/sched/task_stack.h>\n#include\t<linux/prefetch.h>\n#include\t<linux/memory.h>\n#include\t<linux/debugobjects.h>\n#include\t<linux/reciprocal_div.h>\n#include\t<linux/rtmutex.h>\n#include\t<linux/fault-inject.h>\n#include\t<linux/mutex.h>\n#include\t<linux/mempolicy.h>\n#include\t<linux/kmemleak.h>\n#include\t<linux/nodemask.h>\n#include\t<linux/uaccess.h>\n#include\t<linux/string.h>\n#include\t<linux/rcupdate.h>\n#include\t<linux/module.h>\n#include\t<linux/sysctl.h>\n#include\t<linux/cpu.h>\n#include\t<linux/kallsyms.h>\n#include\t<linux/notifier.h>\n#include\t<linux/seq_file.h>\n#include\t<linux/proc_fs.h>\n#include\t<linux/cpuset.h>\n#include\t<linux/compiler.h>\n#include\t<linux/init.h>\n#include\t<linux/interrupt.h>\n#include\t<linux/cache.h>\n#include\t<linux/swap.h>\n#include\t<linux/poison.h>\n#include\t<linux/mm.h>\n#include\t<linux/slab.h>\n\nstatic noinline struct;\n\nvoid *kmem_cache_alloc(struct kmem_cache *cachep, gfp_t flags)\n{\n\tvoid *ret = slab_alloc(cachep, flags, _RET_IP_);\n\n\tkasan_slab_alloc(cachep, ret, flags);\n\ttrace_kmem_cache_alloc(_RET_IP_, ret,\n\t\t\t       cachep->object_size, cachep->size, flags);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\nstatic __init struct;\n\nstatic struct zswap_entry *zswap_entry_cache_alloc(gfp_t gfp)\n{\n\tstruct zswap_entry *entry;\n\tentry = kmem_cache_alloc(zswap_entry_cache, gfp);\n\tif (!entry)\n\t\treturn NULL;\n\tentry->refcount = 1;\n\tRB_CLEAR_NODE(&entry->rbnode);\n\treturn entry;\n}"
  },
  {
    "function_name": "zswap_entry_cache_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "252-255",
    "snippet": "static void __init zswap_entry_cache_destroy(void)\n{\n\tkmem_cache_destroy(zswap_entry_cache);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *zswap_entry_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmem_cache_destroy",
          "args": [
            "zswap_entry_cache"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "kmem_cache_destroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/slab_common.c",
          "lines": "874-906",
          "snippet": "void kmem_cache_destroy(struct kmem_cache *s)\n{\n\tint err;\n\n\tif (unlikely(!s))\n\t\treturn;\n\n\tflush_memcg_workqueue(s);\n\n\tget_online_cpus();\n\tget_online_mems();\n\n\tmutex_lock(&slab_mutex);\n\n\ts->refcount--;\n\tif (s->refcount)\n\t\tgoto out_unlock;\n\n\terr = shutdown_memcg_caches(s);\n\tif (!err)\n\t\terr = shutdown_cache(s);\n\n\tif (err) {\n\t\tpr_err(\"kmem_cache_destroy %s: Slab cache still has objects\\n\",\n\t\t       s->name);\n\t\tdump_stack();\n\t}\nout_unlock:\n\tmutex_unlock(&slab_mutex);\n\n\tput_online_mems();\n\tput_online_cpus();\n}",
          "includes": [
            "#include \"slab.h\"",
            "#include <trace/events/kmem.h>",
            "#include <linux/memcontrol.h>",
            "#include <asm/page.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/cpu.h>",
            "#include <linux/module.h>",
            "#include <linux/compiler.h>",
            "#include <linux/cache.h>",
            "#include <linux/memory.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/poison.h>",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct kmem_cache *kmem_cache;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"slab.h\"\n#include <trace/events/kmem.h>\n#include <linux/memcontrol.h>\n#include <asm/page.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <linux/proc_fs.h>\n#include <linux/seq_file.h>\n#include <linux/uaccess.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n#include <linux/compiler.h>\n#include <linux/cache.h>\n#include <linux/memory.h>\n#include <linux/interrupt.h>\n#include <linux/poison.h>\n#include <linux/mm.h>\n#include <linux/slab.h>\n\nstruct kmem_cache *kmem_cache;\n\nvoid kmem_cache_destroy(struct kmem_cache *s)\n{\n\tint err;\n\n\tif (unlikely(!s))\n\t\treturn;\n\n\tflush_memcg_workqueue(s);\n\n\tget_online_cpus();\n\tget_online_mems();\n\n\tmutex_lock(&slab_mutex);\n\n\ts->refcount--;\n\tif (s->refcount)\n\t\tgoto out_unlock;\n\n\terr = shutdown_memcg_caches(s);\n\tif (!err)\n\t\terr = shutdown_cache(s);\n\n\tif (err) {\n\t\tpr_err(\"kmem_cache_destroy %s: Slab cache still has objects\\n\",\n\t\t       s->name);\n\t\tdump_stack();\n\t}\nout_unlock:\n\tmutex_unlock(&slab_mutex);\n\n\tput_online_mems();\n\tput_online_cpus();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\n\nstatic void __init zswap_entry_cache_destroy(void)\n{\n\tkmem_cache_destroy(zswap_entry_cache);\n}"
  },
  {
    "function_name": "zswap_entry_cache_create",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "246-250",
    "snippet": "static int __init zswap_entry_cache_create(void)\n{\n\tzswap_entry_cache = KMEM_CACHE(zswap_entry, 0);\n\treturn zswap_entry_cache == NULL;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct kmem_cache *zswap_entry_cache;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "KMEM_CACHE",
          "args": [
            "zswap_entry",
            "0"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic struct kmem_cache *zswap_entry_cache;\n\nstatic int __init zswap_entry_cache_create(void)\n{\n\tzswap_entry_cache = KMEM_CACHE(zswap_entry, 0);\n\treturn zswap_entry_cache == NULL;\n}"
  },
  {
    "function_name": "zswap_update_total_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "226-239",
    "snippet": "static void zswap_update_total_size(void)\n{\n\tstruct zswap_pool *pool;\n\tu64 total = 0;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\ttotal += zpool_get_total_size(pool->zpool);\n\n\trcu_read_unlock();\n\n\tzswap_pool_total_size = total;\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 zswap_pool_total_size;",
      "static LIST_HEAD(zswap_pools);",
      "static int zswap_pool_get(struct zswap_pool *pool);",
      "static void zswap_pool_put(struct zswap_pool *pool);",
      "static __init struct"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "zpool_get_total_size",
          "args": [
            "pool->zpool"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "zpool_get_total_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zpool.c",
          "lines": "356-359",
          "snippet": "u64 zpool_get_total_size(struct zpool *zpool)\n{\n\treturn zpool->driver->total_size(zpool->pool);\n}",
          "includes": [
            "#include <linux/zpool.h>",
            "#include <linux/module.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/mm.h>",
            "#include <linux/types.h>",
            "#include <linux/list.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/zpool.h>\n#include <linux/module.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/mm.h>\n#include <linux/types.h>\n#include <linux/list.h>\n\nu64 zpool_get_total_size(struct zpool *zpool)\n{\n\treturn zpool->driver->total_size(zpool->pool);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "pool",
            "&zswap_pools",
            "list"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic u64 zswap_pool_total_size;\nstatic LIST_HEAD(zswap_pools);\nstatic int zswap_pool_get(struct zswap_pool *pool);\nstatic void zswap_pool_put(struct zswap_pool *pool);\nstatic __init struct;\n\nstatic void zswap_update_total_size(void)\n{\n\tstruct zswap_pool *pool;\n\tu64 total = 0;\n\n\trcu_read_lock();\n\n\tlist_for_each_entry_rcu(pool, &zswap_pools, list)\n\t\ttotal += zpool_get_total_size(pool->zpool);\n\n\trcu_read_unlock();\n\n\tzswap_pool_total_size = total;\n}"
  },
  {
    "function_name": "zswap_is_full",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2018-18397/repo/mm/zswap.c",
    "lines": "220-224",
    "snippet": "static bool zswap_is_full(void)\n{\n\treturn totalram_pages * zswap_max_pool_percent / 100 <\n\t\tDIV_ROUND_UP(zswap_pool_total_size, PAGE_SIZE);\n}",
    "includes": [
      "#include <linux/debugfs.h>",
      "#include <linux/pagemap.h>",
      "#include <linux/writeback.h>",
      "#include <linux/swapops.h>",
      "#include <linux/page-flags.h>",
      "#include <linux/mm_types.h>",
      "#include <linux/zpool.h>",
      "#include <linux/mempool.h>",
      "#include <linux/crypto.h>",
      "#include <linux/swap.h>",
      "#include <linux/rbtree.h>",
      "#include <linux/frontswap.h>",
      "#include <linux/atomic.h>",
      "#include <linux/types.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/slab.h>",
      "#include <linux/highmem.h>",
      "#include <linux/cpu.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static u64 zswap_pool_total_size;",
      "static unsigned int zswap_max_pool_percent = 20;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DIV_ROUND_UP",
          "args": [
            "zswap_pool_total_size",
            "PAGE_SIZE"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/debugfs.h>\n#include <linux/pagemap.h>\n#include <linux/writeback.h>\n#include <linux/swapops.h>\n#include <linux/page-flags.h>\n#include <linux/mm_types.h>\n#include <linux/zpool.h>\n#include <linux/mempool.h>\n#include <linux/crypto.h>\n#include <linux/swap.h>\n#include <linux/rbtree.h>\n#include <linux/frontswap.h>\n#include <linux/atomic.h>\n#include <linux/types.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/highmem.h>\n#include <linux/cpu.h>\n#include <linux/module.h>\n\nstatic u64 zswap_pool_total_size;\nstatic unsigned int zswap_max_pool_percent = 20;\n\nstatic bool zswap_is_full(void)\n{\n\treturn totalram_pages * zswap_max_pool_percent / 100 <\n\t\tDIV_ROUND_UP(zswap_pool_total_size, PAGE_SIZE);\n}"
  }
]