[
  {
    "file_path": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
    "id": [
      "virDomainAgentSetResponseTimeout",
      "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
      "12564-12590"
    ],
    "function_name": "virDomainAgentSetResponseTimeout",
    "contextual_snippet": "MAIN FUNCTION:\n#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainAgentSetResponseTimeout(virDomainPtr domain,\n                                 int timeout,\n                                 unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"timeout=%i, flags=0x%x\",\n                     timeout, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    if (conn->driver->domainAgentSetResponseTimeout) {\n        if (conn->driver->domainAgentSetResponseTimeout(domain, timeout, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}\n\n-------- CONTEXTUAL INFORMATIONS - CALLEES CODE --------\n-------- Code of the functions used by the analyzed function -------- \n\n\nCallee: virDispatchError\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}\n\nCallee: virResetLastError\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}\n",
    "sinks": [
      {
        "sink_id": "conn->driver->domainAgentSetResponseTimeout(domain, timeout, flags)",
        "sink_description": "Invokes the hypervisor driver to change the guest agent response timeout for a given domain, affecting how the system interacts with that VM guest agent.",
        "required_conditions": [
          {
            "id": "domain_nonnull",
            "description": "The domain pointer must refer to a valid, existing domain associated with the connection.",
            "locally_satisfied": true,
            "justification": "virCheckDomainReturn(domain, -1) is called at the top of the function to validate the domain and return early on failure."
          },
          {
            "id": "driver_method_available",
            "description": "The underlying hypervisor driver must support the domainAgentSetResponseTimeout operation before it is invoked.",
            "locally_satisfied": true,
            "justification": "The call is guarded by if (conn->driver->domainAgentSetResponseTimeout) and the unsupported case is handled via virReportUnsupportedError()."
          },
          {
            "id": "authorization_for_timeout_change",
            "description": "The caller must be authorized to modify the guest agent response timeout for the specified domain.",
            "locally_satisfied": false,
            "justification": null
          },
          {
            "id": "timeout_value_policy",
            "description": "The timeout parameter must comply with any policy or safety constraints (e.g., non-negative, within allowed range).",
            "locally_satisfied": false,
            "justification": null
          },
          {
            "id": "flags_policy",
            "description": "The flags argument must be validated to only contain supported and permitted flag bits for this operation.",
            "locally_satisfied": false,
            "justification": null
          }
        ]
      }
    ]
  }
]