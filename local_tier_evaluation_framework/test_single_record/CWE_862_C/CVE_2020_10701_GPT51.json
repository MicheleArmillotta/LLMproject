[
  {
    "file_path": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
    "id": [
      "virDomainAgentSetResponseTimeout",
      "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
      "12564-12590"
    ],
    "function_name": "virDomainAgentSetResponseTimeout",
    "contextual_snippet": "MAIN FUNCTION:\n#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainAgentSetResponseTimeout(virDomainPtr domain,\n                                 int timeout,\n                                 unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"timeout=%i, flags=0x%x\",\n                     timeout, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    if (conn->driver->domainAgentSetResponseTimeout) {\n        if (conn->driver->domainAgentSetResponseTimeout(domain, timeout, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}\n\n-------- CONTEXTUAL INFORMATIONS - CALLEES CODE --------\n-------- Code of the functions used by the analyzed function -------- \n\n\nCallee: virDispatchError\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}\n\nCallee: virResetLastError\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}\n",
    "sinks": [
      {
        "sink_id": "conn->driver->domainAgentSetResponseTimeout(domain, timeout, flags)",
        "sink_description": "Delegates setting of the guest agent response timeout for a given domain to the hypervisor driver, affecting how the management layer communicates with the domain's guest agent.",
        "required_conditions": [
          {
            "id": "domain_pointer_valid",
            "description": "The domain pointer must reference a valid, existing domain object associated with this connection.",
            "locally_satisfied": true,
            "justification": "virCheckDomainReturn(domain, -1) is called at the beginning, which typically validates that the domain pointer is non-NULL and refers to a valid domain, and returns early on failure."
          },
          {
            "id": "driver_callback_present",
            "description": "The connection's driver must actually implement the domainAgentSetResponseTimeout callback before it is invoked.",
            "locally_satisfied": true,
            "justification": "The code checks if conn->driver->domainAgentSetResponseTimeout is non-NULL before calling it; otherwise it reports an unsupported error."
          },
          {
            "id": "caller_authorized_to_change_agent_timeout",
            "description": "The caller must be authorized (per libvirt/driver policy) to modify the agent response timeout for the specified domain, as this affects management behavior and potentially availability of operations on that domain.",
            "locally_satisfied": false,
            "justification": null
          },
          {
            "id": "timeout_value_within_policy",
            "description": "The timeout value provided must comply with any policy or constraints on acceptable agent timeouts (e.g., minimum/maximum values) to avoid unintended denial of service or overly permissive timeouts.",
            "locally_satisfied": false,
            "justification": null
          }
        ]
      }
    ]
  }
]